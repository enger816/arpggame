
function float2int(a){return 0|a}function radian2angle(a){return a/Math.PI*180}function angle2radian(a){return a/180*Math.PI}function getChiNum(a){return keyChi[a]}function hexToArgb(a,b,c){return void 0===b&&(b=!0),void 0===c&&(c=null),c||(c=new Vector3D),c.w=b?a>>24&255:0,c.x=a>>16&255,c.y=a>>8&255,c.z=255&a,c}function hexToArgbNum(a,b,c){return void 0===b&&(b=!0),void 0===c&&(c=null),c=hexToArgb(a,b,c),c.scaleBy(1/255),c}function getBaseUrl(){return Scene_data.supportBlob?"":"_base"}function strokeFilter(a,b,c,d){function e(a,c){return 4*(c*b+a)}function f(a,b){var c;return c=e(a-1,b),i[c+3]>0?!0:(c=e(a+1,b),i[c+3]>0?!0:(c=e(a,b+1),i[c+3]>0?!0:(c=e(a,b-1),i[c+3]>0?!0:!1)))}for(var g=hexToArgb(d),h=a.getImageData(0,0,b,c),i=h.data,j=new Array,k=1;b-1>k;k++)for(var l=0;c-1>l;l++){var m=e(k,l);0==i[m+3]&&f(k,l)&&j.push(m)}for(var k=0;k<j.length;k++)i[j[k]]=g.x,i[j[k]+1]=g.y,i[j[k]+2]=g.z,i[j[k]+3]=g.w;a.putImageData(h,0,0)}function trim(a){return trimRight(trimLeft(a))}function trimLeft(a){if(null==a)return"";var b=new String(" 	\n\r"),c=new String(a);if(-1!=b.indexOf(c.charAt(0))){for(var d=0,e=c.length;e>d&&-1!=b.indexOf(c.charAt(d));)d++;c=c.substring(d,e)}return c}function trimRight(a){if(null==a)return"";var b=new String(" 	\n\r"),c=new String(a);if(-1!=b.indexOf(c.charAt(c.length-1))){for(var d=c.length-1;d>=0&&-1!=b.indexOf(c.charAt(d));)d--;c=c.substring(0,d+1)}return c}function TweenMoveTo(a,b,c){c.ease=Linear.easeInOut,TweenLite.to(a,b,c)}function getScencdStr(a){var b=Math.floor(a/60%60),c=Math.floor(a%60);return String(10>b?"0":"")+String(b)+":"+String(10>c?"0":"")+String(c)}function random(a){return Math.floor(Math.random()*a)}function randomByItem(a){return a[random(a.length)]}function makeArray(a,b){a||console.log("有错");for(var c=0;c<a.length;c++)b.push(a[c])}function unZip(a){var b=new Uint8Array(a),c=new Zlib.Inflate(b),d=c.decompress();return d.buffer}function getZipByte(a){var b=a.readInt(),c=a.buffer.slice(a.position,a.position+b);a.position+=b;var d=unZip(c);return new ByteArray(d)}function getUrlParam(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),c=window.location.search.substr(1).match(b);return null!=c?decodeURI(c[2]):null}function copy2clipboard(a){var b=document.createElement("textarea");b.style.fontSize="12pt",b.style.position="absolute",b.style["z-index"]=-1,b.style.background="transparent",b.style.border="transparent",b.style.color="white",b.setAttribute("readonly",""),document.body.appendChild(b),b.value=a,b.select(),b.setSelectionRange(0,b.value.length);try{document.execCommand("copy")}catch(c){alert("不支持复制")}setTimeout(function(){document.body.removeChild(b)},1e3)}function getBit(a,b){return Boolean(a>>(31&b)&1)}function OperationFailedToString(a,b,c){return a==OprateResult.OPRATE_TYPE_LOGIN?b==OprateResult.OPRATE_RESULT_SUCCESS?" 登录 - 成功 - "+c:b==OprateResult.OPRATE_RESULT_NAME_REPEAT?" 登录 - 名称重复 - "+c:b==OprateResult.OPRATE_RESULT_NAME_ILLEGAL?" 登录 - 名称非法 - "+c:b==OprateResult.OPRATE_RESULT_CHAR_CAP?" 登录 - 角色数量达到上限 - "+c:b==OprateResult.OPRATE_RESULT_SCENED_CLOSE?" 登录 - 场景服未开启 - "+c:b==OprateResult.OPRATE_RESULT_SCENED_ERROR?" 登录 - 场景服重置，其实就是崩了一个场景服换一个新的 - "+c:b==OprateResult.OPRATE_RESULT_LOGINED_IN?" 登录 - 角色已登录 - "+c:b==OprateResult.OPRATE_RESULT_OTHER_LOGINED?" 登录 - 角色其他地方登录 - "+c:b==OprateResult.OPRATE_RESULT_GAME_VERSION_ERROR?" 登录 - 游戏版本不对 - "+c:b==OprateResult.OPRATE_RESULT_MAP_VERSION_ERROR?" 登录 - 地图素材版本不对 - "+c:b==OprateResult.OPRATE_RESULT_DATA_VERSION_ERROR?" 登录 - data素材版本不对 - "+c:b==OprateResult.OPRATE_RESULT_VERSION_FORMAT_ERROR?" 登录 - 客户端发来的版本信息格式不对 - "+c:b==OprateResult.OPRATE_RESULT_APPD_ERROR?" 登录 - 应用服异常重启 - "+c:b==OprateResult.OPRATE_RESULT_LOCK_ACCOUNT?" 登录 - 帐号被封 - "+c:b==OprateResult.OPRATE_RESULT_LOCK_IP?" 登录 - IP被封 - "+c:b==OprateResult.OPRATE_RESULT_APPD_CLOSE?" 登录 - 应用服未开启 - "+c:b==OprateResult.OPRATE_RESULT_NAME_TOO_LONG?" 登录 - 名字太长 - "+c:b==OprateResult.OPRATE_RESULT_NAME_HAS_PINGBI?" 登录 - 有屏蔽词 - "+c:b==OprateResult.OPRATE_RESULT_LOGOUT_UNFINISHED?" 登录 - 该角色上一次的登出未完成，请等待 - "+c:b==OprateResult.OPRATE_RESULT_PID_OR_SID_ERROR?" 登录 - 服务器id或者平台id错误 - "+c:b==OprateResult.OPRATE_RESULT_DB_RESULT_ERROR?" 登录 - 数据库查询出问题了 - "+c:b==OprateResult.OPRATE_RESULT_MERGE_SERVER?" 登录 - 合服了 - "+c:b==OprateResult.OPRATE_RESULT_PLAYER_ZIBAO?" 登录 - 自爆 - "+c:b==OprateResult.OPRATE_RESULT_GENDER_ILLEGAL?" 登录 - 角色种类异常 - "+c:"未知错误1  OPRATE_TYPE_LOGIN "+b+"    "+c:a==OprateResult.OPRATE_TYPE_KICKING?b==OprateResult.KICKING_TYPE_GM_LOCK_IP?" 踢人 - 封IP - "+c:b==OprateResult.KICKING_TYPE_GM_LOCK_ACCOUNT?" 踢人 - 封号 - "+c:b==OprateResult.KICKING_TYPE_GM_KICKING?" 踢人 - 从GM表中读取的踢人 - "+c:b==OprateResult.KICKING_TYPE_KUANGCHANG_RELIVE?" 踢人 - 荒芜矿场非法复活 - "+c:b==OprateResult.KICKING_TYPE_FUCK_PINGBI?" 踢人 - 聊天点带屏蔽词 - "+c:b==OprateResult.KICKING_TYPE_QUEST_GET_ITEM?" 踢人 - 刷物品 - "+c:b==OprateResult.KICKING_TYPE_NOT_MONEY?" 踢人 - 钱负数还继续消费 - "+c:"未知错误1  OPRATE_TYPE_KICKING "+b+"    "+c:a==OprateResult.OPRATE_TYPE_JUMP?b==OprateResult.JUMP_RESULT_NOMAL?" 跳 - 无，默认结果 - "+c:b==OprateResult.JUMP_RESULT_DEAD?" 跳 - 死了你还跳，果断是诈尸 - "+c:b==OprateResult.JUMP_RESULT_ENERGY?" 跳 - 体力不足 - "+c:b==OprateResult.JUMP_RESULT_MAP_CANT_JUMP?" 跳 - 地图无法跳跃 - "+c:b==OprateResult.JUMP_RESULT_CANT_JUMP?" 跳 - 玩家被限制不能跳跃 - "+c:b==OprateResult.JUMP_RESULT_MAX_DISTANCE?" 跳 - 超过最大距离 - "+c:b==OprateResult.JUMP_RESULT_WRONG_COORD?" 跳 - 无效坐标，障碍点之流 - "+c:b==OprateResult.JUMP_RESULT_SPELL_CD?" 跳 - 跳跃技能cd中 - "+c:b==OprateResult.JUMP_RESULT_NOT_ACTIVE_SPELL?" 跳 - 2段跳没有激活 - "+c:"未知错误1  OPRATE_TYPE_JUMP "+b+"    "+c:a==OprateResult.OPRATE_TYPE_ATTK_LOSE?b==OprateResult.ATTACK_LOST_CANTATTACK?" 攻击失败 - 被限制不能攻击 - "+c:b==OprateResult.ATTACK_LOST_TARGET_DEAD?" 攻击失败 - 目标已经死亡 - "+c:b==OprateResult.ATTACK_LOST_NEED_TARGET?" 攻击失败 - 攻击需要一个目标 - "+c:b==OprateResult.ATTACK_LOST_OUT_OF_RANGE?" 攻击失败 - 超出攻击范围 - "+c:b==OprateResult.ATTACK_LOST_WRONG_TARGET?" 攻击失败 - 错误的目标 - "+c:b==OprateResult.ATTACK_LOST_MOVING?" 攻击失败 - 正在移动状态下不能攻击 - "+c:"未知错误1  OPRATE_TYPE_ATTK_LOSE "+b+"    "+c:a==OprateResult.OPRATE_TYPE_SPELL_LOSE?b==OprateResult.LOST_RESON_SPELL_DOENT_EXIST?" 技能释放失败 - 技能不存在 - "+c:b==OprateResult.LOST_RESON_NOT_HAVE_SPELL?" 技能释放失败 - 你没有这个技能 - "+c:b==OprateResult.LOST_RESON_NOT_ENOUGH_ANGER?" 技能释放失败 - 怒气值不足 - "+c:b==OprateResult.LOST_RESON_SPELL_COOLDOWN?" 技能释放失败 - 冷却 - "+c:b==OprateResult.LOST_RESON_ALREADY_CAST?" 技能释放失败 - 已经在施法 - "+c:b==OprateResult.LOST_RESON_TARGET_DEAD?" 技能释放失败 - 目标已经死亡 - "+c:b==OprateResult.LOST_RESON_NEED_TARGET?" 技能释放失败 - 此技能需要一个目标 - "+c:b==OprateResult.LOST_RESON_JUMP_DENY?" 技能释放失败 - 跳跃状态不能施法 - "+c:b==OprateResult.LOST_RESON_SCENE_DENY?" 技能释放失败 - 场景禁止施法 - "+c:b==OprateResult.LOST_RESON_CAN_NOT_CAST?" 技能释放失败 - 无法施法 - "+c:b==OprateResult.LOST_RESON_HAS_CONFLICT_SPELL?" 技能释放失败 - 有技能冲突 - "+c:b==OprateResult.LOST_RESON_NOTHAS_CHUZHAN?" 技能释放失败 - 当前没有出战兵种 - "+c:b==OprateResult.LOST_RESON_WRONG_FACTION?" 技能释放失败 - 同一阵营不能攻击（争霸天下用） - "+c:b==OprateResult.LOST_RESON_ACTIVE_SPELL_SUCCESS?" 技能释放失败 - 技能激活成功 - "+c:b==OprateResult.LOST_RESON_IN_SAFE_ZONE?" 技能释放失败 - 安全区域不能攻击（大沼泽用） - "+c:b==OprateResult.LOST_RESON_YXT_WRONG_FACTION?" 技能释放失败 - 同一阵营不能攻击（英雄帖用） - "+c:b==OprateResult.LOST_RESON_PVP_STATE?" 技能释放失败 - PVP状态不能释放 - "+c:"未知错误1  OPRATE_TYPE_SPELL_LOSE "+b+"    "+c:a==OprateResult.OPRATE_TYPE_INTERACTION?b==OprateResult.INTERACTION_TOO_FAR?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - NPC太远 - "+c:b==OprateResult.INTERACTION_BOOK_DAILYNUM_FULL?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - 奇遇日常任务次数已满 - "+c:b==OprateResult.INTERACTION_NO_ENOUGH_ENDURANCE?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - 精力值不够 - "+c:b==OprateResult.INTERACTION_JHM_ERROR?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - 激活码错误 - "+c:b==OprateResult.INTERACTION_WORSHIP?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - 城主膜拜 - "+c:b==OprateResult.INTERACTION_JHM_HAVE?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - 激活码奖励已领取 - "+c:b==OprateResult.INTERACTION_JHM_IS_USED?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - 激活码已使用 - "+c:b==OprateResult.INTERACTION_JHM_NOT_USE_RANGE?" 交互,如使用GAMEOBJ 与NPC对话，交接任务等 - 不在使用范围内 - "+c:"未知错误1  OPRATE_TYPE_INTERACTION "+b+"    "+c:a==OprateResult.OPRATE_TYPE_USE_GAMEOBJECT?b==OprateResult.USE_GAMEOBJECT_SUCCEED?" 使用游戏对象 - 使用游戏对象成功 - "+c:b==OprateResult.USE_GAMEOBJECT_FAIL?" 使用游戏对象 - 使用游戏对象失败 - "+c:b==OprateResult.USE_GAMEOBJECT_QUEST?" 使用游戏对象 - 采集成功 - "+c:b==OprateResult.USE_GAMEOBJECT_TOO_FAST?" 使用游戏对象 - 采集速度太快 - "+c:"未知错误1  OPRATE_TYPE_USE_GAMEOBJECT "+b+"    "+c:a==OprateResult.OPRATE_TYPE_BAG?b==OprateResult.BAG_RESULT_NULL?" 包裹 - 路过的 - "+c:b==OprateResult.BAG_RESULT_ITEM_NOT_EXIST?" 包裹 - 物品不存在 - "+c:b==OprateResult.BAG_RESULT_CHANGE_ERROR?" 包裹 - 交换位置错误 - "+c:b==OprateResult.BAG_RESULT_DESTROY_BIND?" 包裹 - 删除绑定的 - "+c:b==OprateResult.BAG_RESULT_ITEM_NOT_SELF?" 包裹 - 不是自己的物品 - "+c:b==OprateResult.BAG_RESULT_REPAIR_FULL?" 包裹 - 修理耐久已满的物品 - "+c:b==OprateResult.BAG_RESULT_BAG_NOT_EXIST?" 包裹 - 包裹不存在 - "+c:b==OprateResult.BAG_RESULT_POS_NOT_EXIST?" 包裹 - 包裹位置不存在 - "+c:b==OprateResult.BAG_RESULT_DESTROY_TOOMUCH?" 包裹 - 数量不够删 - "+c:b==OprateResult.BAG_RESULT_BAN_FOR_TRADE?" 包裹 - 交易中不允许操作 - "+c:b==OprateResult.BAG_RESULT_SPLIT_FAILURE?" 包裹 - 物品拆分失败 - "+c:b==OprateResult.BAG_RESULT_LACK_USER?" 包裹 - 数量不够删 - "+c:b==OprateResult.BAG_RESULT_BAG_FULL?" 包裹 - 包裹放不下 - "+c:b==OprateResult.BAG_RESULT_MAX_COUNT?" 包裹 - 超过最大拥有数 - "+c:b==OprateResult.BAG_RESULT_SELL_BIND?" 包裹 - 定物品不允许出售 - "+c:b==OprateResult.BAG_RESULT_REPAIR_OK?" 包裹 - 铜钱宝箱开启成功 - "+c:b==OprateResult.BAG_RESULT_REPAIR_MONEY_LACK?" 包裹 - 钱不够无法修理 - "+c:b==OprateResult.BAG_RESULT_EXTENSION_BAG?" 包裹 - 包裹不支持扩展 - "+c:b==OprateResult.BAG_RESULT_EXTENSION_MAX_SIZE?" 包裹 - 包裹大小已经最大 - "+c:b==OprateResult.BAG_RESULT_EXTENSION_MATERIAL_LACK?" 包裹 - 包裹扩展材料不足 - "+c:b==OprateResult.BAG_RESULT_EXTENSION_TRADE?" 包裹 - 交易中不允许包裹扩展 - "+c:b==OprateResult.BAG_RESULT_USE_ITEM_COUNT_MAX?" 包裹 - 使用物品数量达到上限 - "+c:b==OprateResult.BAG_RESULT_NOT_ITEM?" 包裹 - 没开出物品 - "+c:b==OprateResult.BAG_RESULT_ITEM_USEING?" 包裹 - 物品使用中 - "+c:b==OprateResult.BAG_RESULT_GET_ITEMS?" 包裹 - 获得物品（元宝卡） - "+c:b==OprateResult.BAG_RESULT_USE_ITEMS?" 包裹 - 使用物品（装备宝箱） - "+c:b==OprateResult.BAG_RESULT_GET_ITEMS_ORANGE?" 包裹 - 开启橙色装备 - "+c:b==OprateResult.BAG_RESULT_USE_ITEMS_GENERALS?" 包裹 - 使用物品（将魂使用） - "+c:b==OprateResult.BAG_RESULT_GET_ITEMS_CABX?" 包裹 - 获得 财神宝箱 - "+c:b==OprateResult.BAG_RESULT_GET_ITEMS_CABX_BUFF?" 包裹 - 获得 财神宝箱的buff 提示 - "+c:b==OprateResult.BAG_RESULT_ALREADY_KAIGUANG?" 包裹 - 设备已经开光 - "+c:b==OprateResult.BAG_RESULT_EXCHANGE_SUCCESS?" 包裹 - 穿上装备成功 - "+c:b==OprateResult.BAG_RESULT_OPEN_ITEMS_SUCCESS?" 包裹 - 打开物品成功（用于概率获得） - "+c:b==OprateResult.BAG_RESULT_OPEN_ITEMS_FAIL?" 包裹 - 打开物品失败（用于概率获得） - "+c:b==OprateResult.BAG_RESULT_GET_ITEMS_GENERALS_EQUIP?" 包裹 - 使用物品获得武将装备 - "+c:b==OprateResult.BAG_RESULT_GET_SHOWHAND_JIEZHI?" 包裹 - 获得梭哈戒指 - "+c:b==OprateResult.BAG_RESULT_USE_WUJIANG_EXP_CARD?" 包裹 - 使用武将经验卡 - "+c:b==OprateResult.BAG_RESULT_USE_ITEMS_SUCCESS?" 包裹 - 物品使用成功 - "+c:b==OprateResult.BAG_RESULT_BAG_FULL_SEND_MAIL?" 包裹 - 包裹已满 发送邮箱提示 - "+c:b==OprateResult.BAG_RESULT_BAG_FULL_AUTO_SELL?" 包裹 - 包裹已满自动出售 - "+c:b==OprateResult.BAG_RESULT_BAG_XIULIAN_USE?" 包裹 - 使用修炼丹获得经验 - "+c:b==OprateResult.BAG_RESULT_BAG_SORT_CD?" 包裹 - 整理功能冷却中 - "+c:"未知错误1  OPRATE_TYPE_BAG "+b+"    "+c:a==OprateResult.OPRATE_TYPE_TRADE?b==OprateResult.TRADE_RESULT_TYPE_NOT_TARGET?" 交易 - 没有交易对象 - "+c:b==OprateResult.TRADE_RESULT_TYPE_TRADEING?" 交易 - 已经交易中无法继续处理交易申请 - "+c:b==OprateResult.TRADE_RESULT_TYPE_NOT_TRADE?" 交易 - 非交易进行中无效操作 - "+c:b==OprateResult.TRADE_RESULT_TYPE_BAG_SIZE?" 交易 - 包裹空间不足交易失败 - "+c:b==OprateResult.TRADE_RESULT_TYPE_UNRECOGNISED?" 交易 - 未确认交易物品 - "+c:b==OprateResult.TRADE_RESULT_TYPE_TARGET_CANCEL?" 交易 - 对方交已取消交易 - "+c:b==OprateResult.TRADE_RESULT_TYPE_LACK_MONEY?" 交易 - 金钱不足 - "+c:b==OprateResult.TRADE_RESULT_TYPE_IS_BIND?" 交易 - 绑定物品不允许交易 - "+c:"未知错误1  OPRATE_TYPE_TRADE "+b+"    "+c:a==OprateResult.OPRATE_TYPE_CHAT?b==OprateResult.CHAT_RESULT_NOT_PLAYER?" 聊天 - 找不到玩家 - "+c:b==OprateResult.CHAT_RESULT_IS_GAG?" 聊天 - 被禁言 - "+c:b==OprateResult.CHAT_LEVEL_WHISPER_LEVEL_NO?" 聊天 - 私聊等级不足 - "+c:b==OprateResult.CHAT_LEVEL_WORLD_LEVEL_NO?" 聊天 - 世界聊天等级不足 - "+c:b==OprateResult.CHAT_RESULT_CHECK_LIMIT?" 聊天 - 您说话太快了，赶紧练级等等再聊天吧… - "+c:b==OprateResult.CHAT_RESULT_NO_FACTION?" 聊天 - 你暂无帮派 - "+c:b==OprateResult.CHAT_RESULT_NO_GROUP?" 聊天 - 你暂无队伍 - "+c:"未知错误1  OPRATE_TYPE_CHAT "+b+"    "+c:a==OprateResult.OPERTE_TYPE_RECEIVE_GIFT_PACKS?b==OprateResult.RECEIVE_GIFT_PACKS_NOT_FIND?" 领取补偿礼包 - 找不到这条补偿礼包 - "+c:b==OprateResult.RECEIVE_GIFT_PACKS_CHAR_ERROR?" 领取补偿礼包 - 这礼包不是你的 - "+c:b==OprateResult.RECEIVE_GIFT_PACKS_CHAR_CREATE?" 领取补偿礼包 - 礼包指定的发放起始时间在你角色创建时间之前 - "+c:b==OprateResult.RECEIVE_GIFT_PACKS_RECEIVED?" 领取补偿礼包 - 该礼包你已经领取过了 - "+c:b==OprateResult.RECEIVE_GIFT_PACKS_ONLINE_AWARD?" 领取补偿礼包 - 在线礼包奖励 - "+c:b==OprateResult.RECEIVE_GIFT_PACKS_ONLINE_XIANSHI?" 领取补偿礼包 - 在线礼包显示用 - "+c:"未知错误1  OPERTE_TYPE_RECEIVE_GIFT_PACKS "+b+"    "+c:a==OprateResult.OPERTE_TYPE_QUEST?b==OprateResult.INVALIDREASON_QUEST_FAILED_LOW_LEVEL?" 任务 -  等级太低 You are not high enough level for that quest. - "+c:b==OprateResult.INVALIDREASON_QUEST_FAILED_WRONG_RACE?" 任务 -  这个任务对于你的角色类别是无效的 That quest is not available to your race. - "+c:b==OprateResult.INVALIDREASON_QUEST_ALREADY_DONE?" 任务 -  任务已经完成 You have completed that quest. - "+c:b==OprateResult.INVALIDREASON_QUEST_ONLY_ONE_TIMED?" 任务 -  任务只能做一次 You can only be on one timed quest at a time. - "+c:b==OprateResult.INVALIDREASON_QUEST_ALREADY_ON?" 任务 -  已经在任务中 You are already on that quest. - "+c:b==OprateResult.INVALIDREASON_QUEST_FAILED_EXPANSION?" 任务 -  物品太少 This quest requires an expansion enabled account. - "+c:b==OprateResult.INVALIDREASON_QUEST_ALREADY_ON2?" 任务 -  已经在任务中 ? You are already on that quest. - "+c:b==OprateResult.INVALIDREASON_QUEST_FAILED_MISSING_ITEMS?" 任务 -  没有完成任务需要的物品 You don't have the required items with you. Check storage. - "+c:b==OprateResult.INVALIDREASON_QUEST_FAILED_NOT_ENOUGH_MONEY?" 任务 -  没有足够的金钱完成任务 You don't have enough money for that quest. - "+c:b==OprateResult.INVALIDREASON_DAILY_QUESTS_REMAINING?" 任务 -  你已经完成了每天的25个任务 You have already completed 25 daily quests today. - "+c:b==OprateResult.INVALIDREASON_QUEST_FAILED_CAIS?" 任务 -  有疲劳时间无法完成任务 You cannot complete quests once you have reached tired time. - "+c:b==OprateResult.INVALIDREASON_DAILY_QUEST_COMPLETED_TODAY?" 任务 -  已经完成当天的任务 You have completed that daily quest today. - "+c:b==OprateResult.INVALIDREASON_QUEST_FINISH_ALL_RIHUAN?" 任务 - 完成所有日环任务了 - "+c:"未知错误1  OPERTE_TYPE_QUEST "+b+"    "+c:a==OprateResult.OPERTE_TYPE_NPCBUY?b==OprateResult.QUEST_TYPE_PROCESS?" 购买商品 - 任务进度, 名字:1/1 - "+c:"未知错误1  OPERTE_TYPE_NPCBUY "+b+"    "+c:a==OprateResult.OPERTE_TYPE_FUBEN?b==OprateResult.NPC_BUY_ITEM_NO_EXIST?" 副本 - 物品不存在 - "+c:b==OprateResult.NPC_BUY_ITEM_UNDER?" 副本 - 下架的物品 - "+c:b==OprateResult.NPC_BUY_ITEM_NO_OPEN?" 副本 - 商品还未到开放时间 - "+c:b==OprateResult.NPC_BUY_ITEM_OUT_TIME?" 副本 - 商品已过期 - "+c:b==OprateResult.NPC_BUY_BAG_OUT_SIZE?" 副本 - 包裹放不下了 - "+c:b==OprateResult.NPC_BUY_MONEY_NO_ENOUGH?" 副本 - 钱不够了 - "+c:b==OprateResult.NPC_BUY_MONEY_TRANSFINITE?" 副本 - 购买金额过大 - "+c:b==OprateResult.NPC_BUY_SELL_OUT?" 副本 - 超出商品限购次数 - "+c:"未知错误1  OPERTE_TYPE_FUBEN "+b+"    "+c:a==OprateResult.OPERTE_TYPE_KUAFU?b==OprateResult.FUBEN_OPRATE_NO_GROUP_STATE?" 跨服 - 玩家不在组队状态 - "+c:b==OprateResult.FUBEN_OPRATE_NOT_TWO_PEOPLE?" 跨服 - 队伍不是2个人 - "+c:b==OprateResult.FUBEN_OPRATE_NO_ENERGY?" 跨服 - 体力不足 - "+c:b==OprateResult.FUBEN_OPRATE_NO_MONEY?" 跨服 - 元宝不足 - "+c:b==OprateResult.FUBEN_OPRATE_TEAM_NO_LEVEL?" 跨服 - 队友等级不足 - "+c:b==OprateResult.FUBEN_OPRATE_TEAM_NO_ENERGY?" 跨服 - 队友体力不足 - "+c:b==OprateResult.FUBEN_OPRATE_NO_GROUP?" 跨服 - 队伍已经解散 - "+c:b==OprateResult.FUBEN_OPRATE_SEND_TEAM_FRIEND?" 跨服 - 邀请队友进入组队副本 - "+c:b==OprateResult.FUBEN_OPRATE_TEAM_REFUSE_ENETR?" 跨服 - 队友拒绝进入组队副本 - "+c:b==OprateResult.FUBEN_OPRATE_TEAM_ON_FUBEN_MAP?" 跨服 - 队友在副本地图中 - "+c:b==OprateResult.FUBEN_OPRATE_TEAM_HAVE_FLAGS?" 跨服 - 队友已经发起邀请了 - "+c:b==OprateResult.FUBEN_OPRATE_REFRESH_BOSS?" 跨服 - 副本刷出boss - "+c:b==OprateResult.FUBEN_OPRATE_KILLED_BOSS?" 跨服 - 玩家成功击杀了boss - "+c:b==OprateResult.FUBEN_OPRATE_MORE_TIMES?" 跨服 - 全屏秒杀超过最大次数 - "+c:b==OprateResult.FUBEN_OPRATE_NO_CREATURES?" 跨服 - 全屏秒杀当前没有怪物 - "+c:"未知错误1  OPERTE_TYPE_KUAFU "+b+"    "+c:a==OprateResult.OPERTE_TYPE_RANK_LIST?b==OprateResult.KUAFU_OPERATE_CONN_DISCONN?" 排行榜 - 游戏服与世界服的链接断开了 - "+c:b==OprateResult.KUAFU_OPERATE_HASNOT_REGISTER?" 排行榜 - 本服还没有向世界服注册成功 - "+c:"未知错误1  OPERTE_TYPE_RANK_LIST "+b+"    "+c:a==OprateResult.OPERTE_TYPE_CLOSE?b==OprateResult.RANK_LIST_OPERATE_SUCCEED?" 连接关闭 - 成功 - "+c:b==OprateResult.RANK_LIST_OPERATE_TYPE_ERROR?" 连接关闭 - 查询类型错误 - "+c:b==OprateResult.RANK_LIST_OPERATE_OUT_OF_RANGE?" 连接关闭 - 查询范围超出界限 - "+c:b==OprateResult.RANK_LIST_OPERATE_MAX_LIKE?" 连接关闭 - 点赞已超过最大次数 - "+c:b==OprateResult.RANK_LIST_OPERATE_HAS_LIKE?" 连接关闭 - 已点过赞了 - "+c:"未知错误1  OPERTE_TYPE_CLOSE "+b+"    "+c:a==OprateResult.OPERTE_TYPE_HOSTING?b==OprateResult.ACTIVITY_OPERATE_NOTVIP?" 托管 - 你不是vip无法领取vip奖励 - "+c:b==OprateResult.ACTIVITY_OPERATE_NOENOUGH?" 托管 - 活跃度不够无法领取 - "+c:b==OprateResult.ACTIVITY_OPERATE_HASGET?" 托管 - 已经领取过该奖励 - "+c:"未知错误1  OPERTE_TYPE_HOSTING "+b+"    "+c:a==OprateResult.OPERTE_TYPE_STRENGTH?b==OprateResult.ACHIEVE_OPERATE_NO_FIND?" 强化 - 找不到成就 - "+c:b==OprateResult.ACHIEVE_OPERATE_NO_GET?" 强化 - 尚未达成成就 - "+c:b==OprateResult.ACHIEVE_OPERATE_HASGET?" 强化 - 已经领取过成就奖励 - "+c:b==OprateResult.ACHIEVE_OPERATE_NO_ALL?" 强化 - 总成就不够无法领取 - "+c:b==OprateResult.ACHIEVE_OPERATE_TITLE_SUC?" 强化 - 设置称号成功 - "+c:b==OprateResult.ACHIEVE_OPERATE_TITLE_FAL?" 强化 - 称号不存在无法设置 - "+c:b==OprateResult.ACHIEVE_OPERATE_NO_MONEY?" 强化 - 钱不够了不能找回 - "+c:"未知错误1  OPERTE_TYPE_STRENGTH "+b+"    "+c:a==OprateResult.OPERTE_TYPE_CHANGE_BATTLE_MODE_LOSE?b==OprateResult.ATHLETICS_OPERATE_NO_LEV?" 切换战斗模式失败 - 等级不够{1}，不能参加3v3 - "+c:b==OprateResult.ATHLETICS_OPERATE_NO_FORCE?" 切换战斗模式失败 - 战力不够{1}，不能参加3v3 - "+c:b==OprateResult.ATHLETICS_OPERATE_NO_OPEN?" 切换战斗模式失败 - 不在活动时间，不能参加 - "+c:b==OprateResult.ATHLETICS_OPERATE_NO_TIME_BUY?" 切换战斗模式失败 - 3v3次数已用完，可以购买次数 - "+c:b==OprateResult.ATHLETICS_OPERATE_NO_TIME?" 切换战斗模式失败 - 3v3次数已用完，请明天再来 - "+c:b==OprateResult.ATHLETICS_OPERATE_IN_MATCH?" 切换战斗模式失败 - 正在匹配中 - "+c:b==OprateResult.ATHLETICS_OPERATE_MAX_BUY?" 切换战斗模式失败 - 超出最大购买次数 - "+c:b==OprateResult.ATHLETICS_OPERATE_NO_MONEY?" 切换战斗模式失败 - 超出最大购买次数 - "+c:b==OprateResult.ATHLETICS_OPERATE_HAS_DAY_REWARD?" 切换战斗模式失败 - 已经领取该奖励 - "+c:b==OprateResult.ATHLETICS_OPERATE_NO_DAY_REWARD?" 切换战斗模式失败 - 尚未到达次数{1} - "+c:"未知错误1  OPERTE_TYPE_CHANGE_BATTLE_MODE_LOSE "+b+"    "+c:a==OprateResult.OPERTE_TYPE_SOCIAL?b==OprateResult.ATHLETICS_OPERATE_BUFF_OCCUR?" 社交 - buff产生 - "+c:"未知错误1  OPERTE_TYPE_SOCIAL "+b+"    "+c:a==OprateResult.OPERTE_TYPE_FACTION?b==OprateResult.DOUJIAN_OPERATE_NO_LEV?" 帮派 - 等级不够，需要{0}才能参与斗剑台 - "+c:b==OprateResult.DOUJIAN_OPERATE_ZHUCHENG?" 帮派 - 只能在主城中参加活动 - "+c:b==OprateResult.DOUJIAN_OPERATE_NO_TIME?" 帮派 - 挑战次数已满 - "+c:b==OprateResult.DOUJIAN_OPERATE_IN_CD?" 帮派 - 挑战CD中 - "+c:b==OprateResult.DOUJIAN_OPERATE_MAX_TIME?" 帮派 - 超过最大购买次数 - "+c:b==OprateResult.DOUJIAN_OPERATE_NO_MONEY?" 帮派 - 元宝不足购买斗剑次数 - "+c:b==OprateResult.DOUJIAN_OPERATE_NO_MONEY_CD?" 帮派 - 元宝不足不能清理CD - "+c:"未知错误1  OPERTE_TYPE_FACTION "+b+"    "+c:a==OprateResult.OPERTE_TYPE_FIELD_BOSS?b==OprateResult.DOUJIAN_OPERATE_SELF_BATTLE?" 野外BOSS - 自己正在被别人挑战 - "+c:b==OprateResult.DOUJIAN_OPERATE_OTHER_BATTLE?" 野外BOSS - 挑战的人正在被别人挑战 - "+c:b==OprateResult.DOUJIAN_OPERATE_COUNTDOWN?" 野外BOSS - 刷新在冷却中 - "+c:b==OprateResult.DOUJIAN_OPERATE_REFRESH?" 野外BOSS - 刷新完成 - "+c:"未知错误1  OPERTE_TYPE_FIELD_BOSS "+b+"    "+c:a==OprateResult.OPERTE_TYPE_WORLD_BOSS?b==OprateResult.PLAYER_CLOSE_OPERTE_APPD_ONE1?" 世界BOSS - 插入单个物品时，包裹id 超过最大值 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_APPD_ONE2?" 世界BOSS - 创建玩家其他的对象的时候，发现之前已经创建过了 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_APPD_ONE3?" 世界BOSS - 托管到期 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_APPD_ONE4?" 世界BOSS - GM命令 踢人 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_APPD_ONE5?" 世界BOSS - GM命令 回档数据 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_APPD_ONE6?" 世界BOSS -  踢玩家下线 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE4?" 世界BOSS - 帐号信息不完整 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE5?" 世界BOSS - Char_Create put  fail! - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE6?" 世界BOSS - 登录时候不是我的角色 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE7?" 世界BOSS - 待定 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE8?" 世界BOSS - 跨服回来的玩家 m_player 不存在 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE9?" 世界BOSS - 初始化数据库数据失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE10?" 世界BOSS - 看看有没有玩家数据需要修复或者升级的 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE11?" 世界BOSS - 重设元宝数量 取数据时失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE12?" 世界BOSS - 踢人 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE13?" 世界BOSS - 如果连接不存在,则根据解开的session结果进行创建对应的session实例(on_create_conn_get_session create_sesstion duplicate) - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE14?" 世界BOSS - 客户端连接失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE15?" 世界BOSS - 把玩家由pk服回到游戏服,登录失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE16?" 世界BOSS - 检测跨服玩家是否可以登陆 -玩家不存在 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE17?" 世界BOSS - 检测跨服玩家是否可以登陆 -超时 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE18?" 世界BOSS - 登陆队列 context->GetGuid().empty(） - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE19?" 世界BOSS - 合服检测 手游下线 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE20?" 世界BOSS - 通知场景服玩家加入地图 m_scened_conn不存在 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE21?" 世界BOSS - 玩家加入地图实例时，玩家binlg不存在  - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE22?" 世界BOSS - 玩家加入地图 创建实例失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE23?" 世界BOSS - 如果已登录过 !m_account.empty() - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE24?" 世界BOSS - 帐号名称超长 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE25?" 世界BOSS - 验证是否可以登录本服验证失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE26?" 世界BOSS - 账户表数据不存在 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE27?" 世界BOSS - 玩家已在线关闭掉旧链接 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE28?" 世界BOSS - 手游登录，但是还没有玩家角色 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE39?" 世界BOSS - 数据准备完毕，玩家开始登录 玩家不存在 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE40?" 世界BOSS - 获取sessionKey对象,已经登录过 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE41?" 世界BOSS - 获取sessionKey对象，帐户名称，并且判断一下是否超长(超长则失败) - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE42?" 世界BOSS - 获取sessionKey对象，Get_Session: other_data size is wrong - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE43?" 世界BOSS - 获取sessionKey对象，验证session_key是否可以登录这个服务器（为不可登录时候断开） - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE44?" 世界BOSS - 获取sessionKey对象，LogindContext::Get_Session:%s load account fail(获取帐号表数据异常) - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE45?" 世界BOSS - 获取sessionKey对象，LogindContext::Get_Session:%s Get_Chars_List fail（获取角色列表数据异常） - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE46?" 世界BOSS - 跨服读取数据失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE47?" 世界BOSS - 运气不好，登录时碰上正在释放自己数据 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE48?" 世界BOSS - 合服检测，从服玩家状态 不为 STATUS_LOGGEDIN - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE49?" 世界BOSS - 封号 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE50?" 世界BOSS - 踢人 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE51?" 世界BOSS - 玩家不存在时关闭连接 LuaPlayerLogin %s, but not found - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE52?" 世界BOSS - 角色在其他地方登陆 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE53?" 世界BOSS - 登陆是无法获得数据 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE54?" 世界BOSS - 登陆时 player login call puts fail %s, fd %u - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE55?" 世界BOSS - on_create_conn_get_session create_mobile_context duplicate - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE56?" 世界BOSS - 登陆失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE57?" 世界BOSS - Gm命令 @自爆 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE58?" 世界BOSS - PK服登陆数据异常 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_ONE59?" 世界BOSS - 从数据库读取玩家数据失败 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_2046?" 世界BOSS - 一个角色对应两个账号	 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_2047?" 世界BOSS - 改名字的时候找不到account，刷新就可以过了 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_LOGDIN_2048?" 世界BOSS - session的account不等于player的account,简单来说,串号了. - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE29?" 世界BOSS - 停止移动，地图模板为null - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE30?" 世界BOSS - 对象移动，地图模板为null - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE31?" 世界BOSS - 对象移动的时候  状态不为 STATUS_LOGGEDIN  时候 （assert error: Handle_Unit_Move  ASSERT(status_ == STATUS_LOGGEDIN)） - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE32?" 世界BOSS - 传送是 状态不为 STATUS_LOGGEDIN （ScenedContext::Teleport status_ != STATUS_LOGGEDIN） - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE33?" 世界BOSS - 如果玩家未正确的加入地图，这个时间传送也是失败的 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE34?" 世界BOSS - 任务链条中断 assert error: Handle_QuestGiver_Status_Query  ASSERT(questGetter) - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE35?" 世界BOSS - 玩家被杀死时，地图数据不存在 Player::OnKilled ASSERT(GetMap()) - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE36?" 世界BOSS - 加入地图宠物不存在的时候  Player::OnJoinMap ASSERT(m_pets.empty()) - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE37?" 世界BOSS - 任务管理者不存在的时候 Player::Create ASSERT(!m_questMgr) - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_SCREND_ONE38?" 世界BOSS - 传送超时1分钟 - "+c:b==OprateResult.PLAYER_CLOSE_OPERTE_POLICED_4001?" 世界BOSS - 在日志服重复登录 - "+c:"未知错误1  OPERTE_TYPE_WORLD_BOSS "+b+"    "+c:a==OprateResult.OPRATE_TYPE_MOUNT_QICHENG?b==OprateResult.OPERTE_TYPE_FACTION_IS_HAVE?" 坐骑骑乘 - 你已经在帮派中 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_NAME_ERR?" 坐骑骑乘 - 帮派名称超过6个字符 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_NAME_HAVE_FUCK?" 坐骑骑乘 - 帮派名称中有非法字符 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_NAME_REPEAT?" 坐骑骑乘 - 帮派名称重复 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_CREATE_MAX?" 坐骑骑乘 - 帮派数量达到上限 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_CREATE_COST?" 坐骑骑乘 - 元宝不足无法创建帮派 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_NOT_MANAGER?" 坐骑骑乘 - 不是帮主或副帮主无法编辑 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_NOTICE_ERR?" 坐骑骑乘 - 帮派公告超过144个字符 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_NOTICE_ERR_PB?" 坐骑骑乘 - 帮派公告包含非法字符 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_LEV_LOW?" 坐骑骑乘 - 等级不够，不能加入帮派 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_MEMBER_MAX_COUNT?" 坐骑骑乘 - 帮派人数已满无法加入 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_JOIN_SUCESS?" 坐骑骑乘 - 恭喜你加入帮派 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_FACTION_REFUSED_JOIN?" 坐骑骑乘 - 你被拒绝加入帮派 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_KICKED?" 坐骑骑乘 - 你被移出帮派 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_KICK_SUCCESS?" 坐骑骑乘 - 踢出帮派成员 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_MAX_ZHIWEI?" 坐骑骑乘 - 职位人数已满 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_APPOINT_SUCCESS?" 坐骑骑乘 - 任命成功 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_PROMOTED?" 坐骑骑乘 - 你被任命为 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_APPOINT_NOSELF?" 坐骑骑乘 - 自己不能任命自己  - "+c:b==OprateResult.OPERTE_TYPE_FACTION_DONATIONMAX?" 坐骑骑乘 - 捐献次数超过最大次数 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_DONATION_GOLD?" 坐骑骑乘 - 捐献所需金币不够 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_DONATION_YB?" 坐骑骑乘 - 捐献所需元宝不够 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_SHOP_NUMLOW?" 坐骑骑乘 - 商品剩余数量不足无法购买 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_DEVOTE?" 坐骑骑乘 - 帮贡不足 - "+c:b==OprateResult.OPEATE_TYPE_FACTION_MONEY_ERR?" 坐骑骑乘 - 帮派资金不足 - "+c:b==OprateResult.OPEATE_TYPE_FACTION_LEVEL_UP?" 坐骑骑乘 - 帮派升级成功 - "+c:b==OprateResult.OPEATE_TYPE_FACTION_NOT_JOIN?" 坐骑骑乘 - 没有可以加入的帮派 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_PLAYER_OFFLINE?" 坐骑骑乘 - 对方不在线,无法加入成员 - "+c:"未知错误1  OPRATE_TYPE_MOUNT_QICHENG "+b+"    "+c:a==OprateResult.OPRATE_TYPE_TELEPORT?b==OprateResult.OPERTE_TYPE_FACTION_BOSS_START?" 传送 - 召唤boss - "+c:"未知错误1  OPRATE_TYPE_TELEPORT "+b+"    "+c:a==OprateResult.OPRATE_TYPE_UPGRADE?b==OprateResult.OPERTE_TYPE_FACTION_GIFT_THANK?" 游戏中的升级操作 - 感谢完成 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_GIFT_THANK_ALL?" 游戏中的升级操作 - 全部感谢完成 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_GIFT_GET_EXREWARD?" 游戏中的升级操作 - 领取成功 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_GIFT_GET_EXREWARD_ALL?" 游戏中的升级操作 - 全部领取成功 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_GIFT_SEND?" 游戏中的升级操作 - 赠送成功 - "+c:b==OprateResult.OPERTE_TYPE_FACTION_GIFT_SEND_FAIL?" 游戏中的升级操作 - 赠送成功 - "+c:"未知错误1  OPRATE_TYPE_UPGRADE "+b+"    "+c:a==OprateResult.OPRATE_TYPE_ACTIVITY?b==OprateResult.OPERTE_TYPE_FACTION_GIFT_NOTICE?" 活动 - 礼物广播 - "+c:"未知错误1  OPRATE_TYPE_ACTIVITY "+b+"    "+c:a==OprateResult.OPRATE_TYPE_ACHIEVE?b==OprateResult.OPERTE_TYPE_FACTION_BOSSDEFENSE_TIME_ERROR?" 成就 - 非法时间 无法挑战boss - "+c:b==OprateResult.OPERTE_TYPE_FACTION_NAME_NOT_CHINESE?" 成就 - 包含中文以外字符 - "+c:"未知错误1  OPRATE_TYPE_ACHIEVE "+b+"    "+c:a==OprateResult.OPRATE_TYPE_ATHLETICS?b==OprateResult.OPERTE_TYPE_SOCIAL_HAS_SEND?" 竞技 - 好友请求信息已发送 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_NOT_FIND?" 竞技 - 角色不存在或者角色不在线 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_SELF_FULL?" 竞技 - 自己好友列表已满 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_TARGET_FULL?" 竞技 - 对方好友列表已满 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_ALREADY_FRIEND?" 竞技 - 对方已经是你的好友 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_ADD_MYSELF?" 竞技 - 不能自己添加自己为好友 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_HAS_SEND_ADD?" 竞技 - 已经发送申请 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_NO_MONEY?" 竞技 - 元宝或者金币不足 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_NOT_ENEMY?" 竞技 - 对方不是仇人 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_ENEMY_OFFLINE?" 竞技 - 对方处于离线中 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_ENEMY_NOT_IN_FIELD?" 竞技 - 对方不在野外 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_REVENGE_TIMES_NOT_ENOUGH?" 竞技 - 复仇传送次数不足 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_RENAME_SUCCESS?" 竞技 - 改名成功 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_OTHNER_FACTION?" 竞技 - 对方已在帮派 - "+c:b==OprateResult.OPERTE_TYPE_SOCIAL_SAME_FACTION?" 竞技 - 对方已在同帮派 - "+c:"未知错误1  OPRATE_TYPE_ATHLETICS "+b+"    "+c:a==OprateResult.OPRATE_TYPE_XIANFU?b==OprateResult.HOSTING_OPERTE_IS_SELF?" 仙府夺宝 - 无法对自己操作 - "+c:b==OprateResult.HOSTING_OPERTE_LEVEL_NOT?" 仙府夺宝 - 等级不足 - "+c:b==OprateResult.HOSTING_OPERTE_IS_HOSTING?" 仙府夺宝 - 托管中 - "+c:b==OprateResult.HOSTING_OPERTE_IS_HOSTING_APPLY?" 仙府夺宝 - 托管申请 - "+c:b==OprateResult.HOSTING_OPERTE_FRIEND_NOT?" 仙府夺宝 - 好友不存在 - "+c:b==OprateResult.HOSTING_OPERTE_HAS_NOT_24H?" 仙府夺宝 - 还没到24小时 - "+c:b==OprateResult.HOSTING_OPERTE_FRIEND_OUTLINE?" 仙府夺宝 - 好友不在线 - "+c:b==OprateResult.HOSTING_OPERTE_FRIEND_ERR?" 仙府夺宝 - 托管好友错误 - "+c:b==OprateResult.HOSTING_OPERTE_NOT_HOSTING?" 仙府夺宝 - 不在托管中 - "+c:b==OprateResult.HOSTING_OPERTE_FRIEND_ONLINE?" 仙府夺宝 - 好友在线 - "+c:b==OprateResult.HOSTING_OPERTE_LOGIN_HOSTING?" 仙府夺宝 - 托管登录中 - "+c:b==OprateResult.HOSTING_OPERTE_FRIEND_APPLY?" 仙府夺宝 - 申请发送 - "+c:b==OprateResult.HOSTING_OPERTE_LOGIN?" 仙府夺宝 - 登录 - "+c:b==OprateResult.HOSTING_OPERTE_SUCCESS?" 仙府夺宝 - 托管申请成功 - "+c:b==OprateResult.HOSTING_OPERTE_CANCEL?" 仙府夺宝 - 取消托管 - "+c:b==OprateResult.HOSTING_OPERTE_REFUSED?" 仙府夺宝 - 拒绝托管 - "+c:b==OprateResult.HOSTING_OPERTE_NOT_DUE_TO?" 仙府夺宝 - 托管未到期 - "+c:b==OprateResult.HOSTING_OPERTE_FRIEND_HOSTING_LOGIN?" 仙府夺宝 - 对方托管登录中，无法操作 - "+c:b==OprateResult.HOSTING_OPERTE_FRIEND_NOT_HAS_YOU?" 仙府夺宝 - 对方好友列表没有你 - "+c:"未知错误1  OPRATE_TYPE_XIANFU "+b+"    "+c:a==OprateResult.OPRATE_TYPE_REWARD?b==OprateResult.STRENGTH_OPERTE_FAIL?" 获得物品 - 强化失败 - "+c:"未知错误1  OPRATE_TYPE_REWARD "+b+"    "+c:a==OprateResult.OPRATE_TYPE_DOUJIAN?b==OprateResult.BATTLE_MODE_OPERTE_PEACE_MODE_DENY?" 斗剑台 - 战斗中不能切换和平模式 - "+c:b==OprateResult.BATTLE_MODE_OPERTE_PEACE_MODE_IN_CD?" 斗剑台 - 和平模式在CD中 - "+c:"未知错误1  OPRATE_TYPE_DOUJIAN "+b+"    "+c:a==OprateResult.OPRATE_TYPE_GEM?b==OprateResult.FIELD_BOSS_OPERTE_WILL_START?" 宝石 - 野外BOSS即将在{1}分钟后开启, 请大家安排好时间 - "+c:b==OprateResult.FIELD_BOSS_OPERTE_WILL_OCCUR?" 宝石 - 野外boss即将出现，请各位大侠做好准备 - "+c:b==OprateResult.FIELD_BOSS_OPERTE_OCCUR?" 宝石 - 野外boss已经在各个地图刷新，请各位大侠火速前往击杀 查看详情 - "+c:b==OprateResult.FIELD_BOSS_OPERTE_BOSS_BORN?" 宝石 - {1}已出现在{2}，请各位大侠火速前往击杀 立即前往 - "+c:b==OprateResult.FIELD_BOSS_OPERTE_BOSS_KILL?" 宝石 - {1}已被成功击杀！恭喜{2}获得{3}1分钟的优先开启权利 - "+c:b==OprateResult.FIELD_BOSS_OPERTE_PROTECT?" 宝石 - 九龙宝箱保护时间结束，静待各位大侠开启 - "+c:b==OprateResult.FIELD_BOSS_OPERTE_PICKED?" 宝石 - 恭喜{1}最终开启九龙宝箱，获得XXXX - "+c:b==OprateResult.FIELD_BOSS_OPERTE_TOO_FAR?" 宝石 - 太远了，你不可能开启这个宝箱 - "+c:"未知错误1  OPRATE_TYPE_GEM "+b+"    "+c:a==OprateResult.OPRATE_TYPE_MONEYTREE?b==OprateResult.WORLD_BOSS_OPERTE_NOT_ENROLL?" 摇钱树 - 本次活动您未报名，无法参加 - "+c:b==OprateResult.WORLD_BOSS_OPERTE_WILL_START?" 摇钱树 - 世界boss即将开启，请各位大侠做好准备 - "+c:b==OprateResult.WORLD_BOSS_OPERTE_WILL_ROLL1?" 摇钱树 - 恭喜{1}赢得本次拼点奖励，BOSS在3秒后恢复正常 - "+c:b==OprateResult.WORLD_BOSS_OPERTE_WILL_ROLL2?" 摇钱树 - 恭喜{1}赢得本次拼点奖励，现在可自由离开战场 - "+c:b==OprateResult.WORLD_BOSS_OPERTE_ENROLL?" 摇钱树 - 世界BOSS开始报名 - "+c:"未知错误1  OPRATE_TYPE_MONEYTREE "+b+"    "+c:a==OprateResult.OPRATE_TYPE_NEED_NOTICE?b==OprateResult.MOUNT_QICHENG_FIGHT?" 需要跑马灯 - 战斗状态不能骑乘 - "+c:b==OprateResult.MOUNT_QICHENG_JUMP?" 需要跑马灯 - 跳跃状态不能骑乘 - "+c:"未知错误1  OPRATE_TYPE_NEED_NOTICE "+b+"    "+c:"未知错误2   "+a+"  "+b+"    "+c;
}function Base64(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=_utf8_encode(a);j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+_keyStr.charAt(e)+_keyStr.charAt(f)+_keyStr.charAt(g)+_keyStr.charAt(h);return i},this.decode=function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=_keyStr.indexOf(a.charAt(j++)),f=_keyStr.indexOf(a.charAt(j++)),g=_keyStr.indexOf(a.charAt(j++)),h=_keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=_utf8_decode(i)},_utf8_encode=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode=function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}}function hex_md5(a){return binl2hex(core_md5(str2binl(a),a.length*chrsz))}function b64_md5(a){return binl2b64(core_md5(str2binl(a),a.length*chrsz))}function str_md5(a){return binl2str(core_md5(str2binl(a),a.length*chrsz))}function hex_hmac_md5(a,b){return binl2hex(core_hmac_md5(a,b))}function b64_hmac_md5(a,b){return binl2b64(core_hmac_md5(a,b))}function str_hmac_md5(a,b){return binl2str(core_hmac_md5(a,b))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc")}function core_md5(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16){var h=c,i=d,j=e,k=f;c=md5_ff(c,d,e,f,a[g+0],7,-680876936),f=md5_ff(f,c,d,e,a[g+1],12,-389564586),e=md5_ff(e,f,c,d,a[g+2],17,606105819),d=md5_ff(d,e,f,c,a[g+3],22,-1044525330),c=md5_ff(c,d,e,f,a[g+4],7,-176418897),f=md5_ff(f,c,d,e,a[g+5],12,1200080426),e=md5_ff(e,f,c,d,a[g+6],17,-1473231341),d=md5_ff(d,e,f,c,a[g+7],22,-45705983),c=md5_ff(c,d,e,f,a[g+8],7,1770035416),f=md5_ff(f,c,d,e,a[g+9],12,-1958414417),e=md5_ff(e,f,c,d,a[g+10],17,-42063),d=md5_ff(d,e,f,c,a[g+11],22,-1990404162),c=md5_ff(c,d,e,f,a[g+12],7,1804603682),f=md5_ff(f,c,d,e,a[g+13],12,-40341101),e=md5_ff(e,f,c,d,a[g+14],17,-1502002290),d=md5_ff(d,e,f,c,a[g+15],22,1236535329),c=md5_gg(c,d,e,f,a[g+1],5,-165796510),f=md5_gg(f,c,d,e,a[g+6],9,-1069501632),e=md5_gg(e,f,c,d,a[g+11],14,643717713),d=md5_gg(d,e,f,c,a[g+0],20,-373897302),c=md5_gg(c,d,e,f,a[g+5],5,-701558691),f=md5_gg(f,c,d,e,a[g+10],9,38016083),e=md5_gg(e,f,c,d,a[g+15],14,-660478335),d=md5_gg(d,e,f,c,a[g+4],20,-405537848),c=md5_gg(c,d,e,f,a[g+9],5,568446438),f=md5_gg(f,c,d,e,a[g+14],9,-1019803690),e=md5_gg(e,f,c,d,a[g+3],14,-187363961),d=md5_gg(d,e,f,c,a[g+8],20,1163531501),c=md5_gg(c,d,e,f,a[g+13],5,-1444681467),f=md5_gg(f,c,d,e,a[g+2],9,-51403784),e=md5_gg(e,f,c,d,a[g+7],14,1735328473),d=md5_gg(d,e,f,c,a[g+12],20,-1926607734),c=md5_hh(c,d,e,f,a[g+5],4,-378558),f=md5_hh(f,c,d,e,a[g+8],11,-2022574463),e=md5_hh(e,f,c,d,a[g+11],16,1839030562),d=md5_hh(d,e,f,c,a[g+14],23,-35309556),c=md5_hh(c,d,e,f,a[g+1],4,-1530992060),f=md5_hh(f,c,d,e,a[g+4],11,1272893353),e=md5_hh(e,f,c,d,a[g+7],16,-155497632),d=md5_hh(d,e,f,c,a[g+10],23,-1094730640),c=md5_hh(c,d,e,f,a[g+13],4,681279174),f=md5_hh(f,c,d,e,a[g+0],11,-358537222),e=md5_hh(e,f,c,d,a[g+3],16,-722521979),d=md5_hh(d,e,f,c,a[g+6],23,76029189),c=md5_hh(c,d,e,f,a[g+9],4,-640364487),f=md5_hh(f,c,d,e,a[g+12],11,-421815835),e=md5_hh(e,f,c,d,a[g+15],16,530742520),d=md5_hh(d,e,f,c,a[g+2],23,-995338651),c=md5_ii(c,d,e,f,a[g+0],6,-198630844),f=md5_ii(f,c,d,e,a[g+7],10,1126891415),e=md5_ii(e,f,c,d,a[g+14],15,-1416354905),d=md5_ii(d,e,f,c,a[g+5],21,-57434055),c=md5_ii(c,d,e,f,a[g+12],6,1700485571),f=md5_ii(f,c,d,e,a[g+3],10,-1894986606),e=md5_ii(e,f,c,d,a[g+10],15,-1051523),d=md5_ii(d,e,f,c,a[g+1],21,-2054922799),c=md5_ii(c,d,e,f,a[g+8],6,1873313359),f=md5_ii(f,c,d,e,a[g+15],10,-30611744),e=md5_ii(e,f,c,d,a[g+6],15,-1560198380),d=md5_ii(d,e,f,c,a[g+13],21,1309151649),c=md5_ii(c,d,e,f,a[g+4],6,-145523070),f=md5_ii(f,c,d,e,a[g+11],10,-1120210379),e=md5_ii(e,f,c,d,a[g+2],15,718787259),d=md5_ii(d,e,f,c,a[g+9],21,-343485551),c=safe_add(c,h),d=safe_add(d,i),e=safe_add(e,j),f=safe_add(f,k)}return Array(c,d,e,f)}function md5_cmn(a,b,c,d,e,f){return safe_add(bit_rol(safe_add(safe_add(b,a),safe_add(d,f)),e),c)}function md5_ff(a,b,c,d,e,f,g){return md5_cmn(b&c|~b&d,a,b,e,f,g)}function md5_gg(a,b,c,d,e,f,g){return md5_cmn(b&d|c&~d,a,b,e,f,g)}function md5_hh(a,b,c,d,e,f,g){return md5_cmn(b^c^d,a,b,e,f,g)}function md5_ii(a,b,c,d,e,f,g){return md5_cmn(c^(b|~d),a,b,e,f,g)}function core_hmac_md5(a,b){var c=str2binl(a);c.length>16&&(c=core_md5(c,a.length*chrsz));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var g=core_md5(d.concat(str2binl(b)),512+b.length*chrsz);return core_md5(e.concat(g),640)}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function bit_rol(a,b){return a<<b|a>>>32-b}function str2binl(a){for(var b=Array(),c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<d%32;return b}function binl2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>d%32&c);return b}function binl2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>d%4*8+4&15)+b.charAt(a[d>>2]>>d%4*8&15);return c}function binl2b64(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0;d<4*a.length;d+=3)for(var e=(a[d>>2]>>8*(d%4)&255)<<16|(a[d+1>>2]>>8*((d+1)%4)&255)<<8|a[d+2>>2]>>8*((d+2)%4)&255,f=0;4>f;f++)c+=8*d+6*f>32*a.length?b64pad:b.charAt(e>>6*(3-f)&63);return c}function getKeyProById(a){return keyProp[a-1]}function getResName(a){return TableData.getInstance().getData(TableData.tb_item_template,a).name}function getProfessional(a){return professionalKey[a]}function getColorQua(a){return this.quaColorAry[a]}function getRoleUrl(a){return"role/"+a+getBaseUrl()+".txt"}function getRoleUIUrl(a){return"role/ui/"+a+getBaseUrl()+".txt"}function getSkillUrl(a){a&&0!=a.length||console.log("没有技能");var b="skill/"+a+getBaseUrl()+".txt";return b.replace(".txt","_byte.txt")}function getModelUrl(a){return"model/"+a+getBaseUrl()+".txt"}function getModelUIUrl(a){return"model/"+a+getBaseUrl()+".txt"}function getMapUrl(a){return"map/"+a+".txt"}function getfactionmapUrl(a){return"ui/load/map/world/"+a+".png"}function getZipMapUrl(a){return"map/"+a+"/"}function getactivityIconUrl(a){return"ui/load/activity/icon/"+a+".jpg"}function getTouPic(a){return"ui/tou/"+a%2+".png"}function getVipIconUrl(a){return"ui/load/Vip/"+a+".png"}function getExteriorIconUrl(a){return"ui/load/exterior/"+a+".png"}function getFactionBuildMapUrl(a){return"ui/load/map/factionbuildmap/"+a+".png"}function geteqiconIconUrl(a){return"ui/eqicon/"+a+".png"}function getstrongerIconUrl(a){return"ui/load/stronger/"+a+".png"}function getgemIconUrl(a){return"ui/load/gem/"+a+".png"}function getRoleIconUrl(a){return"ui/roleicon/"+a+".png"}function getStateUpIconUrl(a){return"ui/load/stateup/"+a+".png"}function getKaifuIconUrl(a){return"ui/load/kaifu/"+a+".png"}function getTeamcopyIconUrl(a){return"ui/load/teamcopy/"+a+".png"}function getSuccesspromptUrl(a){return"ui/load/toptip/txt/"+a+".png"}function getSkillIconUrl(a){return"ui/skillicon/"+a+".png"}function getEffectUIUrl(a){return"ui/load/effect/"+a+".png"}function getMountIconUrl(a){return"ui/load/mount/photo/"+a+".png"}function getload_IconUrl(a){return"ui/load/icon/"+a+".png"}function getload_FacBuildUrl(a){return"ui/load/faction/buildicon/"+a+".png"}function getload_LogingiftUrl(a){return"ui/load/Logingift/Name/"+a+".png"}function getload_LogingiftInfoUrl(a){return"ui/load/Logingift/Info/"+a+".png"}function getUIIconUrl(a){return"ui/uiicon/"+a+".png"}function getQueenIconUrl(a){return Scene_data.fileRoot+"ui/load/queen/"+a+".jpg"}function getUItimeOutUrl(a){return"ui/load/timeOut/"+a+".png"}function getUIpkGradeUrl(a){return"ui/load/pkGrade/"+a+".png"}function getUItittleUrl(a){return"ui/load/tittle/"+a+".png"}function getOutBossUiUrl(a,b){return b?"ui/tittlename/oboss/t_"+a+".png":"ui/tittlename/oboss/"+a+".png"}function getForceByAtt(a,b){for(var c=0,d=0;d<b.length;d++)c+=tb.TB_battle_force.get_TB_battle_forceById(a[d]).rate*b[d];return console.log("---NAN--",float2int(c/1e6)),float2int(c/1e6)}function Snum(a){return a>999999?float2int(a/1e4)+"万":a>999999999?float2int(a/1e8)+"亿":String(float2int(a))}function getvipadd(a){for(var b=tb.TB_vip_base.getTB_vip_base(),c=b[GuidData.player.getVipLevel()][a],d=GuidData.player.getVipLevel();d<b.length;d++){var e=b[d];if(c!=e[a])return console.log("----",c,a),"VIP"+e.id+"结算奖励增加"+e[a]+"%"}return console.log("----",c,a),"结算奖励增加"+b[b.length-1][a]+"%"}function converItem2Cost(a){var b=TableData.getInstance().getData(TableData.tb_item_template,a[0]).money_type;return[b,a[1]]}function getresIdByreward(a){return a}function getServerAndName(a){var b=a.split(",");return 3==b.length?b[1]+b[2]:a}function getBaseName(a){var b=a.split(",");return 3==b.length?b[2]:a}function getAvataByID(a){var b=tb.TB_creature_template.get_TB_creature_template(a);return b.avatar}function hasEnoughRes(a){return a[1]<=GuidData.player.getResType(a[0])}function costRes(a,b,c){void 0===c&&(c=null);var d=GuidData.player.getResType(a[0]);if(a[1]<=d)b();else if(a[0]==SharedDef.MONEY_TYPE_BIND_GOLD)if(d+=GuidData.player.getResType(SharedDef.MONEY_TYPE_GOLD_INGOT),a[1]<=d)AlertUtil.show("绑定元宝不足，将消耗元宝","消耗提示",function(a){1==a&&b()});else{var e=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);e.data=SharedDef.MONEY_TYPE_BIND_GOLD,ModuleEventManager.dispatchEvent(e),c&&c()}else{var e=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);e.data=a[0],ModuleEventManager.dispatchEvent(e),c&&c()}}function hasEnoughResItem(a){var b=tb.TB_item_template.get_TB_item_template(a[0]);return b?b.money_type>0?GuidData.player.getResType(b.money_type)>=a[1]:GuidData.bag.hasItem(a[0],a[1]):!1}function traceNoTabelData(){throw console.log("数据表无"),new Error("数据表无")}function get2dMappicById(a){return"pan/zymap2d/scene/"+a+"/maps/"}function get2dMapdataById(a){return"pan/zymap2d/maps/"+a+".txt"}(function(){"use strict";function a(a,b){var c=a.split("."),d=h;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function b(a){var b,c,d,e,f,g,h,j,k,l,m=a.length,n=0,o=Number.POSITIVE_INFINITY;for(j=0;m>j;++j)a[j]>n&&(n=a[j]),a[j]<o&&(o=a[j]);for(b=1<<n,c=new(i?Uint32Array:Array)(b),d=1,e=0,f=2;n>=d;){for(j=0;m>j;++j)if(a[j]===d){for(g=0,h=e,k=0;d>k;++k)g=g<<1|1&h,h>>=1;for(l=d<<16|j,k=g;b>k;k+=f)c[k]=l;++e}++d,e<<=1,f<<=1}return[c,n,o]}function c(a,b){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=i?new Uint8Array(a):a,this.m=!1,this.i=k,this.s=!1,(b||!(b={}))&&(b.index&&(this.a=b.index),b.bufferSize&&(this.h=b.bufferSize),b.bufferType&&(this.i=b.bufferType),b.resize&&(this.s=b.resize)),this.i){case j:this.b=32768,this.c=new(i?Uint8Array:Array)(32768+this.h+258);break;case k:this.b=0,this.c=new(i?Uint8Array:Array)(this.h),this.e=this.A,this.n=this.w,this.j=this.z;break;default:throw Error("invalid inflate mode")}}function d(a,b){for(var c,d=a.f,e=a.d,f=a.input,g=a.a,h=f.length;b>e;){if(g>=h)throw Error("input buffer is broken");d|=f[g++]<<e,e+=8}return c=d&(1<<b)-1,a.f=d>>>b,a.d=e-b,a.a=g,c}function e(a,b){for(var c,d,e=a.f,f=a.d,g=a.input,h=a.a,i=g.length,j=b[0],k=b[1];k>f&&!(h>=i);)e|=g[h++]<<f,f+=8;return c=j[e&(1<<k)-1],d=c>>>16,a.f=e>>d,a.d=f-d,a.a=h,65535&c}function f(a){function c(a,b,c){var f,g,h,i=this.q;for(h=0;a>h;)switch(f=e(this,b)){case 16:for(g=3+d(this,2);g--;)c[h++]=i;break;case 17:for(g=3+d(this,3);g--;)c[h++]=0;i=0;break;case 18:for(g=11+d(this,7);g--;)c[h++]=0;i=0;break;default:i=c[h++]=f}return this.q=i,c}var f,g,h,j,k=d(a,5)+257,l=d(a,5)+1,m=d(a,4)+4,n=new(i?Uint8Array:Array)(p.length);for(j=0;m>j;++j)n[p[j]]=d(a,3);if(!i)for(j=m,m=n.length;m>j;++j)n[p[j]]=0;f=b(n),g=new(i?Uint8Array:Array)(k),h=new(i?Uint8Array:Array)(l),a.q=0,a.j(b(c.call(a,k,f,g)),b(c.call(a,l,f,h)))}function g(a,b){var d,e;switch(this.input=a,this.a=0,(b||!(b={}))&&(b.index&&(this.a=b.index),b.verify&&(this.B=b.verify)),d=a[this.a++],e=a[this.a++],15&d){case E:this.method=E;break;default:throw Error("unsupported compression method")}if(0!==((d<<8)+e)%31)throw Error("invalid fcheck flag:"+((d<<8)+e)%31);if(32&e)throw Error("fdict flag is not supported");this.r=new c(a,{index:this.a,bufferSize:b.bufferSize,bufferType:b.bufferType,resize:b.resize})}var h=this,i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView,j=0,k=1,l={u:j,t:k};c.prototype.k=function(){for(;!this.m;){var a=d(this,3);switch(1&a&&(this.m=!0),a>>>=1){case 0:var b=this.input,c=this.a,e=this.c,g=this.b,h=b.length,l=void 0,m=void 0,n=e.length,o=void 0;if(this.d=this.f=0,c+1>=h)throw Error("invalid uncompressed block header: LEN");if(l=b[c++]|b[c++]<<8,c+1>=h)throw Error("invalid uncompressed block header: NLEN");if(m=b[c++]|b[c++]<<8,l===~m)throw Error("invalid uncompressed block header: length verify");if(c+l>b.length)throw Error("input buffer is broken");switch(this.i){case j:for(;g+l>e.length;){if(o=n-g,l-=o,i)e.set(b.subarray(c,c+o),g),g+=o,c+=o;else for(;o--;)e[g++]=b[c++];this.b=g,e=this.e(),g=this.b}break;case k:for(;g+l>e.length;)e=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(i)e.set(b.subarray(c,c+l),g),g+=l,c+=l;else for(;l--;)e[g++]=b[c++];this.a=c,this.b=g,this.c=e;break;case 1:this.j(B,D);break;case 2:f(this);break;default:throw Error("unknown BTYPE: "+a)}}return this.n()};var m,n,o=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=i?new Uint16Array(o):o,q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],r=i?new Uint16Array(q):q,s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],t=i?new Uint8Array(s):s,u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],v=i?new Uint16Array(u):u,w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=i?new Uint8Array(w):w,y=new(i?Uint8Array:Array)(288);for(m=0,n=y.length;n>m;++m)y[m]=143>=m?8:255>=m?9:279>=m?7:8;var z,A,B=b(y),C=new(i?Uint8Array:Array)(30);for(z=0,A=C.length;A>z;++z)C[z]=5;var D=b(C);c.prototype.j=function(a,b){var c=this.c,f=this.b;this.o=a;for(var g,h,i,j,k=c.length-258;256!==(g=e(this,a));)if(256>g)f>=k&&(this.b=f,c=this.e(),f=this.b),c[f++]=g;else for(h=g-257,j=r[h],0<t[h]&&(j+=d(this,t[h])),g=e(this,b),i=v[g],0<x[g]&&(i+=d(this,x[g])),f>=k&&(this.b=f,c=this.e(),f=this.b);j--;)c[f]=c[f++-i];for(;8<=this.d;)this.d-=8,this.a--;this.b=f},c.prototype.z=function(a,b){var c=this.c,f=this.b;this.o=a;for(var g,h,i,j,k=c.length;256!==(g=e(this,a));)if(256>g)f>=k&&(c=this.e(),k=c.length),c[f++]=g;else for(h=g-257,j=r[h],0<t[h]&&(j+=d(this,t[h])),g=e(this,b),i=v[g],0<x[g]&&(i+=d(this,x[g])),f+j>k&&(c=this.e(),k=c.length);j--;)c[f]=c[f++-i];for(;8<=this.d;)this.d-=8,this.a--;this.b=f},c.prototype.e=function(){var a,b,c=new(i?Uint8Array:Array)(this.b-32768),d=this.b-32768,e=this.c;if(i)c.set(e.subarray(32768,c.length));else for(a=0,b=c.length;b>a;++a)c[a]=e[a+32768];if(this.g.push(c),this.l+=c.length,i)e.set(e.subarray(d,d+32768));else for(a=0;32768>a;++a)e[a]=e[d+a];return this.b=32768,e},c.prototype.A=function(a){var b,c,d,e,f=this.input.length/this.a+1|0,g=this.input,h=this.c;return a&&("number"==typeof a.p&&(f=a.p),"number"==typeof a.v&&(f+=a.v)),2>f?(c=(g.length-this.a)/this.o[2],e=258*(c/2)|0,d=e<h.length?h.length+e:h.length<<1):d=h.length*f,i?(b=new Uint8Array(d),b.set(h)):b=h,this.c=b},c.prototype.n=function(){var a,b,c,d,e,f=0,g=this.c,h=this.g,j=new(i?Uint8Array:Array)(this.l+(this.b-32768));if(0===h.length)return i?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(b=0,c=h.length;c>b;++b)for(a=h[b],d=0,e=a.length;e>d;++d)j[f++]=a[d];for(b=32768,c=this.b;c>b;++b)j[f++]=g[b];return this.g=[],this.buffer=j},c.prototype.w=function(){var a,b=this.b;return i?this.s?(a=new Uint8Array(b),a.set(this.c.subarray(0,b))):a=this.c.subarray(0,b):(this.c.length>b&&(this.c.length=b),a=this.c),this.buffer=a},g.prototype.k=function(){var a,b,c=this.input;if(a=this.r.k(),this.a=this.r.a,this.B){b=(c[this.a++]<<24|c[this.a++]<<16|c[this.a++]<<8|c[this.a++])>>>0;var d=a;if("string"==typeof d){var e,f,g=d.split("");for(e=0,f=g.length;f>e;e++)g[e]=(255&g[e].charCodeAt(0))>>>0;d=g}for(var h,i=1,j=0,k=d.length,l=0;k>0;){h=k>1024?1024:k,k-=h;do i+=d[l++],j+=i;while(--h);i%=65521,j%=65521}if(b!==(j<<16|i)>>>0)throw Error("invalid adler-32 checksum")}return a};var E=8;a("Zlib.Inflate",g),a("Zlib.Inflate.prototype.decompress",g.prototype.k);var F,G,H,I,J={ADAPTIVE:l.t,BLOCK:l.u};if(Object.keys)F=Object.keys(J);else for(G in F=[],H=0,J)F[H++]=G;for(H=0,I=F.length;I>H;++H)G=F[H],a("Zlib.Inflate.BufferType."+G,J[G])}).call(this);var BaseEvent=function(){function a(a){this.type=a}return a.COMPLETE="complete",a}(),EventDispatcher=function(){function a(){this._eventsMap=null}return a.prototype.addEventListener=function(a,b,c){this._eventsMap||(this._eventsMap=new Object);var d=this._eventsMap[a];d||(d=this._eventsMap[a]=[]);for(var e={listener:b,thisObject:c},f=0;f<d.length;f++){var g=d[f];if(g.listener==b&&g.thisObject==c)return}d.push(e)},a.prototype.removeEventListener=function(a,b,c){if(null!=this._eventsMap)for(var d=this._eventsMap[a],e=0;d&&e<d.length;e++){var f=d[e];if(f.listener==b&&f.thisObject==c)return void d.splice(e,1)}},a.prototype.dispatchEvent=function(a){var b=this._eventsMap;if(!b)return!0;var c=b[a.type];if(!c)return!0;var d=c.length;if(0==d)return!0;a.target=this;for(var e=0;d>e;e++){var f=c[e];f.listener.call(f.thisObject,a)}},a}(),GC=function(){function a(){}return a.prototype.destory=function(){},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ResCount=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._useNum=0,b.idleTime=0,b}return __extends(b,a),Object.defineProperty(b.prototype,"useNum",{get:function(){return this._useNum},set:function(a){this._useNum=a,0==this._useNum&&(this.idleTime=0)},enumerable:!0,configurable:!0}),b.prototype.clearUseNum=function(){this._useNum--,this._useNum<=0&&(this.idleTime=b.GCTime)},b.GCTime=2,b}(GC),ResGC=function(){function a(){var a=this;this._dic=new Object,TimeUtil.addTimeTick(1e8,function(){a.gc()})}return a.prototype.gc=function(){for(var a in this._dic){var b=this._dic[a];b.useNum<=0&&(b.idleTime++,b.idleTime>=ResCount.GCTime&&(console.log("清理 -"+a),b.destory(),delete this._dic[a]))}},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Object3D=function(a){function b(b,c,d){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0);var e=a.call(this)||this;return e._x=b,e._y=c,e._z=d,e._scaleX=1,e._scaleY=1,e._scaleZ=1,e._rotationX=0,e._rotationY=0,e._rotationZ=0,e.posMatrix=new Matrix3D,e}return __extends(b,a),b.prototype.toString=function(){return"Object3D("+String(this._x)+","+String(this._y)+","+String(this._z)+")"},Object.defineProperty(b.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this._z},set:function(a){this._z=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scale",{set:function(a){this._scaleX=this._scaleY=this._scaleZ=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scaleX",{get:function(){return this._scaleX},set:function(a){this._scaleX=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scaleY",{get:function(){return this._scaleY},set:function(a){this._scaleY=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scaleZ",{get:function(){return this._scaleZ},set:function(a){this._scaleZ=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"rotationX",{get:function(){return this._rotationX},set:function(a){this._rotationX=a,this.updateMatrix(),this.updateRotationMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"rotationY",{get:function(){return this._rotationY},set:function(a){this._rotationY=a,this.updateMatrix(),this.updateRotationMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"rotationZ",{get:function(){return this._rotationZ},set:function(a){this._rotationZ=a,this.updateMatrix(),this.updateRotationMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"px",{get:function(){return 0},set:function(a){},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"py",{get:function(){return 0},set:function(a){},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"pz",{get:function(){return 0},set:function(a){},enumerable:!0,configurable:!0}),b.prototype.updateMatrix=function(){this.posMatrix.identity(),this.posMatrix.appendScale(this._scaleX,this._scaleY,this._scaleZ),this.posMatrix.appendRotation(this._rotationX,Vector3D.X_AXIS),this.posMatrix.appendRotation(this._rotationY,Vector3D.Y_AXIS),this.posMatrix.appendRotation(this._rotationZ,Vector3D.Z_AXIS),this.posMatrix.appendTranslation(this._x,this._y,this._z)},b.prototype.updateRotationMatrix=function(){},b}(EventDispatcher),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Camera3D=function(a){function b(){var b=a.call(this)||this;return b._distance=500,b.offset=new Vector3D,b.lastFoucs3D=new Vector3D,b.needChange=!0,b.cameraMatrix=new Matrix3D,b}return __extends(b,a),Object.defineProperty(b.prototype,"distance",{get:function(){return this._distance},set:function(a){this._distance=a},enumerable:!0,configurable:!0}),b.prototype.lookAt=function(a){this.lookAtTarget=a},Object.defineProperty(b.prototype,"astarRect",{set:function(a){this._astarRect=new Rectangle,this._astarRect.x=a.x,this._astarRect.y=a.y,this._astarRect.width=a.width,this._astarRect.height=a.height,this._midPos=new Vector3D,this._midPos.x=this._astarRect.x+this._astarRect.width/2,this._midPos.z=this._astarRect.y+this._astarRect.height/2,this._scaleVec=new Vector3D,this._scaleVec.x=(this._astarRect.width-100)/this._astarRect.width,this._scaleVec.z=(this._astarRect.height-100)/this._astarRect.height},enumerable:!0,configurable:!0}),b.prototype.update=function(){if(this.lookAtTarget){var a=28;if(this._astarRect&&this._astarRect.width<600){var b=new Vector3D;b.x=(this.lookAtTarget.px-this._midPos.x)*this._scaleVec.x+this._midPos.x,b.z=(this.lookAtTarget.pz-this._midPos.z)*this._scaleVec.z+this._midPos.z,b.y=this.lookAtTarget.py,Scene_data.focus3D.x=b.x,Scene_data.focus3D.y=b.y+a,Scene_data.focus3D.z=b.z}else Scene_data.focus3D.x=this.lookAtTarget.px,Scene_data.focus3D.y=this.lookAtTarget.py+a,Scene_data.focus3D.z=this.lookAtTarget.pz;this.lastFoucs3D.x!=Scene_data.focus3D.x||this.lastFoucs3D.y!=Scene_data.focus3D.y||this.lastFoucs3D.z!=Scene_data.focus3D.z?(this.lastFoucs3D.x=Scene_data.focus3D.x,this.lastFoucs3D.y=Scene_data.focus3D.y,this.lastFoucs3D.z=Scene_data.focus3D.z,this.needChange=!0):this.needChange=!1}},Object.defineProperty(b.prototype,"postion",{get:function(){return new Vector3D(this.x,this.y,this.z)},enumerable:!0,configurable:!0}),b}(Object3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ObjData=function(a){function b(){var b=a.call(this)||this;return b.vertices=new Array,b.uvs=new Array,b.indexs=new Array,b.lightuvs=new Array,b.normals=new Array,b.tangents=new Array,b.bitangents=new Array,b.treNum=0,b.compressBuffer=!1,b.hasdispose=!1,b}return __extends(b,a),b.prototype.destory=function(){this.vertices.length=0,this.vertices=null,this.uvs.length=0,this.uvs=null,this.indexs.length=0,this.indexs=null,this.lightuvs.length=0,this.lightuvs=null,this.normals.length=0,this.normals=null,this.tangents.length=0,this.tangents=null,this.bitangents.length=0,this.bitangents=null,this.vertexBuffer&&(Scene_data.context3D.deleteBuffer(this.vertexBuffer),this.vertexBuffer=null),this.uvBuffer&&(Scene_data.context3D.deleteBuffer(this.uvBuffer),this.uvBuffer=null),this.indexBuffer&&(Scene_data.context3D.deleteBuffer(this.indexBuffer),this.indexBuffer=null),this.lightUvBuffer&&(Scene_data.context3D.deleteBuffer(this.lightUvBuffer),this.lightUvBuffer=null),this.normalsBuffer&&(Scene_data.context3D.deleteBuffer(this.normalsBuffer),this.normalsBuffer=null),this.tangentBuffer&&(Scene_data.context3D.deleteBuffer(this.tangentBuffer),this.tangentBuffer=null),this.bitangentBuffer&&(Scene_data.context3D.deleteBuffer(this.bitangentBuffer),this.bitangentBuffer=null),this.hasdispose=!0},b}(ResCount),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MeshData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.boneIDAry=new Array,b.boneWeightAry=new Array,b.boneNewIDAry=new Array,b.particleAry=new Array,b}return __extends(b,a),b.prototype.destory=function(){a.prototype.destory.call(this),this.materialParam&&(this.materialParam.destory(),this.materialParam=null,this.materialParamData=null),this.boneIDAry.length=0,this.boneWeightAry.length=0,this.boneNewIDAry.length=0,this.boneIDAry=null,this.boneWeightAry=null,this.boneNewIDAry=null,this.boneWeightBuffer&&(Scene_data.context3D.deleteBuffer(this.boneWeightBuffer),this.boneWeightBuffer=null),this.boneIdBuffer&&(Scene_data.context3D.deleteBuffer(this.boneIdBuffer),this.boneIdBuffer=null),this.material&&this.material.clearUseNum(),this.particleAry.length=0,this.particleAry=null},b}(ObjData),BindParticle=function(){function a(a,b){this.url=a,this.socketName=b}return a}(),Dictionary=function(){function a(a){this._keys=new Array,this._values=new Array;for(var b=0;a&&b<a.length;b++)this[a[b].key]=a[b].value,this._keys.push(a[b].key),this._values.push(a[b].value)}return a.prototype.add=function(a,b){this[a]=b,this._keys.push(a),this._values.push(b)},a.prototype.has=function(a){return this[a]?!0:!1},a.prototype.remove=function(a){var b=this._keys.indexOf(a,0);this._keys.splice(b,1),this._values.splice(b,1),delete this[a]},a.prototype.keys=function(){return this._keys},a.prototype.values=function(){return this._values},a.prototype.containsKey=function(a){return"undefined"==typeof this[a]?!1:!0},a.prototype.toLookup=function(){return this},a}(),WeakSet=function(){function a(){this._item=new Array}return a.prototype.add=function(a){this._item.push(a)},a.prototype.has=function(a){for(var b=0;b<this._item.length;b++)if(this._item[b]==a)return!0;return!1},a}(),ColorType=function(){function a(){}return a.Orange7a2f21="[7a2f21]",a.Orange9a683f="[9a683f]",a.Orange853d07="[853d07]",a.Brown6a4936="[6a4936]",a.Brown623424="[623424]",a.Brownac8965="[ac8965]",a.Reddb4051="[db4051]",a.Redd92200="[d92200]",a.Redff0000="[ff0000]",a.Brownd8d49c="[d8d49c]",a.color843b11="[843b11]",a.colorb96d49="[b96d49]",a.colorcd2000="[cd2000]",a.colorfef3d7="[fef3d7]",a.color9a683f="[9a683f]",a.Brown7a2f21="[7a2f21]",a.Brown40120a="[40120a]",a.Brown491207="[491207]",a.Brown541616="[541616]",a.Browndf9a68="[df9a68]",a.Browndb39264="[b39264]",a.colorefe4c4="[efe4c4]",a.color802626="[802626]",a.color9f7b4d="[9f7b4d]",a.color4b0808="[4b0808]",a.color5f5c59="[5f5c59]",a.color903713="[903713]",a.Green98ec2c="[98ec2c]",a.Green56da35="[56da35]",a.Green20a200="[20a200]",a.Greenadff00="[adff00]",a.Green2ca937="[2ca937]",a.Green464b11="[464b11]",a.Green54db36="[54db36]",a.Yellowf7d253="[f7d253]",a.Yellowffecc6="[ffecc6]",a.Yellowffd500="[ffd500]",a.Yellowffe9b4="[ffe9b4]",a.Yellowedce7e="[edce7e]",a.color4c1c07="[4c1c07]",a.Whiteffffff="[ffffff]",a.Whitefffce6="[fffce6]",a.Whitefff7db="[fff7db]",a.White9A683F="[9A683F]",a.Black000000="[000000]",a.Whitefff4d6="[fff4d6]",a.Whiteffeed0="[ffeed0]",a.Whiteffeec9="[ffeec9]",a.Coffeeff9200="[ff9200]",a.color2daa35="[2daa35]",a.color4392ff="[4392ff]",a.colorb759ff="[b759ff]",a.colorff7200="[ff7200]",a.colorce0a00="[ce0a00]",a.coloraa874a="[aa874a]",a.colorffecc6="[ffecc6]",a.colorfde87e="[fde87e]",a.colord6e7ff="[d6e7ff]",a.colord27262e="[27262e]",a.colorffe9b4="[ffe9b4]",a.color9c9b9b="[9c9b9b]",a}(),BitMapData=function(){function a(a,b){this.width=a,this.height=b;var c=UIManager.getInstance().getContext2D(this.width,this.height,!1);this.imgData=c.getImageData(0,0,this.width,this.height);for(var d=0;d<this.imgData.data.length;d+=4)this.imgData.data[d+0]=255,this.imgData.data[d+1]=255,this.imgData.data[d+2]=255,this.imgData.data[d+3]=255}return a.prototype.getIndexByPos=function(a,b){var c=b*this.width+a;return 4*c},a.prototype.setRgb=function(a,b,c){a=Math.round(a),b=Math.round(b);var d=this.getIndexByPos(a,b);this.imgData.data[d+0]=255*c.x,this.imgData.data[d+1]=255*c.y,this.imgData.data[d+2]=255*c.z,this.imgData.data[d+3]=255},a.prototype.getRgb=function(a,b){a=Math.round(a),b=Math.round(b);var c=new Vector3D,d=this.getIndexByPos(a,b);return c.x=this.imgData.data[d+0]/255,c.y=this.imgData.data[d+1]/255,c.z=this.imgData.data[d+2]/255,c.w=1,c},a}(),Context3D=function(){function a(){this.setTextureNum=0,this.setProgramNum=0}return a.prototype.init=function(a){var b=a.getContext("webgl",{stencil:!0,alpha:!0,depth:!0,antialias:!1})||a.getContext("experimental-webgl",{stencil:!0,alpha:!0,depth:!0,antialias:!1});this.renderContext=b,this._contextSetTest=new ContextSetTest},a.prototype.resetSize=function(a,b){this.renderContext.viewport(0,0,a,b)},a.prototype.uploadBuff3D=function(a){var b=this.renderContext.createBuffer();return this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,b),this.renderContext.bufferData(this.renderContext.ARRAY_BUFFER,new Float32Array(a),this.renderContext.STATIC_DRAW),b},a.prototype.uploadBuff3DArrayBuffer=function(a){var b=this.renderContext.createBuffer();return this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,b),this.renderContext.bufferData(this.renderContext.ARRAY_BUFFER,a,this.renderContext.STATIC_DRAW),
b},a.prototype.uploadBuff3DByBuffer=function(a,b){this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,a),this.renderContext.bufferData(this.renderContext.ARRAY_BUFFER,new Float32Array(b),this.renderContext.STATIC_DRAW)},a.prototype.uploadIndexBuff3D=function(a){var b=this.renderContext.createBuffer();return this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,b),this.renderContext.bufferData(this.renderContext.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),this.renderContext.STATIC_DRAW),b},a.prototype.uploadIndexBuff3DByBuffer=function(a,b){this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,a),this.renderContext.bufferData(this.renderContext.ELEMENT_ARRAY_BUFFER,new Uint16Array(b),this.renderContext.STATIC_DRAW)},a.prototype.clearContext=function(){this.renderContext.depthMask(!0),this.renderContext.clear(this.renderContext.COLOR_BUFFER_BIT|this.renderContext.DEPTH_BUFFER_BIT|this.renderContext.STENCIL_BUFFER_BIT)},a.prototype.update=function(){this._contextSetTest.clear(),this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,null),this.renderContext.clearColor(63/255,63/255,63/255,1),this.renderContext.clearDepth(1),this.renderContext.clearStencil(0),this.renderContext.enable(this.renderContext.DEPTH_TEST),this.renderContext.depthMask(!0),this.renderContext.enable(this.renderContext.BLEND),this.renderContext.frontFace(this.renderContext.CW),this.renderContext.clear(this.renderContext.COLOR_BUFFER_BIT|this.renderContext.DEPTH_BUFFER_BIT|this.renderContext.STENCIL_BUFFER_BIT),this.setBlendParticleFactors(0),this.renderContext.disable(this.renderContext.CULL_FACE),this.setTextureNum=0,this.setProgramNum=0},a.prototype.updateFBO=function(a){this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,a.frameBuffer),this.renderContext.clearColor(63/255,63/255,63/255,1),this.renderContext.clearDepth(1),this.renderContext.clearStencil(0),this.renderContext.enable(this.renderContext.DEPTH_TEST),this.renderContext.depthMask(!0),this.renderContext.enable(this.renderContext.BLEND),this.renderContext.frontFace(this.renderContext.CW),this.renderContext.clear(this.renderContext.COLOR_BUFFER_BIT|this.renderContext.DEPTH_BUFFER_BIT|this.renderContext.STENCIL_BUFFER_BIT),this.setBlendParticleFactors(0),this.renderContext.disable(this.renderContext.CULL_FACE)},a.prototype.setDepthTest=function(a){a?this.renderContext.enable(this.renderContext.DEPTH_TEST):this.renderContext.disable(this.renderContext.DEPTH_TEST)},a.prototype.setWriteDepth=function(a){this._contextSetTest.testZbuffer(a)||this.renderContext.depthMask(a)},a.prototype.setBlendParticleFactors=function(a){if(!this._contextSetTest.testBlend(a))switch(a){case 0:this.renderContext.blendFunc(this.renderContext.ONE,this.renderContext.ONE_MINUS_SRC_ALPHA);break;case 1:this.renderContext.blendFunc(this.renderContext.ONE,this.renderContext.ONE);break;case 2:this.renderContext.blendFunc(this.renderContext.DST_COLOR,this.renderContext.ZERO);break;case 3:this.renderContext.blendFunc(this.renderContext.ONE,this.renderContext.ONE_MINUS_SRC_COLOR);break;case 4:this.renderContext.blendFunc(this.renderContext.SRC_ALPHA,this.renderContext.ONE);break;case-1:this.renderContext.blendFunc(this.renderContext.SRC_ALPHA,this.renderContext.ONE_MINUS_SRC_ALPHA)}},a.prototype.setProgram=function(a){this._contextSetTest.testProgram(a)||(this.renderContext.useProgram(a),this.setProgramNum++)},a.prototype.getLocation=function(a,b){return this.renderContext.getUniformLocation(a,b)},a.prototype.setVcMatrix3fv=function(a,b,c){this.renderContext.uniformMatrix3fv(a.getWebGLUniformLocation(b),!1,c)},a.prototype.setVcMatrix4fv=function(a,b,c){this.renderContext.uniformMatrix4fv(a.getWebGLUniformLocation(b),!1,c)},a.prototype.setVpMatrix=function(a,b){this._contextSetTest.testVp()||this.renderContext.uniformMatrix4fv(a.getWebGLUniformLocation("vpMatrix3D"),!1,b)},a.prototype.setVc4fv=function(a,b,c){this.renderContext.uniform4fv(a.getWebGLUniformLocation(b),c)},a.prototype.setVc1fv=function(a,b,c){this.renderContext.uniform1fv(a.getWebGLUniformLocation(b),c)},a.prototype.setVc3fv=function(a,b,c){this.renderContext.uniform3fv(a.getWebGLUniformLocation(b),c)},a.prototype.setVc2fv=function(a,b,c){this.renderContext.uniform2fv(a.getWebGLUniformLocation(b),c)},a.prototype.setVcFloat=function(a,b,c){this.renderContext.uniform1fv(a.getWebGLUniformLocation(b),c)},a.prototype.setVcMatrix4fvLocation=function(a,b){this.renderContext.uniformMatrix4fv(a,!1,b)},a.prototype.setVcMatrix2fvLocation=function(a,b){this.renderContext.uniformMatrix2fv(a,!1,b)},a.prototype.setVc4fvLocation=function(a,b){this.renderContext.uniform4fv(a,b)},a.prototype.setVa=function(a,b,c){this._contextSetTest.testVa(c),this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,c),this.renderContext.enableVertexAttribArray(a),this.renderContext.vertexAttribPointer(a,b,this.renderContext.FLOAT,!1,0,0)},a.prototype.pushVa=function(a){return this._contextSetTest.testVa(a)?!0:(this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,a),!1)},a.prototype.setVaOffset=function(a,b,c,d){this._contextSetTest.enableVaAry[a]||(this.renderContext.enableVertexAttribArray(a),this._contextSetTest.enableVaAry[a]=!0),this.renderContext.vertexAttribPointer(a,b,this.renderContext.FLOAT,!1,c,d)},a.prototype.clearVa=function(a){this._contextSetTest.enableVaAry[a]=!1,this.renderContext.disableVertexAttribArray(a)},a.prototype.drawCall=function(a,b){this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,a),this.renderContext.drawElements(this.renderContext.TRIANGLES,b,this.renderContext.UNSIGNED_SHORT,0)},a.prototype.drawLine=function(a,b){this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,a),this.renderContext.drawElements(this.renderContext.LINES,b,this.renderContext.UNSIGNED_SHORT,0)},a.prototype.setRenderTexture=function(a,b,c,d,e){void 0===e&&(e=!0),e&&this._contextSetTest.testTexture(b,c)||(0==d?this.renderContext.activeTexture(this.renderContext.TEXTURE0):1==d?this.renderContext.activeTexture(this.renderContext.TEXTURE1):2==d?this.renderContext.activeTexture(this.renderContext.TEXTURE2):3==d?this.renderContext.activeTexture(this.renderContext.TEXTURE3):4==d?this.renderContext.activeTexture(this.renderContext.TEXTURE4):5==d?this.renderContext.activeTexture(this.renderContext.TEXTURE5):6==d&&this.renderContext.activeTexture(this.renderContext.TEXTURE6),this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,c),this.renderContext.uniform1i(a.getWebGLUniformLocation(b),d),this.setTextureNum++)},a.prototype.setRenderTextureCube=function(a,b,c,d){0==d?this.renderContext.activeTexture(this.renderContext.TEXTURE0):1==d?this.renderContext.activeTexture(this.renderContext.TEXTURE1):2==d?this.renderContext.activeTexture(this.renderContext.TEXTURE2):3==d?this.renderContext.activeTexture(this.renderContext.TEXTURE3):4==d?this.renderContext.activeTexture(this.renderContext.TEXTURE4):5==d?this.renderContext.activeTexture(this.renderContext.TEXTURE5):6==d&&this.renderContext.activeTexture(this.renderContext.TEXTURE6),this.renderContext.bindTexture(this.renderContext.TEXTURE_CUBE_MAP,c),this.renderContext.uniform1i(this.renderContext.getUniformLocation(a,b),d)},a.prototype.updateTexture=function(a,b,c,d){this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,a),this.renderContext.texSubImage2D(this.renderContext.TEXTURE_2D,0,b,c,this.renderContext.RGBA,this.renderContext.UNSIGNED_BYTE,d)},a.prototype.getTexture=function(a,b,c,d){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0);var e=new Rectangle(0,0,Math.pow(2,Math.ceil(Math.log(a.width)/Math.log(2))),Math.pow(2,Math.ceil(Math.log(a.height)/Math.log(2))));if(e.width!=a.width||e.height!=a.height){console.log("图片尺寸不为2幂");var f=UIManager.getInstance().getContext2D(e.width,e.height,!1);return f.drawImage(a,0,0,a.width,a.height,0,0,e.width,e.height),this.getTexture(f.canvas,0,0)}var g=this.renderContext.createTexture();this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,g),this.renderContext.texImage2D(this.renderContext.TEXTURE_2D,0,this.renderContext.RGBA,this.renderContext.RGBA,this.renderContext.UNSIGNED_BYTE,a);var h;h=0==c?this.renderContext.LINEAR:this.renderContext.NEAREST;var i;return 0==c?0==d?i=this.renderContext.LINEAR:1==d?i=this.renderContext.LINEAR_MIPMAP_LINEAR:2==d&&(i=this.renderContext.LINEAR_MIPMAP_NEAREST):0==d?i=this.renderContext.NEAREST:1==d?i=this.renderContext.NEAREST_MIPMAP_LINEAR:2==d&&(i=this.renderContext.NEAREST_MIPMAP_NEAREST),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MAG_FILTER,h),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MIN_FILTER,i),0==b?(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.REPEAT),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.REPEAT)):(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.CLAMP_TO_EDGE),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.CLAMP_TO_EDGE)),0!=d&&this.renderContext.generateMipmap(this.renderContext.TEXTURE_2D),g},a.prototype.creatTexture=function(a,b,c){void 0===c&&(c=0);var d=this.renderContext.createTexture();return this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,d),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MAG_FILTER,this.renderContext.LINEAR),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MIN_FILTER,this.renderContext.LINEAR),0==c?(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.REPEAT),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.REPEAT)):(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.CLAMP_TO_EDGE),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.CLAMP_TO_EDGE)),this.renderContext.texImage2D(this.renderContext.TEXTURE_2D,0,this.renderContext.RGB,a,b,0,this.renderContext.RGB,this.renderContext.UNSIGNED_BYTE,null),d},a.prototype.createFramebuffer=function(){var a=this.renderContext.createFramebuffer();return this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,a),a},a.prototype.deleteBuffer=function(a){a||console.log("aaa12"),this.renderContext.deleteBuffer(a),0!=this.renderContext.getError()&&console.log("aaa12")},a.prototype.deleteTexture=function(a){this.renderContext.deleteTexture(a)},a.prototype.deleteShader=function(a){this.renderContext.deleteShader(a.vShader),this.renderContext.deleteShader(a.fShader),this.renderContext.deleteProgram(a.program)},a.prototype.cullFaceBack=function(a){this._contextSetTest.testCull(a)||(a?(this.renderContext.enable(this.renderContext.CULL_FACE),this.renderContext.cullFace(this.renderContext.BACK)):this.renderContext.disable(this.renderContext.CULL_FACE))},a.prototype.getFBO=function(){var a=FBO.fw,b=FBO.fh,c=this.renderContext.createFramebuffer();this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,c);var d=this.renderContext.createRenderbuffer();this.renderContext.bindRenderbuffer(this.renderContext.RENDERBUFFER,d),this.renderContext.renderbufferStorage(this.renderContext.RENDERBUFFER,this.renderContext.DEPTH_COMPONENT16,a,b),this.renderContext.framebufferRenderbuffer(this.renderContext.FRAMEBUFFER,this.renderContext.DEPTH_ATTACHMENT,this.renderContext.RENDERBUFFER,d);var e=this.renderContext.createTexture();this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,e),this.renderContext.texImage2D(this.renderContext.TEXTURE_2D,0,this.renderContext.RGBA,a,b,0,this.renderContext.RGBA,this.renderContext.UNSIGNED_BYTE,null),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MAG_FILTER,this.renderContext.LINEAR),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MIN_FILTER,this.renderContext.LINEAR),this.renderContext.framebufferTexture2D(this.renderContext.FRAMEBUFFER,this.renderContext.COLOR_ATTACHMENT0,this.renderContext.TEXTURE_2D,e,0),this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,null),this.renderContext.bindRenderbuffer(this.renderContext.RENDERBUFFER,null),this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,null);var f=new FBO;return f.frameBuffer=c,f.depthBuffer=d,f.texture=e,f},a}(),FBO=function(){function a(){}return a.fw=512,a.fh=512,a}(),ContextSetTest=function(){function a(){this.enableVaAry=new Array,this.vaAry=new Array,this._blendType=-1e3,this._cullType=!1,this._zbufferType=!0,this._vpMatrix=!1}return a.prototype.testTexture=function(a,b){return this._textureDic[a]==b?!0:(this._textureDic[a]=b,!1)},a.prototype.testProgram=function(a){return this._program==a?!0:(this._program=a,this._textureDic=new Object,this._vpMatrix=!1,!1)},a.prototype.testVa=function(a){return this._vabuffer==a?!0:(this._vabuffer=a,!1)},a.prototype.clear=function(){this._blendType=-1e3,this._cullType=!1,this._vpMatrix=!1,this._program=null},a.prototype.testBlend=function(a){return this._blendType==a?!0:(this._blendType=a,!1)},a.prototype.testCull=function(a){return this._cullType==a?!0:(this._cullType=a,!1)},a.prototype.testZbuffer=function(a){return this._zbufferType==a?!0:(this._zbufferType=a,!1)},a.prototype.testVp=function(){return this._vpMatrix?!0:(this._vpMatrix=!0,!1)},a}(),Scene_data=function(){function a(){}return Object.defineProperty(a,"viewMatrx3D",{get:function(){return a._viewMatrx3D},set:function(b){a._viewMatrx3D=b},enumerable:!0,configurable:!0}),a.sceneViewHW=500,a.fileRoot="res/",a.verticalScene=!1,a.effectsLev=2,a.camFar=1e3,a.frameTime=1e3/60,a.MAX_NUMBER=1e7,a.user=0,a.scaleLight=[2],a.useByte=!0,a.fogColor=[0,0,0],a.fogData=[1e3,.003],a.gameAngle=0,a.sceneNumId=0,a.supportBlob=!1,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3D=function(a){function b(){var b=a.call(this)||this;return b.sceneVisible=!0,b._hasDestory=!1,b._onStage=!1,b}return __extends(b,a),b.prototype.update=function(){},Object.defineProperty(b.prototype,"onStage",{get:function(){return this._onStage},enumerable:!0,configurable:!0}),b.prototype.addStage=function(){this._onStage=!0},b.prototype.removeStage=function(){this._onStage=!1},b.prototype.resize=function(){},b.prototype.destory=function(){this.objData&&this.objData.useNum--},b}(Object3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DSprite=function(a){function b(){var b=a.call(this)||this;return b.time=0,b.dynamic=!1,b._rotationMatrix=new Matrix3D,b}return __extends(b,a),Object.defineProperty(b.prototype,"aabbVect",{get:function(){if(!this._aabbVect){var a=this.aabb,b=a.x,c=a.y,d=a.z,e=a.width,f=a.height,g=a.depth;this._aabbVect=new Array,this._aabbVect.push(new Vector3D(b,c,d)),this._aabbVect.push(new Vector3D(b+e,c,d)),this._aabbVect.push(new Vector3D(b,c+f,d)),this._aabbVect.push(new Vector3D(b,c,d+g)),this._aabbVect.push(new Vector3D(b+e,c+f,d)),this._aabbVect.push(new Vector3D(b+e,c,d+g)),this._aabbVect.push(new Vector3D(b,c+f,d+g)),this._aabbVect.push(new Vector3D(b+e,c+f,d+g))}return this._aabbVect},enumerable:!0,configurable:!0}),b.prototype.setObjUrl=function(a){var b=this;this.objurl=a,ObjDataManager.getInstance().getObjData(Scene_data.fileRoot+a,function(a){b.objData=a,b.material&&(b.objData.tangentBuffer||ObjDataManager.getInstance().creatTBNBuffer(b.objData))})},b.prototype.setPicUrl=function(a){var b=this;this.picUrl=a,TextureManager.getInstance().getTexture(Scene_data.fileRoot+a,function(a){b.baseTexture=a})},b.prototype.setLightMapUrl=function(a){var b=this;if(a&&""!=a){var c=Scene_data.fileRoot+a;TextureManager.getInstance().getTexture(c,function(a){b.lightMapTextureRes=a})}},Object.defineProperty(b.prototype,"lightMapTexture",{get:function(){return this.lightMapTextureRes||console.log("无光照贴图------------------------------------"),this.lightMapTextureRes.texture},enumerable:!0,configurable:!0}),b.prototype.setMaterialUrl=function(a,b){var c=this;void 0===b&&(b=null),a=a.replace("_byte.txt",".txt"),a=a.replace(".txt","_byte.txt"),this.materialUrl=Scene_data.fileRoot+a,MaterialManager.getInstance().getMaterialByte(this.materialUrl,function(a){c.material=a,c.material.useNormal&&c.objData&&!c.objData.tangentBuffer&&ObjDataManager.getInstance().creatTBNBuffer(c.objData),(c.material.usePbr||c.material.directLight)&&(c._rotationData=new Float32Array(9),c.updateRotationMatrix()),b&&(c.materialParam=new MaterialBaseParam,c.materialParam.setData(c.material,b))},null,!0,MaterialShader.MATERIAL_SHADER,MaterialShader)},Object.defineProperty(b.prototype,"lightProbe",{get:function(){return this._lightProbe},set:function(a){if(this._lightProbe=a,this._lightProbe&&!this.resultSHVec){this.resultSHVec=new Array;for(var b=[.4444730390920146,-.3834955622240026,-.33124467509627725,.09365654209093091,-.05673310882817577,.2120523322966496,.02945768486978205,-.04965996229802928,-.1136529129285836],c=0;9>c;c++)this.resultSHVec.push(new Vector3D(b[c],b[c],b[c]))}},enumerable:!0,configurable:!0}),b.prototype.update=function(){(!this.dynamic||this.sceneVisible)&&this.updateMaterial()},b.prototype.updateMaterial=function(){this.material&&this.objData&&(Scene_data.context3D.setBlendParticleFactors(this.material.blendMode),Scene_data.context3D.cullFaceBack(this.material.backCull),this.updateBind(),Scene_data.context3D.setProgram(this.material.program),Scene_data.context3D.setWriteDepth(this.material.writeZbuffer),Scene_data.context3D.setVcMatrix4fv(this.material.shader,"posMatrix3D",this.posMatrix.m),this.setCam(),this.setMaterialVc(this.material,this.materialParam),this.setMaterialTexture(this.material,this.materialParam),this.setDirectLight(this.material),this.setMaterialVa(),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},b.prototype.setMaterialVa=function(){this.objData.compressBuffer?this.setMaterialVaCompress():this.setMaterialVaIndependent()},b.prototype.setMaterialVaIndependent=function(){Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),this.material.directLight||this.material.noLight||Scene_data.context3D.setVa(2,2,this.objData.lightUvBuffer),(this.material.usePbr||this.material.directLight)&&(Scene_data.context3D.setVa(3,3,this.objData.normalsBuffer),Scene_data.context3D.setVcMatrix3fv(this.material.shader,"rotationMatrix3D",this._rotationData)),this.material.useNormal&&(Scene_data.context3D.setVa(4,3,this.objData.tangentBuffer),Scene_data.context3D.setVa(5,3,this.objData.bitangentBuffer))},b.prototype.setMaterialVaCompress=function(){var a=Scene_data.context3D.pushVa(this.objData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.objData.stride,0),Scene_data.context3D.setVaOffset(1,2,this.objData.stride,this.objData.uvsOffsets),this.material.directLight||this.material.noLight||Scene_data.context3D.setVaOffset(2,2,this.objData.stride,this.objData.lightuvsOffsets),(this.material.usePbr||this.material.directLight)&&(Scene_data.context3D.setVaOffset(3,3,this.objData.stride,this.objData.normalsOffsets),Scene_data.context3D.setVcMatrix3fv(this.material.shader,"rotationMatrix3D",this._rotationData)),this.material.useNormal&&(Scene_data.context3D.setVaOffset(4,3,this.objData.stride,this.objData.tangentsOffsets),Scene_data.context3D.setVaOffset(5,3,this.objData.stride,this.objData.bitangentsOffsets)))},b.prototype.setDirectLight=function(a){a.directLight&&(Scene_data.context3D.setVc3fv(a.shader,"ambientColor",Scene_data.light.ambientColor),Scene_data.context3D.setVc3fv(a.shader,"sunDirect",Scene_data.light.sunDirect),Scene_data.context3D.setVc3fv(a.shader,"sunColor",Scene_data.light.sunColor))},b.prototype.setCam=function(){Scene_data.context3D.setVpMatrix(this.material.shader,Scene_data.vpMatrix.m)},b.prototype.setBind=function(a,b){this.bindTarget=a,this.bindSocket=b,this.bindMatrix=new Matrix3D},b.prototype.setGroup=function(a,b,c){this._isInGroup=!0,this._groupPos=a,this._groupRotation=b,this._groupScale=c,this.groupMatrix=new Matrix3D,this.groupRotationMatrix=new Matrix3D,this.groupMatrix.isIdentity=!1,this.groupMatrix.identity(),this.groupMatrix.appendScale(c.x,c.y,c.z),this.groupMatrix.appendRotation(b.x,Vector3D.X_AXIS),this.groupMatrix.appendRotation(b.y,Vector3D.Y_AXIS),this.groupMatrix.appendRotation(b.z,Vector3D.Z_AXIS),this.groupMatrix.appendTranslation(a.x,a.y,a.z),this.groupRotationMatrix.isIdentity=!1,this.groupRotationMatrix.identity(),this.groupRotationMatrix.prependRotation(b.z,Vector3D.Z_AXIS),this.groupRotationMatrix.prependRotation(b.y,Vector3D.Y_AXIS),this.groupRotationMatrix.prependRotation(b.x,Vector3D.X_AXIS)},b.prototype.updateBind=function(){this.bindTarget&&(this.posMatrix.identity(),this.posMatrix.appendScale(this._scaleX,this._scaleY,this._scaleZ),this._isInGroup&&this.posMatrix.append(this.groupMatrix),this.bindTarget.getSocket(this.bindSocket,this.bindMatrix),this.posMatrix.append(this.bindMatrix),this.bindMatrix.copyTo(this._rotationMatrix),this._rotationMatrix.identityPostion(),this._isInGroup&&this._rotationMatrix.prepend(this.groupRotationMatrix))},b.prototype.setBaseMaterialVc=function(a){var b=0;a.hasTime&&(b=(TimeUtil.getTimer()-this.time)%1e5*.001),(a.hasTime||a.usePbr||a.useKill)&&Scene_data.context3D.setVc4fv(a.shader,"fc0",[1,0,a.killNum,b]),a.scaleLightMap&&Scene_data.context3D.setVcFloat(a.shader,"scalelight",Scene_data.scaleLight),(a.usePbr||1==a.fogMode)&&this.setCamPos(a),0!=a.fogMode&&(Scene_data.context3D.setVc2fv(a.shader,"fogdata",Scene_data.fogData),Scene_data.context3D.setVc3fv(a.shader,"fogcolor",Scene_data.fogColor))},b.prototype.setCamPos=function(a){a.updateCam(Scene_data.cam3D.x/100,Scene_data.cam3D.y/100,Scene_data.cam3D.z/100)},b.prototype.setMaterialVc=function(a,b){if(void 0===b&&(b=null),!(a.fcNum<=0)){var c=0;a.hasTime&&(c=(TimeUtil.getTimer()-this.time)%1e5*.001),a.update(c),this.setCamPos(a),b&&b.update(),Scene_data.context3D.setVc4fv(a.shader,"fc",a.fcData)}},b.prototype.setMaterialTexture=function(a,b){void 0===b&&(b=null);for(var c=a.texList,d=0;d<c.length;d++)if(c[d].type==TexItem.LIGHTMAP)Scene_data.context3D.setRenderTexture(a.shader,c[d].name,this.lightMapTexture,c[d].id);else if(c[d].type==TexItem.LTUMAP&&Scene_data.pubLut)Scene_data.context3D.setRenderTexture(a.shader,c[d].name,Scene_data.pubLut,c[d].id);else if(c[d].type==TexItem.CUBEMAP)if(a.useDynamicIBL);else{var e=Math.floor(5*a.roughness);if(Scene_data.skyCubeMap){var f=Scene_data.skyCubeMap[e];Scene_data.context3D.setRenderTextureCube(a.program,c[d].name,f,c[d].id)}}else c[d].texture&&Scene_data.context3D.setRenderTexture(a.shader,c[d].name,c[d].texture,c[d].id);if(b)for(d=0;d<b.dynamicTexList.length;d++)b.dynamicTexList[d].target&&Scene_data.context3D.setRenderTexture(a.shader,b.dynamicTexList[d].target.name,b.dynamicTexList[d].texture,b.dynamicTexList[d].target.id)},b.prototype.checkMaterialTexture=function(a){for(var b=a.texList,c=0;c<b.length;c++)if(b[c].type==TexItem.LIGHTMAP){if(!this.lightMapTexture)return!1}else if(b[c].type==TexItem.LTUMAP){if(!Scene_data.pubLut)return!1}else if(b[c].type==TexItem.CUBEMAP){if(a.useDynamicIBL);else if(!Scene_data.skyCubeMap)return!1}else if(!b[c].texture)return!1;return!0},b.prototype.updateRotationMatrix=function(){try{this._rotationMatrix.identity(),this._rotationMatrix.appendRotation(this._rotationX,Vector3D.X_AXIS),this._rotationMatrix.appendRotation(this._rotationY,Vector3D.Y_AXIS),this._rotationMatrix.appendRotation(this._rotationZ,Vector3D.Z_AXIS),this._rotationData&&this._rotationMatrix.getRotaion(this._rotationData)}catch(a){console.log("在此处理错误1")}},b.prototype.setPos=function(a){this.x=a.x,this.y=a.y+10,this.z=a.z},b.prototype.destory=function(){a.prototype.destory.call(this),this.name=null,this.objurl=null,this.picUrl=null,this.materialUrl=null,this.material&&this.material.useNum--,this.materialParam&&(this.materialParam.destory(),this.materialParam=null),this.lightMapTextureRes&&this.lightMapTextureRes.clearUseNum(),this._rotationMatrix=null,this._rotationData=null,this.bindMatrix=null,this.bindTarget=null,this.bindSocket=null,this._groupPos=null,this._groupRotation=null,this._groupScale=null,this.groupMatrix=null,this.groupRotationMatrix=null},b}(Display3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DSky=function(a){function b(){var b=a.call(this)||this;return b.shader=ProgrmaManager.getInstance().getProgram(SkyShader.Sky_Shader),b.program=b.shader.program,b}return __extends(b,a),b.prototype.setObjUrl=function(a){var b=this;this.objurl=a,ObjDataManager.getInstance().getObjData(Scene_data.fileRoot+a,function(a){b.objData=a})},b.prototype.setCubeUrl=function(a){var b=this;TextureManager.getInstance().loadCubeTexture(a,function(a){b.cubeTextList=a})},b.prototype.update=function(){Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"posMatrix3D",this.posMatrix.m),this.cubeTextList&&Scene_data.context3D.setRenderTextureCube(this.program,"s_texture",this.cubeTextList[0],0),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.normalsBuffer),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},b}(Display3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3dMovie=function(a){function b(){var b=a.call(this)||this;return b._completeState=0,b._defaultAction="stand",b._curentFrame=0,b._actionTime=0,b._fileScale=1,b._isSinging=!1,b.meshVisible=!0,b._nextScale=1,b.locationDic=new Object,b._animDic=new Object,b._partDic=new Object,b._partUrl=new Object,b._preLoadActionDic=new Object,b._waitLoadActionDic=new Object,b.showCapsule=!1,b._enablePhysics=!1,b}return __extends(b,a),Object.defineProperty(b.prototype,"isSinging",{get:function(){return this._isSinging},set:function(a){this._isSinging=a,console.log(" this._isSinging",this._isSinging)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"curentAction",{get:function(){return this._curentAction},set:function(a){this._curentAction=a},enumerable:!0,configurable:!0}),b.prototype.fixAstartData=function(a){},b.prototype.setRoleUrl=function(a){var b=this;this.clearMesh(),MeshDataManager.getInstance().getMeshData(a,function(a){b._skinMesh=a,b.fileScale=a.fileScale,b.onStage&&b.addSkinMeshParticle(),b._animDic=a.animDic,b.onMeshLoaded()})},b.prototype.onMeshLoaded=function(){},b.prototype.clearMesh=function(){this.removeSkinMeshParticle(),this._skinMesh&&this._skinMesh.useNum--,this._skinMesh=null,this._animDic=new Object},b.prototype.addSkinMeshParticle=function(){if(this._skinMesh){var a=new Array;this._partDic.mesh=a;var b=this._skinMesh.meshAry;if(b)for(var c=0;c<b.length;c++)for(var d=b[c].particleAry,e=0;e<d.length;e++){var f,g=d[e];f=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+g.url),f.dynamic=!0,f.bindSocket=g.socketName,a.push(f),f.bindTarget=this,ParticleManager.getInstance().addParticle(f)}}},b.prototype.removeSkinMeshParticle=function(){var a=this._partDic.mesh;if(a){for(var b=0;b<a.length;b++)ParticleManager.getInstance().removeParticle(a[b]),a[b].destory();this._partDic.mesh=null}},b.prototype.roleResCom=function(a,b){},b.prototype.setMeshUrl=function(a,b){var c=this;void 0===b&&(b=1),this._meshUrl=Scene_data.fileRoot+a,MeshDataManager.getInstance().getMeshData(this._meshUrl,function(a){c._skinMesh=a,1!=b&&(c._skinMesh.type=1);for(var d in c._animDic)c.processAnimByMesh(c._animDic[d]);a.loadMaterial(function(a){c.loadMaterialCom(a)}),c.fileScale=a.fileScale},b)},Object.defineProperty(b.prototype,"scale",{get:function(){return this._nextScale},set:function(a){this._nextScale=a,this._scaleX=a*this._fileScale,this._scaleY=a*this._fileScale,this._scaleZ=a*this._fileScale,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"fileScale",{set:function(a){this._fileScale=a,this._scaleX=this._nextScale*a,this._scaleY=this._nextScale*a,this._scaleZ=this._nextScale*a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"shadow",{set:function(a){a?this._shadow||(this._shadow=ShadowManager.getInstance().addShadow()):this._shadow&&ShadowManager.getInstance().removeShadow(this._shadow)},enumerable:!0,configurable:!0}),b.prototype.setShadowSize=function(a){this._shadow&&(this._shadow.size=a)},b.prototype.addStage=function(){a.prototype.addStage.call(this),this.addSkinMeshParticle(),this._shadow&&(this._shadow.visible=!0)},b.prototype.removeStage=function(){a.prototype.removeStage.call(this),this._shadow&&ShadowManager.getInstance().removeShadow(this._shadow);for(var b in this._partDic)for(var c=this._partDic[b],d=0;d<c.length;d++)c[d]instanceof CombineParticle?ParticleManager.getInstance().removeParticle(c[d]):c[d]instanceof Display3DSprite&&SceneManager.getInstance().removeSpriteDisplay(c[d])},b.prototype.loadMaterialCom=function(a){a.lightProbe&&(this.lightProbe=!0)},b.prototype.setCollision=function(a,b){},b.prototype.removePart=function(a){var b=this._partDic[a];if(b){for(var c=0;c<b.length;c++)b[c]instanceof CombineParticle?(ParticleManager.getInstance().removeParticle(b[c]),b[c].destory()):b[c]instanceof Display3DSprite&&(SceneManager.getInstance().removeSpriteDisplay(b[c]),b[c].destory());this._partDic[a]=null,this._partUrl[a]=null,delete this._partDic[a],delete this._partUrl[a]}},b.prototype.addPart=function(a,b,c){var d=this;if(this._partUrl[a]!=c){this._partUrl[a]&&this.removePart(a),this._partDic[a]||(this._partDic[a]=new Array),this._partUrl[a]=c;var e=this._partDic[a];GroupDataManager.getInstance().getGroupData(Scene_data.fileRoot+c,function(a){d.loadPartRes(b,a,e)})}},b.prototype.loadPartRes=function(a,b,c){for(var d=0;d<b.dataAry.length;d++){var e,f,g,h=b.dataAry[d];if(h.isGroup&&(e=new Vector3D(h.x,h.y,h.z),f=new Vector3D(h.rotationX,h.rotationY,h.rotationZ),g=new Vector3D(h.scaleX,h.scaleY,h.scaleZ)),h.types==BaseRes.SCENE_PARTICLE_TYPE){var i=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+h.particleUrl);c.push(i),i.bindTarget=this,i.bindSocket=a,i.dynamic=!0,ParticleManager.getInstance().addParticle(i),h.isGroup&&i.setGroup(e,f,g)}else if(h.types==BaseRes.PREFAB_TYPE){var j=new Display3DSprite;j.setObjUrl(h.objUrl),j.setMaterialUrl(h.materialUrl,h.materialInfoArr),j.dynamic=!0,c.push(j),j.setBind(this,a),SceneManager.getInstance().addSpriteDisplay(j),h.isGroup&&j.setGroup(e,f,g)}}},b.prototype.getSocket=function(a,b){
if(b.identity(),!this._skinMesh)return void b.append(this.posMatrix);if(!this._skinMesh.boneSocketDic[a])return void((a="none")?b.appendTranslation(this._x,this._y,this._z):b.append(this.posMatrix));var c,d=this._skinMesh.boneSocketDic[a],e=d.index;c=this.getFrameMatrix(e),b.appendScale(1/this._scaleX,1/this._scaleY,1/this._scaleZ),b.appendRotation(d.rotationX,Vector3D.X_AXIS),b.appendRotation(d.rotationY,Vector3D.Y_AXIS),b.appendRotation(d.rotationZ,Vector3D.Z_AXIS),b.appendTranslation(d.x,d.y,d.z),c&&(b.append(this._skinMesh.bindPosInvertMatrixAry[e]),b.append(c)),b.append(this.posMatrix)},b.prototype.getSunType=function(){return 0},b.prototype.getFrameMatrix=function(a){if(this._animDic[this.curentAction]){var b=this._animDic[this.curentAction];return b.matrixAry[this._curentFrame][a]}if(this._animDic[this._defaultAction]){var b=this._animDic[this._defaultAction];return b.matrixAry[this._curentFrame][a]}return null},b.prototype.addAction=function(a,b,c){void 0===c&&(c=!1),this._preLoadActionDic[a]=b,a==this._defaultAction||a==this.curentAction?this.setAnimUrl(a,b):c&&this.setAnimUrl(a,b)},b.prototype.setAnimUrl=function(a,b){var c=this;this._waitLoadActionDic[a]=!0,AnimManager.getInstance().getAnimData(b,function(b){c._animDic[a]=b,c.processAnimByMesh(b),c._waitLoadActionDic[a]=!1})},b.prototype.play=function(a,b,c){return void 0===b&&(b=0),void 0===c&&(c=!0),this.curentAction!=a?(this.curentAction=a,this._completeState=b,this._actionTime=0,this.updateFrame(0),this._animDic.hasOwnProperty(a)?!0:(!this._waitLoadActionDic[a]&&this._preLoadActionDic[a]&&this.setAnimUrl(a,this._preLoadActionDic[a]),!1)):void 0},b.prototype.processAnimByMesh=function(a){if(this._skinMesh&&!a.hasProcess){for(var b=0;b<a.matrixAry.length;b++)for(var c=a.matrixAry[b],d=0;d<c.length;d++)c[d].prepend(this._skinMesh.bindPosMatrixAry[d]);a.hasProcess=!0}},b.prototype.update=function(){if(this._skinMesh){if(this.lightProbe&&(this.resultSHVec=LightProbeManager.getInstance().getData(new Vector3D(this.x,this.y+10,this.z))),this.updateBind(),this.meshVisible)for(var a=0;a<this._skinMesh.meshAry.length;a++)this.updateMaterialMesh(this._skinMesh.meshAry[a]);this.showCapsule&&this.updateShowCapsule()}},b.prototype.updateFrame=function(a){this._actionTime+=a;var b;if(this.curentAction&&this._animDic[this.curentAction])b=this.curentAction;else{if(!this._animDic[this._defaultAction])return;b=this._defaultAction}var c=this._animDic[b];this._curentFrame=float2int(this._actionTime/(2*Scene_data.frameTime)),this._curentFrame>=c.matrixAry.length&&(0==this._completeState?(this._actionTime=0,this._curentFrame=0):1==this._completeState?this._curentFrame=c.matrixAry.length-1:2==this._completeState?(this._curentFrame=0,this._completeState=0,this.changeAction(this.curentAction)):3==this._completeState)},b.prototype.changeAction=function(a){this.curentAction=this._defaultAction},b.prototype.destory=function(){a.prototype.destory.call(this),this._skinMesh&&this._skinMesh.useNum--;for(var b in this._partDic)for(var c=this._partDic[b],d=0;d<c.length;d++)c[d]instanceof CombineParticle?c[d].destory():c[d]instanceof Display3DSprite&&c[d].destory();this._partDic=null},b.prototype.updateShowCapsule=function(){this.capsuleLineSprite?(this.capsuleLineSprite.x=this.x,this.capsuleLineSprite.y=this.y+this._capsule.radius,this.capsuleLineSprite.z=this.z,this.capsuleLineSprite.update()):(this.capsuleLineSprite=new LineDisplaySprite,this.capsuleLineSprite.clear(),this.capsuleLineSprite.baseColor=new Vector3D(1,0,0,1),this.drawCylinder(this._capsule.radius,this._capsule.height),this.drawBall(this._capsule.radius),this.capsuleLineSprite.upToGpu())},b.prototype.drawBall=function(a){var b,c,d,e,f,g,h,i=a,j=12;for(f=0;j>=f;f++)for(d=null,e=j/2;j>e;e++)b=new Vector3D(i,0,0),c=new Matrix3D,c.appendRotation(360/j*e,Vector3D.Z_AXIS),b=c.transformVector(b),g=new Matrix3D,g.appendRotation(360/j*f,Vector3D.Y_AXIS),b=g.transformVector(b),d&&this.capsuleLineSprite.makeLineMode(d,b),d=b.clone();for(f=1;4>=f;f++)for(g=new Matrix3D,g.appendRotation(-20*f,Vector3D.Z_AXIS),h=g.transformVector(new Vector3D(i,0,0)),d=null,e=0;j>e;e++)b=h.clone(),c=new Matrix3D,c.appendRotation(360/j*e,Vector3D.Y_AXIS),b=c.transformVector(b),d&&this.capsuleLineSprite.makeLineMode(d,b),e==j-1&&this.capsuleLineSprite.makeLineMode(h,b),d=b.clone()},b.prototype.drawCylinder=function(a,b){var c,d,e,f=a,g=b,h=12;for(e=0;h>e;e++){var i=new Vector3D(f,0,0),j=new Vector3D(f,+g,0),k=new Matrix3D;k.appendRotation(e*(360/h),Vector3D.Y_AXIS);var l=k.transformVector(i),m=k.transformVector(j);this.capsuleLineSprite.makeLineMode(l,m),this.capsuleLineSprite.makeLineMode(m,new Vector3D(0,+g,0)),e==h-1&&(this.capsuleLineSprite.makeLineMode(l,i),this.capsuleLineSprite.makeLineMode(m,j)),(c||d)&&(this.capsuleLineSprite.makeLineMode(l,c),this.capsuleLineSprite.makeLineMode(m,d)),c=l.clone(),d=m.clone()}},b.prototype.setVcMatrix=function(a){Scene_data.context3D.setVpMatrix(a.material.shader,Scene_data.vpMatrix.m),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"posMatrix3D",this.posMatrix.m)},b.prototype.setVa=function(a){a.compressBuffer?this.setVaCompress(a):this.setVaIndependent(a)},b.prototype.setVaIndependent=function(a){Scene_data.context3D.setVa(0,3,a.vertexBuffer),Scene_data.context3D.setVa(1,2,a.uvBuffer),Scene_data.context3D.setVa(2,4,a.boneIdBuffer),Scene_data.context3D.setVa(3,4,a.boneWeightBuffer),a.material.usePbr?(Scene_data.context3D.setVa(4,4,a.normalsBuffer),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"rotationMatrix3D",this._rotationMatrix.m),a.material.useNormal&&(Scene_data.context3D.setVa(5,4,a.tangentBuffer),Scene_data.context3D.setVa(6,4,a.bitangentBuffer))):(a.material.lightProbe||a.material.directLight)&&(Scene_data.context3D.setVa(4,4,a.normalsBuffer),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"rotationMatrix3D",this._rotationMatrix.m))},b.prototype.setVaCompress=function(a){var b=Scene_data.context3D.pushVa(a.vertexBuffer);b||(Scene_data.context3D.setVaOffset(0,3,a.stride,0),Scene_data.context3D.setVaOffset(1,2,a.stride,a.uvsOffsets),Scene_data.context3D.setVaOffset(2,4,a.stride,a.boneIDOffsets),Scene_data.context3D.setVaOffset(3,4,a.stride,a.boneWeightOffsets),a.material.usePbr?(Scene_data.context3D.setVaOffset(4,3,a.stride,a.normalsOffsets),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"rotationMatrix3D",this._rotationMatrix.m),a.material.useNormal&&(Scene_data.context3D.setVaOffset(5,3,a.stride,a.tangentsOffsets),Scene_data.context3D.setVaOffset(6,3,a.stride,a.bitangentsOffsets))):(a.material.lightProbe||a.material.directLight)&&(Scene_data.context3D.setVaOffset(4,3,a.stride,a.normalsOffsets),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"rotationMatrix3D",this._rotationMatrix.m)))},b.prototype.updateMaterialMesh=function(a){a.material&&(Scene_data.context3D.setProgram(a.material.program),Scene_data.context3D.cullFaceBack(a.material.backCull),Scene_data.context3D.setBlendParticleFactors(a.material.blendMode),this.setVcMatrix(a),this.setMaterialVc(a.material,a.materialParam),this.setMaterialTexture(a.material,a.materialParam),this.setVa(a),this.setDirectLight(a.material),this.setMeshVc(a),Scene_data.context3D.drawCall(a.indexBuffer,a.treNum))},b.prototype.setLightProbeVc=function(a){if(a.lightProbe)for(var b=0;b<this.resultSHVec.length;b++)Scene_data.context3D.setVc3fv(a.shader,"sh["+b+"]",[this.resultSHVec[b].x,this.resultSHVec[b].y,this.resultSHVec[b].z])},b.prototype.setMeshVc=function(a){var b;if(this._animDic[this.curentAction])b=this._animDic[this.curentAction];else{if(!this._animDic[this._defaultAction])return;b=this._animDic[this._defaultAction]}var c=b.boneQPAry[a.uid][this._curentFrame];Scene_data.context3D.setVc4fv(a.material.shader,"boneQ",c.quat),Scene_data.context3D.setVc3fv(a.material.shader,"boneD",c.pos)},b.prototype.setPos=function(b){a.prototype.setPos.call(this,b),this._shadow&&(this._shadow.x=b.x,this._shadow.y=b.y+8,this._shadow.z=b.z)},Object.defineProperty(b.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this.updateMatrix(),this._shadow&&(this._shadow.x=a),this.changePos()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this.updateMatrix(),this._shadow&&(this._shadow.y=a),this.changePos()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this._z},set:function(a){this._z=a,this.updateMatrix(),this._shadow&&(this._shadow.z=a),this.changePos()},enumerable:!0,configurable:!0}),b.prototype.changePos=function(){},b}(Display3DSprite),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3dBatchMovie=function(a){function b(){var b=a.call(this)||this;return b.batchNum=0,b.batchPos=new Array,b}return __extends(b,a),Object.defineProperty(b.prototype,"fileScale",{set:function(a){this._fileScale=a;for(var b=0;b<this.batchPos.length;b++)this.batchPos[b].fileScale=a},enumerable:!0,configurable:!0}),b.prototype.addSun=function(a){this.batchPos.push(a),a.fileScale=this._fileScale},b.prototype.setVcMatrix=function(a){Scene_data.context3D.setVcMatrix4fv(a.material.shader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"rotationMatrix3D",this._rotationMatrix.m);for(var b=0;b<this.batchPos.length;b++)Scene_data.context3D.setVcMatrix4fv(a.material.shader,"posMatrixAry["+b+"]",this.batchPos[b].posMatrix.m)},b.prototype.setLightProbeVc=function(a){},b.prototype.setVa=function(a){Scene_data.context3D.setVa(0,3,a.vertexBuffer),Scene_data.context3D.setVa(1,3,a.uvBuffer),Scene_data.context3D.setVa(2,4,a.boneIdBuffer),Scene_data.context3D.setVa(3,4,a.boneWeightBuffer),a.material.usePbr?(Scene_data.context3D.setVa(4,4,a.normalsBuffer),a.material.useNormal&&(Scene_data.context3D.setVa(5,4,a.tangentBuffer),Scene_data.context3D.setVa(6,4,a.bitangentBuffer))):(a.material.lightProbe||a.material.directLight)&&Scene_data.context3D.setVa(4,4,a.normalsBuffer)},b.prototype.addStage=function(){if(a.prototype.addStage.call(this),this.batchPos.length)for(var b=0;b<this.batchPos.length;b++)this.batchPos[b].add()},b.prototype.removeStage=function(){if(a.prototype.removeStage.call(this),this.batchPos.length)for(var b=0;b<this.batchPos.length;b++)this.batchPos[b].remove()},b}(Display3dMovie),Movie3D=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.posData=[0,0,0,10],b.hasReach=!1,b._fileScale=1,b}return __extends(b,a),Object.defineProperty(b.prototype,"shadow",{set:function(a){a&&(this._shadow||(this._shadow=ShadowManager.getInstance().addShadow(),this._shadow.x=this._x,this._shadow.y=this._y,this._shadow.z=this._z))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"fileScale",{set:function(a){this._fileScale=a,this._scaleX*=a,this._scaleY*=a,this._scaleZ*=a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scale",{set:function(a){this._scaleX=a*this._fileScale,this._scaleY=a*this._fileScale,this._scaleZ=a*this._fileScale,this.posData[3]=20*a,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this.posData[0]=a,this.updateMatrix(),this._shadow&&(this.retinueShadowFix?this._shadow.x=a+this.retinueShadowFix.x:this._shadow.x=a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this.posData[1]=a,this.updateMatrix(),this._shadow&&(this.retinueShadowFix?this._shadow.y=a+this.retinueShadowFix.y+2:this._shadow.y=a+2)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this._z},set:function(a){this._z=a,this.posData[2]=a,this.updateMatrix(),this._shadow&&(this.retinueShadowFix?this._shadow.z=a+this.retinueShadowFix.z:this._shadow.z=a)},enumerable:!0,configurable:!0}),b.prototype.add=function(){this._shadow&&(this._shadow.visible=!0)},b.prototype.remove=function(){this._shadow&&(this._shadow.visible=!1)},b}(Object3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3dShadow=function(a){function b(){var b=a.call(this)||this;return b.needUpdate=!1,b.locationFloat32=new Float32Array(0),b.shadowList=new Array,b.objData=new ObjData,b.shader=ProgrmaManager.getInstance().getProgram(Display3DShadowShader.Display3DShadowShader),b.program=b.shader.program,b.posProLocation=Scene_data.context3D.getLocation(b.program,"pos"),b}return __extends(b,a),b.prototype.addShadow=function(a){this.shadowList.push(a),a.display=this,this.applyObjData()},b.prototype.removeShadow=function(a){var b=this.shadowList.indexOf(a);-1!=b&&(this.shadowList.splice(b,1),this.applyObjData()),0==this.shadowList.length},b.prototype.stateChage=function(){for(var a=0;a<this.shadowList.length&&!this.shadowList[a].visible;a++);a==this.shadowList.length?this.needUpdate=!1:this.needUpdate=!0},b.prototype.hasIdle=function(){return this.shadowList.length<30},b.prototype.applyObjData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0,this.objData.indexs.length=0;for(var a=1,b=0;b<this.shadowList.length;b++)this.objData.vertices.push(-a,0,a,a,0,a,a,0,-a,-a,0,-a),this.objData.uvs.push(0,0,b,0,1,b,1,1,b,1,0,b),this.objData.indexs.push(4*b,1+4*b,2+4*b,4*b,2+4*b,3+4*b);this.objData.treNum=6*this.shadowList.length,this.objData.vertexBuffer?(Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},b.prototype.update=function(){if(this.needUpdate&&0!=this.shadowList.length&&this.objData.treNum){Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),this.locationFloat32.length!=4*this.shadowList.length&&(this.locationFloat32=new Float32Array(4*this.shadowList.length));for(var a=0;a<this.shadowList.length;a++)this.shadowList[a].visible?(this.locationFloat32[4*a+0]=this.shadowList[a].data[0],this.locationFloat32[4*a+1]=this.shadowList[a].data[1],this.locationFloat32[4*a+2]=this.shadowList[a].data[2],this.locationFloat32[4*a+3]=this.shadowList[a].data[3]):(this.locationFloat32[4*a+0]=0,this.locationFloat32[4*a+1]=1e4,this.locationFloat32[4*a+2]=0,this.locationFloat32[4*a+3]=0);Scene_data.context3D.setVc4fvLocation(this.posProLocation,this.locationFloat32),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),Scene_data.context3D.setRenderTexture(this.shader,"s_texture",b.texture,0),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},b}(Display3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3dBg=function(a){function b(){var b=a.call(this)||this;return b._scaleData=[1,1],b.shader=ProgrmaManager.getInstance().getProgram(UIImageShader.UI_IMG_SHADER),b.program=b.shader,b.initData(),b}return __extends(b,a),b.prototype.initData=function(){this.objData=new ObjData,this.objData.vertices.push(-1,1,.99,1,1,.99,1,-1,.99,-1,-1,.99),this.objData.uvs.push(0,0,1,0,1,1,0,1),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=6,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)},b.prototype.resize=function(){this.appleyPos()},b.prototype.setImgInfo=function(a,b,c){this.setImgUrl(a),this._width=b,this._height=c},b.prototype.setImgUrl=function(a){},b.prototype.appleyPos=function(){var a=this._width/Scene_data.stageWidth,b=this._height/Scene_data.stageHeight;b>a?(this._scaleData[0]=1,this._scaleData[1]=this._height/Scene_data.stageHeight/a):(this._scaleData[0]=this._width/Scene_data.stageWidth/b,this._scaleData[1]=1)},b.prototype.update=function(){this.appleyPos(),Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),Scene_data.context3D.setVc2fv(this.shader,"scale",this._scaleData),Scene_data.context3D.setVcFloat(this.shader,"alpha",[1]),Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},b}(Display3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display2dMovie=function(a){function b(){var b=a.call(this)||this;return b.batchPos=new Array,b._time=0,b._allFrame=12,b._uvData=[0,0],b._uWidth=0,b._vWidth=0,b._state=0,b.frameRate=3,b.objData=new ObjData,b.watchCaramMatrix=new Matrix3D,b.shader=ProgrmaManager.getInstance().getProgram(Movie2DShader.MOVIE2D_SHADER),b.program=b.shader.program,b}return __extends(b,a),b.prototype.update=function(){this.watchCaramMatrix.identity(),this.watchCaramMatrix.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),this.watchCaramMatrix.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"watchCamMatrix3D",this.watchCaramMatrix.m);for(var a=0;a<this.batchPos.length;a++)Scene_data.context3D.setVc4fv(this.shader,"posdata["+a+"]",this.batchPos[a].posData);Scene_data.context3D.setVc2fv(this.shader,"outuv",this._uvData),Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.movieTexture,0),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},b.prototype.updateFrame=function(a){this._time+=a;var b=float2int(this._time/(2*Scene_data.frameTime)/this.frameRate);b>=this._allFrame&&(0==this._state?(this._time=0,b=0):1==this._state?b=this._allFrame-1:2==this._state?(this.play("stand"),b=0,this._state=0):3==this._state),this._uvData[0]=b*this._uWidth},b.prototype.play=function(a,b){void 0===b&&(b=0),this._state=b,this._time=0,"walk"==a?this._uvData[1]=this._vWidth:-1!=a.indexOf("attack")?this._uvData[1]=2*this._vWidth:this._uvData[1]=0},b.prototype.addSun=function(a){this.batchPos.push(a)},b.prototype.setUrl=function(a){},b.prototype.initData=function(a,b,c,d,e,f){void 0===f&&(f=!1),this.objData.vertices.length=0,this.objData.uvs.length=0,this.objData.indexs.length=0,this._uWidth=c,this._vWidth=d,this._allFrame=e;for(var g=0;a>g;g++){this.objData.vertices.push(-.5*b,1,0,.5*b,1,0,.5*b,0,0,-.5*b,0,0);var h=0;f&&(h=float2int(e*Math.random())*c),this.objData.uvs.push(0+h,0,g,c+h,0,g,c+h,1*d,g,0+h,1*d,g),this.objData.indexs.push(4*g,1+4*g,2+4*g,4*g,2+4*g,3+4*g)}this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer?(Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},b.prototype.addStage=function(){if(a.prototype.addStage.call(this),this.batchPos.length)for(var b=0;b<this.batchPos.length;b++)this.batchPos[b].add()},b.prototype.removeStage=function(){if(a.prototype.removeStage.call(this),this.batchPos.length)for(var b=0;b<this.batchPos.length;b++)this.batchPos[b].remove()},b}(Display3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DUISprite=function(a){function b(){var b=a.call(this)||this;return b.uiMatrix=new Matrix3D,b.uiMatrix.prependTranslation(0,0,600),b.uiMatrix.prependRotation(-15,Vector3D.X_AXIS),b.uiMatrix.prependRotation(0,Vector3D.Y_AXIS),b.uiViewMatrix=new Matrix3D,b}return __extends(b,a),b.prototype.loadRes=function(a){var b=this;this.modelRes||(this.modelRes=new ModelRes),this.modelRes.load(Scene_data.fileRoot+getModelUrl(a),function(){b.loadResComFinish()})},b.prototype.loadResComFinish=function(){this.setObjUrl(this.modelRes.objUrl),this.setMaterialUrl(this.modelRes.materialUrl)},b.prototype.loadGroup=function(a){var b=this,c=new GroupRes;c.load(Scene_data.fileRoot+"model/"+a+".txt",function(){b.loadPartRes(c)})},b.prototype.loadPartRes=function(a){for(var b=0;b<a.dataAry.length;b++){var c=a.dataAry[b];c.types==BaseRes.SCENE_PARTICLE_TYPE||c.types==BaseRes.PREFAB_TYPE&&(this.setObjUrl(c.objUrl),this.setMaterialUrl(c.materialUrl,c.materialInfoArr))}},b.prototype.resize=function(){this.uiViewMatrix.identity(),this.uiViewMatrix.perspectiveFieldOfViewLH(1,1,500,5e3),this.uiViewMatrix.appendScale(1e3/Scene_data.stageWidth,1e3/Scene_data.stageHeight,1)},b.prototype.setCam=function(){Scene_data.context3D.setVcMatrix4fv(this.material.shader,"viewMatrix3D",this.uiViewMatrix.m),Scene_data.context3D.setVcMatrix4fv(this.material.shader,"camMatrix3D",this.uiMatrix.m)},b.prototype.update=function(){Scene_data.context3D.setWriteDepth(!0),Scene_data.context3D.setDepthTest(!0),a.prototype.update.call(this),Scene_data.context3D.setWriteDepth(!1),Scene_data.context3D.setDepthTest(!1)},b}(Display3DSprite),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display2DSprite=function(a){function b(){var b=a.call(this)||this;return b.batchPos=new Array,b.objData=new ObjData,b.watchCaramMatrix=new Matrix3D,b.shader=ProgrmaManager.getInstance().getProgram(Sprite2DShader.SPRITE2D_SHADER),b.program=b.shader.program,b}return __extends(b,a),b.prototype.setInfo=function(a,b,c){this._imgAtlas||(this._imgAtlas=new UIAtlas),this._imgAtlas.setInfo(a,b,c)},b.prototype.getSprite=function(a){var b=new Sprite;return b.uvData=this._imgAtlas.getRec(a),b},b.prototype.addSprite=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];for(var c=0;c<a.length;c++)this.batchPos.push(a[c]);this.applyData()},b.prototype.applyData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0,this.objData.indexs.length=0;for(var a=0;a<this.batchPos.length;a++){var b=this.batchPos[a].uvData,c=b.pixelHeight/b.pixelWitdh;this.objData.vertices.push(-.5*b.width,1*c*b.width,0,.5*b.width,1*c*b.width,0,.5*b.width,0,0,-.5*b.width,0,0),this.objData.uvs.push(b.x,b.y,a,b.x+b.width,b.y,a,b.x+b.width,b.y+b.height,a,b.x,b.y+b.height,a),this.objData.indexs.push(4*a,1+4*a,2+4*a,4*a,2+4*a,3+4*a)}this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer?(Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},b.prototype.update=function(){if(0!=this.batchPos.length){this.watchCaramMatrix.identity(),this.watchCaramMatrix.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),this.watchCaramMatrix.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"watchCamMatrix3D",this.watchCaramMatrix.m);for(var a=0;a<this.batchPos.length;a++)Scene_data.context3D.setVc4fv(this.shader,"posdata["+a+"]",this.batchPos[a].posData);Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this._imgAtlas.texture,0),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},b}(Display3D),Sprite=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.posData=[0,0,0,100],b}return __extends(b,a),b.prototype.setPos=function(a,b,c){this.x=a,this.y=b,this.z=c},Object.defineProperty(b.prototype,"scale",{get:function(){return this._scaleX},set:function(a){this._scaleX=a,this.posData[3]=100*a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"x",{set:function(a){this._x=a,this.posData[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{set:function(a){this._y=a,this.posData[1]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{set:function(a){this._z=a,this.posData[2]=a},enumerable:!0,configurable:!0}),b}(Object3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GroundDataMesh=function(){function a(){}return a.prototype.mekeUseTexture=function(a){var b=new Rectangle(0,0,Math.pow(2,Math.ceil(Math.log(a.width)/Math.log(2))),Math.pow(2,Math.ceil(Math.log(a.height)/Math.log(2))));if(b.width!=a.width||b.height!=a.height){for(var c=new BitMapData(b.width,b.height),d=0;d<c.width;d++)for(var e=0;e<c.height;e++){var f=a.getRgb(d/c.width*a.width,e/c.height*a.height);c.setRgb(d,e,f)}return c}return a},a.prototype.calibration=function(){this.idBitmap=this.mekeUseTexture(this.idBitmap),this.infoBitmap=this.mekeUseTexture(this.infoBitmap)},a.meshAllgroundData=function(b){for(var c=b.readInt(),d=b.readInt(),e=new Array,f=0;c>f;f++)for(var g=0;d>g;g++){var h=b.readInt(),i=b.readInt(),j=b.readInt(),k=b.readInt(),l=new a;l.idBitmap=new BitMapData(j,k),l.infoBitmap=new BitMapData(j,k),l.tx=h,l.ty=i,e.push(l);for(var m=0;j>m;m++)for(var n=0;k>n;n++){var o,p=b.readByte();switch(p){case 0:o=new Vector3D(0,1,2);break;case 1:o=new Vector3D(0,1,3);break;case 2:o=new Vector3D(0,2,3);break;case 3:o=new Vector3D(1,2,3);break;default:throw new Error("信息索引没有编入")}l.idBitmap.setRgb(m,n,new Vector3D(o.x/255,o.y/255,o.z/255,1));var q=new Vector3D;q.x=b.readByte()+128,q.y=b.readByte()+128,q.z=255-q.x-q.y,l.infoBitmap.setRgb(m,n,new Vector3D(q.x/255,q.y/255,q.z/255,1))}l.calibration()}for(var r=b.readUTF(),s=0;s<e.length;s++)e[s].sixurl=r;return e},a}(),TerrainDisplay3DSprite=function(a){function b(){var b=a.call(this)||this;return ProgrmaManager.getInstance().registe(TerrainDisplay3DShader.TerrainDisplay3DShader,new TerrainDisplay3DShader),b.groundShader=ProgrmaManager.getInstance().getProgram(TerrainDisplay3DShader.TerrainDisplay3DShader),b}return __extends(b,a),b.prototype.update=function(){this.groundShader&&this.baseSixteenRes&&this.idMapPicDataTexture?this.upDataToDraw():a.prototype.update.call(this)},b.prototype.upDataToDraw=function(){if(this.groundShader&&this.baseSixteenRes){Scene_data.context3D.cullFaceBack(!1),Scene_data.context3D.setProgram(this.groundShader.program),Scene_data.context3D.setVcMatrix4fv(this.groundShader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(this.groundShader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),Scene_data.context3D.setVcMatrix4fv(this.groundShader,"posMatrix3D",this.posMatrix.m),Scene_data.context3D.setVc4fv(this.groundShader,"colorData",[1,0,1,1]);var a=Scene_data.context3D.pushVa(this.objData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.objData.stride,0),Scene_data.context3D.setVaOffset(1,2,this.objData.stride,this.objData.uvsOffsets)),Scene_data.context3D.setRenderTexture(this.groundShader,"idmaptexture",this.idMapPicDataTexture,0),Scene_data.context3D.setRenderTexture(this.groundShader,"infotexture",this.infoMapPicDataTexture,1),Scene_data.context3D.setRenderTexture(this.groundShader,"sixtexture",this.baseSixteenRes.texture,2),Scene_data.context3D.setRenderTexture(this.groundShader,"lightexture",this.lightMapTexture,3),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},b.prototype.setGrounDataMesh=function(a){var b=this;this.idMapPicDataTexture=Scene_data.context3D.getTexture(a.idBitmap.imgData,0,1),this.infoMapPicDataTexture=Scene_data.context3D.getTexture(a.infoBitmap.imgData,0,1);var c=a.sixurl;TextureManager.getInstance().getTexture(Scene_data.fileRoot+c,function(a){b.baseSixteenRes=a})},b}(Display3DSprite),Engine=function(){function a(){}return a.init=function(b){var c=/ipad/i.test(navigator.userAgent),d=/iPhone/i.test(navigator.userAgent),e=/android/i.test(navigator.userAgent);/iindow/i.test(navigator.userAgent),navigator.userAgent.toLowerCase();c||d||e?Scene_data.isPc=!1:Scene_data.isPc=!0,Scene_data.vpMatrix=new Matrix3D,Scene_data.canvas3D=b,Scene_data.context3D=new Context3D,Scene_data.context3D.init(b),UIManager.getInstance().init(),Scene_data.cam3D=new Camera3D,Scene_data.focus3D=new Object3D,Scene_data.focus3D.x=0,Scene_data.focus3D.y=0,Scene_data.focus3D.z=0,Scene_data.focus3D.rotationY=135,Scene_data.focus3D.rotationX=-45,Scene_data.light=new LightVo,a.testBlob(),a.resetSize(),a.initShadow(),TimeUtil.init(),PathManager.init()},a.resReady=function(){a.initPbr()},a.testBlob=function(){try{new Blob}catch(a){return void(Scene_data.supportBlob=!1)}Scene_data.supportBlob=!0},a.initPbr=function(){Scene_data.pubLut||TextureManager.getInstance().getTexture(Scene_data.fileRoot+"base/brdf_ltu.jpg",function(a){Scene_data.pubLut=a.texture},1),Scene_data.skyCubeMap||TextureManager.getInstance().loadCubeTexture(Scene_data.fileRoot+"base/cube/e",function(a){
Scene_data.skyCubeMap=a})},a.initShadow=function(){TextureManager.getInstance().getTexture(Scene_data.fileRoot+"base/shadow.png",function(a){Display3dShadow.texture=a.texture})},a.resetSize=function(){a.needInputTxt||(document.body.clientWidth>document.body.clientHeight?(Scene_data.stageWidth=document.body.clientWidth,Scene_data.stageHeight=document.body.clientHeight,Scene_data.verticalScene=!1):(Scene_data.stageWidth=document.body.clientHeight,Scene_data.stageHeight=document.body.clientWidth,Scene_data.verticalScene=!0),this.needVertical||(Scene_data.stageWidth=document.body.clientWidth,Scene_data.stageHeight=document.body.clientHeight,Scene_data.verticalScene=!1),Scene_data.canvas3D.width=Scene_data.stageWidth,Scene_data.canvas3D.height=Scene_data.stageHeight,Scene_data.context3D.resetSize(Scene_data.stageWidth,Scene_data.stageHeight),UIManager.getInstance().resize(),BloodManager.getInstance().resize(),this.resetViewMatrx3D(),Scene_data.canvas3D.style.position="absolute",Scene_data.canvas3D.style.left="0px",Scene_data.canvas3D.style.top="0px",Scene_data.verticalScene?Scene_data.canvas3D.style.transform="matrix(0,1,-1,0,"+Scene_data.stageHeight+",0)":Scene_data.canvas3D.style.transform="matrix(1,0,0,1,0,0)",Scene_data.canvas3D.style.transformOrigin="0px 0px 0px",Scene_data.canvas3D.style.top="0px")},a.resetViewMatrx3D=function(){Scene_data.viewMatrx3D?Scene_data.viewMatrx3D.identity():Scene_data.viewMatrx3D=new Matrix3D;var a=Scene_data.stageWidth,b=Scene_data.stageHeight;Scene_data.sceneViewHW=Math.max(a,b),Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(this.sceneCamScale,1,50,Scene_data.camFar),Scene_data.viewMatrx3D.appendScale(1*(Scene_data.sceneViewHW/a*2),a/b*(Scene_data.sceneViewHW/a*2),1)},a.update=function(){TimeUtil.update(),SceneManager.getInstance().update(),FpsMc.update()},a.unload=function(){},a.needVertical=!0,a.needInputTxt=!1,a.sceneCamScale=1.76,a}(),MathClass=function(){function a(){}return a.getCamView=function(a,b){a.update();var c=new Matrix3D;c.appendRotation(-b.rotationX,Vector3D.X_AXIS),c.appendRotation(-b.rotationY,Vector3D.Y_AXIS),c.appendTranslation(b.x,b.y,b.z);var d=c.transformVector(new Vector3D(0,0,-a.distance));return a.x=d.x,a.y=d.y,a.z=d.z,a.rotationX=b.rotationX,a.rotationY=b.rotationY,a.cameraMatrix.identity(),a.cameraMatrix.prependTranslation(0,0,a.distance),a.cameraMatrix.prependRotation(a.rotationX,Vector3D.X_AXIS),a.cameraMatrix.prependRotation(a.rotationY,Vector3D.Y_AXIS),a.cameraMatrix.prependTranslation(-b.x+a.offset.x,-b.y+a.offset.y,-b.z+ +a.offset.z),this.updateVp(),a.cameraMatrix.m},a.updateVp=function(){Scene_data.vpMatrix.identity(),Scene_data.vpMatrix.prepend(Scene_data.viewMatrx3D),Scene_data.vpMatrix.prepend(Scene_data.cam3D.cameraMatrix)},a.MathCam=function(a){var b=new Matrix3D;b.prependRotation(a.rotationX,Vector3D.X_AXIS),b.prependRotation(a.rotationY,Vector3D.Y_AXIS),b.prependTranslation(-a.x,-a.y,-a.z),a.cameraMatrix.identity(),a.cameraMatrix.append(b)},a.GetViewHitBoxData=function(a){var b=Scene_data.cam3D.cameraMatrix.clone();b.invert();var c=Scene_data.viewMatrx3D.m[0],d=Scene_data.viewMatrx3D.m[5];this.viewBoxVecItem?(this.lastViewScale.x!=c||this.lastViewScale.y!=d)&&(this.viewBoxVecItem[0]=new Vector3D(-a/c,-a/d,a),this.viewBoxVecItem[1]=new Vector3D(-a/c,+a/d,a),this.viewBoxVecItem[2]=new Vector3D(+a/c,-a/d,a),this.viewBoxVecItem[3]=new Vector3D(+a/c,+a/d,a),this.viewBoxVecItem[4]=new Vector3D(0,0,0)):(this.lastViewScale=new Vector2D(c,d),this.viewBoxVecItem=new Array,this.viewBoxVecItem.push(new Vector3D(-a/c,-a/d,a)),this.viewBoxVecItem.push(new Vector3D(-a/c,+a/d,a)),this.viewBoxVecItem.push(new Vector3D(+a/c,-a/d,a)),this.viewBoxVecItem.push(new Vector3D(+a/c,+a/d,a)),this.viewBoxVecItem.push(new Vector3D(0,0,0)))},a.GetViewHitBoxDataCopy=function(a){this.viewBoxVecItem||(this.viewBoxVecItem=new Array,this.viewBoxVecItem.push(new Vector3D),this.viewBoxVecItem.push(new Vector3D),this.viewBoxVecItem.push(new Vector3D),this.viewBoxVecItem.push(new Vector3D));var b=a/(Scene_data.sceneViewHW/2),c=Scene_data.sceneViewHW/2*b,d=Scene_data.stageWidth,e=Scene_data.stageHeight,f=new Matrix3D;f.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),f.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS);var g=Scene_data.viewMatrx3D.transformVector(new Vector3D(500,0,500)),h=g.x/g.w,i=.8,j=d/2/h*b*i,k=e/2/h*b*i;this.viewBoxVecItem[0]=this.gettempPos(new Vector3D(-j,-k,c),f),this.viewBoxVecItem[1]=this.gettempPos(new Vector3D(+j,-k,c),f),this.viewBoxVecItem[2]=this.gettempPos(new Vector3D(+j,+k,c),f),this.viewBoxVecItem[3]=this.gettempPos(new Vector3D(-j,+k,c),f)},a.gettempPos=function(a,b){var c=b.transformVector(a);return c=c.add(new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z))},a.mathmidpoint=function(a,b,c){var d,e,f;d=a.x+(b.x-a.x)*c,e=a.y+(b.y-a.y)*c,f=a.z+(b.z-a.z)*c,a.x=d,a.y=e,a.z=f},a.drawbezier=function(a,b){var c=new Array;if(0==a.length)return{x:0,y:0,z:0};for(var d=0;d<a.length;d++)c.push({x:a[d].x,y:a[d].y,z:a[d].z});for(;c.length>1;){for(var e=0;e<c.length-1;e++)this.mathmidpoint(c[e],c[e+1],b);c.pop()}return c[0]},a.math_distance=function(a,b,c,d){return Math.sqrt((d-b)*(d-b)+(c-a)*(c-a))},a.math_angle=function(a,b,c,d){var e=a-c,f=b-d,g=180*Math.atan(f/e)/Math.PI;return g},a.easeIn=function(a,b,c,d){return c*(a/=d)*a+b},a.easeOut=function(a,b,c,d){return-c*(a/=d)*(a-2)+b},a.easeInOut=function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},a.mathDisplay2Dto3DWorldPos=function(a,b,c){void 0===c&&(c=300);var d=Scene_data.cam3D.cameraMatrix.clone(),e=Scene_data.viewMatrx3D.clone();d.invert(),e.invert();var f=new Vector3D;return f.x=b.x-a.x,f.y=b.y-a.y,f.x=2*f.x/a.width-1,f.y=1-2*f.y/a.height,f.w=c,f.x=f.x*f.w,f.y=f.y*f.w,f=e.transformVector(f),f.z=c,f=d.transformVector(f)},a}(),MathUtil=function(){function a(){}return a.mathDisplay2Dto3DWorldPos=function(a,b){void 0===b&&(b=300);var c=b/(Scene_data.sceneViewHW/2),d=Scene_data.sceneViewHW/2*c,e=Scene_data.stageWidth,f=Scene_data.stageHeight,g=new Matrix3D;g.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),g.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS);var h=Scene_data.viewMatrx3D.transformVector(new Vector3D(500,0,500)),i=h.x/h.w,j=e/2/i*c,k=f/2/i*c,l=a.x/e*j*2,m=a.y/f*k*2,n=this.gettempPos(new Vector3D(-j+l,+k-m,d),g);return n},a.getGroundPanelPos=function(a){var b=MathClass.mathDisplay2Dto3DWorldPos(new Rectangle(0,0,Scene_data.stageWidth,Scene_data.stageHeight),new Vector2D(a.x,a.y),300),c=new Array;c.push(new Vector3D(0,0,0)),c.push(new Vector3D(-100,0,100)),c.push(new Vector3D(100,0,100));var d=new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z);return this.getLinePlaneInterectPointByTri(d,b,c)},a.gettempPos=function(a,b){var c=b.transformVector(a);return c=c.add(new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z))},a.math3DWorldtoDisplay2DPos=function(a){var b=Scene_data.cam3D.cameraMatrix.clone();b.append(Scene_data.viewMatrx3D.clone());var c=Scene_data.stageWidth,d=Scene_data.stageHeight,e=b.transformVector(a),f=new Vector2D;return f.x=(e.x/e.w+1)*(c/2),f.y=(-e.y/e.w+1)*(d/2),f},a.argbToHex=function(a,b,c,d){var e=a<<24|b<<16|c<<8|d;return e},a.hexToArgb=function(a){var b=new Vector3D;return b.w=a>>24&255,b.x=a>>16&255,b.y=a>>8&255,b.z=255&a,b},a.getLinePlaneInterectPointByTri=function(a,b,c){if(c.length<3)return null;var d=new Vector3D(0,2e3,0);return this.getLineAndPlaneIntersectPoint(a,b,c[0],d)},a.getLineAndPlaneIntersectPoint=function(a,b,c,d){var e=new Vector3D(a.x-b.x,a.y-b.y,a.z-b.z);e.normalize();var f=e.x*d.x+e.y*d.y+e.z*d.z,g=((c.x-a.x)*d.x+(c.y-a.y)*d.y+(c.z-a.z)*d.z)/f,h=new Vector3D;return h.setTo(a.x+e.x*g,a.y+e.y*g,a.z+e.z*g),h},a.lookAt=function(a,b){var c=new Matrix3D;return c.buildLookAtLH(a,b,Vector3D.Y_AXIS),c},a}(),Matrix3D=function(){function a(){this.isIdentity=!0;var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this.m=new Float32Array(a)}return a.prototype.clone=function(b){return void 0===b&&(b=null),b||(b=new a),b.m[0]=this.m[0],b.m[1]=this.m[1],b.m[2]=this.m[2],b.m[3]=this.m[3],b.m[4]=this.m[4],b.m[5]=this.m[5],b.m[6]=this.m[6],b.m[7]=this.m[7],b.m[8]=this.m[8],b.m[9]=this.m[9],b.m[10]=this.m[10],b.m[11]=this.m[11],b.m[12]=this.m[12],b.m[13]=this.m[13],b.m[14]=this.m[14],b.m[15]=this.m[15],b},Object.defineProperty(a.prototype,"position",{get:function(){return new Vector3D(this.m[12],this.m[13],this.m[14],this.m[15])},enumerable:!0,configurable:!0}),a.prototype.copyTo=function(a){a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=this.m[4],a.m[5]=this.m[5],a.m[6]=this.m[6],a.m[7]=this.m[7],a.m[8]=this.m[8],a.m[9]=this.m[9],a.m[10]=this.m[10],a.m[11]=this.m[11],a.m[12]=this.m[12],a.m[13]=this.m[13],a.m[14]=this.m[14],a.m[15]=this.m[15]},a.prototype.identity=function(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=0,this.m[4]=0,this.m[5]=1,this.m[6]=0,this.m[7]=0,this.m[8]=0,this.m[9]=0,this.m[10]=1,this.m[11]=0,this.m[12]=0,this.m[13]=0,this.m[14]=0,this.m[15]=1},a.prototype.invert=function(){var a=this.m,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p,D=r*C-s*B+t*A+u*z-v*y+w*x;return D?(D=1/D,this.m[0]=(g*C-h*B+i*A)*D,this.m[1]=(d*B-c*C-e*A)*D,this.m[2]=(o*w-p*v+q*u)*D,this.m[3]=(l*v-k*w-m*u)*D,this.m[4]=(h*z-f*C-i*y)*D,this.m[5]=(b*C-d*z+e*y)*D,this.m[6]=(p*t-n*w-q*s)*D,this.m[7]=(j*w-l*t+m*s)*D,this.m[8]=(f*B-g*z+i*x)*D,this.m[9]=(c*z-b*B-e*x)*D,this.m[10]=(n*v-o*t+q*r)*D,this.m[11]=(k*t-j*v-m*r)*D,this.m[12]=(g*y-f*A-h*x)*D,this.m[13]=(b*A-c*y+d*x)*D,this.m[14]=(o*s-n*u-p*r)*D,void(this.m[15]=(j*u-k*s+l*r)*D)):null},a.prototype.invertToMatrix=function(a){var b=this.m,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a.m[0]=(h*D-i*C+j*B)*E,a.m[1]=(e*C-d*D-f*B)*E,a.m[2]=(p*x-q*w+r*v)*E,a.m[3]=(m*w-l*x-n*v)*E,a.m[4]=(i*A-g*D-j*z)*E,a.m[5]=(c*D-e*A+f*z)*E,a.m[6]=(q*u-o*x-r*t)*E,a.m[7]=(k*x-m*u+n*t)*E,a.m[8]=(g*C-h*A+j*y)*E,a.m[9]=(d*A-c*C-f*y)*E,a.m[10]=(o*w-p*u+r*s)*E,a.m[11]=(l*u-k*w-n*s)*E,a.m[12]=(h*z-g*B-i*y)*E,a.m[13]=(c*B-d*z+e*y)*E,a.m[14]=(p*t-o*v-q*s)*E,void(a.m[15]=(k*v-l*t+m*s)*E)):null},a.prototype.appendTranslation=function(b,c,d){a.tempM.identity(),a.tempM.prependTranslation(b,c,d),this.append(a.tempM)},a.prototype.prependTranslation=function(a,b,c){var d=this.m;d[12]=d[0]*a+d[4]*b+d[8]*c+d[12],d[13]=d[1]*a+d[5]*b+d[9]*c+d[13],d[14]=d[2]*a+d[6]*b+d[10]*c+d[14],d[15]=d[3]*a+d[7]*b+d[11]*c+d[15]},a.prototype.transformVector=function(a){var b=new Vector3D;return b.x=this.m[0]*a.x+this.m[4]*a.y+this.m[8]*a.z+this.m[12]*a.w,b.y=this.m[1]*a.x+this.m[5]*a.y+this.m[9]*a.z+this.m[13]*a.w,b.z=this.m[2]*a.x+this.m[6]*a.y+this.m[10]*a.z+this.m[14]*a.w,b.w=this.m[3]*a.x+this.m[7]*a.y+this.m[11]*a.z+this.m[15]*a.w,b},a.prototype.append=function(b){a.tempM.m[0]=b.m[0],a.tempM.m[1]=b.m[1],a.tempM.m[2]=b.m[2],a.tempM.m[3]=b.m[3],a.tempM.m[4]=b.m[4],a.tempM.m[5]=b.m[5],a.tempM.m[6]=b.m[6],a.tempM.m[7]=b.m[7],a.tempM.m[8]=b.m[8],a.tempM.m[9]=b.m[9],a.tempM.m[10]=b.m[10],a.tempM.m[11]=b.m[11],a.tempM.m[12]=b.m[12],a.tempM.m[13]=b.m[13],a.tempM.m[14]=b.m[14],a.tempM.m[15]=b.m[15],a.tempM.prepend(this),this.m[0]=a.tempM.m[0],this.m[1]=a.tempM.m[1],this.m[2]=a.tempM.m[2],this.m[3]=a.tempM.m[3],this.m[4]=a.tempM.m[4],this.m[5]=a.tempM.m[5],this.m[6]=a.tempM.m[6],this.m[7]=a.tempM.m[7],this.m[8]=a.tempM.m[8],this.m[9]=a.tempM.m[9],this.m[10]=a.tempM.m[10],this.m[11]=a.tempM.m[11],this.m[12]=a.tempM.m[12],this.m[13]=a.tempM.m[13],this.m[14]=a.tempM.m[14],this.m[15]=a.tempM.m[15]},a.prototype.prepend=function(a){var b=a.m,c=this.m,d=this.m,e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d[5],k=d[6],l=d[7],m=d[8],n=d[9],o=d[10],p=d[11],q=d[12],r=d[13],s=d[14],t=d[15],u=b[0],v=b[1],w=b[2],x=b[3];c[0]=u*e+v*i+w*m+x*q,c[1]=u*f+v*j+w*n+x*r,c[2]=u*g+v*k+w*o+x*s,c[3]=u*h+v*l+w*p+x*t,u=b[4],v=b[5],w=b[6],x=b[7],c[4]=u*e+v*i+w*m+x*q,c[5]=u*f+v*j+w*n+x*r,c[6]=u*g+v*k+w*o+x*s,c[7]=u*h+v*l+w*p+x*t,u=b[8],v=b[9],w=b[10],x=b[11],c[8]=u*e+v*i+w*m+x*q,c[9]=u*f+v*j+w*n+x*r,c[10]=u*g+v*k+w*o+x*s,c[11]=u*h+v*l+w*p+x*t,u=b[12],v=b[13],w=b[14],x=b[15],c[12]=u*e+v*i+w*m+x*q,c[13]=u*f+v*j+w*n+x*r,c[14]=u*g+v*k+w*o+x*s,c[15]=u*h+v*l+w*p+x*t},a.prototype.appendRotation=function(b,c){a.tempM.identity(),a.tempM.prependRotation(b,c),this.append(a.tempM)},a.prototype.tomat3=function(){var a=Array.prototype.concat.apply([],arguments);a=[1,0,0,0,1,0,0,0,1];var b=new Float32Array(a);return b[0]=this.m[0],b[1]=this.m[1],b[2]=this.m[2],b[3]=this.m[4],b[4]=this.m[5],b[5]=this.m[6],b[6]=this.m[8],b[7]=this.m[9],b[8]=this.m[10],b},a.prototype.getRotaion=function(a){a[0]=this.m[0],a[1]=this.m[1],a[2]=this.m[2],a[3]=this.m[4],a[4]=this.m[5],a[5]=this.m[6],a[6]=this.m[8],a[7]=this.m[9],a[8]=this.m[10]},a.prototype.identityPostion=function(){this.m[12]=0,this.m[13]=0,this.m[14]=0},Object.defineProperty(a.prototype,"x",{get:function(){return this.m[12]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.m[13]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"z",{get:function(){return this.m[14]},enumerable:!0,configurable:!0}),a.prototype.prependRotation=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this.m,B=this.m,C=b.x,D=b.y,E=b.z,F=Math.sqrt(C*C+D*D+E*E);return Math.abs(F)<1e-6?null:(F=1/F,C*=F,D*=F,E*=F,c=Math.sin(a*Math.PI/180),d=Math.cos(a*Math.PI/180),e=1-d,f=B[0],g=B[1],h=B[2],i=B[3],j=B[4],k=B[5],l=B[6],m=B[7],n=B[8],o=B[9],p=B[10],q=B[11],r=C*C*e+d,s=D*C*e+E*c,t=E*C*e-D*c,u=C*D*e-E*c,v=D*D*e+d,w=E*D*e+C*c,x=C*E*e+D*c,y=D*E*e-C*c,z=E*E*e+d,A[0]=f*r+j*s+n*t,A[1]=g*r+k*s+o*t,A[2]=h*r+l*s+p*t,A[3]=i*r+m*s+q*t,A[4]=f*u+j*v+n*w,A[5]=g*u+k*v+o*w,A[6]=h*u+l*v+p*w,A[7]=i*u+m*v+q*w,A[8]=f*x+j*y+n*z,A[9]=g*x+k*y+o*z,A[10]=h*x+l*y+p*z,A[11]=i*x+m*y+q*z,B!==A&&(A[12]=B[12],A[13]=B[13],A[14]=B[14],A[15]=B[15]),A)},a.prototype.prependScale=function(a,b,c){var d=this.m,e=this.m;return e[0]=d[0]*a,e[1]=d[1]*a,e[2]=d[2]*a,e[3]=d[3]*a,e[4]=d[4]*b,e[5]=d[5]*b,e[6]=d[6]*b,e[7]=d[7]*b,e[8]=d[8]*c,e[9]=d[9]*c,e[10]=d[10]*c,e[11]=d[11]*c,e[12]=d[12],e[13]=d[13],e[14]=d[14],e[15]=d[15],e},a.prototype.appendScale=function(b,c,d){a.tempM.identity(),a.tempM.prependScale(b,c,d),this.append(a.tempM)},a.prototype.perspectiveFieldOfViewLH=function(a,b,c,d){var e=1/Math.tan(a/2),f=e/b,g=this.m;g[0]=f,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=e,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=d/(d-c),g[11]=1,g[12]=0,g[13]=0,g[14]=c*d/(c-d),g[15]=0},a.prototype.fromVtoV=function(a,b){var c=a.cross(b),d=Math.acos(a.dot(b)),e=new Quaternion;e.fromAxisAngle(c,d),e.toMatrix3D(this)},a.prototype.buildLookAtLH=function(a,b,c){var d=this.m,e=new Vector3D;e.x=b.x-a.x,e.y=b.y-a.y,e.z=b.z-a.z,e.normalize();var f=c.cross(e);f.normalize();var g=e.cross(f);d[0]=f.x,d[1]=g.x,d[2]=e.x,d[3]=0,d[4]=f.y,d[5]=g.y,d[6]=e.y,d[7]=0,d[8]=f.z,d[9]=g.z,d[10]=e.z,d[11]=0,d[12]=-f.dot(a),d[13]=-g.dot(a),d[14]=-e.dot(a),d[15]=1},a.prototype.toEulerAngles=function(a){void 0===a&&(a=null);var b=new Quaternion;return b.fromMatrix(this),b.toEulerAngles(a)},a.tempM=new a,a}(),Quaternion=function(){function a(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),this.x=0,this.y=0,this.z=0,this.w=1,this.x=a,this.y=b,this.z=c,this.w=d}return a.prototype.print=function(){alert(String(this.x)+" "+String(this.y)+" "+String(this.z)+" "+String(this.w))},a.prototype.toEulerAngles=function(a){void 0===a&&(a=null),a||(a=new Vector3D);var b=this.x,c=this.y,d=this.z,e=this.w;return a.x=Math.atan2(2*(e*b+c*d),1-2*(b*b+c*c)),a.y=Math.asin(2*(e*c-d*b)),a.z=Math.atan2(2*(e*d+b*c),1-2*(c*c+d*d)),a},a.prototype.toMatrix3D=function(a){void 0===a&&(a=null),a||(a=new Matrix3D);var b=a.m,c=this.x,d=this.y,e=this.z,f=this.w,g=c+c,h=d+d,i=e+e,j=c*g,k=d*g,l=d*h,m=e*g,n=e*h,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-l-o,b[1]=k+r,b[2]=m-q,b[3]=0,b[4]=k-r,b[5]=1-j-o,b[6]=n+p,b[7]=0,b[8]=m+q,b[9]=n-p,b[10]=1-j-l,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,a},a.prototype.fromAxisAngle=function(a,b){var c=Math.sin(b/2),d=Math.cos(b/2);this.x=a.x*c,this.y=a.y*c,this.z=a.z*c,this.w=d,this.normalize()},a.prototype.normalize=function(a){void 0===a&&(a=1);var b=a/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);this.x*=b,this.y*=b,this.z*=b,this.w*=b},a.prototype.fromMatrix=function(a){var b=[0,0,0,0,0,0,0,0,0];b[0]=a.m[0],b[1]=a.m[1],b[2]=a.m[2],b[3]=a.m[4],b[4]=a.m[5],b[5]=a.m[6],b[6]=a.m[8],b[7]=a.m[9],b[8]=a.m[10];var c,d=b[0]+b[4]+b[8],e=[0,0,0,0];if(d>0)c=Math.sqrt(d+1),e[3]=.5*c,c=.5/c,e[0]=(b[5]-b[7])*c,e[1]=(b[6]-b[2])*c,e[2]=(b[1]-b[3])*c;else{var f=0;b[4]>b[0]&&(f=1),b[8]>b[3*f+f]&&(f=2);var g=(f+1)%3,h=(f+2)%3;c=Math.sqrt(b[3*f+f]-b[3*g+g]-b[3*h+h]+1),e[f]=.5*c,c=.5/c,e[3]=(b[3*g+h]-b[3*h+g])*c,e[g]=(b[3*g+f]+b[3*f+g])*c,e[h]=(b[3*h+f]+b[3*f+h])*c}this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3]},a.prototype.setMd5W=function(){this.w=1-(this.x*this.x+this.y*this.y+this.z*this.z),this.w<0?this.w=0:this.w=-Math.sqrt(this.w)},a.prototype.slerp=function(a,b,c){var d=a.w,e=a.x,f=a.y,g=a.z,h=b.w,i=b.x,j=b.y,k=b.z,l=d*h+e*i+f*j+g*k;if(0>l&&(l=-l,h=-h,i=-i,j=-j,k=-k),.95>l){var m=Math.acos(l),n=1/Math.sin(m),o=Math.sin(m*(1-c))*n,p=Math.sin(m*c)*n;this.w=d*o+h*p,this.x=e*o+i*p,this.y=f*o+j*p,this.z=g*o+k*p}else{this.w=d+c*(h-d),this.x=e+c*(i-e),this.y=f+c*(j-f),this.z=g+c*(k-g);var q=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=q,this.x*=q,this.y*=q,this.z*=q}},a}(),Vector3D=function(){function a(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),this.x=0,this.y=0,this.z=0,this.w=1,this.x=a,this.y=b,this.z=c,this.w=d}return a.prototype.normalize=function(){var a=this.length;0!=a&&this.scaleBy(1/a)},Object.defineProperty(a.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),a.prototype.scaleBy=function(a){this.x*=a,this.y*=a,this.z*=a,this.w*=a},a.prototype.divideScalar=function(a){0!=a?(this.x=this.x/a,this.y=this.y/a,this.z=this.z/a):(this.x=0,this.y=0,this.z=0)},a.prototype.distanceToSquared=function(b){return a.distance(this,b)},a.prototype.scaleByW=function(){this.x*=this.w,this.y*=this.w,this.z*=this.w},a.prototype.add=function(b){return new a(this.x+b.x,this.y+b.y,this.z+b.z)},a.prototype.subtract=function(b){return new a(this.x-b.x,this.y-b.y,this.z-b.z)},a.prototype.addByNum=function(a,b,c,d){void 0===d&&(d=0),this.x+=a,this.y+=b,this.z+=c,this.w+=d},a.prototype.setTo=function(a,b,c){this.x=a,this.y=b,this.z=c},a.prototype.setByte=function(a){this.x=a.readFloat(),this.y=a.readFloat(),this.z=a.readFloat()},a.prototype.cross=function(b){return new a(this.y*b.z-this.z*b.y,this.z*b.x-this.x*b.z,this.x*b.y-this.y*b.x)},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},a.prototype.clone=function(){return new a(this.x,this.y,this.z)},a.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.z-b.z;return Math.sqrt(c*c+d*d+e*e)},a.prototype.toString=function(){return"Vector3D("+String(this.x)+","+String(this.y)+","+String(this.z)+","+String(this.w)+")"},a.X_AXIS=new a(1,0,0),a.Y_AXIS=new a(0,1,0),a.Z_AXIS=new a(0,0,1),a}(),Vector2D=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this.x=0,this.y=0,this.x=a,this.y=b}return a.prototype.normalize=function(){var a=this.length;0!=a&&this.scaleBy(1/a)},Object.defineProperty(a.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),a.prototype.scaleBy=function(a){this.x*=a,this.y*=a},a.prototype.sub=function(b){return new a(b.x-this.x,b.y-this.y)},a.prototype.add=function(b){return new a(b.x+this.x,b.y+this.y)},a.prototype.toString=function(){return"Vector2D("+String(this.x)+","+String(this.y)+")"},a.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},a}(),Rectangle=function(){function a(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=1),void 0===d&&(d=1),this.x=0,this.y=0,this.width=0,this.height=1,this.x=a,this.y=b,this.width=c,this.height=d}return a.prototype.sets=function(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d},a.prototype.setRec=function(a){this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height},a.prototype.isHitByPoint=function(a,b){return a>=this.x&&b>=this.y&&a<=this.x+this.width&&b<=this.y+this.height},a}(),Circle=function(){function a(a,b,c){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),this.setData(a,b,c)}return a.prototype.setData=function(a,b,c){this.x=a,this.y=b,this.radius=c},a.prototype.setPos=function(a,b){this.x=a,this.y=b},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a},enumerable:!0,configurable:!0}),a.prototype.setRadius=function(a){this.radius=a},a.prototype.testPoint=function(a){var b=this.x-a.x,c=this.y-a.y;return Math.sqrt(b*b+c*c)<this.radius},a}(),Groundposition=function(){function a(){}return a.getGroundPos=function(a,b){var c=-500;if(!this._plantObjectMath){var d=new Vector3D(0,c,500),e=new Vector3D(-500,c,0),f=new Vector3D(500,c,0);this._plantObjectMath=Calculation._PanelEquationFromThreePt(d,e,f),this._plantnormal=new Vector3D(this._plantObjectMath.a,this._plantObjectMath.b,this._plantObjectMath.c),this._plantnormal.normalize(),this._plane_a=new Vector3D(d.x,d.y,d.z)}var g=MathUtil.mathDisplay2Dto3DWorldPos(new Vector2D(a,b),500),h=new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z),i=Calculation.calPlaneLineIntersectPoint(this._plantnormal,this._plane_a,g,h);return i},a}(),ObjectMath=function(){function a(){this.a=0,this.b=0,this.c=0,this.d=0}return a}(),Calculation=function(){function a(){}return a._PanelEquationFromThreePt=function(a,b,c){var d=(b.y-a.y)*(c.z-a.z)-(b.z-a.z)*(c.y-a.y),e=(b.z-a.z)*(c.x-a.x)-(b.x-a.x)*(c.z-a.z),f=(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x),g=0-(d*a.x+e*a.y+f*a.z),h=new ObjectMath;return h.a=d,h.b=e,h.c=f,h.d=g,h},a.calPlaneLineIntersectPoint=function(a,b,c,d){var e=new Vector3D,f=a.x,g=a.y,h=a.z,i=b.x,j=b.y,k=b.z,l=c.x-d.x,m=c.y-d.y,n=c.z-d.z,o=d.x,p=d.y,q=d.z,r=l*f+m*g+n*h;if(0==r)return null;var s=((i-o)*f+(j-p)*g+(k-q)*h)/r;return e.x=o+l*s,e.y=p+m*s,e.z=q+n*s,e},a}(),Endian=function(){function a(){}return a.LITTLE_ENDIAN="littleEndian",a.BIG_ENDIAN="bigEndian",a}(),ByteArray=function(){function a(a){this.BUFFER_EXT_SIZE=0,this.optcode=0,this.EOF_byte=-1,this.EOF_code_point=-1,this._setArrayBuffer(a||new ArrayBuffer(this.BUFFER_EXT_SIZE)),this.endian=Endian.BIG_ENDIAN}return a.prototype._setArrayBuffer=function(a){this.write_position=a.byteLength,this.data=new DataView(a),this._position=0},a.prototype.setdata=function(a){this._setArrayBuffer(a.buffer)},Object.defineProperty(a.prototype,"buffer",{get:function(){return this.data.buffer},set:function(a){this.data=new DataView(a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dataView",{get:function(){return this.data},set:function(a){this.data=a,this.write_position=a.byteLength},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),a.prototype.getByte=function(a){return this.data.getUint8(a)},a.prototype.setByte=function(a,b){this.data.setUint8(a,b)},Object.defineProperty(a.prototype,"position",{get:function(){return this._position},set:function(a){this._position=a,this.write_position=a>this.write_position?a:this.write_position},enumerable:!0,configurable:!0}),a.prototype.reset=function(){this.clear()},Object.defineProperty(a.prototype,"length",{get:function(){return this.write_position},set:function(a){this.validateBuffer(a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),a.prototype.clear=function(){this._setArrayBuffer(new ArrayBuffer(this.BUFFER_EXT_SIZE))},a.prototype.readBoolean=function(){return 0!=this.data.getUint8(this.position++)},a.prototype.readByte=function(){return this.data.getInt8(this.position++)},a.prototype.readBytes=function(a,b,c){void 0===b&&(b=0),void 0===c&&(c=0);for(var d=0;c>d;d++)a.data.setUint8(d+b,this.data.getUint8(this.position++))},a.prototype.readDouble=function(){var b=this.data.getFloat64(this.position,this.endian==Endian.LITTLE_ENDIAN);return this.position+=a.SIZE_OF_FLOAT64,b},a.prototype.readFloat=function(){var b=this.data.getFloat32(this.position,this.endian==Endian.LITTLE_ENDIAN);return this.position+=a.SIZE_OF_FLOAT32,b},a.prototype.readInt=function(){var b=this.data.getInt32(this.position,this.endian==Endian.LITTLE_ENDIAN);return this.position+=a.SIZE_OF_INT32,b},a.prototype.getInt=function(){var a=this.data.getInt32(this.position,this.endian==Endian.LITTLE_ENDIAN);return a},a.prototype.readInt32=function(){return this.readInt()},a.prototype.readShort=function(){this.position>=this.data.byteLength&&console.log("readShort");var b=this.data.getInt16(this.position,this.endian==Endian.LITTLE_ENDIAN);return this.position+=a.SIZE_OF_INT16,b},a.prototype.readFloatTwoByte=function(a){return this.readShort()/a},a.prototype.readFloatOneByte=function(){return(this.readByte()+128)/256},a.prototype.readUnsignedByte=function(){return this.data.getUint8(this.position++)},a.prototype.readUint8=function(){return this.readUnsignedByte()},a.prototype.readInt8=function(){return this.readByte()},a.prototype.readUnsignedInt=function(){var b=this.data.getUint32(this.position,this.endian==Endian.LITTLE_ENDIAN);return this.position+=a.SIZE_OF_UINT32,b},a.prototype.readUint32=function(){return this.readUnsignedInt()},a.prototype.readUint64=function(){return this.readDouble()},a.prototype.readUnsignedShort=function(){var b=this.data.getUint16(this.position,this.endian==Endian.LITTLE_ENDIAN);return this.position+=a.SIZE_OF_UINT16,b},a.prototype.readUint16=function(){return this.readUnsignedShort()},a.prototype.readUTF=function(){var b=this.data.getUint16(this.position,this.endian==Endian.LITTLE_ENDIAN);return this.position+=a.SIZE_OF_UINT16,b>0?this.readUTFBytes(b):""},a.prototype.readString=function(){return this.readUTF()},a.prototype.readUTFBytes=function(a){var b=new Uint8Array(this.buffer,this.bufferOffset+this.position,a);return this.position+=a,this.decodeUTF8(b)},a.prototype.readStringByLen=function(a){return this.readUTFBytes(a)},a.prototype.writeBoolean=function(b){this.validateBuffer(a.SIZE_OF_BOOLEAN),this.data.setUint8(this.position++,b?1:0)},a.prototype.writeByte=function(b){this.validateBuffer(a.SIZE_OF_INT8),this.data.setInt8(this.position++,b)},a.prototype.writeUint8=function(a){this.writeByte(a)},a.prototype.writeInt8=function(a){this.writeByte(a)},a.prototype.writeBytes=function(a,b,c){void 0===b&&(b=0),void 0===c&&(c=0);var d;if(!(0>b)&&!(0>c)&&(d=0==c?a.length-b:Math.min(a.length-b,c),d>0)){this.validateBuffer(d);for(var e=new DataView(a.buffer),f=b;d+b>f;f++)this.data.setUint8(this.position++,e.getUint8(f))}},a.prototype.writeDouble=function(b){this.validateBuffer(a.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,b,this.endian==Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_FLOAT64},a.prototype.writeFloat=function(b){this.validateBuffer(a.SIZE_OF_FLOAT32),this.data.setFloat32(this.position,b,this.endian==Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_FLOAT32},a.prototype.writeInt=function(b){this.validateBuffer(a.SIZE_OF_INT32),this.data.setInt32(this.position,b,this.endian==Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_INT32},a.prototype.writeInt32=function(a){this.writeInt(a)},a.prototype.writeUnsignedShort=function(b){this.validateBuffer(a.SIZE_OF_INT16),this.data.setInt16(this.position,b,this.endian==Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_INT16},a.prototype.writeUint16=function(a){this.writeUnsignedShort(a)},a.prototype.writeUint64=function(b){this.validateBuffer(a.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,b,this.endian==Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_FLOAT64},a.prototype.writeShort=function(b){this.validateBuffer(a.SIZE_OF_INT16),this.data.setUint16(this.position,b,this.endian==Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_INT16},a.prototype.writeUnsignedInt=function(b){this.validateBuffer(a.SIZE_OF_UINT32),this.data.setUint32(this.position,b,this.endian==Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_UINT32},a.prototype.writeUint32=function(a){this.writeUnsignedInt(a)},a.prototype.writeUTF=function(b){var c=this.encodeUTF8(b),d=c.length;this.validateBuffer(a.SIZE_OF_UINT16+d),this.data.setUint16(this.position,d,this.endian===Endian.LITTLE_ENDIAN),this.position+=a.SIZE_OF_UINT16,this._writeUint8Array(c,!1)},a.prototype.writeString=function(b){var c=new a;c.writeUTFBytes(b),this.writeUint16(c.length+1),this.writeBytes(c,0,c.length),this.writeByte(0)},a.prototype.writeStringByLen=function(a,b){var c=this.position;this.writeUTFBytes(a),this.position=c+b,this.length=this.position+1},a.prototype.readVector3D=function(a){void 0===a&&(a=!1);var b=new Vector3D;return b.x=this.readFloat(),b.y=this.readFloat(),b.z=this.readFloat(),a&&(b.w=this.readFloat()),b},a.prototype.writeUTFBytes=function(a){this._writeUint8Array(this.encodeUTF8(a))},a.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},a.prototype._writeUint8Array=function(a,b){void 0===b&&(b=!0),b&&this.validateBuffer(this.position+a.length);for(var c=0;c<a.length;c++)this.data.setUint8(this.position++,a[c])},a.prototype.validate=function(a){return this.data.byteLength>0&&this._position+a<=this.data.byteLength?!0:void 0},a.prototype.validateBuffer=function(a,b){if(void 0===b&&(b=!1),this.write_position=a>this.write_position?a:this.write_position,a+=this._position,this.data.byteLength<a||b){var c=new Uint8Array(new ArrayBuffer(a+this.BUFFER_EXT_SIZE)),d=Math.min(this.data.buffer.byteLength,a+this.BUFFER_EXT_SIZE);c.set(new Uint8Array(this.data.buffer,0,d)),this.buffer=c.buffer}},a.prototype.encodeUTF8=function(a){for(var b=0,c=this.stringToCodePoints(a),d=[];c.length>b;){var e=c[b++];if(this.inRange(e,55296,57343))this.encoderError(e);else if(this.inRange(e,0,127))d.push(e);else{var f,g;for(this.inRange(e,128,2047)?(f=1,g=192):this.inRange(e,2048,65535)?(f=2,g=224):this.inRange(e,65536,1114111)&&(f=3,g=240),d.push(this.div(e,Math.pow(64,f))+g);f>0;){var h=this.div(e,Math.pow(64,f-1));d.push(128+h%64),f-=1}}}return new Uint8Array(d)},a.prototype.decodeUTF8=function(a){for(var b,c=!1,d=0,e="",f=0,g=0,h=0,i=0;a.length>d;){var j=a[d++];if(j===this.EOF_byte)b=0!==g?this.decoderError(c):this.EOF_code_point;else if(0===g)this.inRange(j,0,127)?b=j:(this.inRange(j,194,223)?(g=1,i=128,f=j-192):this.inRange(j,224,239)?(g=2,i=2048,f=j-224):this.inRange(j,240,244)?(g=3,i=65536,f=j-240):this.decoderError(c),f*=Math.pow(64,g),b=null);else if(this.inRange(j,128,191))if(h+=1,f+=(j-128)*Math.pow(64,g-h),h!==g)b=null;else{var k=f,l=i;f=0,g=0,h=0,i=0,b=this.inRange(k,l,1114111)&&!this.inRange(k,55296,57343)?k:this.decoderError(c,j)}else f=0,g=0,h=0,i=0,d--,b=this.decoderError(c,j);null!==b&&b!==this.EOF_code_point&&(65535>=b?b>0&&(e+=String.fromCharCode(b)):(b-=65536,e+=String.fromCharCode(55296+(b>>10&1023)),e+=String.fromCharCode(56320+(1023&b))))}return e},a.prototype.encoderError=function(a){},a.prototype.decoderError=function(a,b){return b||65533},a.prototype.inRange=function(a,b,c){return a>=b&&c>=a},a.prototype.div=function(a,b){return Math.floor(a/b)},a.prototype.stringToCodePoints=function(a){for(var b=[],c=0,d=a.length;c<a.length;){var e=a.charCodeAt(c);if(this.inRange(e,55296,57343))if(this.inRange(e,56320,57343))b.push(65533);else if(c===d-1)b.push(65533);else{
var f=a.charCodeAt(c+1);if(this.inRange(f,56320,57343)){var g=1023&e,h=1023&f;c+=1,b.push(65536+(g<<10)+h)}else b.push(65533)}else b.push(e);c+=1}return b},a.SIZE_OF_BOOLEAN=1,a.SIZE_OF_INT8=1,a.SIZE_OF_INT16=2,a.SIZE_OF_INT32=4,a.SIZE_OF_UINT8=1,a.SIZE_OF_UINT16=2,a.SIZE_OF_UINT32=4,a.SIZE_OF_FLOAT32=4,a.SIZE_OF_FLOAT64=8,a}(),TestTriangle=function(){function a(a,b,c,d){void 0===a&&(a=null),void 0===b&&(b=null),void 0===c&&(c=null),void 0===d&&(d=.1),this.p1=a,this.p2=b,this.p3=c,this.precision=d}return a.prototype.setAllPoint=function(a,b,c){this.p1=a,this.p2=b,this.p3=c},a.prototype.checkPointIn=function(b){var c=this.getArea(),d=0;return d+=a.getAreaByPoints(b,this.p1,this.p2),d+=a.getAreaByPoints(b,this.p2,this.p3),d+=a.getAreaByPoints(b,this.p3,this.p1),d==c||Math.abs(d-c)<this.precision},a.prototype.getArea=function(){return a.getAreaByPoints(this.p1,this.p2,this.p3)},a.getAreaByPoints=function(a,b,c){var d=a.x-b.x,e=a.y-b.y,f=Math.sqrt(d*d+e*e);d=b.x-c.x,e=b.y-c.y;var g=Math.sqrt(d*d+e*e);d=c.x-a.x,e=c.y-a.y;var h=Math.sqrt(d*d+e*e),i=(f+g+h)/2,j=i*(i-f)*(i-g)*(i-h);return j>0?Math.sqrt(j):0},a.baseTri=new a,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ProgrmaManager=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.getProgram=function(a){return this._dic[a]?this._dic[a]:(alert("please registe Program=>"+a),null)},b.prototype.registe=function(a,b){this._dic[a]||(b.encode(),b.useNum=1,b.name=a,this._dic[a]=b)},b.prototype.getMaterialProgram=function(a,b,c,d,e){void 0===d&&(d=null),void 0===e&&(e=!1);var f=a+"_"+c.url;if(d){for(var g=0;g<d.length;g++)f+="_"+d[g];f+=e?"true_":"false_"}if(this._dic[f])return this._dic[f].useNum++,this._dic[f];e&&(d=[c.usePbr,c.useNormal,c.hasFresnel,c.useDynamicIBL,c.lightProbe,c.directLight,c.noLight,c.fogMode]);var h=new b;h.paramAry=d,h.fragment=c.shaderStr;var i=h.encode();return h.useNum++,i||(console.log("**********错误"+f),console.log(h.vertex),console.log(h.fragment)),this._dic[f]=h,h},b.prototype.outShader=function(a){var b=a.split("\n");console.log("----");for(var c=0;c<b.length;c++){var d='"';d+=b[c],c<b.length-1?(d+="\\n",d+='"',d+="+"):d+='"',console.log(d)}console.log("----")},b.prototype.gc=function(){a.prototype.gc.call(this)},b}(ResGC),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Shader3D=function(a){function b(){var b=a.call(this)||this;return b.fragment=b.getFragmentShaderString(),b}return __extends(b,a),b.prototype.encode=function(){this.vertex=this.getVertexShaderString();var a=Scene_data.context3D.renderContext;this.program=a.createProgram(),this.vShader=a.createShader(a.VERTEX_SHADER),this.fShader=a.createShader(a.FRAGMENT_SHADER),a.shaderSource(this.vShader,this.vertex),a.shaderSource(this.fShader,this.fragment),a.compileShader(this.vShader),a.compileShader(this.fShader),a.attachShader(this.program,this.vShader),a.attachShader(this.program,this.fShader),this.binLocation(a),a.linkProgram(this.program),this.localDic=new Object;var b=a.getProgramInfoLog(this.program),c=a.getShaderInfoLog(this.vShader),d=a.getShaderInfoLog(this.fShader);return""!=b?""==c&&""==d?!0:(console.log("shader error: "+b+","+c+","+d),!1):!0},b.prototype.getWebGLUniformLocation=function(a){var b=this.localDic[a];return b?b:(this.localDic[a]=Scene_data.context3D.getLocation(this.program,a),this.localDic[a])},b.prototype.binLocation=function(a){},b.prototype.getVertexShaderString=function(){return""},b.prototype.getFragmentShaderString=function(){return""},b.prototype.destory=function(){this.vertex=null,this.fragment=null,this.name=null,this.localDic=null,Scene_data.context3D.deleteShader(this)},b}(ResCount),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BuildShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v2CubeTexST")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Position;attribute vec2 v2CubeTexST;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2CubeTexST.x, v2CubeTexST.y);   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nuniform vec4 testconst;uniform vec4 testconst2;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\nvec4 test = vec4(0,0,0,1);\ntest.xyz = mix(vec3(1,1,1)*0.5,testconst.xyz,0.5);\ninfoUv.xyz = test.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}";return a},b.buildShader="BuildShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MaterialShader=function(a){function b(){var b=a.call(this)||this;return b.name="Material_shader",b}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v2CubeTexST");var b=this.paramAry[0],c=this.paramAry[1],d=(this.paramAry[4],this.paramAry[5]),e=this.paramAry[6];d||e||a.bindAttribLocation(this.program,2,"v2lightuv"),b?(a.bindAttribLocation(this.program,3,"v3Normal"),c&&(a.bindAttribLocation(this.program,4,"v3Tangent"),a.bindAttribLocation(this.program,5,"v3Bitangent"))):d&&a.bindAttribLocation(this.program,3,"v3Normal")},b.prototype.getVertexShaderString=function(){var a=this.paramAry[0],b=this.paramAry[1],c=(this.paramAry[2],this.paramAry[3],this.paramAry[4],this.paramAry[5]),d=this.paramAry[6],e=this.paramAry[7],f="attribute vec3 v3Position;\nattribute vec2 v2CubeTexST;\nvarying vec2 v0;\n";return c?f+="varying vec3 v2;\n":d||(f+="attribute vec2 v2lightuv;\nvarying vec2 v2;\n"),a?(f+="attribute vec3 v3Normal;\nvarying vec3 v1;\n",f+=b?"varying mat3 v4;\n":"varying vec3 v4;\n"):0!=e&&(f+="varying vec3 v1;\n"),b&&(f+="attribute vec3 v3Tangent;\nattribute vec3 v3Bitangent;\n"),c&&(a||(f+="attribute vec3 v3Normal;\n"),f+="uniform vec3 sunDirect;\nuniform vec3 sunColor;\nuniform vec3 ambientColor;\n"),f+="uniform mat4 vpMatrix3D;\nuniform mat4 posMatrix3D;\nuniform mat3 rotationMatrix3D;\n",f+="void main(void){\nv0 = vec2(v2CubeTexST.x, v2CubeTexST.y);\nvec4 vt0= vec4(v3Position, 1.0);\nvt0 = posMatrix3D * vt0;\n",c||d||(f+="v2 = vec2(v2lightuv.x, v2lightuv.y);\n"),(a||0!=e)&&(f+="v1 = vec3(vt0.x,vt0.y,vt0.z);\n"),f+="vt0 = vpMatrix3D * vt0;\n",a&&(f+=b?"v4 = mat3(rotationMatrix3D * v3Tangent,rotationMatrix3D * v3Bitangent, rotationMatrix3D * v3Normal);\n":"v4 = rotationMatrix3D * v3Normal;\n"),c&&(f+=a?"float suncos = dot(v4.xyz,sunDirect.xyz);\n":"vec3 n = rotationMatrix3D * v3Normal;\nfloat suncos = dot(n.xyz,sunDirect.xyz);\n",f+="suncos = clamp(suncos,0.0,1.0);\nv2 = sunColor * suncos + ambientColor;"),f+="gl_Position = vt0;}"},b.prototype.outstr=function(a){for(var b=a.split(";"),c=0;c<b.length;c++){var d=String(trim(b[c]));console.log('"'+d+';"+')}},b.prototype.getFragmentShaderString=function(){var a="uniform sampler2D s_texture1;\nuniform vec4 testconst;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz = testconst.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}";return a},b.MATERIAL_SHADER="Material_shader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MaterialAnimShader=function(a){function b(){var b=a.call(this)||this;return b.name="Material_Anim_shader",b}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"pos"),a.bindAttribLocation(this.program,1,"v2Uv"),a.bindAttribLocation(this.program,2,"boneID"),a.bindAttribLocation(this.program,3,"boneWeight");var b=this.paramAry[0],c=this.paramAry[1],d=this.paramAry[4],e=this.paramAry[5];b?(a.bindAttribLocation(this.program,4,"normal"),c&&(a.bindAttribLocation(this.program,5,"tangent"),a.bindAttribLocation(this.program,6,"bitangent"))):(d||e)&&a.bindAttribLocation(this.program,4,"normal")},b.getMd5M44Str=function(){var a="vec4 qdv(vec4 q,vec3 d, vec3 v ){\nvec3 t = 2.0 * cross(q.xyz, v);\nvec3 f = v + q.w * t + cross(q.xyz, t);\nreturn  vec4(f.x+d.x,f.y+d.y,f.z+d.z,1.0);\n }\nvec4 getQDdata(vec3 vdata){\nvec4 tempnum = qdv(boneQ[int(boneID.x)],boneD[int(boneID.x)],vdata) * boneWeight.x;\ntempnum += qdv(boneQ[int(boneID.y)],boneD[int(boneID.y)],vdata) * boneWeight.y;\ntempnum += qdv(boneQ[int(boneID.z)],boneD[int(boneID.z)],vdata)* boneWeight.z;\ntempnum += qdv(boneQ[int(boneID.w)],boneD[int(boneID.w)],vdata) * boneWeight.w;\ntempnum.x = tempnum.x*-1.0;\nreturn  tempnum;\n }\n";return a},b.getMd5M44NrmStr=function(){var a="vec4 qdvNrm(vec4 q, vec3 v ){\nvec3 t = 2.0 * cross(q.xyz, v);\nvec3 f = v + q.w * t + cross(q.xyz, t);\nreturn  vec4(f.x,f.y,f.z,1.0);\n }\nvec4 getQDdataNrm(vec3 vdata){\nvec4 tempnum = qdvNrm(boneQ[int(boneID.x)],vdata) * boneWeight.x;\ntempnum += qdvNrm(boneQ[int(boneID.y)],vdata) * boneWeight.y;\ntempnum += qdvNrm(boneQ[int(boneID.z)],vdata)* boneWeight.z;\ntempnum += qdvNrm(boneQ[int(boneID.w)],vdata) * boneWeight.w;\ntempnum.x = tempnum.x*-1.0;\ntempnum.xyz = normalize(tempnum.xyz);\nreturn  tempnum;\n }\n";return a},b.prototype.getVertexShaderString=function(){var a=this.paramAry[0],c=this.paramAry[1],d=(this.paramAry[2],this.paramAry[3],this.paramAry[4]),e=this.paramAry[5],f=this.paramAry[6],g="attribute vec4 pos;\nattribute vec2 v2Uv;\nattribute vec4 boneID;\nattribute vec4 boneWeight;\nvarying vec2 v0;\nuniform vec4 boneQ[54];\nuniform vec3 boneD[54];\nuniform mat4 vpMatrix3D;\nuniform mat4 posMatrix3D;\n";return d?g+="uniform vec3 sh[9];\nvarying vec3 v2;\n":e?g+="uniform vec3 sunDirect;\nuniform vec3 sunColor;\nuniform vec3 ambientColor;\nvarying vec3 v2;\n":f||(g+="varying vec2 v2;\n"),a?(g+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\nvarying vec3 v1;\n",g+=c?"varying mat3 v4;\n":"varying vec3 v4;\n",c&&(g+="attribute vec4 tangent;\nattribute vec4 bitangent;\n")):(d||e)&&(g+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\n"),g+=b.getMd5M44Str()+b.getMd5M44NrmStr()+"void main(void){\nv0 = v2Uv;\nvec4 vt0 = getQDdata(vec3(pos.x,pos.y,pos.z));\nvt0.xyz = vt0.xyz*1.0;\nvt0 = posMatrix3D * vt0;\n",a&&(g+="v1 = vec3(vt0.x,vt0.y,vt0.z);\n"),g+="vt0 = vpMatrix3D * vt0;\ngl_Position = vt0;\n",a?g+=c?"vec4 vt2 = getQDdataNrm(vec3(tangent.x,tangent.y,tangent.z));\nvt2 = rotationMatrix3D * vt2;\nvt2.xyz = normalize(vt2.xyz);\nvec4 vt1 = getQDdataNrm(vec3(bitangent.x,bitangent.y,bitangent.z));\nvt1 = rotationMatrix3D * vt1;\nvt1.xyz = normalize(vt1.xyz);\nvt0 = getQDdataNrm(vec3(normal.x,normal.y,normal.z));\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = mat3(vec3(vt2.x,vt2.y,vt2.z),vec3(vt1.x,vt1.y,vt1.z),vec3(vt0.x,vt0.y,vt0.z));\n":"vt0 = getQDdataNrm(vec3(normal.x,normal.y,normal.z));\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = vec3(vt0.x,vt0.y,vt0.z);\n":(d||e)&&(g+="vt0 = getQDdataNrm(vec3(normal.x,normal.y,normal.z));\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\n"),d?g+="vec3 lpb = sh[0] * 0.28209479177387814;\nlpb += sh[1] * (vt0.y * -0.4886025119029199);\nlpb += sh[2] * (vt0.z * 0.4886025119029199);\nlpb += sh[3] * (vt0.x * -0.4886025119029199);\nlpb += sh[4] * (vt0.x * vt0.y * 1.0925484305920792);\nlpb += sh[5] * (vt0.z * vt0.y * -1.0925484305920792);\nlpb += sh[6] * ((3.0 * vt0.z * vt0.z - 1.0) * 0.31539156525252005);\nlpb += sh[7] * (vt0.z * vt0.x * -1.0925484305920792);\nlpb += sh[8] * ((vt0.x * vt0.x - vt0.y * vt0.y) * 0.5462742152960396);\nv2 = lpb;\n":e?g+="float suncos = dot(vt0.xyz,sunDirect.xyz);\nsuncos = clamp(suncos,0.0,1.0);\nv2 = sunColor * suncos + ambientColor;":f||(g+="v2 = v2Uv;\n"),g+="}"},b.prototype.getFragmentShaderString=function(){var a="uniform sampler2D s_texture1;\nuniform vec4 testconst;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz = testconst.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}";return a},b.MATERIAL_ANIM_SHADER="Material_Anim_shader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MaterialBatchAnimShader=function(a){function b(){var b=a.call(this)||this;return b.name="Material_Batch_Anim_Shader",b}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"pos"),a.bindAttribLocation(this.program,1,"v2Uv"),a.bindAttribLocation(this.program,2,"boneID"),a.bindAttribLocation(this.program,3,"boneWeight");var b=this.paramAry[0],c=this.paramAry[1],d=this.paramAry[4],e=this.paramAry[5];b?(a.bindAttribLocation(this.program,4,"normal"),c&&(a.bindAttribLocation(this.program,5,"tangent"),a.bindAttribLocation(this.program,6,"bitangent"))):(d||e)&&a.bindAttribLocation(this.program,4,"normal")},b.prototype.getVertexShaderString=function(){var a=this.paramAry[0],b=this.paramAry[1],c=(this.paramAry[2],this.paramAry[3],this.paramAry[4]),d=this.paramAry[5],e=this.paramAry[6],f="precision mediump float;\nattribute vec4 pos;\nattribute vec3 v2Uv;\nattribute vec4 boneID;\nattribute vec4 boneWeight;\nvarying vec2 v0;\nuniform mat4 bone[19];\nuniform mat4 viewMatrix3D;\nuniform mat4 camMatrix3D;\nuniform mat4 posMatrixAry[6];\n";return c?f+="varying vec3 v2;\n":d?f+="uniform vec3 sunDirect;\nuniform vec3 sunColor;\nuniform vec3 ambientColor;\nvarying vec3 v2;\n":e||(f+="varying vec2 v2;\n"),a?(f+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\nvarying vec3 v1;\n",f+=b?"varying mat3 v4;\n":"varying vec3 v4;\n",b&&(f+="attribute vec4 tangent;\nattribute vec4 bitangent;\n")):(c||d)&&(f+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\n"),f+="void main(void){\nv0 = vec2(v2Uv.xy);\nvec4 vt0 = bone[int(boneID.x)] * pos * boneWeight.x;\nvt0 += bone[int(boneID.y)] * pos * boneWeight.y;\nvt0 += bone[int(boneID.z)] * pos * boneWeight.z;\nvt0 += bone[int(boneID.w)] * pos * boneWeight.w;\nvt0 = posMatrixAry[int(v2Uv.z)] * vt0;\n",a&&(f+="v1 = vec3(vt0.x,vt0.y,vt0.z);\n"),f+="vt0 = camMatrix3D * vt0;\nvt0 = viewMatrix3D * vt0;\ngl_Position = vt0;\n",a?f+=b?"vec4 vt2 = bone[int(boneID.x)] * tangent * boneWeight.x;\nvt2 += bone[int(boneID.y)] * tangent * boneWeight.y;\nvt2 += bone[int(boneID.z)] * tangent * boneWeight.z;\nvt2 += bone[int(boneID.w)] * tangent * boneWeight.w;\nvt2 = rotationMatrix3D * vt2;\nvt2.xyz = normalize(vt2.xyz);\nvec4 vt1 = bone[int(boneID.x)] * bitangent * boneWeight.x;\nvt1 += bone[int(boneID.y)] * bitangent * boneWeight.y;\nvt1 += bone[int(boneID.z)] * bitangent * boneWeight.z;\nvt1 += bone[int(boneID.w)] * bitangent * boneWeight.w;\nvt1 = rotationMatrix3D * vt1;\nvt1.xyz = normalize(vt1.xyz);\nvt0 = bone[int(boneID.x)] * normal * boneWeight.x;\nvt0 += bone[int(boneID.y)] * normal * boneWeight.y;\nvt0 += bone[int(boneID.z)] * normal * boneWeight.z;\nvt0 += bone[int(boneID.w)] * normal * boneWeight.w;\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = mat3(vec3(vt2.x,vt2.y,vt2.z),vec3(vt1.x,vt1.y,vt1.z),vec3(vt0.x,vt0.y,vt0.z));\n":"vt0 = bone[int(boneID.x)] * normal * boneWeight.x;\nvt0 += bone[int(boneID.y)] * normal * boneWeight.y;\nvt0 += bone[int(boneID.z)] * normal * boneWeight.z;\nvt0 += bone[int(boneID.w)] * normal * boneWeight.w;\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = vec3(vt0.x,vt0.y,vt0.z);\n":(c||d)&&(f+="vt0 = bone[int(boneID.x)] * normal * boneWeight.x;\nvt0 += bone[int(boneID.y)] * normal * boneWeight.y;\nvt0 += bone[int(boneID.z)] * normal * boneWeight.z;\nvt0 += bone[int(boneID.w)] * normal * boneWeight.w;\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\n"),c?f+="vec3 lpb = normalize(vec3(1.0,1.0,-1.0));\nfloat lp = min(0.0,dot(lpb,vec3(vt0.xyz)));\nlp = lp * 2.0 + 0.7;\nv2 = vec3(lp,lp,lp);\n":d?f+="float suncos = dot(vt0.xyz,sunDirect.xyz);\nsuncos = clamp(suncos,0.0,1.0);\nv2 = sunColor * suncos + ambientColor;":e||(f+="v2 = v2Uv;\n"),f+="}"},b.prototype.getFragmentShaderString=function(){var a="uniform sampler2D s_texture1;\nuniform vec4 testconst;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz = testconst.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}";return a},b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkyShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v3Normal")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Position;attribute vec3 v3Normal;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec3 vNormal;void main(void){   vNormal = vec3(v3Normal.x, v3Normal.y,v3Normal.z);   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;\nuniform samplerCube s_texture;\nvarying vec3 vNormal;\nvoid main(void)\n{\nvec4 infoUv = textureCube(s_texture, vNormal);\ngl_FragColor = infoUv;\n}";return a},b.Sky_Shader="SkyShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DShadowShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform vec4 pos[30];varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2uv.x, v2uv.y);   vec3 vt1= vec3(v3Pos.xyz * pos[int(v2uv.z)].w + pos[int(v2uv.z)].xyz);   vec4 vt0= vec4(vt1, 1.0);   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}";return a},b.Display3DShadowShader="Display3DShadowShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform vec4 ui[50];uniform vec4 ui2[50];varying vec2 v_texCoord;void main(void){   vec4 data = ui2[int(v2uv.z)];   v_texCoord = vec2(v2uv.x * data.x + data.z, v2uv.y * data.y + data.w);   data = ui[int(v2uv.z)];   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy * data.zw * 2.0;   pos.x += data.x * 2.0 - 1.0;   pos.y += -data.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}";return a},b.UI_SHADER="UIShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIImageShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec2 v2uv;uniform vec2 scale;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2uv.x, v2uv.y);   vec4 vt0= vec4(v3Pos.x*scale.x,v3Pos.y*scale.y,v3Pos.z,1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nuniform float alpha;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.w = alpha;\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}";return a},b.UI_IMG_SHADER="UI_img_Shader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIMaskShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;uniform vec4 ui;void main(void){   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy * ui.zw * 2.0;   pos.x += ui.x * 2.0 - 1.0;   pos.y += -ui.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nvoid main(void)\n{\ngl_FragColor = vec4(0.5,0.5,0.5,1.0);\n}";return a},b.UI_MASK_SHADER="UImaskShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Movie2DShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform mat4 viewMatrix3D;\nuniform mat4 camMatrix3D;\nuniform mat4 watchCamMatrix3D;\nuniform vec4 posdata[24];uniform vec2 outuv;varying vec2 v_texCoord;void main(void){   vec4 data = posdata[int(v2uv.z)];   vec4 vt0= vec4(v3Pos * data.w,1.0);   vt0= watchCamMatrix3D * vt0;   vt0.xyz += data.xyz;   v_texCoord = vec2(v2uv.x,v2uv.y) + outuv;   gl_Position = viewMatrix3D * camMatrix3D * vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\nif(infoUv.w < 0.1){discard;}\ngl_FragColor = infoUv;\n}";return a},b.MOVIE2D_SHADER="Movie2DShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Sprite2DShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform mat4 viewMatrix3D;\nuniform mat4 camMatrix3D;\nuniform mat4 watchCamMatrix3D;\nuniform vec4 posdata[12];varying vec2 v_texCoord;void main(void){   vec4 data = posdata[int(v2uv.z)];   vec4 vt0= vec4(v3Pos * data.w,1.0);   vt0= watchCamMatrix3D * vt0;   vt0.xyz += data.xyz;   v_texCoord = vec2(v2uv.x,v2uv.y);   gl_Position = viewMatrix3D * camMatrix3D * vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\nif(infoUv.w < 0.1){discard;}\ngl_FragColor = infoUv;\n}";return a},b.SPRITE2D_SHADER="Sprite2DShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),TerrainDisplay3DShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v2TexCoord")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Position;attribute vec2 v2TexCoord;\nuniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec2 v0;\nvoid main(void){ v0 = v2TexCoord;   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;uniform sampler2D idmaptexture;uniform sampler2D infotexture;uniform sampler2D sixtexture;uniform sampler2D lightexture;vec4 qdvNrm(float indx ,vec2 uvpos){vec2 sixuvTx=uvpos; float ccavid= floor(indx*255.0);if (ccavid==0.0) {\n} else  if (ccavid==1.0){\nsixuvTx.x=sixuvTx.x+0.5;} else  if (ccavid==2.0){sixuvTx.y=sixuvTx.y+0.5;}else{sixuvTx.x=sixuvTx.x+0.5;sixuvTx.y=sixuvTx.y+0.5;}; sixuvTx.x=sixuvTx.x+0.001;sixuvTx.y=sixuvTx.y+0.001;vec4 sixUvColor = texture2D(sixtexture, sixuvTx.xy);\nreturn  sixUvColor;\n }\nvarying vec2 v0;void main(void){vec4 idUv = texture2D(idmaptexture, v0.xy);\nvec4 infoUv = texture2D(infotexture, v0.xy);\nvec4 sixUv = texture2D(sixtexture, v0.xy);\nvec4 lightUv = texture2D(lightexture, v0*0.995+0.0025);\nvec2 sixuv=fract(v0*10.0);  sixuv=sixuv*0.498; vec4 tempnumA = qdvNrm(idUv.x,sixuv) * infoUv.x;\nvec4 tempnumB = qdvNrm(idUv.y,sixuv) * infoUv.y;\nvec4 tempnumC = qdvNrm(idUv.z,sixuv) * infoUv.z;\nvec4 tempnumD = tempnumA+tempnumB+tempnumC;\n tempnumD.xyz=tempnumD.xyz*lightUv.xyz*2.0; gl_FragColor = tempnumD;}";return a},b.TerrainDisplay3DShader="TerrainDisplay3DShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),CombineParticleData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.destory=function(){for(var a=0;a<this.dataAry.length;a++)this.dataAry[a].destory()},b.prototype.getCombineParticle=function(){var a=new CombineParticle;a.maxTime=this.maxTime;for(var b=0;b<this.dataAry.length;b++){var c=this.dataAry[b].creatPartilce();a.addPrticleItem(c)}return a.sourceData=this,this.useNum++,a},b.prototype.setDataByte=function(a){a.position=0;var b=a.readInt(),c=a.readInt();this.maxTime=0,this.dataAry=new Array;for(var d=0;c>d;d++){var e=a.readInt(),f=this.getParticleDataType(e);f.version=b,f.setAllByteInfo(a),this.dataAry.push(f),f.timelineData.maxFrameNum>this.maxTime&&(this.maxTime=f.timelineData.maxFrameNum)}this.maxTime*=Scene_data.frameTime},b.prototype.getParticleDataType=function(a){var b;switch(a){case 1:b=new ParticleFacetData;break;case 18:b=new ParticleBallData;break;case 3:b=new ParticleLocusData;break;case 14:b=new ParticleLocusballData;break;case 9:b=new ParticleModelData;break;case 4:b=new ParticleModelData;break;case 7:b=new ParticleModelData;break;case 8:b=new ParticleFollowData;break;case 12:b=new ParticleFollowLocusData;break;case 13:b=new ParticleBoneData}return b},b}(ResCount),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),CombineParticle=function(a){function b(){var b=a.call(this)||this;return b._maxTime=1e6,b._rotationX=0,b._rotationY=0,b._rotationZ=0,b.hasMulItem=!1,b.sceneVisible=!0,b.dynamic=!1,b._displayAry=new Array,b._time=0,b.bindMatrix=new Matrix3D,b.invertBindMatrix=new Matrix3D,b.bindVecter3d=new Vector3D,b.bindScale=new Vector3D(1,1,1),b.groupMatrix=new Matrix3D,b.groupRotationMatrix=new Matrix3D,b}return __extends(b,a),Object.defineProperty(b.prototype,"displayAry",{get:function(){return this._displayAry},set:function(a){this._displayAry=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"maxTime",{set:function(a){this._maxTime=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"bindTarget",{set:function(a){this._bindTarget=a,this.invertBindMatrix.isIdentity=!1},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"bindSocket",{set:function(a){this._bindSocket=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"x",{get:function(){return this.bindVecter3d.x},set:function(a){this.bindVecter3d.x=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{
get:function(){return this.bindVecter3d.y},set:function(a){this.bindVecter3d.y=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this.bindVecter3d.z},set:function(a){this.bindVecter3d.z=a},enumerable:!0,configurable:!0}),b.prototype.setPos=function(a,b,c){this.bindVecter3d.setTo(a,b,c);for(var d=0;d<this._displayAry.length;d++)this._displayAry[d].resetPos()},b.prototype.setMulPos=function(a){for(var b=0;b<this._displayAry.length;b++)this._displayAry[b].resetMulPos(a)},Object.defineProperty(b.prototype,"scaleX",{set:function(a){this.bindScale.x=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scaleY",{set:function(a){this.bindScale.y=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scaleZ",{set:function(a){this.bindScale.z=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"rotationX",{set:function(a){this._rotationX=a,this.applyRotation()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"rotationY",{set:function(a){this._rotationY=a,this.applyRotation()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"rotationZ",{set:function(a){this._rotationZ=a,this.applyRotation()},enumerable:!0,configurable:!0}),b.prototype.applyRotation=function(){this.bindMatrix.identity(),this.bindMatrix.appendRotation(this._rotationX,Vector3D.X_AXIS),this.bindMatrix.appendRotation(this._rotationY,Vector3D.Y_AXIS),this.bindMatrix.appendRotation(this._rotationZ,Vector3D.Z_AXIS),this.bindMatrix.copyTo(this.invertBindMatrix),this.invertBindMatrix.invert(),this.invertBindMatrix.isIdentity=!1},b.prototype.setGroup=function(a,b,c){this._isInGroup=!0,this._groupPos=a,this._groupRotation=b,this._groupScale=c,this.groupMatrix.isIdentity=!1,this.groupMatrix.identity(),this.groupMatrix.appendScale(c.x,c.y,c.z),this.groupMatrix.appendRotation(b.x,Vector3D.X_AXIS),this.groupMatrix.appendRotation(b.y,Vector3D.Y_AXIS),this.groupMatrix.appendRotation(b.z,Vector3D.Z_AXIS),this.groupMatrix.appendTranslation(a.x,a.y,a.z),this.groupRotationMatrix.isIdentity=!1,this.groupRotationMatrix.identity(),this.groupRotationMatrix.prependRotation(b.z,Vector3D.Z_AXIS),this.groupRotationMatrix.prependRotation(b.y,Vector3D.Y_AXIS),this.groupRotationMatrix.prependRotation(b.x,Vector3D.X_AXIS)},b.prototype.setDataByte=function(a){a.position=0;var b=a.readInt(),c=a.readInt();this._maxTime=0,this._displayAry=new Array;for(var d=0;c>d;d++){var e=a.readInt(),f=this.getDisplay3DById(e);f.setAllByteInfo(a,b),f.setBind(this.bindVecter3d,this.bindMatrix,this.bindScale,this.invertBindMatrix,this.groupMatrix),this._displayAry.push(f),f.timeline.maxFrameNum>this._maxTime&&(this._maxTime=f.timeline.maxFrameNum)}this._maxTime*=Scene_data.frameTime},b.prototype.addPrticleItem=function(a){a.visible=!1,a.setBind(this.bindVecter3d,this.bindMatrix,this.bindScale,this.invertBindMatrix,this.groupMatrix),this._displayAry.push(a)},b.prototype.getDisplay3DById=function(a){var b=new Object;return b.particleType=a,this.getDisplay3D(b)},b.prototype.setData=function(a){this._displayAry=new Array,this._maxTime=0;for(var b=0;b<a.length;b++){var c=a[b].display,d=this.getDisplay3D(c);d.setBind(this.bindVecter3d,this.bindMatrix,this.bindScale,this.invertBindMatrix,this.groupMatrix),this._displayAry.push(d),d.timeline.maxFrameNum>this._maxTime&&(this._maxTime=d.timeline.maxFrameNum)}this._maxTime*=Scene_data.frameTime},b.prototype.updateTime=function(a){if(this._time+=a,this._displayAry){for(var b=0;b<this._displayAry.length;b++)this._displayAry[b].updateTime(this._time);this.updateBind(),this._time>=this._maxTime&&this.dispatchEvent(new BaseEvent(BaseEvent.COMPLETE))}},b.prototype.updateBind=function(){this._bindTarget&&(this._bindTarget.getSocket(this._bindSocket,this.bindMatrix),this.bindVecter3d.setTo(this.bindMatrix.x,this.bindMatrix.y,this.bindMatrix.z),this.bindMatrix.identityPostion(),this.groupRotationMatrix.isIdentity?this.bindMatrix.invertToMatrix(this.invertBindMatrix):(this.bindMatrix.copyTo(this.invertBindMatrix),this.invertBindMatrix.prepend(this.groupRotationMatrix),this.invertBindMatrix.invert()))},b.prototype.reset=function(){this._time=0;for(var a=0;a<this._displayAry.length;a++)this._displayAry[a].reset()},b.prototype.update=function(){if(this.sceneVisible&&this._displayAry)for(var a=0;a<this._displayAry.length;a++)this._displayAry[a].update()},b.prototype.updateItem=function(a){this.sceneVisible&&this._displayAry[a].update()},Object.defineProperty(b.prototype,"size",{get:function(){return this._displayAry?this._displayAry.length:0},enumerable:!0,configurable:!0}),b.prototype.getDisplay3D=function(a){var b,c=a.particleType;switch(c){case 1:b=new Display3DFacetParticle;break;case 18:b=new Display3DBallPartilce;break;case 3:b=new Display3DLocusPartilce;break;case 14:b=new Display3DLocusBallPartilce;break;case 9:b=new Display3DModelObjParticle;break;case 4:b=new Display3DModelPartilce;break;case 7:b=new Display3dModelAnimParticle;break;case 8:b=new Display3DFollowPartilce}return b.visible=!1,b},b.prototype.destory=function(){this.sourceData.useNum--;for(var a=0;a<this._displayAry.length;a++)this._displayAry[a].destory();this._displayAry.length=0,this._displayAry=null,this.bindMatrix=null,this.bindVecter3d=null,this.bindScale=null,this.invertBindMatrix=null,this._bindTarget=null,this._bindSocket=null,this._groupPos=null,this._groupRotation=null,this._groupScale=null,this.groupMatrix=null,this.groupRotationMatrix=null},b}(EventDispatcher),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleManager=function(a){function b(){var b=a.call(this)||this;return b._time=0,b.renderDic=new Object,b._particleList=new Array,b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.getParticleByte=function(a){a=a.replace("_byte.txt",".txt"),a=a.replace(".txt","_byte.txt");var b=new CombineParticle,c=a;if(this._dic[c]){var d=this._dic[c];b=d.getCombineParticle()}else LoadManager.getInstance().load(c,LoadManager.BYTE_TYPE,function(a){var c=new ByteArray(a);b.setDataByte(c)});return b.url=c,b},b.prototype.registerUrl=function(a){if(a=a.replace("_byte.txt",".txt"),a=a.replace(".txt","_byte.txt"),this._dic[a]){var b=this._dic[a];b.useNum++}},b.prototype.releaseUrl=function(a){if(a=a.replace("_byte.txt",".txt"),a=a.replace(".txt","_byte.txt"),this._dic[a]){var b=this._dic[a];b.clearUseNum()}},b.prototype.addResByte=function(a,b){if(!this._dic[a]){var c=new CombineParticleData;c.setDataByte(b),this._dic[a]=c}},b.prototype.update=function(){this.updateRenderDic(),this.clearPaticleVa()},b.prototype.clearPaticleVa=function(){Scene_data.context3D.clearVa(2),Scene_data.context3D.clearVa(3),Scene_data.context3D.clearVa(4),Scene_data.context3D.clearVa(5)},b.prototype.setHide=function(){for(var a=0;a<this._particleList.length;a++)!this._particleList[a].dynamic},Object.defineProperty(b.prototype,"particleList",{get:function(){return this._particleList},enumerable:!0,configurable:!0}),b.prototype.updateTime=function(){for(var a=TimeUtil.getTimer(),b=a-this._time,c=0;c<this._particleList.length;c++)this._particleList[c].sceneVisible&&this._particleList[c].updateTime(b);this._time=a},b.prototype.addRenderDic=function(a){var b=a.url;this.renderDic[b]||(this.renderDic[b]=new Array),this.renderDic[b].push(a)},b.prototype.removeRenderDic=function(a){var b=a.url,c=this.renderDic[b].indexOf(a);-1!=c&&(this.renderDic[b].splice(c,1),0==this.renderDic[b].length&&delete this.renderDic[b])},b.prototype.updateRenderDic=function(){for(var a in this.renderDic){var b=this.renderDic[a];if(1==b.length)b[0].update();else for(var c=b[0].size,d=0;c>d;d++)for(var e=0;e<b.length;e++)b[e].updateItem(d)}},b.prototype.addParticle=function(a){-1==this._particleList.lastIndexOf(a)&&(this._particleList.push(a),this.addRenderDic(a))},b.prototype.removeParticle=function(a){var b=this._particleList.indexOf(a);-1!=b&&(this._particleList.splice(b,1),this.removeRenderDic(a))},b.prototype.gc=function(){a.prototype.gc.call(this)},b}(ResGC),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DParticle=function(a){function b(){var b=a.call(this)||this;return b.isInGroup=!1,b.visible=!0,b._rotationMatrix=new Matrix3D,b.modelMatrix=new Matrix3D,b}return __extends(b,a),b.prototype.onCreated=function(){},b.prototype.setBind=function(a,b,c,d,e){this.bindVecter3d=a,this.bindMatrix=b,this.bindScale=c,this.invertBindMatrix=d,this.groupMatrix=e},b.prototype.getMulBindList=function(){return null},b.prototype.updateMatrix=function(){this.bindMatrix&&(this.modelMatrix.identity(),this.groupMatrix.isIdentity||this.posMatrix.append(this.groupMatrix),this.modelMatrix.append(this.posMatrix),this.modelMatrix.append(this.bindMatrix),this.modelMatrix.appendTranslation(this.bindVecter3d.x,this.bindVecter3d.y,this.bindVecter3d.z))},Object.defineProperty(b.prototype,"cantUseEffectsLev",{get:function(){var a=this.data._renderPriority<=Scene_data.effectsLev;return!a},enumerable:!0,configurable:!0}),b.prototype.updateTime=function(a){this.cantUseEffectsLev||(this._time=a-this._beginTime,this._time+=this.data._delayedTime,this.timeline.updateTime(a),this.visible=this.timeline.visible,this.posMatrix.identity(),this.posMatrix.prependScale(.1*this._scaleX*this.bindScale.x*this.data.overAllScale,.1*this._scaleY*this.bindScale.y*this.data.overAllScale,.1*this._scaleZ*this.bindScale.z*this.data.overAllScale),this.timeline.updateMatrix(this.posMatrix,this))},b.prototype.reset=function(){this.timeline.reset(),this.updateTime(0)},b.prototype.clearAllAnim=function(){},b.prototype.update=function(){this.cantUseEffectsLev||this.visible&&this.data.materialParam&&(Scene_data.context3D.setBlendParticleFactors(this.data._alphaMode),Scene_data.context3D.cullFaceBack(this.data.materialParam.material.backCull),this.data.materialParam&&Scene_data.context3D.setProgram(this.data.materialParam.program),this.updateMatrix(),this.setVc(),this.setVa(),this.resetVa())},b.prototype.setVc=function(){},b.prototype.pushVc=function(){Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData)},b.prototype.setVa=function(){},b.prototype.resetVa=function(){},b.prototype.setMaterialVc=function(){if(this.data.materialParam){for(var a=this.data.materialParam.dynamicConstList,b=this._time%(Scene_data.frameTime*this.data._life),c=0;c<a.length;c++)a[c].update(b);this.data.materialParam.material.fcNum<=0||(b*=this.data.materialParam.material.timeSpeed,this.data.materialParam.material.update(b),Scene_data.context3D.setVc4fv(this.data.materialParam.shader,"fc",this.data.materialParam.material.fcData))}},b.prototype.setMaterialTexture=function(){if(this.data.materialParam){for(var a=this.data.materialParam.material.texList,b=0;b<a.length;b++)a[b].isDynamic||Scene_data.context3D.setRenderTexture(this.data.materialParam.shader,a[b].name,a[b].texture,a[b].id,!0);for(var c=this.data.materialParam.dynamicTexList,b=0;b<c.length;b++)Scene_data.context3D.setRenderTexture(this.data.materialParam.shader,c[b].target.name,c[b].texture,c[b].target.id,!0)}},b.prototype.inverBind=function(){this.invertBindMatrix.isIdentity||this._rotationMatrix.prepend(this.invertBindMatrix)},b.prototype.resetPos=function(){},b.prototype.resetMulPos=function(a){},b.prototype.getVector3DByObject=function(a){return a?new Vector3D(a.x,a.y,a.z,a.w):null},b.prototype.clone=function(){return null},b.prototype.setAllByteInfo=function(a,b){void 0===b&&(b=0),this.creatData(),this.data.version=b,this.data.setAllByteInfo(a),this.timeline=new TimeLine,this.timeline.setAllDataInfo(this.data.timelineData),this._beginTime=this.timeline.beginTime},b.prototype.creatData=function(){this.data=new ParticleData},b.prototype.setTimeLine=function(a){this.timeline=a,this._beginTime=a.beginTime},b.prototype.destory=function(){this.timeline=null,this.bindMatrix=null,this.bindVecter3d=null,this.bindScale=null,this.invertBindMatrix=null,this.groupMatrix=null,this._rotationMatrix=null,this.modelMatrix=null,this.groupPos=null,this.groupScale=null,this.groupRotation=null},b}(Object3D),ParticleData=function(){function a(){this._delayedTime=0,this._width=100,this._height=100,this._originWidthScale=.5,this._originHeightScale=.5,this._eyeDistance=0,this._watchEye=!1,this._isZiZhuan=!1,this.overAllScale=1}return a.prototype.destory=function(){this.objData&&this.objData.destory(),this.materialParam.destory(),this.timelineData.destory(),this.timelineData=null},a.prototype.uploadGpu=function(){},a.prototype.regShader=function(){},a.prototype.initVcData=function(){},a.prototype.creatPartilce=function(){var a=this.getParticle();a.data=this;var b=new TimeLine;return b.setAllDataInfo(this.timelineData),a.setTimeLine(b),a.onCreated(),a},a.prototype.getParticle=function(){return null},a.prototype.setAllByteInfo=function(a){this.timelineData=new TimeLineData,this.timelineData.setByteData(a),this._beginTime=this.timelineData.beginTime,this.version>=15&&(this._delayedTime=a.readFloat()),this._width=a.readFloat(),this._height=a.readFloat(),this._widthFixed=a.readBoolean(),this._heightFixed=a.readBoolean(),this._originWidthScale=a.readFloat(),this._originHeightScale=a.readFloat(),this._eyeDistance=a.readFloat(),this._alphaMode=a.readFloat(),this._uSpeed=a.readFloat(),this._vSpeed=a.readFloat(),this._animLine=a.readFloat(),this._animRow=a.readFloat(),this._animInterval=a.readFloat(),this._renderPriority=a.readFloat(),this._distortion=a.readBoolean(),this._isUV=a.readBoolean(),this._isU=a.readBoolean(),this._isV=a.readBoolean(),this._life=a.readFloat(),this._life=this._life>1e4?Scene_data.MAX_NUMBER:this._life,this._watchEye=a.readBoolean(),this._ziZhuanAngly=new Vector3D,this._ziZhuanAngly.x=a.readFloat(),this._ziZhuanAngly.y=a.readFloat(),this._ziZhuanAngly.z=a.readFloat(),this._ziZhuanAngly.w=a.readFloat(),this.rotationV3d=new Vector3D,this.rotationV3d.x=a.readFloat(),this.rotationV3d.y=a.readFloat(),this.rotationV3d.z=a.readFloat(),this.center=new Vector3D,this.center.x=a.readFloat(),this.center.y=a.readFloat(),this.center.z=a.readFloat(),this.center.w=a.readFloat(),this.overAllScale=a.readFloat(),!this._ziZhuanAngly||0==this._ziZhuanAngly.x&&0==this._ziZhuanAngly.y&&0==this._ziZhuanAngly.z||(this._isZiZhuan=!0),this.readMaterialPara(a);var b=a.readUTF();b=b.replace("_byte.txt",".txt"),b=b.replace(".txt","_byte.txt"),this.materialByteUrl=b},Object.defineProperty(a.prototype,"materialByteUrl",{set:function(a){var b=this;this._materialUrl!=a&&(this._materialUrl=a,MaterialManager.getInstance().getMaterialByte(Scene_data.fileRoot+a,function(a){b.onMaterialLoad(a)}))},enumerable:!0,configurable:!0}),a.prototype.onMaterialLoad=function(a){this.materialParam=new MaterialParam,this.materialParam.setMaterial(a),this.materialParam.setLife(this._life),this.materialParamData&&(this.materialParam.setTextObj(this.materialParamData.texAry),this.materialParam.setConstObj(this.materialParamData.conAry)),MaterialManager.getInstance().loadDynamicTexUtil(this.materialParam),this.regShader()},a.prototype.readMaterialPara=function(a){this.materialParamData=new Object;var b=(a.readUTF(),a.readInt());this.materialParamData.texAry=new Array;for(var c=0;b>c;c++){var d=new Object;d.isParticleColor=a.readBoolean(),d.paramName=a.readUTF(),d.url=a.readUTF(),d.isParticleColor&&(d.curve=new Object,this.readTempCurve(a,d.curve)),this.materialParamData.texAry.push(d)}this.readMaterialParaConAry(a)},a.prototype.readTempCurve=function(a,b){b.values=new Array;var c=!1;if(this.version>=12){var d=a.readInt();if(d>0)var e=a.readFloat();for(var f=0;d>f;f++){for(var g=a.readInt(),h=new Array,i=0;g>i;i++)h.push(a.readByte()/127*e);b.values.push(h)}c=!0}b.type=a.readFloat(),b.maxFrame=a.readFloat(),b.sideType=a.readBoolean(),b.speedType=a.readBoolean(),b.useColorType=a.readBoolean(),b.items=this.readItems(a),c||this.makeCurveData(b)},a.prototype.readItems=function(a){for(var b=new Array,c=a.readInt(),d=0;c>d;d++){var e=new Object;e.frame=a.readInt(),e.vec3=a.readVector3D(!0),e.rotation=a.readVector3D(!0),e.rotationLeft=a.readVector3D(!0),b.push(e)}return b},a.prototype.makeCurveData=function(a){for(var b=a.items,c=new Array,d=new Array,e=new Array,f=new Array,g=0;g<b.length;g++)if(g==b.length-1)c.push(b[g].vec3.x),d.push(b[g].vec3.y),e.push(b[g].vec3.z),f.push(b[g].vec3.w);else{var h=b[g+1].frame-b[g].frame,i=b[g].vec3,j=b[g+1].vec3,k=a.items[g].rotation,l=a.items[g+1].rotationLeft;c=c.concat(this.getBzData(i.x,j.x,k.x,l.x,h)),d=d.concat(this.getBzData(i.y,j.y,k.y,l.y,h)),e=e.concat(this.getBzData(i.z,j.z,k.z,l.z,h)),f=f.concat(this.getBzData(i.w,j.w,k.w,l.w,h))}a.values=new Array,a.values[0]=c,a.values[1]=d,a.values[2]=e,a.values[3]=f},a.prototype.getBzData=function(a,b,c,d,e){var f=10,g=new Vector2D(0,a*f),h=new Vector2D(e,b*f),i=new Matrix3D,j=new Vector3D;i.identity(),i.appendRotation(-c,Vector3D.Z_AXIS),j=i.transformVector(new Vector3D(e/2,0,0));var k=new Vector2D(e/2,g.y+j.y);i.identity(),i.appendRotation(-d,Vector3D.Z_AXIS),j=i.transformVector(new Vector3D(-e/2,0,0));for(var l=new Vector2D(e/2,h.y+j.y),m=[g,k,l,h],n=new Array,o=1;3*e>o;o++)n.push(this.drawbezier(m,o/(3*e)));var p=new Array;for(o=0;e>o;o++)for(var q=0;q<n.length;q++)if(n[q].x>=o){p.push(n[q].y/f);break}return p},a.prototype.drawbezier=function(a,b){var c=new Array;if(0==a.length)return new Vector2D;for(var d in a)c.push(new Vector2D(a[d].x,a[d].y));for(;c.length>1;){for(var e=0;e<c.length-1;e++)this.mathmidpoint(c[e],c[e+1],b);c.pop()}return c[0]},a.prototype.mathmidpoint=function(a,b,c){var d,e;d=a.x+(b.x-a.x)*c,e=a.y+(b.y-a.y)*c,a.x=d,a.y=e},a.prototype.readMaterialParaConAry=function(a){for(var b=new Array,c=a.readInt(),d=0;c>d;d++){var e=new Object;e.type=a.readFloat(),e.indexID=a.readFloat(),e.paramName=a.readUTF(),e.curve=new Object,this.readTempCurve(a,e.curve),b.push(e)}this.materialParamData.conAry=b},a.prototype.setFloat32Vec=function(a,b){},a.prototype.setFloat32Mat=function(a,b){},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleGpuData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(ObjData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DFacetParticle=function(a){function b(){var b=a.call(this)||this;return b._lifeVisible=!0,b._resultUvVec=new Array(2),b}return __extends(b,a),Object.defineProperty(b.prototype,"facetdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),b.prototype.creatData=function(){this.data=new ParticleFacetData},b.prototype.update=function(){this._lifeVisible&&a.prototype.update.call(this)},b.prototype.reset=function(){a.prototype.reset.call(this),this._lifeVisible=!0},b.prototype.setVc=function(){this.updateRotaionMatrix(),this.updateUV(),this.data.vcmatData.set(Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,48),this.data.vcmatData.set(this._rotationMatrix.m,32),this.data.vcmatData.set(this._resultUvVec,64),this.setMaterialVc(),!this.facetdata._isCycle&&this._time/Scene_data.frameTime>this.data._life-2&&(this._lifeVisible=!1),Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData)},b.prototype.setVa=function(){var a=Scene_data.context3D.pushVa(this.data.objData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,12)),this.setMaterialTexture(),Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},b.prototype.updateRotaionMatrix=function(){this._rotationMatrix.identity(),this.data._watchEye&&(this.timeline.inverAxisRotation(this._rotationMatrix),this.facetdata._locky||this.facetdata._lockx||this.inverBind(),this.facetdata._locky||this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),this.facetdata._lockx||this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS)),this.data._isZiZhuan&&this.timeline.applySelfRotation(this._rotationMatrix,this.data._ziZhuanAngly)},b.prototype.updateUV=function(){var a=float2int(this._time/Scene_data.frameTime);a=a>this.facetdata._maxAnimTime?this.facetdata._maxAnimTime:a,a=a/this.data._animInterval%(this.data._animLine*this.data._animRow),this._resultUvVec[0]=float2int(a%this.data._animLine)/this.data._animLine+this._time/Scene_data.frameTime*this.data._uSpeed,this._resultUvVec[1]=float2int(a/this.data._animLine)/this.data._animRow+this._time/Scene_data.frameTime*this.data._vSpeed},b}(Display3DParticle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DFacetShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v2TexCoord")},b.prototype.getMat4Str=function(a){return"vcmat["+b.shader_mat4[a]+"]"},b.prototype.getVec4Str=function(a){return"vcmat["+b.shader_vec4[a][0]+"]["+b.shader_vec4[a][1]+"]"},b.getVcSize=function(){return 5},b.prototype.getVertexShaderString=function(){var a="attribute vec4 v3Position;\nattribute vec2 v2TexCoord;\nuniform mat4 vcmat["+b.getVcSize()+"];\nvarying vec2 v0;\nvoid main(void){\n   v0 = v2TexCoord + vec2("+this.getVec4Str("uvMove")+".xy);\n   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("posMatrix3D")+" * "+this.getMat4Str("rotationMatrix3D")+" * v3Position;\n}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}";return a},b.Display3D_Facet_Shader="Display3DFacetShader",b.shader_mat4={viewMatrix3D:0,camMatrix3D:1,rotationMatrix3D:2,posMatrix3D:3},b.shader_vec4={uvMove:[4,0]},b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleFacetData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._isCycle=!1,b}return __extends(b,a),b.prototype.setAllByteInfo=function(b){this._maxAnimTime=b.readFloat(),this._isCycle=b.readBoolean(),this._lockx=b.readBoolean(),this._locky=b.readBoolean(),a.prototype.setAllByteInfo.call(this,b),this.initVcData(),this.uploadGpu()},b.prototype.getParticle=function(){return new Display3DFacetParticle},b.prototype.uploadGpu=function(){this.objData=new ObjData,this.makeRectangleData(this._width,this._height,this._originWidthScale,this._originHeightScale,this._isUV,this._isU,this._isV,this._animLine,this._animRow)},b.prototype.makeRectangleData=function(a,b,c,d,e,f,g,h,i){void 0===c&&(c=.5),void 0===d&&(d=.5),void 0===e&&(e=!1),void 0===f&&(f=!1),void 0===g&&(g=!1),void 0===h&&(h=1),void 0===i&&(i=1);var j=new Array,k=new Array,l=new Array;if(l.push(new Vector2D(0,0)),l.push(new Vector2D(0,1/i)),l.push(new Vector2D(1/h,1/i)),l.push(new Vector2D(1/h,0)),f)for(var m=0;m<l.length;m++)l[m].x=-l[m].x;if(g)for(var m=0;m<l.length;m++)l[m].y=-l[m].y;e&&l.push(l.shift());for(var m=0;m<l.length;m++)j.push(l[m].x,l[m].y);k.push(-c*a,b-d*b,0),k.push(l[0].x,l[0].y),k.push(a-c*a,b-d*b,0),k.push(l[1].x,l[1].y),k.push(a-c*a,-d*b,0),k.push(l[2].x,l[2].y),k.push(-c*a,-d*b,0),k.push(l[3].x,l[3].y);var n=new Array;n.push(0,1,2,0,2,3),this.objData.stride=20,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(k),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(n),this.objData.treNum=n.length},b.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*Display3DFacetShader.getVcSize())},b.prototype.setFloat32Vec=function(a,b){var c=Display3DFacetShader.shader_vec4[a],d=16*c[0]+4*c[1];this.vcmatData.set(b,d)},b.prototype.setFloat32Mat=function(a,b){var c=16*Display3DFacetShader.shader_mat4[a];this.vcmatData.set(b,c)},b.prototype.regShader=function(){this.materialParam.shader=ProgrmaManager.getInstance().getMaterialProgram(Display3DFacetShader.Display3D_Facet_Shader,Display3DFacetShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program},b}(ParticleData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DBallPartilce=function(a){function b(){return a.call(this)||this}return __extends(b,a),Object.defineProperty(b.prototype,"balldata",{get:function(){return this.data},enumerable:!0,configurable:!0}),b.prototype.creatData=function(){this.data=new ParticleBallData},b.prototype.setVa=function(){this.setVaCompress(),this.setMaterialTexture(),Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},b.prototype.setVaCompress=function(){var a=Scene_data.context3D.pushVa(this.data.objData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),Scene_data.context3D.setVaOffset(1,3,this.data.objData.stride,12),Scene_data.context3D.setVaOffset(2,4,this.data.objData.stride,24),Scene_data.context3D.setVaOffset(3,3,this.data.objData.stride,40),this.balldata._needSelfRotation&&Scene_data.context3D.setVaOffset(4,2,this.data.objData.stride,52),this.balldata._needRandomColor&&Scene_data.context3D.setVaOffset(5,4,this.particleBallData.stride,this.particleBallData.randomOffset))},b.prototype.resetVa=function(){},b.prototype.setVc=function(){this.updateWatchCaramMatrix(),this.balldata.vcmatData.set(Scene_data.viewMatrx3D.m,0),this.balldata.vcmatData.set(Scene_data.cam3D.cameraMatrix.m,16),this.balldata.vcmatData.set(this.modelMatrix.m,32),this.balldata.vcmatData.set(this._rotationMatrix.m,48),this.balldata._timeVec[0]=this._time/Scene_data.frameTime*this.balldata._playSpeed,this.balldata.vcmatData.set(this.balldata._timeVec,80),this.balldata._is3Dlizi&&(this.updateAllRotationMatrix(),this.balldata._wordPosVec[0]=this.bindVecter3d.x,this.balldata._wordPosVec[1]=this.bindVecter3d.y,this.balldata._wordPosVec[2]=this.bindVecter3d.z,this.balldata._caramPosVec[0]=Scene_data.cam3D.x,this.balldata._caramPosVec[1]=Scene_data.cam3D.y,this.balldata._caramPosVec[2]=Scene_data.cam3D.z,this.balldata.vcmatData.set(this.balldata._allRotationMatrix.m,64),this.balldata.vcmatData.set(this.balldata._wordPosVec,96),this.balldata.vcmatData.set(this.balldata._caramPosVec,100)),Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.balldata.vcmatData),this.setMaterialVc()},b.prototype.updateWatchCaramMatrix=function(){this._rotationMatrix.identity(),this.balldata.facez?this._rotationMatrix.prependRotation(90,Vector3D.X_AXIS):this.balldata._is3Dlizi?(this.timeline.inverAxisRotation(this._rotationMatrix),this.inverBind()):this.balldata._watchEye&&(this.timeline.inverAxisRotation(this._rotationMatrix),this.inverBind(),this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS))},b.prototype.updateAllRotationMatrix=function(){this.balldata._allRotationMatrix.identity(),this.balldata._allRotationMatrix.prependScale(this.data.overAllScale*this._scaleX*.1*this.bindScale.x,this.data.overAllScale*this._scaleY*.1*this.bindScale.y,this.data.overAllScale*this._scaleZ*.1*this.bindScale.z),this.timeline.inverAxisRotation(this._rotationMatrix),this.isInGroup&&(this.balldata._allRotationMatrix.appendRotation(this.groupRotation.x,Vector3D.X_AXIS),this.balldata._allRotationMatrix.appendRotation(this.groupRotation.y,Vector3D.Y_AXIS),this.balldata._allRotationMatrix.appendRotation(this.groupRotation.z,Vector3D.Z_AXIS)),this.bindMatrix&&this.balldata._allRotationMatrix.append(this.bindMatrix)},Object.defineProperty(b.prototype,"particleBallData",{get:function(){return this.data.objData},enumerable:!0,configurable:!0}),b}(Display3DParticle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DBallShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"vPosition"),a.bindAttribLocation(this.program,1,"texcoord"),a.bindAttribLocation(this.program,2,"basePos"),a.bindAttribLocation(this.program,3,"speed");var b=this.paramAry[3];b&&a.bindAttribLocation(this.program,4,"rotation");var c=this.paramAry[1];c&&a.bindAttribLocation(this.program,5,"color")},b.prototype.getMat4Str=function(a){return"vcmat["+b.shader_mat4[a]+"]"},b.prototype.getVec4Str=function(a){return"vcmat["+b.shader_vec4[a][0]+"]["+b.shader_vec4[a][1]+"]"},b.getVcSize=function(){return 7},b.prototype.getVertexShaderString=function(){var a,c,d,e,f,g,h,i,j,k,l,m,j,i,n,o,p,q,r,s,t,u,v;n="attribute vec4 vPosition;\nattribute vec3 texcoord;\nattribute vec4 basePos;\nattribute vec3 speed;\nuniform mat4 vcmat["+b.getVcSize()+"];\nvarying vec2 v0;\n",u="attribute vec4 color;\nvarying vec4 v2;\n",o="",p="attribute vec2 rotation;\n",q="",r="",s="",t="",v="varying vec2 v1;\n",a="float ctime = "+this.getVec4Str("time")+".x - basePos.w;\nif ("+this.getVec4Str("time")+".w > 0.0 && ctime >= 0.0) {\n    ctime = fract(ctime / "+this.getVec4Str("time")+".z) * "+this.getVec4Str("time")+".z;\n}\nvec4 pos = vPosition;\n",c="float stime = ctime - "+this.getVec4Str("scale")+".w;\nstime = max(stime,0.0);\nfloat sf = "+this.getVec4Str("scale")+".x * stime;\nif ("+this.getVec4Str("scale")+".y != 0.0 && "+this.getVec4Str("scale")+".z != 0.0) {\n    sf += sin("+this.getVec4Str("scale")+".y * stime) * "+this.getVec4Str("scale")+".z;\n}\nif (sf > "+this.getVec4Str("scaleCtrl")+".z) {\n    sf = "+this.getVec4Str("scaleCtrl")+".z;\n} else if (sf < "+this.getVec4Str("scaleCtrl")+".w) {\n    sf = "+this.getVec4Str("scaleCtrl")+".w;\n}\nvec2 sv2 = vec2("+this.getVec4Str("scaleCtrl")+".x * sf, "+this.getVec4Str("scaleCtrl")+".y * sf);\nsv2 = sv2 + 1.0;\npos.x *= sv2.x;\npos.y *= sv2.y;\n",d="float angle = rotation.x + rotation.y * ctime;\nvec4 np = vec4(sin(angle), cos(angle), 0, 0);\nnp.z = np.x * pos.y + np.y * pos.x;\nnp.w = np.y * pos.y - np.x * pos.x;\npos.xy = np.zw;\n",
e="vec3 addPos = speed * ctime;\nvec3 uspeed = vec3(0,0,0);\nif (ctime < 0.0 || ctime >= "+this.getVec4Str("time")+".z) {\n    addPos.y = addPos.y + 100000.0;\n}\n",f="if("+this.getVec4Str("time")+".y != 0.0 && length(speed) != 0.0) {\n    uspeed = vec3(speed.x, speed.y, speed.z);\n    uspeed = normalize(uspeed);\n    uspeed = uspeed * "+this.getVec4Str("time")+".y;\n    uspeed.xyz = uspeed.xyz + "+this.getVec4Str("force")+".xyz;\n} else {\n    uspeed = vec3("+this.getVec4Str("force")+".x, "+this.getVec4Str("force")+".y, "+this.getVec4Str("force")+".z);\n}\naddPos.xyz = addPos.xyz + uspeed.xyz * ctime * ctime;\n",g="uspeed = speed + uspeed * ctime * 2.0;\nuspeed = normalize(uspeed);\nvec4 tempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(uspeed,1.0);\nuspeed.xyz = tempMul.xyz;\nuspeed = normalize(uspeed);\nvec3 cPos = addPos;\ntempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(cPos,1.0);\ncPos.xyz = tempMul.xyz; \ncPos.xyz = "+this.getVec4Str("worldPos")+".xyz + cPos.xyz;\ncPos.xyz = "+this.getVec4Str("camPos")+".xyz - cPos.xyz;\ncPos = normalize(cPos);\ncPos = cross(uspeed, cPos);\ncPos = normalize(cPos);\nuspeed = uspeed * pos.x;\ncPos = cPos * pos.y;\npos.xyz = uspeed.xyz + cPos.xyz;\n",h="pos = "+this.getMat4Str("watheye")+" * pos;\npos.xyz = pos.xyz + basePos.xyz + addPos.xyz;\ngl_Position = "+this.getMat4Str("viewMatrix3D")+" * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("modelMatrix")+" * pos;\n",k="v0 = vec2(texcoord.x,texcoord.y);\n",l="vec2 uv = vec2(texcoord.x,texcoord.y);\nfloat animframe = floor(ctime / "+this.getVec4Str("animCtrl")+".z);\nanimframe = animframe / "+this.getVec4Str("animCtrl")+".x;\nuv.x += animframe;\nanimframe = floor(animframe);\nuv.y += animframe / "+this.getVec4Str("animCtrl")+".y;\nv0.xy = uv.xy;\n",m="vec2 uv = vec2("+this.getVec4Str("uvCtrl")+".x,"+this.getVec4Str("uvCtrl")+".y);\nuv.xy = uv.xy * ctime + texcoord.xy;\nv0.xy = uv.xy;\n",j="v2 = color;\n",i="v1 = vec2(ctime/"+this.getVec4Str("time")+".z,1.0);\n";var w=this.paramAry[0],x=this.paramAry[1],y=this.paramAry[2],z=this.paramAry[3],A=this.paramAry[4],B=this.paramAry[5],C=this.paramAry[6],D="",E="";D+=a,E+=n,A&&(D+=c,E+=o),z&&(D+=d,E+=p),D+=e,B&&(D+=f,E+=q),y&&(D+=g,E+=r),D+=h,1==C?(D+=l,E+=s):2==C?(D+=m,E+=t):D+=k,x&&(D+=j,E+=u),w&&(D+=i,E+=v);var F=E+"void main(){\n"+D+"}";return F},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}";return a},b.Display3D_Ball_Shader="Display3DBallShader",b.shader_mat4={viewMatrix3D:0,camMatrix3D:1,modelMatrix:2,watheye:3,rotationMatrix:4},b.shader_vec4={time:[5,0],scale:[5,1],scaleCtrl:[5,2],force:[5,3],worldPos:[6,0],camPos:[6,1],animCtrl:[6,2],uvCtrl:[6,3]},b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleBallData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._totalNum=1,b._acceleration=.2,b._toscale=0,b._shootAngly=new Vector3D(1,0,0),b._shootSpeed=0,b._isRandom=!1,b._isSendRandom=!1,b._isSendAngleRandom=!1,b._paticleMaxScale=1,b._paticleMinScale=1,b._addforce=new Vector3D(0,0,0),b._lixinForce=new Vector3D(0,0,0),b._waveform=new Vector3D(0,0,0,0),b._round=new Vector3D,b._is3Dlizi=!1,b._speed=1,b._isLoop=!1,b._basePositon=new Vector3D(0,0,0),b._baseRandomAngle=0,b._shapeType=0,b._playSpeed=1,b._beginScale=0,b}return __extends(b,a),b.prototype.getParticle=function(){return new Display3DBallPartilce},b.prototype.setAllByteInfo=function(b){this._totalNum=b.readFloat(),this._acceleration=b.readFloat(),this._toscale=b.readFloat(),this._shootSpeed=b.readFloat(),this._isRandom=b.readBoolean(),this._isSendRandom=b.readBoolean(),this._round.x=b.readFloat(),this._round.y=b.readFloat(),this._round.z=b.readFloat(),this._round.w=b.readFloat(),this._is3Dlizi=b.readBoolean(),this._halfCircle=b.readBoolean(),this._shootAngly.x=b.readFloat(),this._shootAngly.y=b.readFloat(),this._shootAngly.z=b.readFloat(),this._shootAngly.w=b.readFloat(),this._speed=b.readFloat(),this._isLoop=b.readBoolean(),this._isSendAngleRandom=b.readBoolean(),this._waveform.x=b.readFloat(),this._waveform.y=b.readFloat(),this._waveform.z=b.readFloat(),this._waveform.w=b.readFloat(),this._closeSurface=b.readBoolean(),this._isEven=b.readBoolean(),this._paticleMaxScale=b.readFloat(),this._paticleMinScale=b.readFloat(),this._basePositon.x=b.readFloat(),this._basePositon.y=b.readFloat(),this._basePositon.z=b.readFloat(),this._basePositon.w=b.readFloat(),this._baseRandomAngle=b.readFloat(),this._shapeType=b.readFloat(),this._lockX=b.readBoolean(),this._lockY=b.readBoolean(),this._addforce.x=b.readFloat(),this._addforce.y=b.readFloat(),this._addforce.z=b.readFloat(),this._addforce.w=b.readFloat(),this._addforce.scaleByW(),this._lixinForce.x=b.readFloat(),this._lixinForce.y=b.readFloat(),this._lixinForce.z=b.readFloat(),this._lixinForce.w=b.readFloat(),this._islixinAngly=b.readBoolean(),this._particleRandomScale=new Vector3D,this._particleRandomScale.x=b.readFloat(),this._particleRandomScale.y=b.readFloat(),this._particleRandomScale.z=b.readFloat(),this._particleRandomScale.w=b.readFloat(),this._playSpeed=b.readFloat(),this.facez=b.readBoolean(),this._beginScale=b.readFloat(),this._widthFixed=b.readBoolean(),this._heightFixed=b.readBoolean(),this.readRandomColor(b),0!=this._acceleration||0!=this._addforce.x||0!=this._addforce.y||0!=this._addforce.z?(this._needAddSpeed=!0,this._addSpeedVec=[this._addforce.x,this._addforce.y,this._addforce.z]):this._needAddSpeed=!1,0!=this._toscale||0!=this._waveform.x||0!=this._waveform.y?(this._needScale=!0,this._scaleVec=[this._toscale,this._waveform.x,this._waveform.y,this._beginScale],this._scaleCtrlVec=[this._widthFixed?0:1,this._heightFixed?0:1,this._paticleMaxScale-1,this._paticleMinScale-1]):this._needScale=!1,a.prototype.setAllByteInfo.call(this,b),this._timeVec=[0,this._acceleration,this._life,this._isLoop?1:-1],this._is3Dlizi&&(this._wordPosVec=[0,0,0],this._caramPosVec=[0,0,0],this._allRotationMatrix=new Matrix3D),this.initVcData()},b.prototype.readRandomColor=function(a){var b=a.readInt(),c=new Object;c.alpha=new Array,c.color=new Array,c.pos=new Array;for(var d=0;b>d;d++)c.alpha.push(a.readFloat()),c.color.push(a.readFloat()),c.pos.push(a.readFloat());this._textureRandomColorInfo=c},Object.defineProperty(b.prototype,"objBallData",{get:function(){return this.objData},enumerable:!0,configurable:!0}),b.prototype.uploadGpu=function(){this.objData=new ParticleBallGpuData,this.initBaseData(),this.initBasePos(),this.initSpeed(),this._needSelfRotation&&this.initSelfRotaion(),this._needRandomColor&&this.initBaseColor(),this.pushToGpu()},b.prototype.initBaseData=function(){for(var a=new Array,b=new Array,c=new Array,d=0;d<this._totalNum;d++)this.makeRectangleData(a,b,this._width,this._height,this._originWidthScale,this._originHeightScale,this._isUV,this._isU,this._isV,this._animLine,this._animRow,d),c.push(0+4*d,1+4*d,2+4*d,0+4*d,2+4*d,3+4*d);this.objBallData.vertices=a,this.objBallData.uvs=b,this.objBallData.indexs=c},b.prototype.makeRectangleData=function(a,b,c,d,e,f,g,h,i,j,k,l){void 0===e&&(e=.5),void 0===f&&(f=.5),void 0===g&&(g=!1),void 0===h&&(h=!1),void 0===i&&(i=!1),void 0===j&&(j=1),void 0===k&&(k=1),void 0===l&&(l=0);var m=Math.random()*(this._particleRandomScale.x-this._particleRandomScale.y)+this._particleRandomScale.y;a.push(-e*c*m,(d-f*d)*m,0),a.push((c-e*c)*m,(d-f*d)*m,0),a.push((c-e*c)*m,-f*d*m,0),a.push(-e*c*m,-f*d*m,0);var n=new Array;if(n.push(new Vector2D(0,0)),n.push(new Vector2D(0,1/k)),n.push(new Vector2D(1/j,1/k)),n.push(new Vector2D(1/j,0)),h)for(var o=0;o<n.length;o++)n[o].x=-n[o].x;if(i)for(var o=0;o<n.length;o++)n[o].y=-n[o].y;g&&n.push(n.shift());for(var o=0;o<n.length;o++)b.push(n[o].x,n[o].y,l)},b.prototype.initBasePos=function(){for(var a=new Array,b=0;b<this._totalNum;b++){var c,d;if(this._isRandom){var e=new Vector3D(this._round.x*this._round.w,this._round.y*this._round.w,this._round.z*this._round.w);this._isEven?this._closeSurface?(c=new Vector3D(0,0,e.z),d=new Matrix3D,d.appendRotation(360*Math.random(),Vector3D.Y_AXIS),c=d.transformVector(c),c.y=e.y*Math.random()*2-e.y):(c=new Vector3D(0,0,e.z*Math.random()*2-e.z),d=new Matrix3D,d.appendRotation(360*Math.random(),Vector3D.Y_AXIS),c=d.transformVector(c),c.y=e.y*Math.random()*2-e.y):this._closeSurface?(c=new Vector3D(0,0,e.z),d=new Matrix3D,this._halfCircle?d.appendRotation(180*-Math.random(),Vector3D.X_AXIS):d.appendRotation(360*Math.random(),Vector3D.X_AXIS),d.appendRotation(360*Math.random(),Vector3D.Y_AXIS),c=d.transformVector(c)):c=this._halfCircle?new Vector3D(e.x*Math.random()*2-e.x,e.y*Math.random(),e.z*Math.random()*2-e.z):new Vector3D(e.x*Math.random()*2-e.x,e.y*Math.random()*2-e.y,e.z*Math.random()*2-e.z)}else c=new Vector3D;c=c.add(this._basePositon);for(var f=0;4>f;f++)a.push(c.x,c.y,c.z,b*this._shootSpeed)}this.objBallData.basePos=a},b.prototype.initSpeed=function(){for(var a=new Array,b=0;b<this._totalNum;b++){var c=new Vector3D,d=new Vector3D;if(0!=this._shootAngly.x||0!=this._shootAngly.y||0!=this._shootAngly.z){var e=Math.tan(this._shootAngly.w*Math.PI/180*Math.random()),f=360*Math.PI/180*Math.random();d=new Vector3D(Math.sin(f)*e,Math.cos(f)*e,1);var g=new Matrix3D;g.fromVtoV(new Vector3D(0,0,1),new Vector3D(this._shootAngly.x,this._shootAngly.y,this._shootAngly.z)),d=g.transformVector(d),d.normalize(),c=c.add(d)}(0!=this._lixinForce.x||0!=this._lixinForce.y||0!=this._lixinForce.z)&&(d=new Vector3D(Math.random()>.5?-this._lixinForce.x:this._lixinForce.x,Math.random()>.5?-this._lixinForce.y:this._lixinForce.y,Math.random()>.5?-this._lixinForce.z:this._lixinForce.z),d.normalize(),c=c.add(d)),this._islixinAngly&&(d=this._isEven?new Vector3D(this.objBallData.basePos[16*b],0,this.objBallData.basePos[16*b+2]):new Vector3D(this.objBallData.basePos[16*b],this.objBallData.basePos[16*b+1],this.objBallData.basePos[16*b+2]),d.normalize(),c=c.add(d)),c.normalize(),this._isSendRandom?c.scaleBy(this._speed*Math.random()):c.scaleBy(this._speed);for(var h=(this._baseRandomAngle*Math.random()*Math.PI/180,0);4>h;h++)a.push(c.x,c.y,c.z)}this.objBallData.beMove=a},b.prototype.initSelfRotaion=function(){var a=0,b=0;if(0==this._ziZhuanAngly.x&&0==this._ziZhuanAngly.y&&0==this._ziZhuanAngly.z&&0==this._ziZhuanAngly.w)return void(this._needSelfRotation=!1);this._needSelfRotation=!0;for(var c=new Array,d=0;d<this._totalNum;)a=this._ziZhuanAngly.x,1==this._ziZhuanAngly.y&&(a*=Math.random()),b=this._ziZhuanAngly.z,1==this._ziZhuanAngly.w?b*=Math.random():-1==this._ziZhuanAngly.w&&(b*=2*Math.random()-1),c.push(a,b),c.push(a,b),c.push(a,b),c.push(a,b),d++;this.objBallData.baseRotation=c},b.prototype.initBaseColor=function(){for(var a=ColorTransition.getInstance().getImageData(this._textureRandomColorInfo),b=a.data,c=new Array,d=0;d<this._totalNum;d++){var e=4*float2int(128*Math.random()),f=new Vector3D(b[e],b[e+1],b[e+2],b[e+3]);f.scaleBy(1/255),c.push(f.x,f.y,f.z,f.w),c.push(f.x,f.y,f.z,f.w),c.push(f.x,f.y,f.z,f.w),c.push(f.x,f.y,f.z,f.w)}this.objBallData.randomColor=c},b.prototype.pushToGpu=function(){this.compressVertex()},b.prototype.compressVertex=function(){var a=this.objBallData.vertices.length/3,b=13;this._needSelfRotation&&(b+=2),this._needRandomColor&&(this.objBallData.randomOffset=4*b,b+=4),this.objBallData.stride=4*b;for(var c=new Array,d=0;a>d;d++){for(var e=0;3>e;e++)c.push(this.objBallData.vertices[3*d+e]);for(var e=0;3>e;e++)c.push(this.objBallData.uvs[3*d+e]);for(var e=0;4>e;e++)c.push(this.objBallData.basePos[4*d+e]);for(var e=0;3>e;e++)c.push(this.objBallData.beMove[3*d+e]);if(this._needSelfRotation)for(var e=0;2>e;e++)c.push(this.objBallData.baseRotation[2*d+e]);if(this._needRandomColor)for(var e=0;4>e;e++)c.push(this.objBallData.randomColor[4*d+e])}this.objBallData.vertexBuffer=Scene_data.context3D.uploadBuff3D(c),this.objBallData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objBallData.indexs),this.objBallData.treNum=this.objBallData.indexs.length},b.prototype.setFloat32Vec=function(a,b){var c=Display3DBallShader.shader_vec4[a],d=16*c[0]+4*c[1];this.vcmatData.set(b,d)},b.prototype.setFloat32Mat=function(a,b){var c=16*Display3DBallShader.shader_mat4[a];this.vcmatData.set(b,c)},b.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*Display3DBallShader.getVcSize()),this.setFloat32Vec("time",this._timeVec),this._needAddSpeed&&this.setFloat32Vec("force",this._addSpeedVec),this._needScale&&(this.setFloat32Vec("scale",this._scaleVec),this.setFloat32Vec("scaleCtrl",this._scaleCtrlVec)),1==this._uvType?this.setFloat32Vec("animCtrl",this._animCtrlVec):2==this._uvType&&this.setFloat32Vec("uvCtrl",this._uvCtrlVec)},b.prototype.regShader=function(){if(this.materialParam){var a=this.getShaderParam();this.materialParam.shader=ProgrmaManager.getInstance().getMaterialProgram(Display3DBallShader.Display3D_Ball_Shader,Display3DBallShader,this.materialParam.material,a),this.materialParam.program=this.materialParam.shader.program}},b.prototype.getShaderParam=function(){1!=this._animRow||1!=this._animLine?(this._uvType=1,this._animCtrlVec=[this._animLine,this._animRow,this._animInterval]):0!=this._uSpeed||0!=this._vSpeed?(this._uvType=2,this._uvCtrlVec=[this._uSpeed,this._vSpeed]):this._uvType=0;var a=this.materialParam.material.hasParticleColor;this._needRandomColor=this.materialParam.material.hasVertexColor,this.uploadGpu();var b,c;c=a?1:0;var d=this._needRandomColor?1:0,e=this._is3Dlizi?1:0,f=this._needSelfRotation?1:0,g=this._needScale?1:0,h=this._needAddSpeed?1:0;return b=[c,d,e,f,g,h,this._uvType]},b}(ParticleData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleBallGpuData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.destory=function(){a.prototype.destory.call(this),this.basePos&&(this.basePos.length=0,this.basePos=null,this.basePosBuffer&&(Scene_data.context3D.deleteBuffer(this.basePosBuffer),this.basePosBuffer=null)),this.beMove&&(this.beMove.length=0,this.beMove=null,this.beMoveBuffer&&(Scene_data.context3D.deleteBuffer(this.beMoveBuffer),this.beMoveBuffer=null)),this.randomColor&&(this.randomColor.length=0,this.randomColor=null,this.randomColorBuffer&&(Scene_data.context3D.deleteBuffer(this.randomColorBuffer),this.randomColorBuffer=null)),this.baseRotation&&(this.baseRotation.length=0,this.baseRotation=null,this.baseRotationBuffer&&(Scene_data.context3D.deleteBuffer(this.baseRotationBuffer),this.baseRotationBuffer=null))},b}(ParticleGpuData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BaseDiplay3dShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"u2Texture")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Position;attribute vec2 u2Texture;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(u2Texture.x, u2Texture.y);   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ngl_FragColor =infoUv;\n}";return a},b.BaseDiplay3dShader="BaseDiplay3dShader",b}(Shader3D),BaseDiplay3dSprite=function(a){function b(){var b=a.call(this)||this;return b.initData(),b.updateMatrix,b}return __extends(b,a),b.prototype.initData=function(){ProgrmaManager.getInstance().registe(BaseDiplay3dShader.BaseDiplay3dShader,new BaseDiplay3dShader),this.shader=ProgrmaManager.getInstance().getProgram(BaseDiplay3dShader.BaseDiplay3dShader),this.program=this.shader.program,this.objData=new ObjData,this.objData.vertices=new Array,this.objData.vertices.push(0,0,0),this.objData.vertices.push(100,0,0),this.objData.vertices.push(100,0,100),this.objData.uvs=new Array,this.objData.uvs.push(0,0),this.objData.uvs.push(1,0),this.objData.uvs.push(0,1),this.objData.indexs=new Array,this.objData.indexs.push(0,1,2),this.loadTexture(),this.upToGpu()},b.prototype.loadTexture=function(){var a=UIManager.getInstance().getContext2D(128,128,!1);a.fillStyle="rgb(255,255,255)",a.fillRect(0,0,128,128),this._uvTextureRes=TextureManager.getInstance().getCanvasTexture(a)},b.prototype.upToGpu=function(){this.objData.indexs.length&&(this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},b.prototype.update=function(){this.objData&&this.objData.indexBuffer&&this._uvTextureRes&&(Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"posMatrix3D",this.posMatrix.m),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this._uvTextureRes.texture,0),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},b}(Display3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DLocusPartilce=function(a){function b(){return a.call(this)||this}return __extends(b,a),Object.defineProperty(b.prototype,"locusdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),b.prototype.creatData=function(){this.data=new ParticleLocusData},b.prototype.setVa=function(){var a=Scene_data.context3D.pushVa(this.data.objData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,28),this.data._watchEye&&Scene_data.context3D.setVaOffset(2,4,this.data.objData.stride,12)),this.setMaterialTexture(),Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},b.prototype.setVc=function(){this.updateUV(),this.data.vcmatData.set(Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,32),this.data.vcmatData.set(this.locusdata._resultUvVec,48),this.data._watchEye&&(this.locusdata._caramPosVec[0]=Scene_data.cam3D.x,this.locusdata._caramPosVec[1]=Scene_data.cam3D.y,this.locusdata._caramPosVec[2]=Scene_data.cam3D.z,this.data.vcmatData.set(this.locusdata._caramPosVec,52)),this.locusdata._changUv&&this.data.setFloat32Vec("isUv",this.locusdata._uvVec),Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData),this.setMaterialVc()},b.prototype.updateUV=function(){var a=this._time/Scene_data.frameTime,b=this.data._life/100,c=this.locusdata._speed*a/this.locusdata._density/10;this.locusdata._isEnd&&(c=Math.min(1,c)),this.locusdata._isLoop&&(c%=this.locusdata._life?b+1:1),this.locusdata._resultUvVec[0]=c},b}(Display3DParticle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DLocusShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v2TexCoord"),this.paramAry[0]&&a.bindAttribLocation(this.program,2,"v3Normal")},b.prototype.getMat4Str=function(a){return"vcmat["+b.shader_mat4[a]+"]"},b.prototype.getVec4Str=function(a){return"vcmat["+b.shader_vec4[a][0]+"]["+b.shader_vec4[a][1]+"]"},b.getVcSize=function(){return 4},b.prototype.getVertexShaderString=function(){var a="attribute vec4 v3Position;\nattribute vec2 v2TexCoord;\nuniform mat4 vcmat["+Display3DFacetShader.getVcSize()+"];\nvarying vec2 v0;\nvarying vec4 v2;\n",b="attribute vec4 v3Normal;\n",c="",d="varying vec2 v1;\n",e="   vec2 tempv0 = v2TexCoord;\n   tempv0.x -= "+this.getVec4Str("uvMove")+".x;\n",f="   v1 = v2TexCoord;\n",g="   v0 = tempv0;\n",h="   tempv0.xy *= "+this.getVec4Str("isUv")+".xy;\n   if("+this.getVec4Str("isUv")+".z >= 0.0){\n   vec2 tempv1 = tempv0;\n   tempv0.y = tempv1.x;\n   tempv0.x = tempv1.y;}\n   v0 = tempv0;\n",i="   float alpha = tempv0.x/"+this.getVec4Str("uvMove")+".y;\n   alpha = 1.0 - clamp(abs(alpha),0.0,1.0);\n   float kill = -tempv0.x;\n   kill *= tempv0.x - "+this.getVec4Str("uvMove")+".z;\n   v2 = vec4(kill,0.0,0.0,alpha);\n",j="   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("posMatrix3D")+" * v3Position;\n",k="   vec4 tempPos = "+this.getMat4Str("posMatrix3D")+" * v3Position;\n   vec3 mulPos = vec3(tempPos.x,tempPos.y,tempPos.z);\n   vec3 normals = vec3(v3Normal.x,v3Normal.y,v3Normal.z);\n   mulPos = normalize(vec3("+this.getVec4Str("camPos")+".xyz) - mulPos);\n   mulPos = cross(mulPos, normals);\n   mulPos = normalize(mulPos);\n   mulPos *= v3Normal.w;\n   tempPos.xyz = mulPos.xyz + v3Position.xyz;\n   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("posMatrix3D")+" * tempPos;\n",l=this.paramAry[0],m=this.paramAry[1],n=this.paramAry[2],o=a;l&&(o+=b),m&&(o+=c),n&&(o+=d);var p=e+i;n&&(p+=f),p+=m?h:g,p+=l?k:j;var q=o+"void main(void){\n"+p+"}";return q},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}";return a},b.Display3D_Locus_Shader="Display3DLocusShader",b.shader_mat4={viewMatrix3D:0,camMatrix3D:1,posMatrix3D:2},b.shader_vec4={uvMove:[3,0],camPos:[3,1],isUv:[3,2]},b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleLocusData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._speed=1,b._isLoop=!1,b}return __extends(b,a),b.prototype.getParticle=function(){return new Display3DLocusPartilce},b.prototype.setAllByteInfo=function(b){this._isLoop=b.readBoolean(),this._speed=b.readFloat(),this._density=b.readFloat(),this._isEnd=b.readBoolean(),this.objData=new ObjData;var c=b.getInt(),d=9,e=c*d*4,f=new ArrayBuffer(e),g=new DataView(f);BaseRes.readBytes2ArrayBuffer(b,g,3,0,d,4),BaseRes.readBytes2ArrayBuffer(b,g,4,3,d,4),BaseRes.readBytes2ArrayBuffer(b,g,2,7,d,4);for(var h=b.readInt(),i=0;h>i;i++)this.objData.indexs.push(b.readInt());this.objData.stride=4*d,a.prototype.setAllByteInfo.call(this,b),this.initUV(),this._watchEye&&(this._caramPosVec=[0,0,0]),this._uvVec=[this._isU?-1:1,this._isV?-1:1,this._isUV?1:-1],this.initVcData(),this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3DArrayBuffer(f),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},b.prototype.initUV=function(){this._resultUvVec=new Array(3);var a=0,b=this._life/100,c=this._speed*a/this._density/10;this._isEnd&&(c=Math.min(1,c));var d;this._isLoop?this._life?(c%=b+1,d=new Vector3D(c,b,-b)):(c%=1,d=new Vector3D(c+1,99,-2)):d=this._life?new Vector3D(c,b,-1):new Vector3D(c,99,-1),this._resultUvVec[0]=d.x,this._resultUvVec[1]=d.y,this._resultUvVec[2]=d.z},b.prototype.uploadGpu=function(){this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this._watchEye&&(this.objData.normalsBuffer=Scene_data.context3D.uploadBuff3D(this.objData.normals)),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},b.prototype.regShader=function(){if(this.materialParam){var a=this._watchEye?1:0,b=0,c=this.materialParam.material.hasParticleColor;this._isU||this._isV||this._isUV?(b=1,this._changUv=!0):this._changUv=!1;var d;d=[a,b,c?1:0],this.materialParam.shader=ProgrmaManager.getInstance().getMaterialProgram(Display3DLocusShader.Display3D_Locus_Shader,Display3DLocusShader,this.materialParam.material,d),this.materialParam.program=this.materialParam.shader.program}},b.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*Display3DLocusShader.getVcSize())},b.prototype.setFloat32Vec=function(a,b){var c=Display3DLocusShader.shader_vec4[a],d=16*c[0]+4*c[1];this.vcmatData.set(b,d)},b.prototype.setFloat32Mat=function(a,b){var c=16*Display3DLocusShader.shader_mat4[a];this.vcmatData.set(b,c)},b}(ParticleData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DLocusBallPartilce=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.creatData=function(){this.data=new ParticleLocusballData},b}(Display3DBallPartilce),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleLocusballData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getParticle=function(){return new Display3DLocusBallPartilce},b.prototype.initBasePos=function(){for(var a=new Array,b=0;b<this._totalNum;b++){var c,d=3*b;if(this._isRandom){var e=new Vector3D(this._round.x*this._round.w,this._round.y*this._round.w,this._round.z*this._round.w);c=new Vector3D(this._posAry[d]+Math.random()*e.x,this._posAry[d+1]+Math.random()*e.y,this._posAry[d+2]+Math.random()*e.z)}else c=new Vector3D(this._posAry[d],this._posAry[d+1],this._posAry[d+2]);c=c.add(this._basePositon);for(var f=0;4>f;f++)a.push(c.x,c.y,c.z,b*this._shootSpeed)}this.objBallData.basePos=a},b.prototype.initSpeed=function(){for(var a=new Array,b=0;b<this._totalNum;b++){var c=new Vector3D;if(0==this._tangentSpeed)c.addByNum(this._angleAry[3*b],this._angleAry[3*b+1],this._angleAry[3*b+2]);else if(2==this._tangentSpeed)c.setTo(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);else{var d=new Vector3D(this._tangentAry[3*b],this._tangentAry[3*b+1],this._tangentAry[3*b+2]);d.scaleBy(this._tangentSpeed),c=c.add(d)}c.normalize(),this._isSendRandom?c.scaleBy(this._speed*Math.random()):c.scaleBy(this._speed);for(var e=0;4>e;e++)a.push(c.x,c.y,c.z)}this.objBallData.beMove=a},b.prototype.setAllByteInfo=function(b){this._tangentSpeed=b.readFloat(),this._posAry=JSON.parse(b.readUTF()),this._angleAry=JSON.parse(b.readUTF()),this._tangentAry=JSON.parse(b.readUTF()),a.prototype.setAllByteInfo.call(this,b),this.uploadGpu()},b}(ParticleBallData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DModelPartilce=function(a){function b(){var b=a.call(this)||this;return b._resultUvVec=new Array(2),b}return __extends(b,a),Object.defineProperty(b.prototype,"modeldata",{get:function(){return this.data},enumerable:!0,configurable:!0}),b.prototype.creatData=function(){this.data=new ParticleModelData},b.prototype.setVc=function(){this.updateWatchCaramMatrix(),this.updateUV(),this.data.vcmatData.set(Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,48),this.data.vcmatData.set(this._rotationMatrix.m,32),this.data.vcmatData.set(this._resultUvVec,64),Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData),this.setMaterialVc()},b.prototype.setVa=function(){var a=Scene_data.context3D.pushVa(this.data.objData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,12)),this.setMaterialTexture(),Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},b.prototype.updateWatchCaramMatrix=function(){this._rotationMatrix.identity(),this.data._watchEye&&(this.timeline.inverAxisRotation(this._rotationMatrix),this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS)),this.data._isZiZhuan&&this.timeline.applySelfRotation(this._rotationMatrix,this.data._ziZhuanAngly)},b.prototype.updateUV=function(){this._resultUvVec[0]=this._time/Scene_data.frameTime*this.data._uSpeed,this._resultUvVec[1]=this._time/Scene_data.frameTime*this.data._vSpeed},b}(Display3DParticle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DModelObjParticle=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.update=function(){this._depthMode&&Scene_data.context3D.setDepthTest(!0),a.prototype.update.call(this),this._depthMode&&Scene_data.context3D.setDepthTest(!1)},b}(Display3DModelPartilce),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3dModelAnimParticle=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.updateUV=function(){var a=this._time/Scene_data.frameTime;a=a>this.modeldata._maxAnimTime?this.modeldata._maxAnimTime:a,
a=a/this.data._animInterval%(this.data._animLine*this.data._animRow),this._resultUvVec[0]=float2int(a%this.data._animLine)/this.data._animLine+this._time/Scene_data.frameTime*this.data._uSpeed,this._resultUvVec[1]=float2int(a/this.data._animLine)/this.data._animRow+this._time/Scene_data.frameTime*this.data._vSpeed},b}(Display3DModelPartilce),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleModelData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getParticle=function(){return new Display3DModelPartilce},b.prototype.setAllByteInfo=function(b){this.objData=new ObjData,this._maxAnimTime=b.readFloat();var c=b.getInt(),d=5,e=c*d*4,f=new ArrayBuffer(e),g=new DataView(f);BaseRes.readBytes2ArrayBuffer(b,g,3,0,d,4),BaseRes.readBytes2ArrayBuffer(b,g,2,3,d,4);for(var h=b.readInt(),i=0;h>i;i++)this.objData.indexs.push(b.readInt());this.objData.stride=4*d,a.prototype.setAllByteInfo.call(this,b),this.initVcData(),this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3DArrayBuffer(f),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},b.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*Display3DFacetShader.getVcSize())},b.prototype.uploadGpu=function(){this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},b.prototype.regShader=function(){this.materialParam.shader=ProgrmaManager.getInstance().getMaterialProgram(Display3DFacetShader.Display3D_Facet_Shader,Display3DFacetShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program},b.prototype.setFloat32Vec=function(a,b){var c=Display3DFacetShader.shader_vec4[a],d=16*c[0]+4*c[1];this.vcmatData.set(b,d)},b.prototype.setFloat32Mat=function(a,b){var c=16*Display3DFacetShader.shader_mat4[a];this.vcmatData.set(b,c)},b}(ParticleData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DFollowPartilce=function(a){function b(){var b=a.call(this)||this;return b.flag=0,b}return __extends(b,a),Object.defineProperty(b.prototype,"followdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),b.prototype.creatData=function(){this.data=new ParticleFollowData},b.prototype.onCreated=function(){this.initBingMatrixAry()},b.prototype.setVc=function(){a.prototype.setVc.call(this),this.updateBind(),Scene_data.context3D.setVc3fv(this.data.materialParam.shader,"bindpos",this._bindMatrixAry)},b.prototype.initBingMatrixAry=function(){this._bindMatrixAry=new Float32Array(120),this._bindFlagAry=new Array;for(var a=0;a<this.followdata._totalNum;a++)this._bindFlagAry.push(0)},b.prototype.updateBind=function(){for(var a=this._time/Scene_data.frameTime,b=this.flag;b<this.followdata._totalNum;b++){var c=(a-b*this.followdata._shootSpeed)/this.followdata._life;if(c>=this._bindFlagAry[b]){var d=3*b;this._bindMatrixAry[d]=this.bindVecter3d.x,this._bindMatrixAry[d+1]=this.bindVecter3d.y,this._bindMatrixAry[d+2]=this.bindVecter3d.z,this._bindFlagAry[b]++}}},b.prototype.updateMatrix=function(){this.bindMatrix&&(this.modelMatrix.identity(),this.groupMatrix.isIdentity||this.posMatrix.append(this.groupMatrix),this.modelMatrix.append(this.posMatrix))},b.prototype.updateAllRotationMatrix=function(){this.followdata._allRotationMatrix.identity(),this.followdata._allRotationMatrix.prependScale(this.followdata.overAllScale*this._scaleX*.1*this.bindScale.x,this.followdata.overAllScale*this._scaleY*.1*this.bindScale.y,this.followdata.overAllScale*this._scaleZ*.1*this.bindScale.z),this.isInGroup&&(this.followdata._allRotationMatrix.appendRotation(this.groupRotation.x,Vector3D.X_AXIS),this.followdata._allRotationMatrix.appendRotation(this.groupRotation.y,Vector3D.Y_AXIS),this.followdata._allRotationMatrix.appendRotation(this.groupRotation.z,Vector3D.Z_AXIS))},b.prototype.reset=function(){a.prototype.reset.call(this);for(var b=0;b<this.followdata._totalNum;b++)this._bindMatrixAry[3*b]=0,this._bindMatrixAry[3*b+1]=0,this._bindMatrixAry[3*b+2]=0,this._bindFlagAry[b]=0},b.prototype.updateWatchCaramMatrix=function(){this._rotationMatrix.identity(),this.followdata.facez?this._rotationMatrix.prependRotation(90,Vector3D.X_AXIS):this.followdata._watchEye&&(this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),this._rotationMatrix.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS))},b}(Display3DBallPartilce),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DFollowShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"vPosition"),a.bindAttribLocation(this.program,1,"texcoord"),a.bindAttribLocation(this.program,2,"basePos"),a.bindAttribLocation(this.program,3,"speed");var b=this.paramAry[3];b&&a.bindAttribLocation(this.program,4,"rotation");var c=this.paramAry[1];c&&a.bindAttribLocation(this.program,5,"color")},b.prototype.getMat4Str=function(a){return"vcmat["+Display3DBallShader.shader_mat4[a]+"]"},b.prototype.getVec4Str=function(a){return"vcmat["+Display3DBallShader.shader_vec4[a][0]+"]["+Display3DBallShader.shader_vec4[a][1]+"]"},b.getVcSize=function(){return 7},b.prototype.getVertexShaderString=function(){var a,b,c,d,e,f,g,h,i,j,k,l,i,h,m,n,o,p,q,r,s,t,u;m="attribute vec4 vPosition;\nattribute vec3 texcoord;\nattribute vec4 basePos;\nattribute vec3 speed;\nuniform mat4 vcmat["+Display3DBallShader.getVcSize()+"];\nuniform vec3 bindpos[30];\nvarying vec2 v0;\n",t="attribute vec4 color;\nvarying vec4 v2;\n",n="",o="attribute vec2 rotation;\n",p="",q="",r="",s="",u="varying vec2 v1;\n",a="float ctime = "+this.getVec4Str("time")+".x - basePos.w;\nif ("+this.getVec4Str("time")+".w > 0.0 && ctime >= 0.0) {\n    ctime = fract(ctime / "+this.getVec4Str("time")+".z) * "+this.getVec4Str("time")+".z;\n}\nvec4 pos = vPosition;\n",b="float stime = ctime - "+this.getVec4Str("scale")+".w;\nstime = max(stime,0.0);\nfloat sf = "+this.getVec4Str("scale")+".x * stime;\nif ("+this.getVec4Str("scale")+".y != 0.0 && "+this.getVec4Str("scale")+".z != 0.0) {\n    sf += sin("+this.getVec4Str("scale")+".y * stime) * "+this.getVec4Str("scale")+".z;\n}\nif (sf > "+this.getVec4Str("scaleCtrl")+".z) {\n    sf = "+this.getVec4Str("scaleCtrl")+".z;\n} else if (sf < "+this.getVec4Str("scaleCtrl")+".w) {\n    sf = "+this.getVec4Str("scaleCtrl")+".w;\n}\nvec2 sv2 = vec2("+this.getVec4Str("scaleCtrl")+".x * sf, "+this.getVec4Str("scaleCtrl")+".y * sf);\nsv2 = sv2 + 1.0;\npos.x *= sv2.x;\npos.y *= sv2.y;\n",c="float angle = rotation.x + rotation.y * ctime;\nvec4 np = vec4(sin(angle), cos(angle), 0, 0);\nnp.z = np.x * pos.y + np.y * pos.x;\nnp.w = np.y * pos.y - np.x * pos.x;\npos.xy = np.zw;\n",d="vec3 addPos = speed * ctime;\nvec3 uspeed = vec3(0,0,0);\nif (ctime < 0.0 || ctime >= "+this.getVec4Str("time")+".z) {\n    addPos.y = addPos.y + 100000.0;\n}\n",e="if("+this.getVec4Str("time")+".y != 0.0 && length(speed) != 0.0) {\n    uspeed = vec3(speed.x, speed.y, speed.z);\n    uspeed = normalize(uspeed);\n    uspeed = uspeed * "+this.getVec4Str("time")+".y;\n    uspeed.xyz = uspeed.xyz + "+this.getVec4Str("force")+".xyz;\n} else {\n    uspeed = vec3("+this.getVec4Str("force")+".x, "+this.getVec4Str("force")+".y, "+this.getVec4Str("force")+".z);\n}\naddPos.xyz = addPos.xyz + uspeed.xyz * ctime * ctime;\n",f="uspeed = speed + uspeed * ctime * 2.0;\nuspeed = normalize(uspeed);\nvec4 tempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(uspeed,1.0);\nuspeed.xyz = tempMul.xyz;\nuspeed = normalize(uspeed);\nvec3 cPos = addPos;\ntempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(cPos,1.0);\ncPos.xyz = tempMul.xyz; \ncPos.xyz = "+this.getVec4Str("worldPos")+".xyz + cPos.xyz;\ncPos.xyz = "+this.getVec4Str("camPos")+".xyz - cPos.xyz;\ncPos = normalize(cPos);\ncPos = cross(uspeed, cPos);\ncPos = normalize(cPos);\nuspeed = uspeed * pos.x;\ncPos = cPos * pos.y;\npos.xyz = uspeed.xyz + cPos.xyz;\n",g="pos = "+this.getMat4Str("watheye")+" * pos;\npos.xyz = pos.xyz + basePos.xyz + addPos.xyz;\npos = "+this.getMat4Str("modelMatrix")+" * pos;\npos.xyz = pos.xyz + bindpos[int(texcoord.z)].xyz;\ngl_Position = "+this.getMat4Str("viewMatrix3D")+" * "+this.getMat4Str("camMatrix3D")+" * pos;\n",j="v0 = vec2(texcoord.x,texcoord.y);\n",k="vec2 uv = vec2(texcoord.x,texcoord.y);\nfloat animframe = floor(ctime / "+this.getVec4Str("animCtrl")+".z);\nanimframe = animframe / "+this.getVec4Str("animCtrl")+".x;\nuv.x += animframe;\nanimframe = floor(animframe);\nuv.y += animframe / "+this.getVec4Str("animCtrl")+".y;\nv0.xy = uv.xy;\n",l="vec2 uv = vec2("+this.getVec4Str("uvCtrl")+".x,"+this.getVec4Str("uvCtrl")+".y);\nuv.xy = uv.xy * ctime + texcoord.xy;\nv0.xy = uv.xy;\n",i="v2 = color;\n",h="v1 = vec2(ctime/"+this.getVec4Str("time")+".z,1.0);\n";var v=this.paramAry[0],w=this.paramAry[1],x=this.paramAry[2],y=this.paramAry[3],z=this.paramAry[4],A=this.paramAry[5],B=this.paramAry[6],C="",D="";C+=a,D+=m,z&&(C+=b,D+=n),y&&(C+=c,D+=o),C+=d,A&&(C+=e,D+=p),x&&(C+=f,D+=q),C+=g,1==B?(C+=k,D+=r):2==B?(C+=l,D+=s):C+=j,w&&(C+=i,D+=t),v&&(C+=h,D+=u);var E=D+"void main(){\n"+C+"}";return E},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}";return a},b.Display3D_Follow_Shader="Display3DFollowShader",b.shader_mat4={viewMatrix3D:0,camMatrix3D:1,modelMatrix:2,watheye:3,rotationMatrix:4},b.shader_vec4={time:[5,0],scale:[5,1],scaleCtrl:[5,2],force:[5,3],worldPos:[6,0],camPos:[6,1],animCtrl:[6,2],uvCtrl:[6,3]},b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleFollowData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getParticle=function(){return new Display3DFollowPartilce},b.prototype.setAllByteInfo=function(b){a.prototype.setAllByteInfo.call(this,b),this.uploadGpu()},b.prototype.regShader=function(){if(this.materialParam){var a=this.getShaderParam();this.materialParam.shader=ProgrmaManager.getInstance().getMaterialProgram(Display3DFollowShader.Display3D_Follow_Shader,Display3DFollowShader,this.materialParam.material,a),this.materialParam.program=this.materialParam.shader.program}},b}(ParticleBallData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DFollowLocusPartilce=function(a){function b(){var b=a.call(this)||this;return b.flag=0,b._caramPosVec=[0,0,0],b}return __extends(b,a),Object.defineProperty(b.prototype,"followlocusdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),b.prototype.creatData=function(){this.data=new ParticleFollowLocusData},b.prototype.onCreated=function(){this.initBindMatrixAry()},b.prototype.initBindMatrixAry=function(){this._bindPosAry=new Array,this._gpuVc=new Float32Array(6*this.followlocusdata._fenduanshu);for(var a=0;a<=this.followlocusdata._fenduanshu;a++)this._bindPosAry.push([0,0,5*a]),this._bindPosAry.push([0,0,1])},b.prototype.setVa=function(){var a=Scene_data.context3D.pushVa(this.data.objData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,12)),this.setMaterialTexture(),Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},b.prototype.setVc=function(){this.updateMatrix(),this.updateBind(),this.data.vcmatData.set(Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(Scene_data.cam3D.cameraMatrix.m,16),this._caramPosVec[0]=Scene_data.cam3D.x,this._caramPosVec[1]=Scene_data.cam3D.y,this._caramPosVec[2]=Scene_data.cam3D.z,this.data.vcmatData.set(this._caramPosVec,32),Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData),this.setBindPosVc(),this.setMaterialVc()},b.prototype.setBindPosVc=function(){for(var a=0;a<this._bindPosAry.length;a++)Scene_data.context3D.setVc3fv(this.data.materialParam.shader,"bindpos["+a+"]",this._bindPosAry[a])},b.prototype.updateMatrix=function(){this.modelMatrix.identity(),this.modelMatrix.prepend(this.posMatrix)},b.prototype.resetPos=function(){for(var a=0;a<this._bindPosAry.length;a+=2)this._bindPosAry[a][0]=this.bindVecter3d.x,this._bindPosAry[a][1]=this.bindVecter3d.y,this._bindPosAry[a][2]=this.bindVecter3d.z;this.flag=TimeUtil.getTimer()},b.prototype.updateBind=function(){var a=TimeUtil.getTimer();if(a-this.flag>=35){var b=this._bindPosAry.pop(),c=this._bindPosAry.pop();c[0]=this.bindVecter3d.x,c[1]=this.bindVecter3d.y,c[2]=this.bindVecter3d.z;var d=this._bindPosAry[0],e=this._bindPosAry[1],f=new Vector3D(c[0]-d[0],c[1]-d[1],c[2]-d[2]);f.normalize(),e[0]=f.x,b[0]=f.x,e[1]=f.y,b[1]=f.y,e[2]=f.z,b[2]=f.z,this._bindPosAry.unshift(b),this._bindPosAry.unshift(c),this.flag=a}},b}(Display3DParticle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DFollowLocusShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v2TexCoord")},b.prototype.getMat4Str=function(a){return"vcmat["+b.shader_mat4[a]+"]"},b.prototype.getVec4Str=function(a){return"vcmat["+b.shader_vec4[a][0]+"]["+b.shader_vec4[a][1]+"]"},b.getVcSize=function(){return 3},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Position;\nattribute vec2 v2TexCoord;\nuniform mat4 vcmat["+Display3DFacetShader.getVcSize()+"];\nuniform vec3 bindpos[30];\nvarying vec2 v0;\n",b="   vec3 cpos = bindpos[int(v3Position.x)];\n   vec3 mulPos = normalize(vec3("+this.getVec4Str("camPos")+".xyz) - cpos);\n   vec3 normals = bindpos[int(v3Position.y)];\n   mulPos = cross(mulPos, normals);\n   mulPos = normalize(mulPos);\n   mulPos *= v3Position.z;\n   cpos += mulPos;\n   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * vec4(cpos,1.0);\n",c="v0 = v2TexCoord;\n",d=a+"void main(){\n"+b+c+"}";return d},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}";return a},b.Display3D_FollowLocus_Shader="Display3DFollowLocusShader",b.shader_mat4={viewMatrix3D:0,camMatrix3D:1},b.shader_vec4={camPos:[2,0]},b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleFollowLocusData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getParticle=function(){return new Display3DFollowLocusPartilce},b.prototype.setAllByteInfo=function(b){this._fenduanshu=b.readFloat(),a.prototype.setAllByteInfo.call(this,b),this.uploadGpu(),this.initVcData()},b.prototype.uploadGpu=function(){this.objData=new ObjData,this.objData.vertices=new Array,this.objData.uvs=new Array,this.objData.indexs=new Array;for(var a=0;a<=this._fenduanshu;a++){var b=new Vector2D(a/this._fenduanshu,0),c=new Vector2D(a/this._fenduanshu,1);b.scaleBy(.9),c.scaleBy(.9),this._isU&&(b.x=-b.x,c.x=-c.x),this._isV&&(b.y=-b.y,c.y=-c.y);var d=2*a;this.objData.vertices.push(d,d+1,-this._originWidthScale*this._width/100),this._isUV?this.objData.vertices.push(b.y,b.x):this.objData.vertices.push(b.x,b.y),this.objData.vertices.push(d,d+1,(1-this._originWidthScale)*this._width/100),this._isUV?this.objData.vertices.push(c.y,c.x):this.objData.vertices.push(c.x,c.y)}for(a=0;a<this._fenduanshu;a++)this.objData.indexs.push(0+2*a,1+2*a,2+2*a,1+2*a,3+2*a,2+2*a);this.pushToGpu()},b.prototype.pushToGpu=function(){this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.stride=20,this.objData.treNum=this.objData.indexs.length},b.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*Display3DFollowLocusShader.getVcSize())},b.prototype.regShader=function(){if(this.materialParam){new Display3DFollowLocusShader;this.materialParam.shader=ProgrmaManager.getInstance().getMaterialProgram(Display3DFollowLocusShader.Display3D_FollowLocus_Shader,Display3DFollowLocusShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program}},b}(ParticleData),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Display3DBoneShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"pos"),a.bindAttribLocation(this.program,1,"v2uv"),a.bindAttribLocation(this.program,2,"boneWeight"),a.bindAttribLocation(this.program,3,"boneID")},b.prototype.getMat4Str=function(a){return"vcmat["+b.shader_mat4[a]+"]"},b.getVcSize=function(){return 3},b.prototype.getVertexShaderString=function(){var a="attribute vec3 pos;attribute vec2 v2uv;attribute vec4 boneWeight;attribute vec4 boneID;uniform vec4 boneQ[54];\nuniform vec3 boneD[54];\nuniform mat4 vcmat["+b.getVcSize()+"];\nvarying vec2 v0;\n"+MaterialAnimShader.getMd5M44Str()+"void main(void){v0 = v2uv;\nvec4 vt0 = getQDdata(vec3(pos.x,pos.y,pos.z));\n gl_Position = "+this.getMat4Str("viewMatrix3D")+" * "+this.getMat4Str("camMatrix3D")+" *"+this.getMat4Str("posMatrix3D")+"* vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;\nvarying vec2 v0;\nvoid main(void)\n{\ngl_FragColor = vec4(1.0,0.0,1.0,1.0);\n}";return a},b.Display3DBoneShader="Display3DBoneShader",b.shader_mat4={viewMatrix3D:0,camMatrix3D:1,posMatrix3D:2},b}(Shader3D),Display3DBonePartilce=function(a){function b(){var b=a.call(this)||this;return b.skipNum=0,b}return __extends(b,a),Object.defineProperty(b.prototype,"modeldata",{get:function(){return this.data},enumerable:!0,configurable:!0}),b.prototype.creatData=function(){this.data=new ParticleBoneData},b.prototype.update=function(){Scene_data.context3D.setWriteDepth(!0),a.prototype.update.call(this),Scene_data.context3D.setWriteDepth(!1)},b.prototype.setVc=function(){var a=float2int(this._time/Scene_data.frameTime/2);this.data.vcmatData.set(Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,32),Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData);var b=this.modeldata.animData.boneQPAry[0],c=b.length,d=a%c,e=b[d];Scene_data.context3D.setVc4fv(this.data.materialParam.shader,"boneQ",e.quat),Scene_data.context3D.setVc3fv(this.data.materialParam.shader,"boneD",e.pos),this.setMaterialVc()},b.prototype.setVa=function(){var a=Scene_data.context3D.pushVa(this.modeldata.meshData.vertexBuffer);a||(Scene_data.context3D.setVaOffset(0,3,this.modeldata.meshData.stride,0),Scene_data.context3D.setVaOffset(1,2,this.modeldata.meshData.stride,12),Scene_data.context3D.setVaOffset(3,4,this.modeldata.meshData.stride,20),Scene_data.context3D.setVaOffset(2,4,this.modeldata.meshData.stride,36)),this.setMaterialTexture(),Scene_data.context3D.drawCall(this.modeldata.meshData.indexBuffer,this.modeldata.meshData.treNum)},b.prototype.resetVa=function(){a.prototype.resetVa.call(this)},b}(Display3DParticle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ParticleBoneData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.objScale=1,b}return __extends(b,a),b.prototype.getParticle=function(){return new Display3DBonePartilce},b.prototype.destory=function(){a.prototype.destory.call(this),this.meshData.destory(),this.animData=null},b.prototype.setAllByteInfo=function(b){this.meshData=new MeshData,this.animData=new AnimData,this.objScale=b.readFloat();var c=13,d=b.getInt();d*=4*c;var e=new ArrayBuffer(d),f=new DataView(e);BaseRes.readBytes2ArrayBuffer(b,f,3,0,c),BaseRes.readBytes2ArrayBuffer(b,f,2,3,c),BaseRes.readIntForTwoByte(b,this.meshData.indexs),BaseRes.readBytes2ArrayBuffer(b,f,4,5,c,2),BaseRes.readBytes2ArrayBuffer(b,f,4,9,c,3),this.meshData.stride=4*c,this.readFrameQua(b),a.prototype.setAllByteInfo.call(this,b),this.initVcData(),this.meshData.vertexBuffer=Scene_data.context3D.uploadBuff3DArrayBuffer(e),this.meshData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.meshData.indexs),this.meshData.treNum=this.meshData.indexs.length},b.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*Display3DBoneShader.getVcSize())},b.prototype.setFloat32Mat=function(a,b){var c=16*Display3DBoneShader.shader_mat4[a];this.vcmatData.set(b,c)},b.prototype.readFrameQua=function(a){for(var b=a.readFloat(),c=32767,d=a.readInt(),e=new Array,f=0;d>f;f++){var g=a.readInt(),h=new DualQuatFloat32Array;h.quat=new Float32Array(4*g),h.pos=new Float32Array(3*g);for(var i=0;g>i;i++)h.quat[4*i+0]=a.readShort()/c,h.quat[4*i+1]=a.readShort()/c,h.quat[4*i+2]=a.readShort()/c,h.quat[4*i+3]=a.readShort()/c,h.pos[3*i+0]=a.readShort()/c*b,h.pos[3*i+1]=a.readShort()/c*b,h.pos[3*i+2]=a.readShort()/c*b;e.push(h)}this.animData.boneQPAry=new Array,this.animData.boneQPAry.push(e)},b.prototype.uploadGpu=function(){this.uploadMesh(this.meshData)},b.prototype.uploadMesh=function(a){a.vertexBuffer=Scene_data.context3D.uploadBuff3D(a.vertices),a.uvBuffer=Scene_data.context3D.uploadBuff3D(a.uvs),a.boneIdBuffer=Scene_data.context3D.uploadBuff3D(a.boneIDAry),a.boneWeightBuffer=Scene_data.context3D.uploadBuff3D(a.boneWeightAry),a.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(a.indexs),a.treNum=a.indexs.length},b.prototype.regShader=function(){this.materialParam.shader=ProgrmaManager.getInstance().getMaterialProgram(Display3DBoneShader.Display3DBoneShader,Display3DBoneShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program},b}(ParticleData),KeyFrame=function(){function a(){}return a}(),TimeLineData=function(){function a(){this.dataAry=new Array}return a.prototype.destory=function(){this.dataAry=null},a.prototype.setByteData=function(a){for(var b=a.readFloat(),c=0;b>c;c++){var d=a.readFloat(),e=this.addKeyFrame(d);e.frameNum=d,e.baseValue=new Array;for(var f=0;10>f;f++)e.baseValue.push(a.readFloat());var g=a.readFloat();if(e.animData=new Array,g>0)for(var h=0;g>h;h++)e.animData.push(this.getByteDataTemp(a))}this.maxFrameNum=this.dataAry[this.dataAry.length-1].frameNum,this.beginTime=this.dataAry[0].frameNum*Scene_data.frameTime},a.prototype.addKeyFrame=function(a){var b=new Object;return b.frameNum=a,this.dataAry.push(b),b},a.prototype.getByteDataTemp=function(a){var b=new Object,c=a.readInt(),d=a.readInt();b.data=new Array,b.dataByte=new Array;for(var e=0;d>e;e++){var f=new Object;if(f.type=a.readInt(),1==f.type){var g=a.readFloat();b.dataByte.push(g)}if(2==f.type){var h=new Vector3D;h.x=a.readFloat(),h.y=a.readFloat(),h.z=a.readFloat(),b.dataByte.push(h)}}return b.type=c,b},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),TimeLine=function(a){function b(){var b=a.call(this)||this;return b._time=0,b.targetFlag=-1,b.beginTime=0,b.isByteData=!1,b.targetFlag=-1,b.visible=!1,b.maxFrameNum=0,b._time=0,b._keyFrameAry=new Array,b}return __extends(b,a),b.prototype.updateMatrix=function(a,b){this._axisMove&&a.prependTranslation(this._axisMove.axis.x*this._axisMove.num,this._axisMove.axis.y*this._axisMove.num,this._axisMove.axis.z*this._axisMove.num),this._axisRotaion&&a.prependRotation(this._axisRotaion.num,this._axisRotaion.axis),a.prependTranslation(b.data.center.x,b.data.center.y,b.data.center.z),this._scaleChange?a.prependScale(b.data._widthFixed?1:this._scaleChange.num,b.data._heightFixed?1:this._scaleChange.num,b.data._widthFixed?1:this._scaleChange.num):this._scaleNosie?a.prependScale(b.data._widthFixed?1:1+this._scaleNosie.num,b.data._heightFixed?1:1+this._scaleNosie.num,b.data._widthFixed?1:1+this._scaleNosie.num):this._scaleAnim&&a.prependScale(b.data._widthFixed?1:this._scaleAnim.num,b.data._heightFixed?1:this._scaleAnim.num,b.data._widthFixed?1:this._scaleAnim.num),a.prependRotation(b.data.rotationV3d.z,Vector3D.Z_AXIS),a.prependRotation(b.data.rotationV3d.y,Vector3D.Y_AXIS),a.prependRotation(b.data.rotationV3d.x,Vector3D.X_AXIS)},b.prototype.inverAxisRotation=function(a){this._axisRotaion&&a.prependRotation(-this._axisRotaion.num,this._axisRotaion.axis)},b.prototype.applySelfRotation=function(a,b){this._selfRotaion&&a.prependRotation(this._selfRotaion.num,b)},b.prototype.addKeyFrame=function(a){var b=new KeyFrame;return b.frameNum=a,this._keyFrameAry.push(b),b},b.prototype.updateTime=function(a){this._currentKeyFrame&&(this._time=a,this.getTarget(),this._axisRotaion&&this._axisRotaion.update(this._time),this._selfRotaion&&this._selfRotaion.update(this._time),this._axisMove&&this._axisMove.update(this._time),this._scaleChange?this._scaleChange.update(this._time):this._scaleNosie?this._scaleNosie.update(this._time):this._scaleAnim&&this._scaleAnim.update(this._time))},b.prototype.getTarget=function(){for(var a=-1,b=0;b<this._keyFrameAry.length&&this._keyFrameAry[b].frameNum*Scene_data.frameTime<this._time;b++)a=b;a!=this.targetFlag&&(this._currentKeyFrame=this._keyFrameAry[a],this.targetFlag=a,a==this._keyFrameAry.length-1?(this.visible=!1,this._currentKeyFrame=null):(this.visible=!0,this.enterKeyFrame(this._currentKeyFrame.animData,this._currentKeyFrame.frameNum*Scene_data.frameTime,this._currentKeyFrame.baseValue)))},b.prototype.enterKeyFrame=function(a,b,c){if(void 0===b&&(b=0),void 0===c&&(c=null),null!=c){for(var d=0;10>d;d++)if(c[d])switch(d){case 1:this._selfRotaion||(this._selfRotaion=new SelfRotation),this._selfRotaion.num=this._selfRotaion.baseNum=c[d];break;case 2:this._axisRotaion||(this._axisRotaion=new AxisRotaion),this._axisRotaion.num=this._axisRotaion.baseNum=c[d];break;case 6:this._scaleChange||(this._scaleChange=new ScaleChange),this._scaleChange.num=this._scaleChange.baseNum=c[d];break;case 7:this._scaleAnim||(this._scaleAnim=new ScaleAnim),this._scaleAnim.num=this._scaleAnim.baseNum=c[d];break;case 8:this._scaleNosie||(this._scaleNosie=new ScaleNoise),this._scaleNosie.num=this._scaleNosie.baseNum=c[d];break;case 9:this._axisMove||(this._axisMove=new AxisMove),this._axisMove.num=this._axisMove.baseNum=c[d]}this._selfRotaion&&(this._selfRotaion.isDeath=!0),this._axisRotaion&&(this._axisRotaion.isDeath=!0),this._scaleChange&&(this._scaleChange.isDeath=!0),this._scaleAnim&&(this._scaleAnim.isDeath=!0),this._scaleNosie&&(this._scaleNosie.isDeath=!0),this._axisMove&&(this._axisMove.isDeath=!0),a&&this.setBaseTimeByte(a,b,c)}},b.prototype.reset=function(){this._time=0,this._currentKeyFrame=this._keyFrameAry[0],this.visible=!1,this.targetFlag=-1},b.prototype.setAllByteInfo=function(a,b){this.isByteData=!0;for(var c=a.readFloat(),d=0;c>d;d++){var e=a.readFloat(),f=this.addKeyFrame(e);f.frameNum=e,f.baseValue=new Array;for(var g=0;10>g;g++)f.baseValue.push(a.readFloat());var h=a.readFloat();if(f.animData=new Array,h>0)for(var i=0;h>i;i++)f.animData.push(this.getByteDataTemp(a))}this.maxFrameNum=this._keyFrameAry[this._keyFrameAry.length-1].frameNum,this.beginTime=this._keyFrameAry[0].frameNum*Scene_data.frameTime,this._currentKeyFrame=this._keyFrameAry[0]},b.prototype.setAllDataInfo=function(a){this.isByteData=!0;for(var b=a.dataAry.length,c=0;b>c;c++){var d=this.addKeyFrame(a.dataAry[c].frameNum);d.baseValue=a.dataAry[c].baseValue,d.animData=a.dataAry[c].animData}this.maxFrameNum=a.maxFrameNum,this.beginTime=a.beginTime,this._currentKeyFrame=this._keyFrameAry[0]},b.prototype.setBaseTimeByte=function(a,b,c){void 0===b&&(b=0),void 0===c&&(c=null);for(var d=0;d<a.length;d++)1==a[d].type?(this._selfRotaion?this._selfRotaion.reset():this._selfRotaion=new SelfRotation,this._selfRotaion.dataByte(a[d].data,a[d].dataByte),this._selfRotaion.baseTime=b):2==a[d].type?(this._axisRotaion?this._axisRotaion.reset():this._axisRotaion=new AxisRotaion,this._axisRotaion.dataByte(a[d].data,a[d].dataByte),this._axisRotaion.baseTime=b):6==a[d].type?(this._scaleChange?this._scaleChange.reset():this._scaleChange=new ScaleChange,this._scaleChange.dataByte(a[d].data,a[d].dataByte),this._scaleChange.baseTime=b):7==a[d].type?(this._scaleAnim?this._scaleAnim.reset():this._scaleAnim=new ScaleAnim,this._scaleAnim.dataByte(a[d].data,a[d].dataByte),this._scaleAnim.baseTime=b):8==a[d].type?(this._scaleNosie?this._scaleNosie.reset():this._scaleNosie=new ScaleNoise,this._scaleNosie.dataByte(a[d].data,a[d].dataByte),this._scaleNosie.baseTime=b):9==a[d].type&&(this._axisMove?this._axisMove.reset():this._axisMove=new AxisMove,this._axisMove.dataByte(a[d].data,a[d].dataByte),this._axisMove.baseTime=b)},b.prototype.getByteDataTemp=function(a){var b=new Object,c=a.readInt(),d=a.readInt();b.data=new Array,b.dataByte=new Array;for(var e=0;d>e;e++){var f=new Object;if(f.type=a.readInt(),1==f.type){var g=a.readFloat();b.dataByte.push(g)}if(2==f.type){var h=new Vector3D;h.x=a.readFloat(),h.y=a.readFloat(),h.z=a.readFloat(),b.dataByte.push(h)}}return b.type=c,b},b.prototype.getMaxFrame=function(){return this._keyFrameAry[this._keyFrameAry.length-1].frameNum},b.prototype.dispose=function(){},b}(EventDispatcher),BaseAnim=function(){function a(){this.baseNum=0,this.num=0,
this.time=0,this.speed=0,this.aSpeed=0,this.beginTime=0,this.lastTime=0,this.baseTime=0}return a.prototype.BaseAnim=function(){},a.prototype.update=function(a){this._isDeath||(this.time=a-this.baseTime,this._isActiva?(this.time=this.time-this.beginTime,this.time>this.lastTime&&(this.time=this.lastTime-this.beginTime,this._isDeath=!0),this.coreCalculate()):this.time>=this.beginTime&&(this.time>=this.lastTime?(this.time=this.lastTime-this.beginTime,this.coreCalculate(),this._isDeath=!0):(this.time=this.time-this.beginTime,this.coreCalculate()),this._isActiva=!0))},a.prototype.coreCalculate=function(){this.num=this.speed*this.time+this.aSpeed*this.time*this.time+this.baseNum},a.prototype.reset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.num=0},a.prototype.depthReset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.baseNum=0,this.num=0},Object.defineProperty(a.prototype,"data",{set:function(a){},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isDeath",{get:function(){return this._isDeath},set:function(a){this._isDeath=a},enumerable:!0,configurable:!0}),a.prototype.getAllNum=function(a){a=Math.min(a,this.lastTime),a-=this.beginTime;var b=this.speed*a+this.aSpeed*a*a;this.baseNum+=b},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),AxisMove=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),Object.defineProperty(b.prototype,"data",{set:function(a){this.beginTime=Number(a[0].value),-1==Number(a[1].value)?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=Number(a[1].value);var b=a[2].value.split("|");this.axis=new Vector3D(Number(b[0]),Number(b[1]),Number(b[2])),this.axis.normalize(),this.speed=.1*Number(a[3].value),this.aSpeed=.001*Number(a[4].value)},enumerable:!0,configurable:!0}),b.prototype.dataByte=function(a,b){this.beginTime=b[0],-1==b[1]?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=b[1],this.axis=b[2],this.axis.normalize(),this.speed=.1*b[3],this.aSpeed=.001*b[4]},b}(BaseAnim),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),AxisRotaion=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),Object.defineProperty(b.prototype,"data",{set:function(a){this.beginTime=Number(a[0].value),-1==Number(a[1].value)?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=Number(a[1].value);var b=String(a[2].value).split("|");this.axis=new Vector3D(Number(b[0]),Number(b[1]),Number(b[2])),b=String(a[3].value).split("|"),this.axisPos=new Vector3D(100*Number(b[0]),100*Number(b[1]),100*Number(b[2])),this.speed=.1*Number(a[4].value),this.aSpeed=.1*Number(a[5].value)},enumerable:!0,configurable:!0}),b.prototype.dataByte=function(a,b){this.beginTime=Number(b[0]),-1==Number(b[1])?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=Number(b[1]),this.axis=b[2],this.axisPos=b[3],this.speed=.1*b[4],this.aSpeed=.1*b[5]},b}(BaseAnim),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ScaleAnim=function(a){function b(){var b=a.call(this)||this;return b.num=1,b}return __extends(b,a),b.prototype.update=function(a){this._isDeath||(this.time=a-this.baseTime,this._isActiva?(this.coreCalculate(),this.time>this.lastTime&&(this._isDeath=!0)):this.time>=this.beginTime&&(this._isActiva=!0))},b.prototype.coreCalculate=function(){var a=float2int(this.time/Scene_data.frameTime);a>=this.numAry.length?this.num=this.numAry[this.numAry.length-1]:this.num=this.numAry[a]},b.prototype.reset=function(){a.prototype.reset.call(this),this.num=1},b.prototype.depthReset=function(){a.prototype.depthReset.call(this),this.num=1},Object.defineProperty(b.prototype,"data",{set:function(a){this.numAry=new Array,this.beginTime=Number(a[0].value),-1==Number(a[1].value)?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=Number(a[1].value),this.beginScale=Number(a[2].value),this.scaleNum=Number(a[3].value),this.scaleAry=new Array;for(var b=0,c=4;c<4+2*this.scaleNum;c+=2){var d=new Object;d.value=Number(a[c].value),d.time=Number(a[c+1].value),b+=d.time,d.beginTime=this.beginTime+b,this.scaleAry.push(d)}var e,f=0,g=1;this.scaleAry.length?(e=(this.scaleAry[this.scaleAry.length-1].beginTime+this.scaleAry[this.scaleAry.length-1].time)/Scene_data.frameTime,g=this.scaleAry[0].beginTime,this._currentTarget=this.scaleAry[0]):e=0;var h=0;for(c=0;e>c;c++){var i=Scene_data.frameTime*c;i>=this._currentTarget.beginTime&&(this.beginScale=this._currentTarget.value,f=this._currentTarget.beginTime,h==this.scaleAry.length-1?this._currentTarget=this.scaleAry[this.scaleAry.length-1]:(h++,this._currentTarget=this.scaleAry[h]),g=this._currentTarget.time);var j=(i-f)/g*(this._currentTarget.value-this.beginScale)+this.beginScale;this.numAry.push(j)}this._currentTarget=this.scaleAry[0]},enumerable:!0,configurable:!0}),b.prototype.dataByte=function(a,b){this.numAry=new Array,this.beginTime=b[0],-1==b[1]?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=b[1],this.beginScale=b[2],this.scaleNum=b[3],this.scaleAry=new Array;for(var c=0,d=4;d<4+2*this.scaleNum;d+=2){var e=new Object;e.value=b[d],e.time=b[d+1],c+=e.time,e.beginTime=this.beginTime+c,this.scaleAry.push(e)}var f,g=0,h=1;this.scaleAry.length?(f=(this.scaleAry[this.scaleAry.length-1].beginTime+this.scaleAry[this.scaleAry.length-1].time)/Scene_data.frameTime,h=this.scaleAry[0].beginTime,this._currentTarget=this.scaleAry[0]):f=0;var i=0;for(d=0;f>d;d++){var j=Scene_data.frameTime*d;j>=this._currentTarget.beginTime&&(this.beginScale=this._currentTarget.value,g=this._currentTarget.beginTime,i==this.scaleAry.length-1?this._currentTarget=this.scaleAry[this.scaleAry.length-1]:(i++,this._currentTarget=this.scaleAry[i]),h=this._currentTarget.time);var k=(j-g)/h*(this._currentTarget.value-this.beginScale)+this.beginScale;this.numAry.push(k)}this._currentTarget=this.scaleAry[0]},b.prototype.getAllNum=function(a){a=Math.min(a,this.lastTime+this.beginTime);var b=this.scaleAry[this.scaleAry.length-1];if(a>=b.beginTime+b.time)return void(this.baseNum=b.value);for(var c,d=0;d<this.scaleAry.length;d++)a>this.scaleAry[d]["this"].beginTime&&(this._currentTarget=this.scaleAry[d],this.beginTime=this._currentTarget["this"].beginTime,this.beginScale=this._currentTarget.value,c=d);c++,this._currentTarget=this.scaleAry[c],this.baseNum=(this._currentTarget.value-this.beginScale)/this._currentTarget["this"].time*(a-this.beginTime)+this.beginScale},b}(BaseAnim),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ScaleChange=function(a){function b(){var b=a.call(this)||this;return b.num=1,b}return __extends(b,a),b.prototype.coreCalculate=function(){this.num=1+this.speed*this.time+this.baseNum,this.num<this.minNum?this.num=this.minNum:this.num>this.maxNum&&(this.num=this.maxNum)},Object.defineProperty(b.prototype,"data",{set:function(a){this.beginTime=Number(a[0].value),-1==Number(a[1].value)?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=Number(a[1].value),this.speed=.001*Number(a[2].value),this.minNum=.01*Number(a[3].value),this.maxNum=.01*Number(a[4].value)},enumerable:!0,configurable:!0}),b.prototype.dataByte=function(a,b){this.beginTime=b[0],-1==b[1]?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=b[1],this.speed=.001*b[2],this.minNum=.01*b[3],this.maxNum=.01*b[4]},b.prototype.getAllNum=function(a){a=Math.min(a,this.lastTime),a-=this.beginTime;var b=this.speed*a;this.baseNum+=b,this.baseNum<this.minNum?this.baseNum=this.minNum:b>this.maxNum&&(this.baseNum=this.maxNum)},b.prototype.reset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.num=1},b.prototype.depthReset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.baseNum=0,this.num=1},b}(BaseAnim),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ScaleNoise=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.coreCalculate=function(){this.num=this.amplitude+this.amplitude*Math.sin(this.speed*this.time)},Object.defineProperty(b.prototype,"data",{set:function(a){this.beginTime=Number(a[0].value),-1==Number(a[1].value)?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=Number(a[1].value),this.amplitude=Number(a[2].value),this.speed=.01*Number(a[3].value)},enumerable:!0,configurable:!0}),b.prototype.dataByte=function(a,b){this.beginTime=b[0],-1==b[1]?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=b[1],this.amplitude=b[2],this.speed=.01*b[3]},b.prototype.getAllNum=function(a){this.baseNum=this.amplitude+this.amplitude*Math.sin(this.speed*a)},b}(BaseAnim),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SelfRotation=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),Object.defineProperty(b.prototype,"data",{set:function(a){this.beginTime=Number(a[0].value),-1==Number(a[1].value)?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=Number(a[1].value),this.speed=.1*Number(a[2].value),this.aSpeed=.1*Number(a[3].value)},enumerable:!0,configurable:!0}),b.prototype.dataByte=function(a,b){this.beginTime=b[0],-1==b[1]?this.lastTime=Scene_data.MAX_NUMBER:this.lastTime=b[1],this.speed=.1*b[2],this.aSpeed=.1*b[3]},b}(BaseAnim),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),InteractiveEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.Down="down",b.Up="Up",b.Move="Move",b.PinchStart="PinchStart",b.Pinch="Pinch",b}(BaseEvent),TextAlign=function(){function a(){}return a.LEFT="left",a.CENTER="center",a.RIGHT="right",a.TOP="top",a.MIDDLE="middle",a.BOTTOM="bottom",a}(),UIAtlas=function(){function a(){this._hasDispose=!1}return Object.defineProperty(a.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),a.prototype.setInfo=function(a,b,c,d){var e=this;void 0===d&&(d=null),this._useImgUrl=d,LoadManager.getInstance().load(Scene_data.fileRoot+a,LoadManager.XML_TYPE,function(a){var d=JSON.parse(a);e.configData=d.uiArr,e.layoutData=d.panelArr,e.loadImgUrl(b,c)})},a.prototype.loadConfig=function(a,b){var c=this;LoadManager.getInstance().load(Scene_data.fileRoot+a,LoadManager.XML_TYPE,function(a){var d=JSON.parse(a);c.configData=d.uiArr,b()})},a.prototype.loadImgUrl=function(a,b){var c=this;TextureManager.getInstance().getTexture(Scene_data.fileRoot+a,function(a){c.textureRes=a,c._useImgUrl?c.loadUseImg(b):b()},1,null,0)},a.prototype.loadUseImg=function(a){this.useImg=new Image,this.useImg.onload=function(){a()},this.useImg.src=Scene_data.fileRoot+this._useImgUrl},a.prototype.getRec=function(a){for(var b=new UIRectangle,c=0;c<this.configData.length;c++)if(this.configData[c].name==a){b.x=this.configData[c].x,b.y=this.configData[c].y,b.width=this.configData[c].width,b.height=this.configData[c].height,b.pixelWitdh=this.configData[c].ow,b.pixelHeight=this.configData[c].oh,b.pixelX=this.configData[c].ox,b.pixelY=this.configData[c].oy,b.type=this.configData[c].type,b.cellX=this.configData[c].cellX,b.cellY=this.configData[c].cellY;break}return b},a.prototype.getLayoutData=function(a){if(!this.layoutData)return null;for(var b in this.layoutData)for(var c=this.layoutData[b].item,d=0;d<c.length;d++)if(c[d].name==a)return c[d]},a.prototype.getGridRec=function(a){for(var b=new UIGridRentangle,c=0;c<this.configData.length;c++)if(this.configData[c].name==a){b.x=this.configData[c].x,b.y=this.configData[c].y,b.width=this.configData[c].width,b.height=this.configData[c].height,b.pixelWitdh=this.configData[c].ow,b.pixelHeight=this.configData[c].oh,b.pixelX=this.configData[c].ox,b.pixelY=this.configData[c].oy,b.ogw=this.configData[c].uow,b.ogh=this.configData[c].uoh;break}return b},Object.defineProperty(a.prototype,"hasData",{get:function(){return this.configData},enumerable:!0,configurable:!0}),a.prototype.getObject=function(a,b,c,d,e,f,g,h,i){void 0===h&&(h=0),void 0===i&&(i=0);var j=new Object;return j.x=b/f,j.y=c/g,j.width=d/f,j.height=e/g,j.ow=d,j.oh=e,j.ox=b,j.oy=c,j.name=a,j.cellX=h,j.cellY=i,j},a.prototype.updateCtx=function(a,b,c){TextureManager.getInstance().updateTexture(this.texture,b,c,a)},a.prototype.upDataPicToTexture=function(a,b){var c=this;LoadManager.getInstance().load(Scene_data.fileRoot+a,LoadManager.IMG_TYPE,function(a){var d=c.getRec(b);c.ctx=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1),c.ctx.drawImage(a,0,0,d.pixelWitdh,d.pixelHeight),TextureManager.getInstance().updateTexture(c.texture,d.pixelX,d.pixelY,c.ctx)})},a.prototype.clearCtxTextureBySkilname=function(a){var b=this.getRec(a);this.ctx=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1),this.ctx.clearRect(0,0,b.pixelWitdh,b.pixelHeight),TextureManager.getInstance().updateTexture(this.texture,b.pixelX,b.pixelY,this.ctx)},a.prototype.copyPicToTexture=function(a,b){var c=this.getRec(a),d=this.getRec(b);this.ctx=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1),this.ctx.drawImage(this.useImg,c.pixelX,c.pixelY,c.pixelWitdh,c.pixelWitdh,0,0,d.pixelWitdh,d.pixelWitdh),TextureManager.getInstance().updateTexture(this.texture,d.pixelX,d.pixelY,this.ctx)},a.prototype.updateLable=function(a,b,c,d,e,f,g,h){void 0===e&&(e=TextAlign.MIDDLE),void 0===f&&(f=TextAlign.CENTER),void 0===g&&(g=!1),void 0===h&&(h=0);var i=this.getRec(a);this.ctx=this.getTextCtx(i,c,d,g,e,f);var j=this.getTextxpos(f,this.ctx),k=this.getTextypos(e,this.ctx);h>0?this.wrapText(this.ctx,b,j,k,h,c+3):this.ctx.fillText(b,j,k),TextureManager.getInstance().updateTexture(this.texture,i.pixelX,i.pixelY,this.ctx)},a.prototype.updateArtNum=function(a,b,c){var d=String(c),e=this.getRec(a),f=this.getRec(b);this.ctx=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);for(var g=f.pixelWitdh/10,h=0;h<d.length;h++){var i=Number(d.charAt(h));this.ctx.drawImage(this.useImg,f.pixelX+i*g,f.pixelY,g,f.pixelHeight,h*g,0,g,f.pixelHeight)}TextureManager.getInstance().updateTexture(this.texture,e.pixelX,e.pixelY,this.ctx)},a.prototype.writeSingleLabel=function(a,b,c,d,e){void 0===c&&(c=12),void 0===d&&(d=TextAlign.CENTER),void 0===e&&(e="#ffffff"),LabelTextFont.writeSingleLabel(this,a,b,c,d,e)},a.prototype.writeSingleLabelToCxt=function(a,b,c,d,e){void 0===c&&(c=12),void 0===d&&(d=0),void 0===e&&(e=0),a.textBaseline=TextAlign.TOP,a.textAlign=TextAlign.LEFT,a.font="bolder  "+c+"px "+UIData.font,TextRegExp.wrapText(a,b,"#ffffff",d,e,9999,20)},a.prototype.updateLableCtx=function(a,b,c,d,e,f,g,h,i,j){void 0===f&&(f=TextAlign.CENTER),void 0===g&&(g=TextAlign.MIDDLE),void 0===h&&(h="#000000"),void 0===i&&(i="bolder"),void 0===j&&(j=0),a.textAlign=f,a.textBaseline=g,a.fillStyle=h,a.font=i+" "+e+"px "+UIData.font;var k=this.getTextxpos(f,a);j>0?this.wrapText(a,b,c,d,j,e+3):a.fillText(b,c+k,d)},a.prototype.getTextCtx=function(a,b,c,d,e,f){var g=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1);return g.textBaseline=e,g.textAlign=f,g.fillStyle=c,g.font=(d?"bolder ":"")+" "+b+"px "+UIData.font,g},a.prototype.getTextxpos=function(a,b){var c=0;return a==TextAlign.LEFT?c=0:a==TextAlign.RIGHT?c=b.canvas.width:a==TextAlign.CENTER&&(c=b.canvas.width/2),c},a.prototype.getTextypos=function(a,b){var c=0;return a==TextAlign.BOTTOM?c=b.canvas.height:a==TextAlign.TOP?c=0:a==TextAlign.MIDDLE&&(c=b.canvas.height/2),c},a.prototype.wrapText=function(a,b,c,d,e,f){for(var g=b,h="",i=0;i<g.length;i++)if("\n"==g[i])a.fillText(h,c,d),h="",d+=f;else{var j=h+g[i]+" ",k=a.measureText(j),l=k.width;l>e?(a.fillText(h,c,d),h=g[i]+"",d+=f):h=j}a.fillText(h,c,d)},a.prototype.dispose=function(){this._hasDispose||(this.textureRes.clearUseNum(),this.configData=null,this.layoutData=null,this.useImg=null,this._hasDispose=!0)},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIRectangle=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.pixelWitdh=1,b.pixelHeight=1,b.pixelX=0,b.pixelY=0,b.cellX=0,b.cellY=0,b.type=0,b}return __extends(b,a),b}(Rectangle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIGridRentangle=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.ogw=0,b.ogh=0,b}return __extends(b,a),b}(UIRectangle),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UICompenent=function(a){function b(){var b=a.call(this)||this;return b._x=0,b._y=0,b._width=0,b._height=0,b.z=0,b.absoluteX=0,b.absoluteY=0,b.absoluteWidth=0,b.absoluteHeight=0,b.enable=!0,b._left=0,b._right=0,b._center=0,b._xType=-1,b._top=0,b._bottom=0,b._middle=0,b._yType=-1,b.renderX=0,b.renderY=0,b.renderWidth=0,b.renderHeight=0,b.scale=1,b.isVirtual=!1,b.vcId=0,b._uvScale=1,b._rendering=!1,b.isU=!1,b.isV=!1,b.tr=new Rectangle,b.mouseEnable=!0,b}return __extends(b,a),Object.defineProperty(b.prototype,"rendering",{get:function(){return this._rendering},set:function(a){this._rendering=a},enumerable:!0,configurable:!0}),b.prototype.addStage=function(){this.renderData=[0,0,0,0],this.renderData2=[1,1,0,0],this.applyAbsolutePoint(),this.uiRender.addRenderUI(this)},b.prototype.removeStage=function(){this.uiRender.removeRenderUI(this)},b.prototype.pushVaData=function(a,b,c){return a.vertices.push(0,0,0,1,0,0,1,-1,0,0,-1,0),a.uvs.push(this.isU?1:0,this.isV?1:0,b,this.isU?0:1,this.isV?1:0,b,this.isU?0:1,this.isV?0:1,b,this.isU?1:0,this.isV?0:1,b),a.indexs.push(c,1+c,2+c,c,2+c,3+c),c+4},b.prototype.setVc=function(a,b){Scene_data.context3D.setVc4fv(a,"ui["+b+"]",this.renderData),Scene_data.context3D.setVc4fv(a,"ui2["+b+"]",this.renderData2)},b.prototype.update=function(){},b.prototype.applyRenderSize=function(){if(this.parent){if(this.renderX=this.absoluteX/Scene_data.stageWidth,this.renderY=this.absoluteY/Scene_data.stageHeight,this.renderWidth=this.absoluteWidth/Scene_data.stageWidth,this.renderHeight=this.absoluteHeight/Scene_data.stageHeight,this._uvScale>=0)this.renderData[0]=this.renderX,this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this.scale*this._uvScale,this.renderData[3]=this.renderHeight*this.scale,this.renderData2[0]=this.tr.width*this._uvScale,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x,this.renderData2[3]=this.tr.y;else{var a=Math.abs(this._uvScale);this.renderData[0]=this.renderX+this.renderWidth*(1-a),this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this.scale*a,this.renderData[3]=this.renderHeight*this.scale,this.renderData2[0]=this.tr.width*a,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x+this.tr.width*(1-a),this.renderData2[3]=this.tr.y}this.uiRender.makeRenderDataVc(this.vcId)}},Object.defineProperty(b.prototype,"uvScale",{get:function(){return this._uvScale},set:function(a){this._uvScale=a,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),b.prototype.setScale=function(a){this.scale=a,this.applyAbsolutePoint()},b.prototype.applyAbsolutePoint=function(){this.parent&&(-1==this._xType?this.absoluteX=this._x*UIData.Scale*this.scale+this.parent.x:0==this._xType?this.absoluteX=this._left*UIData.Scale:1==this._xType?this.absoluteX=Scene_data.stageWidth-this._right*UIData.Scale-this.width*UIData.Scale:2==this._xType&&(this.absoluteX=this._center*UIData.Scale+Scene_data.stageWidth/2-this.width*UIData.Scale/2),-1==this._yType?this.absoluteY=this._y*UIData.Scale*this.scale+this.parent.y:0==this._yType?this.absoluteY=this._top*UIData.Scale:1==this._yType?this.absoluteY=Scene_data.stageHeight-this._bottom*UIData.Scale-this.height*UIData.Scale:2==this._yType&&(this.absoluteY=this._middle*UIData.Scale+Scene_data.stageHeight/2-this.height*UIData.Scale/2),this.absoluteWidth=this.width*UIData.Scale,this.absoluteHeight=this.height*UIData.Scale,this.applyRenderSize())},Object.defineProperty(b.prototype,"x",{get:function(){return this._x},set:function(a){a!=this._x&&(this._x=a,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this._y},set:function(a){a!=this._y&&(this._y=a,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"width",{get:function(){return this._width},set:function(a){a!=this._width&&(this._width=a,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this._height},set:function(a){a!=this._height&&(this._height=a,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"left",{set:function(a){this._left=a,this._xType=0,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"right",{set:function(a){this._right=a,this._xType=1,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"center",{set:function(a){this._center=a,this._xType=2,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"top",{set:function(a){this._top=a,this._yType=0,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"bottom",{set:function(a){this._bottom=a,this._yType=1,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"middle",{set:function(a){this._middle=a,this._yType=2,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),b.prototype.testPoint=function(a,b){return a>this.absoluteX&&a<this.absoluteX+this.absoluteWidth&&b>this.absoluteY&&b<this.absoluteY+this.absoluteHeight?!0:!1},b.prototype.setPos=function(a,b){this.x=a,this.y=b},b.prototype.interactiveEvent=function(a){if(!this.enable)return!1;var b=(a.type,this._eventsMap);if(!b)return!1;var c=b[a.type];if(!c)return!1;if(!this.testPoint(a.x,a.y))return!1;var d=c.length;if(0==d)return!1;a.target=this;for(var e=d-1;e>=0;e--){var f=c[e];console.log("uiname",this.name),f.listener.call(f.thisObject,a)}return!0},b.prototype.preShow=function(){this.preParent&&this.preParent.addChild(this)},b.prototype.preHide=function(){this.preParent&&this.preParent.removeChild(this)},b}(EventDispatcher),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIConatiner=function(){function a(){this._x=0,this._y=0,this._width=0,this._height=0,this._left=0,this._right=0,this._center=0,this._xType=0,this._top=0,this._bottom=0,this._middle=0,this._yType=0,this._list=new Array,this.renderList=new Array,this._hasStage=!1,this._hasLoad=!1,this._isLoading=!1,this._needShowLoading=!0,this._interfaceUI=!1,this._layer=100}return Object.defineProperty(a.prototype,"layer",{get:function(){return this._layer},set:function(a){this._layer=a;for(var b=0;b<this.renderList.length;b++)this.renderList[b].sortnum=this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"interfaceUI",{get:function(){return this._interfaceUI},set:function(a){a?this.layer=0:this.layer=100},enumerable:!0,configurable:!0}),a.prototype.load=function(a,b){void 0===b&&(b=!0),this._isLoading||(this._completeFun=a,this._needShowLoading=b,this._hasLoad?a():(this._isLoading=!0,this._needShowLoading&&UILoading.getInstance().show(),this.makeBaseWinUi()))},Object.defineProperty(a.prototype,"hasLoad",{get:function(){return this._hasLoad},enumerable:!0,configurable:!0}),a.prototype.makeBaseWinUi=function(){this.applyLoad()},a.prototype.applyLoad=function(){},a.prototype.applyLoadComplete=function(){this._isLoading=!1,this._completeFun(),this._needShowLoading&&UILoading.getInstance().hide(),this._hasLoad=!0},Object.defineProperty(a.prototype,"hasStage",{get:function(){return this._hasStage},set:function(a){this._hasStage=a,a?this.onAdd():this.onRemove()},enumerable:!0,configurable:!0}),a.prototype.setUiListVisibleByItem=function(a,b){try{for(var c=0;c<a.length;c++)b?a[c].parent||this.addChild(a[c]):a[c].parent&&this.removeChild(a[c])}catch(d){console.log("在此处理错误3")}},a.prototype.onAdd=function(){},a.prototype.onRemove=function(){},a.prototype.addChild=function(a){if(!a)throw console.log("ui cuo "),new Error("ui cuo");if(!a.parent)return this._list.push(a),a.parent=this,a.addStage(),a},a.prototype.addVirtualContainer=function(a){this.virtualContainerList||(this.virtualContainerList=new Array),a.parent=this,this.virtualContainerList.push(a)},a.prototype.removeVirtualContainer=function(a){},a.prototype.addUIList=function(a,b){for(var c=new Array,d=0;d<a.length;d++){var e=b.getComponent(a[d]);this.addChild(e),c.push(e)}return c},a.prototype.getUIList=function(a,b){for(var c=new Array,d=0;d<a.length;d++){var e=b.getComponent(a[d]);c.push(e)}return c},a.prototype.addEvntBut=function(a,b){var c=this.addChild(b.getComponent(a));return c.addEventListener(InteractiveEvent.Down,this.butClik,this),c},a.prototype.addEvntButUp=function(a,b){var c=this.addChild(b.getComponent(a));return c.addEventListener(InteractiveEvent.Up,this.butClik,this),c},a.prototype.removeEvntBut=function(a){a.removeEventListener(InteractiveEvent.Down,this.butClik,this),this.removeChild(a)},a.prototype.butClik=function(a){},a.prototype.renderSetVisibel=function(a,b){for(var c=0;c<a.length;c++)b?a[c].rendering||this.addRender(a[c]):a[c].rendering&&this.removeRender(a[c])},a.prototype.removeChild=function(a){var b=this._list.indexOf(a);-1!=b&&(this._list.splice(b,1),a.parent=null,a.removeStage())},a.prototype.removeAll=function(){for(;this._list.length;)this.removeChild(this._list[0]);for(;this._maskList.length;)this.removeMaks(this._maskList[0])},a.prototype.addMask=function(a){this._maskList||(this._maskList=new Array),a.parent=this,a.applyAbsolutePoint(),this._maskList.push(a)},a.prototype.removeMaks=function(a){if(this._maskList){var b=this._maskList.indexOf(a);-1!=b&&this._maskList.splice(b,1)}},a.prototype.addRender=function(a){var b=this.renderList.indexOf(a);-1==b&&(a.container=this,a.sortnum=this._layer,this.renderList.push(a),this.hasStage&&UIManager.getInstance().addUI(a))},a.prototype.addRenderAt=function(a,b){var c=this.renderList.indexOf(a);-1==c&&(a.container=this,a.sortnum=this._layer,this.renderList.splice(b,0,a),this.hasStage&&UIManager.getInstance().addUI(a))},a.prototype.removeRender=function(a){var b=this.renderList.indexOf(a);-1!=b&&(this.renderList.splice(b,1),this.hasStage&&UIManager.getInstance().removeUI(a))},a.prototype.resize=function(){0==this._xType?this._x=this._left*UIData.Scale:1==this._xType?this._x=Scene_data.stageWidth-this._right*UIData.Scale-this.width*UIData.Scale:2==this._xType&&(this._x=this._center*UIData.Scale+Scene_data.stageWidth/2-this.width*UIData.Scale/2),0==this._yType?this._y=this._top*UIData.Scale:1==this._yType?this._y=Scene_data.stageHeight-this._bottom*UIData.Scale-this.height*UIData.Scale:2==this._yType&&(this._y=this._middle*UIData.Scale+Scene_data.stageHeight/2-this.height*UIData.Scale/2),this.applyChild(),this.resizeVirtualList()},a.prototype.resizeVirtualList=function(){if(this.virtualContainerList)for(var a=0;a<this.virtualContainerList.length;a++)this.virtualContainerList[a].resize()},Object.defineProperty(a.prototype,"left",{get:function(){return this._left},set:function(a){this._left=a,this._xType=0,this._x=this._left*UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this._right},set:function(a){this._right=a,this._xType=1,this._x=Scene_data.stageWidth-this._right*UIData.Scale-this.width*UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"center",{set:function(a){this._center=a,this._xType=2,this._x=this._center*UIData.Scale+Scene_data.stageWidth/2-this.width*UIData.Scale/2,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._top},set:function(a){this._top=a,this._yType=0,this._y=this._top*UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this._bottom},set:function(a){this._bottom=a,this._yType=1,this._y=Scene_data.stageHeight-this._bottom*UIData.Scale-this.height*UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"middle",{set:function(a){this._middle=a,this._yType=2,this._y=this._middle*UIData.Scale+Scene_data.stageHeight/2-this.height*UIData.Scale/2,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){if(0!=this._width)return this._width;for(var a=0,b=0;b<this._list.length;b++)a=Math.max(this._list[b].width);return a},set:function(a){this._width=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){if(0!=this._height)return this._height;for(var a=0,b=0;b<this._list.length;b++)a=Math.max(this._list[b].height);return a},set:function(a){this._height=a},enumerable:!0,configurable:!0}),a.prototype.applyChild=function(){for(var a=0;a<this._list.length;a++)this._list[a].applyAbsolutePoint();if(this._maskList)for(var a=0;a<this._maskList.length;a++)this._maskList[a].applyAbsolutePoint()},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){
console.log("忘了重写disposepanel")},a.prototype.setSizeForPanelUiCopy=function(a,b,c){var d=c.getComponent(b);a.x=d.x,a.y=d.y,a.width=d.width,a.height=d.height},a}(),Dis2DUIContianerBase=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.update=function(a){},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIVirtualContainer=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.visible=!0,b}return __extends(b,a),b}(UIConatiner),UIData=function(){function a(){}return a.setDesignWH=function(a,b){this.designWidth=a,this.designHeight=b,this.resize()},a.resize=function(){this.Scale=Math.min(Scene_data.stageWidth/this.designWidth,Scene_data.stageHeight/this.designHeight)},a.init=function(a,b,c){return void 0===c&&(c=null),this._itemLoad=a,this._bFun=b,this.loadFun=c,this.loadBaseConfigCom(),a.length},Object.defineProperty(a,"mainUIAtlas",{get:function(){return null},enumerable:!0,configurable:!0}),a.loadBaseConfigCom=function(){for(var a=0;a<this._itemLoad.length;a++)this.loadUIdata(this._itemLoad[a].xmlurl,this._itemLoad[a].picurl,this._itemLoad[a].name)},a.loadOkNum=function(a){this.loadFun&&this.loadFun(a)},a.loadUIdata=function(b,c,d){var e=this;void 0===d&&(d="default"),LoadManager.getInstance().load(Scene_data.fileRoot+b,LoadManager.XML_TYPE,function(a){var b=Array(JSON.parse(a))[0];e._dic[d]=b,f.src=Scene_data.fileRoot+c});var f=new Image;this._imgDic[d]=f,f.onload=function(b){e._skipnum++,e.loadOkNum(e._skipnum),e._skipnum>=e._itemLoad.length&&(a.textImg=e._imgDic[a.textlist],e._bFun())}},a.getImgByKey=function(a){return this._imgDic.containsKey(a)?this._imgDic[a]:(console.log("uiData getImgByKey=>"+a),null)},a.getUiByName=function(a,b){if(this._dic.containsKey(a))for(var c=this._dic[a].uiArr,d=0;d<c.length;d++)if(c[d].name==b)return c[d];return console.log("uiData getUiByName =>"+b),null},a.getUiArrByKey=function(a){return this._dic.containsKey(a)?this._dic[a].uiArr:null},a.designWidth=960,a.designHeight=540,a.font="Helvetica",a._skipnum=0,a.textlist="textlist",a.publicUi="publicUi",a.faceItem=["/大笑","/脸2","/脸3","/脸4","/脸5","/脸6","/脸7","/脸8","/脸9","/脸a","/脸b","/脸c","/脸d","/脸e","/脸f","/脸g","/脸h","/脸i"],a._dic=new Dictionary([]),a._imgDic=new Dictionary([]),a}(),UiDraw=function(){function a(){}return a.drawUseImg=function(a,b,c){var d=a.uiRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1),f=b.getRec(c);e.drawImage(b.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight),a.uiRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)},a.clearUI=function(a){var b=a.uiRender.uiAtlas.getRec(a.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);a.uiRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},a.drawTxtLab=function(b,c,d,e,f,g){void 0===f&&(f=0),void 0===g&&(g=3);var h=b.uiRender.uiAtlas.getRec(b.skinName),i=UIManager.getInstance().getContext2D(h.pixelWitdh,h.pixelHeight,!1);a.cxtDrawImg(i,PuiData.TXTBG,new Rectangle(0,0,h.pixelWitdh,h.pixelHeight),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(i,c,d,f,g,e),b.uiRender.uiAtlas.updateCtx(i,h.pixelX,h.pixelY)},a.drawAttVal=function(b,c,d,e,f){void 0===e&&(e=TextAlign.LEFT),void 0===f&&(f=!1);var g="";return"undefined"==typeof c?void a.clearUI(b):(g=ColorType.Orange7a2f21+getKeyProById(c)+":  "+ColorType.Orange9a683f+Snum(Math.floor(d/100)),f&&(g=ColorType.Orange7a2f21+getKeyProById(c)+":  "+ColorType.Orange9a683f+"+"+Snum(Math.floor(d/100))),void LabelTextFont.writeSingleLabel(b.uiRender.uiAtlas,b.skinName,g,14,e))},a.drawAttValAdd=function(b,c,d){var e="";return"undefined"==typeof c?void a.clearUI(b):(e=ColorType.Orange7a2f21+getKeyProById(c)+":    "+ColorType.Green2ca937+"+"+Snum(Math.floor(d/100)),void LabelTextFont.writeSingleLabel(b.uiRender.uiAtlas,b.skinName,e,14,TextAlign.LEFT))},a.drawAddValTop=function(b,c){var d="";d=c>0?"+"+Snum(Math.floor(c/100)):"+0";var e=b.uiRender.uiAtlas.getRec(b.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);""!=d&&a.cxtDrawImg(f,PuiData.ARROW_TOP,new Rectangle(0,3,12,16),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(f,d,14,15,0,TextAlign.LEFT,ColorType.Green2ca937),b.uiRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)},a.drawAddValRight=function(b,c,d,e){if(void 0===d&&(d=!1),void 0===e&&(e=TextAlign.RIGHT),c>=0){var f=b.uiRender.uiAtlas.getRec(b.skinName),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);a.cxtDrawImg(g,PuiData.ARROW_RIGHT,new Rectangle(0,3,16,12),UIData.publicUi);var h=Snum(Math.floor(c/100));d&&(h="+"+h);var i=0;e==TextAlign.LEFT&&(i=22),console.log("-----addStr----",h,i),LabelTextFont.writeSingleLabelToCtx(g,h,14,i,0,e,ColorType.Green2ca937),b.uiRender.uiAtlas.updateCtx(g,f.pixelX,f.pixelY)}else a.clearUI(b)},a.drawResHasNumAndAllNum=function(a,b,c){void 0===c&&(c="");var d,e,f=tb.TB_item_template.get_TB_item_template(b[0]);return f.money_type&&f.money_type>0?GuidData.player.getResType(f.money_type)>=b[1]?(d=ColorType.Green2ca937+Snum(b[1]),e=!0):(e=!1,d=ColorType.colorce0a00+Snum(b[1])):GuidData.bag.hasItem(b[0],b[1])?(d=ColorType.Green2ca937+GuidData.bag.getItemCount(b[0])+ColorType.Brown7a2f21+"/"+b[1],e=!0):(e=!1,d=ColorType.colorce0a00+GuidData.bag.getItemCount(b[0])+ColorType.Brown7a2f21+"/"+b[1]),LabelTextFont.writeSingleLabel(a.uiRender.uiAtlas,a.skinName,c+d,14,TextAlign.CENTER),e},a.drawCost=function(b,c,d,e){a.cxtDrawImg(b,UIuitl.getInstance().costtype(e),new Rectangle(c,d,35,35),UIData.publicUi)},a.drawRewardIconAndtxt=function(b,c,d,e,f){void 0===e&&(e=TextAlign.LEFT),void 0===f&&(f=25);var g=b.uiRender.uiAtlas.getRec(b.skinName),h=UIManager.getInstance().getContext2D(g.pixelWitdh,g.pixelHeight,!1),i=0,j=14,k=TextRegExp.getTextMetrics(h,String(c[1]));e==TextAlign.RIGHT?i=g.pixelWitdh-k.width-f-35:e==TextAlign.CENTER&&(i=g.pixelWitdh/2-(k.width+f+35)/2);var l=ColorType.colorce0a00,m=!1;return d&&hasEnoughRes(c)&&(m=!0,l=ColorType.Green20a200),a.cxtDrawImg(h,UIuitl.getInstance().costtype(c[0]),new Rectangle(i,0,35,35),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(h,String(c[1]),16,i+35+f,j,TextAlign.LEFT,d?l:ColorType.Brown7a2f21),b.uiRender.uiAtlas.updateCtx(h,g.pixelX,g.pixelY),m},a.cxtDrawImg=function(a,b,c,d){var e=UIData.getUiByName(d,b);e&&((0==c.width||0==c.height)&&(c.width=e.ow,c.height=e.oh),0==e.type?a.drawImage(UIData.getImgByKey(d),e.ox,e.oy,e.ow,e.oh,c.x,c.y,c.width,c.height):1==e.type?(a.drawImage(UIData.getImgByKey(d),e.ox,e.oy,e.uow,e.uoh,c.x,c.y,e.uow,e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox+e.uow,e.oy,e.ow-2*e.uow,e.uoh,c.x+e.uow,c.y,c.width-2*e.uow,e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox+e.ow-e.uow,e.oy,e.uow,e.uoh,c.x+c.width-e.uow,c.y,e.uow,e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox,e.oy+e.uoh,e.uow,e.oh-2*e.uoh,c.x,c.y+e.uoh,e.uow,c.height-2*e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox+e.uow,e.oy+e.uoh,e.ow-2*e.uow,e.oh-2*e.uoh,c.x+e.uow,c.y+e.uoh,c.width-2*e.uow,c.height-2*e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox+e.ow-e.uow,e.oy+e.uoh,e.uow,e.uoh,c.x+c.width-e.uow,c.y+e.uoh,e.uow,c.height-2*e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox,e.oy+e.oh-e.uoh,e.uow,e.uoh,c.x,c.y+c.height-e.uoh,e.uow,e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox+e.uow,e.oy+e.oh-e.uoh,e.ow-2*e.uow,e.uoh,c.x+e.uow,c.y+c.height-e.uoh,c.width-2*e.uow,e.uoh),a.drawImage(UIData.getImgByKey(d),e.ox+e.ow-e.uow,e.oy+e.oh-e.uoh,e.uow,e.uoh,c.x+c.width-e.uow,c.y+c.height-e.uoh,e.uow,e.uoh)):alert("UiDraw没有绘制成功  "+e.type))},a.uiAtlasDrawImg=function(a,b,c,d){var e=a.getRec(b);a.ctx=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);var f=UIData.getUiByName(c,d);f?(0==f.type?a.ctx.drawImage(UIData.getImgByKey(c),f.ox,f.oy,f.ow,f.oh,0,0,e.pixelWitdh,e.pixelHeight):1==f.type?(a.ctx.drawImage(UIData.getImgByKey(c),f.ox,f.oy,f.uow,f.uoh,0,0,f.uow,f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox+f.uow,f.oy,f.ow-2*f.uow,f.uoh,f.uow,0,e.pixelWitdh-2*f.uow,f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox+f.ow-f.uow,f.oy,f.uow,f.uoh,e.pixelWitdh-f.uow,0,f.uow,f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox,f.oy+f.uoh,f.uow,f.oh-2*f.uoh,0,f.uoh,f.uow,e.pixelHeight-2*f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox+f.uow,f.oy+f.uoh,f.ow-2*f.uow,f.oh-2*f.uoh,f.uow,f.uoh,e.pixelWitdh-2*f.uow,e.pixelHeight-2*f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox+f.ow-f.uow,f.oy+f.uoh,f.uow,f.uoh,e.pixelWitdh-f.uow,f.uoh,f.uow,e.pixelHeight-2*f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox,f.oy+f.oh-f.uoh,f.uow,f.uoh,0,e.pixelHeight-f.uoh,f.uow,f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox+f.uow,f.oy+f.oh-f.uoh,f.ow-2*f.uow,f.uoh,f.uow,e.pixelHeight-f.uoh,e.pixelWitdh-2*f.uow,f.uoh),a.ctx.drawImage(UIData.getImgByKey(c),f.ox+f.ow-f.uow,f.oy+f.oh-f.uoh,f.uow,f.uoh,e.pixelWitdh-f.uow,e.pixelHeight-f.uoh,f.uow,f.uoh)):console.log("11"),TextureManager.getInstance().updateTexture(a.texture,e.pixelX,e.pixelY,a.ctx)):alert("uiAtlasDrawImg错误")},a.SharedDrawImg=function(a,b,c,d,e,f,g){void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=!0);var h=a.getRec(c);a.ctx=UIManager.getInstance().getContext2D(h.pixelWitdh,h.pixelHeight,!1);var i=b.getRec(d),j=g?0:e,k=g?0:f,l=g?h.pixelWitdh:i.pixelWitdh,m=g?h.pixelHeight:i.pixelHeight;a.ctx.drawImage(b.useImg,i.pixelX,i.pixelY,i.pixelWitdh,i.pixelHeight,j,k,l,m),TextureManager.getInstance().updateTexture(a.texture,h.pixelX,h.pixelY,a.ctx)},a.drawToUiAtlasToCtx=function(a,b,c,d){var e=b.getRec(c);d||(d=new Rectangle(0,0,0,0)),d.width>1&&d.height>1?a.drawImage(b.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,d.x,d.y,d.width,d.height):a.drawImage(b.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,d.x,d.y,e.pixelWitdh,e.pixelHeight)},a.RepeatLoadImg=function(a,b,c){void 0===c&&(c=null);var d=new Image;d.onload=function(){LoadManager.getInstance().load(b,LoadManager.IMG_TYPE,function(a){c&&c(d,a)})},d.src=a},a}(),UIuitl=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.drawCostUI=function(a,b,c,d,e,f){void 0===d&&(d="#000000"),void 0===e&&(e=0),void 0===f&&(f=0),-1!=d.indexOf("[")&&(d="#"+d.substr(1,6));var g=a.getRec(b),h=UIManager.getInstance().getContext2D(g.pixelWitdh,g.pixelHeight,!1);0==e&&(e=g.pixelWitdh,f=g.pixelHeight),UiDraw.cxtDrawImg(h,PuiData.TXTBG,new Rectangle(g.pixelWitdh-e,g.pixelHeight-f-3,e,f+3),UIData.publicUi);var i,j;Number(c[0])>-1?(UiDraw.cxtDrawImg(h,this.costtype(Number(c[0])),new Rectangle(0,0,35,35),UIData.publicUi),i=(e-35)/2+35,j=f>=35?2:35-f):(i=e/2+(g.pixelWitdh-e),j=g.pixelHeight-f),LabelTextFont.writeSingleLabelToCtxSetAnchor(h,String(c[1]),16,i,j,TextAlign.CENTER,d),a.updateCtx(h,g.pixelX,g.pixelY)},a.prototype.costtype=function(a){switch(a){case 1:return PuiData.A_YUANBAO;case 2:return PuiData.A_BANGYUAN;case 3:return PuiData.A_YINBI;case 101:return PuiData.A_ZHENQI;case 102:return PuiData.A_SHOULING;case 103:return PuiData.A_JINGHUA;case 6:return PuiData.A_BANGGONG;case 7:return PuiData.A_HONOR;case 8:return PuiData.A_DOUHUN;case 9:return PuiData.A_DOUHUN;case 10:return PuiData.A_CARD_G;case 11:return PuiData.A_CARD_C;case 12:return PuiData.A_CARD_B;case 104:return PuiData.A_EXP}},a}(),UIRenderComponent=function(){function a(){this._rendering=!1,this.scale=1,this.sortnum=0,this.blenderMode=0,this.renderData=new Float32Array(0),this.renderData2=new Float32Array(0),this.num=0,this.visible=!0,this.initData()}return Object.defineProperty(a.prototype,"rendering",{get:function(){return this._rendering},set:function(a){if(this._rendering=a,this._uiList)for(var b=0;b<this._uiList.length;b++)this._uiList[b].rendering=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),a.prototype.initData=function(){this._uiList=new Array,this.objData=new ObjData,this.shader=ProgrmaManager.getInstance().getProgram(UIShader.UI_SHADER),this.program=this.shader.program,this.uiProLocation=Scene_data.context3D.getLocation(this.program,"ui"),this.ui2ProLocation=Scene_data.context3D.getLocation(this.program,"ui2")},a.prototype.resize=function(){},a.prototype.setImgUrl=function(a){var b=this;TextureManager.getInstance().getTexture(Scene_data.fileRoot+a,function(a){b.textureRes=a})},a.prototype.setInfo=function(a,b,c){this.uiAtlas=new UIAtlas,this.uiAtlas.setInfo(a,b,function(){c()})},a.prototype.setAtlas=function(a){this.uiAtlas=a},a.prototype.creatComponent=function(a,b,c,d){var e=new UICompenent;return e.tr.sets(a,b,c,d),e.uiRender=this,e},a.prototype.getComponent=function(a){var b=this.uiAtlas.getLayoutData(a);if(b){var c=b.type;if(0==c){var d=this.creatBaseComponent(b.dataItem[0]);return d.width=b.rect.width,d.height=b.rect.height,d.x=b.rect.x,d.y=b.rect.y,d.baseRec=b.rect,d.name=a,d}if(1==c){var e=this.creatGrid9Component(b.dataItem[0],b.rect.width,b.rect.height);return e.x=b.rect.x,e.y=b.rect.y,e.baseRec=b.rect,e.name=a,e}if(2==c){if(b.selected){var f=this.createSelectButton(b.dataItem[0],b.dataItem[1]);return f.width=b.rect.width,f.height=b.rect.height,f.x=b.rect.x,f.y=b.rect.y,f.baseRec=b.rect,f.name=a,f}var g=this.creatButton(b.dataItem[0],b.dataItem[1]);return g.width=b.rect.width,g.height=b.rect.height,g.x=b.rect.x,g.y=b.rect.y,g.baseRec=b.rect,g.name=a,g}if(4==c){var h=this.createFrame(b.dataItem[0]);return h.width=b.rect.width,h.height=b.rect.height,h.x=b.rect.x,h.y=b.rect.y,h.baseRec=b.rect,h.name=a,h}}return null},a.prototype.createFrame=function(a){var b=new FrameCompenent;b.skinName=a;var c=this.uiAtlas.getRec(a);return b.setFrameData(c),b.uiRender=this,b},a.prototype.creatBaseComponent=function(a){var b=new UICompenent;b.skinName=a;var c=this.uiAtlas.getRec(a);return b.tr.setRec(c),b.width=c.pixelWitdh,b.height=c.pixelHeight,b.uiRender=this,b},a.prototype.creatGrid9Component=function(a,b,c){var d=new Grid9Compenent;d.skinName=a;var e=this.uiAtlas.getGridRec(a);return d.tr.setRec(e),d.ogw=e.ogw,d.ogh=e.ogh,d.gw=d.ogw/e.pixelWitdh,d.gh=d.ogh/e.pixelHeight,d.width=b,d.height=c,d.uiRender=this,d},a.prototype.creatButton=function(a,b){if(!this.uiAtlas.hasData)return null;var c=new Button,d=this.uiAtlas.getRec(a);return c.tr.setRec(d),c.trDown.setRec(this.uiAtlas.getRec(b)),c.width=d.pixelWitdh,c.height=d.pixelHeight,c.uiRender=this,c},a.prototype.createSelectButton=function(a,b){if(!this.uiAtlas.hasData)return null;var c=new SelectButton,d=this.uiAtlas.getRec(a);return c.tr.setRec(d),c.trDown.setRec(this.uiAtlas.getRec(b)),c.width=d.pixelWitdh,c.height=d.pixelHeight,c.uiRender=this,c},a.prototype.addRenderUI=function(a){return this._uiList.length>=50?(console.log("UIRenderComponent超限制51"),void alert("UIRenderComponent超限制51")):(this._uiList.push(a),a.rendering=this.rendering,void this.applyObjData())},a.prototype.removeRenderUI=function(a){var b=this._uiList.indexOf(a);-1!=b&&this._uiList.splice(b,1),a.rendering=!1,this.applyObjData()},a.prototype.applyObjData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0,this.objData.indexs.length=0;for(var a=0,b=0;b<this._uiList.length;b++){var c=this._uiList[b];c.isVirtual||(a=c.pushVaData(this.objData,b,a))}this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer?(Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)),this.mask&&(this.mask.scale=this.scale,this.mask.applyAbsolutePoint()),this.makeRenderDataVc(-1)},a.prototype.makeRenderDataVc=function(a){if((!this.renderData||this.renderData&&this.renderData.length!=4*this._uiList.length)&&(this.renderData=new Float32Array(4*this._uiList.length),this.renderData2=new Float32Array(4*this._uiList.length)),-1==a)for(var b=0;this._uiList&&b<this._uiList.length;b++)this._uiList[b].vcId=b,this.renderData[4*b+0]=this._uiList[b].renderData[0],this.renderData[4*b+1]=this._uiList[b].renderData[1],this.renderData[4*b+2]=this._uiList[b].renderData[2],this.renderData[4*b+3]=this._uiList[b].renderData[3],this.renderData2[4*b+0]=this._uiList[b].renderData2[0],this.renderData2[4*b+1]=this._uiList[b].renderData2[1],this.renderData2[4*b+2]=this._uiList[b].renderData2[2],this.renderData2[4*b+3]=this._uiList[b].renderData2[3];else a<this._uiList.length&&(this.renderData[4*a+0]=this._uiList[a].renderData[0],this.renderData[4*a+1]=this._uiList[a].renderData[1],this.renderData[4*a+2]=this._uiList[a].renderData[2],this.renderData[4*a+3]=this._uiList[a].renderData[3],this.renderData2[4*a+0]=this._uiList[a].renderData2[0],this.renderData2[4*a+1]=this._uiList[a].renderData2[1],this.renderData2[4*a+2]=this._uiList[a].renderData2[2],this.renderData2[4*a+3]=this._uiList[a].renderData2[3])},a.prototype.update=function(){if(this.visible&&0!=this._uiList.length||this.modelRenderList&&this.modelRenderList.length){if(this.mask){var a=Scene_data.context3D.renderContext;a.enable(a.STENCIL_TEST),a.stencilMask(255),a.stencilFunc(a.NEVER,this.mask.level,255),a.stencilOp(a.REPLACE,a.REPLACE,a.REPLACE),this.mask.update(),a.stencilFunc(a.LESS,this.mask.level-1,255),a.stencilOp(a.KEEP,a.KEEP,a.KEEP)}if(Scene_data.context3D.setBlendParticleFactors(this.blenderMode),Scene_data.context3D.setProgram(this.program),this.setVc(),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),this.setTextureToGpu(),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum),this.mask&&Scene_data.context3D.renderContext.disable(Scene_data.context3D.renderContext.STENCIL_TEST),this.modelRenderList)for(var b=0;b<this.modelRenderList.length;b++)this.modelRenderList[b].update()}},a.prototype.setTextureToGpu=function(){this.uiAtlas?Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.uiAtlas.texture,0):Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0)},a.prototype.setVc=function(){for(var a=0;a<this._uiList.length;a++)this._uiList[a].update(),this._uiList[a].vcId!=a;Scene_data.context3D.setVc4fvLocation(this.uiProLocation,this.renderData),Scene_data.context3D.setVc4fvLocation(this.ui2ProLocation,this.renderData2)},a.prototype.addModel=function(a){this.modelRenderList||(this.modelRenderList=new Array);var b=this.modelRenderList.indexOf(a);-1==b&&this.modelRenderList.push(a)},a.prototype.removeModel=function(a){var b=this.modelRenderList.indexOf(a);-1!=b&&this.modelRenderList.splice(b,1)},a.prototype.interactiveEvent=function(a){if(this.mask&&!this.mask.testPoint(a.x,a.y))return!1;for(var b=!1,c=0;c<this._uiList.length;c++)if(this._uiList[c].interactiveEvent(a)&&UIManager.cando)return b=!0,UIManager.cando=!1,!0;return b},a.prototype.dispose=function(){this.objData.destory(),this.objData=null,this.uiAtlas&&(this.uiAtlas.dispose(),this.uiAtlas=null),this.mask&&(this.mask.dispose(),this.mask=null),this.renderData=null,this.renderData2=null},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIListRenderComponent=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.createList=function(){var a=new List;return a.uiRender=this,a},b.prototype.createGridList=function(){var a=new GridList;return a.uiRender=this,a},b}(UIRenderComponent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIBackImg=function(a){function b(){var b=a.call(this)||this;return b._scaleData=[1,1],b._isFBO=!1,b.alpha=1,b}return __extends(b,a),b.prototype.initData=function(){this.objData=new ObjData,this.shader=ProgrmaManager.getInstance().getProgram(UIImageShader.UI_IMG_SHADER),this.program=this.shader.program,this.objData.vertices.push(-1,1,0,1,1,0,1,-1,0,-1,-1,0),this.objData.uvs.push(0,0,1,0,1,1,0,1),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=6,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)},b.prototype.resize=function(){this.appleyPos()},b.prototype.setImgInfo=function(a,b,c){this.setImgUrl(a),this._width=b,this._height=c},b.prototype.appleyPos=function(){var a=this._width/Scene_data.stageWidth,b=this._height/Scene_data.stageHeight;b>a?(this._scaleData[0]=1,this._scaleData[1]=this._height/Scene_data.stageHeight/a):(this._scaleData[0]=this._width/Scene_data.stageWidth/b,this._scaleData[1]=1)},b.prototype.setFbo=function(){this._isFBO=!0},b.prototype.update=function(){var a=!1;this._isFBO?(Scene_data.fbo&&(a=!0),Scene_data.context3D.clearContext(),Scene_data.context3D.setDepthTest(!1)):this.texture&&(a=!0),this.objData&&a&&(Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),Scene_data.context3D.setVc2fv(this.shader,"scale",this._scaleData),this._isFBO?(Scene_data.context3D.setVc2fv(this.shader,"scale",[1,-1]),Scene_data.context3D.setRenderTexture(this.shader,"s_texture",Scene_data.fbo.texture,0)):Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),Scene_data.context3D.setVcFloat(this.shader,"alpha",[this.alpha]),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},b.prototype.interactiveEvent=function(a){return!0},b}(UIRenderComponent),UIRenderOnlyPicComponent=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.makeRenderDataVc=function(b){a.prototype.makeRenderDataVc.call(this,b);for(var c=0;c<this.renderData2.length/4;c++)this.renderData2[4*c+0]=1,this.renderData2[4*c+1]=1,this.renderData2[4*c+2]=0,this.renderData2[4*c+3]=0},b.prototype.update=function(){this.texture&&a.prototype.update.call(this)},b.prototype.setTextureToGpu=function(){Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0)},b.prototype.dispose=function(){a.prototype.dispose.call(this),this.textureRes&&this.textureRes.clearUseNum()},b}(UIRenderComponent),UIMask=function(){function a(){this._x=0,this._y=0,this._width=0,this._height=0,this.absoluteX=0,this.absoluteY=0,this.absoluteWidth=0,this.absoluteHeight=0,this.scale=1,this.level=2,this._hasDisposed=!1,this.initData(),this.renderData=[0,0,0,0]}return a.prototype.initData=function(){this.objData=new ObjData,this.shader=ProgrmaManager.getInstance().getProgram(UIMaskShader.UI_MASK_SHADER),this.program=this.shader.program,this.applyObjData()},a.prototype.applyAbsolutePoint=function(){this.parent&&(this.absoluteX=this._x*this.scale*UIData.Scale+this.parent.x,this.absoluteY=this._y*this.scale*UIData.Scale+this.parent.y,this.absoluteWidth=this._width*UIData.Scale*this.scale,this.absoluteHeight=this._height*UIData.Scale*this.scale,this.applyRenderSize())},a.prototype.testPoint=function(a,b){return a>this.absoluteX&&a<this.absoluteX+this.absoluteWidth&&b>this.absoluteY&&b<this.absoluteY+this.absoluteHeight?!0:!1},a.prototype.applyRenderSize=function(){this.parent&&(this.renderData[0]=this.absoluteX/Scene_data.stageWidth,this.renderData[1]=this.absoluteY/Scene_data.stageHeight,this.renderData[2]=this.absoluteWidth/Scene_data.stageWidth,this.renderData[3]=this.absoluteHeight/Scene_data.stageHeight)},a.prototype.applyObjData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0,this.objData.indexs.length=0,this.objData.vertices.push(0,0,0,1,0,0,1,-1,0,0,-1,0),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)},a.prototype.update=function(){Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVc4fv(this.shader,"ui",this.renderData),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this._width},set:function(a){this._width=a,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},set:function(a){this._height=a,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._hasDisposed||(this.objData.destory(),this.objData=null,this.program=null,this.shader=null,this.renderData=null,this.parent=null,this._hasDisposed=!0)},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BaseButton=function(a){function b(){var b=a.call(this)||this;return b.trDown=new Rectangle,b._state=0,b._currentState=0,b}return __extends(b,a),b.prototype.update=function(){this._currentState!=this._state&&(this.applyRenderSize(),this._currentState=this._state)},b.prototype.applyRenderSize=function(){a.prototype.applyRenderSize.call(this),0==this._state?(this.renderData2[0]=this.tr.width,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x,this.renderData2[3]=this.tr.y):1==this._state&&(this.renderData2[0]=this.trDown.width,this.renderData2[1]=this.trDown.height,this.renderData2[2]=this.trDown.x,this.renderData2[3]=this.trDown.y),this.uiRender.makeRenderDataVc(this.vcId)},b}(UICompenent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Button=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.interactiveEvent=function(b){return a.prototype.interactiveEvent.call(this,b)},b}(BaseButton),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SelectButton=function(a){function b(){var b=a.call(this)||this;return b._selected=!1,b}return __extends(b,a),Object.defineProperty(b.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this._selected?this._state=1:this._state=0},enumerable:!0,configurable:!0}),b.prototype.interactiveEvent=function(b){return this.enable?(b.type==InteractiveEvent.Down&&this.testPoint(b.x,b.y)&&(this._selected=!this._selected,this._selected?this._state=1:this._state=0),a.prototype.interactiveEvent.call(this,b)):!1},b}(BaseButton),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Grid9Compenent=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.pushVaData=function(a,b,c){for(var d=[0,0,0,this.ogw,0,0,this.width-this.ogw,0,0,this.width,0,0,0,-this.ogh,0,this.ogw,-this.ogh,0,this.width-this.ogw,-this.ogh,0,this.width,-this.ogh,0,0,this.ogh-this.height,0,this.ogw,this.ogh-this.height,0,this.width-this.ogw,this.ogh-this.height,0,this.width,this.ogh-this.height,0,0,-this.height,0,this.ogw,-this.height,0,this.width-this.ogw,-this.height,0,this.width,-this.height,0],e=0;e<d.length;e+=3)a.vertices.push(d[e]/this.width,d[e+1]/this.height,d[e+2]);a.uvs.push(0,0,b,this.gw,0,b,1-this.gw,0,b,1,0,b,0,this.gh,b,this.gw,this.gh,b,1-this.gw,this.gh,b,1,this.gh,b,0,1-this.gh,b,this.gw,1-this.gh,b,1-this.gw,1-this.gh,b,1,1-this.gh,b,0,1,b,this.gw,1,b,1-this.gw,1,b,1,1,b);for(var f=[0,1,5,0,5,4,1,2,6,1,6,5,2,3,7,2,7,6,4,5,9,4,9,8,5,6,10,5,10,9,6,7,11,6,11,10,8,9,13,8,13,12,9,10,14,9,14,13,10,11,15,10,15,14],e=0;e<f.length;e++)a.indexs.push(c+f[e]);return c+16},b}(UICompenent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),FrameCompenent=function(a){function b(){var b=a.call(this)||this;return b.isTrue=!1,b.current=0,b.totalcurrent=0,b.speed=6,b.endFlag=!1,b.stopStatic=0,b.speedNum=0,b}return __extends(b,a),b.prototype.setFrameData=function(a){this._frameData=a,this.totalcurrent=this._frameData.cellX*this._frameData.cellY},b.prototype.applyRenderSize=function(){if(this.parent){this.renderX=this.absoluteX/Scene_data.stageWidth,this.renderY=this.absoluteY/Scene_data.stageHeight,this.renderWidth=this.absoluteWidth/Scene_data.stageWidth,this.renderHeight=this.absoluteHeight/Scene_data.stageHeight,this.renderData[0]=this.renderX,this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this._uvScale,this.renderData[3]=this.renderHeight;var a=this._frameData.cellX,b=this._frameData.cellY,c=this._frameData.width/a,d=this._frameData.height/b,e=new Rectangle(0,0,c,d),f=this.current%(a*b);e.x=f%a*c,e.y=float2int(f/a)*d,this.renderData2[0]=e.width*this._uvScale,this.renderData2[1]=e.height,this.renderData2[2]=e.x+this._frameData.x,this.renderData2[3]=e.y+this._frameData.y,this.uiRender.makeRenderDataVc(this.vcId)}},b.prototype.getSkinCtxRect=function(){var a=this._frameData,b=new Rectangle;return b.width=a.pixelWitdh/a.cellX,b.height=a.pixelHeight/a.cellY,b.x=this.current%a.cellX*b.width,b.y=Math.floor(this.current/a.cellX)*b.height,b},b.prototype.drawToCtx=function(a,b){var c=this._frameData,d=this.getSkinCtxRect();a.updateCtx(b,c.pixelX+d.x,c.pixelY+d.y)},b.prototype.update=function(){if(this._frameData&&2!=this.stopStatic){this.applyRenderSize(),this.speedNum++,this.speedNum>this.speed&&(this.current++,this.speedNum=0);var a=this._frameData.cellX,b=this._frameData.cellY;this.current>a*b-1&&(1==this.stopStatic?(this.stopStatic=2,this.endFlag=!0):this.current=0)}},b.prototype.goToAndPlay=function(a){this.stopStatic=1,this.current=a},b.prototype.goToAndStop=function(a){
this.stopEnd(),this.current=a,this.applyRenderSize()},b.prototype.Invisible=function(){0!=this.renderData[2]&&0!=this.renderData[3]&&(this.stopEnd(),this.renderData[0]=0,this.renderData[1]=0,this.renderData[2]=0,this.renderData[3]=0,this.uiRender.makeRenderDataVc(this.vcId))},b.prototype.play=function(){this.stopStatic=0},b.prototype.stopEnd=function(){this.stopStatic=2;var a=this._frameData.cellX,b=this._frameData.cellY;this.current=a*b-1,this.applyRenderSize()},b}(UICompenent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),List=function(a){function b(){var b=a.call(this)||this;return b._contentX=0,b._contentY=0,b._needScoller=!1,b.lastcontentY=0,b.addEventListener(InteractiveEvent.Down,b.onDown,b),b.addEventListener(InteractiveEvent.Up,b.onListUp,b),b}return __extends(b,a),b.prototype.applyAbsolutePoint=function(){this.parent&&(this.absoluteX=(this._x*this.scale+this._contentX)*UIData.Scale+this.parent.x,this.absoluteY=(this._y*this.scale+this._contentY)*UIData.Scale+this.parent.y,this.absoluteWidth=this.width*UIData.Scale,this.absoluteHeight=this.height*UIData.Scale,this.applyRenderSize())},Object.defineProperty(b.prototype,"contentX",{get:function(){return this._contentX},set:function(a){this._contentX=a,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"contentY",{get:function(){return this._contentY},set:function(a){this._contentY=a,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),b.prototype.testPoint=function(a,b){return a>this.absoluteX&&a<this.absoluteX+this._showWidth*UIData.Scale&&b>this.absoluteY&&b<this.absoluteY+this._showHeight*UIData.Scale?!0:!1},b.prototype.setData=function(a,b,c,d,e,f,g,h){void 0===g&&(g=256),void 0===h&&(h=300),this.uiRender.uiAtlas&&this.uiRender.uiAtlas.dispose(),this.width=e,this.height=f,this._showWidth=g,this._showHeight=h,this._itemWidth=c,this._itemHeight=d,this.data=a;var i=new ListAtlas;this.uiRender.setAtlas(i),i.setData(e,f,c,d,a.length),this._itemRenderAry=new Array;for(var j=0;j<a.length;j++){var k=new b;k.setData(a[j],i,i.configData[j]),this._itemRenderAry.push(k)}this._oHeight=d*a.length,this._oHeight>this._showHeight?this._needScoller=!0:this._needScoller=!1,this.uiRender.applyObjData()},b.prototype.refresh=function(){for(var a=0;this._itemRenderAry&&a<this._itemRenderAry.length;a++)this._itemRenderAry[a].draw()},b.prototype.pushVaData=function(a,b,c){if(!this._itemRenderAry)return 0;for(var d=0;d<this._itemRenderAry.length;d++){var e=this._itemRenderAry[d].uvData;a.vertices.push(0,-e.y,0,1,-e.y,0),a.uvs.push(0,e.y,b,1,e.y,b)}a.vertices.push(0,-1,0,1,-1,0),a.uvs.push(0,1,b,1,1,b);for(var d=0;d<this._itemRenderAry.length;d++)a.indexs.push(c+2*d,1+c+2*d,3+c+2*d,c+2*d,3+c+2*d,2+c+2*d);return c+2*(this._itemRenderAry.length+1)},b.prototype.onDown=function(a){this._ypos=a.y,this.lastcontentY=this.contentY,this._needScoller&&(Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.onUp,this))},b.prototype.onListUp=function(a){if(this.uiRender.mask)this.uiRender.mask.testPoint(a.x,a.y)&&this.testItemClick(a.x,a.y);else if(Math.abs(this.contentY-this.lastcontentY)<1){var b=(a.y-this.absoluteY+this.contentY)/UIData.Scale;b>=0&&b<this._showHeight&&this.testItemClick(a.x,a.y)}},b.prototype.testItemClick=function(a,b){var c=a-this.absoluteX,d=b-this.absoluteY,e=this._itemHeight*UIData.Scale,f=Math.floor(d/e);f>=this._itemRenderAry.length||0>f||this._itemRenderAry[f].click(c,d-e*f)},b.prototype.onMove=function(a){this.contentY-=this._ypos-a.y,this.contentY>0?this.contentY=0:this.contentY<this._showHeight*this.scale-this._oHeight*this.scale&&(this.contentY=this._showHeight*this.scale-this._oHeight*this.scale),this._ypos=a.y},b.prototype.onUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.onUp,this)},b}(UICompenent),ListAtlas=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.setData=function(a,b,c,d,e){this.ctx=UIManager.getInstance().getContext2D(a,b,!1),this.textureRes=TextureManager.getInstance().getCanvasTexture(this.ctx),this.configData=new Array;for(var f=0;e>f;f++){var g=new Object;g.ox=0,g.oy=f*d,g.ow=c,g.oh=d,g.x=0,g.y=f*d/b,g.width=c/a,g.height=d/b,g.name=f.toString(),this.configData.push(g)}},b}(UIAtlas),ListItemData=function(){function a(){}return a}(),ListItemRender=function(){function a(){}return a.prototype.setData=function(a,b,c){this._listItemData=a,this._listItemData.itemRender=this,this.uvData=c,this.atlas=b,this.draw()},Object.defineProperty(a.prototype,"listItemData",{get:function(){return this._listItemData},enumerable:!0,configurable:!0}),a.prototype.setNewData=function(a){},Object.defineProperty(a.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a},enumerable:!0,configurable:!0}),a.prototype.draw=function(){},a.prototype.redraw=function(){},a.prototype.click=function(a,b){if(this._listItemData.clickFun){if(this._listItemData.clickRect&&!this._listItemData.clickRect.isHitByPoint(a/UIData.Scale,b/UIData.Scale))return;this._listItemData.clickFun(this._listItemData)}},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SList=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.p_scrollY=0,b._showItemNum=0,b._allItemNum=0,b._topSize=0,b._bottomSize=0,b._outSize=0,b._showDataIndex=0,b.scrollLock=!1,b._minScrollY=0,b._maskLevel=2,b._mouseY=0,b._dragFlag=!1,b._dragY=0,b._dragMaxY=100,b}return __extends(b,a),b.prototype.setData=function(a,b,c,d,e,f,g,h,i,j,k,l){if(void 0===l&&(l=0),this.width=c,this._height=d,this.p_itemHeight=f,this.p_itemWidth=e,this._showIndexList=new Array,this._dataAry=a,this._showItemNum=g,this._allItemNum=j*k,this._contentX=j,this._contentY=k,this._outSize=(k-this._showItemNum)*f,this._topSize=0,this._bottomSize=this._outSize,this._showDataIndex=0,this._sAtlas=new SListAtlas,this._sAtlas.setData(h,i,j,k),this.bgMask=new UIMask,this.bgMask.x=0,this.bgMask.y=0,this.bgMask.width=c,this.bgMask.height=d,this.bgMask.level=this._maskLevel,this.addMask(this.bgMask),this._bgRender=new SListBgRender,this._bgRender.uiAtlas=this._sAtlas,this._bgRender.slist=this,this.addRender(this._bgRender),this._baseRender=new SlistFrontRender,this._baseRender.uiAtlas=this._sAtlas,this.addRender(this._baseRender),this._bgRender.mask=this.bgMask,this._baseRender.mask=this.bgMask,0!=l){this.customRenderAry=new Array;for(var m=0;l>m;m++){var n=new SlistFrontRender;n.uiAtlas=this._sAtlas,this.addRender(n),n.mask=this.bgMask,this.customRenderAry.push(n)}}this._itemList=new Array;for(var m=0;m<this._allItemNum;m++){var o=new b;o.baseY=float2int(m/j)*f,o.baseX=m%j*e,o.uiAtlas=this._sAtlas,o.index=m,o.parentTarget=this,o.create(this,this._bgRender,this._baseRender,this.customRenderAry),o.render(a[m]),this._itemList.push(o),this._showIndexList.push(m)}this._minScrollY=this._height-float2int(this._dataAry.length/this._contentX)*this.p_itemHeight,this.scrollY(0),Math.ceil(a.length/this._contentX)<=this._showItemNum?this.scrollLock=!0:this.scrollLock=!1,this.initComplte()},b.prototype.initComplte=function(){},b.prototype.setShowLevel=function(a){this._maskLevel=a,this.bgMask&&(this.bgMask.level=this._maskLevel)},b.prototype.setSelect=function(a){for(var b=0;b<this._itemList.length;b++)this._itemList[b]==a?(this._currentSelIdx=this._dataAry.indexOf(this._itemList[b].itdata),console.log("--选中---",this._currentSelIdx),this._itemList[b].selected=!0):this._itemList[b].selected&&(this._itemList[b].selected=!1)},b.prototype.setSelectIndex=function(a){console.log("--选中哪个---",a),this._currentSelIdx=a;for(var b=0;b<this._itemList.length;b++)this._itemList[b].itdata&&this._itemList[b].itdata.id==a?this._itemList[b].selected=!0:this._itemList[b].selected&&(this._itemList[b].selected=!1)},b.prototype.getCurrentSelectIndex=function(){return this._currentSelIdx||(this._currentSelIdx=0),this._currentSelIdx},b.prototype.changeMinScrollY=function(){this._minScrollY=this._height-Math.ceil(this._dataAry.length/this._contentX)*this.p_itemHeight},b.prototype.refreshData=function(a){this._dataAry=a,this._showIndexList=new Array;for(var b=0;b<this._itemList.length;b++)this._itemList[b].render(a[b]),this._itemList[b].baseY=float2int(b/this._contentX)*this.p_itemHeight,this._showIndexList.push(b);this._outSize=(this._contentY-this._showItemNum)*this.p_itemHeight,this._topSize=0,this._bottomSize=this._outSize,this._showDataIndex=0,this._minScrollY=this._height-Math.ceil(this._dataAry.length/this._contentX)*this.p_itemHeight,this.scrollY(0),Math.ceil(a.length/this._contentX)<=this._showItemNum?this.scrollLock=!0:this.scrollLock=!1},b.prototype.setItemData=function(a,b){this._dataAry[b].data=a;for(var c=0;c<this._itemList.length;c++)if(this._itemList[c].itdata==this._dataAry[b]){this._itemList[c].refreshDraw();break}},b.prototype.clearItemByPos=function(a){this._dataAry[a].data=null;for(var b=0;b<this._itemList.length;b++)if(this._itemList[b].itdata==this._dataAry[a]){this._itemList[b].refreshDraw();break}},b.prototype.getDataSize=function(){return this._dataAry.length},b.prototype.refreshDraw=function(){for(var a=0;a<this._itemList.length;a++)this._itemList[a].refreshDraw()},b.prototype.scroll=function(){},b.prototype.interactiveEvent=function(a){return a.type==InteractiveEvent.Down&&this.bgMask.testPoint(a.x,a.y)?(this._mouseY=a.y,(!this.scrollLock||this._dragFlag)&&(Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.onUp,this)),!0):!1},b.prototype.onMove=function(a){var b=a.y-this._mouseY;this._mouseY=a.y,0>b&&this.scrollLock||this.scrollY(b)},b.prototype.onUp=function(a){var b=this;Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.onUp,this),this._dragFlag&&(this._dragY<0?this._dragDownFun&&this._dragDownFun():this._dragY>0&&this._dragUpFun&&this._dragUpFun(),0!=this._dragY&&TweenMoveTo(this,.5,{dragY:0,onUpdate:function(){b.refreshResultPos()}}))},b.prototype.setDragFun=function(a,b){this._dragUpFun=a,this._dragDownFun=b,a||b?this._dragFlag=!0:(this._dragFlag=!1,this._dragY=0)},Object.defineProperty(b.prototype,"dragY",{get:function(){return this._dragY},set:function(a){this._dragY=a},enumerable:!0,configurable:!0}),b.prototype.scrollIdx=function(a){console.log("--滑动几个--",a);var b=-this.p_itemHeight*a,c=b-this.p_scrollY,d=Math.ceil(Math.abs(c)/this.p_itemHeight);c/=d;for(var e=0;d>e;e++)this.scrollY(c)},b.prototype.getIdxY=function(a){return this.p_itemHeight*a},b.prototype.getIdxX=function(a){return this.p_itemWidth*a},b.prototype.scrollY=function(a){if(this._topSize-=a,this._bottomSize+=a,this._topSize<=0)if(this._bottomflag=!0,0==this._showDataIndex)this._topSize=0,this._bottomSize=this._outSize,this.p_scrollY=0,this._topflag=!1,this._dragFlag&&Math.abs(this._dragY)<this._dragMaxY&&(this._dragY+=a);else{for(var b=this._showIndexList[0],c=this._itemList[b].baseY-this.p_itemHeight,d=0;d<this._contentX;d++){var e=this._showIndexList.pop();this._showIndexList.unshift(e),this._itemList[e].baseY=c,this._itemList[e].render(this._dataAry[this._showDataIndex-1]),this._itemList[e].selected=this.getCurrentSelectIndex()==this._showDataIndex-1,this._showDataIndex--}this._bottomSize-=this.p_itemHeight,this._topSize+=this.p_itemHeight,this.p_scrollY+=a,this._topflag=!0}else if(this._bottomSize<=0)if(this._topflag=!0,this._showDataIndex+this._allItemNum>=this._dataAry.length)this._bottomSize=0,this._topSize=this._outSize,this.p_scrollY=-(Math.ceil(this._dataAry.length/this._contentX)-this._showItemNum)*this.p_itemHeight,this._bottomflag=!1;else{this._bottomflag=!0;for(var f=this._showIndexList[this._showIndexList.length-1],g=this._itemList[f].baseY+this.p_itemHeight,d=0;d<this._contentX;d++){var e=this._showIndexList.shift();this._showIndexList.push(e),this._itemList[e].baseY=g,this._itemList[e].render(this._dataAry[this._showDataIndex+this._allItemNum]),this._itemList[e].selected=this.getCurrentSelectIndex()==this._showDataIndex+this._allItemNum,this._showDataIndex++}this._bottomSize+=this.p_itemHeight,this._topSize-=this.p_itemHeight,this.p_scrollY+=a}else this._showItemNum>=this._dataAry.length?(this._topflag=!1,this._bottomflag=!1,this.p_scrollY=0):(this._topflag=!0,this._bottomflag=!0,this.p_scrollY+=a);this.p_scrollY<=this._minScrollY&&this._minScrollY<0&&(this.p_scrollY=this._minScrollY,this._topSize+=a,this._bottomSize-=a,this._topflag=!0,this._bottomflag=!1,this._dragFlag&&Math.abs(this._dragY)<this._dragMaxY&&(this._dragY+=a)),this.refreshResultPos(),this.backFun&&this.backFun(this._topflag,this._bottomflag,a)},b.prototype.refreshResultPos=function(){for(var a=0;a<this._itemList.length;a++)this._itemList[a].setY(this.p_scrollY+this._dragY)},b.prototype.dispose=function(){if(this._bgRender.dispose(),this._baseRender.dispose(),this.customRenderAry)for(var a=0;a<this.customRenderAry.length;a++)this.customRenderAry[a].dispose();this.bgMask.dispose()},b}(UIVirtualContainer),SListItem=function(){function a(){this._height=10,this._list=new Array,this.index=0,this.baseY=0,this.baseX=0,this._selected=!1}return a.prototype.addUI=function(a){this._list.push(a)},a.prototype.create=function(a,b,c,d){void 0===d&&(d=null),this._bgRender=b,this._baseRender=c,this._customRenderAry=d},a.prototype.render=function(a){},a.prototype.refreshDraw=function(){},a.prototype.setSelect=function(){this.parentTarget.setSelect(this)},a.prototype.unSetSelect=function(){this.selected=!1},Object.defineProperty(a.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a},enumerable:!0,configurable:!0}),a.prototype.creatSUI=function(a,b,c,d,e,f,g){var h=b.getLayoutData(c),i=c+this.index;this.uiAtlas.addConfig(i,this.index,h.rect);var j=a.creatBaseComponent(i),h=new Object;return j.name=c,j.x=h.x=d,j.y=h.y=e,j.width=h.width=f,j.height=h.height=g,j.baseRec=h,this._list.push(j),j},a.prototype.creatGrid9Component=function(a,b,c,d){var e=new Grid9Compenent,f=this.uiAtlas.getGridRec(b);return f.ogw=c,f.ogh=d,e.tr.setRec(f),e.ogw=f.ogw,e.ogh=f.ogh,e.gw=e.ogw/f.pixelWitdh,e.gh=e.ogh/f.pixelHeight,e.tr.setRec(f),e.skinName=b,e.uiRender=a,e},a.prototype.creatGrid9SUI=function(a,b,c,d,e,f,g,h,i){void 0===h&&(h=5),void 0===i&&(i=5);var j=b.getLayoutData(c),k=c+this.index;this.uiAtlas.addConfig(k,this.index,j.rect);var l=this.creatGrid9Component(a,k,h,i),j=new Object;return l.name=c,l.x=j.x=d,l.y=j.y=e,l.width=j.width=f,l.height=j.height=g,l.baseRec=j,this._list.push(l),l},a.prototype.getHeight=function(){return this._height},a.prototype.setItemUiX=function(a,b){a.baseRec.x=b,this.setY(this._sy)},a.prototype.setY=function(a){this._sy=a;for(var b=a+this.baseY,c=0;c<this._list.length;c++)this._list[c].y=this._list[c].baseRec.y+b,this._list[c].x=this._list[c].baseRec.x+this.baseX},a.prototype.setX=function(a){this._sx=a;for(var b=a+this.baseX,c=0;c<this._list.length;c++)this._list[c].y=this._list[c].baseRec.y+this.baseY,this._list[c].x=this._list[c].baseRec.x+b},a}(),SListItemData=function(){function a(){this.selected=!1}return a}(),SListBgRender=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.interactiveEvent=function(b){a.prototype.interactiveEvent.call(this,b);var c=this.slist.interactiveEvent(b);return c},b}(UIRenderComponent),SlistFrontRender=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.interactiveEvent=function(b){return a.prototype.interactiveEvent.call(this,b)},b}(UIRenderComponent),SListAtlas=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.setData=function(a,b,c,d){this.ctx=UIManager.getInstance().getContext2D(a,b,!1),this.width=a,this.height=b,this.textureRes=TextureManager.getInstance().getCanvasTexture(this.ctx),this.xNum=c,this.yNum=d,this.itemWidth=a/this.xNum,this.itemHeight=b/this.yNum,this.configData=new Array},b.prototype.addConfig=function(a,b,c){var d=new Object,e=b%this.xNum*this.itemWidth,f=float2int(b/this.xNum)*this.itemHeight;d.ox=e+c.x,d.oy=f+c.y,d.ow=c.width,d.oh=c.height,d.x=d.ox/this.width,d.y=d.oy/this.height,d.width=d.ow/this.width,d.height=d.oh/this.height,d.name=a,this.configData.push(d)},b}(UIAtlas),TransverseSList=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.p_scrollX=0,b._minScrollX=0,b._mouseX=0,b}return __extends(b,a),b.prototype.setData=function(a,b,c,d,e,f,g,h,i,j,k,l){void 0===l&&(l=0),this.width=c,this._height=d,this.p_itemWidth=e,this.p_itemHeight=f,this._showIndexList=new Array,this._dataAry=a,this._showItemNum=g,this._allItemNum=j*k,this._contentX=j,this._contentY=k,this._outSize=(j-this._showItemNum)*e,this._topSize=0,this._bottomSize=this._outSize,this._showDataIndex=0,this._sAtlas=new SListAtlas,this._sAtlas.setData(h,i,j,k),this.bgMask=new UIMask,this.bgMask.x=0,this.bgMask.y=0,this.bgMask.width=c,this.bgMask.height=d,this.bgMask.level=this._maskLevel,this.addMask(this.bgMask),this._bgRender=new SListBgRender,this._bgRender.uiAtlas=this._sAtlas,this._bgRender.slist=this,this.addRender(this._bgRender),this._baseRender=new SlistFrontRender,this._baseRender.uiAtlas=this._sAtlas,this.addRender(this._baseRender),this._bgRender.mask=this.bgMask,this._baseRender.mask=this.bgMask;var m;if(0!=l){m=new Array;for(var n=0;l>n;n++){var o=new SlistFrontRender;o.uiAtlas=this._sAtlas,this.addRender(o),o.mask=this.bgMask,m.push(o)}}this._itemList=new Array;for(var n=0;n<this._allItemNum;n++){var p=new b;p.baseX=float2int(n/k)*e,p.baseY=n%k*f,p.uiAtlas=this._sAtlas,p.index=n,p.parentTarget=this,p.create(this,this._bgRender,this._baseRender,m),p.render(this._dataAry[n]),this._itemList.push(p),this._showIndexList.push(n)}this._minScrollX=this.width-float2int(this._dataAry.length/this._contentY)*this.p_itemWidth,this.scrollX(0)},b.prototype.changeMinScrollX=function(){this._minScrollX=this.width-float2int(this._dataAry.length/this._contentY)*this.p_itemWidth},b.prototype.refreshData=function(a){this._dataAry=a,this._showIndexList=new Array;for(var b=0;b<this._itemList.length;b++)this._itemList[b].render(this._dataAry[b]),this._itemList[b].baseX=float2int(b/this._contentY)*this.p_itemWidth,this._showIndexList.push(b);this._outSize=(this._contentX-this._showItemNum)*this.p_itemWidth,this._topSize=0,this._bottomSize=this._outSize,this._showDataIndex=0,this._minScrollX=this.width-float2int(this._dataAry.length/this._contentY)*this.p_itemWidth,this.scrollX(0),Math.ceil(a.length/this._contentY)<=this._showItemNum?this.scrollLock=!0:this.scrollLock=!1},b.prototype.interactiveEvent=function(a){return a.type==InteractiveEvent.Down&&this.bgMask.testPoint(a.x,a.y)?(this._mouseX=a.x,this.scrollLock||(Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.onUp,this)),!0):!1},b.prototype.onMove=function(a){var b=a.x-this._mouseX;this._mouseX=a.x,0>b&&this.scrollLock||this.scrollX(b)},b.prototype.onUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.onUp,this)},b.prototype.scrollX=function(a){if(this._topSize-=a,this._bottomSize+=a,this._topSize<=0)if(this._bottomflag=!0,0==this._showDataIndex)this._topSize=0,this._bottomSize=this._outSize,this.p_scrollX=0,this._topflag=!1;else{for(var b=this._showIndexList[0],c=this._itemList[b].baseX-this.p_itemWidth,d=0;d<this._contentY;d++){var e=this._showIndexList.pop();this._showIndexList.unshift(e),this._itemList[e].baseX=c,this._itemList[e].render(this._dataAry[this._showDataIndex-1]),this._itemList[e].selected=this.getCurrentSelectIndex()==this._showDataIndex-1,this._showDataIndex--}this._bottomSize-=this.p_itemWidth,this._topSize+=this.p_itemWidth,this.p_scrollX+=a,this._topflag=!0}else if(this._bottomSize<=0)if(this._topflag=!0,this._showDataIndex+this._allItemNum>=this._dataAry.length)this._bottomSize=0,this._topSize=this._outSize,this.p_scrollX=-(Math.ceil(this._dataAry.length/this._contentY)-this._showItemNum)*this.p_itemWidth,this._bottomflag=!1;else{this._bottomflag=!0;for(var f=this._showIndexList[this._showIndexList.length-1],g=this._itemList[f].baseX+this.p_itemWidth,d=0;d<this._contentY;d++){var e=this._showIndexList.shift();this._showIndexList.push(e),this._itemList[e].baseX=g,this._itemList[e].render(this._dataAry[this._showDataIndex+this._allItemNum]),this._itemList[e].selected=this.getCurrentSelectIndex()==this._showDataIndex+this._allItemNum,this._showDataIndex++}this._bottomSize+=this.p_itemWidth,this._topSize-=this.p_itemWidth,this.p_scrollX+=a}else this._showItemNum>=this._dataAry.length?(this._topflag=!1,this._bottomflag=!1,this.p_scrollX=0):(this._topflag=!0,this._bottomflag=!0,this.p_scrollX+=a);this.p_scrollX<=this._minScrollX&&this._minScrollX<0&&(this.p_scrollX=this._minScrollX,this._topSize+=a,this._bottomSize-=a,this._topflag=!0,this._bottomflag=!1),this.refreshResultPos(),this.backFun&&this.backFun(this._topflag,this._bottomflag,a)},b.prototype.scrollIdx=function(a){var b=-this.p_itemWidth*a,c=b-this.p_scrollX,d=Math.ceil(Math.abs(c)/this.p_itemWidth);c/=d;for(var e=0;d>e;e++)this.scrollX(c)},b.prototype.refreshResultPos=function(){for(var a=0;a<this._itemList.length;a++)this._itemList[a].setX(this.p_scrollX)},b}(SList),EffectSlist=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._effRender=new FrameUIRender,b}return __extends(b,a),b.prototype.setEffectUrl=function(a,b,c,d){var e=this;void 0===d&&(d=1),this.effList&&this.effList.length>0?this.effectComplte():this._effRender.setImg(getEffectUIUrl(a),b,c,function(a){1==d?(e.effList=new Array,e.effList.push(a)):e.effList=a,e.effectComplte()},d)},b.prototype.initComplte=function(){this.addRender(this._effRender),this._effRender.mask=this.bgMask},b.prototype.effectComplte=function(){},b.prototype.refreshResultPos=function(){if(a.prototype.refreshResultPos.call(this),this.effList)for(var b=0;b<this.effList.length;b++)this.effList[b].y=this.effList[b].baseRec.y+this.p_scrollY},b.prototype.playEffect=function(a,b,c,d,e,f){void 0===f&&(f=3),this.effList&&this.effList.length>0&&(this.effList[a].x=b,this.effList[a].baseRec.y=c,this.effList[a].y=c+this.p_scrollY,this.effList[a].width=this.effList[a].baseRec.width*d,this.effList[a].height=this.effList[a].baseRec.height*e,this.effList[a].speed=f,this.effList[a].playOne(this))},b.prototype.showEffect=function(a,b,c,d,e,f){void 0===f&&(f=3),this.effList&&this.effList.length>0&&(this.effList[a].x=b,this.effList[a].baseRec.y=c,this.effList[a].y=c+this.p_scrollY,this.effList[a].width=this.effList[a].baseRec.width*d,this.effList[a].height=this.effList[a].baseRec.height*e,this.effList[a].speed=f,this.addChild(this.effList[a]),this.effList[a].play())},b.prototype.hideEffect=function(a){if(void 0===a&&(a=-1),this.effList&&this.effList.length>0)if(-1==a)for(var b=0;b<this.effList.length;b++)this.effList[b].parent&&this.effList[b].parent.removeChild(this.effList[b]);else a<this.effList.length&&a>=0&&this.effList[a].parent&&this.effList[a].parent.removeChild(this.effList[a])},b.prototype.dispose=function(){a.prototype.dispose.call(this),this._effRender.dispose()},b}(SList),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GridList=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.testPoint=function(a,b){return a>this.absoluteX&&a<this.absoluteX+this._showWidth*UIData.Scale&&b>this.absoluteY&&b<this.absoluteY+this._oHeight*UIData.Scale?!0:!1},b.prototype.setGridData=function(a,b,c,d,e,f,g,h,i){void 0===h&&(h=256),void 0===i&&(i=300),this.uiRender.uiAtlas&&this.uiRender.uiAtlas.dispose(),this.width=f,this.height=g,this._showWidth=h,this._showHeight=i,this.data=a,this.wNum=c,this._itemWidth=d,this._itemHeight=e;var j=new GridListAtlas;this.uiRender.setAtlas(j),j.setGridData(f,g,d,e,c,a.length),this._itemRenderAry=new Array;for(var k=0;k<a.length;k++){var l=new b;l.setData(a[k],j,j.configData[k]),this._itemRenderAry.push(l)}this._oHeight=e*Math.ceil(this._itemRenderAry.length/this.wNum),this._oHeight>this._showHeight?this._needScoller=!0:this._needScoller=!1,this.uiRender.applyObjData()},b.prototype.setGridItemData=function(a,b){var c=this._itemRenderAry[b].listItemData.data?!0:!1;return this._itemRenderAry[b].setNewData(a),c},b.prototype.setGridItemFun=function(a,b){this._itemRenderAry[b].listItemData.clickFun=a},b.prototype.clearItemByIndex=function(a){for(var b=0;b<this._itemRenderAry.length;b++)this._itemRenderAry[b].listItemData.data&&this._itemRenderAry[b].listItemData.data.dataIndex==a&&(this._itemRenderAry[b].setNewData(null),this._itemRenderAry[b].listItemData.clickFun=null)},b.prototype.clearItemByPos=function(a){this._itemRenderAry[a].setNewData(null),this._itemRenderAry[a].listItemData.clickFun=null},b.prototype.redraw=function(){for(var a=0;a<this._itemRenderAry.length;a++)this._itemRenderAry[a].redraw()},b.prototype.testItemClick=function(a,b){var c=a-this.absoluteX,d=b-this.absoluteY,e=this._itemHeight*UIData.Scale,f=this._itemWidth*UIData.Scale,g=float2int(c/f),h=float2int(d/e),i=h*this.wNum+g;i>=this._itemRenderAry.length||this._itemRenderAry[i].click(c-f*(g-1),d-e*(h-1))},b.prototype.pushVaData=function(a,b,c){if(!this._itemRenderAry)return 0;for(var d=Math.ceil(this._itemRenderAry.length/this.wNum),e=this._itemWidth/this.width,f=this._itemHeight/this.height,b=0;d+1>b;b++)for(var g=0;g<this.wNum+1;g++)a.vertices.push(g*e,-b*f,0),a.uvs.push(g*e,b*f,0);for(var h=d*this.wNum,g=0;h>g;g++){var i=g%this.wNum+float2int(g/this.wNum)*(this.wNum+1),j=i+c,k=i+1+c,l=i+this.wNum+1+c,m=i+1+this.wNum+1+c;a.indexs.push(j,k,m,j,m,l)}return c+2*(this._itemRenderAry.length+1)},b}(List),GridListAtlas=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getAlphaImg=function(a,b){for(var c=this.ctx.createImageData(a,b),d=0;d<c.data.length;d++)c.data[d]=0;return c},b.prototype.setGridData=function(a,b,c,d,e,f){this.ctx=UIManager.getInstance().getContext2D(a,b,!1),this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,a,b);var g=this.getAlphaImg(a,b);this.textureRes=new TextureRes,this.textureRes.texture=Scene_data.context3D.getTexture(g,0,0),this.configData=new Array;for(var h=Math.ceil(f/e),i=0,j=0;h>j;j++)for(var k=0;e>k;k++){i=j*e+k;var l=new Object;l.ox=k*c,l.oy=j*d,l.ow=c,l.oh=d,l.x=k*c/a,l.y=j*d/b,l.width=c/a,l.height=d/b,l.name=i.toString(),this.configData.push(l)}},b}(ListAtlas),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),CdRenderComponent=function(a){function b(){var b=a.call(this)||this;return b.initProgram(),b}return __extends(b,a),b.prototype.setVc=function(){for(var b=0;b<this._uiList.length;b++)this._uiList[b].setVc(this.shader,b);a.prototype.setVc.call(this)},b.prototype.initProgram=function(){ProgrmaManager.getInstance().registe(CdUIShader.CdUIShader,new CdUIShader),this.shader=ProgrmaManager.getInstance().getProgram(CdUIShader.CdUIShader),this.program=this.shader.program,this.uiProLocation=Scene_data.context3D.getLocation(this.program,"ui"),this.ui2ProLocation=Scene_data.context3D.getLocation(this.program,"ui2"),this.dataTProLocation=Scene_data.context3D.getLocation(this.program,"dataT")},b.prototype.getComponent=function(a){var b=this.uiAtlas.getLayoutData(a),c=this.creatBaseComponent(b.dataItem[0]);return c.width=b.rect.width,c.height=b.rect.height,c.x=b.rect.x,c.y=b.rect.y,c.baseRec=b.rect,c.name=a,c},b.prototype.creatBaseComponent=function(a){var b=new CdUICompenent;b.skinName=a;var c=this.uiAtlas.getRec(a);return b.tr.setRec(c),b.width=c.pixelWitdh,b.height=c.pixelHeight,b.uiRender=this,b},b}(UIRenderComponent),CdUICompenent=function(a){function b(){var b=a.call(this)||this;return b.cdTotalnum=0,b.lastTime=0,b._skipNum=0,b.isRound=!1,b.visible=!0,b.clockwise=!0,b._skipNum=float2int(360*Math.random()),b}return __extends(b,a),b.prototype.setCdNum=function(a){this._skipNum=360*a},Object.defineProperty(b.prototype,"isFinish",{get:function(){return this._skipNum>=360?!0:!1},enumerable:!0,configurable:!0}),b.prototype.update=function(){if(0!=this.cdTotalnum){var b=(TimeUtil.getTimer()-this.lastTime)/this.cdTotalnum;1>b?this.setCdNum(b):this.setCdNum(1)}a.prototype.update.call(this)},b.prototype.setVc=function(a,b){var c=this._skipNum%360/180*Math.PI;Scene_data.context3D.setVc4fv(a,"dataTime["+b+"]",[c,this.clockwise?0:1,0,1])},b}(UICompenent),CdUIShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform vec4 ui[20];uniform vec4 ui2[20];uniform vec4 dataTime[20];varying vec2 v_pos;\nvarying vec2 u_pos;varying vec4 v_dataTime;void main(void){   vec4 data = ui2[int(v2uv.z)];   v_dataTime = dataTime[int(v2uv.z)];   v_pos = vec2(v3Pos.x ,v3Pos.y);   u_pos = vec2(v2uv.x * data.x + data.z, v2uv.y * data.y + data.w);   data = ui[int(v2uv.z)];   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy * data.zw * 2.0;   pos.x += data.x * 2.0 - 1.0;   pos.y += -data.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 u_pos;\nvarying vec2 v_pos;varying vec4 v_dataTime;\nvoid main(void)\n{\nfloat alpha =1.0;\nfloat tx =v_pos.x*2.0 - 1.0;\nfloat ty =v_pos.y*2.0 + 1.0;\nfloat atanNum =atan(tx,ty);\nvec4 infoUv = texture2D(s_texture, u_pos.xy);\ninfoUv.xyz *= infoUv.w;\nif (tx>0.0) {\nif (v_dataTime.x<atanNum) {\nalpha=0.0;\n}; \n} else {\natanNum =atanNum+6.283;\nif (v_dataTime.x<atanNum) {\nalpha=0.0;\n}; \n}; \nif (v_dataTime.y==1.0) {\nalpha=1.0-alpha;\n}; \ngl_FragColor = infoUv*alpha;\n}";return a},b.CdUIShader="CdUIShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Disp2DBaseText=function(){function a(){this.dtime=-1,this.time=0,this.oldPos=new Vector2D}return a.prototype.needUpData=function(a){return this.oldPos.x!=a.x||this.oldPos.y!=a.y||Scene_data.cam3D.needChange?(this.oldPos.x=a.x,this.oldPos.y=a.y,!0):!1},Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a,this.makeData(),this.time=0,this.update()},enumerable:!0,configurable:!0}),a.prototype.makeData=function(){},a.prototype.update=function(){},
a.prototype.Vector3DToVector2D=function(a){var b=Scene_data.cam3D.cameraMatrix.clone();b.append(Scene_data.viewMatrx3D.clone());var c=b.transformVector(a),d=new Vector2D;return d.x=(c.x/c.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,d.y=(-c.y/c.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2,d},a.prototype.isEqualLastKey=function(a){return!1},a}(),Dis2DUIContianerPanel=function(a){function b(b,c,d){var e=a.call(this)||this;return e.width=UIData.designWidth,e.height=UIData.designHeight,e.creatBaseRender(),e.addRender(e._baseRender),e.initData(b,c,d),e}return __extends(b,a),b.prototype.creatBaseRender=function(){this._baseRender=new UIRenderComponent},b.prototype.initData=function(a,b,c){this._voNum=Math.floor(c),this._voRect=b,this._textureRect=new Rectangle(0,0,Math.pow(2,Math.ceil(Math.log(b.width)/Math.log(2))),Math.pow(2,Math.ceil(Math.log(b.height*this._voNum)/Math.log(2)))),this._baseRender.uiAtlas=new UIAtlas;var d=this._baseRender.uiAtlas;d.configData=new Array,d.ctx=UIManager.getInstance().getContext2D(this._textureRect.width,this._textureRect.height,!1),d.textureRes=TextureManager.getInstance().getCanvasTexture(d.ctx),this.makeBaseUi(a)},b.prototype.makeBaseUi=function(a){var b=this._baseRender.uiAtlas;this._uiItem=new Array,this._lostItem=new Array;for(var c=0;c<this._voNum;c++){var d=new a;this._uiItem.push(d),d.parent=this._baseRender,d.voRect=this._voRect,d.textureStr="id"+c,b.configData.push(b.getObject(d.textureStr,0,c*this._voRect.height,this._voRect.width,this._voRect.height,this._textureRect.width,this._textureRect.height)),d.ui=this._baseRender.creatBaseComponent(d.textureStr),d.ui.width*=1,d.ui.height*=1}},b.prototype.showTemp=function(a){for(var b,c=0;c<this._uiItem.length;c++)if(null==this._uiItem[c].data&&this._uiItem[c].isEqualLastKey(a)){b=this._uiItem[c];break}if(!b)for(var d=0;d<this._uiItem.length;d++)if(null==this._uiItem[d].data){b=this._uiItem[d];break}return b?(b.data=a,this.addChild(b.ui)):this._lostItem.push(a),b},b.prototype.playLost=function(){this._lostItem.length&&this.showTemp(this._lostItem.pop())},b.prototype.clearTemp=function(a){for(var b=0;b<this._uiItem.length;b++)if(this._uiItem[b].data==a){this._uiItem[b].data=null,this.removeChild(this._uiItem[b].ui);break}},b.prototype.clearAll=function(){for(var a=0;a<this._uiItem.length;a++)this._uiItem[a].data&&this.clearTemp(this._uiItem[a].data)},b.prototype.update=function(a){for(var b=0;b<this._uiItem.length;b++)this._uiItem[b].data&&this._uiItem[b].update()},b.prototype.getUiItemLen=function(){for(var a=0,b=0;b<this._uiItem.length;b++)this._uiItem[b].data&&a++;return a},b}(Dis2DUIContianerBase),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),AlphaUIShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform vec4 ui[40];uniform vec4 ui2[40];uniform float alpha[40];varying vec2 v_texCoord;varying float v_alpha;void main(void){   vec4 data = ui2[int(v2uv.z)];   v_texCoord = vec2(v2uv.x * data.x + data.z, v2uv.y * data.y + data.w);   v_alpha = alpha[int(v2uv.z)];   data = ui[int(v2uv.z)];   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy * data.zw * 2.0;   pos.x += data.x * 2.0 - 1.0;   pos.y += -data.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvarying float v_alpha;void main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\ninfoUv *=v_alpha;\ngl_FragColor = infoUv;\n}";return a},b.AlphaUiShader="AlphaUiShader",b}(Shader3D),AlphaUIRenderComponent=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.update=function(){if(this.visible&&0!=this._uiList.length){Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program);for(var a=0;a<this._uiList.length;a++)this._uiList[a].update(),this._uiList[a].setVc(this.shader,a);Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),this.uiAtlas?Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.uiAtlas.texture,0):Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},b.prototype.initData=function(){this._uiList=new Array,this.objData=new ObjData,ProgrmaManager.getInstance().registe(AlphaUIShader.AlphaUiShader,new AlphaUIShader),this.shader=ProgrmaManager.getInstance().getProgram(AlphaUIShader.AlphaUiShader),this.program=this.shader.program,this.uiProLocation=Scene_data.context3D.getLocation(this.program,"ui"),this.ui2ProLocation=Scene_data.context3D.getLocation(this.program,"ui2"),this.alphaLocation=Scene_data.context3D.getLocation(this.program,"alpha")},b.prototype.creatBaseComponent=function(a){var b=new AlphaUICompenent;b.skinName=a;var c=this.uiAtlas.getRec(a);return b.tr.setRec(c),b.width=c.pixelWitdh,b.height=c.pixelHeight,b.uiRender=this,b},b.prototype.creatGrid9Component=function(a,b,c){var d=new AlphaGrid9UICompenent;d.skinName=a;var e=this.uiAtlas.getGridRec(a);return d.tr.setRec(e),d.ogw=e.ogw,d.ogh=e.ogh,d.gw=d.ogw/e.pixelWitdh,d.gh=d.ogh/e.pixelHeight,d.width=b,d.height=c,d.uiRender=this,d},b}(UIRenderComponent),AlphaGrid9UICompenent=function(a){function b(){var b=a.call(this)||this;return b.alpha=1,b}return __extends(b,a),b.prototype.setVc=function(a,b){Scene_data.context3D.setVc4fv(a,"ui["+b+"]",this.renderData),Scene_data.context3D.setVc4fv(a,"ui2["+b+"]",this.renderData2),Scene_data.context3D.setVc1fv(a,"alpha["+b+"]",[this.alpha])},b}(Grid9Compenent),AlphaUICompenent=function(a){function b(){var b=a.call(this)||this;return b.alpha=1,b}return __extends(b,a),b.prototype.setVc=function(a,b){Scene_data.context3D.setVc4fv(a,"ui["+b+"]",this.renderData),Scene_data.context3D.setVc4fv(a,"ui2["+b+"]",this.renderData2),Scene_data.context3D.setVc1fv(a,"alpha["+b+"]",[this.alpha])},b}(UICompenent),AlphaUiContianer=function(a){function b(b,c,d){return a.call(this,b,c,d)||this}return __extends(b,a),b.prototype.creatBaseRender=function(){this._baseRender=new AlphaUIRenderComponent},b}(Dis2DUIContianerPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),RoationUIShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform vec4 ui[40];uniform vec4 ui2[40];uniform float rotation[40];varying vec2 v_texCoord;void main(void){   vec4 data = ui2[int(v2uv.z)];   v_texCoord = vec2(v2uv.x * data.x + data.z, v2uv.y * data.y + data.w);   float angle = rotation[int(v2uv.z)];   data = ui[int(v2uv.z)];vec3 pos = vec3(0.0,0.0,0.0);vec4 np = vec4(sin(angle), cos(angle), 0, 0);\npos.x = np.x * v3Pos.y + np.y * v3Pos.x;\npos.y = np.y * v3Pos.y - np.x * v3Pos.x;\n pos.xy = pos.xy * data.zw * 2.0;   pos.x += data.x * 2.0 - 1.0;   pos.y += -data.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}";return a},b.RoationUiShader="RoationUiShader",b}(Shader3D),RoationUIRenderComponent=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.update=function(){if(this.visible&&0!=this._uiList.length){Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program);for(var a=0;a<this._uiList.length;a++)this._uiList[a].update(),this._uiList[a].setVc(this.shader,a);Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),this.uiAtlas?Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.uiAtlas.texture,0):Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},b.prototype.initData=function(){this._uiList=new Array,this.objData=new ObjData,ProgrmaManager.getInstance().registe(RoationUIShader.RoationUiShader,new RoationUIShader),this.shader=ProgrmaManager.getInstance().getProgram(RoationUIShader.RoationUiShader),this.program=this.shader.program,this.uiProLocation=Scene_data.context3D.getLocation(this.program,"ui"),this.ui2ProLocation=Scene_data.context3D.getLocation(this.program,"ui2"),this.alphaLocation=Scene_data.context3D.getLocation(this.program,"rotation")},b.prototype.creatBaseComponent=function(a){var b=new RoationUICompenent;b.skinName=a;var c=this.uiAtlas.getRec(a);return b.tr.setRec(c),b.width=c.pixelWitdh,b.height=c.pixelHeight,b.uiRender=this,b},b}(UIRenderComponent),RoationUICompenent=function(a){function b(){var b=a.call(this)||this;return b.alpha=.5,b}return __extends(b,a),b.prototype.setVc=function(a,b){Scene_data.context3D.setVc4fv(a,"ui["+b+"]",this.renderData),Scene_data.context3D.setVc4fv(a,"ui2["+b+"]",this.renderData2),Scene_data.context3D.setVc1fv(a,"rotation["+b+"]",[this.alpha]),this.alpha+=.01},b}(UICompenent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),FrameUIRender=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.setImg=function(a,b,c,d,e){var f=this;void 0===e&&(e=1),TextureManager.getInstance().getTexture(Scene_data.fileRoot+a,function(a){var g=new UIAtlas;if(g.textureRes=a,f.uiAtlas=g,1==e)d(f.getFrameTipComponent(b,c));else{for(var h=new Array,i=0;e>i;i++)h.push(f.getFrameTipComponent(b,c));d(h)}})},b.prototype.update=function(){a.prototype.update.call(this);for(var b=this._uiList.length-1;b>=0;b--)this._uiList[b]instanceof FrameTipCompenent&&this._uiList[b].updateEnd()},b.prototype.getFrameTipComponent=function(a,b){var c=new FrameTipCompenent,d=new UIRectangle;d.x=0,d.y=0,d.width=1,d.height=1,d.pixelWitdh=this.uiAtlas.textureRes.width,d.pixelHeight=this.uiAtlas.textureRes.height,d.pixelX=0,d.pixelY=0,d.type=2,d.cellX=a,d.cellY=b,c.setFrameData(d),c.uiRender=this;var e=new Object;return e.width=this.uiAtlas.textureRes.width/a,e.height=this.uiAtlas.textureRes.height/b,e.x=0,e.y=0,c.width=e.width,c.height=e.height,c.x=e.x,c.y=e.y,c.baseRec=e,c},b}(UIRenderComponent),FrameTipCompenent=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.playOne=function(a){this.parent||a.addChild(this),this.endFlag=!1,this.goToAndPlay(0)},b.prototype.updateEnd=function(){this.endFlag&&this.parent.removeChild(this)},b}(FrameCompenent),IconManager=function(){function a(){this._dic=new Object,this._loadDic=new Object}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getIconName=function(a,b,c){void 0===c&&(c=null),this.getIcon(geteqiconIconUrl(a),b,c)},a.prototype.getIcon=function(a,b,c){var d=this;void 0===c&&(c=null);var e=Scene_data.fileRoot+a;if(this._dic[e])return void(c?b(this._dic[e],c):b(this._dic[e]));if(this._loadDic[e])this._loadDic[e].push({fun:b,info:c});else{this._loadDic[e]=new Array,this._loadDic[e].push({fun:b,info:c});var f=new Image;f.onload=function(){for(var a=d._loadDic[e],b=0;b<a.length;b++){var c=a[b];c.info?c.fun(f,c.info):c.fun(f)}delete d._loadDic[e],d._dic[e]=f},f.src=e}},a.prototype.drawLoadImg=function(a,b){},a.prototype.drawCircleIcon=function(b,c,d,e,f,g){void 0===e&&(e=!1),void 0===f&&(f=null),void 0===g&&(g=!1);var h="";if(0==c){var i=tb.TB_item_template.get_TB_item_template(d);h=geteqiconIconUrl(i.icon)}else if(1==c);else if(2==c){var j=tb.TB_skill_base.get_TB_skill_base(d);h=getSkillIconUrl(String(j.icon))}else 3==c&&(h=getRoleIconUrl("1"));if(a.getInstance().getIcon(h,function(a){var c=b.uiRender.uiAtlas.getRec(b.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(a,0,0,a.width,a.height,4,4,60,60),e&&UIManager.getInstance().makeCtxToGray(d,new Rectangle(0,0,68,68)),g&&UiDraw.cxtDrawImg(d,PuiData.CIRCL74,new Rectangle(0,0,68,68),UIData.publicUi),b.uiRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)}),2==c&&f>0){var k=new Object;k.baseData=j,k.levData=TableData.getInstance().getData(TableData.tb_skill_uplevel,j.uplevel_id[0]+f-1),k.lev=f,b.data=k,b.addEventListener(InteractiveEvent.Up,this.itemSkillClick,this)}},a.prototype.drawMountIcon=function(b,c,d,e){void 0===d&&(d=!1),void 0===e&&(e=!1),a.getInstance().getIcon(getMountIconUrl(String(c)),function(a){var c=b.uiRender.uiAtlas.getRec(b.skinName),f=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.SKILL_BG68,new Rectangle(3,3,68,68),UIData.publicUi),f.drawImage(a,0,0,a.width,a.height,6,6,62,62),d&&(UIManager.getInstance().makeCtxToGray(f,new Rectangle(0,0,74,74)),UiDraw.cxtDrawImg(f,PuiData.A_CHAIN,new Rectangle(4,4,65,65),UIData.publicUi)),e&&UiDraw.cxtDrawImg(f,PuiData.CIRCL74,new Rectangle(0,0,74,74),UIData.publicUi),b.uiRender.uiAtlas.updateCtx(f,c.pixelX,c.pixelY)})},a.prototype.drawMinSkillIcon=function(b,c,d,e){void 0===d&&(d=!1),void 0===e&&(e=1);var f=TableData.getInstance().getData(TableData.tb_skill_base,c),g=getSkillIconUrl(String(f.icon));a.getInstance().getIcon(g,function(a){var c=b.uiRender.uiAtlas.getRec(b.skinName),e=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.SKILL_BG58,new Rectangle(0,0,58,58),UIData.publicUi),e.drawImage(a,0,0,a.width,a.height,4,4,50,50),d&&UIManager.getInstance().makeCtxToGray(e,new Rectangle(0,0,58,58)),b.uiRender.uiAtlas.updateCtx(e,c.pixelX,c.pixelY)});var h=new Object;h.baseData=f,h.levData=TableData.getInstance().getData(TableData.tb_skill_uplevel,f.uplevel_id[0]+e-1),h.lev=e,b.data=h,b.addEventListener(InteractiveEvent.Up,this.itemSkillClick,this)},a.prototype.drawCircleBossIcon=function(b,c,d){var e=(tb.TB_creature_template.get_TB_creature_template(c),"ui/load/npc/tou.png");a.getInstance().getIcon(e,function(a){var c=b.uiRender.uiAtlas.getRec(b.skinName),e=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);1==d?(UiDraw.cxtDrawImg(e,PuiData.BOSSBG76,new Rectangle(0,0,76,76),UIData.publicUi),e.drawImage(a,0,0,60,60,8,8,60,60)):(UiDraw.cxtDrawImg(e,PuiData.BOSSBG64,new Rectangle(0,0,72,72),UIData.publicUi),e.drawImage(a,0,0,60,60,8,8,56,56)),b.uiRender.uiAtlas.updateCtx(e,c.pixelX,c.pixelY)})},a.prototype.drawTxtLabel=function(a,b){var c=a.uiRender.uiAtlas.getRec(a.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.TXTBG,new Rectangle(0,0,c.pixelWitdh,c.pixelHeight),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(d,b,16,c.pixelWitdh-d.measureText(b).width-15,5,TextAlign.LEFT,ColorType.Orange7a2f21),a.uiRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},a.prototype.drawCostTxtLabel=function(a,b){},a.prototype.drawSkillIcon=function(a){},a.prototype.clearItemEvent=function(a){a.data=null,a.removeEventListener(InteractiveEvent.Up,this.itemClick,this)},a.prototype.drawItemIcon60=function(b,c,d,e,f){if(void 0===d&&(d=0),void 0===e&&(e=!1),void 0===f&&(f=!0),c>0){var g=tb.TB_item_template.get_TB_item_template(c);a.getInstance().getIconName(g.icon,function(a){var c=b.uiRender.uiAtlas.getRec(b.skinName),f=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);if(UiDraw.cxtDrawImg(f,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(g.quality),new Rectangle(0,0,68,68),UIData.publicUi),f.drawImage(a,0,0,60,60,4,4,60,60),1==g.type&&(UiDraw.cxtDrawImg(f,PuiData.A_EQULEVBG,new Rectangle(4,4,41,17),UIData.publicUi),ArtFont.getInstance().writeFontToCtxCenten(f,String(g.level),ArtFont.num63,18,4,4)),d>1){var h=Snum(d);LabelTextFont.writeSingleLabelToCtxSetAnchor(f,h,16,64,45,TextAlign.RIGHT,ColorType.Whitefff4d6,ColorType.colord27262e)}e&&UIManager.getInstance().makeCtxToGray(f,new Rectangle(0,0,68,68)),b.uiRender.uiAtlas.updateCtx(f,c.pixelX,c.pixelY)}),f&&(b.data=g,b.addEventListener(InteractiveEvent.Up,this.itemClick,this))}else{var h=b.uiRender.uiAtlas.getRec(b.skinName),i=UIManager.getInstance().getContext2D(h.pixelWitdh,h.pixelHeight,!1);UiDraw.cxtDrawImg(i,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),b.uiRender.uiAtlas.updateCtx(i,h.pixelX,h.pixelY)}},a.prototype.drawItemIcon40=function(b,c,d,e,f){if(void 0===d&&(d=0),void 0===e&&(e=!1),void 0===f&&(f=!0),c>0){var g=tb.TB_item_template.get_TB_item_template(c);a.getInstance().getIconName(g.icon,function(a){var c=b.uiRender.uiAtlas.getRec(b.skinName),f=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);if(UiDraw.cxtDrawImg(f,PuiData.PropBg40,new Rectangle(0,0,48,48),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(g.quality),new Rectangle(0,0,48,48),UIData.publicUi),f.drawImage(a,0,0,60,60,4,4,40,40),d>1){var h=Snum(d);LabelTextFont.writeSingleLabelToCtxSetAnchor(f,h,12,44,30,TextAlign.RIGHT,ColorType.Whitefff4d6,ColorType.colord27262e)}e&&UIManager.getInstance().makeCtxToGray(f,new Rectangle(0,0,48,48)),b.uiRender.uiAtlas.updateCtx(f,c.pixelX,c.pixelY)}),f&&(b.data=g,b.addEventListener(InteractiveEvent.Up,this.itemClick,this))}else{var h=b.uiRender.uiAtlas.getRec(b.skinName),i=UIManager.getInstance().getContext2D(h.pixelWitdh,h.pixelHeight,!1);UiDraw.cxtDrawImg(i,PuiData.PropBg40,new Rectangle(0,0,48,48),UIData.publicUi),b.uiRender.uiAtlas.updateCtx(i,h.pixelX,h.pixelY)}},a.prototype.drawVip=function(b,c){a.getInstance().getIcon(getVipIconUrl(c),function(a){var c=b.uiRender.uiAtlas.getRec(b.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(a,0,0,a.width,a.height,0,0,a.width,a.height),b.uiRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},a.prototype.itemClick=function(a){var b=a.target.data,c=new BagItemData;c.entryData=b;var d=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);d.data=c,d.buttonType=-1,ModuleEventManager.dispatchEvent(d)},a.prototype.itemSkillClick=function(a){var b=a.target.data,c=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);c.data=b,c.buttonType=7,ModuleEventManager.dispatchEvent(c)},a}(),UiTweenVo=function(){function a(){this._scale=1}return Object.defineProperty(a.prototype,"ui",{get:function(){return this._ui},set:function(a){this._ui=a,this._baseRect=new Rectangle(this._ui.x,this._ui.y,this._ui.width,this._ui.height)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scale",{get:function(){return this._scale},set:function(a){this._scale=a,this._ui.width=this._baseRect.width*this._scale,this._ui.height=this._baseRect.height*this._scale,this._ui.x=this._baseRect.x+(this._baseRect.width-this._ui.width)/2,this._ui.y=this._baseRect.y+(this._baseRect.height-this._ui.height)/2},enumerable:!0,configurable:!0}),a.prototype.destory=function(){this._ui=null,this._scale=null,this._baseRect=null},a.getPosByPanel=function(a,b,c){if(void 0===b&&(b=null),void 0===c&&(c=null),this.baseUIConatiner||(this.baseUIConatiner=new UIConatiner),this.baseUIConatiner.width=UIData.designWidth,this.baseUIConatiner.height=UIData.designHeight,this.baseUIConatiner.middle=0,this.baseUIConatiner.center=0,b)for(var d in b)this.baseUIConatiner[d]=b[d];this.baseUIConatiner.resize();var e=new Vector2D;return e.x=a.x+this.baseUIConatiner.x/UIData.Scale,e.y=a.y+this.baseUIConatiner.y/UIData.Scale,c&&(e.x=e.x-c.x/UIData.Scale,e.y=e.y-c.y/UIData.Scale),e},a}(),UiTweenScale=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.changeButSize=function(a){var b=this;this._uiTweenVo||(this._uiTweenVo=new UiTweenVo,this._uiTweenVo.ui=a,this._uiTweenVo.scale=1,TweenMoveTo(this._uiTweenVo,.07,{scale:1.2,onComplete:function(){b.changeButScale()}}))},a.prototype.changeButScale=function(){var a=this;this._uiTweenVo.scale=1.2,TweenMoveTo(this._uiTweenVo,.05,{scale:1,onComplete:function(){a.changeButEnd()}})},a.prototype.changeButEnd=function(){this._uiTweenVo.destory(),this._uiTweenVo=null},a}(),UIManager=function(){function a(){this._eventItem=new Array,this.lastTime=0,Scene_data.uiStage=new UIStage,Scene_data.uiBlankStage=new UIStage,this._canvas=document.createElement("canvas"),this._canvas.style.zIndex="3",this._canvas.width=200,this._canvas.height=200,this._canvas.style.left=200,this._canvas.style.top=300,this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline=TextAlign.TOP}return a.getInstance=function(){var b=this;return this._instance||(this._instance=new a,a.popClikNameFun=function(a,c){void 0===c&&(c=0),b.uiClikName(a,c)}),this._instance},a.uiClikName=function(a,b){},a.prototype.getContext2D=function(a,b,c){return void 0===c&&(c=!0),this._canvas.width=a,this._canvas.height=b,this._ctx.clearRect(0,0,a,b),c=!0,c&&(this._ctx.textBaseline=TextAlign.TOP,this._ctx.textAlign=TextAlign.LEFT),this._ctx},a.prototype.getGrayImageDatabyImg=function(b){var c=a.getInstance().getContext2D(b.width,b.height,!1);c.drawImage(b,0,0);for(var d,e=c.getImageData(0,0,b.width,b.height),f=0;f<e.data.length;f+=4)d=Math.floor(.3*e.data[f+0])+Math.floor(.59*e.data[f+1])+Math.floor(.11*e.data[f+2]),e.data[f+0]=d,e.data[f+1]=d,e.data[f+2]=d;return e},a.prototype.makeCtxToGray=function(a,b){for(var c,d=a.getImageData(b.x,b.y,b.width,b.height),e=0;e<d.data.length;e+=4)c=Math.floor(.3*d.data[e+0])+Math.floor(.59*d.data[e+1])+Math.floor(.11*d.data[e+2]),c=.5*c+.5,d.data[e+0]=c,d.data[e+1]=c,d.data[e+2]=c;a.putImageData(d,b.x,b.y)},a.prototype.showCanvas=function(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this._canvas.style.left=a,this._canvas.style.top=b,document.getElementById("root").appendChild(this._canvas)},a.prototype.init=function(){ProgrmaManager.getInstance().registe(UIShader.UI_SHADER,new UIShader),ProgrmaManager.getInstance().registe(UIImageShader.UI_IMG_SHADER,new UIImageShader),ProgrmaManager.getInstance().registe(UIMaskShader.UI_MASK_SHADER,new UIMaskShader),ProgrmaManager.getInstance().registe(Movie2DShader.MOVIE2D_SHADER,new Movie2DShader),ProgrmaManager.getInstance().registe(Sprite2DShader.SPRITE2D_SHADER,new Sprite2DShader),this._uiList=new Array,this._containerList=new Array,UIData.setDesignWH(960,540)},a.prototype.addUI=function(a){for(var b=0,c=this._uiList.length-1;c>=0;c--)if(this._uiList[c].sortnum<=a.sortnum){b=c+1;break}this._uiList.splice(b,0,a),a.rendering=!0},a.prototype.removeUI=function(a){var b=this._uiList.indexOf(a);a.rendering=!1,-1!=b&&this._uiList.splice(b,1)},a.prototype.addUIContainer=function(a){if(!a.hasStage){this._containerList.push(a),a.resize();for(var b=0;b<a.renderList.length;b++)this.addUI(a.renderList[b]);a.hasStage=!0}},a.prototype.removeAll=function(){for(;this._containerList.length;)this.removeUIContainer(this._containerList[this._containerList.length-1])},a.prototype.removeUIContainer=function(a){if(a.hasStage){var b=this._containerList.indexOf(a);a.hasStage=!1,-1!=b&&this._containerList.splice(b,1);for(var c=0;c<a.renderList.length;c++)this.removeUI(a.renderList[c])}},a.prototype.hasWindowUI=function(){for(var a=0;a<this._containerList.length;a++)if(this._containerList[a]instanceof WindowUi)return!0;return!1},a.prototype.resize=function(){if(this._uiList){UIData.resize();for(var a=0;a<this._uiList.length;a++)this._uiList[a].resize();for(var a=0;a<this._containerList.length;a++)this._containerList[a].resize()}},a.prototype.upBgGroundZero=function(){for(var a=0;a<this._uiList.length;a++)-1==this._uiList[a].container.layer&&this._uiList[a].update()},a.prototype.update=function(){for(var a=0;a<this._uiList.length;a++)this._uiList[a].container.layer>=0&&this._uiList[a].update()},a.prototype.regEvent=function(a){},a.prototype.onTouch=function(a){this.interactiveEvent(a)},a.prototype.onMouse=function(a){this.interactiveEvent(a)},a.prototype.interactiveEvent=function(a){var b,c=new Vector2D;if(a instanceof MouseEvent)a.type==MouseType.MouseDown?b=new InteractiveEvent(InteractiveEvent.Down):a.type==MouseType.MouseUp?b=new InteractiveEvent(InteractiveEvent.Up):a.type==MouseType.MouseMove?b=new InteractiveEvent(InteractiveEvent.Move):a.type==MouseType.MouseClick,c.x=a.pageX,c.y=a.pageY;else if(a.type==MouseType.TouchStart?(b=new InteractiveEvent(InteractiveEvent.Down),a.touches.length>1?(c.x=a.touches[a.touches.length-1].pageX,c.y=a.touches[a.touches.length-1].pageY):(c.x=a.pageX,c.y=a.pageY)):a.type==MouseType.TouchEnd?(b=new InteractiveEvent(InteractiveEvent.Up),c.x=a.changedTouches[0].pageX,c.y=a.changedTouches[0].pageY):a.type==MouseType.TouchMove&&(a.touches.length>1?(b=new InteractiveEvent(InteractiveEvent.Pinch),b.data=MathClass.math_distance(a.touches[0].clientX,a.touches[0].clientY,a.touches[1].clientX,a.touches[1].clientY)/this.lastSwipeDis,b.roation=180*(Math.atan2(a.touches[1].clientY-a.touches[0].clientY,a.touches[1].clientX-a.touches[0].clientX)-this.lastSwipeRot)/Math.PI):b=new InteractiveEvent(InteractiveEvent.Move),c.x=a.pageX,c.y=a.pageY),a.touches.length)for(var d=0;d<a.touches.length;d++)c.x=a.touches[d].clientX,c.y=a.touches[d].clientY;this.mouseEvetData(b,c)},a.prototype.disMoveNnum=function(a,b){return Vector2D.distance(a,this.lastMousePos)<b},a.prototype.mouseEvetData=function(b,c){a.cando=!0,Scene_data.verticalScene?(b.x=c.y,b.y=Scene_data.stageHeight-c.x):(b.x=c.x,b.y=c.y);var d=!1;if(!d)for(var e=this._uiList.length-1;e>=0;e--)if(this._uiList[e]&&0==this._uiList[e].container.interfaceUI&&this._uiList[e]&&this._uiList[e].interactiveEvent(b)){d=!0;break}if(!d)for(var e=this._uiList.length-1;e>=0;e--)if(this._uiList[e]&&1==this._uiList[e].container.interfaceUI&&this._uiList[e]&&this._uiList[e].interactiveEvent(b)){d=!0;break}if(b.type==InteractiveEvent.Down){this.lastMousePos=new Vector2D(b.x,b.y);var f=TimeUtil.getTimer()-this.lastTime;if(200>f)return!0;this.lastTime=TimeUtil.getTimer()}var g=Scene_data.uiStage.interactiveEvent(b);return d?!0:(Scene_data.uiBlankStage.interactiveEvent(b),g)},a.prototype.setUseMouseEventCon=function(a){this._eventItem.length=0,a&&this._eventItem.push(a)},a.prototype.getcurrentList=function(){for(var a=new Array,b=this._uiList.length-1;b>0;b--)if(this._eventItem.length)for(var c=0;c<this._eventItem.length;c++)this._eventItem[c]!=this._uiList[b].container||(a.push(this._uiList[b]),c=this._eventItem.length);else a.push(this._uiList[b]);return a},a.cando=!0,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UILoading=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b.initData(),b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.initData=function(){var a=this;this.atls=new UIAtlas,this.atls.configData=new Array,this.atls.configData.push(this.atls.getObject("load",0,0,256,256,256,256,4,4)),this.atls.loadImgUrl("ui/load/ui_loding.png",function(){a.loadCom()})},b.prototype.loadCom=function(){this._render=new UIRenderComponent,this._render.uiAtlas=this.atls;var a=this._render.createFrame("load");this.addChild(a),a.speed=1,a.width=100,a.height=100,a.x=(UIData.designWidth-a.width)/2,a.y=(UIData.designHeight-a.height)/2,this.addRender(this._render)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIStage=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.interactiveEvent=function(a){var b=a.type,c=this._eventsMap;if(!c)return!1;var d=c[b];if(!d)return!1;var e=d.length;if(0==e)return!1;for(var f=e-1;f>=0;f--){var g=d[f];g.listener.call(g.thisObject,a)}return!0},b}(EventDispatcher),PuiData=function(){function a(){}return a.A_HIGHT_F="A_hight_f",a.TAB_HIGHT="Tab_hight",a.A_HIGHT_C="A_hight_c",a.A_DELETEBTN="A_deletebtn",a.A_ZHENQI="A_zhenqi",a.A_SHOULING="A_SHOULING",a.A_JINGHUA="A_JINGHUA",a.A_JIANTOU="A_jiantou",a.A_WUPINKUANG="A_wupinkuang",a.A_BLACK_C="A_black_c",a.A_BLACK_F="A_black_f",a.A_BLACK_START="A_black_start",a.A_HIGHT_START="A_hight_start",a.A_BLACK_BASE="A_black_base ",a.A_RED_POINT="A_red_point",a.A_YINBI="A_yinbi",a.A_YUANBAO="A_yuanbao",a.A_BANGGONG="A_banggong",a.A_DOUHUN="A_DOUHUN",a.A_EXP="A_EXP",a.A_HONOR="A_HONOR",a.A_BANGYUAN="A_bangyuan",a.A_RIGHT_XING="A_RIGHT_XING",a.A_SSTART="A_SSTART",a.A_LEFT_XING="A_LEFT_XING",a.A_GOODS_PURPLE="A_GOODS_PURPLE",a.A_GOODS_BLUE="A_GOODS_BLUE",a.A_GOODS_RED="A_GOODS_RED",a.A_GOODS_GREEN="A_GOODS_GREEN",a.A_GOODS_WHITE="A_GOODS_WHITE",a.A_GOODS_ORANGE="A_GOODS_ORANGE",a.A_START_BG="A_START_BG",a.A_START="A_START",a.A_CHAIN="A_CHAIN",a.A_OK="A_OK",a.A_QIANWANG="A_QIANWANG",a.T_LEFT="T_LEFT",a.T_MID="T_MID",a.T_RIGHT="T_RIGHT",a.E_LEFT="E_LEFT",a.E_MID="E_MID",a.E_RIGHT="E_RIGHT",a.F_LEFT="F_LEFT",a.F_MID="F_MID",a.F_RIGHT="F_RIGHT",a.A_F_22="A_F_22",a.A_BLACK_BASE_66="A_BLACK_BASE_66 ",a.A_HIGHR_C_66="A_HIGHR_C_66",a.A_V="A_V",a.A_GIVING_BG="A_GIVING_BG",a.B_SUB="B_SUB",a.A_FACTION_ICON="A_FACTION_ICON",a.SELECT_1="SELECT_1",a.SELECT_0="SELECT_0",a.A_JIE="A_JIE",a.A_XING="A_XING",a.T_tips_txt_bg="T_tips_txt_bg",a.ITEMBG="ITEMBG",a.A_quest_top="A_quest_top",a.A_quest_mid="A_quest_mid",a.A_quest_bottom="A_quest_bottom",a.A_quest_ion0="A_quest_ion0",a.A_quest_ion1="A_quest_ion1",a.A_quest_ion2="A_quest_ion2",a.A_quest_ion3="A_quest_ion3",a.A_quest_finish="A_quest_finish",a.A_zhanli_label="A_zhanli_label",a.A_gou="A_gou",a.A_cha="A_cha",a.TYPE3="TYPE3",a.TYPE5="TYPE5",a.TYPE9="TYPE9",a.TYPE7="TYPE7",a.B_ZHUFUZHI="B_ZHUFUZHI",a.B_DABAOJI="B_DABAOJI",a.B_XIAOBAOJI="B_XIAOBAOJI",a.B_JINGYAN="B_JINGYAN",a.NewPicBg="NewPicBg",a.Select="Select",a.CostBg="CostBg",a.BG2="BG2",a.PropBg40="PropBg40",a.PropBg60="PropBg60",a.PropBg100="PropBg100",a.REWARD_BG1="REWARD_BG1",a.SKILL_BG68="SKILL_BG68",a.SKILL_BG58="SKILL_BG58",a.BG6="BG6",a.Slist_nselect="Slist_nselect",a.Slist_select="Slist_select",a.TXTBG="TXTBG",a.ARROW_TOP="ARROW_TOP",a.ARROW_RIGHT="ARROW_RIGHT",a.MASK="MASK",a.BTNADD="BTNADD",a.BOSSBG76="BOSSBG76",a.BOSSBG64="BOSSBG64",a.CIRCL74="CIRCL74",a.LISTITEMBG="LISTITEMBG",a.ADDITEM="ADDITEM",a.HASSEL="HASSEL",a.SKILL_LEV_BG="SKILL_LEV_BG",
a.TITLEBG="TITLEBG",a.TITLEHIGHT="TITLEHIGHT",a.NEWLISTITEMBG="NEWLISTITEMBG",a.CHATBG="CHATBG",a.ITEMBIGBG="ITEMBIGBG",a.I1bg_2="I1bg_2",a.I1bg_1="I1bg_1",a.ARROWUP="ARROWUP",a.ARROWDOWN="ARROWDOWN",a.A_EQULEVBG="A_EQULEVBG",a.DISABLE="DISABLE",a.EQUBG="EQUBG",a.RESLISTBG="RESLISTBG",a.A_CARD_C="A_CARD_C",a.A_CARD_G="A_CARD_G",a.A_CARD_B="A_CARD_B",a.RESBG="RESBG",a.STATEUP_LISTBG="STATEUP_LISTBG",a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),TextureRes=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.destory=function(){Scene_data.context3D.deleteTexture(this.texture)},b}(ResCount),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),TextureManager=function(a){function b(){var b=a.call(this)||this;return b._loadDic=new Object,b._resDic=new Object,b.initDefaultLightMapTexture(),b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.hasTexture=function(a){return this._dic[a]?!0:!1},b.prototype.getTexture=function(a,b,c,d,e,f){var g=this;if(void 0===c&&(c=0),void 0===d&&(d=null),void 0===e&&(e=0),void 0===f&&(f=0),this._dic[a])return d?b(this._dic[a],d):b(this._dic[a]),void this._dic[a].useNum++;var h=new TextureLoad(b,d,a,c,e,f);if(this._loadDic[a]){var i=this._loadDic[a];return void i.push(h)}this._loadDic[a]=new Array,this._loadDic[a].push(h),this._resDic[a]?(this.loadTextureCom(this._resDic[a],h),delete this._resDic[a]):LoadManager.getInstance().load(a,LoadManager.IMG_TYPE,function(a,b){g.loadTextureCom(a,b)},h)},b.prototype.getImageData=function(a,b){LoadManager.getInstance().load(a,LoadManager.IMG_TYPE,function(a){var c=UIManager.getInstance().getContext2D(a.width,a.height,!1);c.drawImage(a,0,0,a.width,a.height);var d=c.getImageData(0,0,a.width,a.height);b(d)})},b.prototype.addRes=function(a,b){this._dic[a]||this._resDic[a]||(this._resDic[a]=b)},b.prototype.getCanvasTexture=function(a){var b=new TextureRes,c=Scene_data.context3D.getTexture(a.canvas,0,0);return b.texture=c,b},b.prototype.getImageDataTexture=function(a){var b=Scene_data.context3D.getTexture(a,0,0);return b},b.prototype.getTextureRes=function(a){var b=new TextureRes,c=Scene_data.context3D.getTexture(a,0,0);return b.texture=c,b},b.prototype.updateTexture=function(a,b,c,d){Scene_data.context3D.updateTexture(a,b,c,d.canvas)},b.prototype.loadCubeTexture=function(a,b){var c=new CubemapLoad;c.loadCube(a,function(a){b(a)})},b.prototype.loadTextureCom=function(a,b){var c=Scene_data.context3D.getTexture(a,b.wrap,b.filter,b.mipmap),d=new TextureRes;d.texture=c,d.width=a.width,d.height=a.height;for(var e=this._loadDic[b.url],f=0;f<e.length;f++)e[f].info?e[f].fun(d,e[f].info):e[f].fun(d),d.useNum++;delete this._loadDic[b.url],this._dic[b.url]=d},b.prototype.initDefaultLightMapTexture=function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.width=32,a.height=32,b.fillStyle="rgb(51,51,51)",b.fillRect(0,0,32,32),this.defaultLightMap=Scene_data.context3D.getTexture(a)},b.prototype.gc=function(){a.prototype.gc.call(this)},b}(ResGC),TextureLoad=function(){function a(a,b,c,d,e,f){this.fun=a,this.info=b,this.url=c,this.wrap=d,this.filter=e,this.mipmap=f}return a}(),CubemapLoad=function(){function a(){this.ary=new Array(6),this.flagNum=0}return a.prototype.loadCube=function(a,b){var c=this;this.fun=b;for(var d=0;6>d;d++){var e=a+"0"+(d+1)+".jpg";LoadManager.getInstance().load(e,LoadManager.IMG_TYPE,function(a,b){c.loadCom(a,b)},{id:d})}},a.prototype.loadCom=function(a,b){var c=a.width/4,d=document.createElement("canvas"),e=d.getContext("2d");d.width=c,d.height=c;var f=Scene_data.context3D.renderContext,g=f.createTexture();f.bindTexture(f.TEXTURE_CUBE_MAP,g),e.drawImage(a,2*c,c,c,c,0,0,c,c),f.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,d),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),e.drawImage(a,0,c,c,c,0,0,c,c),f.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_X,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,d),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),e.drawImage(a,c,0,c,c,0,0,c,c),f.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Y,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,d),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),e.drawImage(a,c,2*c,c,c,0,0,c,c),f.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,d),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),e.drawImage(a,c,c,c,c,0,0,c,c),f.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Z,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,d),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),e.drawImage(a,3*c,c,c,c,0,0,c,c),f.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,d),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),this.ary[b.id]=g,this.flagNum++,6==this.flagNum&&this.fun(this.ary)},a}(),ConstItem=function(){function a(){this.value=new Vector3D,this.offset=0}return Object.defineProperty(a.prototype,"id",{get:function(){return this._id},set:function(a){this._id=a,this.name="fc"+a,this.offset=4*a},enumerable:!0,configurable:!0}),a.prototype.creat=function(a){this.vecNum=a,this.vecNum[0+this.offset]=this.value.x,this.vecNum[1+this.offset]=this.value.y,this.vecNum[2+this.offset]=this.value.z,this.vecNum[3+this.offset]=this.value.w},a.prototype.setData=function(a){this.id=a.id,this.value=new Vector3D(a.value.x,a.value.y,a.value.z,a.value.w),this.paramName0=a.paramName0,this.param0Type=a.param0Type,this.param0Index=a.param0Index,this.paramName1=a.paramName1,this.param1Type=a.param1Type,this.param1Index=a.param1Index,this.paramName2=a.paramName2,this.param2Type=a.param2Type,this.param2Index=a.param2Index,this.paramName3=a.paramName3,this.param3Type=a.param3Type,this.param3Index=a.param3Index},a.prototype.setDynamicOffset=function(a){this.paramName0==a.paramName?a.targetOffset=this.param0Index+this.offset:this.paramName1==a.paramName?a.targetOffset=this.param1Index+this.offset:this.paramName2==a.paramName?a.targetOffset=this.param2Index+this.offset:this.paramName3==a.paramName&&(a.targetOffset=this.param3Index+this.offset)},a.prototype.setDynamicDirect=function(a,b){this.vecNum.set(a,b)},a.prototype.setDynamic=function(a){try{this.vecNum.set(a.currentValue,a.targetOffset)}catch(b){console.log("在此处理错误2")}},a}(),TexItem=function(){function a(){}return a.prototype.destory=function(){this.textureRes&&this.textureRes.clearUseNum()},Object.defineProperty(a.prototype,"id",{get:function(){return this._id},set:function(a){this._id=a,this.name="fs"+a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),a.LIGHTMAP=1,a.LTUMAP=2,a.CUBEMAP=3,a.HEIGHTMAP=4,a.REFRACTIONMAP=5,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Material=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.texList=new Array,b.constList=new Array,b.killNum=0,b.writeZbuffer=!0,b.fogMode=0,b.fcNum=0,b}return __extends(b,a),b.prototype.update=function(a){this.updateTime(a),this.updateScene()},b.prototype.updateTime=function(a){this.hasTime&&(this.fcData[1]=a)},b.prototype.updateCam=function(a,b,c){if(this.usePbr||1==this.fogMode){var d=4*this.fcIDAry[0];this.fcData[0+d]=a,this.fcData[1+d]=b,this.fcData[2+d]=c}},b.prototype.updateScene=function(){if(this.sceneNumId!=Scene_data.sceneNumId){if(this.sceneNumId=Scene_data.sceneNumId,0!=this.fogMode){var a=4*this.fcIDAry[1];this.fcData[0+a]=Scene_data.fogColor[0],this.fcData[1+a]=Scene_data.fogColor[1],this.fcData[2+a]=Scene_data.fogColor[2]}if(this.scaleLightMap){var a=4*this.fcIDAry[2];this.fcData[0+a]=Scene_data.scaleLight[0]}}},b.prototype.initFcData=function(){if(this.fcData=new Float32Array(4*this.fcNum),!(this.fcNum<=0)){if(this.sceneNumId=Scene_data.sceneNumId,(this.hasTime||this.useKill||0!=this.fogMode)&&(this.useKill&&(this.fcData[0]=this.killNum),0!=this.fogMode&&(this.fcData[2]=Scene_data.fogData[0],this.fcData[3]=Scene_data.fogData[1])),this.usePbr||1==this.fogMode){var a=4*this.fcIDAry[0];this.fcData[0+a]=Scene_data.cam3D.x/100,this.fcData[1+a]=Scene_data.cam3D.y/100,this.fcData[2+a]=Scene_data.cam3D.z/100}if(0!=this.fogMode){var a=4*this.fcIDAry[1];this.fcData[0+a]=Scene_data.fogColor[0],this.fcData[1+a]=Scene_data.fogColor[1],this.fcData[2+a]=Scene_data.fogColor[2]}if(this.scaleLightMap){var a=4*this.fcIDAry[2];this.fcData[0+a]=Scene_data.scaleLight[0]}}},b.prototype.setCompileData=function(a){if(a){if(this.shaderStr=a.shaderStr,this.hasTime=a.hasTime,this.timeSpeed=a.timeSpeed,this.blendMode=a.blendMode,this.backCull=a.backCull,this.killNum=a.killNum,this.hasVertexColor=a.hasVertexColor,this.usePbr=a.usePbr,this.useNormal=a.useNormal,this.roughness=a.roughness,this.writeZbuffer=a.writeZbuffer,this.hasFresnel=a.hasFresnel,this.useDynamicIBL=a.useDynamicIBL,this.normalScale=a.normalScale,this.lightProbe=a.lightProbe,this.useKill=a.useKill,this.directLight=a.directLight,this.noLight=a.noLight,this.scaleLightMap=a.scaleLightMap,this.fogMode=a.fogMode,this.hasParticleColor=!1,this.initFcData(),a.texList){var b=a.texList;this.texList=new Array;for(var c=0;c<b.length;c++){var d=new TexItem;d.id=b[c].id,d.url=b[c].url,d.isDynamic=b[c].isDynamic,d.paramName=b[c].paramName,d.isMain=b[c].isMain,d.isParticleColor=b[c].isParticleColor,d.type=b[c].type,d.wrap=b[c].wrap,d.filter=b[c].filter,d.mipmap=b[c].mipmap,this.texList.push(d),d.isParticleColor&&(this.hasParticleColor=!0)}}if(a.constList)for(b=a.constList,this.constList=new Array,c=0;c<b.length;c++){var e=new ConstItem;e.setData(b[c]),e.creat(this.fcData),this.constList.push(e)}}},b.prototype.setByteData=function(a){var b=a,c=b.readInt();if(this.shaderStr=b.readUTF(),this.hasTime=b.readBoolean(),this.timeSpeed=b.readFloat(),this.blendMode=b.readFloat(),this.backCull=b.readBoolean(),this.killNum=b.readFloat(),this.hasVertexColor=b.readBoolean(),this.usePbr=b.readBoolean(),this.useNormal=b.readBoolean(),this.roughness=b.readFloat(),this.writeZbuffer=b.readBoolean(),this.hasFresnel=b.readBoolean(),this.useDynamicIBL=b.readBoolean(),this.normalScale=b.readFloat(),this.lightProbe=b.readBoolean(),this.useKill=b.readBoolean(),this.directLight=b.readBoolean(),this.noLight=b.readBoolean(),this.scaleLightMap=b.readBoolean(),c>2&&(this.fogMode=b.readInt()),c>=22){this.fcNum=b.readByte();var d=b.readByte();this.fcIDAry=new Array;for(var e=0;d>e;e++)this.fcIDAry.push(b.readByte())}this.hasParticleColor=!1,this.initFcData(),this.readTexList(b),this.readConstLis(b)},b.prototype.readConstLis=function(a){var b=a.readInt();this.constList=new Array;for(var c=0;b>c;c++){var d=new ConstItem;d.id=a.readFloat(),d.value=new Vector3D(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat()),d.paramName0=a.readUTF(),d.param0Type=a.readFloat(),d.param0Index=a.readFloat(),d.paramName1=a.readUTF(),d.param1Type=a.readFloat(),d.param1Index=a.readFloat(),d.paramName2=a.readUTF(),d.param2Type=a.readFloat(),d.param2Index=a.readFloat(),d.paramName3=a.readUTF(),d.param3Type=a.readFloat(),d.param3Index=a.readFloat(),d.creat(this.fcData),this.constList.push(d)}},b.prototype.readTexList=function(a){var b=a.readInt();this.texList=new Array;for(var c=0;b>c;c++){var d=new TexItem;d.id=a.readFloat(),d.url=a.readUTF(),d.isDynamic=a.readBoolean(),d.paramName=a.readUTF(),d.isMain=a.readBoolean(),d.isParticleColor=a.readBoolean(),d.type=a.readFloat(),d.wrap=a.readFloat(),d.filter=a.readFloat(),d.mipmap=a.readFloat(),d.isParticleColor&&(this.hasParticleColor=!0),this.texList.push(d)}},b.prototype.destory=function(){for(var a=0;a<this.texList.length;a++)this.texList[a].destory();this.texList=null,this.constList=null,this.shader&&this.shader.clearUseNum()},b}(ResCount),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MaterialManager=function(a){function b(){var b=a.call(this)||this;return b._loadDic=new Object,b._resDic=new Object,b._regDic=new Object,b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.getMaterialByte=function(a,b,c,d,e,f){var g=this;if(void 0===c&&(c=null),void 0===d&&(d=!1),void 0===e&&(e=null),void 0===f&&(f=null),this._dic[a])return c?b(this._dic[a],c):b(this._dic[a]),void this._dic[a].useNum++;var h=new MaterialLoad(b,c,a,d,e,f);if(this._loadDic[a]){var i=this._loadDic[a];return void i.push(h)}this._loadDic[a]=new Array,this._loadDic[a].push(h),this._resDic[a]?(this.meshByteMaterialByt(this._resDic[a],h),this._regDic[a]&&(this._dic[a].useNum+=this._regDic[a],delete this._regDic[a]),delete this._resDic[a]):LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(a,b){g.loadMaterialByteCom(a,b)},h)},b.prototype.meshByteMaterialByt=function(a,b){var c=new Material;c.setByteData(a),c.url=b.url,this.loadMaterial(c),b.autoReg&&(c.shader=ProgrmaManager.getInstance().getMaterialProgram(b.regName,b.shader3D,c,null,!0),c.program=c.shader.program);for(var d=this._loadDic[b.url],e=0;e<d.length;e++)d[e].info?d[e].fun(c,d[e].info):d[e].fun(c),c.useNum++;delete this._loadDic[b.url],this._dic[b.url]=c},b.prototype.loadMaterialByteCom=function(a,b){var c=new ByteArray(a);this.meshByteMaterialByt(c,b)},b.prototype.addResByte=function(a,b){this._dic[a]||this._resDic[a]||(this._resDic[a]=b)},b.prototype.registerUrl=function(a){a=a.replace("_byte.txt",".txt"),a=a.replace(".txt","_byte.txt"),this._dic[a]?this._dic[a].useNum++:this._regDic[a]?this._regDic[a]++:1==this._regDic[a]},b.prototype.releaseUrl=function(a){a=a.replace("_byte.txt",".txt"),a=a.replace(".txt","_byte.txt"),this._dic[a]&&this._dic[a].clearUseNum()},b.prototype.loadMaterial=function(a){for(var b=a.texList,c=0;c<b.length;c++)b[c].isParticleColor||b[c].isDynamic||0!=b[c].type||TextureManager.getInstance().getTexture(Scene_data.fileRoot+b[c].url,function(a,b){b.textureRes=a},b[c].wrap,b[c],b[c].filter,b[c].mipmap)},b.prototype.loadDynamicTexUtil=function(a){for(var b=a.dynamicTexList,c=0;c<b.length;c++)b[c].isParticleColor?b[c].creatTextureByCurve():TextureManager.getInstance().getTexture(Scene_data.fileRoot+b[c].url,function(a,b){b.textureRes=a},0,b[c],0,1)},b.prototype.gc=function(){a.prototype.gc.call(this)},b}(ResGC),MaterialLoad=function(){function a(a,b,c,d,e,f){this.fun=a,this.info=b,this.url=c,this.autoReg=d,this.regName=e,this.shader3D=f}return a}(),DynamicBaseConstItem=function(){function a(){}return a.prototype.update=function(a){void 0===a&&(a=0),this.target&&this.target.setDynamic(this)},Object.defineProperty(a.prototype,"type",{get:function(){return this._type},set:function(a){this._type=a},enumerable:!0,configurable:!0}),a.prototype.setTargetInfo=function(a,b,c){this.target=a,this.paramName=b,this.type=c,this.target.setDynamicOffset(this),this.currentValue=new Array(c)},a.prototype.setCurrentVal=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];for(var c=0;c<a.length;c++)this.currentValue[c]=a[c]},a}(),DynamicBaseTexItem=function(){function a(){}return a.prototype.destory=function(){this.textureRes&&this.textureRes.useNum--,this.target=null},Object.defineProperty(a.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MaterialBaseParam=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.destory=function(){for(var a=0;a<this.dynamicTexList.length;a++)this.dynamicTexList[a].destory();this.dynamicTexList=null,this.dynamicConstList=null},b.prototype.update=function(){if(this.material&&this.dynamicConstList)for(var a=0;a<this.dynamicConstList.length;a++)this.dynamicConstList[a].update()},b.prototype.setData=function(a,b){this.material=a,this.dynamicConstList=new Array,this.dynamicTexList=new Array;for(var c=a.constList,d=a.texList,e=0;e<b.length;e++){var f=b[e];if(0==f.type){var g=new DynamicBaseTexItem;g.paramName=f.name;for(var h=0;h<d.length;h++)if(g.paramName==d[h].paramName){g.target=d[h];break}var i=0;g.target&&(i=g.target.mipmap),i=0,TextureManager.getInstance().getTexture(Scene_data.fileRoot+f.url,function(a){g.textureRes=a},0,null,0,i),this.dynamicTexList.push(g)}else{for(var j=f.name,k=null,h=0;h<c.length;h++)if(j==c[h].paramName0||j==c[h].paramName1||j==c[h].paramName2||j==c[h].paramName3){k=c[h];break}var l=new DynamicBaseConstItem;l.setTargetInfo(k,j,f.type),1==f.type?l.setCurrentVal(f.x):2==f.type?l.setCurrentVal(f.x,f.y):l.setCurrentVal(f.x,f.y,f.z),this.dynamicConstList.push(l)}}},b}(GC),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MaterialParam=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.destory=function(){this.material.useNum--,this.shader.useNum--,a.prototype.destory.call(this)},b.prototype.setMaterial=function(a){this.material=a,this.materialUrl=a.url,this.dynamicTexList=new Array,this.dynamicConstList=new Array,this.setTexList(),this.setConstList()},b.prototype.setLife=function(a){for(var b=0;b<this.dynamicTexList.length;b++)this.dynamicTexList[b].isParticleColor&&(this.dynamicTexList[b].life=a)},b.prototype.setTexList=function(){for(var a=this.material.texList,b=0;b<a.length;b++){var c;a[b].isParticleColor?(c=new DynamicTexItem,c.target=a[b],c.paramName=a[b].paramName,c.initCurve(4),this.dynamicTexList.push(c),c.isParticleColor=!0):a[b].isDynamic&&(c=new DynamicTexItem,c.target=a[b],c.paramName=a[b].paramName,this.dynamicTexList.push(c))}},b.prototype.setConstList=function(){for(var a=this.material.constList,b=0;b<a.length;b++){var c,d=a[b];0!=d.param0Type&&(c=new DynamicConstItem,c.setTargetInfo(d,d.paramName0,d.param0Type),this.dynamicConstList.push(c)),0!=d.param1Type&&(c=new DynamicConstItem,c.setTargetInfo(d,d.paramName1,d.param1Type),this.dynamicConstList.push(c)),0!=d.param2Type&&(c=new DynamicConstItem,c.setTargetInfo(d,d.paramName2,d.param2Type),this.dynamicConstList.push(c)),0!=d.param3Type&&(c=new DynamicConstItem,c.setTargetInfo(d,d.paramName3,d.param3Type),this.dynamicConstList.push(c))}},b.prototype.setTextObj=function(a){for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<this.dynamicTexList.length;d++)if(this.dynamicTexList[d].paramName==c.paramName){this.dynamicTexList[d].isParticleColor?this.dynamicTexList[d].curve.setData(c.curve):this.dynamicTexList[d].url=c.url;break}},b.prototype.setConstObj=function(a){for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<this.dynamicConstList.length;d++)if(this.dynamicConstList[d].paramName==c.paramName){this.dynamicConstList[d].curve.setData(c.curve);break}},b}(MaterialBaseParam),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),DynamicConstItem=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.update=function(a){void 0===a&&(a=0),this.currentValue=this.curve.getValue(a),this.target.setDynamic(this)},Object.defineProperty(b.prototype,"type",{set:function(a){this._type=a,this.curve=new Curve,this.curve.type=a},enumerable:!0,configurable:!0}),b}(DynamicBaseConstItem),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),DynamicTexItem=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.destory=function(){a.prototype.destory.call(this),this._textureDynamic&&Scene_data.context3D.deleteTexture(this._textureDynamic),this.target=null},b.prototype.initCurve=function(a){this.curve=new Curve,this.curve.type=a},Object.defineProperty(b.prototype,"texture",{get:function(){return this._textureDynamic?this._textureDynamic:this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),b.prototype.creatTextureByCurve=function(){for(var a=0,b=this.curve.valueVec.length-1,c=new Array,a=0;a<this.life;a++)if(a<this.curve.begintFrame)c.push(255*this.curve.valueVec[0][0],255*this.curve.valueVec[0][1],255*this.curve.valueVec[0][2],255*this.curve.valueVec[0][3]);else if(a>this.curve.maxFrame)0==this.curve.maxFrame&&this.curve.begintFrame<0?c.push(255,255,255,255):c.push(255*this.curve.valueVec[b][0],255*this.curve.valueVec[b][1],255*this.curve.valueVec[b][2],255*this.curve.valueVec[b][3]);else if(this.curve.begintFrame<0)c.push(255,255,255,255);else{var d=a-this.curve.begintFrame;c.push(255*this.curve.valueVec[d][0],255*this.curve.valueVec[d][1],255*this.curve.valueVec[d][2],255*this.curve.valueVec[d][3])}var e=ColorTransition.getInstance().getImageDataByVec(c,this.life);this._textureDynamic=Scene_data.context3D.getTexture(e)},Object.defineProperty(b.prototype,"life",{get:function(){return this._life},set:function(a){this._life=a},enumerable:!0,configurable:!0}),b}(DynamicBaseTexItem),QuadTreeNode=function(){function a(a,b,c,d,e,f){this.x=a,this.y=b,this.z=c,this.width=d,this.height=e,this.depth=f}return a.prototype.testViewFrustum=function(a,b){if(this.sun&&1==this.sun.length)return void this.sun[0].testViewFrustum(a,b);if(this.testViewFrustumResult(a)&&(this.target&&(this.target.isPerspective?this.testRay(b)||(this.target.sceneVisible=!0):this.target.sceneVisible=!0),this.sun))for(var c=0;c<this.sun.length;c++)this.sun[c].testViewFrustum(a,b)},a.prototype.testViewFrustumResult=function(a){for(var b=new Vector3D(this.x,this.y,this.z),c=new Vector3D(this.width,this.height,this.depth),d=!0,e=0;e<a.length;e++){var f=b,g=b.add(c),h=new Vector3D;a[e].x>0?h.x=g.x:h.x=f.x,a[e].y>0?h.y=g.y:h.y=f.y,a[e].z>0?h.z=g.z:h.z=f.z;var i=a[e].dot(h)+a[e].w;if(0>i){d=!1;break}}return d},a.prototype.testRay=function(a){var b,c,d,e,f,g,h=a.o.x,i=a.o.y,j=a.o.z,k=a.d.x,l=a.d.y,m=a.d.z,n=this.x,o=this.y,p=this.z,q=this.x+this.width,r=this.y+this.height,s=this.z+this.depth,t=1/k;t>=0?(b=(n-h)*t,e=(q-h)*t):(b=(q-h)*t,e=(n-h)*t);var u=1/l;u>=0?(c=(o-i)*u,f=(r-i)*u):(c=(r-i)*u,f=(o-i)*u);var v=1/m;v>=0?(d=(p-j)*v,g=(s-j)*v):(d=(s-j)*v,g=(p-j)*v);var w,x;w=b>c?b:c,d>w&&(w=d),x=f>e?e:f,x>g&&(x=g);var y=1e-4,z=0;return x>w&&x>y?(z=w>y?w:x,z<a.baseT?!0:void 0):!1},a}(),Ray=function(){function a(){this.o=new Vector3D,this.d=new Vector3D,this.baseT=500}return a.prototype.setPos=function(a,b,c){this.o.x=a,this.o.y=b,this.o.z=c},a.prototype.setTarget=function(a,b,c){this.d.x=a-this.o.x,this.d.y=b-this.o.y,this.d.z=c-this.o.z,this.d.normalize()},a}(),SceneQuadTree=function(){function a(){this.needUpdata=!1,this.panleAry=new Array}return a.prototype.init=function(a,b){this._circle=new Circle(1e4,1e4),this._sceneDic=b,this._rootNode=this.getNode(a),this._ray=new Ray},a.prototype.getNode=function(a){var b=new QuadTreeNode(a.x,a.y,a.z,a.width,a.height,a.depth);if(a.data){b.sun||(b.sun=new Array);for(var c=0;c<a.data.length;c++){var d,e=new QuadTreeNode(a.data[c].x,a.data[c].y,a.data[c].z,a.data[c].width,a.data[c].height,a.data[c].depth);1==a.data[c].type?d="build"+a.data[c].id:11==a.data[c].type?d="particle"+a.data[c].id:14==a.data[c].type&&(d="ground"+a.data[c].id),e.target=this._sceneDic[d],e.target.aabb=e,b.sun.push(e)}}if(a.sun){b.sun||(b.sun=new Array);for(var c=0;c<a.sun.length;c++)b.sun.push(this.getNode(a.sun[c]))}return b},a.prototype.setCircle=function(a,b,c){var d=a-this._circle.x,e=b-this._circle.y;Math.sqrt(d*d+e*e)<10?this.needUpdata=!1:(this._circle.setData(a,b,c),this.needUpdata=!0)},a.prototype.update=function(){MathClass.GetViewHitBoxDataCopy(Scene_data.cam3D.distance);var a=new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z),b=MathClass.viewBoxVecItem;this.panleAry.length=0,this.panleAry.push(this.getPanelByVec(a,b[0],b[1])),this.panleAry.push(this.getPanelByVec(a,b[1],b[2])),this.panleAry.push(this.getPanelByVec(a,b[2],b[3])),this.panleAry.push(this.getPanelByVec(a,b[3],b[0])),this._ray.setPos(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z),this._ray.setTarget(Scene_data.focus3D.x,Scene_data.focus3D.y,Scene_data.focus3D.z),this._ray.baseT=Scene_data.cam3D.distance,this._rootNode.testViewFrustum(this.panleAry,this._ray)},a.prototype.getPanelByVec=function(a,b,c){var d=b.subtract(a),e=c.subtract(a);return d=d.cross(e),d.normalize(),d.w=-d.dot(a),d},a.prototype.updateDraw=function(){this.capsuleLineSprite?(this.capsuleLineSprite.x=Scene_data.focus3D.x,this.capsuleLineSprite.y=Scene_data.focus3D.y+50,this.capsuleLineSprite.z=Scene_data.focus3D.z,this.capsuleLineSprite.update()):(this.capsuleLineSprite=new LineDisplaySprite,this.capsuleLineSprite.clear(),this.capsuleLineSprite.baseColor=new Vector3D(1,0,0,1),this.drawCylinder(this._circle.radius,10),this.capsuleLineSprite.upToGpu())},a.prototype.drawCylinder=function(a,b){var c,d,e,f=a,g=b,h=12;for(e=0;h>e;e++){var i=new Vector3D(f,0,0),j=new Vector3D(f,+g,0),k=new Matrix3D;k.appendRotation(e*(360/h),Vector3D.Y_AXIS);var l=k.transformVector(i),m=k.transformVector(j);this.capsuleLineSprite.makeLineMode(l,m),this.capsuleLineSprite.makeLineMode(m,new Vector3D(0,+g,0)),e==h-1&&(this.capsuleLineSprite.makeLineMode(l,i),this.capsuleLineSprite.makeLineMode(m,j)),(c||d)&&(this.capsuleLineSprite.makeLineMode(l,c),this.capsuleLineSprite.makeLineMode(m,d)),c=l.clone(),d=m.clone()}},a}(),ViewFrustum=function(){function a(){}return a.prototype.init=function(){this.capsuleLineSprite=new LineDisplaySprite,SceneManager.getInstance().addDisplay(this.capsuleLineSprite)},a.prototype.setCam=function(){var a=Scene_data.cam3D.cameraMatrix.clone();a.append(Scene_data.viewMatrx3D);var b=a.m,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15];this.panleAry=new Array;this.getPanle(-k+o,-l+p,-m+q,-n+r),this.getPanle(g+o,h+p,i+q,j+r),this.getPanle(-g+o,-h+p,-i+q,-j+r),this.getPanle(c+o,d+p,e+q,f+r),this.getPanle(-c+o,-d+p,-e+q,-f+r)},a.prototype.getPanle=function(a,b,c,d){var e=new Vector3D(a,b,c,d);return e.normalize(),e},a.prototype.getPanelByVec=function(a,b,c){var d=b.subtract(a),e=c.subtract(a);return d=d.cross(e),d.normalize(),d.w=-d.dot(a),d},a.prototype.setData=function(a){this.dataAry=a},a.prototype.setViewFrustum=function(){this.capsuleLineSprite||this.init(),this.setCam(),this.capsuleLineSprite.clear(),this.capsuleLineSprite.baseColor=new Vector3D(0,0,1,1),MathClass.GetViewHitBoxDataCopy(Scene_data.cam3D.distance);var a=new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z),b=MathClass.viewBoxVecItem;this.panleAry.push(this.getPanelByVec(a,b[0],b[1])),this.panleAry.push(this.getPanelByVec(a,b[1],b[2])),this.panleAry.push(this.getPanelByVec(a,b[2],b[3])),this.panleAry.push(this.getPanelByVec(a,b[3],b[0]));for(var c=0;c<this.dataAry.length;c++){for(var d=this.dataAry[c],e=new Vector3D(d.x,d.y,d.z),f=new Vector3D(d.width,d.height,d.depth),g=!1,h=0;h<this.panleAry.length;h++){var i=e,j=e.add(f),k=new Vector3D;this.panleAry[h].x>0?k.x=j.x:k.x=i.x,this.panleAry[h].y>0?k.y=j.y:k.y=i.y,this.panleAry[h].z>0?k.z=j.z:k.z=i.z;var l=this.panleAry[h].dot(k)+this.panleAry[h].w;if(0>l){g=!0;break}}g?this.capsuleLineSprite.baseColor=new Vector3D(1,0,0,1):this.capsuleLineSprite.baseColor=new Vector3D(0,0,1,1),this.capsuleLineSprite.makeLineMode(e,new Vector3D(e.x+f.x,e.y,e.z)),this.capsuleLineSprite.makeLineMode(e,new Vector3D(e.x,e.y,e.z+f.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x+f.x,e.y,e.z),new Vector3D(e.x+f.x,e.y,e.z+f.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x,e.y,e.z+f.z),new Vector3D(e.x+f.x,e.y,e.z+f.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x,e.y+f.y,e.z),new Vector3D(e.x+f.x,e.y+f.y,e.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x,e.y+f.y,e.z),new Vector3D(e.x,e.y+f.y,e.z+f.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x+f.x,e.y+f.y,e.z),new Vector3D(e.x+f.x,e.y+f.y,e.z+f.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x,e.y+f.y,e.z+f.z),new Vector3D(e.x+f.x,e.y+f.y,e.z+f.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x,e.y,e.z),new Vector3D(e.x,e.y+f.y,e.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x+f.x,e.y,e.z),new Vector3D(e.x+f.x,e.y+f.y,e.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x,e.y,e.z+f.z),new Vector3D(e.x,e.y+f.y,e.z+f.z)),this.capsuleLineSprite.makeLineMode(new Vector3D(e.x+f.x,e.y,e.z+f.z),new Vector3D(e.x+f.x,e.y+f.y,e.z+f.z))}this.capsuleLineSprite.upToGpu()},a}(),SceneManager=function(){function a(){this._ready=!1,this.render=!0,this.test=!1,this._displayList=new Array,this._displaySpriteList=new Array,this._displayRoleList=new Array,this._display2DList=new Array,this._sceneParticleList=new Array,this._time=TimeUtil.getTimer(),this._sceneDic=new Object,this.initScene(),this.viewFrustum=new ViewFrustum}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},Object.defineProperty(a.prototype,"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"displayRoleList",{get:function(){return this._displayRoleList},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"displaySpriteList",{get:function(){return this._displaySpriteList},enumerable:!0,configurable:!0}),a.prototype.clearScene=function(){this._displayRoleList.length=0},a.prototype.clearStaticScene=function(){console.log("场景场景所有对象");for(var a in this._sceneDic){var b=this._sceneDic[a];b instanceof CombineParticle?(ParticleManager.getInstance().removeParticle(b),b.destory()):b instanceof Display3DSprite&&(b.removeStage(),b.destory())}this._ready=!1,this._sceneDic=null,this._sceneQuadTree=null,this._displayList.length=0,this._sceneParticleList.length=0,AstarUtil.porcessBak(!1)},a.prototype.testUrl=function(a){return this._currentUrl==a},a.prototype.loadScene=function(a,b,c,d){
var e=this;return this._currentUrl==a?(AstarUtil.porcessBak(!0),this._ready=!0,b(),void d()):(this.clearStaticScene(),this._ready=!1,ResManager.getInstance().loadSceneRes(a,b,c,function(a){e.loadSceneConfigCom(a),d()}),void(this._currentUrl=a))},a.prototype.addSceneImgBg=function(a){var b=new Display3dBg;b.setImgInfo(a.url,a.width,a.height),this.addDisplay(b)},a.prototype.getDisplayByID=function(a,b){return 0==a?this._sceneDic["build"+b]:1==a?this._sceneDic["particle"+b]:void 0},a.prototype.fixAstart=function(a){for(var b=0;b<this._displayRoleList.length;b++)this._displayRoleList[b].fixAstartData(a)},a.prototype.loadSceneConfigCom=function(a){this._sceneDic=new Object;var b=a.groundItem,c=a.buildItem;Scene_data.fogColor=[a.fogColor.x/255,a.fogColor.y/255,a.fogColor.z/255];var d=1*a.fogDistance,e=a.fogAttenuation;Scene_data.gameAngle=isNaN(a.gameAngle)?0:a.gameAngle,Scene_data.focus3D.rotationY=Scene_data.gameAngle,Scene_data.fogData=[d*e,1/((1-e)*d)],Scene_data.sceneNumId++;for(var f=0;b&&f<b.length;f++){var g=this.getGroundSprite(b[f],a.terrain);this.addDisplay(g)}for(var h=0;h<c.length;h++){var i=c[h];if(i.type==BaseRes.PREFAB_TYPE){var j=this.getBuildSprite(i);this.addDisplay(j)}else if(i.type==BaseRes.SCENE_PARTICLE_TYPE){var k=this.getParticleSprite(i);ParticleManager.getInstance().addParticle(k),this._sceneParticleList.push(k)}}Scene_data.light.setData(a.SunNrm,a.SunLigth,a.AmbientLight),LightProbeManager.getInstance().setLightProbeData(a.lightProbeItem),AstarUtil.setData(a.astar),this._ready=!0,a.quadTreeData?(this._sceneQuadTree=new SceneQuadTree,this._sceneQuadTree.init(a.quadTreeData,this._sceneDic)):this._sceneQuadTree=null,Scene_data.cam3D.astarRect=AstarUtil.areaRect},a.prototype.getGroundSprite=function(a,b){var c=new TerrainDisplay3DSprite;return c.setObjUrl(a.objsurl),c.setMaterialUrl(a.materialurl,a.materialInfoArr),c.materialInfoArr=a.materialInfoArr,c.setLightMapUrl(a.lighturl),c.scaleX=a.scaleX,c.scaleY=a.scaleY,c.scaleZ=a.scaleZ,c.x=a.x,c.y=a.y,c.z=a.z,c.rotationX=a.rotationX,c.rotationY=a.rotationY,c.rotationZ=a.rotationZ,c.objData.lightuvsOffsets=c.objData.uvsOffsets,b&&c.setGrounDataMesh(b[a.id]),this._sceneDic["ground"+a.id]=c,c},a.prototype.makeCollisioin=function(a){},Object.defineProperty(a.prototype,"ready",{get:function(){return this._ready},set:function(a){console.log("--setready--",a),this._ready=a},enumerable:!0,configurable:!0}),a.prototype.getBuildSprite=function(a){var b=new Display3DSprite;return b.setObjUrl(a.objsurl),b.setMaterialUrl(a.materialurl,a.materialInfoArr),b.materialInfoArr=a.materialInfoArr,b.setLightMapUrl(a.lighturl),b.scaleX=a.scaleX,b.scaleY=a.scaleY,b.scaleZ=a.scaleZ,b.x=a.x,b.y=a.y,b.z=a.z,b.rotationX=a.rotationX,b.rotationY=a.rotationY,b.rotationZ=a.rotationZ,b.isPerspective=a.isPerspective,b.type=0,b.id=a.id,this._sceneDic["build"+a.id]=b,b},a.prototype.getParticleSprite=function(a){var b;return b=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+a.url),b.scaleX=a.scaleX,b.scaleY=a.scaleY,b.scaleZ=a.scaleZ,b.x=a.x,b.y=a.y,b.z=a.z,b.rotationX=a.rotationX,b.rotationY=a.rotationY,b.rotationZ=a.rotationZ,b.type=0,this._sceneDic["particle"+a.id]=b,b},a.prototype.initScene=function(){},a.prototype.addDisplay=function(a){-1==this._displayList.indexOf(a)&&(this._displayList.push(a),a.addStage())},a.prototype.removeDisplay=function(a){var b=this._displayList.indexOf(a);-1!=b&&this._displayList.splice(b,1),a.removeStage()},a.prototype.addSpriteDisplay=function(a){if(-1==this._displaySpriteList.indexOf(a)){a.addStage();for(var b=0;b<this._displaySpriteList.length;b++)if(this._displaySpriteList[b].materialUrl==a.materialUrl)return void this._displaySpriteList.splice(b,0,a);this._displaySpriteList.push(a)}},a.prototype.removeSpriteDisplay=function(a){var b=this._displaySpriteList.indexOf(a);-1!=b&&this._displaySpriteList.splice(b,1),a.removeStage()},a.prototype.addMovieDisplay=function(a){this._displayRoleList.push(a),a.addStage()},a.prototype.addMovieDisplayTop=function(a){this._displayRoleList.unshift(a),a.addStage()},a.prototype.removeMovieDisplay=function(a){var b=this._displayRoleList.indexOf(a);-1!=b&&this._displayRoleList.splice(b,1),a.removeStage()},a.prototype.setParticleVisible=function(){for(var a=ParticleManager.getInstance().particleList,b=0;a&&b<a.length;b++)if(!a[b].dynamic&&a[b].bindVecter3d){var c=Vector3D.distance(new Vector3D(Scene_data.focus3D.x,Scene_data.focus3D.y,Scene_data.focus3D.z),new Vector3D(a[b].x,a[b].y,a[b].z));a[b].sceneVisible=1e3>c}},a.prototype.update=function(){if(!this.test){if(this._sceneQuadTree&&(this._sceneQuadTree.setCircle(Scene_data.focus3D.x,Scene_data.focus3D.z,a.mapQudaTreeDistance),this._sceneQuadTree.needUpdata)){for(var b=0;b<this._displayList.length;b++)this._displayList[b].sceneVisible=!1,this._displayList[b].sceneVisible=!0;this.setParticleVisible(),this._sceneQuadTree.update(),this.mathCamFar()}Scene_data.context3D.update(),Scene_data.context3D.setDepthTest(!0),this.updateMovieFrame(),MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D),this._ready&&(ParticleManager.getInstance().updateTime(),SkillManager.getInstance().update(),this.render&&(this.updateStaticDiplay(),this.updateSpriteDisplay(),Scene_data.context3D.setWriteDepth(!0),this.updateMovieDisplay(),ShadowManager.getInstance().update(),Scene_data.context3D.setWriteDepth(!1),ParticleManager.getInstance().update(),BloodManager.getInstance().update())),Scene_data.context3D.setDepthTest(!1),UIManager.getInstance().update();for(var b=0;b<this._display2DList.length;b++)this._display2DList[b].update()}},a.prototype.updateFBO=function(){Scene_data.fbo||(Scene_data.fbo=Scene_data.context3D.getFBO()),Scene_data.context3D.updateFBO(Scene_data.fbo),Scene_data.viewMatrx3D.identity(),Scene_data.context3D.renderContext.viewport(0,0,FBO.fw,FBO.fh),Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(2,1,50,Scene_data.camFar),Scene_data.viewMatrx3D.appendScale(2,2*(Scene_data.stageWidth/Scene_data.stageHeight),1),MathClass.updateVp(),this.updateStaticDiplay(),Engine.resetSize()},a.prototype.addDisplay2DList=function(a){this._display2DList.push(a)},a.prototype.mathCamFar=function(){for(var a=new Vector3D,b=0,c=0;c<this._displayList.length;c++){var d=this._displayList[c];if(d.sceneVisible&&d.aabb){var e=d.posMatrix.clone();e.append(Scene_data.cam3D.cameraMatrix);for(var f=d.aabbVect,g=0;g<f.length;g++)a=Scene_data.cam3D.cameraMatrix.transformVector(f[g]),a.z>b&&(b=a.z)}}Scene_data.camFar=Math.max(500,b+100),Engine.resetViewMatrx3D()},a.prototype.updateStaticDiplay=function(){for(var a=0;a<this._displayList.length;a++)this._displayList[a].update()},a.prototype.updateSpriteDisplay=function(){for(var a=0;a<this._displaySpriteList.length;a++)this._displaySpriteList[a].update()},a.prototype.updateMovieDisplay=function(){for(var a=0;a<this._displayRoleList.length;a++)this._displayRoleList[a].update()},a.prototype.updateMovieFrame=function(){var a=TimeUtil.getTimer(),b=a-this._time;this._time=a;for(var c=0;c<this._displayRoleList.length;c++)this._displayRoleList[c].updateFrame(b)},a.mapQudaTreeDistance=200,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillManager=function(a){function b(){var b=a.call(this)||this;return b._time=0,b._skillDic=new Object,b._loadDic=new Object,b._skillAry=new Array,b._preLoadDic=new Object,b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.update=function(){for(var a=TimeUtil.getTimer(),b=a-this._time,c=0;c<this._skillAry.length;c++)this._skillAry[c].update(b);this._time=a},b.prototype.preLoadSkill=function(a){var b=this;this._dic[a]||this._preLoadDic[a]||(ResManager.getInstance().loadSkillRes(Scene_data.fileRoot+a,function(c){var d=new SkillData;d.data=c.data,b._dic[a]=d}),this._preLoadDic[a]=!0)},b.prototype.getSkill=function(a,b){var c,d=this,e=a+b,f=this._skillDic[e];if(f)for(var g=0;g<f.length;g++)if(c=f[g],c.isDeath&&0==c.useNum)return c.reset(),c.isDeath=!1,c;if(c=new Skill,c.name=b,c.isDeath=!1,this._skillDic[e]||(this._skillDic[e]=new Array),this._skillDic[e].push(c),this._dic[a])return c.setData(this._dic[a].data[c.name],this._dic[a]),this._dic[a].useNum++,c;if(this._loadDic[a]){var h=new Object;return h.name=b,h.skill=c,this._loadDic[a].push(h),c}this._loadDic[a]=new Array;var h=new Object;return h.name=b,h.skill=c,this._loadDic[a].push(h),ResManager.getInstance().loadSkillRes(Scene_data.fileRoot+a,function(b){d.loadSkillCom(a,b)}),c},b.prototype.loadSkillCom=function(a,b){var c=new SkillData;c.data=b.data;for(var d=0;d<this._loadDic[a].length;d++){var e=this._loadDic[a][d];e.skill.setData(c.data[e.name],c),c.useNum++}this._loadDic[a].length=0,this._loadDic[a]=null,this._dic[a]=c},b.prototype.playSkill=function(a){this._skillAry.push(a),a.play()},b.prototype.removeSkill=function(a){var b=this._skillAry.indexOf(a);-1!=b&&this._skillAry.splice(b,1)},b.prototype.gc=function(){a.prototype.gc.call(this);for(var b in this._skillDic){for(var c=this._skillDic[b],d=c.length-1;d>=0;d--)c[d].isDeath&&c[d].useNum<=0&&(c[d].idleTime++,c[d].idleTime>=ResCount.GCTime&&(c[d].destory(),c.splice(d,1)));0==c.length&&(console.log("清理 -"+b),delete this._skillDic[b])}},b}(ResGC),ShockUtil=function(){function a(){var a=this;this.upFun=function(b){a.update(b)}}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.update=function(a){if(this.ctime+=a,this.ctime>this.time)return TimeUtil.removeFrameTick(this.upFun),void Scene_data.cam3D.offset.setTo(0,0,0);var b=(Math.random()-.5)*this.amp,c=(Math.random()-.5)*this.amp,d=(Math.random()-.5)*this.amp;Scene_data.cam3D.offset.setTo(b,c,d)},a.prototype.shock=function(a,b){this.time=a,this.ctime=0,this.amp=b,TimeUtil.addFrameTick(this.upFun)},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Skill=function(a){function b(){var b=a.call(this)||this;return b.isDeath=!0,b.time=0,b.targetFlag=0,b.targetShockFlag=0,b.needSound=!1,b}return __extends(b,a),b.prototype.setData=function(a,b){this.skillVo=new SkillVo,this.skillVo.setData(a),this.setKeyAry(),this.trajectoryAry=new Array,this._skillData=b},b.prototype.getBloodTime=function(){return this.skillVo?this.skillVo.bloodTime:SkillVo.defaultBloodTime},b.prototype.play=function(){if(!this.skillVo)return void this.skillComplete();if(this.active&&this.active instanceof Display3dMovie){var a=this.active;a.play(this.skillVo.action,2,!1)}},b.prototype.setKeyAry=function(){var a=this;if(this.keyAry=new Array,this.skillVo.types==SkillType.FixEffect)for(var b=0;b<this.skillVo.keyAry.length;b++){var c=new SkillFixEffect;c.setInfo(this.skillVo.keyAry[b]),c.removeCallFun=function(b){a.removeKey(b)},c.active=this.active,this.keyAry.push(c)}else if(this.skillVo.types==SkillType.TrajectoryDynamicTarget||this.skillVo.types==SkillType.TrajectoryDynamicPoint)for(var b=0;b<this.skillVo.keyAry.length;b++){var d,e=this.skillVo.keyAry[b];d=1==e.multype?new SkillMulTrajectory:new SkillTrajectory,d.setInfo(this.skillVo.keyAry[b]),this.keyAry.push(d)}},b.prototype.removeKey=function(a){this.completeNum++,this.completeNum==this.keyAry.length&&this.skillComplete()},b.prototype.removeSkillForce=function(){if(this.keyAry)for(var a=0;a<this.keyAry.length;a++)this.keyAry[a].reset();this.skillComplete(),this.reset()},b.prototype.skillComplete=function(){SkillManager.getInstance().removeSkill(this),this.isDeath=!0,this.completeFun&&this.completeFun(),this.idleTime=0},b.prototype.reset=function(){this.time=0,this.completeNum=0,this.active=null,this.completeFun=null,this.targetFlag=0,this.targetShockFlag=0,this.soundPlay=!1,this.needSound=!1},b.prototype.update=function(a){this.time+=a,this.time>b.MaxTime&&(console.log("超时结束"),this.skillComplete()),this.getKeyTarget(),this.getShockTarget(),this.updateTrajector(a)},b.prototype.updateTrajector=function(a){for(var b=0;b<this.trajectoryAry.length;b++)this.trajectoryAry[b].update(a)},b.prototype.getKeyTarget=function(){if(this.keyAry){for(var a=this.targetFlag;a<this.keyAry.length&&this.keyAry[a].time<this.time;a++){if(this.keyAry[a].addToRender(),this.skillVo.types==SkillType.TrajectoryDynamicTarget||this.skillVo.types==SkillType.TrajectoryDynamicPoint){var b=this.keyAry[a];this.trajectoryAry.push(b)}a++,this.targetFlag=a}this.getSound()}},b.prototype.getShockTarget=function(){if(this.skillVo.shockAry&&this.needSound)for(var a=this.targetShockFlag;a<this.skillVo.shockAry.length&&this.skillVo.shockAry[a].time<this.time;a++)ShockUtil.getInstance().shock(this.skillVo.shockAry[a].lasttime,this.skillVo.shockAry[a].amp),a++,this.targetShockFlag=a},b.prototype.getSound=function(){this.skillVo.sound&&!this.soundPlay&&this.needSound&&this.skillVo.sound.frame<this.time&&(SoundManager.getInstance().playSkillSound(this.skillVo.sound.url),this.soundPlay=!0)},b.prototype.configFixEffect=function(a,b,c){if(void 0===b&&(b=null),void 0===c&&(c=null),this.active=a,this.completeFun=b,this.keyAry)for(var d=0;d<this.keyAry.length;d++)if(this.skillVo.types==SkillType.FixEffect){var e=this.keyAry[d];e.active=a,c&&c.length?d>c.length-1?e.outPos=c[c.length-1]:e.outPos=c[d]:e.outPos=null}},b.prototype.configTrajectory=function(a,b,c,d,e){var f=this;if(void 0===c&&(c=null),void 0===d&&(d=0),void 0===e&&(e=null),this.active=a,this.completeFun=c,this.completeNum=0,this.keyAry)for(var g=0;g<this.keyAry.length;g++)if(this.skillVo.types==SkillType.TrajectoryDynamicTarget||this.skillVo.types==SkillType.TrajectoryDynamicPoint){var h=this.keyAry[g];h.setPlayData(a,b,function(a){f.removeTrajectory(a)},d,0==g?e:null)}},b.prototype.configMulTrajectory=function(a,b,c,d){var e=this;if(void 0===d&&(d=null),this.active=b,this.completeFun=d,this.completeNum=0,this.keyAry)for(var f=0;f<this.keyAry.length;f++)if(this.skillVo.types==SkillType.TrajectoryDynamicTarget){var g=this.keyAry[f];g.setMulPlayData(a,c,function(a){e.removeTrajectory(a)},2)}},b.prototype.removeTrajectory=function(a){var b=this.trajectoryAry.indexOf(a);-1!=b&&this.trajectoryAry.splice(b,1),this.completeNum++,this.completeNum==this.keyAry.length&&this.skillComplete()},b.prototype.destory=function(){if(this.skillVo=null,this.name=null,this.keyAry){for(var a=0;a<this.keyAry.length;a++)this.keyAry[a].destory();this.keyAry.length=0,this.keyAry=null}if(this.active=null,this.completeFun=null,this.trajectoryAry){for(var a=0;a<this.trajectoryAry.length;a++)this.trajectoryAry[a].destory();this.trajectoryAry.length=0,this.trajectoryAry=null}this._skillData.useNum--,this._skillData=null},b.MaxTime=5e3,b}(ResCount),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(ResCount),SkillVo=function(){function a(){}return a.prototype.setData=function(a){this.keyAry=new Array,a||console.log("技能有错"),this.action=a.action,this.skillname=a.skillname,this.bloodTime=a.blood,this.types=a.type,this.types==SkillType.FixEffect?this.keyAry=this.getFixEffect(a.data):(this.types==SkillType.TrajectoryDynamicTarget||this.types==SkillType.TrajectoryDynamicPoint)&&(this.keyAry=this.getTrajectoryDynamicTarget(a.data)),a.sound&&(this.sound=new SkillKeyVo,this.sound.frame=a.sound.time*Scene_data.frameTime,this.sound.url=a.sound.name),a.shock&&(this.shockAry=this.getShockAry(a.shock))},a.prototype.getShockAry=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SkillShockVo;d.setData(a[c]),b.push(d)}return b},a.prototype.getFixEffect=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SkillFixEffectKeyVo;d.setData(a[c]),b.push(d)}return b},a.prototype.getTrajectoryDynamicTarget=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SkillTrajectoryTargetKeyVo;d.setData(a[c]),b.push(d)}return b},a.defaultBloodTime=250,a}(),SkillType=function(){function a(){}return a.TrajectoryDynamicTarget=1,a.FixEffect=4,a.TrajectoryDynamicPoint=3,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillKeyVo=function(){function a(){this.frame=0}return a.prototype.setData=function(a){this.frame=a.frame,this.url=a.url},a}(),SkillShockVo=function(){function a(){}return a.prototype.setData=function(a){this.time=a.time*Scene_data.frameTime,this.lasttime=a.lasttime*Scene_data.frameTime,this.amp=a.amp},a}(),SkillFixEffectKeyVo=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.setData=function(b){a.prototype.setData.call(this,b),this.hasSocket=b.hasSocket,this.hasSocket?this.socket=b.socket:(this.pos=new Vector3D(b.pos.x,b.pos.y,b.pos.z),this.rotation=new Vector3D(b.rotation.x,b.rotation.y,b.rotation.z))},b}(SkillKeyVo),SkillTrajectoryTargetKeyVo=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.setData=function(b){a.prototype.setData.call(this,b),this.beginType=b.beginType,0==this.beginType?this.beginPos=new Vector3D(b.beginPos.x,b.beginPos.y,b.beginPos.z):1==this.beginType&&(this.beginSocket=b.beginSocket),this.speed=b.speed,b.hitSocket&&(this.hitSocket=b.hitSocket),b.endParticle&&(this.endParticleUrl=b.endParticle),this.multype=b.multype},b}(SkillKeyVo),SkillKey=function(){function a(){this.time=0}return a.prototype.addToRender=function(){this.particle&&(this.particle.reset(),this.particle.sceneVisible=!0,ParticleManager.getInstance().addParticle(this.particle))},a.prototype.setInfo=function(a){this.time=a.frame*Scene_data.frameTime,this.particle=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+a.url)},a.prototype.reset=function(){this.particle.reset(),ParticleManager.getInstance().removeParticle(this.particle)},a.prototype.destory=function(){this.particle.destory(),this.particle=null,this.removeCallFun=null},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillEffect=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.addToRender=function(){a.prototype.addToRender.call(this),this.particle.addEventListener(BaseEvent.COMPLETE,this.onPlayCom,this)},b.prototype.onPlayCom=function(a){void 0===a&&(a=null),this.particle.removeEventListener(BaseEvent.COMPLETE,this.onPlayCom,this),ParticleManager.getInstance().removeParticle(this.particle),this.removeCallFun(this)},b}(SkillKey),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillFixEffect=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.setInfo=function(b){a.prototype.setInfo.call(this,b);var c=b;this.pos=c.pos,this.rotation=c.rotation,this.hasSocket=c.hasSocket,this.socket=c.socket},b.prototype.addToRender=function(){if(a.prototype.addToRender.call(this),this.outPos)this.particle.x=this.outPos.x,this.particle.y=this.outPos.y,this.particle.z=this.outPos.z,this.particle.rotationX=this.rotation.x,this.particle.rotationY=this.rotation.y+this.active.rotationY,this.particle.rotationZ=this.rotation.z,this.particle.bindTarget=null;else if(this.hasSocket){var b=this.active;this.particle.bindTarget=b,this.particle.bindSocket=this.socket}else{var c=new Matrix3D;c.appendRotation(this.active.rotationY,Vector3D.Y_AXIS);var d=c.transformVector(this.pos);d.x+=this.active.x,d.y+=this.active.y,d.z+=this.active.z,this.particle.x=d.x,this.particle.y=d.y,this.particle.z=d.z,this.particle.rotationX=this.rotation.x,this.particle.rotationY=this.rotation.y+this.active.rotationY,this.particle.rotationZ=this.rotation.z,this.particle.bindTarget=null}},b}(SkillEffect),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillTrajectory=function(a){function b(){var b=a.call(this)||this;return b._currentPos=new Vector3D,b.rotationMatrix=new Matrix3D,b._socketMaxrix=new Matrix3D,b._currentTargetPos=new Vector3D,b}return __extends(b,a),b.prototype.update=function(a){this.path.update(a)},b.prototype.reset=function(){a.prototype.reset.call(this),this.endParticle&&(ParticleManager.getInstance().addParticle(this.endParticle),this.endParticle.reset(),this.endParticle.setPos(this._currentTargetPos.x,this._currentTargetPos.y,this._currentTargetPos.z)),this.removeCallFun&&this.removeCallFun(this)},b.prototype.endPlayFun=function(a){void 0===a&&(a=null),ParticleManager.getInstance().removeParticle(this.endParticle),this.endParticle.removeEventListener(BaseEvent.COMPLETE,this.endPlayFun,this)},b.prototype.setCurrentPos=function(){if(this.data.hitSocket){var a=this.target;return a?(a.getSocket(this.data.hitSocket,this._socketMaxrix),this._currentTargetPos.setTo(this._socketMaxrix.position.x,this._socketMaxrix.position.y,this._socketMaxrix.position.z)):console.log("需要处理,特殊没有指定对象"),!0}return this._currentTargetPos.x==this.target.x&&this._currentTargetPos.y==this.target.y&&this._currentTargetPos.z==this.target.z?!1:(this._currentTargetPos.setTo(this.target.x,this.target.y,this.target.z),!0)},b.prototype.addToRender=function(){a.prototype.addToRender.call(this);var b;if(0==this.data.beginType){var c=new Matrix3D;c.appendRotation(this.active.rotationY,Vector3D.Y_AXIS),b=c.transformVector(this.data.beginPos),this._currentPos.setTo(this.active.x+b.x,this.active.y+b.y,this.active.z+b.z)}else if(1==this.data.beginType){var d=new Matrix3D,e=this.active;e.getSocket(this.data.beginSocket,d),b=d.position,this._currentPos.setTo(b.x,b.y,b.z)}this.particle.setPos(this._currentPos.x,this._currentPos.y,this._currentPos.z),this.path.add()},b.prototype.getSocket=function(a,b){b.identity(),b.append(this.rotationMatrix),b.appendTranslation(this._currentPos.x,this._currentPos.y,this._currentPos.z)},b.prototype.getSunType=function(){return 0},b.prototype.setInfo=function(b){a.prototype.setInfo.call(this,b),this.particle.bindTarget=this,this.data=b,this.data.endParticleUrl&&(this.endParticle=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+this.data.endParticleUrl),this.endParticle.addEventListener(BaseEvent.COMPLETE,this.endPlayFun,this))},b.prototype.setPlayData=function(a,b,c,d,e){var f=this;void 0===d&&(d=0),void 0===e&&(e=null),this.active=a,this.target=b,this.removeCallFun=c,this._currentPos.setTo(0,0,0),this.rotationMatrix.identity(),this._socketMaxrix.identity(),this._currentTargetPos.setTo(0,0,0),this.path||(this.path=PathManager.getNewPath(d),this.path.setData(this,function(){f.reset()},this._currentPos,this.rotationMatrix,this._currentTargetPos,e),this.path.speed=this.data.speed),this.path.reset()},b.prototype.destory=function(){a.prototype.destory.call(this),this.active=null,this.target=null,this.data=null,this._currentPos=null,this.rotationMatrix=null,this._socketMaxrix=null,this._currentTargetPos=null,this.path=null},b}(SkillKey),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillMulTrajectory=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.update=function(a){this.pathMul.update(a)},b.prototype.getSunType=function(){return 1},b.prototype.addToRender=function(){if(this.particle){if(this.particle.reset(),ParticleManager.getInstance().addParticle(this.particle),this.currentPosList)for(var a=0;a<this.activeList.length;a++)this.currentPosList[a].setTo(this.activeList[a].x,this.activeList[a].y+10,this.activeList[a].z+5),this.currentPosList[a].w=0;else{this.currentPosList=new Array;for(var a=0;a<this.activeList.length;a++)this.currentPosList.push(new Vector3D(this.activeList[a].x,this.activeList[a].y+10,this.activeList[a].z+5));this.pathMul.setInitCurrentPos(this.currentPosList)}this.pathMul.add(),this.particle.setMulPos(this.pathMul.resultAry)}},b.prototype.setMulPlayData=function(a,b,c,d){var e=this;void 0===d&&(d=0),this.activeList=a,this.active=this.activeList[0],this.target=b,this.removeCallFun=c,this._currentPos.setTo(0,0,0),this.rotationMatrix.identity(),this._socketMaxrix.identity(),this._currentTargetPos.setTo(0,0,0),this.pathMul||(this.pathMul=PathManager.getNewPath(d),this.pathMul.setData(this,function(){e.reset()},this._currentPos,this.rotationMatrix,this._currentTargetPos),this.pathMul.speed=this.data.speed),this.pathMul.reset()},b.prototype.getMulSocket=function(a){a&&this.pathMul.applyData(a)},b}(SkillTrajectory),SkillPath=function(){function a(){this._currentDirect=new Vector3D}return a.prototype.update=function(a){if(this.time=a,this.hasReached)return this.endTime+=a,void(this.endTime>200&&this.applyArrive());if(this.skillTrajectory.setCurrentPos()&&(this._currentDirect.x=this.currentTargetPos.x-this.currentPos.x,this._currentDirect.y=this.currentTargetPos.y-this.currentPos.y,this._currentDirect.z=this.currentTargetPos.z-this.currentPos.z,this._currentDirect.normalize(),this._currentDirect.scaleBy(this.speed),this.setRotationMatrix(this.currentTargetPos.subtract(this.currentPos)),0==this._currentDirect.length))return void this.arrive();var b=this._currentDirect.length*this.time;if(!this.hasReached){var c=Vector3D.distance(this.currentPos,this.currentTargetPos);this.currentPos.x+=this._currentDirect.x*this.time,this.currentPos.y+=this._currentDirect.y*this.time,this.currentPos.z+=this._currentDirect.z*this.time}b>c&&this.arrive()},a.prototype.setRotationMatrix=function(a){a.normalize();var b=new Vector3D(0,0,-1),c=b.cross(a);c.normalize();var d=Math.acos(a.dot(b)),e=new Quaternion;e.fromAxisAngle(c,d),e.toMatrix3D(this.rotationMatrix)},a.prototype.arrive=function(){this.hasReached=!0},a.prototype.applyArrive=function(){this.endFun(),this.bloodFun&&this.bloodFun()},a.prototype.reset=function(){this.hasReached=!1,this._currentDirect.setTo(0,0,0),this.endTime=0},a.prototype.add=function(){},a.prototype.setData=function(a,b,c,d,e,f){this.skillTrajectory=a,this.currentPos=c,this.rotationMatrix=d,this.currentTargetPos=e,this.endFun=b,this.bloodFun=f},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillSinPath=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.basePos=new Vector3D,b}return __extends(b,a),b.prototype.add=function(){this.skillTrajectory.setCurrentPos();var a=new Vector3D;a.x=this.currentTargetPos.x-this.currentPos.x,a.y=this.currentTargetPos.y-this.currentPos.y,a.z=this.currentTargetPos.z-this.currentPos.z,this.basePos.setTo(this.currentPos.x,this.currentPos.y,this.currentPos.z),this.alltime=a.length/this.speed},b.prototype.update=function(a){if(this.time=a,this.lastTime+=a,this.hasReached)return this.endTime+=a,void(this.endTime>200&&this.applyArrive());this.skillTrajectory.setCurrentPos();var b=this.lastTime/this.alltime;if(b-=b*b,b*=250,this._currentDirect.x=this.currentTargetPos.x-this.basePos.x,this._currentDirect.y=this.currentTargetPos.y-this.basePos.y,this._currentDirect.z=this.currentTargetPos.z-this.basePos.z,this._currentDirect.normalize(),this._currentDirect.scaleBy(this.speed),this.setRotationMatrix(this.currentTargetPos.subtract(this.basePos)),0==this._currentDirect.length)return void this.arrive();var c=this._currentDirect.length*this.time;if(!this.hasReached){var d=Vector3D.distance(this.basePos,this.currentTargetPos);this.basePos.x+=this._currentDirect.x*this.time,this.basePos.y+=this._currentDirect.y*this.time,this.basePos.z+=this._currentDirect.z*this.time,this.currentPos.x=this.basePos.x,this.currentPos.y=this.basePos.y+b,this.currentPos.z=this.basePos.z}c>d&&this.arrive()},b.prototype.reset=function(){a.prototype.reset.call(this),this.lastTime=0},b}(SkillPath),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillMulPath=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.lastTime=0,b}return __extends(b,a),b.prototype.setInitCurrentPos=function(a){this.currentPosAry=a,this.allTimeList=new Array;for(var b=0;b<a.length;b++)this.allTimeList.push(0)},b.prototype.add=function(){this.skillTrajectory.setCurrentPos(),this.directAry=new Array;for(var a=0,b=0;b<this.currentPosAry.length;b++){var c=new Vector3D;c.x=this.currentTargetPos.x-this.currentPosAry[b].x,c.y=this.currentTargetPos.y-this.currentPosAry[b].y,c.z=this.currentTargetPos.z-this.currentPosAry[b].z;var d=c.length;d>a&&(a=d,this.maxV3d=this.currentPosAry[b]),this.allTimeList[b]=d/this.speed,c.normalize(),c.scaleBy(this.speed),this.directAry.push(c)}this.alltime=a/this.speed,this.setAllData()},b.prototype.setAllData=function(){var a=float2int(this.alltime/33)+8;this.resultAry=new Array;for(var b=0;b<this.currentPosAry.length;b++){var c=new Array;this.resultAry.push(c);for(var d=this.directAry[b],e=0;6>e;e++)c.push([this.currentPosAry[b].x,this.currentPosAry[b].y,this.currentPosAry[b].z]);for(var f=0;a>f;f++){this.lastTime=33*f;var g,h=this.lastTime/this.allTimeList[b],i=h;h>=1?(i=0,g=[this.currentTargetPos.x,this.currentTargetPos.y,this.currentTargetPos.z]):(i-=i*i,i*=250,g=[d.x*this.lastTime+this.currentPosAry[b].x,d.y*this.lastTime+i+this.currentPosAry[b].y,d.z*this.lastTime+this.currentPosAry[b].z]);var j;if(0==f)j=[0,1,0];else{var k=c[2*f-2];j=[g[0]-k[0],g[1]-k[1],g[2]-k[2]];var l=Math.sqrt(j[0]*j[0]+j[1]*j[1]+j[2]*j[2]);j[0]/=l,j[1]/=l,j[2]/=l}c.push(g,j)}}},b.prototype.update=function(a){if(this.time=a,this.lastTime+=a,this.hasReached)return this.endTime+=a,void(this.endTime>200&&this.applyArrive());this.skillTrajectory.setCurrentPos();for(var b=0;b<this.currentPosAry.length;b++){var c=this.lastTime/this.allTimeList[b];c-=c*c,c*=250;var d=this.currentPosAry[b];if(this._currentDirect.x=this.currentTargetPos.x-d.x,this._currentDirect.y=this.currentTargetPos.y-d.y,this._currentDirect.z=this.currentTargetPos.z-d.z,
this._currentDirect.normalize(),this._currentDirect.scaleBy(this.speed),this.maxV3d==d&&(this.setRotationMatrix(this.currentTargetPos.subtract(d)),0==this._currentDirect.length))return void this.arrive();var e=this._currentDirect.length*this.time;if(!this.hasReached){var f=Vector3D.distance(d,this.currentTargetPos);d.x+=this._currentDirect.x*this.time,d.y+=this._currentDirect.y*this.time,d.z+=this._currentDirect.z*this.time,d.w=c}this.maxV3d==d&&e>f&&this.arrive()}this.currentPos.setTo(this.currentPosAry[0].x,this.currentPosAry[0].y+this.currentPosAry[0].w,this.currentPosAry[0].z)},b.prototype.setData=function(b,c,d,e,f){a.prototype.setData.call(this,b,c,d,e,f,null),this.skillMul=b},b.prototype.applyData=function(a){for(var b=0;b<a.length;b++)a[b].setTo(this.currentPosAry[b].x,this.currentPosAry[b].y+this.currentPosAry[b].w,this.currentPosAry[b].z)},b.prototype.reset=function(){a.prototype.reset.call(this),this.lastTime=0},b}(SkillPath),PathManager=function(){function a(){}return a.reg=function(a,b){this.dic[a]=b},a.getNewPath=function(a){var b=this.dic[a];return new b},a.init=function(){this.dic[0]=SkillPath,this.dic[1]=SkillSinPath,this.dic[2]=SkillMulPath},a.dic=new Object,a}(),LoadManager=function(){function a(){this._loadThreadList=new Array,this._waitLoadList=new Array;for(var a=0;10>a;a++)this._loadThreadList.push(new LoaderThread)}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.load=function(a,b,c,d,e){void 0===d&&(d=null),void 0===e&&(e=null),(!a||a.length<1||-1!=a.search("undefined"))&&console.log("加载地址不能为空"),-1!=a.search("undefined.txt")&&console.log("没有这个文件");for(var f=new LoadInfo(a,b,c,d,e),g=0;g<this._loadThreadList.length;g++)if(this._loadThreadList[g].idle)return void this._loadThreadList[g].load(f);this._waitLoadList.push(f)},a.prototype.loadWaitList=function(){if(!(this._waitLoadList.length<=0))for(var a=0;a<this._loadThreadList.length;a++)if(this._loadThreadList[a].idle)return void this._loadThreadList[a].load(this._waitLoadList.shift())},a.BYTE_TYPE="BYTE_TYPE",a.IMG_TYPE="IMG_TYPE",a.XML_TYPE="XML_TYPE",a}(),LoaderThread=function(){function a(){var a=this;this._xhr=new XMLHttpRequest,this._xhr.onreadystatechange=function(){200==a._xhr.status&&4==a._xhr.readyState&&a.loadByteXML()},this._xhr.onprogress=function(b){a._loadInfo.progressFun&&a._loadInfo.progressFun(b.loaded/b.total)},this._xhr.onerror=function(){a.loadError()},this._img=new Image,this._img.onload=function(){a.loadImg()},this._img.onerror=function(){a.loadError()},this.idle=!0}return a.prototype.load=function(a){this._loadInfo=a,this.idle=!1,this._url=a.url,this._loadInfo.type==LoadManager.BYTE_TYPE?(this._xhr.open("GET",a.url,!0),this._xhr.responseType="arraybuffer",this._xhr.send()):this._loadInfo.type==LoadManager.XML_TYPE?(this._xhr.open("GET",a.url,!0),this._xhr.responseType="text",this._xhr.send()):this._loadInfo.type==LoadManager.IMG_TYPE&&(this._img.url==a.url?this.loadImg():(this._img.url=a.url,this._img.src=a.url))},a.prototype.loadError=function(){this.idle=!0,this._loadInfo=null,LoadManager.getInstance().loadWaitList()},a.prototype.loadByteXML=function(){this._loadInfo.info?this._loadInfo.fun(this._xhr.response,this._loadInfo.info):this._loadInfo.fun(this._xhr.response),this.idle=!0,this._loadInfo=null,LoadManager.getInstance().loadWaitList()},a.prototype.loadByteImg=function(){var a=new Blob([this._xhr.response],{type:"application/octet-binary"});this._img.src=URL.createObjectURL(a)},a.prototype.loadImg=function(){this._loadInfo.info?this._loadInfo.fun(this._img,this._loadInfo.info):this._loadInfo.fun(this._img),this.idle=!0,this._loadInfo=null,LoadManager.getInstance().loadWaitList()},a}(),LoadInfo=function(){function a(a,b,c,d,e){void 0===d&&(d=null),void 0===e&&(e=null),this.url=a,this.type=b,this.fun=c,this.info=d,this.progressFun=e}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ObjDataManager=function(a){function b(){var b=a.call(this)||this;return b._loadList=new Object,b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.getObjData=function(a,b){var c=this;if(this._dic[a])return b(this._dic[a]),void this._dic[a].useNum++;var d;this._loadList[a]||(this._loadList[a]=new Array,LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(b){c.loadObjCom(b,a)})),d=this._loadList[a],d.push(b)},b.prototype.registerUrl=function(a){this._dic[a]&&this._dic[a].useNum++},b.prototype.releaseUrl=function(a){this._dic[a]&&this._dic[a].clearUseNum()},b.prototype.gc=function(){a.prototype.gc.call(this)},b.prototype.readFloatNrm=function(a,b){var c=a.readInt();if(c>0)for(var d=0;c>d;d++)b.push(a.readFloat())},b.prototype.loadObjCom=function(a,b){if(!this._dic[b]){var c=new ObjData,d=new ByteArray(a),e=d.readInt();d.readUTF();e>=20?this.readObj2OneBuffer(d,c):(BaseRes.readFloatTwoByte(d,c.vertices),BaseRes.readFloatTwoByte(d,c.uvs),BaseRes.readFloatOneByte(d,c.lightuvs),BaseRes.readFloatTwoByte(d,c.normals),BaseRes.readIntForTwoByte(d,c.indexs),BaseRes.readFloatTwoByte(d,c.tangents),BaseRes.readFloatTwoByte(d,c.bitangents),c.vertexBuffer=Scene_data.context3D.uploadBuff3D(c.vertices),c.uvBuffer=Scene_data.context3D.uploadBuff3D(c.uvs),c.lightUvBuffer=Scene_data.context3D.uploadBuff3D(c.lightuvs),c.normalsBuffer=Scene_data.context3D.uploadBuff3D(c.normals)),c.treNum=c.indexs.length,c.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(c.indexs),this._dic[b]=c;var f=this._loadList[b];if(f){for(var g=0;g<f.length;g++)f[g](c);delete this._loadList[b]}return c}},b.prototype.readObj2OneBuffer=function(a,b){for(var c,d=new Array,d=new Array,e=0,f=0;6>f;f++){var g=a.readBoolean();if(d.push(g),g)switch(f){case 1:e+=2;break;case 2:e+=2;break;default:e+=3}}c=a.readFloat();c*=4*e;var h=new ArrayBuffer(c),i=new DataView(h),j=3,k=j+2,l=d[2]?k+2:j+2,m=l+3,n=m+3;BaseRes.readBytes2ArrayBuffer(a,i,3,0,e),BaseRes.readBytes2ArrayBuffer(a,i,2,j,e),BaseRes.readBytes2ArrayBuffer(a,i,2,k,e,1),BaseRes.readBytes2ArrayBuffer(a,i,3,l,e),BaseRes.readBytes2ArrayBuffer(a,i,3,m,e),BaseRes.readBytes2ArrayBuffer(a,i,3,n,e),BaseRes.readIntForTwoByte(a,b.indexs),b.vertexBuffer=Scene_data.context3D.uploadBuff3DArrayBuffer(h),b.compressBuffer=!0,b.uvsOffsets=4*j,b.lightuvsOffsets=4*k,b.normalsOffsets=4*l,b.tangentsOffsets=4*m,b.bitangentsOffsets=4*n,b.stride=4*e},b.prototype.creatTBNBuffer=function(a){a.tangentBuffer=Scene_data.context3D.uploadBuff3D(a.tangents),a.bitangentBuffer=Scene_data.context3D.uploadBuff3D(a.bitangents)},b}(ResGC),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MeshDataManager=function(a){function b(){var b=a.call(this)||this;return b._loadDic=new Object,b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.getMeshData=function(a,b,c){var d=this;return void 0===c&&(c=1),this._dic[a]&&this._dic[a].ready?(b(this._dic[a]),void this._dic[a].useNum++):this._loadDic[a]?void this._loadDic[a].push(b):(this._loadDic[a]=new Array,this._loadDic[a].push(b),void ResManager.getInstance().loadRoleRes(Scene_data.fileRoot+a,function(a){d.roleResCom(a,b)},c))},b.prototype.roleResCom=function(a,b){var c=a.roleUrl,d=this._dic[c];d.loadMaterial(),d.setAction(a.actionAry,c),a.ambientLightColor&&(d.lightData=[[a.ambientLightColor.x,a.ambientLightColor.y,a.ambientLightColor.z],[a.nrmDircet.x,a.nrmDircet.y,a.nrmDircet.z],[a.sunLigthColor.x,a.sunLigthColor.y,a.sunLigthColor.z]]);for(var e=0;e<this._loadDic[c].length;e++)this._loadDic[c][e](d),d.useNum++;delete this._loadDic[c],d.ready=!0},b.prototype.gc=function(){a.prototype.gc.call(this)},b.prototype.readData=function(a,b,c,d){var e=new SkinMesh;e.fileScale=a.readFloat(),d>=19?e.tittleHeight=a.readFloat():e.tittleHeight=50,e.hitBox=new Vector2D(20,20),d>=23&&(e.hitBox.x=a.readFloat(),e.hitBox.y=a.readFloat()),e.makeHitBoxItem();for(var f=a.readInt(),g=new Object,h=0;f>h;h++){var i=new MeshData;d>=21?this.readMesh2OneBuffer(a,i):(BaseRes.readFloatTwoByte(a,i.vertices),BaseRes.readFloatTwoByte(a,i.tangents),BaseRes.readFloatTwoByte(a,i.bitangents),BaseRes.readFloatTwoByte(a,i.normals),BaseRes.readFloatTwoByte(a,i.uvs),BaseRes.readIntForOneByte(a,i.boneIDAry),BaseRes.readFloatOneByte(a,i.boneWeightAry),BaseRes.readIntForTwoByte(a,i.indexs),BaseRes.readIntForTwoByte(a,i.boneNewIDAry),this.uploadMesh(i)),i.treNum=i.indexs.length,i.materialUrl=a.readUTF(),i.materialParamData=BaseRes.readMaterialParamData(a);for(var j=a.readInt(),k=0;j>k;k++){var l=new BindParticle(a.readUTF(),a.readUTF());i.particleAry.push(l),g[l.url]=!0}e.addMesh(i)}for(var m in g)ParticleManager.getInstance().registerUrl(m);e.allParticleDic=g;for(var n=a.readInt(),o=new Array,k=0;n>k;k++){var p=new Array(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat());o.push(p)}this.getBindPosMatrix(o,e);var q=a.readInt();e.boneSocketDic=new Object;for(var k=0;q>k;k++){var r=new BoneSocketData;r.name=a.readUTF(),r.boneName=a.readUTF(),r.index=a.readInt(),r.x=a.readFloat(),r.y=a.readFloat(),r.z=a.readFloat(),r.rotationX=a.readFloat(),r.rotationY=a.readFloat(),r.rotationZ=a.readFloat(),e.boneSocketDic[r.name]=r}return this._dic[c]=e,e},b.prototype.readMesh2OneBuffer=function(a,b){for(var c=a.readInt(),d=new Array,e=0,f=0;5>f;f++){var g=a.readBoolean();d.push(g),g&&(e+=1==f?2:3)}e+=8,c*=4*e;var h,i=3,j=i+2,k=j+3,l=k+3;h=d[2]?d[4]?l+3:j+3:i+2;var m=h+4,n=new ArrayBuffer(c),o=new DataView(n);BaseRes.readBytes2ArrayBuffer(a,o,3,0,e),BaseRes.readBytes2ArrayBuffer(a,o,2,i,e),BaseRes.readBytes2ArrayBuffer(a,o,3,j,e),BaseRes.readBytes2ArrayBuffer(a,o,3,k,e),BaseRes.readBytes2ArrayBuffer(a,o,3,l,e),BaseRes.readBytes2ArrayBuffer(a,o,4,h,e,2),BaseRes.readBytes2ArrayBuffer(a,o,4,m,e,1),BaseRes.readIntForTwoByte(a,b.indexs),BaseRes.readIntForTwoByte(a,b.boneNewIDAry),b.compressBuffer=!0,b.uvsOffsets=4*i,b.normalsOffsets=4*j,b.tangentsOffsets=4*k,b.bitangentsOffsets=4*l,b.boneIDOffsets=4*h,b.boneWeightOffsets=4*m,b.stride=4*e,b.vertexBuffer=Scene_data.context3D.uploadBuff3DArrayBuffer(n),b.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(b.indexs)},b.prototype.cloneMeshData=function(a,b){var c=a.vertices,d=a.normals,e=a.uvs,f=a.boneIDAry,g=a.boneWeightAry,h=a.indexs;a.vertices=new Array,a.normals=new Array,a.uvs=new Array,a.boneIDAry=new Array,a.boneWeightAry=new Array,a.indexs=new Array;for(var i=c.length/3,j=0;b>j;j++){a.vertices=a.vertices.concat(c),a.normals=a.normals.concat(d),a.boneIDAry=a.boneIDAry.concat(f),a.boneWeightAry=a.boneWeightAry.concat(g);for(var k=0;k<e.length;k+=2)a.uvs.push(e[k],e[k+1],j);for(var k=0;k<h.length;k++)a.indexs.push(h[k]+j*i)}a.treNum=a.indexs.length},b.prototype.getBindPosMatrix=function(a,b){for(var c=new Array,d=new Array,e=0;e<a.length;e++){var f=a[e],g=new Quaternion(f[0],f[1],f[2]);g.setMd5W();var h=g.toMatrix3D();h.appendTranslation(f[3],f[4],f[5]),d.push(h.clone()),h.invert(),c.push(h)}b.bindPosMatrixAry=c,b.bindPosInvertMatrixAry=d},b.prototype.uploadMesh=function(a){a.vertexBuffer=Scene_data.context3D.uploadBuff3D(a.vertices),a.uvBuffer=Scene_data.context3D.uploadBuff3D(a.uvs),a.boneIdBuffer=Scene_data.context3D.uploadBuff3D(a.boneIDAry),a.boneWeightBuffer=Scene_data.context3D.uploadBuff3D(a.boneWeightAry),a.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(a.indexs)},b.prototype.uploadPbrMesh=function(a,b){a.normalsBuffer=Scene_data.context3D.uploadBuff3D(a.normals),b&&(a.tangentBuffer=Scene_data.context3D.uploadBuff3D(a.tangents),a.bitangentBuffer=Scene_data.context3D.uploadBuff3D(a.bitangents))},b.prototype.preLoad=function(a){this.getMeshData(a,function(a){a.loadMaterial()})},b}(ResGC),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),AnimManager=function(){function a(){this._dic=new Object}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getAnimData=function(a,b){var c=this;return this._dic[a]?void b(this._dic[a]):void LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(b,d){var e=c.readData(new ByteArray(b),a);d(e)},b)},a.prototype.getAnimDataImmediate=function(a){return this._dic[a]},a.prototype.clearAnim=function(a){delete this._dic[a]},a.prototype.readData=function(a,b){var c=new Array,d=new Array,e=new AnimData;e.inLoop=a.readInt();for(var f=a.readInt(),g=0;f>g;g++)e.inter.push(a.readInt());f=a.readInt();for(var g=0;f>g;g++)e.bounds.push(a.readVector3D());e.nameHeight=a.readInt(),f=a.readInt();for(var g=0;f>g;g++){var h=new ObjectBone;h.father=a.readInt(),h.changtype=a.readInt(),h.startIndex=a.readInt(),h.tx=a.readFloat(),h.ty=a.readFloat(),h.tz=a.readFloat(),h.qx=a.readFloat(),h.qy=a.readFloat(),h.qz=a.readFloat(),c.push(h)}this.readFrameData(a,d),f=a.readInt();for(var g=0;f>g;g++)e.posAry.push(a.readVector3D());return e.matrixAry=this.processFrame(d,c),this._dic[b]=e,e},a.prototype.readFrameData=function(a,b){for(var c=this.readFrameTypeData(a),d=a.readBoolean(),e=a.readFloat(),f=a.readInt(),g=0;f>g;g++){var h=a.readInt(),i=new Array;b.push(i);for(var j=0;h>j;j++)c[j]?i.push(a.readFloatTwoByte(e)):d?i.push(a.readFloat()):i.push(a.readShort()/32767)}},a.prototype.readFrameTypeData=function(a){for(var b=new Array,c=a.readInt(),d=0;c>d;d++)b.push(a.readBoolean());return b},a.prototype.processFrame=function(a,b){for(var c=new Array,d=0;d<a.length;d++)c.push(this.frameToBone(a[d],b));return this.setFrameToMatrix(c)},a.prototype.frameToBone=function(a,b){for(var c=new Array,d=0;d<b.length;d++){var e=new ObjectBaseBone;e.father=b[d].father;var f=0;1&b[d].changtype?(e.tx=a[b[d].startIndex+f],++f):e.tx=b[d].tx,2&b[d].changtype?(e.ty=a[b[d].startIndex+f],++f):e.ty=b[d].ty,4&b[d].changtype?(e.tz=a[b[d].startIndex+f],++f):e.tz=b[d].tz,8&b[d].changtype?(e.qx=a[b[d].startIndex+f],++f):e.qx=b[d].qx,16&b[d].changtype?(e.qy=a[b[d].startIndex+f],++f):e.qy=b[d].qy,32&b[d].changtype?(e.qz=a[b[d].startIndex+f],++f):e.qz=b[d].qz,c.push(e)}return c},a.prototype.setFrameToMatrix=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=a[c],e=new Quaternion,f=new Matrix3D,g=new Array;b.push(g);for(var h=0;h<d.length;h++){var i=d[h];if(e=new Quaternion(i.qx,i.qy,i.qz),e.w=this.getW(e.x,e.y,e.z),-1==i.father)f=e.toMatrix3D(),f.appendTranslation(i.tx,i.ty,i.tz),f.appendRotation(-90,Vector3D.X_AXIS),g.push(f);else{d[i.father];f=e.toMatrix3D(),f.appendTranslation(i.tx,i.ty,i.tz),f.append(g[i.father]),g.push(f)}}for(h=0;h<g.length;h++)g[h].appendScale(-1,1,1)}return b},a.prototype.getW=function(a,b,c){var d=1-(a*a+b*b+c*c);return d=0>d?0:-Math.sqrt(d)},a}(),ObjectBaseBone=function(){function a(){}return a}(),ObjectBone=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.clone=function(){var a=new b;return a.tx=this.tx,a.ty=this.ty,a.tz=this.tz,a.tw=this.tw,a.qx=this.qx,a.qy=this.qy,a.qz=this.qz,a.qw=this.qw,a.changtype=this.changtype,a.name=this.name,a.father=this.father,a.startIndex=this.startIndex,a.matrix=this.matrix,a},b}(ObjectBaseBone),LightProbeManager=function(){function a(){this._defaultVec=new Array;for(var a=[.4444730390920146,-.3834955622240026,-.33124467509627725,.09365654209093091,-.05673310882817577,.2120523322966496,.02945768486978205,-.04965996229802928,-.1136529129285836],b=0;9>b;b++)this._defaultVec.push(new Vector3D(a[b],a[b],a[b]))}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.setLightProbeData=function(a){this._dataAry=a},a.prototype.clear=function(){this._dataAry=null},a.prototype.getData=function(a){if(!this._dataAry)return this._defaultVec;for(var b=0;b<this._dataAry.length;b++){var c=this._dataAry[b];if(this.testPoint(c,a)){var d=c.postion,e=a.subtract(d);return this.getResultData(c.posItem,float2int(e.x/c.betweenNum),float2int(e.z/c.betweenNum),float2int(e.y/c.betweenNum),c.betweenNum,e)}}return this._defaultVec},a.prototype.testPoint=function(a,b){var c=(a.cubeVec.x-1)*a.betweenNum,d=(a.cubeVec.y-1)*a.betweenNum,e=(a.cubeVec.z-1)*a.betweenNum,f=b.x-a.postion.x,g=b.y-a.postion.y,h=b.z-a.postion.z;return f>=0&&c>f&&g>=0&&d>g&&h>=0&&e>h?!0:!1},a.prototype.getResultData=function(a,b,c,d,e,f){var g=new Array;g.push(new PosItem(a[b][c][d],f)),g.push(new PosItem(a[b+1][c][d],f)),g.push(new PosItem(a[b][c+1][d],f)),g.push(new PosItem(a[b+1][c+1][d],f)),g.push(new PosItem(a[b][c][d+1],f)),g.push(new PosItem(a[b+1][c][d+1],f)),g.push(new PosItem(a[b][c+1][d+1],f)),g.push(new PosItem(a[b+1][c+1][d+1],f));for(var h=0,i=0;i<g.length;i++)h+=g[i].dis;for(i=0;i<g.length;i++)g[i].setBais(h);var j=0;for(i=0;i<g.length;i++)j+=g[i].bais;for(i=0;i<g.length;i++)g[i].bais=g[i].bais/j;var k=new Array;for(i=0;9>i;i++){for(var l=new Vector3D,m=0;m<g.length;m++){var n=new Vector3D(g[m].vecNum[i].x,g[m].vecNum[i].y,g[m].vecNum[i].z);n.scaleBy(g[m].bais),l=l.add(n)}k.push(l)}return k},a}(),PosItem=function(){function a(a,b){this.pos=new Vector3D(a.x,a.y,a.z),this.vecNum=a.resultSHVec,this.dis=Vector3D.distance(this.pos,b)}return a.prototype.setBais=function(a){this.bais=this.dis/a*(this.dis/a),this.bais=1/this.bais},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GroupDataManager=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._loadDic=new Object,b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.getGroupData=function(a,b){var c=this;if(this._dic[a]){var d=this._dic[a];return d.useNum++,void b(d)}if(this._loadDic[a])return void this._loadDic[a].push(b);this._loadDic[a]=new Array,this._loadDic[a].push(b);var e=new GroupRes;e.load(a,function(){for(var b=c._loadDic[a],d=0;d<b.length;d++){var f=b[d];f(e)}c._dic[a]=e,delete c._loadDic[a],e.initReg()})},b}(ResGC),AstarUtil=function(){function a(){}return a.setData=function(a){this.navmeshData=a,this.heightItem=this.navmeshData.heightItem,this.jumpItem=this.navmeshData.jumpItem,this.midu=this.navmeshData.midu,this.aPos=new Vector3D(this.navmeshData.aPos.x,this.navmeshData.aPos.y,this.navmeshData.aPos.z),this.makeStarGraph(this.navmeshData.astarItem),this.astarWidth=this.heightItem[0].length,this.astarHeight=this.heightItem.length,SceneManager.getInstance().fixAstart(new Vector2D(this.aPos.x,this.midu*this.astarHeight+this.aPos.z)),this.mathAreaRect(),this.mathMinMapRect()},Object.defineProperty(a,"sceneVectList",{set:function(a){this._sceneVectList=a,this._frist=!0},enumerable:!0,configurable:!0}),a.getJumpDataByV2d=function(a,b){return this.jumpItem&&this.jumpItem.length&&this.jumpItem[b]&&1==this.jumpItem[b][a]?!0:!1},a.mathMinMapRect=function(){var b=(a.navmeshData.midu,a.navmeshData.astarItem[0].length),c=a.navmeshData.astarItem.length,d=a.navmeshData.aPos.x+b*a.navmeshData.midu,e=a.navmeshData.aPos.z+c*a.navmeshData.midu;d=Math.max(Math.abs(a.navmeshData.aPos.x),Math.abs(d)),e=Math.max(Math.abs(a.navmeshData.aPos.z),Math.abs(e));var f=Math.max(d,e);f+=100,f=Math.round(f);var g=new Rectangle;g.x=-f,g.y=-f,g.width=2*f,g.height=2*f,g.x-=1,g.y-=1,g.width+=2,g.height+=2,g.width/=2,g.height/=2,this.minMapRect=g},a.mathAreaRect=function(){this.areaRect=new Rectangle,this.areaRect.x=this.aPos.x,this.areaRect.y=this.aPos.z,this.areaRect.width=this.astarWidth*this.midu,this.areaRect.height=this.astarHeight*this.midu},a.clear=function(){this._bakData=this.navmeshData,this.aPos.setTo(0,0,0),this.navmeshData=null},a.porcessBak=function(a){a&&this.setData(this._bakData)},a.getHeightByPos=function(a){if(this.heightItem){var b=a.subtract(this.aPos).add(new Vector3D(this.midu/2,0,this.midu/2)),c=(this.astarWidth-1)*this.midu,d=(this.astarHeight-1)*this.midu;if(b.x>0&&b.x<=c&&b.z>0&&b.z<=d)return this.getBaseHeightByBitmapdata(b.x/this.midu,b.z/this.midu)}return-500},a.getBaseHeightByBitmapdata=function(a,b){var c=a-float2int(a),d=b-float2int(b),e=this.getBitmapDataHight(float2int(a),float2int(b)),f=this.getBitmapDataHight(float2int(a),Math.ceil(b)),g=this.getBitmapDataHight(Math.ceil(a),float2int(b)),h=this.getBitmapDataHight(Math.ceil(a),Math.ceil(b)),i=(1-c)*(1-d),j=(1-c)*d,k=c*(1-d),l=c*d,m=i*e+j*f+k*g+l*h;return m},a.getBitmapDataHight=function(a,b){return this.heightItem[this.heightItem.length-1-b][a]},a.findPath=function(b,c){a.getPosIsCanMove(c)||(c=this.findNearLinePoint(b,c));var d=this.getGrapIndexByPos(b),e=this.getGrapIndexByPos(c);if(d&&e){for(var f=this.graphData.grid[d.x][d.y],g=this.graphData.grid[e.x][e.y],h=astar.search(this.graphData,f,g),i=new Array,j=0;j<h.length;j++){var k=new Vector2D(h[j].x,h[j].y),l=new Vector3D(k.x*this.midu+this.midu/2,3,k.y*this.midu+this.midu/2);l=l.add(this.aPos),i.push(l)}return i}return null},a.Path2dTo3d=function(a){for(var b=new Array,c=0;c<a.length;c++)b.push(this.getWorldPosByStart2D(a[c]));return b},a.getWorldPosByStart2D=function(a){if(this.navmeshData){var b=new Vector3D(a.x*this.midu,3,a.y*this.midu);return b.x=b.x+this.aPos.x+this.midu/2,b.z=this.aPos.z+this.midu*this.astarHeight-b.z-this.midu/2,b}return new Vector3D(10*a.x+this.midu/2,0,10*a.y-this.midu/2)},a.findPath3D=function(b,c){if(this.navmeshData){a.getPosIsCanMove(c)||(c=this.findNearLinePoint(b,c));var d=this.getGrapIndexByPos(b),e=this.getGrapIndexByPos(c);return this.getJumpDataByV2d(e.x,e.y)?(console.log("是跳跃区域不可寻路",e.x,e.y),null):this.isGridCanWalk(e)?d?this.findStraightLine(d,e)?[d,e]:this.findPath2D(d,e):(console.log("逻辑格位置有错"),null):null}return[this.getGrapIndexByPos(b),this.getGrapIndexByPos(c)]},a.findStraightLine=function(a,b){var c=new Vector2D(b.x-a.x,b.y-a.y);c.normalize();for(var d=Math.round(Vector2D.distance(a,b)),e=new Vector2D,f=0;d>f;f++){if(e.x=Math.floor(a.x+f*c.x),e.y=Math.floor(a.y+f*c.y),!this.isGridCanWalk(e))return!1;if(e.x=Math.ceil(a.x+f*c.x),e.y=Math.ceil(a.y+f*c.y),!this.isGridCanWalk(e))return!1;if(e.x=Math.round(a.x+f*c.x),e.y=Math.round(a.y+f*c.y),!this.isGridCanWalk(e))return!1}return!0},a.isGridCanWalk=function(a){return a?this.graphData.grid[a.y]&&this.graphData.grid[a.y][a.x]?0==this.graphData.grid[a.y][a.x].weight?!1:!0:!1:(console.log("没有这个点",a),!1)},a.findPath2D=function(a,b){try{if(this.graphData&&this.graphData.grid&&a&&b){var c=this.graphData.grid[a.y][a.x],d=this.graphData.grid[b.y][b.x],e=astar.search(this.graphData,c,d),f=new Array;f.push(a);for(var g=0;g<e.length;g++){var h=new Vector2D(e[g].y,e[g].x);f.push(h)}return this.simplifyAstar(f)}}catch(i){throw console.log("在此处理错误2"),new Error("findPath2D 在此处理错误")}return null},a.simplifyAstar=function(a){var b=0;if(a.length>1,a.length>2){var c=new Array;c.push(a[0]);for(var d=2;d<a.length;d++){var e=c[c.length-1],f=a[d-1],g=a[d];Math.atan2(f.y-e.y,f.x-e.x)!=Math.atan2(g.y-e.y,g.x-e.x)||b>126?c.push(f):b++}return c.push(a[a.length-1]),c}return a},a.findNearLinePoint=function(b,c){for(;Vector3D.distance(b,c)>5;)if(c=this.moveA2B(c,b,1),a.getPosIsCanMove(c))return c;return c},a.moveA2B=function(a,b,c){var d=b.subtract(a);return d.normalize(),d.scaleBy(c),d=d.add(a)},a.getPosIsCanMove=function(a){if(!this.graphData||!this.graphData.grid)return console.log("寻路这时是不可的a"),!1;var b=this.getGrapIndexByPos(a);return this.isGridCanWalk(b)},a.makeStarGraph=function(a){var b=new Array;this.canwalkItem.length=0;for(var c=0;c<a.length;c++){for(var d=new Array,e=0;e<a[c].length;e++)1==a[c][e]?d.push(1):d.push(0);b.push(d)}this.graphData=new Graph(b),this.graphData.diagonal=!0},a.getGrapIndexByPos=function(a){if(!this.navmeshData)return new Vector2D(float2int(a.x/this.midu),float2int(a.z/this.midu));var b=a.subtract(this.aPos).add(new Vector3D(0,0,this.midu/2)),c=this.astarWidth*this.midu,d=this.astarHeight*this.midu;return b.x>0&&b.x<c&&b.z>0&&b.z<d?new Vector2D(float2int(b.x/this.midu),float2int(this.astarHeight-b.z/this.midu)):null},a.getScenePos=function(a,b){var c=Groundposition.getGroundPos(a,b);return this.getLookAtPos(c)},a.getLookAtPos=function(b){var c=new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z),d=b.subtract(c);d.normalize();for(var e,f=0;;){f+=2;var g=d.clone();g.scaleBy(f);var h=c.add(g),i=a.getHeightByPos(h);if(i>h.y){e=h;break}if(f>1e3){e=null;break}}return e},a.aPos=new Vector3D,a.midu=10,a.astarWidth=0,a.astarHeight=0,a._frist=!1,a.canwalkItem=[],a}(),KeyboardType=function(){function a(){}return a.A=65,a.B=66,a.C=67,a.D=68,a.E=69,a.F=70,a.G=71,a.H=72,a.I=73,a.J=74,a.K=75,a.L=76,a.M=77,a.N=78,a.O=79,a.P=80,a.Q=81,a.R=82,a.S=83,a.T=84,a.U=85,a.V=86,a.W=87,a.X=88,a.Y=89,a.Z=90,a.Left=37,a.Up=38,a.Right=39,a.Down=40,a.Delete=46,a.F1=112,a.F2=113,a}(),MouseType=function(){function a(){}return a.MouseDown="mousedown",a.MouseUp="mouseup",a.MouseMove="mousemove",a.MouseClick="mouseclick",a.KeyDown="keydown",a.KeyUp="keyup",a.MouseWheel="mousewheel",a.TouchStart="touchstart",a.TouchMove="touchmove",a.TouchEnd="touchend",a.TouchClick="touchstart",a}(),KeyControl=function(){function a(){var a=this;this._isUpData=!0,this.speedNum=10,this._keyDic=new Object,this._lostMousePos=new Object3D,this._lastFousce=new Object3D,this._isMouseDown=!1,setInterval(function(){a.upData()},1e3/60)}return Object.defineProperty(a,"instance",{get:function(){return this._instance||(this._instance=new a),this._instance},enumerable:!0,configurable:!0}),a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.init=function(){document.addEventListener(MouseType.MouseDown,this.onMouseDown),document.addEventListener(MouseType.MouseUp,this.onMouseUp),document.addEventListener(MouseType.MouseMove,this.onMouseMove),document.addEventListener(MouseType.KeyDown,this.onKeyDown),document.addEventListener(MouseType.KeyUp,this.onKeyUp)},a.prototype.clearAllEvet=function(){document.removeEventListener(MouseType.MouseDown,this.onMouseDown),document.removeEventListener(MouseType.MouseUp,this.onMouseUp),document.removeEventListener(MouseType.MouseMove,this.onMouseMove),document.removeEventListener(MouseType.KeyDown,this.onKeyDown),document.removeEventListener(MouseType.KeyUp,this.onKeyUp)},a.prototype.clearMouseEvent=function(){document.removeEventListener(MouseType.MouseDown,this.onMouseDown),document.removeEventListener(MouseType.MouseUp,this.onMouseUp),document.removeEventListener(MouseType.MouseMove,this.onMouseMove),this._isUpData=!1},a.prototype.onMouseMove=function(b){var c=a.instance,d=new Object3D;d.x=b.pageX,d.y=b.pageY,c._isMouseDown&&(Scene_data.cam3D.rotationY=c._lastFousce.rotationY-(d.x-c._lostMousePos.x)/10,Scene_data.cam3D.rotationX=c._lastFousce.rotationX-(d.y-c._lostMousePos.y)/10)},a.prototype.onMouseDown=function(b){var c=a.instance;c._isMouseDown=!0,c._lostMousePos.x=b.pageX,c._lostMousePos.y=b.pageY,c._lastFousce.rotationX=Scene_data.cam3D.rotationX,c._lastFousce.rotationY=Scene_data.cam3D.rotationY},a.prototype.onMouseUp=function(b){var c=a.instance;c._isMouseDown=!1},a.prototype.upData=function(){if(this._isUpData){var a=this._keyDic;a[65]&&this.tureLeft(),a[83]&&this.tureDown(),a[68]&&this.tureRight(),a[87]&&this.tureUp(),a[81]&&(Scene_data.cam3D.y-=this.speedNum),a[69]&&(Scene_data.cam3D.y+=this.speedNum),MathClass.MathCam(Scene_data.cam3D)}},a.prototype.tureLeft=function(){var a=new Vector3D(-this.speedNum,0,0,1);new Matrix3D;this.mathFocus3D(a)},a.prototype.tureRight=function(){var a=new Vector3D(this.speedNum,0,0,1);this.mathFocus3D(a)},a.prototype.tureUp=function(){var a=new Vector3D(0,0,this.speedNum,1);this.mathFocus3D(a)},a.prototype.tureDown=function(){var a=new Vector3D(0,0,-this.speedNum,1);this.mathFocus3D(a)},a.prototype.mathFocus3D=function(a){var b=new Matrix3D;b.prependRotation(-Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),b.prependRotation(-Scene_data.cam3D.rotationX,Vector3D.X_AXIS),a=b.transformVector(a),Scene_data.cam3D.x+=a.x,Scene_data.cam3D.y+=a.y,Scene_data.cam3D.z+=a.z},a.prototype.onKeyDown=function(b){var c=a.instance._keyDic;c[b.keyCode]=!0,0==b.keyCode},a.prototype.onKeyUp=function(b){var c=a.instance._keyDic;c[b.keyCode]=!1},a}(),TimeUtil=function(){function a(){}return a.getTimer=function(){return Date.now()-a.START_TIME},a.getTimerSecond=function(){return a.getTimer()/1e3},a.saveNowTime=function(){this.lastTime=this.getTimer()},a.getUseTime=function(){return this.getTimer()-this.lastTime},a.getZeroTime=function(a){var b=new Date(1e3*a);return b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.getTime()/1e3},a.getLocalTime=function(a){var b=new Date(1e3*a);return b.toLocaleDateString().replace(/\//g,"-")+" "+b.toTimeString().substr(0,5)},a.getLocalTime0=function(a){var b=new Date(1e3*a);return b.toLocaleDateString().replace(/\//g,"-")},a.getLocalTime1=function(a){var b=new Date(1e3*a);return b.toLocaleDateString().replace(/\//g,"-")+" "+b.toTimeString().substr(0,8)},a.getLocalTime2=function(a){var b=new Date(1e3*a);return b.toTimeString().substr(0,8)},a.getLocalTime3=function(a){var b=new Date(1e3*a);return b.toTimeString().substr(3,5)},a.getLocalTime4=function(a){return float2int(a/60)+"分"+a%60+"秒"},a.getLocalTime5=function(a){var b=new Date(1e3*a),c=b.toTimeString().substr(0,8),d=c.split(":");return d[0]+"时"+d[1]+"分"+d[2]+"秒"},a.getDiffTime1=function(a){var b=float2int(a/this.dayTime);a-=b*this.dayTime;var c=float2int(a/this.HourTime);a-=c*this.HourTime;var d=float2int(a/this.MinuteTime);return a-=d*this.MinuteTime,b+"天"+c+"时"+d+"分"+a+"秒"},a.getDiffTime2=function(a){var b=float2int(a/this.HourTime);a-=b*this.HourTime;var c=float2int(a/this.MinuteTime);return a-=c*this.MinuteTime,this.zeroStr(b)+":"+this.zeroStr(c)+":"+this.zeroStr(a)},a.zeroStr=function(a){return a>9?String(a):"0"+a},a.getDelayTimeStr=function(a){var b=Math.floor(a/3600),c="";return c=b>24?Math.floor(b/24)+"天前":b>=1?b+"小时前":"刚刚"},a.init=function(){a.START_TIME=Date.now()},a.addTimeTick=function(b,c,d){void 0===d&&(d=0);var e=new TimeFunTick;e.alltime=b,e.fun=c,e.time=b-d,a.timefunAry.push(e)},a.removeTimeTick=function(b){for(var c=0;c<a.timefunAry.length;c++)if(a.timefunAry[c]&&a.timefunAry[c].fun==b){a.timefunAry[c]=null;break}},a.addTimeOut=function(b,c){if(!this.hasTimeOut(c)){var d=new TimeFunOut;d.alltime=b,d.fun=c,d.time=0,a.outTimeFunAry.push(d)}},a.removeTimeOut=function(b){for(var c=0;c<a.outTimeFunAry.length;c++)if(a.outTimeFunAry[c]&&a.outTimeFunAry[c].fun==b){a.outTimeFunAry[c]=null;break}},a.hasTimeOut=function(b){for(var c=0;c<a.outTimeFunAry.length;c++)if(a.outTimeFunAry[c]&&a.outTimeFunAry[c].fun==b)return!0;return!1},a.addFrameTick=function(b){-1==a.funAry.indexOf(b)&&a.funAry.push(b)},a.hasFrameTick=function(b){var c=a.funAry.indexOf(b);return-1!=c?!0:!1},a.removeFrameTick=function(b){var c=a.funAry.indexOf(b);-1!=c&&(a.funAry[c]=null)},a.update=function(){for(var b=a.getTimer()-a.time,c=0;c<a.funAry.length;c++)a.funAry[c]&&a.funAry[c](b);for(var c=0;c<a.timefunAry.length;c++)a.timefunAry[c]&&a.timefunAry[c].update(b);for(var c=a.outTimeFunAry.length-1;c>=0;c--)a.outTimeFunAry[c]&&a.outTimeFunAry[c].update(b)&&(a.outTimeFunAry[c]=null);for(var c=a.funAry.length-1;c>=0;c--)a.funAry[c]||a.funAry.splice(c,1);for(var c=a.timefunAry.length-1;c>=0;c--)a.timefunAry[c]||a.timefunAry.splice(c,1);for(var c=a.outTimeFunAry.length-1;c>=0;c--)a.outTimeFunAry[c]||a.outTimeFunAry.splice(c,1);
a.time=a.getTimer()},a.funAry=new Array,a.timefunAry=new Array,a.outTimeFunAry=new Array,a.time=0,a.lastTime=0,a.dayTime=86400,a.HourTime=3600,a.MinuteTime=60,a}(),TimeFunTick=function(){function a(){this.alltime=0,this.time=0}return a.prototype.update=function(a){this.time+=a,this.time>=this.alltime&&(this.fun(),this.time=0)},a}(),TimeFunOut=function(){function a(){this.alltime=0,this.time=0}return a.prototype.update=function(a){return this.time+=a,this.time>=this.alltime?(this.fun(),!0):!1},a}(),keyChi=["零","一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五"],ColorTransition=function(){function a(){this._canvas=document.createElement("canvas"),this._cxt=this._canvas.getContext("2d"),this._gnt=this._cxt.createLinearGradient(0,0,128,0),this._canvas.style.zIndex="1"}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getImageData=function(a){for(var b=a.pos.length,c=new Vector3D,d=0;b>d;d++)hexToArgb(a.color[d],!1,c),this._gnt.addColorStop(a.pos[d]/255,"rgba("+c.x+","+c.y+","+c.z+","+a.alpha[d]+")");return this._cxt.fillStyle=this._gnt,this._cxt.fillRect(0,0,128,2),this._cxt.getImageData(0,0,128,2)},a.prototype.getImageDataByVec=function(a,b){for(var c,d,e=this._cxt.createImageData(64,1),f=0;64>f;f++)c=4*f,d=4*float2int(f/64*b),e.data[c]=a[d],e.data[c+1]=a[d+1],e.data[c+2]=a[d+2],e.data[c+3]=a[d+3];return e},a.prototype.setData=function(){},a}(),ArtFont=function(){function a(){this.fontData=new Dictionary([]),this.fontData_Unit=new Dictionary([]),this.makeFontRect()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.makeFontRect=function(){this.fontData.Red=this.makeBase12pxNum(new Vector2D(0,0)),this.fontData.Green=this.makeBase12pxNum(new Vector2D(0,15)),this.fontData.Blue=this.makeBase12pxNum(new Vector2D(0,30)),this.fontData.White=this.makeBase12pxNum(new Vector2D(0,45)),this.fontData.Yellow=this.makeBase12pxNum(new Vector2D(0,75)),this.getXmlData()},a.prototype.getXmlData=function(){for(var a=UIData.getUiArrByKey(UIData.textlist),b=0;b<a.length;b++){var c=String(a[b].name);if(-1!=c.search("A_")){var d=Number(c.substring(5,c.length)),e=new UIRectangle;e.pixelX=Number(a[b].ox),e.pixelY=Number(a[b].oy),e.pixelWitdh=Number(a[b].ow),e.pixelHeight=Number(a[b].oh),e.cellX=Number(a[b].cellX),e.cellY=Number(a[b].cellY);for(var f=new Rectangle(0,0,e.pixelWitdh/e.cellX,e.pixelHeight),g=new Array,h=0;h<e.cellX;h++)g.push(new Rectangle(e.pixelX+h*f.width,e.pixelY,f.width,f.height));this.fontData["NUM"+d]=g}if(-1!=c.search("B_")){var d=Number(c.substring(5,c.length)),e=new UIRectangle;e.pixelX=Number(a[b].ox),e.pixelY=Number(a[b].oy),e.pixelWitdh=Number(a[b].ow),e.pixelHeight=Number(a[b].oh),e.cellX=Number(a[b].cellX),e.cellY=Number(a[b].cellY);for(var f=new Rectangle(0,0,e.pixelWitdh/e.cellX,e.pixelHeight),g=new Array,h=0;h<e.cellX;h++)g.push(new Rectangle(e.pixelX+h*f.width,e.pixelY,f.width,f.height));this.fontData_Unit["BNUM"+d]=g}}},a.prototype.makeBase12pxNum=function(a){var b=new Array;b.push(new Rectangle(3,0,9,14)),b.push(new Rectangle(14,0,9,14)),b.push(new Rectangle(25,0,9,14)),b.push(new Rectangle(36,0,9,14)),b.push(new Rectangle(47,0,9,14)),b.push(new Rectangle(59,0,9,14)),b.push(new Rectangle(70,0,9,14)),b.push(new Rectangle(81,0,9,14)),b.push(new Rectangle(92.5,0,9,14)),b.push(new Rectangle(104,0,9,14)),b.push(new Rectangle(116,0,9,14)),b.push(new Rectangle(126,0,9,14)),b.push(new Rectangle(136,0,9,14)),b.push(new Rectangle(144,0,9,13)),b.push(new Rectangle(154,0,9,13));for(var c=0;c<b.length;c++)b[c].x=b[c].x+a.x,b[c].y=b[c].y+a.y;return b},a.prototype.writeFontToCtxLeft=function(b,c,d,e,f,g){void 0===d&&(d=a.num1),void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=0);for(var h,i=this.fontData[d],j=0,k=0;k<c.length;k++){h=this.getCharId(c[k]);var l=this.getRect(h,d,i);if(!l)return void console.log("writeFontToCtxLeft有错");b.drawImage(UIData.textImg,l.x,l.y,l.width,l.height,j+e,f,l.width,l.height),j+=l.width-g}return j},a.prototype.writeFontToCtxRight=function(b,c,d,e,f,g){void 0===d&&(d=a.White),void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=0);for(var h,i=this.fontData[d],j=0,k=this.getAirFontWidth(b,c,d,g),l=0;l<c.length;l++){h=this.getCharId(c[l]);var m=this.getRect(h,d,i);b.drawImage(UIData.textImg,m.x,m.y,m.width,m.height,j+e-k,f,m.width,m.height),j+=m.width-g}return k},a.prototype.writeFontToCtxCenten=function(b,c,d,e,f,g){void 0===d&&(d=a.White),void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=0);var h,i=this.fontData[d],j=0,k=this.getAirFontWidth(b,c,d,g)/2;void 0==c&&console.log("有错的");for(var l=0;l<c.length;l++){h=this.getCharId(c[l]);var m=this.getRect(h,d,i);b.drawImage(UIData.textImg,m.x,m.y,m.width,m.height,j+e-k,f,m.width,m.height),j+=m.width-g}return k},a.prototype.writeFontToSkinName=function(b,c,d,e,f,g){void 0===e&&(e=a.ORANGE_TXT),void 0===f&&(f=TextAlign.LEFT),void 0===g&&(g=0);var h=b.getRec(c);b.ctx=UIManager.getInstance().getContext2D(h.pixelWitdh,h.pixelHeight,!1);var i;return f==TextAlign.LEFT?i=this.writeFontToCtxLeft(b.ctx,d,e,0,0,g):f==TextAlign.RIGHT?i=this.writeFontToCtxRight(b.ctx,d,e,h.pixelWitdh,0,g):f==TextAlign.CENTER&&(i=this.writeFontToCtxCenten(b.ctx,d,e,h.pixelWitdh/2,0,g)),TextureManager.getInstance().updateTexture(b.texture,h.pixelX,h.pixelY,b.ctx),i},a.prototype.writeFontToSkinNameCenter=function(b,c,d,e,f){void 0===e&&(e=a.ORANGE_TXT),void 0===f&&(f=0);var g=b.getRec(c);b.ctx=UIManager.getInstance().getContext2D(g.pixelWitdh,g.pixelHeight,!1);for(var h,i=g.pixelWitdh/2,j=g.pixelHeight/2,k=this.fontData[e],l=0,m=this.getAirFontWidth(b.ctx,d,e,f)/2,n=0;n<d.length;n++){h=this.getCharId(d[n]);var o=this.getRect(h,e,k);b.ctx.drawImage(UIData.textImg,o.x,o.y,o.width,o.height,l+i-m,j-o.height/2,o.width,o.height),l+=o.width-f}TextureManager.getInstance().updateTexture(b.texture,g.pixelX,g.pixelY,b.ctx)},a.prototype.getAirFontWidth=function(b,c,d,e){if(void 0===d&&(d=a.White),void 0===e&&(e=0),void 0==c)return 0;for(var f,g=this.fontData[d],h=0,i=0;i<c.length;i++){f=this.getCharId(c[i]);var j=this.getRect(f,d,g);j||console.log("---$str---",c),h+=j.width-e}return h},a.prototype.getRect=function(a,b,c){var d;return d=a>15?this.fontData_Unit["B"+b][a-16]:c[a]},a.prototype.upArtFont=function(b,c,d,e,f,g){void 0===e&&(e=12),void 0===f&&(f=a.White),void 0===g&&(g=TextAlign.LEFT);var h=e/12,i=this.fontData[f],j=b.getRec(c);b.ctx=UIManager.getInstance().getContext2D(j.pixelWitdh,j.pixelHeight,!1);var k=this.getTotalWandDraw(j,d,i,h,b.ctx,!1),l=this.getXpos(g,k,new Rectangle(0,0,j.pixelWitdh,j.pixelHeight));this.getTotalWandDraw(j,d,i,h,b.ctx,!0,l),TextureManager.getInstance().updateTexture(b.texture,j.pixelX,j.pixelY,b.ctx)},a.prototype.upArtBase=function(b,c,d,e,f){void 0===e&&(e=a.White),void 0===f&&(f=TextAlign.LEFT);var g=1,h=this.fontData[e],i=b.getRec(c);b.ctx=UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1);var j=this.getTotalWandDraw(i,d,h,g,b.ctx,!1),k=this.getXpos(f,j,new Rectangle(0,0,i.pixelWitdh,i.pixelHeight));this.getTotalWandDraw(i,d,h,g,b.ctx,!0,k),TextureManager.getInstance().updateTexture(b.texture,i.pixelX,i.pixelY,b.ctx)},a.prototype.getXpos=function(a,b,c){var d=0;return a==TextAlign.LEFT?d=0:a==TextAlign.RIGHT?d=b-c.width:a==TextAlign.CENTER&&(d=(c.width-b)/2),d},a.prototype.getTotalWandDraw=function(a,b,c,d,e,f,g,h){void 0===g&&(g=0),void 0===h&&(h=0);for(var i,j=0,k=0;k<b.length;k++){i=this.getCharId(b[k]);var l=c[i];l||console.log("没有这个字"),f&&e.drawImage(UIData.textImg,l.x,l.y,l.width,l.height,a.x+j+g,a.y,l.width*d,l.height*d),j+=(l.width-h)*d}return j},a.prototype.getCharId=function(a){return"+"==a||"x"==a||"X"==a?10:"-"==a?11:"/"==a?12:":"==a?13:"."==a?14:"%"==a?15:"万"==a?16:"亿"==a?17:(NaN==Number(a)&&alert("MeshVo,GetCharId error:"+a),Number(a))},a.Red="Red",a.Green="Green",a.Blue="Blue",a.White="White",a.Yellow="Yellow",a.BOSSBIGTXT="NUM99",a.CN1="NUM100",a.num101="NUM101",a.num102="NUM102",a.BigYellow="NUM12",a.num99="NUM99",a.GARY_TXT="NUM1",a.ORANGE_TXT="NUM19",a.num1="NUM1",a.num2="NUM2",a.num3="NUM3",a.num4="NUM4",a.num5="NUM5",a.num6="NUM6",a.num7="NUM7",a.num10="NUM10",a.num8="NUM8",a.num9="NUM9",a.num11="NUM11",a.num12="NUM12",a.num13="NUM13",a.num14="NUM14",a.num15="NUM15",a.num16="NUM16",a.num17="NUM17",a.num18="NUM18",a.num19="NUM19",a.num20="NUM20",a.num21="NUM21",a.num22="NUM22",a.num23="NUM23",a.num24="NUM24",a.num25="NUM24",a.num26="NUM26",a.num27="NUM27",a.num28="NUM28",a.num30="NUM30",a.num51="NUM51",a.num52="NUM52",a.num53="NUM53",a.num54="NUM54",a.num55="NUM55",a.num56="NUM56",a.num57="NUM57",a.num58="NUM58",a.num59="NUM59",a.num60="NUM60",a.num61="NUM61",a.numVip="NUM62",a.num63="NUM63",a.num64="NUM64",a.num65="NUM65",a.num66="NUM66",a}(),TextRegVo=function(){function a(){}return a}(),TextRegExp=function(){function a(){}return a.pushStr=function(b){this.item=new Array;for(var c,d=/\[\]|\[[A-Za-z0-9]{6}\]/g;null!=(c=d.exec(b));){var e=new TextRegVo;e.begin=c.index,e.end=d.lastIndex,e.color=c.toString(),e.color=e.color.replace("[",""),e.color=e.color.replace("]",""),e.color.length<5?e.color=a.defaultColor:e.color="#"+e.color,this.item.push(e)}},a.pushStrCopy=function(b){this.item=new Array;for(var c,d=/\[\]|\[[A-Za-z0-9]{6}\]/g,e=b;null!=(c=d.exec(b));){var f=new TextRegVo;f.begin=c.index,f.end=d.lastIndex,f.color=c.toString(),e=e.replace(f.color,"#"),f.color=f.color.replace("[",""),f.color=f.color.replace("]",""),f.color.length<5?f.color=a.defaultColor:(b.replace("["+f.color+"]","#"),f.color="#"+f.color),this.item.push(f)}return e},a.isColor=function(a,b){for(var c=0;c<this.item.length;c++)if(a>=this.item[c].begin&&a<this.item[c].end)return b&&(b.fillStyle=this.item[c].color),!0;return!1},a.getTextMetrics=function(a,b){b||(b=""),this.pushStr(b);for(var c=b,d="",e=0;e<c.length;e++)this.isColor(e,a)||(d+=c[e]);var f=a.measureText(d);return f},a.getTextOnlyTxt=function(a,b){b||(b=""),this.pushStr(b);for(var c=b,d="",e=0;e<c.length;e++)this.isColor(e,a)||(d+=c[e]);return d},a.getNextWords=function(a,b){var c=-1;if("/"==a[b]&&a.length>b+2)for(var d=a[b+0]+a[b+1]+a[b+2],e=0;e<UIData.faceItem.length;e++)if(UIData.faceItem[e]==d)return e+1;return c},a.wrapText=function(b,c,d,e,f,g,h,i,j,k,l){void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=500),void 0===h&&(h=10),void 0===i&&(i=12),void 0===j&&(j=""),void 0===k&&(k=4),void 0===l&&(l=1),a.defaultColor=d,""!=j&&(-1!=j.indexOf("[")&&(j="#"+j.substr(1,6)),b.strokeStyle=j,b.lineWidth=k),this.pushStr(c);for(var m=c,n="",o=2,p=1,q=0;m&&q<m.length;q++)if(!this.isColor(q,b)){var r=b.measureText(n.replace("\n","")),s=this.getNextWords(m,q);if(-1==s)r.width>g||"\n"==m[q]?(o+=h,n="","\n"!=m[q]&&(""!=j&&b.strokeText(m[q],e,f+o),b.fillText(m[q],e,f+o)),p++):(""!=j&&b.strokeText(m[q],e+r.width*l,f+o),b.fillText(m[q],e+r.width*l,f+o)),n+=m[q];else{var t=1.4*i,u=new Rectangle(e+1*r.width+0,f+o-t/10,t,t);r.width>g&&(o+=h,n="",p++,u=new Rectangle(e+0,f+o-t/10,t,t)),this.drawFaceIcon(b,u,s),q+=2,n+="脸1"}}return p},a.wrapTextVertical=function(b,c,d,e,f,g,h,i,j,k,l){void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=500),void 0===h&&(h=10),void 0===i&&(i=12),void 0===j&&(j=""),void 0===k&&(k=4),void 0===l&&(l=1),a.defaultColor=d,""!=j&&(-1!=j.indexOf("[")&&(j="#"+j.substr(1,6)),b.strokeStyle=j,b.lineWidth=k),this.pushStr(c);for(var m=c,n="",o=2,p=1,q=0,r=0;m&&r<m.length;r++)if(!this.isColor(r,b)){var s=this.getNextWords(m,r);-1==s&&(q>g||"\n"==m[r]?(o+=h,n="",q=0,"\n"!=m[r]&&(""!=j&&b.strokeText(m[r],e+o,q),b.fillText(m[r],e+o,q)),p++):(q+=i+5,""!=j&&b.strokeText(m[r],e+o,q),b.fillText(m[r],e+o,q)),n+=m[r])}return p},a.drawText=function(b,c,d,e,f,g){void 0===e&&(e=500),void 0===f&&(f=10),void 0===g&&(g=12),a.defaultColor=d;for(var h=this.pushStrCopy(c),i=0,j=0,k="",l=0,m=new Array,n=h.split("#"),o=0;o<n.length;o++){var p=n[o];if(""!=p){b.fillStyle=o>0?this.item[o-1].color:d;for(var q=0;q<p.length;q++)if("\n"==p[q]){var r=new TextCell(k,j,b.measureText(k).width,b.fillStyle,e);m.push(r),l=0,k="",j+=f}else{var s=k+p[q],t=b.measureText(s),u=t.width+l;if(i=Math.min(e,u),u>e){var r=new TextCell(k,j,b.measureText(k).width,b.fillStyle,e);m.push(r),k=p[q]+"",j+=f,l=0}else k=s}var v=b.measureText(k).width;l+=v;var r=new TextCell(k,j,b.measureText(k).width,b.fillStyle,e);m.push(r),k=""}}for(var w,x=-1e4,y=0;y<m.length;y++)x!=m[y].posy&&(x=m[y].posy,w=this.getStartPoint(m[y],m),w=Math.max(w,0)),b.fillStyle=m[y].color,b.fillText(m[y].str,w,x),w+=m[y].width;return j+=f,[i,j]},a.getStartPoint=function(a,b){for(var c=new Array,d=0;d<b.length;d++){var e=b[d];a.posy==e.posy&&c.push(e)}for(var f=0,g=0;g<c.length;g++)f+=c[g].width;return(a.maxwidth-f)/2},a.drawFaceIcon=function(a,b,c){UiDraw.cxtDrawImg(a,"F_FACE_"+c,b,UIData.publicUi)},a.defaultColor="#000000",a}(),TextCell=function(){function a(a,b,c,d,e){this.str=a,this.posy=b,this.width=c,this.color=d,this.maxwidth=e}return a}(),LabelTextFont=function(){function a(){}return a.writeSingleLabel=function(a,b,c,d,e,f,g,h,i,j){void 0===d&&(d=12),void 0===e&&(e=TextAlign.CENTER),void 0===f&&(f="#ffffff"),void 0===g&&(g=""),void 0===h&&(h=0),void 0===i&&(i=4),void 0===j&&(j=!0),-1!=f.indexOf("[")&&(f="#"+f.substr(1,6));var k=a.getRec(b),l=UIManager.getInstance().getContext2D(k.pixelWitdh,k.pixelHeight,!1);l.fillStyle=f,l.font=(j?"bolder ":"")+" "+d+"px "+UIData.font;var m=TextRegExp.getTextMetrics(l,c),n=0;return e==TextAlign.CENTER?n=(k.pixelWitdh-m.width)/2:e==TextAlign.RIGHT&&(n=k.pixelWitdh-m.width),TextRegExp.wrapText(l,c,f,n,h,k.pixelWitdh-d/2,20,d,g,i),a.updateCtx(l,k.pixelX,k.pixelY),m.width},a.writeSingleLabelToCtx=function(a,b,c,d,e,f,g,h,i){void 0===c&&(c=12),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=TextAlign.CENTER),void 0===g&&(g="#ffffff"),void 0===h&&(h=""),void 0===i&&(i=!0),-1!=g.indexOf("[")&&(g="#"+g.substr(1,6)),a.fillStyle=g,a.font=(i?"bolder ":"")+" "+c+"px "+UIData.font;var j=TextRegExp.getTextMetrics(a,b);return f==TextAlign.CENTER?d+=(a.canvas.width-j.width)/2:f==TextAlign.RIGHT&&(d+=a.canvas.width-j.width),TextRegExp.wrapText(a,b,g,d,e,9999,20,c,h),j.width},a.writeSingleLabelToCtxByVertical=function(a,b,c,d,e,f,g,h){void 0===c&&(c=12),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f="#ffffff"),void 0===g&&(g=""),void 0===h&&(h=!0),-1!=f.indexOf("[")&&(f="#"+f.substr(1,6)),a.fillStyle=f,a.font=(h?"bolder ":"")+" "+c+"px "+UIData.font,TextRegExp.wrapTextVertical(a,b,f,d,e,9999,20,c,g)},a.writeSingleLabelToCtxSetAnchor=function(a,b,c,d,e,f,g,h,i){void 0===c&&(c=12),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=TextAlign.CENTER),void 0===g&&(g="#ffffff"),void 0===h&&(h=""),void 0===i&&(i=!0),-1!=g.indexOf("[")&&(g="#"+g.substr(1,6)),a.fillStyle=g,a.font=(i?"bolder ":"")+" "+c+"px "+UIData.font;var j=TextRegExp.getTextMetrics(a,b);return f==TextAlign.CENTER?d-=j.width/2:f==TextAlign.RIGHT&&(d-=j.width),TextRegExp.wrapText(a,b,g,d,e,9999,20,c,h),j.width},a.writeText=function(a,b,c,d,e,f,g,h,i,j){void 0===h&&(h=0),void 0===i&&(i=!1),void 0===j&&(j=TextAlign.LEFT),-1!=g.indexOf("[")&&(g="#"+g.substr(1,6));var k=[10,10],l=a.getRec(b),m=UIManager.getInstance().getContext2D(l.pixelWitdh,l.pixelHeight,!1);m.fillStyle=g,m.font=(i?"bolder ":"")+f+"px "+UIData.font,m.textAlign=j;this.getTextxpos(j,m);return k=this.wrapText(m,e,c,d,h,f+5),a.updateCtx(m,l.pixelX,l.pixelY),k},a.writeTextAutoCenterByAnchor=function(a,b,c,d,e,f,g,h){void 0===g&&(g=!0),void 0===h&&(h=""),-1!=e.indexOf("[")&&(e="#"+e.substr(1,6));var i=a.getRec(b),j=UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1);j.fillStyle=e,j.font=(g?"bolder ":"")+d+"px "+UIData.font,j.textAlign=TextAlign.LEFT;var k=TextRegExp.drawText(j,c,e,f,d+5,d);return a.updateCtx(j,i.pixelX,i.pixelY),k},a.writeTextAutoVerticalCenter=function(a,b,c,d,e,f,g,h){void 0===g&&(g=""),void 0===h&&(h=!1),-1!=e.indexOf("[")&&(e="#"+e.substr(1,6));var i=a.getRec(b),j=UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1);j.fillStyle=e,j.font=(h?"bolder ":"")+d+"px "+UIData.font;var k=0,l=0;this.getTextxpos(TextAlign.LEFT,j);f>0&&(this.isNewline(j,c,f)||(l=i.pixelHeight/2-d/2),TextRegExp.wrapText(j,c,e,k,l,f,d+3,d,g)),a.updateCtx(j,i.pixelX,i.pixelY)},a.writeTextAutoCenter=function(a,b,c,d,e,f,g){void 0===g&&(g=!1),-1!=e.indexOf("[")&&(e="#"+e.substr(1,6));var h=a.getRec(b),i=UIManager.getInstance().getContext2D(h.pixelWitdh,h.pixelHeight,!1);i.fillStyle=e,i.font=(g?"bolder ":"")+d+"px "+UIData.font;var j=0,k=0;this.getTextxpos(TextAlign.LEFT,i);if(f>0){if(!this.isNewline(i,c,f)){var l=i.measureText(c);k=h.pixelHeight/2-d/2,j=h.pixelWitdh/2-l.width/2}TextRegExp.wrapText(i,c,e,j,k,f,d+3)}a.updateCtx(i,h.pixelX,h.pixelY)},a.isNewline=function(a,b,c){var d=b,e=a.measureText(d),f=e.width;return f>c?!0:!1},a.getTextxpos=function(a,b){var c=0;return a==TextAlign.LEFT?c=0:a==TextAlign.RIGHT?c=b.canvas.width:a==TextAlign.CENTER&&(c=b.canvas.width/2),c},a.wrapText=function(a,b,c,d,e,f){for(var g=0,h=d,i=b,j="",k=0;k<i.length;k++)if("\n"==i[k])a.fillText(j,c,h),j="",h+=f;else{var l=j+i[k],m=a.measureText(l),n=m.width;g=Math.max(g,n),n>e?(a.fillText(j,c,h),j=i[k]+"",h+=f):j=l}return a.fillText(j,c,h),h=h-d+f,[g,h]},a.clearLabel=function(a,b){var c=a.getRec(b),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);a.updateCtx(d,c.pixelX,c.pixelY)},a}(),SoundManager=function(){function a(){this.init=!1,this._volume=1,this._skillSoundDic=new Object,this._skillVolume=1}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.playSound=function(){this.initSound(),this.audio.play()},a.prototype.initSound=function(){this.init||(this.audio=new Audio(Scene_data.fileRoot+"sound/sound_3521.mp3"),this.audio.loop=!0,this.audio.volume=this._volume,this.audio.play(),this.init=!0)},a.prototype.stopSound=function(){this.audio&&this.audio.pause()},a.prototype.setVolume=function(a){this._volume=a,this._volume>0?this.playSound():this.stopSound(),this.audio&&(this.audio.volume=this._volume)},a.prototype.setSkillVolume=function(a){this._skillVolume=a;for(var b in this._skillSoundDic)this._skillSoundDic[b].volume=this._skillVolume},a.prototype.playSkillSound=function(a){if(!(this._skillVolume<=0))if(this._skillSoundDic[a])this._skillSoundDic[a].play();else{var b=new Audio(Scene_data.fileRoot+"skill/sound/"+a);b.loop=!1,b.volume=this._skillVolume,b.play(),this._skillSoundDic[a]=b}},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bloodTittle;!function(a){var b=function(){function a(){}return a.NORMALDAMAGE=1,a.CRIT=2,a.DODGE=3,a.TREATMENT=4,a.VERTIGO=5,a.FREEZE=6,a.ATTACKADD=7,a.ATTACKREDUCE=8,a.EXPERIENCE=9,a.NORMALDAMAGEUP=11,a.CRITUP=12,a.MYNORMALDAMAGE=13,a.MYNORMALDAMAGEUP=14,a.MISS=15,a}();a.TextJumpType=b;var c=function(){function a(){}return a}();a.TextJumpUiVo=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.makeData=function(){if(this._data){var a=this._data;switch(this.dtime=a.endtime,this.pos=a.pos,a.type){case b.NORMALDAMAGE:case b.TREATMENT:ArtFont.getInstance().writeFontToSkinName(this.parent.uiAtlas,this.textureStr,String(a.str),"NUM"+(a.type+50),TextAlign.RIGHT);break;case b.MYNORMALDAMAGEUP:case b.MYNORMALDAMAGE:ArtFont.getInstance().writeFontToSkinName(this.parent.uiAtlas,this.textureStr,String(a.str),ArtFont.num53,TextAlign.RIGHT);break;case b.NORMALDAMAGEUP:ArtFont.getInstance().writeFontToSkinName(this.parent.uiAtlas,this.textureStr,String(a.str),"NUM"+(a.type+40),TextAlign.RIGHT);break;case b.DODGE:case b.VERTIGO:case b.FREEZE:case b.MISS:this.drawTxtBytext(a);break;case b.ATTACKADD:case b.ATTACKREDUCE:case b.EXPERIENCE:case b.CRIT:case b.CRITUP:this._width=this.drawTxtBydigitalAndtext(a)}}},d.prototype.drawTxtBytext=function(a){var c=this.parent.uiAtlas.getRec(this.textureStr),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),e=50;return a.type==b.MISS&&(e=67),UiDraw.cxtDrawImg(d,"TYPE"+a.type,new Rectangle(c.pixelWitdh-e,c.pixelHeight-25,e,25),UIData.publicUi),TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,c.pixelX,c.pixelY,d),50},d.prototype.drawTxtBydigitalAndtext=function(a){var c,d=this.parent.uiAtlas.getRec(this.textureStr),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1),f=a.type,g=50,h=25;a.type==b.ATTACKREDUCE?(f=b.ATTACKADD,c=ArtFont.num53):a.type==b.ATTACKADD?c=ArtFont.num54:a.type==b.EXPERIENCE?c=ArtFont.num54:a.type==b.CRIT?(c=ArtFont.num55,g=78,h=50):a.type==b.CRITUP&&(f-=10,g=78,h=50,c=ArtFont.num55);var i=ArtFont.getInstance().getAirFontWidth(e,String(this._data.str),c);return i+=g,UiDraw.cxtDrawImg(e,"TYPE"+f,new Rectangle(d.pixelWitdh-i,d.pixelHeight-h,g,h),UIData.publicUi),ArtFont.getInstance().writeFontToCtxLeft(e,String(this._data.str),c,d.pixelWitdh-i+g+2,d.pixelHeight-h),TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,d.pixelX,d.pixelY,e),i},d.prototype.update=function(){if(this._data){if(this.time=TimeUtil.getTimer(),this.time>=this.dtime)return this.ui&&this.ui.parent&&this.ui.parent.removeChild(this.ui),void(this._data=null);var a=(this._data,this.changerules(this.time));this.ui.width=256*a[2],this.ui.height=50*a[3],this.ui.y=a[1]-this.ui.height,this.ui.x=a[0]-this.ui.width/2+25,this.ui.alpha=a[4]}},d.prototype.changerules=function(b){var c=this._data;b=(b-c.starttime)/1e3*60;var d,e,f,g,h,i=new Array,j=this.Vector3DToVector2D(new Vector3D(this.pos.x,this.pos.y,this.pos.z));switch(c.type){case a.TextJumpType.NORMALDAMAGE:case a.TextJumpType.MYNORMALDAMAGE:d=j.x,4>b?(e=j.y-4*b,f=b/4*1.3+.2,f>1.5&&(f=1.5),g=f,h=b/3*.8+.2,h>1&&(h=1)):8>b?(e=this._lastchange[1]-2,f=this._lastchange[2]-1/6,g=f,h=b/3*.8+.2,h>1&&(h=1)):15>b?(e=this._lastchange[1]-2,f=this._lastchange[2]+1/6,g=f,h=b/3*.8+.2,h>1&&(h=1)):30>b?(e=this._lastchange[1]-2,f=this._lastchange[2]-.05,g=f,h=b/3*.8+.2,h>1&&(h=1)):72>b&&(e=50>b?this._lastchange[1]-2:this._lastchange[1]+2,d=this._lastchange[0]-1.5,f=this._lastchange[2],g=f,h=this._lastchange[4]-.01,0>h&&(h=0));break;case a.TextJumpType.CRIT:d=j.x,4>b?(e=j.y-4*b,f=b/4*1.3+.2,f>1.5&&(f=1.5),g=f,h=b/3*.8+.2,h>1&&(h=1)):8>b?(e=this._lastchange[1]-2,f=this._lastchange[2]-1/6,g=f,h=b/3*.8+.2,h>1&&(h=1)):15>b?(e=this._lastchange[1]-2,f=this._lastchange[2]+.25,g=f,h=b/3*.8+.2,h>1&&(h=1)):30>b?(e=this._lastchange[1]-2,f=this._lastchange[2]-.05,g=f,h=b/3*.8+.2,h>1&&(h=1)):100>b&&(e=50>b?this._lastchange[1]-2:this._lastchange[1]+2,d=this._lastchange[0]-1.5,f=this._lastchange[2],g=f,h=this._lastchange[4]-.01,0>h&&(h=0));break;case a.TextJumpType.NORMALDAMAGEUP:case a.TextJumpType.CRITUP:case a.TextJumpType.MYNORMALDAMAGEUP:d=j.x,4>b?(e=j.y-4*b,f=b/4*1.5+.2,f>1.7&&(f=1.7),g=f,h=b/3*.3+.2,h>.5&&(h=.5)):8>b?(e=this._lastchange[1]-2,f=this._lastchange[2]-.25,g=f,h=b/3*.3+.2,h>.5&&(h=.5)):15>b?(e=this._lastchange[1]-2,f=this._lastchange[2]+.25,g=f,h=b/3*.3+.2,h>.5&&(h=.5)):30>b&&(e=this._lastchange[1]-2,f=this._lastchange[2]-1/15,g=f,h=this._lastchange[4]-1/80,0>h&&(h=0));break;case a.TextJumpType.TREATMENT:d=j.x,e=j.y-1.5*b,12>b?(f=Math.ceil(b)/12*.8+.2,g=f,h=Math.ceil(b)/12*.8+.2):60>b&&(f=1,g=f,h=1-(b-11)/48);break;case a.TextJumpType.EXPERIENCE:e=j.y-=15,e-=.5*b,40>b?(d=j.x-.9*b,f=Math.ceil(b)/40*.3+.5,g=f,h=1):60>b&&(d=j.x-36,f=this._lastchange[2],g=f,h=1-(b-39)/20);break;case a.TextJumpType.ATTACKADD:case a.TextJumpType.ATTACKREDUCE:d=j.x+=110,e=j.y-1.8*b,12>b?(f=Math.ceil(b)/12*1.3+.1,g=f,h=Math.ceil(b)/12*.8+.2):24>b?(f=1.4-(b-11)/12*.4,g=f,h=1):60>b&&(f=1,g=f,h=1-(b-23)/36);break;case a.TextJumpType.DODGE:case a.TextJumpType.MISS:case a.TextJumpType.VERTIGO:case a.TextJumpType.FREEZE:d=j.x-=50,12>b?(e=j.y-3*b,f=1,g=f,h=Math.ceil(b)/12):36>b?(e=j.y-33,f=1,g=f,h=1):72>b&&(e=j.y-33-1.5*(b-36),f=1,g=f,h=1-(b-35)/36)}return i.push(d),i.push(e),i.push(f),i.push(g),i.push(h),i.push(j.x),i.push(j.y),this._lastchange=i,i},d}(Disp2DBaseText);a.TextJumpUiDrawAndRefreash=d;var e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.tempMatrix=new Matrix3D,b}return __extends(b,a),b.prototype.makeData=function(){this._data&&(this.charNameMeshVo=this.data,this.lastKey!=this.charNameMeshVo.name&&(this.ui.width=179.2,this.ui.height=22*.7,this.lastKey=this.charNameMeshVo.name,LabelTextFont.writeSingleLabel(this.parent.uiAtlas,this.textureStr,this.charNameMeshVo.name,20,TextAlign.CENTER,"#ffffff","#27262e")),this.charNameMeshVo.needDraw=!1)},b.prototype.update=function(){if(this.charNameMeshVo){if(this.charNameMeshVo.needDraw&&this.makeData(),this.charNameMeshVo.pos)if(this.charNameMeshVo.visible){if(this.needUpData(this.charNameMeshVo.pos)||this.charNameMeshVo.visibleChange){var a=Scene_data.cam3D.cameraMatrix.clone(this.tempMatrix);a.append(Scene_data.viewMatrx3D);var b=a.transformVector(this.charNameMeshVo.pos);this.ui.x=(b.x/b.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,this.ui.y=(-b.y/b.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2,this.oldPos.x=this.charNameMeshVo.pos.x,this.oldPos.y=this.charNameMeshVo.pos.y,this.charNameMeshVo.visibleChange=!1}}else this.ui.x=1e4;this.charNameMeshVo.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},b}(Disp2DBaseText);a.CharNameUiVo=e;var f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.tempMatrix=new Matrix3D,b}return __extends(b,a),b.prototype.makeData=function(){var a=this;this._data&&(this._charTitleMeshVo=this.data,LoadManager.getInstance().load(Scene_data.fileRoot+getUItittleUrl(String(this._charTitleMeshVo.num)),LoadManager.IMG_TYPE,function(b){var c=a.parent.uiAtlas.getRec(a.textureStr);a.parent.uiAtlas.ctx=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);var d=Math.min(c.pixelWitdh/b.width,c.pixelHeight/b.height);d=Math.min(d,1);var e=b.width*d,f=b.height*d;a.parent.uiAtlas.ctx.drawImage(b,(c.pixelWitdh-e)/2,(c.pixelHeight-f)/2,e,f),TextureManager.getInstance().updateTexture(a.parent.uiAtlas.texture,c.pixelX,c.pixelY,a.parent.uiAtlas.ctx)}))},b.prototype.update=function(){if(this._charTitleMeshVo){if(this._charTitleMeshVo.needDraw&&(this.makeData(),this._charTitleMeshVo.needDraw=!1),this._charTitleMeshVo.pos)if(this._charTitleMeshVo.visible){if(this.needUpData(this._charTitleMeshVo.pos)){var a=Scene_data.cam3D.cameraMatrix.clone(this.tempMatrix);a.append(Scene_data.viewMatrx3D);var b=a.transformVector(this._charTitleMeshVo.pos);this.ui.x=(b.x/b.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,this.ui.y=(-b.y/b.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2,this.oldPos.x=this._charTitleMeshVo.pos.x,this.oldPos.y=this._charTitleMeshVo.pos.y}}else this.ui.x=1e4;this._charTitleMeshVo.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},b}(Disp2DBaseText);a.CharTitleUiVo=f;var g=function(){function a(){this._visible=!0,this.visibleChange=!1,this.clear=!1}return Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible=a,this.visibleChange=!0},enumerable:!0,configurable:!0}),a}();a.baseMeshVo=g}(bloodTittle||(bloodTittle={}));var CharTitleMeshVo=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.destory=function(){this.pos=null,this._num=null,this.clear=!0},Object.defineProperty(b.prototype,"num",{get:function(){return this._num},set:function(a){this._num=a,this.needDraw=!0},enumerable:!0,configurable:!0}),b}(bloodTittle.baseMeshVo),CharNameMeshVo=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),Object.defineProperty(b.prototype,"name",{get:function(){return this._name},set:function(a){this._name=a,this.needDraw=!0},enumerable:!0,configurable:!0}),b.prototype.destory=function(){this.pos=null,this._name=null,this.needDraw=null,this.clear=!0},b}(bloodTittle.baseMeshVo),BloodLineMeshVo=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.destory=function(){this.pos=null,this.num=null,this.colortype=null,this.clear=!0},b}(bloodTittle.baseMeshVo),JumpTextMeshVo=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.destory=function(){this.pos=null,this.clear=!0},b}(bloodTittle.baseMeshVo),JumpTxtContianerPanel=function(a){function b(b,c,d){return a.call(this,b,c,d)||this}return __extends(b,a),b}(Dis2DUIContianerPanel),BloodManager=function(){function a(){this.uiContianerItem=new Array,this._charTitleContianerPanel=new Dis2DUIContianerPanel(bloodTittle.CharTitleUiVo,new Rectangle(0,0,131,69),10),this._charNameContianerPanel=new Dis2DUIContianerPanel(bloodTittle.CharNameUiVo,new Rectangle(0,0,256,24),50),this._jumpTxtContianerPanel=new AlphaUiContianer(bloodTittle.TextJumpUiDrawAndRefreash,new Rectangle(0,0,256,50),10),this._bloodLineUIConatiner=new bloodTittle.BloodLineUIConatiner,this.uiContianerItem.push(this._charTitleContianerPanel),this.uiContianerItem.push(this._charNameContianerPanel),this.uiContianerItem.push(this._jumpTxtContianerPanel),this.uiContianerItem.push(this._bloodLineUIConatiner)}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getCharTitleMeshVo=function(a){void 0===a&&(a=0);var b=new CharTitleMeshVo;return b.num=a,b.pos=new Vector3D(0,50,0),this._charTitleContianerPanel.showTemp(b),b},a.prototype.getCharNameMeshVo=function(a){void 0===a&&(a="测试名");var b=new CharNameMeshVo;return b.name=a,b.pos=new Vector3D(0,50,0),this._charNameContianerPanel.showTemp(b),b},a.prototype.getBloodLineMeshVo=function(){var a=new BloodLineMeshVo;return a.num=100,a.colortype=0,a.pos=new Vector3D(0,50,0),this._bloodLineUIConatiner.showTemp(a),a},a.prototype.setJumpNum=function(a){this._jumpTxtContianerPanel.showTemp(a)},a.prototype.update=function(){for(var a=0;a<this.uiContianerItem.length;a++){this.uiContianerItem[a].update(0);for(var b=0;b<this._bloodLineUIConatiner.renderList.length;b++)this.uiContianerItem[a].renderList[b].update()}},a.prototype.resize=function(){this._jumpTxtContianerPanel.resize();for(var a=0;a<this.uiContianerItem.length;a++)this.uiContianerItem[a].resize();Scene_data.cam3D.needChange=!0},a}();!function(a){var b=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec3 v2uv;uniform vec4 ui[30];uniform vec4 lifenum[30];varying vec2 v_texCoord;\nvarying vec4 v_lifenum;\nvoid main(void){ v_lifenum = lifenum[int(v2uv.z)]; v_texCoord = vec2(v2uv.x , v2uv.y ); vec4  data = ui[int(v2uv.z)];   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy *data.zw * 2.0;   pos.x += data.x * 2.0 - 1.0;   pos.y += -data.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvarying vec4 v_lifenum;\nvoid main(void)\n{\nvec2  v_uv = v_texCoord;if(v_texCoord.x<v_lifenum.x){;\nv_uv.y = v_uv.y+v_lifenum.y;};\nvec4 infoUv = texture2D(s_texture, v_uv.xy);\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}";return a},b.BloodUIShader="BloodUIShader",b}(Shader3D);a.BloodUIShader=b;var c=function(a){function b(){var b=a.call(this)||this;return b.lifeNum=100,b.colortype=0,b}return __extends(b,a),b.prototype.pushVaData=function(a,b,c){return a.vertices.push(0,0,0,1,0,0,1,-1,0,0,-1,0),a.uvs.push(0,0,b,1,0,b,1,.25,b,0,.25,b),a.indexs.push(c,1+c,2+c,c,2+c,3+c),c+4},b}(UICompenent);a.BloodUICompenent=c;var d=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.tempMatrix=new Matrix3D,b}return __extends(b,a),b.prototype.makeData=function(){
this._data&&(this.bloodLineMeshVo=this.data)},b.prototype.update=function(){if(this.bloodLineMeshVo){if(this.bloodLineMeshVo.pos)if(this.bloodLineMeshVo.visible){if(this.needUpData(this.bloodLineMeshVo.pos)||this.bloodLineMeshVo.visibleChange){var a=Scene_data.cam3D.cameraMatrix.clone(this.tempMatrix);a.append(Scene_data.viewMatrx3D);var b=a.transformVector(new Vector3D(this.bloodLineMeshVo.pos.x,this.bloodLineMeshVo.pos.y,this.bloodLineMeshVo.pos.z));this.ui.x=(b.x/b.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,this.ui.y=(-b.y/b.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2,this.bloodLineMeshVo.visibleChange=!1}this.ui.lifeNum=this.bloodLineMeshVo.num,this.ui.colortype=this.bloodLineMeshVo.colortype}else this.ui.x=1e4;this.bloodLineMeshVo.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},b}(Disp2DBaseText);a.BloodDisp2DBaseText=d;var e=function(a){function d(){var b=a.call(this)||this;return b.nextTime=0,b}return __extends(d,a),d.prototype.initData=function(){this._uiList=new Array,this.objData=new ObjData,ProgrmaManager.getInstance().registe(b.BloodUIShader,new b),this.shader=ProgrmaManager.getInstance().getProgram(b.BloodUIShader),this.program=this.shader.program,this.uiProLocation=Scene_data.context3D.getLocation(this.program,"ui"),this.ui2ProLocation=Scene_data.context3D.getLocation(this.program,"lifenum")},d.prototype.update=function(){if(this.visible&&0!=this._uiList.length){if(Scene_data.context3D.setBlendParticleFactors(this.blenderMode),Scene_data.context3D.setProgram(this.program),this.nextTime<TimeUtil.getTimer()||this.renderData2.length!=4*this._uiList.length){this.renderData2.length!=4*this._uiList.length&&(this.renderData2=new Float32Array(4*this._uiList.length));for(var a=0;a<this._uiList.length;a++){var b=this._uiList[a],c=b.lifeNum/100,d=8*(b.colortype+1)/32;this.renderData2[4*a+0]=c,this.renderData2[4*a+1]=d}this.nextTime=TimeUtil.getTimer()+300}if(Scene_data.context3D.setVc4fvLocation(this.uiProLocation,this.renderData),Scene_data.context3D.setVc4fvLocation(this.ui2ProLocation,this.renderData2),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),this.uiAtlas&&Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.uiAtlas.texture,0),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum),this.modelRenderList)for(var a=0;a<this.modelRenderList.length;a++)this.modelRenderList[a].update()}},d.prototype.creatBaseComponent=function(a){var b=new c;return b.tr.setRec(new UIRectangle(0,0,1,1)),b.width=64,b.height=8,b.uiRender=this,b.lifeNum=100,b},d.prototype.makeRenderDataVc=function(a){if((!this.renderData||this.renderData&&this.renderData.length!=4*this._uiList.length)&&(this.renderData=new Float32Array(4*this._uiList.length)),-1==a)for(var b=0;this._uiList&&b<this._uiList.length;b++)this._uiList[b].vcId=b,this.renderData[4*b+0]=this._uiList[b].renderData[0],this.renderData[4*b+1]=this._uiList[b].renderData[1],this.renderData[4*b+2]=this._uiList[b].renderData[2],this.renderData[4*b+3]=this._uiList[b].renderData[3];else a<this._uiList.length&&(this.renderData[4*a+0]=this._uiList[a].renderData[0],this.renderData[4*a+1]=this._uiList[a].renderData[1],this.renderData[4*a+2]=this._uiList[a].renderData[2],this.renderData[4*a+3]=this._uiList[a].renderData[3])},d}(UIRenderComponent);a.BloodUIRenderComponent=e;var f=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b._baseRender=new e,b.addRender(b._baseRender),b._baseRender.uiAtlas=new UIAtlas,b._baseRender.uiAtlas.configData=new Array,b._uiItem=new Array,b.loadBloodTexture(),b}return __extends(b,a),b.prototype.loadBloodTexture=function(){var a=this;TextureManager.getInstance().getTexture(Scene_data.fileRoot+"ui/load/blood.png",function(b){a._baseRender.uiAtlas.textureRes=b})},b.prototype.update=function(a){if(this._baseRender.uiAtlas.textureRes)for(var b=0;b<this._uiItem.length;b++)this._uiItem[b].data&&this._uiItem[b].update()},b.prototype.removeChild=function(b){for(var c=0;c<this._uiItem.length;c++)if(this._uiItem[c].ui==b){this._uiItem.splice(c,1);break}a.prototype.removeChild.call(this,b)},b.prototype.showTemp=function(a){if(this._uiItem.length>=50)return void console.log("超过50。暂时设置不可再添加");var b=new d;b.parent=this._baseRender,b.ui=this._baseRender.creatBaseComponent("test"),b.data=a,this.addChild(b.ui),this._uiItem.push(b)},b}(UIConatiner);a.BloodLineUIConatiner=f}(bloodTittle||(bloodTittle={}));var Curve=function(){function a(){this.valueV3d=[1,1,1,1]}return a.prototype.getValue=function(a){if(!this.valueVec||-1==this.begintFrame)return this.valueV3d;var b=float2int(a/Scene_data.frameTime-this.begintFrame);return 0>b?b=0:b>this.maxFrame-this.begintFrame&&(b=this.maxFrame-this.begintFrame),this.valueVec[b]},a.prototype.setData=function(a){this.type=a.type,this.maxFrame=a.maxFrame,a.items.length?this.begintFrame=a.items[0].frame:this.begintFrame=-1;for(var b=a.values[0].length,c=new Array,d=0;b>d;d++){var e=new Array;if(1==this.type)e.push(a.values[0][d]);else if(2==this.type)e.push(a.values[0][d],a.values[1][d]);else if(3==this.type)e.push(a.values[0][d],a.values[1][d],a.values[2][d]);else if(4==this.type){var f=a.values[3][d];e.push(a.values[0][d]*f,a.values[1][d]*f,a.values[2][d]*f,f)}c.push(e)}this.valueVec=c},a}(),Shadow=function(){function a(){this._visible=!1,this.data=[0,0,0,5]}return Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible=a,this.display.stateChage()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.data[1]=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"z",{get:function(){return this.data[2]},set:function(a){this.data[2]=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"size",{get:function(){return this.data[3]},set:function(a){this.data[3]=a},enumerable:!0,configurable:!0}),a}(),ShadowManager=function(){function a(){this._displayList=new Array,ProgrmaManager.getInstance().registe(Display3DShadowShader.Display3DShadowShader,new Display3DShadowShader)}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.addShadow=function(){var a=this.getIdleShadow(),b=new Shadow;return a.addShadow(b),b},a.prototype.removeShadow=function(a){a.display.removeShadow(a)},a.prototype.update=function(){if(this._displayList.length){Scene_data.context3D.setWriteDepth(!1);for(var a=0;a<this._displayList.length;a++)this._displayList[a].update();Scene_data.context3D.setWriteDepth(!0)}},a.prototype.getIdleShadow=function(){for(var a=0;a<this._displayList.length;a++)if(this._displayList[a].hasIdle())return this._displayList[a];var b=new Display3dShadow;return this._displayList.push(b),b},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BaseRes=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.allImgBytes=1e7,b}return __extends(b,a),b.prototype.read=function(a){void 0===a&&(a=null),this._imgFun=a;var c=this._byte.readInt();c==b.IMG_TYPE?Scene_data.supportBlob?this.readImg():this.readImgLow():c==b.OBJS_TYPE?this.readObj(this._byte):c==b.MATERIAL_TYPE?this.readMaterial():c==b.PARTICLE_TYPE?this.readParticle():c==b.ZIP_OBJS_TYPE&&this.readZipObj()},b.prototype.readZipObj=function(){var a=this._byte.readInt(),b=this._byte.buffer.slice(this._byte.position,this._byte.position+a);this._byte.position+=a;var c=unZip(b),d=new ByteArray(c);this.readObj(d)},b.prototype.readImg=function(){var a=this;this.imgNum=this._byte.readInt(),this.imgLoadNum=0;for(var b=(TimeUtil.getTimer(),new Array),c=new Array,d=0;d<this.imgNum;d++){var e=Scene_data.fileRoot+this._byte.readUTF(),f=this._byte.readInt();if(-1==e.search(".jpng")){var g=this._byte.buffer.slice(this._byte.position,this._byte.position+f);this._byte.position+=f;var h=new Blob([g],{type:"application/octet-binary"});b.push(h),c.push(e)}else this.readJpngImg(e)}for(var d=0;d<b.length;d++){var i=new Image;i.url=c[d],i.onload=function(b){a.loadImg(b.target);var c=b.target;URL.revokeObjectURL(c.src)},i.src=URL.createObjectURL(b[d])}},b.prototype.readJpngImg=function(a){var b=this,c=this._byte.readInt(),d=this._byte.buffer.slice(this._byte.position,this._byte.position+c);this._byte.position+=c;var e=new Blob([d],{type:"application/octet-binary"}),f=this._byte.readInt();d=this._byte.buffer.slice(this._byte.position,this._byte.position+f),this._byte.position+=f;var g=new Blob([d],{type:"application/octet-binary"}),h=new Image,i=new Image,j=0,k=function(c){if(j++,!(2>j)){var d=UIManager.getInstance().getContext2D(h.width,h.height);d.drawImage(h,0,0);var e=d.getImageData(0,0,h.width,h.height);d.clearRect(0,0,h.width,h.height),d.drawImage(i,0,0);for(var f=d.getImageData(0,0,h.width,h.height),g=0;g<e.data.length;g+=4){f.data[g]/255;e.data[g+3]=f.data[g]}b.addImg(a.replace(".jpng",".png"),e)}};h.onload=k,i.onload=k,h.src=URL.createObjectURL(e),i.src=URL.createObjectURL(g)},b.prototype.readImgLow=function(){var a=this;this.imgNum=this._byte.readInt(),this.imgLoadNum=0;for(var b=(TimeUtil.getTimer(),0),c=0;c<this.imgNum;c++){var d=Scene_data.fileRoot+this._byte.readUTF(),e=this._byte.readInt();b+=e;var f=new Image;f.url=d,f.onload=function(b){a.loadImg(b.target)},f.src=d}this.allImgBytes=b},b.prototype.loadImg=function(a){TextureManager.getInstance().addRes(a.url,a),this.countImg()},b.prototype.addImg=function(a,b){TextureManager.getInstance().addRes(a,b),this.countImg()},b.prototype.countImg=function(){this.imgLoadNum++,this.imgLoadNum==this.imgNum&&(this._imgComplete=!0,this.allResCom())},b.prototype.readObj=function(a){for(var b=a.readInt(),c=0;b>c;c++){var d=Scene_data.fileRoot+a.readUTF(),e=a.readInt(),f=new ByteArray;f.length=e,a.readBytes(f,0,e);ObjDataManager.getInstance().loadObjCom(f.buffer,d)}this._imgFun&&this._imgFun()},b.prototype.readMaterial=function(){for(var a=this._byte.readInt(),b=(TimeUtil.getTimer(),0);a>b;b++){var c=Scene_data.fileRoot+this._byte.readUTF(),d=this._byte.readInt(),e=new ByteArray;e.length=d,this._byte.readBytes(e,0,d),MaterialManager.getInstance().addResByte(c,e)}},b.prototype.readParticle=function(){for(var a=this._byte.readInt(),b=(TimeUtil.getTimer(),0);a>b;b++){var c=Scene_data.fileRoot+this._byte.readUTF(),d=this._byte.readInt(),e=new ByteArray;e.length=d,this._byte.readBytes(e,0,d),ParticleManager.getInstance().addResByte(c,e)}},b.prototype.readMaterialInfo=function(){var a=this._byte.readInt();if(a>0){for(var b=new Array,c=0;a>c;c++){var d=new Object;d.type=this._byte.readInt(),d.name=this._byte.readUTF(),0==d.type&&(d.url=this._byte.readUTF()),1==d.type&&(d.x=this._byte.readFloat()),2==d.type&&(d.x=this._byte.readFloat(),d.y=this._byte.readFloat()),3==d.type&&(d.x=this._byte.readFloat(),d.y=this._byte.readFloat(),d.z=this._byte.readFloat()),b.push(d)}return b}return null},b.readFloatTwoByte=function(a,b){var c=a.readInt();if(c>0){var d=a.readFloat();b.length=0;for(var e=0;c>e;e++)b.push(a.readFloatTwoByte(d))}},b.readFloatOneByte=function(a,b){var c=a.readInt();if(c>0)for(var d=0;c>d;d++)b.push((a.readByte()+128)/256)},b.readIntForTwoByte=function(a,b){for(var c=a.readInt(),d=0;c>d;d++)b.push(a.readShort())},b.readIntForOneByte=function(a,b){for(var c=a.readInt(),d=0;c>d;d++)b.push(a.readByte())},b.readBytes2ArrayBuffer=function(a,b,c,d,e,f){void 0===f&&(f=0);var g=a.readInt();if(!(0>=g)){var h;0==f&&(h=a.readFloat());for(var i=g/c,j=0;i>j;j++)for(var k=e*j+d,l=0;c>l;l++)0==f?b.setFloat32(4*(k+l),a.readFloatTwoByte(h),!0):1==f?b.setFloat32(4*(k+l),a.readFloatOneByte(),!0):2==f?b.setFloat32(4*(k+l),a.readByte(),!0):3==f?b.setFloat32(4*(k+l),(a.readByte()+128)/255,!0):4==f&&b.setFloat32(4*(k+l),a.readFloat(),!0)}},b.readMaterialParamData=function(a){var b=a.readInt();if(b>0){for(var c=new Array,d=0;b>d;d++){var e=new Object;e.name=a.readUTF(),e.type=a.readByte(),0==e.type?e.url=a.readUTF():1==e.type?e.x=a.readFloat():2==e.type?(e.x=a.readFloat(),e.y=a.readFloat()):3==e.type&&(e.x=a.readFloat(),e.y=a.readFloat(),e.z=a.readFloat()),c.push(e)}return c}return null},b.prototype.allResCom=function(){this._imgFun&&this._imgFun()},b.IMG_TYPE=1,b.OBJS_TYPE=2,b.MATERIAL_TYPE=3,b.PARTICLE_TYPE=4,b.SCENE_TYPE=5,b.ZIP_OBJS_TYPE=6,b.PREFAB_TYPE=1,b.SCENE_PARTICLE_TYPE=11,b}(ResCount),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ResManager=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.loadRoleRes=function(a,b,c){var d=new RoleRes;d.meshBatchNum=c,d.load(a,function(){b(d)})},b.prototype.loadSkillRes=function(a,b){var c=new SkillRes;c.load(a,function(){b(c)})},b.prototype.loadSceneRes=function(a,b,c,d){var e;return this._dic[a]?e=this._dic[a]:(e=new SceneRes,this._dic[a]=e),e.load(a,b,c,d),this.clearSceneUse(e),e},b.prototype.clearSceneUse=function(a){for(var b in this._dic){var c=this._dic[b];c.useNum>0&&c!=a&&(c.useNum=0)}a.useNum=1},b.prototype.gc=function(){for(var a in this._dic){var b=this._dic[a];b.useNum<=0&&(b.idleTime++,b.idleTime>=ResCount.GCTime&&(console.log("清理 -"+a),b.destory(),delete this._dic[a]))}},b}(ResGC),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),RoleRes=function(a){function b(){var b=a.call(this)||this;return b.meshBatchNum=1,b}return __extends(b,a),b.prototype.load=function(a,b){var c=this;this._fun=b,LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(a){c.loadComplete(a)})},b.prototype.loadComplete=function(a){this._byte=new ByteArray(a),this._byte.position=0,this.version=this._byte.readInt(),this.readMesh()},b.prototype.readMesh=function(){this.roleUrl=this._byte.readUTF(),this.version>=16&&(this.ambientLightColor=new Vector3D,this.sunLigthColor=new Vector3D,this.nrmDircet=new Vector3D,this.ambientLightColor.x=this._byte.readFloat(),this.ambientLightColor.y=this._byte.readFloat(),this.ambientLightColor.z=this._byte.readFloat(),this.ambientLightIntensity=this._byte.readFloat(),this.ambientLightColor.scaleBy(this.ambientLightIntensity),this.sunLigthColor.x=this._byte.readFloat(),this.sunLigthColor.y=this._byte.readFloat(),this.sunLigthColor.z=this._byte.readFloat(),this.sunLigthIntensity=this._byte.readFloat(),this.sunLigthColor.scaleBy(this.sunLigthIntensity),this.nrmDircet.x=this._byte.readFloat(),this.nrmDircet.y=this._byte.readFloat(),this.nrmDircet.z=this._byte.readFloat()),MeshDataManager.getInstance().readData(this._byte,this.meshBatchNum,this.roleUrl,this.version),this.readAction()},b.prototype.readAction=function(){var a,b=this;a=this.version>=30?getZipByte(this._byte):this._byte,this.actionAry=new Array;for(var c=a.readInt(),d=0;c>d;d++){var e=a.readUTF();AnimManager.getInstance().readData(a,this.roleUrl+e),this.actionAry.push(e)}this.read(function(){b.readNext()})},b.prototype.readNext=function(){this.read(),this.read(),this._fun()},b}(BaseRes),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillRes=function(a){function b(){var b=a.call(this)||this;return b.meshBatchNum=1,b}return __extends(b,a),b.prototype.load=function(a,b){var c=this;this._fun=b,LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(a){c.loadComplete(a)})},b.prototype.loadComplete=function(a){var b=this;this._byte=new ByteArray(a),this._byte.position=0,this.version=this._byte.readInt(),this.skillUrl=this._byte.readUTF(),this.read(function(){b.readNext()})},b.prototype.readNext=function(){if(this.read(),this.read(),this.version<27){this._byte.readUTF()}this.data=this.readData(this._byte),this._fun()},b.prototype.readData=function(a){for(var b=a.readInt(),c=new Object,d=0;b>d;d++){var e=new Object,f=a.readUTF(),g=a.readUTF();if(e.skillname=f,e.action=g,e.type=a.readFloat(),this.version>=26?(e.blood=a.readInt(),0==e.blood&&(e.blood=SkillVo.defaultBloodTime)):e.blood=SkillVo.defaultBloodTime,this.version>=32){var h=a.readInt();if(h>0){var i=a.readUTF();e.sound={time:h,name:i}}}if(this.version>=33){var j=a.readInt();if(j){for(var k=new Array,l=0;j>l;l++){var m=new Object;m.time=a.readInt(),m.lasttime=a.readInt(),m.amp=a.readFloat(),k.push(m)}e.shock=k}}e.data=new Array;for(var n=a.readInt(),o=0;n>o;o++){var p=new Object;switch(p.url=a.readUTF(),p.frame=a.readFloat(),e.type){case 1:p.beginType=a.readInt(),0==p.beginType?(p.beginPos=new Vector3D,p.beginPos.x=a.readFloat(),p.beginPos.y=a.readFloat(),p.beginPos.z=a.readFloat()):1==p.beginType&&(p.beginSocket=a.readUTF()),p.hitSocket=a.readUTF(),p.endParticle=a.readUTF(),p.multype=a.readInt(),p.speed=a.readFloat();break;case 3:p.beginSocket=a.readUTF(),p.beginType=a.readFloat(),p.multype=a.readFloat(),p.speed=a.readFloat();break;case 4:if(this.version>=27){var q=a.readBoolean();p.hasSocket=q,q?p.socket=a.readUTF():(p.pos=this.readV3d(a),p.rotation=this.readV3d(a))}else p.hasSocket=!1,p.pos=this.readV3d(a),p.rotation=this.readV3d(a);break;default:alert("没有类型readData")}e.data.push(p)}c[f]=e}return c},b.prototype.readV3d=function(a){var b=new Vector3D;return b.x=a.readFloat(),b.y=a.readFloat(),b.z=a.readFloat(),b.w=a.readFloat(),b},b}(BaseRes),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ModelRes=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.load=function(a,b){var c=this;this._fun=b,LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(a){c.loadComplete(a)})},b.prototype.loadComplete=function(a){var b=this;this._byte=new ByteArray(a),this._byte.position=0,this.read(function(){b.readNexte()})},b.prototype.readNexte=function(){this.read(),this.read(),this.objUrl=this._byte.readUTF(),this.materialUrl=this._byte.readUTF(),this._byte.readBoolean()&&(this.light=new LightVo,this.light.ambientColor[0]=this._byte.readFloat(),this.light.ambientColor[1]=this._byte.readFloat(),this.light.ambientColor[2]=this._byte.readFloat(),this.light.sunColor[0]=this._byte.readFloat(),this.light.sunColor[1]=this._byte.readFloat(),this.light.sunColor[2]=this._byte.readFloat(),this.light.sunDirect[0]=this._byte.readFloat(),this.light.sunDirect[1]=this._byte.readFloat(),this.light.sunDirect[2]=this._byte.readFloat()),this._fun()},b}(BaseRes),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GroupRes=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.load=function(a,b){var c=this;this._fun=b,LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(a){c.loadComplete(a)})},b.prototype.loadComplete=function(a){var b=this;this.dataAry=new Array,this._byte=new ByteArray(a),this._byte.position=0,this.version=this._byte.readInt(),this.read(function(){b.readNext()})},b.prototype.readNext=function(){this.read(),this.read(),this.read();var a=this._byte.readBoolean();if(a)for(var b=this._byte.readInt(),c=0;b>c;c++)this.readItem(!0);else this.readItem(!1);this._fun(),this._fun=null,this._byte=null},b.prototype.readItem=function(a){var b=this._byte.readInt(),c=new GroupItem;c.isGroup=a,a&&(c.x=this._byte.readFloat(),c.y=this._byte.readFloat(),c.z=this._byte.readFloat(),c.scaleX=this._byte.readFloat(),c.scaleY=this._byte.readFloat(),c.scaleZ=this._byte.readFloat(),c.rotationX=this._byte.readFloat(),c.rotationY=this._byte.readFloat(),c.rotationZ=this._byte.readFloat()),b==BaseRes.PREFAB_TYPE?(c.objUrl=this._byte.readUTF(),c.materialUrl=this._byte.readUTF(),this.version>=4&&(c.materialInfoArr=this.readMaterialInfo()),c.types=BaseRes.PREFAB_TYPE):b==BaseRes.SCENE_PARTICLE_TYPE&&(c.particleUrl=this._byte.readUTF(),c.types=BaseRes.SCENE_PARTICLE_TYPE),this.dataAry.push(c)},b.prototype.initReg=function(){this._objDic=new Object,this._materialDic=new Object,this._particleDic=new Object;for(var a=0;a<this.dataAry.length;a++){var b=this.dataAry[a];b.objUrl&&(this._objDic[Scene_data.fileRoot+b.objUrl]=!0),b.materialUrl&&(this._materialDic[Scene_data.fileRoot+b.materialUrl]=!0),b.particleUrl&&(this._particleDic[Scene_data.fileRoot+b.particleUrl]=!0)}for(var c in this._objDic)ObjDataManager.getInstance().registerUrl(c);for(var c in this._materialDic)MaterialManager.getInstance().registerUrl(c);for(var c in this._particleDic)ParticleManager.getInstance().registerUrl(c)},b.prototype.destory=function(){a.prototype.destory.call(this);for(var b in this._objDic)ObjDataManager.getInstance().releaseUrl(b);for(var b in this._materialDic)MaterialManager.getInstance().releaseUrl(b);for(var b in this._particleDic)ParticleManager.getInstance().releaseUrl(b);this.dataAry=null,this._objDic=null,this._particleDic=null,this._materialDic=null},b}(BaseRes),GroupItem=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(Object3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneRes=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.load=function(a,c,d,e){var f=this;if(this.sceneData)return void(this.isNeedReload()?(c(),d(1),this.applyByteArray()):(c(),d(1),e(this.sceneData)));this._completeFun=c,this._readDataFun=e,this._progressFun=d;var g=b.sceneConfigData;g&&g[a]?this.loadZipMap(a,g[a].len):(a=Scene_data.fileRoot+getMapUrl(a),LoadManager.getInstance().load(a,LoadManager.BYTE_TYPE,function(a){f.loadComplete(a)},null,d))},b.prototype.loadZipMap=function(a,b){for(var c=this,d=new Array,e=new Array,f=0,g=new Array,h=0;b>h;h++)g[h]=0;for(var i=function(a){var b=a.response,g=d.indexOf(a);if(e[g]=b,f++,f==d.length){for(var h=0,i=0;i<e.length;i++)h+=e[i].byteLength;for(var j=new Uint8Array(h),k=0,i=0;i<e.length;i++)j.set(new Uint8Array(e[i]),k),k+=e[i].byteLength;c.loadComplete(j.buffer)}},j=function(a,e){var f=d.indexOf(a);g[f]=e;for(var h=0,i=0;b>i;i++)h+=g[i];h/=b,c._progressFun(h)},h=0;b>h;h++){var k=new XMLHttpRequest;k.onreadystatechange=function(a){var b=a.target;200==b.status&&4==b.readyState&&i(b)},k.onprogress=function(a){var b=a.target;j(b,a.loaded/a.total)};var l=Scene_data.fileRoot+getZipMapUrl(a)+h+".txt";d.push(k),k.open("GET",l,!0),k.responseType="arraybuffer",k.send()}},b.prototype.isNeedReload=function(){for(var a=this.sceneData.buildItem,b=0;b<a.length;b++)if(a[b].type==BaseRes.PREFAB_TYPE&&a[b].lighturl){var c=Scene_data.fileRoot+a[b].lighturl;return TextureManager.getInstance().hasTexture(c)?!1:!0}return ResCount.GCTime-this.idleTime<10},b.prototype.loadComplete=function(a){this._byte=new ByteArray(a),this._completeFun(),this.applyByteArray()},b.prototype.applyByteArray=function(){var a=this;this._byte.position=0,this.version=this._byte.readInt(),this.read(function(){a.readNext()})},b.prototype.readNext=function(){this.read(),this.read(),this.read(),this.readScene(),this._readDataFun(this.sceneData)},b.prototype.readScene=function(){this._byte.readInt();this.readAstat(),this.version>=28&&this.readTerrainIdInfoBitmapData(this._byte);var a=this._byte.readInt();this.sceneData=JSON.parse(this._byte.readUTFBytes(a)),this.sceneData.astar=this._astarDataMesh,this.sceneData.terrain=this._terrainDataItem},b.prototype.readTerrainIdInfoBitmapData=function(a){var b=a.readInt();if(b){var c=b,d=a.buffer.slice(a.position,a.position+c);a.position+=c;var e=unZip(d),f=new ByteArray(e);this._terrainDataItem=GroundDataMesh.meshAllgroundData(f)}},b.prototype.readAstat=function(){var a=this._byte.readBoolean();if(a){this._astarDataMesh=new AstarDataMesh,this._astarDataMesh.aPos=new Vector3D,this._astarDataMesh.astarItem=new Array,this._astarDataMesh.heightItem=new Array,this._astarDataMesh.jumpItem=new Array,this._astarDataMesh.midu=this._byte.readFloat(),this._astarDataMesh.aPos.x=this._byte.readFloat(),this._astarDataMesh.aPos.y=this._byte.readFloat(),this._astarDataMesh.aPos.z=this._byte.readFloat();var b,c,d=this._byte.readInt(),e=this._byte.readInt();if(this._astarDataMesh.width=d,this._astarDataMesh.height=e,this.version<25){for(b=0;e>b;b++){var f=new Array;for(c=0;d>c;c++)f.push(this._byte.readFloat());this._astarDataMesh.astarItem.push(f)}for(b=0;e>b;b++){var g=new Array;for(c=0;d>c;c++)g.push(this._byte.readFloat());this._astarDataMesh.heightItem.push(g)}}else{var h=this._byte.readFloat(),i=this.readAstarFromByte(this._byte),j=this.readAstarFromByte(this._byte),k=0,l=0;for(b=0;e>b;b++){var f=new Array,m=new Array;for(c=0;d>c;c++){var n=i[k++];if(f.push(n),1==n){var o=j[l++];m.push(o)}else m.push(0)}this._astarDataMesh.astarItem.push(f),this._astarDataMesh.jumpItem.push(m)}for(this._astarDataMesh.jumpItem,b=0;e>b;b++){var g=new Array;for(c=0;d>c;c++)g.push(this._byte.readShort()/h);this._astarDataMesh.heightItem.push(g)}}}},b.prototype.readAstarFromByte=function(a){for(var b=a.readUnsignedInt(),c=Math.ceil(b/32),d=new Array,e=0;c>e;e++)for(var f=a.readUnsignedInt(),g=0;32>g;g++){var h=1&f;d.length<b&&d.push(h),f>>=1}return d},b}(BaseRes),AstarDataMesh=function(){function a(){}return a}(),NetEventDispatcher=function(){function a(b){void 0===b&&(b=0),this._callback_index=0,this._event_key_type=b,b==a.KEY_TYPE_STRING?this._event_id_str=new Array:b==a.KEY_TYPE_INT?this._event_id_int=new Array:b==a.KEY_TYPE_INT_MASK&&(this._event_id_int_mask=new Array),this._event_callback=new Array,this._event_index=new Array}return a.prototype.DispatchIndex=function(b){var c;if(this._event_key_type==a.KEY_TYPE_STRING)for(c in this._event_index)this._event_callback[this._event_index[c]](b);else if(this._event_key_type==a.KEY_TYPE_INT)for(c in this._event_index)this._event_callback[this._event_index[c]](b);else if(this._event_key_type==a.KEY_TYPE_INT_MASK)for(c in this._event_index)this._event_callback[this._event_index[c]](b)},a.prototype.DispatchString=function(b,c){if(this._event_key_type!=a.KEY_TYPE_STRING)throw new Error("this.DispatchIndex/this._event_key_type != NetEventDispatcher.KEY_TYPE_STRING");this._event_index.length=0;for(var d=this._event_callback.length,e=0;d>e;e++)b==this._event_id_str[e]&&this._event_index.unshift(e);this._event_index.length&&this.DispatchIndex(c)},a.prototype.DispatchInt=function(b,c){if(this._event_key_type!=a.KEY_TYPE_INT)throw new Error("this.DispatchIndex/this._event_key_type != NetEventDispatcher.KEY_TYPE_INT");this._event_index.length=0;for(var d=this._event_callback.length,e=0;d>e;e++)b==this._event_id_int[e]&&this._event_index.unshift(e);this._event_index.length&&this.DispatchIndex(c)},a.prototype.DispatchIntMask=function(b,c){if(this._event_key_type!=a.KEY_TYPE_INT_MASK)throw new Error("this.DispatchIndex/this._event_key_type != NetEventDispatcher.KEY_TYPE_INT_MASK");this._event_index.length=0;for(var d=this._event_callback.length,e=0;d>e;e++)this._event_id_int_mask[e].test(b)&&this._event_index.unshift(e);this._event_index.length&&this.DispatchIndex(c)},a.prototype.Dispatch=function(a,b){this._event_index.length=0;for(var c=this._event_callback.length,d=0;c>d;d++)b(this._event_id_int[d],a)&&this._event_index.unshift(d);this._event_index.length&&this.DispatchIndex(a)},a.prototype.AddListenInt=function(b,c){if(this._event_key_type!=a.KEY_TYPE_INT)throw new Error("AddListenInt but (this._event_key_type != NetEventDispatcher.KEY_TYPE_INT)");for(var d=0;d<this._event_id_int.length;d++)if(this._event_id_int[d]==b&&this._event_callback[d]==c)return;this._event_id_int.push(b),this._event_callback.push(c)},a.prototype.AddListenString=function(b,c){if(this._event_key_type!=a.KEY_TYPE_STRING)throw new Error("AddListenString but (this._event_key_type != NetEventDispatcher.KEY_TYPE_STRING)");for(var d=0;d<this._event_id_str.length;d++)if(this._event_id_str[d]==b&&this._event_callback[d]==c)return;this._event_id_str.push(b),this._event_callback.push(c)},a.prototype.AddListenIntMask=function(b,c){if(this._event_key_type!=a.KEY_TYPE_INT_MASK)throw new Error("AddListenString but (this._event_key_type != NetEventDispatcher.KEY_TYPE_INT_MASK)");for(var d=0;d<this._event_id_int_mask.length;d++)if(this._event_id_int_mask[d].equals(b)&&this._event_callback[d]==c)return;this._event_id_int_mask.push(b.clone()),this._event_callback.push(c)},a.prototype.removeListenerInt=function(b,c){if(void 0===c&&(c=null),this._event_key_type!=a.KEY_TYPE_INT)throw new Error("removeListenerInt but (this._event_key_type != NetEventDispatcher.KEY_TYPE_INT)");for(var d=0;d<this._event_id_int.length;)this._event_id_int[d]!=b||null!=c&&this._event_callback[d]!=c?d++:(this._event_id_int.splice(d,1),this._event_callback.splice(d,1))},a.prototype.removeListenerString=function(b,c){if(void 0===c&&(c=null),this._event_key_type!=a.KEY_TYPE_STRING)throw new Error("removeListenerString but (this._event_key_type != NetEventDispatcher.KEY_TYPE_STRING)");for(var d=0;d<this._event_id_str.length;)this._event_id_str[d]!=b||null!=c&&this._event_callback[d]!=c?d++:(this._event_id_str.splice(d,1),this._event_callback.splice(d,1))},a.prototype.removeListenerUpdateMask=function(b,c){if(void 0===c&&(c=null),this._event_key_type!=a.KEY_TYPE_INT_MASK)throw new Error("removeListenerUpdateMask but ()");for(var d=0;d<this._event_id_int_mask.length;)!this._event_id_int_mask[d].equals(b)||null!=c&&this._event_callback[d]!=c?d++:(this._event_id_int_mask.splice(d,1),this._event_callback.splice(d,1))},a.prototype.AddCallback=function(b){if(this._event_key_type==a.KEY_TYPE_STRING)throw new Error("AddCallback but (this._event_key_type == NetEventDispatcher.KEY_TYPE_STRING)");var c=this._callback_index+1;do{c=this._callback_index+1;for(var d in this._event_id_int)0!=c&&c!=Number(d);this._callback_index=c}while(!1);return this.AddListenInt(c,b),c},a.prototype.Clear=function(){this._event_callback&&(this._event_callback.length=0),this._event_id_int&&(this._event_id_int.length=0),this._event_id_str&&(this._event_id_str.length=0),this._event_index&&(this._event_index.length=0),this._event_id_int_mask&&(this._event_id_int_mask.length=0)},a.KEY_TYPE_INT=0,a.KEY_TYPE_STRING=1,a.KEY_TYPE_INT_MASK=2,a}(),UpdateMask=function(){function a(){this._bytes=new ByteArray,this._bytes.endian=Endian.LITTLE_ENDIAN}return Object.defineProperty(a.prototype,"baseByteArray",{
get:function(){return this._bytes},enumerable:!0,configurable:!0}),a.prototype.Clear=function(){this._bytes.clear()},a.prototype.GetBits=function(a,b){void 0===b&&(b=1);for(var c=0;b>c;c++)if(this.GetBit(a+c))return!0;return!1},a.prototype.GetBit=function(a){return a>>3<this._bytes.length?0!=(this._bytes.getByte(a>>3)&1<<(7&a)):!1},a.prototype.SetBit=function(a){a>>3>=this._bytes.length&&(this._bytes.length=(a>>3)+1),this._bytes.setByte(a>>3,this._bytes.getByte(a>>3)|1<<(7&a))},a.prototype.WriteTo=function(a){return this._bytes.position=0,a.writeShort(this._bytes.length),this._bytes.length&&a.writeBytes(this._bytes),!0},a.prototype.ReadFrom=function(a){this._bytes.clear();var b=a.readUnsignedShort();return this._bytes.length=b,b&&a.readBytes(this._bytes,0,b),!0},a.prototype.GetCount=function(){return this._bytes.length<<3},a.prototype.SetCount=function(a){this._bytes.length=a+7>>3},a.prototype.empty=function(){for(var a=0;a<this._bytes.length;a++)if(0!=this._bytes.getByte(a))return!1;return!0},a.prototype.or=function(a){var b=a._bytes.length;this._bytes.length<b&&(this._bytes.length=b);for(var c=0;b>c;c++)this._bytes[c]|=a._bytes[c]},a.prototype.test=function(a){for(var b=this._bytes.length>a._bytes.length?a._bytes.length:this._bytes.length,c=0;b>c;c++)if(this._bytes[c]&a._bytes[c])return!0;return!1},a.prototype.condense=function(){for(var a=this._bytes.length;a>0&&(a--,0==this._bytes[a]);)this._bytes.length--},a.prototype.equals=function(a){if(this.condense(),a.condense(),this._bytes.length!=a._bytes.length)return!1;for(var b=0;b<this._bytes.length;b++)if(this._bytes[b]!=a._bytes[b])return!1;return!0},a.prototype.clone=function(){for(var b=new a,c=0;c<this._bytes.length;c++)b._bytes[c]=this._bytes[c];return b},a}(),StringIndexer=function(){function a(){this._indexerExp=new Array,this._objs=new Array,this._evFilter=new Array}return a.prototype.createIndex=function(a){var b=this.getIndex(a);return-1==b&&(b=this._indexerExp.length,this._indexerExp[b]=new RegExp(a,"g"),this._objs[b]=new Array,this._evFilter[b]=null),b},a.prototype.getIndex=function(a){var b=-1;for(var c in this._indexerExp){b++;var d=this._indexerExp[c];if(d.source==a)return b}return-1},a.prototype.releaseIndex=function(a){var b=this.getIndex(a);-1!=b&&(this._indexerExp.splice(b,1),this._objs.splice(b,1),this._evFilter.splice(b,1))},a.prototype.test=function(a){for(var b=0;b<this._indexerExp.length;b++)if(this._indexerExp[b].lastIndex=0,this._indexerExp[b].test(a))return b;return-1},a.prototype.insert=function(a){var b=this.test(a.guid);b>=0&&this._objs[b]&&-1==this._objs[b].indexOf(a)&&(this._objs[b][this._objs[b].length]=a)},a.prototype.remove=function(a){var b=this.test(a);if(-1!=b)for(var c=0;c<this._objs[b].length;c++)if(this._objs[b][c].guid==a)return void this._objs[b].splice(c,1)},a.prototype.query=function(a){var b=this.getIndex(a);return-1==b?null:this._objs[b]},a.prototype.get=function(a){return 0>a||a>=this._objs.length?null:this._objs[a]},a.prototype.matchObject=function(a){if(!a)return null;var b=this.test(a.guid);return b>=0?this._evFilter[b]:null},a.prototype.filter=function(a,b){var c=this.getIndex(a);if(0>c||c>=this._objs.length)throw new Error("indexTyp < 0 || indexTyp >= this._objs.length");if(c>=this._evFilter.length)throw new Error("indexTyp >= this._evFilter.length");this._evFilter[c]=b},a.prototype.Clear=function(){if(this._indexerExp&&(this._indexerExp.length=0,this._indexerExp=null),this._objs&&(this._objs.length=0,this._objs=null),this._evFilter)for(;this._evFilter.length;){var a=this._evFilter.shift();a&&a.Clear()}},a}(),SyncEvent=function(){function a(){}return a.init=function(){a.tmpValueBytes=new ByteArray,a.tmpValueBytes.endian=Endian.LITTLE_ENDIAN},a.OBJ_OPT_NEW=1,a.OBJ_OPT_DELETE=2,a.OBJ_OPT_UPDATE=4,a.OBJ_OPT_BINLOG=8,a.OBJ_OPT_U_GUID=16,a.OPT_SET=1,a.OPT_UNSET=2,a.OPT_ADD=4,a.OPT_SUB=8,a.TYPE_UINT32=0,a.TYPE_UINT16=1,a.TYPE_UINT8=2,a.TYPE_BIT=3,a.TYPE_UINT64=4,a.TYPE_INT32=5,a.TYPE_STRING=6,a.TYPE_INT16=7,a.TYPE_FLOAT=9,a.TYPE_DOUBLE=10,a.ATOMIC_OPT_RESULT_NO=0,a.ATOMIC_OPT_RESULT_TRY=1,a.ATOMIC_OPT_RESULT_OK=2,a.ATOMIC_OPT_RESULT_FAILED=-1,a}();SyncEvent.init();var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BinLogStru=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._value_u32_buffer=new DataView(new ArrayBuffer(4)),b._old_value_u32_buffer=new DataView(new ArrayBuffer(4)),b}return __extends(b,a),b.malloc=function(){return 0==b._pool.length?new b:b._pool.pop()},b.free=function(a){a.Clear(),b._pool[b._pool.length]=a},b.prototype.BinLogStru=function(){this.Clear()},Object.defineProperty(b.prototype,"opt",{get:function(){return this._opt},set:function(a){this._opt=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"index",{get:function(){return this._index},set:function(a){this._index=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"offset",{get:function(){return this._value_u32_buffer.getUint8(0)},set:function(a){this._value_u32_buffer.setUint8(0,a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"typ",{get:function(){return this._typ},set:function(a){this._typ=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"atomic_opt",{get:function(){return this._atomic_opt},set:function(a){this._atomic_opt=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"callback_idx",{get:function(){return this._callback_index},set:function(a){this._callback_index=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"uint32",{get:function(){return this._value_u32_buffer.getUint32(0,!0)},set:function(a){this._typ=SyncEvent.TYPE_UINT32,this._value_u32_buffer.setUint32(0,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"int32",{get:function(){if(this._typ!=SyncEvent.TYPE_INT32)throw new Error("get int32 but _typ != SyncEvent.TYPE_INT32!");return this._value_u32_buffer.getInt32(0,!0)},set:function(a){this._typ=SyncEvent.TYPE_INT32,this._value_u32_buffer.setInt32(0,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"bit",{get:function(){if(this._typ!=SyncEvent.TYPE_BIT)throw new Error("get bit but _typ != SyncEvent.TYPE_BIT");return this._value_u32_buffer.getUint32(0,!0)},set:function(a){this._typ=SyncEvent.TYPE_BIT,this._value_u32_buffer.setUint32(0,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"old_int32",{get:function(){if(this._typ!=SyncEvent.TYPE_INT32)throw new Error("get int32 but _typ != SyncEvent.TYPE_INT32!");return this._old_value_u32_buffer.getInt32(0,!0)},set:function(a){if(this._typ!=SyncEvent.TYPE_INT32)throw new Error("get int32 but _typ != SyncEvent.TYPE_INT32!");this._old_value_u32_buffer.setInt32(0,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"uint16",{get:function(){if(this._typ!=SyncEvent.TYPE_UINT16)throw new Error("get uint16 but _typ != SyncEvent.TYPE_UINT16!");return this._value_u32_buffer.getUint16(2,!0)},set:function(a){this._typ=SyncEvent.TYPE_UINT16,this._value_u32_buffer.setUint16(2,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"int16",{get:function(){if(this._typ!=SyncEvent.TYPE_INT16)throw new Error("get int16 but _typ != SyncEvent.TYPE_INT16!");return this._value_u32_buffer.getInt16(2,!0)},set:function(a){this._typ=SyncEvent.TYPE_INT16,this._value_u32_buffer.setInt16(2,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"byte",{get:function(){if(this._typ!=SyncEvent.TYPE_UINT8)throw new Error("get uint8 but _typ != SyncEvent.TYPE_UINT8!");return this._value_u32_buffer.getInt8(2)},set:function(a){this._typ=SyncEvent.TYPE_UINT8,this._value_u32_buffer.setInt8(2,a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"double",{get:function(){return this._value_dbe},set:function(a){this._value_dbe=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"float",{get:function(){return this._value_u32_buffer.getFloat32(0,!0)},set:function(a){this._value_u32_buffer.setFloat32(0,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"str",{get:function(){if(this._typ!=SyncEvent.TYPE_STRING)throw new Error("get str but _typ != SyncEvent.TYPE_STRING!");return this._value_str},set:function(a){this._typ=SyncEvent.TYPE_STRING,this._value_str=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"old_str",{get:function(){if(this._typ!=SyncEvent.TYPE_STRING)throw new Error("get old_str but _typ != SyncEvent.TYPE_STRING!");return this._old_value_str},set:function(a){if(this._typ!=SyncEvent.TYPE_STRING)throw new Error("set old_str but _typ != SyncEvent.TYPE_STRING!");this._old_value_str=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"value",{get:function(){return this._value_u32_buffer.getUint32(0,!0)},set:function(a){this._value_u32_buffer.setUint32(0,a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"old_value",{get:function(){return this._old_value_u32_buffer.getUint32(0,!0)},set:function(a){this._old_value_u32_buffer.setUint32(0,a,!0)},enumerable:!0,configurable:!0}),b.prototype.Clear=function(){this._opt=0,this._typ=0,this._index=0,this._atomic_opt=SyncEvent.ATOMIC_OPT_RESULT_NO,this._value_u32_buffer.setUint32(0,0,!0),this._value_dbe=0,this._value_str="",this._callback_index=0,this._old_value_u32_buffer.setUint32(0,0,!0),this._old_value_dbe=0,this._old_value_str=""},b.prototype.ReadFrom=function(a){return this._opt=a.readUnsignedByte(),this._typ=a.readUnsignedByte(),this._index=a.readShort(),this._atomic_opt=a.readByte(),this._typ==SyncEvent.TYPE_STRING?this._value_str=a.readUTF():this._typ==SyncEvent.TYPE_DOUBLE?this._value_dbe=a.readDouble():this.value=a.readUnsignedInt(),this._atomic_opt&&(this._callback_index=a.readUnsignedInt(),this._typ==SyncEvent.TYPE_STRING?this._old_value_str=a.readUTF():this._typ==SyncEvent.TYPE_DOUBLE?this._old_value_dbe=a.readDouble():this.old_value=a.readUnsignedInt()),!0},b.prototype.WriteTo=function(a){a.writeByte(this._opt),a.writeByte(this._typ),a.writeShort(this._index),a.writeByte(this._atomic_opt),this._typ==SyncEvent.TYPE_STRING?a.writeUTF(this._value_str?this._value_str:""):this._typ==SyncEvent.TYPE_DOUBLE?a.writeDouble(this._value_dbe):a.writeUnsignedInt(this.value),this._atomic_opt&&(a.writeUnsignedInt(this._callback_index),this._typ==SyncEvent.TYPE_STRING?a.writeUTF(this._old_value_str?this._old_value_str:""):this._typ==SyncEvent.TYPE_DOUBLE?a.writeDouble(this._old_value_dbe):a.writeUnsignedInt(this.old_value))},b.prototype.clone=function(){var a=b.malloc();return a._opt=this._opt,a._typ=this._typ,a._index=this._index,a._atomic_opt=this._atomic_opt,a.value=this.value,a._value_dbe=this._value_dbe,a._value_str=this._value_str,a._callback_index=this._callback_index,a.old_value=this.old_value,a._old_value_dbe=this._old_value_dbe,a._old_value_str=this._old_value_str,a},b._pool=new Array,b}(SyncEvent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SyncEventRecorder=function(a){function b(){var b=a.call(this)||this;return b._events_value=new NetEventDispatcher,b._events_str_values=new NetEventDispatcher,b._events_mask=new NetEventDispatcher(NetEventDispatcher.KEY_TYPE_INT_MASK),b._events_callback=new NetEventDispatcher,b._uint32_values_len=0,b._str_values_len=0,b._str_values=new Array,b._guid="",b._tmpBinlog=new BinLogStru,b._afterUpdateIntObj=new Object,b._afterUpdateStrObj=new Object,b._uint32_values_buffer=new DataView(new ArrayBuffer(0)),b}return __extends(b,a),Object.defineProperty(b.prototype,"guid",{get:function(){return this._guid},set:function(a){this._guid=a},enumerable:!0,configurable:!0}),b.prototype.Reset=function(){this._events_value.Clear(),this._events_str_values.Clear(),this._events_callback.Clear(),this.clearValues()},b.prototype.clearValues=function(){this._uint32_values_len=0,this._uint32_values_buffer=new DataView(new ArrayBuffer(0)),this._str_values_len=0,this._str_values.length=this._str_values_len},b.prototype.checkIntSize=function(a){for(var b=!1;a>=this._uint32_values_len;)this._uint32_values_len+=8,b=!0;if(b){var c=new Uint8Array(new ArrayBuffer(this._uint32_values_len<<2));c.set(new Uint8Array(this._uint32_values_buffer.buffer,0,this._uint32_values_buffer.buffer.byteLength)),this._uint32_values_buffer=new DataView(c.buffer)}},b.prototype.checkStrSize=function(a){for(;a>=this._str_values_len;)this._str_values_len+=8,this._str_values.length=this._str_values_len},b.prototype.OnEventSyncBinLog=function(a){this._after_update&&(a.typ==SyncEvent.TYPE_STRING?this._afterUpdateStrObj[a.index]=!0:this._afterUpdateIntObj[a.index]=!0),a.atomic_opt?this._events_callback.DispatchInt(a.callback_idx,a):a.typ==SyncEvent.TYPE_STRING?this._events_str_values.DispatchInt(a.index,a):this._events_value.DispatchInt(a.index,a)},b.prototype.AddListen=function(a,b){this._events_value.AddListenInt(a,b)},b.prototype.AddListens=function(a,c){void 0===c&&(c=null);for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];b.addListens_mask.Clear();for(var f=0;f<d.length;f++)b.addListens_mask.SetBit(a+d[f]);this._events_mask.AddListenIntMask(b.addListens_mask,c)},b.prototype.removeListene=function(a,b){void 0===b&&(b=null),this._events_value.removeListenerInt(a,b)},b.prototype.removeListenes=function(a,c){void 0===c&&(c=null);for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];b.addListens_mask.Clear();for(var f=0;f<d.length;f++)b.addListens_mask.SetBit(a+d[f]);this._events_mask.removeListenerUpdateMask(b.addListens_mask,c)},b.prototype.AddListenString=function(a,b){this._events_str_values.AddListenInt(a,b)},b.prototype.removeListeneString=function(a,b){void 0===b&&(b=null),this._events_str_values.removeListenerInt(a,b)},b.prototype.GetDouble=function(a){return a+1<this._uint32_values_len?this._uint32_values_buffer.getFloat64(a<<2,!0):0},b.prototype.GetUInt32=function(a){return a<this._uint32_values_len?this._uint32_values_buffer.getUint32(a<<2,!0):0},b.prototype.GetInt32=function(a){return a<this._uint32_values_len?this._uint32_values_buffer.getInt32(a<<2,!0):0},b.prototype.GetUInt16=function(a,b){return a<this._uint32_values_len?this._uint32_values_buffer.getUint16((a<<2)+(b<<1),!0):0},b.prototype.GetInt16=function(a,b){return a<this._uint32_values_len?this._uint32_values_buffer.getInt16((a<<2)+(b<<1),!0):0},b.prototype.GetFloat=function(a){return a<this._uint32_values_len?this._uint32_values_buffer.getFloat32(a<<2,!0):0},b.prototype.GetByte=function(a,b){return a<this._uint32_values_len?this._uint32_values_buffer.getInt8((a<<2)+b):0},b.prototype.GetUInt8=function(a,b){return a<this._uint32_values_len?this._uint32_values_buffer.getUint8((a<<2)+b):0},b.prototype.GetBit=function(a,b){return a+=b>>5,a<this._uint32_values_len?Boolean(this._uint32_values_buffer.getUint32(a<<2,!0)>>(31&b)&1):!1},b.prototype.SetBit=function(a,b,c){var d=this._uint32_values_buffer.getUint32(a<<2,!0);d=d&(4294967295^1<<b)|(c?1:0)<<b,this._uint32_values_buffer.setUint32(a<<2,d,!0)},b.prototype.GetStr=function(a){return a<this._str_values_len&&this._str_values[a]?this._str_values[a]:""},b.prototype.SetDouble=function(a,b){this.checkIntSize(a+1),this._uint32_values_buffer.setFloat64(a<<2,b,!0)},b.prototype.AddDouble=function(a,b){this.checkIntSize(a+1),this.SetDouble(a,this.GetDouble(a)+b)},b.prototype.SubDouble=function(a,b){this.checkIntSize(a+1),this.SetDouble(a,this.GetDouble(a)-b)},b.prototype.SetUInt32=function(a,b){this.checkIntSize(a),this._uint32_values_buffer.setUint32(a<<2,b,!0)},b.prototype.AddUInt32=function(a,b){this.SetUInt32(a,this.GetUInt32(a)+b)},b.prototype.SubUInt32=function(a,b){this.SetUInt32(a,this.GetUInt32(a)-b)},b.prototype.SetInt32=function(a,b){this.checkIntSize(a),this._uint32_values_buffer.setInt32(a<<2,b,!0)},b.prototype.AddInt32=function(a,b){this.SetInt32(a,this.GetInt32(a)+b)},b.prototype.SubInt32=function(a,b){this.SetInt32(a,this.GetInt32(a)-b)},b.prototype.SetUInt16=function(a,b,c){this.checkIntSize(a),this._uint32_values_buffer.setUint16((a<<2)+(b<<1),c,!0)},b.prototype.AddUInt16=function(a,b,c){this.checkIntSize(a),this.SetUInt16(a,b,this.GetUInt16(a,b)+c)},b.prototype.SubUInt16=function(a,b,c){this.checkIntSize(a),this.SetUInt16(a,b,this.GetUInt16(a,b)-c)},b.prototype.SetInt16=function(a,b,c){this.checkIntSize(a),this._uint32_values_buffer.setInt16((a<<2)+(b<<1),c,!0)},b.prototype.AddInt16=function(a,b,c){this.SetInt16(a,b,this.GetInt16(a,b)+c)},b.prototype.SubInt16=function(a,b,c){this.SetInt16(a,b,this.GetInt16(a,b)-c)},b.prototype.SetFloat=function(a,b){this.checkIntSize(a),this._uint32_values_buffer.setFloat32(a<<2,b,!0)},b.prototype.SetByte=function(a,b,c){this.checkIntSize(a),this._uint32_values_buffer.setInt8((a<<2)+b,c)},b.prototype.AddByte=function(a,b,c){this.SetByte(a,b,this.GetByte(a,b)+c)},b.prototype.SubByte=function(a,b,c){this.SetByte(a,b,this.GetByte(a,b)-c)},b.prototype.SetStr=function(a,b){this.checkStrSize(a),this._str_values[a]=b},b.prototype.ReadValues=function(a,b,c){for(var d=a.GetCount(),e=0;d>e;e++)if(a.GetBit(e)){this.checkIntSize(e);var f=c?null:BinLogStru.malloc();f&&(f.typ=SyncEvent.TYPE_UINT32,f.index=e,f.old_value=this.GetUInt32(e)),this.SetUInt32(e,b.readUnsignedInt()),f&&(f.value=this.GetUInt32(e),this._events_value.DispatchInt(f.index,f),BinLogStru.free(f),this._after_update&&(this._afterUpdateIntObj[e]=!0))}return!0},b.prototype.ReadStringValues=function(a,b,c){for(var d=a.GetCount(),e=0;d>e;e++)if(a.GetBit(e)){this.checkStrSize(e);var f=c?null:BinLogStru.malloc();f&&(f.index=e,f.typ=SyncEvent.TYPE_STRING,f.old_str=this._str_values[e]),this._str_values[e]=b.readUTF(),f&&(f.str=this._str_values[e],this._events_str_values.DispatchInt(f.index,f),BinLogStru.free(f),this._after_update&&(this._afterUpdateStrObj[e]=!0))}return!0},b.prototype.GetCreateMask=function(a){a.Clear();for(var b=0;b<this._uint32_values_len;b++)this.GetUInt32(b)&&a.SetBit(b)},b.prototype.GetCreateStringMask=function(a){a.Clear();for(var b=0;b<this._str_values_len;b++)this._str_values[b]&&this._str_values[b].length>0&&a.SetBit(b)},b.prototype.ApplyAtomicBinLog=function(a){if(a.atomic_opt==SyncEvent.ATOMIC_OPT_RESULT_FAILED||a.atomic_opt==SyncEvent.ATOMIC_OPT_RESULT_OK)return void this._events_callback.DispatchInt(a.callback_idx,a);if(a._typ==SyncEvent.TYPE_STRING)return this.checkStrSize(a._index),void(a._old_value_str!=this._str_values[a._index]?(a._old_value_str=a._value_str,a._value_str=this._str_values[a._index],a._atomic_opt=SyncEvent.ATOMIC_OPT_RESULT_FAILED):(a._atomic_opt=SyncEvent.ATOMIC_OPT_RESULT_OK,this.ApplyBinLog(a)));this.checkIntSize(a._index);var b=this.GetUInt32(a.index);a.old_value!=b?(a.old_value=a.value,a.value=b,a._atomic_opt=SyncEvent.ATOMIC_OPT_RESULT_FAILED):(a._atomic_opt=SyncEvent.ATOMIC_OPT_RESULT_OK,this.ApplyBinLog(a))},b.prototype.ApplyBinLog=function(a){var b=a.index;if(a._typ==SyncEvent.TYPE_STRING)return this.checkStrSize(b),a.old_str=this._str_values[b]?this._str_values[b]:"",void(this._str_values[b]=a._value_str);if(a.typ==SyncEvent.TYPE_DOUBLE?(this._uint32_values_len>b+1&&(a._old_value_dbe=this.GetDouble(b)),this.checkIntSize(b+1)):(a.typ!=SyncEvent.TYPE_BIT&&this._uint32_values_len>b&&(a.old_value=this.GetUInt32(b)),this.checkIntSize(b)),a.typ==SyncEvent.TYPE_UINT32||a.typ==SyncEvent.TYPE_INT32||a.typ==SyncEvent.TYPE_FLOAT)switch(a.opt){case SyncEvent.OPT_SET:this.SetUInt32(b,a.uint32);break;case SyncEvent.OPT_ADD:this.AddUInt32(b,a.uint32);break;case SyncEvent.OPT_SUB:this.SubUInt32(b,a.uint32)}else if(a.typ==SyncEvent.TYPE_DOUBLE)switch(a.opt){case SyncEvent.OPT_SET:this.SetDouble(b,a["double"]);break;case SyncEvent.OPT_ADD:this.AddDouble(b,a["double"]);break;case SyncEvent.OPT_SUB:this.SubDouble(b,a["double"])}else if(a.typ==SyncEvent.TYPE_BIT)switch(a.opt){case SyncEvent.OPT_SET:this.SetBit(b,a.uint32,!0);break;case SyncEvent.OPT_UNSET:this.SetBit(b,a.uint32,!1);break;default:throw"JLC_BinLogObject_BIT:op type is error."}else{var c=0;switch(a.typ){case SyncEvent.TYPE_UINT16:switch(a.opt){case SyncEvent.OPT_SET:this.SetUInt16(b,a.offset,a.uint16);break;case SyncEvent.OPT_ADD:this.AddUInt16(b,a.offset,a.uint16);break;case SyncEvent.OPT_SUB:this.SubUInt16(b,a.offset,a.uint16);break;default:throw"JLC_BinLogObject_UINT16:unknow OP type"}break;case SyncEvent.TYPE_INT16:switch(a.opt){case SyncEvent.OPT_SET:this.SetInt16(b,a.offset,a.int16);break;case SyncEvent.OPT_ADD:this.AddInt16(b,a.offset,a.int16);break;case SyncEvent.OPT_SUB:this.SubInt16(b,a.offset,a.int16);break;default:throw"JLC_BinLogObject_UINT16:unknow OP type"}break;case SyncEvent.TYPE_UINT8:switch(c=0,a.opt){case SyncEvent.OPT_SET:this.SetByte(b,a.offset,a["byte"]);break;case SyncEvent.OPT_ADD:this.AddByte(b,a.offset,a["byte"]);break;case SyncEvent.OPT_SUB:this.SubByte(b,a.offset,a["byte"]);break;default:throw"JLC_BinLogObject_UINT8:op type is error."}break;default:throw"JLC_BinLogObject:op type is error."}}},b.prototype.clearAfterUpdateObj=function(){if(this._after_update){for(var a in this._afterUpdateIntObj)delete this._afterUpdateIntObj[a];for(var a in this._afterUpdateStrObj)delete this._afterUpdateStrObj[a]}},b.prototype.ReadFrom=function(a,c,d){void 0===d&&(d=null);var e=Boolean(a&SyncEvent.OBJ_OPT_NEW);if(e&&this.clearValues(),(e||a&SyncEvent.OBJ_OPT_UPDATE)&&(d&&d.pushNew(),this.clearAfterUpdateObj(),b.tmpIntMask.ReadFrom(c),b.tmpStrMask.ReadFrom(c),this.ReadValues(b.tmpIntMask,c,e),this.ReadStringValues(b.tmpStrMask,c,e),null!=this._after_update&&this._after_update(a,this._afterUpdateIntObj,this._afterUpdateStrObj)),a&SyncEvent.OBJ_OPT_BINLOG){b.tmpIntMask.Clear(),b.tmpStrMask.Clear(),this.clearAfterUpdateObj();for(var f=c.readUnsignedShort(),g=0;f>g;g++)this._tmpBinlog.ReadFrom(c),this._tmpBinlog._atomic_opt?this.ApplyAtomicBinLog(this._tmpBinlog):(d&&d.pushBinlog(this._tmpBinlog),this.ApplyBinLog(this._tmpBinlog)),this.OnEventSyncBinLog(this._tmpBinlog);null!=this._after_update&&this._after_update(a,this._afterUpdateIntObj,this._afterUpdateStrObj)}return e&&(console.log("创建Binlog  "+this.guid),this.onBaseCreated()),!0},b.prototype.onBaseCreated=function(){},b.prototype.GetHashCode=function(){for(var a=2166136261,b=16777619,c=a,d=0;d<this._uint32_values_len;d++){var e=this.GetUInt32(d);c^=e,c*=b}var f=new ByteArray;f.endian=Endian.LITTLE_ENDIAN;var g=a;f.writeUTFBytes(this._guid);for(var d=0;d<f.length;d++)g^=f.getByte(d),g*=b;for(var h in this._str_values)for(f.clear(),f.writeUTFBytes(h?h:""),d=0;d<f.length;d++)g^=f[d],g*=b;return c^g<<1},b.prototype.Equals=function(a){return this._uint32_values_len>a._uint32_values_len?a.checkIntSize(this._uint32_values_len):this._uint32_values_len<a._uint32_values_len&&this.checkIntSize(a._uint32_values_len),this._str_values_len>a._str_values_len?a.checkStrSize(this._str_values_len):this._str_values_len>a._str_values_len&&this.checkStrSize(a._str_values_len),this.GetHashCode()==a.GetHashCode()},b.prototype.DeleteThis=function(){},b.prototype.dispose=function(){console.log("回收Binlog  "+this.guid),this.clearValues(),this._events_value.Clear(),this._events_str_values.Clear(),this._events_mask.Clear(),this._events_callback.Clear(),this._after_update=null},b.addListens_mask=new UpdateMask,b.tmpIntMask=new UpdateMask,b.tmpStrMask=new UpdateMask,b}(SyncEvent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GuidObject=function(a){function b(b){void 0===b&&(b="");var c=a.call(this)||this;return c._ref=0,c.guid=b,c}return __extends(b,a),b.prototype.add_ref=function(a){this._ref=this._ref+a},Object.defineProperty(b.prototype,"ref",{get:function(){return this._ref},enumerable:!0,configurable:!0}),b.prototype.getName=function(){return this.GetStr(SharedDef.BINLOG_STRING_FIELD_NAME)},b.prototype.getGuid=function(){return this.GetStr(SharedDef.BINLOG_STRING_FIELD_GUID)},b}(SyncEventRecorder),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GuidObjectTable=function(a){function b(){var b=a.call(this)||this;return b._objs=new Object,b._hashGUID=null,b._u_2_guid=new Object,b._packet_pool=new Array,b._newEvent=new NetEventDispatcher(NetEventDispatcher.KEY_TYPE_STRING),b._delEvent=new NetEventDispatcher(NetEventDispatcher.KEY_TYPE_STRING),b._indexer=new StringIndexer,b}return __extends(b,a),b.prototype.Get=function(a){return this._objs[a]},Object.defineProperty(b.prototype,"indexer",{get:function(){return this._indexer},enumerable:!0,configurable:!0}),b.prototype.CreateObject=function(a){var b=this._objs[a];return b||(b=new GuidObject,b.guid=a),this.AttachObject(b),b},b.prototype.ReleaseObject=function(a){var b=a.guid,c=this._objs[b];c&&this.DetachObject(c)},b.prototype.ReleaseKey=function(a){var b=this._objs[a];b&&this.DetachObject(b)},b.prototype.AttachObject=function(a){if(null==a)throw new Error("AttachObject,o==null");a.add_ref(1),this._objs[a.guid]=a,this._indexer.insert(a);var b=0;null!=this._hashGUID&&(b=this._hashGUID(a.guid),0!=b&&(this._u_2_guid[b]=a.guid))},b.prototype.DetachObject=function(a){if(a.add_ref(-1),a.ref<=0){this._indexer.remove(a.guid),delete this._objs[a.guid];var b=0;null!=this._hashGUID&&(b=this._hashGUID(a.guid),0!=b&&delete this._u_2_guid[b])}},b.prototype.msgClientsubscription=function(a){var b=a.readUint32(),c=this._u_2_guid[b]?this._u_2_guid[b]:"",d=this.Get(c);if(d){var e=new UpdateMask;e.ReadFrom(a);for(var f=e.GetCount(),g=0;f>g;g++)if(e.GetBit(g)){var h=a.readUint32();d.SetUInt32(g,h)}d.buffUnit.resetAllBufData()}},b.prototype.ApplyBlock=function(a){for(;a.bytesAvailable;){var c,d=a.readUnsignedByte();if(d&SyncEvent.OBJ_OPT_U_GUID){var e=a.readUnsignedInt();c=this._u_2_guid[e]?this._u_2_guid[e]:""}else c=a.readUTF();if(0==c.length)return console.log("没有对象 guid=>",c),!1;var f,g=this.Get(c);d&SyncEvent.OBJ_OPT_DELETE?(this._delEvent.DispatchString(c,g),this.ReleaseKey(c),f=this._indexer.matchObject(g),null!=f&&(f.beginPush(g),f.pushDelete(),f.endPush()),g.dispose()):(g||(g=d&SyncEvent.OBJ_OPT_NEW?this.CreateObject(c):b.applyBlock_tmp_obj),f=this._indexer.matchObject(g),f&&f.beginPush(g),g.ReadFrom(d,a,f),f&&f.endPush(),d&SyncEvent.OBJ_OPT_NEW&&this._newEvent.DispatchString(g.guid.charAt(0),g))}return!0},b.prototype.SearchObject=function(a,b){var c=new RegExp(a);b.length=0;for(var d in this._objs)c.test(d)&&b.push(d)},b.prototype.ForEachObject=function(a){for(var b in this._objs)a(this._objs[b])},b.prototype.RegisterCreateEvent=function(a,b){this._newEvent.AddListenString(a,b)},b.prototype.RegisterReleaseEvent=function(a,b){this._delEvent.AddListenString(a,b)},b.prototype.newPacket=function(a){void 0===a&&(a=0);var b=null;return 0==this._packet_pool.length?(b=new ByteArray,b.endian=Endian.LITTLE_ENDIAN):(b=this._packet_pool.shift(),b.clear()),a&&b.writeShort(a),b},b.prototype.freePacket=function(a){a.clear(),this._packet_pool.push(a)},b.prototype.clearObjs=function(){for(var a in this._objs){if(this._objs[a]instanceof GuidObject){var b=this._objs[a];this.removeObject(b.guid,b),b.dispose()}delete this._objs[a]}},b.prototype.removeObject=function(a,b){this._delEvent.DispatchString(a,b),this.ReleaseKey(a);var c=this._indexer.matchObject(b);null!=c&&(c.beginPush(b),c.pushDelete(),c.endPush())},b.prototype.dispose=function(){this._newEvent.Clear(),this._delEvent.Clear();for(var a in this._objs){var b=this._objs[a];b&&b.dispose()}this._objs=new Object},b.applyBlock_tmp_obj=new GuidObject,b}(SyncEvent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SyncEventFilter=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.open=function(){this._opening||(this._opening=!0)},b.prototype.close=function(){this._opening&&(this._opening=!1,this._curObj=null,this._curEventCount=0,this._eventObjs.length=0,this._eventParams.clear())},b.prototype.SyncEventFilter=function(){this._opening=!1,this._curObj=null,this._curEventCount=0,this._eventParams=new ByteArray,this._eventParams.endian=Endian.LITTLE_ENDIAN,this._eventObjs=new Array},b.prototype.beginPush=function(a){return this._curObj&&this.endPush(),this._curObj=a,this._eventObjs.push(a.guid),this._eventParams.writeShort(0),!0},b.prototype.endPush=function(){if(this._curEventCount){var a=this._eventParams.position;this._eventParams.position-=8*this._curEventCount,this._eventParams.position-=2,this._eventParams.writeShort(this._curEventCount),this._curEventCount=0,this._eventParams.position=a}else this._eventObjs.splice(this._eventObjs.length-1,1),this._eventParams.position-=2;this._curObj=null},b.prototype.writeParam=function(a,b,c){this._eventParams.writeShort(a),this._eventParams.writeShort(b),this._eventParams.writeInt(c),this._curEventCount++},b.prototype.pushDelete=function(){this.writeParam(b.EV_DEL,0,0)},b.prototype.pushNew=function(){this.writeParam(b.EV_NEW,0,0)},b.prototype.pushUpdateMask=function(a,c){var d,e=c.GetCount();if(a==SyncEvent.TYPE_STRING)for(d=0;e>d;d++)c.GetBit(d)&&this.writeParam(b.EV_UPDATE_S,d,0);else for(d=0;e>d;d++)c.GetBit(d)&&this.writeParam(b.EV_UPDATE_I,d,this._curObj.GetInt32(d))},b.prototype.pushBinlog=function(a){if(0==a._atomic_opt){var c=a._typ==SyncEvent.TYPE_STRING?b.EV_UPDATE_S:b.EV_UPDATE_I;this.writeParam(c,a.index,this._curObj.GetInt32(a.index))}},b.prototype.beginPop=function(){this._eventParams.position=0},b.prototype.pop=function(a){if(0==this._eventObjs.length)return"";a.length=0;for(var b=this._eventParams.readShort(),c=0;b>c;c++)a.push(this._eventParams.readShort()),a.push(this._eventParams.readShort()),a.push(this._eventParams.readInt());return this._eventObjs.shift()},b.prototype.endPop=function(){0==this._eventObjs.length&&this._eventParams.clear()},b.prototype.Clear=function(){this._curObj=null,this._eventObjs=null,this._eventParams&&(this._eventParams.clear(),this._eventParams=null)},b.EV_NEW=0,b.EV_DEL=1,b.EV_UPDATE_I=2,b.EV_UPDATE_S=3,b}(SyncEvent),ObjectDef=function(){function a(){}return a.getPrefix=function(a){return a.charAt(0)},a.getGUIDIndex=function(a){var b=a.indexOf(".");return b=b>0?b-1:Number.MAX_VALUE,Number(a.substr(1,b))},a.testUG=function(a,b){var c=a.indexOf(".");if(-1!=c){var d=a.substr(c+1);return d==b}return!1},a.MAP="M",a.UNIT="U",a.STRENGTH="B",a.PLAYER="p",a.BAG="I",a.FACTION="L",a.GROW="X",a.INSTANCE="C",a.SOCIAL="s",a.EMAIL="g",a.GLOBEL="G",a.QUEST="Q",a.LOOT="O",a.GLOBAL_VALUE="G.globalvalue",a.GAME_CONFIG="G.gameconfig",a}(),both_null_action=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onNull_action",a}(),both_ping_pong=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onPing_pong",a}(),c2s_forced_into=function(){function a(){this.optcode=0;
}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onForced_into",a}(),c2s_get_session=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.sessionkey=this.input.readString(),a.account=this.input.readString(),a.version=this.input.readString()},a.param_count=3,a.optname="onGet_session",a}(),both_route_trace=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.val=this.input.readString()},a.param_count=1,a.optname="onRoute_trace",a}(),c2s_write_client_log=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint32(),a.uid=this.input.readString(),a.guid=this.input.readString(),a.log=this.input.readString()},a.param_count=4,a.optname="onWrite_client_log",a}(),s2c_operation_failed=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint16(),a.reason=this.input.readUint16(),a.data=this.input.readString()},a.param_count=3,a.optname="onOperation_failed",a}(),both_sync_mstime=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.mstime_now=this.input.readUint32(),a.time_now=this.input.readUint32(),a.open_time=this.input.readUint32()},a.param_count=3,a.optname="onSync_mstime",a}(),s2c_ud_object=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onUd_object",a}(),c2s_ud_control=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onUd_control",a}(),s2c_ud_control_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onUd_control_result",a}(),s2c_grid_ud_object=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGrid_ud_object",a}(),s2c_grid_ud_object_2=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGrid_ud_object_2",a}(),s2c_login_queue_index=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.index=this.input.readUint32()},a.param_count=1,a.optname="onLogin_queue_index",a}(),s2c_kicking_type=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.k_type=this.input.readUint32()},a.param_count=1,a.optname="onKicking_type",a}(),c2s_get_chars_list=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGet_chars_list",a}(),s2c_chars_list=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new char_create_info;e.read(this.input),a.list.push(e)}a.faction_name=this.input.readString(),a.queen_name=this.input.readString(),a.icon=this.input.readUint8()},a.param_count=4,a.optname="onChars_list",a}(),c2s_check_name=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.name=this.input.readString()},a.param_count=1,a.optname="onCheck_name",a}(),s2c_check_name_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.result=this.input.readUint8()},a.param_count=1,a.optname="onCheck_name_result",a}(),c2s_char_create=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.info=new char_create_info,a.info.read(this.input)},a.param_count=1,a.optname="onChar_create",a}(),s2c_char_create_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.result=this.input.readUint8()},a.param_count=1,a.optname="onChar_create_result",a}(),c2s_delete_char=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onDelete_char",a}(),s2c_delete_char_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.result=this.input.readUint8()},a.param_count=1,a.optname="onDelete_char_result",a}(),c2s_player_login=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onPlayer_login",a}(),c2s_player_logout=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onPlayer_logout",a}(),c2s_regularise_account=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.uid=this.input.readString()},a.param_count=1,a.optname="onRegularise_account",a}(),c2s_char_remotestore=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.key=this.input.readUint32(),a.value=this.input.readUint32()},a.param_count=2,a.optname="onChar_remotestore",a}(),c2s_char_remotestore_str=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.key=this.input.readUint32(),a.value=this.input.readString()},a.param_count=2,a.optname="onChar_remotestore_str",a}(),c2s_teleport=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.intGuid=this.input.readUint32()},a.param_count=1,a.optname="onTeleport",a}(),both_move_stop=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32(),a.pos_x=this.input.readUint16(),a.pos_y=this.input.readUint16()},a.param_count=3,a.optname="onMove_stop",a}(),both_unit_move=function(){function a(){this.optcode=0,this.path=new Array}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32(),a.pos_x=this.input.readUint16(),a.pos_y=this.input.readUint16(),a.path.length=0;for(var c=this.input.readUint16(),d=0;c>d;d++)a.path.push(this.input.readInt8())},a.param_count=4,a.optname="onUnit_move",a}(),c2s_use_gameobject=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.target=this.input.readUint32()},a.param_count=1,a.optname="onUse_gameobject",a}(),c2s_bag_exchange_pos=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.src_bag=this.input.readUint32(),a.src_pos=this.input.readUint32(),a.dst_bag=this.input.readUint32(),a.dst_pos=this.input.readUint32()},a.param_count=4,a.optname="onBag_exchange_pos",a}(),c2s_bag_destroy=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.item_guid=this.input.readString(),a.num=this.input.readUint32(),a.bag_id=this.input.readUint32()},a.param_count=3,a.optname="onBag_destroy",a}(),c2s_bag_item_split=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.bag_id=this.input.readUint8(),a.src_pos=this.input.readUint16(),a.count=this.input.readUint32(),a.dst_pos=this.input.readUint16(),a.dst_bag=this.input.readUint8()},a.param_count=5,a.optname="onBag_item_split",a}(),c2s_bag_item_user=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.item_guid=this.input.readString(),a.count=this.input.readUint32()},a.param_count=2,a.optname="onBag_item_user",a}(),s2c_bag_item_cooldown=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_cooldown_info;e.read(this.input),a.list.push(e)}},a.param_count=1,a.optname="onBag_item_cooldown",a}(),s2c_grid_unit_move=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGrid_unit_move",a}(),s2c_grid_unit_move_2=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGrid_unit_move_2",a}(),c2s_exchange_item=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.entry=this.input.readUint32(),a.count=this.input.readUint32(),a.tar_entry=this.input.readUint32()},a.param_count=3,a.optname="onExchange_item",a}(),c2s_bag_extension=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.bag_id=this.input.readUint8(),a.extension_type=this.input.readUint8(),a.bag_pos=this.input.readUint32()},a.param_count=3,a.optname="onBag_extension",a}(),c2s_npc_get_goods_list=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.npc_id=this.input.readUint32()},a.param_count=1,a.optname="onNpc_get_goods_list",a}(),s2c_npc_goods_list=function(){function a(){this.optcode=0,this.goods=new Array}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.goods.length=0;for(var c=this.input.readUint16(),d=0;c>d;d++)a.goods.push(this.input.readUint32());a.npc_id=this.input.readUint32()},a.param_count=2,a.optname="onNpc_goods_list",a}(),c2s_store_buy=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32(),a.count=this.input.readUint32()},a.param_count=2,a.optname="onStore_buy",a}(),c2s_npc_sell=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.npc_id=this.input.readUint32(),a.item_guid=this.input.readString(),a.num=this.input.readUint32()},a.param_count=3,a.optname="onNpc_sell",a}(),c2s_npc_repurchase=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.item_id=this.input.readString()},a.param_count=1,a.optname="onNpc_repurchase",a}(),c2s_avatar_fashion_enable=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.pos=this.input.readUint8()},a.param_count=1,a.optname="onAvatar_fashion_enable",a}(),c2s_questhelp_talk_option=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_id=this.input.readUint32(),a.option_id=this.input.readUint32(),a.value0=this.input.readInt32(),a.value1=this.input.readInt32()},a.param_count=4,a.optname="onQuesthelp_talk_option",a}(),c2s_taxi_hello=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32()},a.param_count=1,a.optname="onTaxi_hello",a}(),s2c_taxi_stations_list=function(){function a(){this.optcode=0,this.stations=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.npcid=this.input.readUint32(),a.stations.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new taxi_menu_info;e.read(this.input),a.stations.push(e)}},a.param_count=2,a.optname="onTaxi_stations_list",a}(),c2s_taxi_select_station=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.station_id=this.input.readUint32(),a.guid=this.input.readUint32()},a.param_count=2,a.optname="onTaxi_select_station",a}(),c2s_gossip_select_option=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.option=this.input.readUint32(),a.guid=this.input.readUint32(),a.unknow=this.input.readString()},a.param_count=3,a.optname="onGossip_select_option",a}(),c2s_gossip_hello=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32()},a.param_count=1,a.optname="onGossip_hello",a}(),s2c_gossip_message=function(){function a(){this.optcode=0,this.gossip_items=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.npcid=this.input.readUint32(),a.npc_entry=this.input.readUint32(),a.option_id=this.input.readUint32(),a.option_text=this.input.readString(),a.gossip_items.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new gossip_menu_option_info;e.read(this.input),a.gossip_items.push(e)}},a.param_count=5,a.optname="onGossip_message",a}(),c2s_questgiver_status_query=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32()},a.param_count=1,a.optname="onQuestgiver_status_query",a}(),s2c_questgiver_status=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32(),a.status=this.input.readUint8()},a.param_count=2,a.optname="onQuestgiver_status",a}(),both_query_quest_status=function(){function a(){this.optcode=0,this.quest_array=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_array.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new quest_status;e.read(this.input),a.quest_array.push(e)}},a.param_count=1,a.optname="onQuery_quest_status",a}(),c2s_questhelp_get_canaccept_list=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onQuesthelp_get_canaccept_list",a}(),s2c_questhelp_canaccept_list=function(){function a(){this.optcode=0,this.quests=new Array}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quests.length=0;for(var c=this.input.readUint16(),d=0;c>d;d++)a.quests.push(this.input.readUint32())},a.param_count=1,a.optname="onQuesthelp_canaccept_list",a}(),s2c_questupdate_faild=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.reason=this.input.readUint8()},a.param_count=1,a.optname="onQuestupdate_faild",a}(),s2c_questupdate_complete=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_id=this.input.readUint32()},a.param_count=1,a.optname="onQuestupdate_complete",a}(),c2s_questlog_remove_quest=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.slot=this.input.readUint8(),a.reserve=this.input.readUint64()},a.param_count=2,a.optname="onQuestlog_remove_quest",a}(),c2s_questgiver_complete_quest=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32(),a.quest_id=this.input.readUint32(),a.reward=this.input.readUint8()},a.param_count=3,a.optname="onQuestgiver_complete_quest",a}(),s2c_questhelp_next=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.current_id=this.input.readUint32(),a.next_id=this.input.readUint32(),a.guid=this.input.readUint32()},a.param_count=3,a.optname="onQuesthelp_next",a}(),c2s_questhelp_complete=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_id=this.input.readUint32(),a.quest_statue=this.input.readUint8(),a.reserve=this.input.readUint8()},a.param_count=3,a.optname="onQuesthelp_complete",a}(),s2c_questupdate_accept=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_id=this.input.readUint32()},a.param_count=1,a.optname="onQuestupdate_accept",a}(),c2s_questhelp_update_status=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_id=this.input.readUint32(),a.slot_id=this.input.readUint32(),a.num=this.input.readUint32()},a.param_count=3,a.optname="onQuesthelp_update_status",a}(),s2c_questgetter_complete=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_id=this.input.readUint32()},a.param_count=1,a.optname="onQuestgetter_complete",a}(),c2s_questgiver_accept_quest=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.npcid=this.input.readUint32(),a.quest_id=this.input.readUint32()},a.param_count=2,a.optname="onQuestgiver_accept_quest",a}(),c2s_questupdate_use_item=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.item_id=this.input.readUint32()},a.param_count=1,a.optname="onQuestupdate_use_item",a}(),c2s_questhelp_query_book=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.dynasty=this.input.readUint32()},a.param_count=1,a.optname="onQuesthelp_query_book",a}(),s2c_questhelp_book_quest=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.quest_id=this.input.readUint32()},a.param_count=1,a.optname="onQuesthelp_book_quest",a}(),s2c_use_gameobject_action=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.player_id=this.input.readUint32(),a.gameobject_id=this.input.readUint32()},a.param_count=2,a.optname="onUse_gameobject_action",a}(),c2s_set_attack_mode=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.mode=this.input.readUint8(),a.reserve=this.input.readUint64()},a.param_count=2,a.optname="onSet_attack_mode",a}(),both_select_target=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onSelect_target",a}(),s2c_combat_state_update=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.cur_state=this.input.readUint8()},a.param_count=1,a.optname="onCombat_state_update",a}(),s2c_exp_update=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.exp=this.input.readInt32(),a.type=this.input.readUint8(),a.vip_exp=this.input.readInt32()},a.param_count=3,a.optname="onExp_update",a}(),both_spell_start=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.spell_id=this.input.readUint32(),a.target_pos_x=this.input.readUint16(),a.target_pos_y=this.input.readUint16(),a.caster=this.input.readUint32(),a.target=this.input.readUint32()},a.param_count=5,a.optname="onSpell_start",a}(),both_spell_stop=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onSpell_stop",a}(),both_jump=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32(),a.pos_x=this.input.readFloat(),a.pos_y=this.input.readFloat()},a.param_count=3,a.optname="onJump",a}(),c2s_resurrection=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8(),a.reserve=this.input.readUint64()},a.param_count=2,a.optname="onResurrection",a}(),both_trade_request=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onTrade_request",a}(),both_trade_reply=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.reply=this.input.readUint8()},a.param_count=2,a.optname="onTrade_reply",a}(),s2c_trade_start=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onTrade_start",a}(),both_trade_decide_items=function(){function a(){this.optcode=0,this.items=new Array}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.items.length=0;for(var c=this.input.readUint16(),d=0;c>d;d++)a.items.push(this.input.readString());a.gold_ingot=this.input.readInt32(),a.silver=this.input.readInt32()},a.param_count=3,a.optname="onTrade_decide_items",a}(),s2c_trade_finish=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onTrade_finish",a}(),both_trade_cancel=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onTrade_cancel",a}(),both_trade_ready=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onTrade_ready",a}(),s2c_chat_unit_talk=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32(),a.content=this.input.readUint32(),a.say=this.input.readString()},a.param_count=3,a.optname="onChat_unit_talk",a}(),c2s_chat_near=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.content=this.input.readString()},a.param_count=1,a.optname="onChat_near",a}(),c2s_chat_whisper=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.content=this.input.readString()},a.param_count=2,a.optname="onChat_whisper",a}(),both_chat_faction=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.name=this.input.readString(),a.content=this.input.readString(),a.faction=this.input.readUint8()},a.param_count=4,a.optname="onChat_faction",a}(),both_chat_world=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.faction=this.input.readUint8(),a.name=this.input.readString(),a.content=this.input.readString()},a.param_count=4,a.optname="onChat_world",a}(),both_chat_horn=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.faction=this.input.readUint8(),a.name=this.input.readString(),a.content=this.input.readString()},a.param_count=4,a.optname="onChat_horn",a}(),both_chat_notice=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32(),a.content=this.input.readString(),a.data=this.input.readString()},a.param_count=3,a.optname="onChat_notice",a}(),c2s_query_player_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.flag=this.input.readUint32(),a.callback_id=this.input.readUint32()},a.param_count=3,a.optname="onQuery_player_info",a}(),s2c_query_result_update_object=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onQuery_result_update_object",a}(),c2s_receive_gift_packs=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onReceive_gift_packs",a}(),s2c_map_update_object=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onMap_update_object",a}(),s2c_fighting_info_update_object=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onFighting_info_update_object",a}(),s2c_fighting_info_update_object_2=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onFighting_info_update_object_2",a}(),c2s_instance_enter=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.instance_id=this.input.readUint32()},a.param_count=1,a.optname="onInstance_enter",a}(),c2s_instance_next_state=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.level=this.input.readUint16(),a.param=this.input.readUint32()},a.param_count=2,a.optname="onInstance_next_state",a}(),c2s_instance_exit=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.reserve=this.input.readUint32()},a.param_count=1,a.optname="onInstance_exit",a}(),c2s_limit_activity_receive=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32(),a.type=this.input.readUint32()},a.param_count=2,a.optname="onLimit_activity_receive",a}(),s2c_kill_man=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.killer=this.input.readString(),a.killer_name=this.input.readString(),a.victim=this.input.readString(),a.victim_name=this.input.readString()},a.param_count=4,a.optname="onKill_man",a}(),s2c_player_upgrade=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32()},a.param_count=1,a.optname="onPlayer_upgrade",a}(),c2s_warehouse_save_money=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.money=this.input.readInt32(),a.money_gold=this.input.readInt32(),a.money_bills=this.input.readInt32()},a.param_count=3,a.optname="onWarehouse_save_money",a}(),c2s_warehouse_take_money=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.money=this.input.readInt32(),a.money_gold=this.input.readInt32(),a.money_bills=this.input.readInt32()},a.param_count=3,a.optname="onWarehouse_take_money",a}(),c2s_use_gold_opt=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8(),a.param=this.input.readString()},a.param_count=2,a.optname="onUse_gold_opt",a}(),c2s_use_silver_opt=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8()},a.param_count=1,a.optname="onUse_silver_opt",a}(),s2c_gm_rightfloat=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32(),a.end_time=this.input.readUint32(),a.zone1=this.input.readUint32(),a.zone2=this.input.readUint32(),a.zone3=this.input.readUint32(),a.subject=this.input.readString(),a.content=this.input.readString(),a.link=this.input.readString(),a.mode=this.input.readUint8()},a.param_count=9,a.optname="onGm_rightfloat",a}(),s2c_del_gm_rightfloat=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onDel_gm_rightfloat",a}(),both_sync_mstime_app=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.mstime_now=this.input.readUint32(),a.time_now=this.input.readUint32(),a.open_time=this.input.readUint32()},a.param_count=3,a.optname="onSync_mstime_app",a}(),c2s_open_window=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.window_type=this.input.readUint32()},a.param_count=1,a.optname="onOpen_window",a}(),c2s_player_gag=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.player_id=this.input.readString(),a.end_time=this.input.readUint32(),a.content=this.input.readString()},a.param_count=3,a.optname="onPlayer_gag",a}(),c2s_player_kicking=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.player_id=this.input.readString()},a.param_count=1,a.optname="onPlayer_kicking",a}(),s2c_merge_server_msg=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.merge_host=this.input.readString(),a.merge_port=this.input.readUint32(),a.merge_key=this.input.readString(),a.merge_type=this.input.readUint32(),a.reserve=this.input.readUint32(),a.reserve2=this.input.readUint32()},a.param_count=6,a.optname="onMerge_server_msg",a}(),c2s_rank_list_query=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.call_back_id=this.input.readUint32(),a.rank_list_type=this.input.readUint8(),a.start_index=this.input.readUint16(),a.end_index=this.input.readUint16()},a.param_count=4,a.optname="onRank_list_query",a}(),s2c_rank_list_query_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRank_list_query_result",a}(),c2s_client_update_scened=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onClient_update_scened",a}(),s2c_num_lua=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onNum_lua",a}(),c2s_loot_select=function(){function a(){
this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.x=this.input.readUint16(),a.y=this.input.readUint16()},a.param_count=2,a.optname="onLoot_select",a}(),c2s_goback_to_game_server=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGoback_to_game_server",a}(),c2s_world_war_CS_player_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWorld_war_CS_player_info",a}(),s2c_join_or_leave_server=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.join_or_leave=this.input.readUint8(),a.server_type=this.input.readUint8(),a.server_pid=this.input.readUint32(),a.server_fd=this.input.readUint32(),a.time=this.input.readUint32()},a.param_count=5,a.optname="onJoin_or_leave_server",a}(),both_world_war_SC_player_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWorld_war_SC_player_info",a}(),both_clientSubscription=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readUint32()},a.param_count=1,a.optname="onClientSubscription",a}(),s2c_lua_script=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onLua_script",a}(),c2s_char_update_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.info=new char_create_info,a.info.read(this.input)},a.param_count=1,a.optname="onChar_update_info",a}(),s2c_notice_watcher_map_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.wather_guid=this.input.readString(),a.map_id=this.input.readUint32(),a.instance_id=this.input.readUint32()},a.param_count=3,a.optname="onNotice_watcher_map_info",a}(),c2s_modify_watch=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.opt=this.input.readUint8(),a.cid=this.input.readUint32(),a.key=this.input.readString()},a.param_count=3,a.optname="onModify_watch",a}(),c2s_kuafu_chuansong=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.str_data=this.input.readString(),a.watcher_guid=this.input.readString(),a.reserve=this.input.readUint32()},a.param_count=3,a.optname="onKuafu_chuansong",a}(),c2s_show_suit=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.position=this.input.readUint8()},a.param_count=1,a.optname="onShow_suit",a}(),c2s_show_position=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.channel=this.input.readUint8()},a.param_count=1,a.optname="onShow_position",a}(),c2s_gold_respawn=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.useGold=this.input.readUint8()},a.param_count=1,a.optname="onGold_respawn",a}(),s2c_field_death_cooldown=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8(),a.value=this.input.readUint32(),a.killername=this.input.readString(),a.cooldown=this.input.readUint16(),a.params=this.input.readString()},a.param_count=5,a.optname="onField_death_cooldown",a}(),c2s_mall_buy=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32(),a.count=this.input.readUint32(),a.time=this.input.readUint32()},a.param_count=3,a.optname="onMall_buy",a}(),c2s_strength=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.part=this.input.readUint8()},a.param_count=1,a.optname="onStrength",a}(),s2c_strength_success=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.level=this.input.readUint16()},a.param_count=1,a.optname="onStrength_success",a}(),c2s_forceInto=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onForceInto",a}(),c2s_create_faction=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.name=this.input.readString(),a.icon=this.input.readUint8()},a.param_count=2,a.optname="onCreate_faction",a}(),c2s_faction_upgrade=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onFaction_upgrade",a}(),c2s_faction_join=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readString()},a.param_count=1,a.optname="onFaction_join",a}(),c2s_raise_base_spell=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.raiseType=this.input.readUint8(),a.spellId=this.input.readUint16()},a.param_count=2,a.optname="onRaise_base_spell",a}(),c2s_upgrade_anger_spell=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.spellId=this.input.readUint16()},a.param_count=1,a.optname="onUpgrade_anger_spell",a}(),c2s_raise_mount=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRaise_mount",a}(),c2s_upgrade_mount=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.useItem=this.input.readUint8()},a.param_count=1,a.optname="onUpgrade_mount",a}(),c2s_upgrade_mount_one_step=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.useItem=this.input.readUint8()},a.param_count=1,a.optname="onUpgrade_mount_one_step",a}(),c2s_illusion_mount_active=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.illuId=this.input.readUint16()},a.param_count=1,a.optname="onIllusion_mount_active",a}(),c2s_illusion_mount=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.illuId=this.input.readUint16()},a.param_count=1,a.optname="onIllusion_mount",a}(),c2s_ride_mount=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRide_mount",a}(),s2c_grid_unit_jump=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGrid_unit_jump",a}(),c2s_gem=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.part=this.input.readUint8()},a.param_count=1,a.optname="onGem",a}(),c2s_change_battle_mode=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.mode=this.input.readUint8()},a.param_count=1,a.optname="onChange_battle_mode",a}(),s2c_peace_mode_cd=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.mode=this.input.readUint8()},a.param_count=1,a.optname="onPeace_mode_cd",a}(),c2s_divine_active=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onDivine_active",a}(),c2s_divine_uplev=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onDivine_uplev",a}(),c2s_divine_switch=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onDivine_switch",a}(),c2s_jump_start=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.pos_x=this.input.readUint16(),a.pos_y=this.input.readUint16()},a.param_count=2,a.optname="onJump_start",a}(),c2s_enter_vip_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint16(),a.hard=this.input.readUint8()},a.param_count=2,a.optname="onEnter_vip_instance",a}(),c2s_sweep_vip_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint16()},a.param_count=1,a.optname="onSweep_vip_instance",a}(),c2s_hang_up=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onHang_up",a}(),c2s_hang_up_setting=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.value0=this.input.readUint32(),a.value1=this.input.readUint32(),a.value2=this.input.readUint32(),a.value3=this.input.readUint32()},a.param_count=4,a.optname="onHang_up_setting",a}(),c2s_enter_trial_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onEnter_trial_instance",a}(),c2s_sweep_trial_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onSweep_trial_instance",a}(),c2s_reset_trial_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onReset_trial_instance",a}(),s2c_sweep_instance_reward=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.inst_sub_type=this.input.readUint8(),a.data1=this.input.readUint8(),a.data2=this.input.readUint8(),a.data3=this.input.readUint8(),a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.list.push(e)}},a.param_count=5,a.optname="onSweep_instance_reward",a}(),c2s_reenter_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onReenter_instance",a}(),s2c_merry_go_round=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onMerry_go_round",a}(),c2s_social_add_friend=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onSocial_add_friend",a}(),c2s_social_sureadd_friend=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onSocial_sureadd_friend",a}(),c2s_social_gift_friend=function(){function a(){this.optcode=0,this.gift=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.gift.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.gift.push(e)}},a.param_count=2,a.optname="onSocial_gift_friend",a}(),c2s_social_recommend_friend=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onSocial_recommend_friend",a}(),s2c_social_get_recommend_friend=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new social_friend_info;e.read(this.input),a.list.push(e)}},a.param_count=1,a.optname="onSocial_get_recommend_friend",a}(),c2s_social_revenge_enemy=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onSocial_revenge_enemy",a}(),c2s_social_del_friend=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onSocial_del_friend",a}(),c2s_teleport_main_city=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onTeleport_main_city",a}(),c2s_chat_by_channel=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.channel=this.input.readUint8(),a.content=this.input.readString()},a.param_count=2,a.optname="onChat_by_channel",a}(),s2c_send_chat=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.channel=this.input.readUint8(),a.guid=this.input.readString(),a.title=this.input.readUint8(),a.name=this.input.readString(),a.vip=this.input.readUint8(),a.zs=this.input.readUint8(),a.lvl=this.input.readUint8(),a.gender=this.input.readUint8(),a.content=this.input.readString(),a.to_guid=this.input.readString(),a.faction_guid=this.input.readString()},a.param_count=11,a.optname="onSend_chat",a}(),c2s_social_clear_apply=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onSocial_clear_apply",a}(),c2s_msg_decline=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.value0=this.input.readUint32(),a.value1=this.input.readUint32()},a.param_count=2,a.optname="onMsg_decline",a}(),s2c_faction_get_list_result=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new faction_info;e.read(this.input),a.list.push(e)}a.curpag=this.input.readUint8(),a.maxpag=this.input.readUint8()},a.param_count=3,a.optname="onFaction_get_list_result",a}(),c2s_faction_getlist=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.page=this.input.readUint8(),a.num=this.input.readUint8(),a.grep=this.input.readUint8()},a.param_count=3,a.optname="onFaction_getlist",a}(),c2s_faction_manager=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.opt_type=this.input.readUint8(),a.reserve_int1=this.input.readUint16(),a.reserve_int2=this.input.readUint16(),a.reserve_str1=this.input.readString(),a.reserve_str2=this.input.readString()},a.param_count=5,a.optname="onFaction_manager",a}(),c2s_faction_member_operate=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.opt_type=this.input.readUint8(),a.reserve_int1=this.input.readUint16(),a.reserve_int2=this.input.readUint16(),a.reserve_str1=this.input.readString(),a.reserve_str2=this.input.readString()},a.param_count=5,a.optname="onFaction_member_operate",a}(),c2s_faction_fast_join=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onFaction_fast_join",a}(),c2s_social_add_friend_byname=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.name=this.input.readString()},a.param_count=1,a.optname="onSocial_add_friend_byname",a}(),c2s_read_mail=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint16()},a.param_count=1,a.optname="onRead_mail",a}(),c2s_pick_mail=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint16()},a.param_count=1,a.optname="onPick_mail",a}(),c2s_remove_mail=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint16()},a.param_count=1,a.optname="onRemove_mail",a}(),c2s_pick_mail_one_step=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onPick_mail_one_step",a}(),c2s_remove_mail_one_step=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRemove_mail_one_step",a}(),c2s_block_chat=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onBlock_chat",a}(),c2s_cancel_block_chat=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onCancel_block_chat",a}(),c2s_use_broadcast_gameobject=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.target=this.input.readUint32()},a.param_count=1,a.optname="onUse_broadcast_gameobject",a}(),c2s_world_boss_enroll=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWorld_boss_enroll",a}(),c2s_world_boss_fight=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWorld_boss_fight",a}(),c2s_change_line=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.lineNo=this.input.readUint32()},a.param_count=1,a.optname="onChange_line",a}(),c2s_roll_world_boss_treasure=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRoll_world_boss_treasure",a}(),s2c_roll_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.point=this.input.readUint8(),a.name=this.input.readString(),a.isHighest=this.input.readUint8(),a.timestamp=this.input.readUint32(),a.rollid=this.input.readUint8()},a.param_count=5,a.optname="onRoll_result",a}(),s2c_boss_rank=function(){function a(){this.optcode=0,this.rankList=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.rankType=this.input.readUint8(),a.rankList.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new rank_info;e.read(this.input),a.rankList.push(e)}a.mine=this.input.readUint8()},a.param_count=3,a.optname="onBoss_rank",a}(),c2s_rank_add_like=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8(),a.guid=this.input.readString()},a.param_count=2,a.optname="onRank_add_like",a}(),s2c_rank_add_like_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8(),a.guid=this.input.readString(),a.num=this.input.readUint32()},a.param_count=3,a.optname="onRank_add_like_result",a}(),c2s_res_instance_enter=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onRes_instance_enter",a}(),c2s_res_instance_sweep=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onRes_instance_sweep",a}(),c2s_show_map_line=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onShow_map_line",a}(),s2c_send_map_line=function(){function a(){this.optcode=0,this.info=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.info.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new line_info;e.read(this.input),a.info.push(e)}},a.param_count=1,a.optname="onSend_map_line",a}(),s2c_item_notice=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.showType=this.input.readUint8(),a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.list.push(e)}},a.param_count=2,a.optname="onItem_notice",a}(),c2s_teleport_map=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.mapid=this.input.readUint32(),a.lineNo=this.input.readUint32()},a.param_count=2,a.optname="onTeleport_map",a}(),c2s_teleport_field_boss=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.mapid=this.input.readUint32(),a.lineNo=this.input.readUint32()},a.param_count=2,a.optname="onTeleport_field_boss",a}(),c2s_get_activity_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8(),a.vip=this.input.readUint8()},a.param_count=2,a.optname="onGet_activity_reward",a}(),c2s_get_achieve_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onGet_achieve_reward",a}(),c2s_get_achieve_all_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGet_achieve_all_reward",a}(),c2s_set_title=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onSet_title",a}(),c2s_init_title=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onInit_title",a}(),c2s_welfare_shouchong_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWelfare_shouchong_reward",a}(),c2s_welfare_checkin=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWelfare_checkin",a}(),c2s_welfare_checkin_all=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_checkin_all",a}(),c2s_welfare_checkin_getback=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_checkin_getback",a}(),c2s_welfare_level=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_level",a}(),c2s_welfare_active_getback=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8(),a.best=this.input.readUint8(),a.num=this.input.readUint16()},a.param_count=3,a.optname="onWelfare_active_getback",a}(),c2s_pick_quest_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onPick_quest_reward",a}(),c2s_talk_with_npc=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.u_guid=this.input.readUint32(),a.questId=this.input.readUint16()},a.param_count=2,a.optname="onTalk_with_npc",a}(),c2s_use_virtual_item=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.entry=this.input.readUint16()},a.param_count=1,a.optname="onUse_virtual_item",a}(),c2s_pick_quest_chapter_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onPick_quest_chapter_reward",a}(),c2s_kuafu_3v3_match=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onKuafu_3v3_match",a}(),s2c_kuafu_match_start=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onKuafu_match_start",a}(),c2s_kuafu_3v3_buytimes=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.num=this.input.readUint8()},a.param_count=1,a.optname="onKuafu_3v3_buytimes",a}(),c2s_kuafu_3v3_dayreward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onKuafu_3v3_dayreward",a}(),c2s_kuafu_3v3_getranlist=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onKuafu_3v3_getranlist",a}(),s2c_kuafu_3v3_ranlist=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.list=this.input.readString()},a.param_count=1,a.optname="onKuafu_3v3_ranlist",a}(),c2s_welfare_getalllist_getback=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.best=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_getalllist_getback",a}(),s2c_welfare_rewardlist_getback=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.list=this.input.readString(),a.cost=this.input.readString()},a.param_count=2,a.optname="onWelfare_rewardlist_getback",a}(),c2s_welfare_getall_getback=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.best=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_getall_getback",a}(),c2s_kuafu_3v3_getmyrank=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onKuafu_3v3_getmyrank",a}(),s2c_kuafu_3v3_myrank=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.rank=this.input.readUint8()},a.param_count=1,a.optname="onKuafu_3v3_myrank",a}(),s2c_kuafu_3v3_kill_detail=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx1=this.input.readUint32(),a.indx2=this.input.readUint32()},a.param_count=2,a.optname="onKuafu_3v3_kill_detail",a}(),s2c_kuafu_3v3_wait_info=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new wait_info;e.read(this.input),a.list.push(e)}},a.param_count=1,a.optname="onKuafu_3v3_wait_info",a}(),both_kuafu_3v3_cancel_match=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint32()},a.param_count=1,a.optname="onKuafu_3v3_cancel_match",a}(),c2s_kuafu_3v3_match_oper=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.oper=this.input.readUint32()},a.param_count=1,a.optname="onKuafu_3v3_match_oper",a}(),s2c_kuafu_3v3_decline_match=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint32()},a.param_count=1,a.optname="onKuafu_3v3_decline_match",a}(),c2s_kuafu_xianfu_match=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onKuafu_xianfu_match",a}(),s2c_kuafu_match_wait=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8(),a.target=this.input.readUint8(),a.count=this.input.readUint8(),a.data=this.input.readUint32(),a.params=this.input.readString()},a.param_count=5,a.optname="onKuafu_match_wait",a}(),s2c_kuafu_xianfu_minimap_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onKuafu_xianfu_minimap_info",a}(),c2s_buy_xianfu_item=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8(),a.indx=this.input.readUint8(),a.count=this.input.readUint16()},a.param_count=3,a.optname="onBuy_xianfu_item",a}(),c2s_xianfu_random_respawn=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onXianfu_random_respawn",a}(),c2s_doujiantai_fight=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.rank=this.input.readUint16()},a.param_count=1,a.optname="onDoujiantai_fight",a}(),c2s_doujiantai_buytime=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.num=this.input.readUint8()},a.param_count=1,a.optname="onDoujiantai_buytime",a}(),c2s_doujiantai_clearcd=function(){function a(){
this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onDoujiantai_clearcd",a}(),c2s_doujiantai_first_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onDoujiantai_first_reward",a}(),both_doujiantai_get_enemys_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onDoujiantai_get_enemys_info",a}(),c2s_doujiantai_get_rank=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.startIdx=this.input.readUint16(),a.endIdx=this.input.readUint16()},a.param_count=2,a.optname="onDoujiantai_get_rank",a}(),c2s_doujiantai_refresh_enemys=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onDoujiantai_refresh_enemys",a}(),both_doujiantai_top3=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onDoujiantai_top3",a}(),both_use_jump_point=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onUse_jump_point",a}(),c2s_bag_item_sell=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.item_guid=this.input.readString(),a.count=this.input.readUint32()},a.param_count=2,a.optname="onBag_item_sell",a}(),c2s_bag_item_sort=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.bag_type=this.input.readUint32()},a.param_count=1,a.optname="onBag_item_sort",a}(),c2s_submit_quest_daily2=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onSubmit_quest_daily2",a}(),s2c_attribute_changed=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onAttribute_changed",a}(),s2c_bag_find_equip_better=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.item_id=this.input.readUint32(),a.pos=this.input.readUint32(),a.force=this.input.readUint32()},a.param_count=3,a.optname="onBag_find_equip_better",a}(),s2c_module_active=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.moduleId=this.input.readUint32()},a.param_count=1,a.optname="onModule_active",a}(),c2s_pick_daily2_quest_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onPick_daily2_quest_reward",a}(),c2s_finish_now_guide=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onFinish_now_guide",a}(),c2s_get_cultivation_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGet_cultivation_info",a}(),s2c_update_cultivation_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.start_time=this.input.readUint32(),a.lost=this.input.readUint32()},a.param_count=2,a.optname="onUpdate_cultivation_info",a}(),c2s_get_cultivation_rivals_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGet_cultivation_rivals_info",a}(),s2c_update_cultivation_rivals_info_list=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new cultivation_rivals_info;e.read(this.input),a.list.push(e)}},a.param_count=1,a.optname="onUpdate_cultivation_rivals_info_list",a}(),c2s_get_cultivation_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGet_cultivation_reward",a}(),c2s_refresh_cultivation_rivals=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRefresh_cultivation_rivals",a}(),c2s_plunder_cultivation_rival=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.index=this.input.readUint32()},a.param_count=1,a.optname="onPlunder_cultivation_rival",a}(),c2s_revenge_cultivation_rival=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.index=this.input.readUint32()},a.param_count=1,a.optname="onRevenge_cultivation_rival",a}(),c2s_buy_cultivation_left_plunder_count=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.count=this.input.readUint32()},a.param_count=1,a.optname="onBuy_cultivation_left_plunder_count",a}(),s2c_show_cultivation_result_list=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.result=this.input.readInt32(),a.name=this.input.readString(),a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.list.push(e)}},a.param_count=3,a.optname="onShow_cultivation_result_list",a}(),c2s_get_login_activity_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onGet_login_activity_reward",a}(),s2c_cast_spell_start=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.caster_guid=this.input.readUint32(),a.target_guid=this.input.readUint32(),a.spellid=this.input.readUint16(),a.data=this.input.readString()},a.param_count=4,a.optname="onCast_spell_start",a}(),c2s_finish_optional_guide_step=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guide_id=this.input.readUint32(),a.step=this.input.readUint8()},a.param_count=2,a.optname="onFinish_optional_guide_step",a}(),c2s_execute_quest_cmd_after_accepted=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint16()},a.param_count=1,a.optname="onExecute_quest_cmd_after_accepted",a}(),s2c_show_unit_attribute=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onShow_unit_attribute",a}(),c2s_back_to_famity=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onBack_to_famity",a}(),s2c_faction_boss_send_result=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.result=this.input.readUint32(),a.boss_id=this.input.readUint32(),a.money=this.input.readUint32()},a.param_count=3,a.optname="onFaction_boss_send_result",a}(),c2s_challange_boss=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onChallange_boss",a}(),c2s_pick_offline_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onPick_offline_reward",a}(),s2c_offline_reward_result=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.reserve=this.input.readUint32(),a.reserve2=this.input.readUint32(),a.reserve3=this.input.readUint32(),a.reserve4=this.input.readUint32(),a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.list.push(e)}},a.param_count=5,a.optname="onOffline_reward_result",a}(),c2s_smelting_equip=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.pos_str=this.input.readString()},a.param_count=1,a.optname="onSmelting_equip",a}(),c2s_storehouse_hand_in=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.pos_str=this.input.readString()},a.param_count=1,a.optname="onStorehouse_hand_in",a}(),c2s_storehouse_exchange=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.pos=this.input.readUint32()},a.param_count=1,a.optname="onStorehouse_exchange",a}(),c2s_storehouse_destroy=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.pos=this.input.readUint32()},a.param_count=1,a.optname="onStorehouse_destroy",a}(),c2s_send_faction_gift=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.list.push(e)}a.msg=this.input.readString(),a.msg_type=this.input.readUint32()},a.param_count=3,a.optname="onSend_faction_gift",a}(),c2s_get_faction_gift_exreward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.count_id=this.input.readUint32()},a.param_count=1,a.optname="onGet_faction_gift_exreward",a}(),c2s_get_all_faction_gift_exreward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGet_all_faction_gift_exreward",a}(),s2c_show_faction_gift_page=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onShow_faction_gift_page",a}(),s2c_show_faction_gift_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onShow_faction_gift_info",a}(),s2c_show_faction_gift_unthank_page=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onShow_faction_gift_unthank_page",a}(),s2c_show_faction_gift_history_page=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onShow_faction_gift_history_page",a}(),c2s_get_faction_gift_rank_page=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.page=this.input.readUint32()},a.param_count=1,a.optname="onGet_faction_gift_rank_page",a}(),s2c_show_faction_gift_rank_result_list=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new faction_gift_rank_info;e.read(this.input),a.list.push(e)}a.info=new faction_gift_rank_info,a.info.read(this.input),a.page=this.input.readUint32()},a.param_count=3,a.optname="onShow_faction_gift_rank_result_list",a}(),s2c_show_faction_gift_rank_change=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.old_rank=this.input.readUint32(),a.new_rank=this.input.readUint32(),a.info=new faction_gift_rank_info,a.info.read(this.input)},a.param_count=3,a.optname="onShow_faction_gift_rank_change",a}(),s2c_show_faction_gift_rank_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.info=new faction_gift_rank_info,a.info.read(this.input)},a.param_count=1,a.optname="onShow_faction_gift_rank_info",a}(),c2s_divine_forge=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32(),a.count=this.input.readUint32()},a.param_count=2,a.optname="onDivine_forge",a}(),c2s_divine_advance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onDivine_advance",a}(),c2s_divine_spirit=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32(),a.protect=this.input.readUint32(),a.improve=this.input.readUint32()},a.param_count=3,a.optname="onDivine_spirit",a}(),c2s_query_mass_boss_info=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onQuery_mass_boss_info",a}(),s2c_mass_boss_info_ret=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.count=this.input.readUint32(),a.percent=this.input.readUint8()},a.param_count=2,a.optname="onMass_boss_info_ret",a}(),c2s_query_mass_boss_rank=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onQuery_mass_boss_rank",a}(),s2c_mass_boss_rank_result=function(){function a(){this.optcode=0,this.info=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.info.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new rank_info;e.read(this.input),a.info.push(e)}},a.param_count=1,a.optname="onMass_boss_rank_result",a}(),c2s_try_mass_boss=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onTry_mass_boss",a}(),c2s_buy_mass_boss_times=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.cnt=this.input.readUint8()},a.param_count=1,a.optname="onBuy_mass_boss_times",a}(),c2s_group_instance_match=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onGroup_instance_match",a}(),c2s_buy_group_instance_times=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.count=this.input.readUint8()},a.param_count=1,a.optname="onBuy_group_instance_times",a}(),c2s_talisman_active=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onTalisman_active",a}(),c2s_talisman_lvup=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onTalisman_lvup",a}(),c2s_wings_active=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWings_active",a}(),c2s_wings_bless=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWings_bless",a}(),c2s_wings_rankup=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWings_rankup",a}(),c2s_wings_strength=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onWings_strength",a}(),c2s_meridian_practise=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onMeridian_practise",a}(),c2s_add_meridian_exp=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onAdd_meridian_exp",a}(),c2s_raise_mount_level_base=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRaise_mount_level_base",a}(),c2s_active_mount=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onActive_mount",a}(),s2c_show_faction_bossdefense_damage_list=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new mass_boss_rank_info;e.read(this.input),a.list.push(e)}},a.param_count=1,a.optname="onShow_faction_bossdefense_damage_list",a}(),s2c_show_faction_tower_sweep_list=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.list.push(e)}},a.param_count=1,a.optname="onShow_faction_tower_sweep_list",a}(),s2c_send_instance_result=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.state=this.input.readUint8(),a.cd=this.input.readUint8(),a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new item_reward_info;e.read(this.input),a.list.push(e)}a.type=this.input.readUint8(),a.data=this.input.readString()},a.param_count=5,a.optname="onSend_instance_result",a}(),c2s_match_single_pvp=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onMatch_single_pvp",a}(),c2s_buy_match_single_pvp_times=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.cnt=this.input.readUint8()},a.param_count=1,a.optname="onBuy_match_single_pvp_times",a}(),c2s_pick_match_single_pvp_extra_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onPick_match_single_pvp_extra_reward",a}(),c2s_equipdevelop_operate=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.opt_type=this.input.readUint8(),a.reserve_int1=this.input.readUint16(),a.reserve_int2=this.input.readUint16(),a.reserve_str1=this.input.readString(),a.reserve_str2=this.input.readString()},a.param_count=5,a.optname="onEquipdevelop_operate",a}(),c2s_active_appearance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint16()},a.param_count=1,a.optname="onActive_appearance",a}(),c2s_equip_appearance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint16()},a.param_count=1,a.optname="onEquip_appearance",a}(),c2s_cancel_equip_appearance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.type=this.input.readUint8()},a.param_count=1,a.optname="onCancel_equip_appearance",a}(),c2s_rename=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.name=this.input.readString()},a.param_count=1,a.optname="onRename",a}(),c2s_unlock_title=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint8()},a.param_count=1,a.optname="onUnlock_title",a}(),c2s_social_buy_revenge_times=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.count=this.input.readUint8()},a.param_count=1,a.optname="onSocial_buy_revenge_times",a}(),c2s_enter_risk_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onEnter_risk_instance",a}(),c2s_social_remove_enemy=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onSocial_remove_enemy",a}(),c2s_get_player_overview=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onGet_player_overview",a}(),s2c_show_player_overview=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.name=this.input.readString(),a.force=this.input.readUint32(),a.vip=this.input.readUint32(),a.title=this.input.readUint32(),a.gender=this.input.readUint32(),a.coat=this.input.readUint32(),a.weapon=this.input.readUint32()},a.param_count=8,a.optname="onShow_player_overview",a}(),c2s_send_faction_invite=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onSend_faction_invite",a}(),s2c_show_faction_invite=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString(),a.name=this.input.readString(),a.faction_guid=this.input.readString(),a.faction_name=this.input.readString()},a.param_count=4,a.optname="onShow_faction_invite",a}(),c2s_buy_vipgift=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onBuy_vipgift",a}(),c2s_activity_opt_buy_dailygift=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.act_id=this.input.readUint32(),a.index=this.input.readUint32()},a.param_count=2,a.optname="onActivity_opt_buy_dailygift",a}(),c2s_draw_lottery=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.actId=this.input.readUint32(),a.type=this.input.readUint8()},a.param_count=2,a.optname="onDraw_lottery",a}(),c2s_activity_opt_get_rank_process_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.act_id=this.input.readUint32(),a.index=this.input.readUint32()},a.param_count=2,a.optname="onActivity_opt_get_rank_process_reward",a}(),c2s_activity_opt_get_rank_list=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.act_id=this.input.readUint32()},a.param_count=1,a.optname="onActivity_opt_get_rank_list",a}(),s2c_activity_opt_show_rank_list=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.act_id=this.input.readUint32(),a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new act_rank_info;e.read(this.input),a.list.push(e)}},a.param_count=2,a.optname="onActivity_opt_show_rank_list",a}(),c2s_activity_opt_buy_limitgift=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.act_id=this.input.readUint32(),a.index=this.input.readUint32()},a.param_count=2,a.optname="onActivity_opt_buy_limitgift",a}(),c2s_welfare_get_recharge_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_get_recharge_reward",a}(),c2s_welfare_get_consume_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_get_consume_reward",a}(),c2s_welfare_get_sevenday_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint8()},a.param_count=1,a.optname="onWelfare_get_sevenday_reward",a}(),s2c_send_server_open_time=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.open_time=this.input.readUint32()},a.param_count=1,a.optname="onSend_server_open_time",a}(),c2s_risk_get_rank=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onRisk_get_rank",a}(),s2c_risk_get_rank_result=function(){function a(){this.optcode=0,this.list=new Array}return a.read=function(a,b){if(null==this.input&&(this.input=new ByteArray),this.input=b,a.list.length)throw Error("通讯对象池有异常");for(var c=this.input.readUint16(),d=0;c>d;d++){var e=new act_rank_info;e.read(this.input),a.list.push(e)}},a.param_count=1,a.optname="onRisk_get_rank_result",a}(),c2s_set_orient=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.angle=this.input.readUint16()},a.param_count=1,a.optname="onSet_orient",a}(),c2s_use_moneytree=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onUse_moneytree",a}(),c2s_get_moneytree_gift=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onGet_moneytree_gift",a}(),c2s_set_world_risk_last_id=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onSet_world_risk_last_id",a}(),c2s_enter_private_boss=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onEnter_private_boss",a}(),c2s_raise_base_spell_all=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.raiseType=this.input.readUint8(),a.spellIdStr=this.input.readString()},a.param_count=2,a.optname="onRaise_base_spell_all",a}(),c2s_use_restore_potion=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onUse_restore_potion",a}(),c2s_pick_quest_adventure=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint32()},a.param_count=1,a.optname="onPick_quest_adventure",a}(),c2s_raise_adventurespell=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.spellId=this.input.readUint32()},a.param_count=1,a.optname="onRaise_adventurespell",a}(),c2s_pick_quest_realmbreak=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.indx=this.input.readUint32()},a.param_count=1,a.optname="onPick_quest_realmbreak",a}(),c2s_pick_realmbreak_daily_reward=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onPick_realmbreak_daily_reward",a}(),c2s_group_create=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGroup_create",a}(),c2s_group_join_request=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onGroup_join_request",a}(),c2s_group_join_accept=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onGroup_join_accept",a}(),c2s_group_quit=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onGroup_quit",a}(),c2s_group_give_captain=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onGroup_give_captain",a}(),c2s_group_kick=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.guid=this.input.readString()},a.param_count=1,a.optname="onGroup_kick",a}(),s2c_show_loot_animate=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.info=this.input.readString()},a.param_count=1,a.optname="onShow_loot_animate",a}(),c2s_enter_stage_instance=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b},a.param_count=0,a.optname="onEnter_stage_instance",a}(),c2s_pick_stage_instance_bonus=function(){function a(){this.optcode=0}return a.read=function(a,b){null==this.input&&(this.input=new ByteArray),this.input=b,a.id=this.input.readUint32()},a.param_count=1,a.optname="onPick_stage_instance_bonus",a}(),Protocols=function(){function a(a){this._FUNCS=new Object,this._stream=new ByteArray,this._send_func=a,this._stream.endian=Endian.LITTLE_ENDIAN,this._FUNCS[0]="null_action",this._FUNCS[1]="ping_pong",this._FUNCS[2]="forced_into",this._FUNCS[3]="get_session",this._FUNCS[4]="route_trace",this._FUNCS[5]="write_client_log",this._FUNCS[7]="sync_mstime",this._FUNCS[9]="ud_control",this._FUNCS[15]="get_chars_list",this._FUNCS[17]="check_name",this._FUNCS[19]="char_create",this._FUNCS[21]="delete_char",
this._FUNCS[23]="player_login",this._FUNCS[24]="player_logout",this._FUNCS[25]="regularise_account",this._FUNCS[26]="char_remotestore",this._FUNCS[27]="char_remotestore_str",this._FUNCS[28]="teleport",this._FUNCS[29]="move_stop",this._FUNCS[30]="unit_move",this._FUNCS[31]="use_gameobject",this._FUNCS[32]="bag_exchange_pos",this._FUNCS[33]="bag_destroy",this._FUNCS[34]="bag_item_split",this._FUNCS[35]="bag_item_user",this._FUNCS[39]="exchange_item",this._FUNCS[40]="bag_extension",this._FUNCS[41]="npc_get_goods_list",this._FUNCS[43]="store_buy",this._FUNCS[44]="npc_sell",this._FUNCS[45]="npc_repurchase",this._FUNCS[46]="avatar_fashion_enable",this._FUNCS[47]="questhelp_talk_option",this._FUNCS[48]="taxi_hello",this._FUNCS[50]="taxi_select_station",this._FUNCS[51]="gossip_select_option",this._FUNCS[52]="gossip_hello",this._FUNCS[54]="questgiver_status_query",this._FUNCS[56]="query_quest_status",this._FUNCS[57]="questhelp_get_canaccept_list",this._FUNCS[61]="questlog_remove_quest",this._FUNCS[62]="questgiver_complete_quest",this._FUNCS[64]="questhelp_complete",this._FUNCS[66]="questhelp_update_status",this._FUNCS[68]="questgiver_accept_quest",this._FUNCS[69]="questupdate_use_item",this._FUNCS[70]="questhelp_query_book",this._FUNCS[73]="set_attack_mode",this._FUNCS[74]="select_target",this._FUNCS[77]="spell_start",this._FUNCS[78]="spell_stop",this._FUNCS[79]="jump",this._FUNCS[80]="resurrection",this._FUNCS[81]="trade_request",this._FUNCS[82]="trade_reply",this._FUNCS[84]="trade_decide_items",this._FUNCS[86]="trade_cancel",this._FUNCS[87]="trade_ready",this._FUNCS[89]="chat_near",this._FUNCS[90]="chat_whisper",this._FUNCS[91]="chat_faction",this._FUNCS[92]="chat_world",this._FUNCS[93]="chat_horn",this._FUNCS[94]="chat_notice",this._FUNCS[95]="query_player_info",this._FUNCS[97]="receive_gift_packs",this._FUNCS[101]="instance_enter",this._FUNCS[102]="instance_next_state",this._FUNCS[103]="instance_exit",this._FUNCS[104]="limit_activity_receive",this._FUNCS[107]="warehouse_save_money",this._FUNCS[108]="warehouse_take_money",this._FUNCS[109]="use_gold_opt",this._FUNCS[110]="use_silver_opt",this._FUNCS[113]="sync_mstime_app",this._FUNCS[114]="open_window",this._FUNCS[115]="player_gag",this._FUNCS[116]="player_kicking",this._FUNCS[118]="rank_list_query",this._FUNCS[120]="client_update_scened",this._FUNCS[122]="loot_select",this._FUNCS[123]="goback_to_game_server",this._FUNCS[124]="world_war_CS_player_info",this._FUNCS[126]="world_war_SC_player_info",this._FUNCS[127]="clientSubscription",this._FUNCS[129]="char_update_info",this._FUNCS[131]="modify_watch",this._FUNCS[132]="kuafu_chuansong",this._FUNCS[133]="show_suit",this._FUNCS[134]="show_position",this._FUNCS[135]="gold_respawn",this._FUNCS[137]="mall_buy",this._FUNCS[139]="strength",this._FUNCS[141]="forceInto",this._FUNCS[142]="create_faction",this._FUNCS[143]="faction_upgrade",this._FUNCS[144]="faction_join",this._FUNCS[145]="raise_base_spell",this._FUNCS[146]="upgrade_anger_spell",this._FUNCS[147]="raise_mount",this._FUNCS[148]="upgrade_mount",this._FUNCS[149]="upgrade_mount_one_step",this._FUNCS[150]="illusion_mount_active",this._FUNCS[151]="illusion_mount",this._FUNCS[152]="ride_mount",this._FUNCS[154]="gem",this._FUNCS[155]="change_battle_mode",this._FUNCS[157]="divine_active",this._FUNCS[158]="divine_uplev",this._FUNCS[159]="divine_switch",this._FUNCS[160]="jump_start",this._FUNCS[161]="enter_vip_instance",this._FUNCS[162]="sweep_vip_instance",this._FUNCS[163]="hang_up",this._FUNCS[164]="hang_up_setting",this._FUNCS[165]="enter_trial_instance",this._FUNCS[166]="sweep_trial_instance",this._FUNCS[167]="reset_trial_instance",this._FUNCS[169]="reenter_instance",this._FUNCS[171]="social_add_friend",this._FUNCS[172]="social_sureadd_friend",this._FUNCS[173]="social_gift_friend",this._FUNCS[174]="social_recommend_friend",this._FUNCS[176]="social_revenge_enemy",this._FUNCS[177]="social_del_friend",this._FUNCS[178]="teleport_main_city",this._FUNCS[179]="chat_by_channel",this._FUNCS[181]="social_clear_apply",this._FUNCS[182]="msg_decline",this._FUNCS[184]="faction_getlist",this._FUNCS[185]="faction_manager",this._FUNCS[186]="faction_member_operate",this._FUNCS[187]="faction_fast_join",this._FUNCS[188]="social_add_friend_byname",this._FUNCS[190]="read_mail",this._FUNCS[191]="pick_mail",this._FUNCS[192]="remove_mail",this._FUNCS[193]="pick_mail_one_step",this._FUNCS[194]="remove_mail_one_step",this._FUNCS[195]="block_chat",this._FUNCS[196]="cancel_block_chat",this._FUNCS[200]="use_broadcast_gameobject",this._FUNCS[201]="world_boss_enroll",this._FUNCS[202]="world_boss_fight",this._FUNCS[203]="change_line",this._FUNCS[204]="roll_world_boss_treasure",this._FUNCS[207]="rank_add_like",this._FUNCS[210]="res_instance_enter",this._FUNCS[211]="res_instance_sweep",this._FUNCS[212]="show_map_line",this._FUNCS[216]="teleport_map",this._FUNCS[217]="teleport_field_boss",this._FUNCS[218]="get_activity_reward",this._FUNCS[220]="get_achieve_reward",this._FUNCS[221]="get_achieve_all_reward",this._FUNCS[222]="set_title",this._FUNCS[223]="init_title",this._FUNCS[224]="welfare_shouchong_reward",this._FUNCS[225]="welfare_checkin",this._FUNCS[226]="welfare_checkin_all",this._FUNCS[227]="welfare_checkin_getback",this._FUNCS[228]="welfare_level",this._FUNCS[229]="welfare_active_getback",this._FUNCS[230]="pick_quest_reward",this._FUNCS[231]="talk_with_npc",this._FUNCS[232]="use_virtual_item",this._FUNCS[233]="pick_quest_chapter_reward",this._FUNCS[234]="kuafu_3v3_match",this._FUNCS[236]="kuafu_3v3_buytimes",this._FUNCS[237]="kuafu_3v3_dayreward",this._FUNCS[238]="kuafu_3v3_getranlist",this._FUNCS[240]="welfare_getalllist_getback",this._FUNCS[242]="welfare_getall_getback",this._FUNCS[248]="kuafu_3v3_getmyrank",this._FUNCS[252]="kuafu_3v3_cancel_match",this._FUNCS[253]="kuafu_3v3_match_oper",this._FUNCS[255]="kuafu_xianfu_match",this._FUNCS[258]="buy_xianfu_item",this._FUNCS[259]="xianfu_random_respawn",this._FUNCS[260]="doujiantai_fight",this._FUNCS[261]="doujiantai_buytime",this._FUNCS[262]="doujiantai_clearcd",this._FUNCS[263]="doujiantai_first_reward",this._FUNCS[265]="doujiantai_get_enemys_info",this._FUNCS[266]="doujiantai_get_rank",this._FUNCS[270]="doujiantai_refresh_enemys",this._FUNCS[271]="doujiantai_top3",this._FUNCS[272]="use_jump_point",this._FUNCS[273]="bag_item_sell",this._FUNCS[274]="bag_item_sort",this._FUNCS[280]="submit_quest_daily2",this._FUNCS[284]="pick_daily2_quest_reward",this._FUNCS[285]="finish_now_guide",this._FUNCS[286]="get_cultivation_info",this._FUNCS[288]="get_cultivation_rivals_info",this._FUNCS[290]="get_cultivation_reward",this._FUNCS[291]="refresh_cultivation_rivals",this._FUNCS[292]="plunder_cultivation_rival",this._FUNCS[293]="revenge_cultivation_rival",this._FUNCS[294]="buy_cultivation_left_plunder_count",this._FUNCS[296]="get_login_activity_reward",this._FUNCS[301]="finish_optional_guide_step",this._FUNCS[302]="execute_quest_cmd_after_accepted",this._FUNCS[320]="back_to_famity",this._FUNCS[322]="challange_boss",this._FUNCS[325]="pick_offline_reward",this._FUNCS[327]="smelting_equip",this._FUNCS[328]="storehouse_hand_in",this._FUNCS[329]="storehouse_exchange",this._FUNCS[330]="storehouse_destroy",this._FUNCS[331]="send_faction_gift",this._FUNCS[332]="get_faction_gift_exreward",this._FUNCS[333]="get_all_faction_gift_exreward",this._FUNCS[338]="get_faction_gift_rank_page",this._FUNCS[342]="divine_forge",this._FUNCS[343]="divine_advance",this._FUNCS[344]="divine_spirit",this._FUNCS[352]="query_mass_boss_info",this._FUNCS[354]="query_mass_boss_rank",this._FUNCS[356]="try_mass_boss",this._FUNCS[357]="buy_mass_boss_times",this._FUNCS[358]="group_instance_match",this._FUNCS[359]="buy_group_instance_times",this._FUNCS[360]="talisman_active",this._FUNCS[361]="talisman_lvup",this._FUNCS[362]="wings_active",this._FUNCS[363]="wings_bless",this._FUNCS[364]="wings_rankup",this._FUNCS[365]="wings_strength",this._FUNCS[366]="meridian_practise",this._FUNCS[367]="add_meridian_exp",this._FUNCS[368]="raise_mount_level_base",this._FUNCS[369]="active_mount",this._FUNCS[376]="match_single_pvp",this._FUNCS[377]="buy_match_single_pvp_times",this._FUNCS[378]="pick_match_single_pvp_extra_reward",this._FUNCS[380]="equipdevelop_operate",this._FUNCS[381]="active_appearance",this._FUNCS[382]="equip_appearance",this._FUNCS[383]="cancel_equip_appearance",this._FUNCS[384]="rename",this._FUNCS[385]="unlock_title",this._FUNCS[386]="social_buy_revenge_times",this._FUNCS[387]="enter_risk_instance",this._FUNCS[388]="social_remove_enemy",this._FUNCS[389]="get_player_overview",this._FUNCS[391]="send_faction_invite",this._FUNCS[393]="buy_vipgift",this._FUNCS[394]="activity_opt_buy_dailygift",this._FUNCS[395]="draw_lottery",this._FUNCS[396]="activity_opt_get_rank_process_reward",this._FUNCS[397]="activity_opt_get_rank_list",this._FUNCS[399]="activity_opt_buy_limitgift",this._FUNCS[400]="welfare_get_recharge_reward",this._FUNCS[401]="welfare_get_consume_reward",this._FUNCS[402]="welfare_get_sevenday_reward",this._FUNCS[404]="risk_get_rank",this._FUNCS[406]="set_orient",this._FUNCS[407]="use_moneytree",this._FUNCS[408]="get_moneytree_gift",this._FUNCS[409]="set_world_risk_last_id",this._FUNCS[410]="enter_private_boss",this._FUNCS[411]="raise_base_spell_all",this._FUNCS[413]="use_restore_potion",this._FUNCS[414]="pick_quest_adventure",this._FUNCS[415]="raise_adventurespell",this._FUNCS[416]="pick_quest_realmbreak",this._FUNCS[417]="pick_realmbreak_daily_reward",this._FUNCS[418]="group_create",this._FUNCS[419]="group_join_request",this._FUNCS[420]="group_join_accept",this._FUNCS[421]="group_quit",this._FUNCS[422]="group_give_captain",this._FUNCS[423]="group_kick",this._FUNCS[425]="enter_stage_instance",this._FUNCS[426]="pick_stage_instance_bonus"}return a.prototype.getFuncName=function(a){return this._FUNCS[a]?this._FUNCS[a]:null},a.prototype.null_action=function(){this._stream.reset(),this._stream.optcode=0,this._stream.writeUint16(0),this._send_func(this._stream)},a.prototype.ping_pong=function(){this._stream.reset(),this._stream.optcode=1,this._stream.writeUint16(1),this._send_func(this._stream)},a.prototype.forced_into=function(){this._stream.reset(),this._stream.optcode=2,this._stream.writeUint16(2),this._send_func(this._stream)},a.prototype.get_session=function(a,b,c){this._stream.reset(),this._stream.optcode=3,this._stream.writeUint16(3),this._stream.writeString(a),this._stream.writeString(b),this._stream.writeString(c),this._send_func(this._stream)},a.prototype.route_trace=function(a){this._stream.reset(),this._stream.optcode=4,this._stream.writeUint16(4),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.write_client_log=function(a,b,c,d){this._stream.reset(),this._stream.optcode=5,this._stream.writeUint16(5),this._stream.writeUint32(a),this._stream.writeString(b),this._stream.writeString(c),this._stream.writeString(d),this._send_func(this._stream)},a.prototype.sync_mstime=function(a,b,c){this._stream.reset(),this._stream.optcode=7,this._stream.writeUint16(7),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.ud_control=function(){this._stream.reset(),this._stream.optcode=9,this._stream.writeUint16(9),this._send_func(this._stream)},a.prototype.get_chars_list=function(){this._stream.reset(),this._stream.optcode=15,this._stream.writeUint16(15),this._send_func(this._stream)},a.prototype.check_name=function(a){this._stream.reset(),this._stream.optcode=17,this._stream.writeUint16(17),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.char_create=function(a){this._stream.reset(),this._stream.optcode=19,this._stream.writeUint16(19),a.write(this._stream),this._send_func(this._stream)},a.prototype.delete_char=function(a){this._stream.reset(),this._stream.optcode=21,this._stream.writeUint16(21),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.player_login=function(a){this._stream.reset(),this._stream.optcode=23,this._stream.writeUint16(23),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.player_logout=function(){this._stream.reset(),this._stream.optcode=24,this._stream.writeUint16(24),this._send_func(this._stream)},a.prototype.regularise_account=function(a){this._stream.reset(),this._stream.optcode=25,this._stream.writeUint16(25),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.char_remotestore=function(a,b){this._stream.reset(),this._stream.optcode=26,this._stream.writeUint16(26),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.char_remotestore_str=function(a,b){this._stream.reset(),this._stream.optcode=27,this._stream.writeUint16(27),this._stream.writeUint32(a),this._stream.writeString(b),this._send_func(this._stream)},a.prototype.teleport=function(a){this._stream.reset(),this._stream.optcode=28,this._stream.writeUint16(28),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.move_stop=function(a,b,c){this._stream.reset(),this._stream.optcode=29,this._stream.writeUint16(29),this._stream.writeUint32(a),this._stream.writeUint16(b),this._stream.writeUint16(c),this._send_func(this._stream)},a.prototype.unit_move=function(a,b,c,d){this._stream.reset(),this._stream.optcode=30,this._stream.writeUint16(30),this._stream.writeUint32(a),this._stream.writeUint16(b),this._stream.writeUint16(c),this._stream.writeUint16(d.length);for(var e=0;e<d.length;e++)this._stream.writeInt8(d[e]);this._send_func(this._stream)},a.prototype.use_gameobject=function(a){this._stream.reset(),this._stream.optcode=31,this._stream.writeUint16(31),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.bag_exchange_pos=function(a,b,c,d){this._stream.reset(),this._stream.optcode=32,this._stream.writeUint16(32),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._stream.writeUint32(d),this._send_func(this._stream)},a.prototype.bag_destroy=function(a,b,c){this._stream.reset(),this._stream.optcode=33,this._stream.writeUint16(33),this._stream.writeString(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.bag_item_split=function(a,b,c,d,e){this._stream.reset(),this._stream.optcode=34,this._stream.writeUint16(34),this._stream.writeUint8(a),this._stream.writeUint16(b),this._stream.writeUint32(c),this._stream.writeUint16(d),this._stream.writeUint8(e),this._send_func(this._stream)},a.prototype.bag_item_user=function(a,b){this._stream.reset(),this._stream.optcode=35,this._stream.writeUint16(35),this._stream.writeString(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.exchange_item=function(a,b,c){this._stream.reset(),this._stream.optcode=39,this._stream.writeUint16(39),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.bag_extension=function(a,b,c){this._stream.reset(),this._stream.optcode=40,this._stream.writeUint16(40),this._stream.writeUint8(a),this._stream.writeUint8(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.npc_get_goods_list=function(a){this._stream.reset(),this._stream.optcode=41,this._stream.writeUint16(41),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.store_buy=function(a,b){this._stream.reset(),this._stream.optcode=43,this._stream.writeUint16(43),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.npc_sell=function(a,b,c){this._stream.reset(),this._stream.optcode=44,this._stream.writeUint16(44),this._stream.writeUint32(a),this._stream.writeString(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.npc_repurchase=function(a){this._stream.reset(),this._stream.optcode=45,this._stream.writeUint16(45),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.avatar_fashion_enable=function(a){this._stream.reset(),this._stream.optcode=46,this._stream.writeUint16(46),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.questhelp_talk_option=function(a,b,c,d){this._stream.reset(),this._stream.optcode=47,this._stream.writeUint16(47),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeInt32(c),this._stream.writeInt32(d),this._send_func(this._stream)},a.prototype.taxi_hello=function(a){this._stream.reset(),this._stream.optcode=48,this._stream.writeUint16(48),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.taxi_select_station=function(a,b){this._stream.reset(),this._stream.optcode=50,this._stream.writeUint16(50),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.gossip_select_option=function(a,b,c){this._stream.reset(),this._stream.optcode=51,this._stream.writeUint16(51),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeString(c),this._send_func(this._stream)},a.prototype.gossip_hello=function(a){this._stream.reset(),this._stream.optcode=52,this._stream.writeUint16(52),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.questgiver_status_query=function(a){this._stream.reset(),this._stream.optcode=54,this._stream.writeUint16(54),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.query_quest_status=function(a){this._stream.reset(),this._stream.optcode=56,this._stream.writeUint16(56),this._stream.writeUint16(a.length);for(var b=0;b<a.length;b++)a[b].write(this._stream);this._send_func(this._stream)},a.prototype.questhelp_get_canaccept_list=function(){this._stream.reset(),this._stream.optcode=57,this._stream.writeUint16(57),this._send_func(this._stream)},a.prototype.questlog_remove_quest=function(a,b){this._stream.reset(),this._stream.optcode=61,this._stream.writeUint16(61),this._stream.writeUint8(a),this._stream.writeUint64(b),this._send_func(this._stream)},a.prototype.questgiver_complete_quest=function(a,b,c){this._stream.reset(),this._stream.optcode=62,this._stream.writeUint16(62),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint8(c),this._send_func(this._stream)},a.prototype.questhelp_complete=function(a,b,c){this._stream.reset(),this._stream.optcode=64,this._stream.writeUint16(64),this._stream.writeUint32(a),this._stream.writeUint8(b),this._stream.writeUint8(c),this._send_func(this._stream)},a.prototype.questhelp_update_status=function(a,b,c){this._stream.reset(),this._stream.optcode=66,this._stream.writeUint16(66),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.questgiver_accept_quest=function(a,b){this._stream.reset(),this._stream.optcode=68,this._stream.writeUint16(68),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.questupdate_use_item=function(a){this._stream.reset(),this._stream.optcode=69,this._stream.writeUint16(69),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.questhelp_query_book=function(a){this._stream.reset(),this._stream.optcode=70,this._stream.writeUint16(70),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.set_attack_mode=function(a,b){this._stream.reset(),this._stream.optcode=73,this._stream.writeUint16(73),this._stream.writeUint8(a),this._stream.writeUint64(b),this._send_func(this._stream)},a.prototype.select_target=function(a){this._stream.reset(),this._stream.optcode=74,this._stream.writeUint16(74),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.spell_start=function(a,b,c,d,e){this._stream.reset(),this._stream.optcode=77,this._stream.writeUint16(77),this._stream.writeUint32(a),this._stream.writeUint16(b),this._stream.writeUint16(c),this._stream.writeUint32(d),this._stream.writeUint32(e),this._send_func(this._stream)},a.prototype.spell_stop=function(a){this._stream.reset(),this._stream.optcode=78,this._stream.writeUint16(78),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.jump=function(a,b,c){this._stream.reset(),this._stream.optcode=79,this._stream.writeUint16(79),this._stream.writeUint32(a),this._stream.writeFloat(b),this._stream.writeFloat(c),this._send_func(this._stream)},a.prototype.resurrection=function(a,b){this._stream.reset(),this._stream.optcode=80,this._stream.writeUint16(80),this._stream.writeUint8(a),this._stream.writeUint64(b),this._send_func(this._stream)},a.prototype.trade_request=function(a){this._stream.reset(),this._stream.optcode=81,this._stream.writeUint16(81),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.trade_reply=function(a,b){this._stream.reset(),this._stream.optcode=82,this._stream.writeUint16(82),this._stream.writeString(a),this._stream.writeUint8(b),this._send_func(this._stream)},a.prototype.trade_decide_items=function(a,b,c){if(this._stream.reset(),this._stream.optcode=84,this._stream.writeUint16(84),a.length>1e3)throw"StringArray::length max 1000";this._stream.writeUint16(a.length);for(var d=0;d<a.length;d++)this._stream.writeString(a[d]);this._stream.writeInt32(b),this._stream.writeInt32(c),this._send_func(this._stream)},a.prototype.trade_cancel=function(){this._stream.reset(),this._stream.optcode=86,this._stream.writeUint16(86),this._send_func(this._stream)},a.prototype.trade_ready=function(){this._stream.reset(),this._stream.optcode=87,this._stream.writeUint16(87),this._send_func(this._stream)},a.prototype.chat_near=function(a){this._stream.reset(),this._stream.optcode=89,this._stream.writeUint16(89),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.chat_whisper=function(a,b){this._stream.reset(),this._stream.optcode=90,this._stream.writeUint16(90),this._stream.writeString(a),this._stream.writeString(b),this._send_func(this._stream)},a.prototype.chat_faction=function(a,b,c,d){this._stream.reset(),this._stream.optcode=91,this._stream.writeUint16(91),this._stream.writeString(a),this._stream.writeString(b),this._stream.writeString(c),this._stream.writeUint8(d),this._send_func(this._stream)},a.prototype.chat_world=function(a,b,c,d){this._stream.reset(),this._stream.optcode=92,this._stream.writeUint16(92),this._stream.writeString(a),this._stream.writeUint8(b),this._stream.writeString(c),this._stream.writeString(d),this._send_func(this._stream)},a.prototype.chat_horn=function(a,b,c,d){this._stream.reset(),this._stream.optcode=93,this._stream.writeUint16(93),this._stream.writeString(a),this._stream.writeUint8(b),this._stream.writeString(c),this._stream.writeString(d),this._send_func(this._stream)},a.prototype.chat_notice=function(a,b,c){this._stream.reset(),this._stream.optcode=94,this._stream.writeUint16(94),this._stream.writeUint32(a),this._stream.writeString(b),this._stream.writeString(c),this._send_func(this._stream)},a.prototype.query_player_info=function(a,b,c){this._stream.reset(),this._stream.optcode=95,this._stream.writeUint16(95),this._stream.writeString(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.receive_gift_packs=function(){this._stream.reset(),this._stream.optcode=97,this._stream.writeUint16(97),this._send_func(this._stream)},a.prototype.instance_enter=function(a){this._stream.reset(),this._stream.optcode=101,this._stream.writeUint16(101),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.instance_next_state=function(a,b){this._stream.reset(),this._stream.optcode=102,this._stream.writeUint16(102),this._stream.writeUint16(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.instance_exit=function(a){this._stream.reset(),this._stream.optcode=103,this._stream.writeUint16(103),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.limit_activity_receive=function(a,b){this._stream.reset(),this._stream.optcode=104,this._stream.writeUint16(104),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.warehouse_save_money=function(a,b,c){this._stream.reset(),this._stream.optcode=107,this._stream.writeUint16(107),this._stream.writeInt32(a),this._stream.writeInt32(b),this._stream.writeInt32(c),this._send_func(this._stream)},a.prototype.warehouse_take_money=function(a,b,c){this._stream.reset(),this._stream.optcode=108,this._stream.writeUint16(108),this._stream.writeInt32(a),this._stream.writeInt32(b),this._stream.writeInt32(c),this._send_func(this._stream)},a.prototype.use_gold_opt=function(a,b){this._stream.reset(),this._stream.optcode=109,this._stream.writeUint16(109),this._stream.writeUint8(a),this._stream.writeString(b),this._send_func(this._stream)},a.prototype.use_silver_opt=function(a){this._stream.reset(),this._stream.optcode=110,this._stream.writeUint16(110),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.sync_mstime_app=function(a,b,c){this._stream.reset(),this._stream.optcode=113,this._stream.writeUint16(113),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.open_window=function(a){this._stream.reset(),this._stream.optcode=114,this._stream.writeUint16(114),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.player_gag=function(a,b,c){this._stream.reset(),this._stream.optcode=115,this._stream.writeUint16(115),this._stream.writeString(a),this._stream.writeUint32(b),this._stream.writeString(c),this._send_func(this._stream)},a.prototype.player_kicking=function(a){this._stream.reset(),this._stream.optcode=116,this._stream.writeUint16(116),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.rank_list_query=function(a,b,c,d){this._stream.reset(),this._stream.optcode=118,this._stream.writeUint16(118),this._stream.writeUint32(a),this._stream.writeUint8(b),this._stream.writeUint16(c),this._stream.writeUint16(d),this._send_func(this._stream)},a.prototype.client_update_scened=function(){this._stream.reset(),this._stream.optcode=120,this._stream.writeUint16(120),this._send_func(this._stream)},a.prototype.loot_select=function(a,b){this._stream.reset(),this._stream.optcode=122,this._stream.writeUint16(122),this._stream.writeUint16(a),this._stream.writeUint16(b),this._send_func(this._stream)},a.prototype.goback_to_game_server=function(){this._stream.reset(),this._stream.optcode=123,this._stream.writeUint16(123),this._send_func(this._stream)},a.prototype.world_war_CS_player_info=function(){this._stream.reset(),this._stream.optcode=124,this._stream.writeUint16(124),this._send_func(this._stream)},a.prototype.world_war_SC_player_info=function(){this._stream.reset(),this._stream.optcode=126,this._stream.writeUint16(126),this._send_func(this._stream)},a.prototype.clientSubscription=function(a){this._stream.reset(),this._stream.optcode=127,this._stream.writeUint16(127),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.char_update_info=function(a){this._stream.reset(),this._stream.optcode=129,this._stream.writeUint16(129),a.write(this._stream),this._send_func(this._stream)},a.prototype.modify_watch=function(a,b,c){this._stream.reset(),this._stream.optcode=131,this._stream.writeUint16(131),this._stream.writeUint8(a),this._stream.writeUint32(b),this._stream.writeString(c),this._send_func(this._stream)},a.prototype.kuafu_chuansong=function(a,b,c){this._stream.reset(),this._stream.optcode=132,this._stream.writeUint16(132),this._stream.writeString(a),this._stream.writeString(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.show_suit=function(a){this._stream.reset(),this._stream.optcode=133,this._stream.writeUint16(133),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.show_position=function(a){this._stream.reset(),this._stream.optcode=134,this._stream.writeUint16(134),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.gold_respawn=function(a){this._stream.reset(),this._stream.optcode=135,this._stream.writeUint16(135),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.mall_buy=function(a,b,c){this._stream.reset(),this._stream.optcode=137,this._stream.writeUint16(137),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.strength=function(a){this._stream.reset(),this._stream.optcode=139,this._stream.writeUint16(139),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.forceInto=function(){this._stream.reset(),this._stream.optcode=141,this._stream.writeUint16(141),this._send_func(this._stream)},a.prototype.create_faction=function(a,b){this._stream.reset(),this._stream.optcode=142,this._stream.writeUint16(142),this._stream.writeString(a),this._stream.writeUint8(b),this._send_func(this._stream)},a.prototype.faction_upgrade=function(){this._stream.reset(),this._stream.optcode=143,this._stream.writeUint16(143),this._send_func(this._stream)},a.prototype.faction_join=function(a){this._stream.reset(),this._stream.optcode=144,this._stream.writeUint16(144),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.raise_base_spell=function(a,b){this._stream.reset(),this._stream.optcode=145,this._stream.writeUint16(145),this._stream.writeUint8(a),this._stream.writeUint16(b),this._send_func(this._stream)},a.prototype.upgrade_anger_spell=function(a){this._stream.reset(),this._stream.optcode=146,this._stream.writeUint16(146),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.raise_mount=function(){this._stream.reset(),this._stream.optcode=147,this._stream.writeUint16(147),this._send_func(this._stream)},a.prototype.upgrade_mount=function(a){this._stream.reset(),this._stream.optcode=148,this._stream.writeUint16(148),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.upgrade_mount_one_step=function(a){this._stream.reset(),this._stream.optcode=149,this._stream.writeUint16(149),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.illusion_mount_active=function(a){this._stream.reset(),this._stream.optcode=150,this._stream.writeUint16(150),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.illusion_mount=function(a){this._stream.reset(),this._stream.optcode=151,this._stream.writeUint16(151),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.ride_mount=function(){this._stream.reset(),this._stream.optcode=152,this._stream.writeUint16(152),this._send_func(this._stream)},a.prototype.gem=function(a){this._stream.reset(),this._stream.optcode=154,this._stream.writeUint16(154),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.change_battle_mode=function(a){this._stream.reset(),this._stream.optcode=155,this._stream.writeUint16(155),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.divine_active=function(a){this._stream.reset(),this._stream.optcode=157,this._stream.writeUint16(157),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.divine_uplev=function(a){this._stream.reset(),this._stream.optcode=158,this._stream.writeUint16(158),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.divine_switch=function(a){this._stream.reset(),this._stream.optcode=159,this._stream.writeUint16(159),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.jump_start=function(a,b){this._stream.reset(),this._stream.optcode=160,this._stream.writeUint16(160),this._stream.writeUint16(a),this._stream.writeUint16(b),this._send_func(this._stream)},a.prototype.enter_vip_instance=function(a,b){this._stream.reset(),this._stream.optcode=161,this._stream.writeUint16(161),this._stream.writeUint16(a),this._stream.writeUint8(b),this._send_func(this._stream)},a.prototype.sweep_vip_instance=function(a){this._stream.reset(),this._stream.optcode=162,this._stream.writeUint16(162),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.hang_up=function(){this._stream.reset(),this._stream.optcode=163,this._stream.writeUint16(163),this._send_func(this._stream);
},a.prototype.hang_up_setting=function(a,b,c,d){this._stream.reset(),this._stream.optcode=164,this._stream.writeUint16(164),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._stream.writeUint32(d),this._send_func(this._stream)},a.prototype.enter_trial_instance=function(){this._stream.reset(),this._stream.optcode=165,this._stream.writeUint16(165),this._send_func(this._stream)},a.prototype.sweep_trial_instance=function(){this._stream.reset(),this._stream.optcode=166,this._stream.writeUint16(166),this._send_func(this._stream)},a.prototype.reset_trial_instance=function(){this._stream.reset(),this._stream.optcode=167,this._stream.writeUint16(167),this._send_func(this._stream)},a.prototype.reenter_instance=function(){this._stream.reset(),this._stream.optcode=169,this._stream.writeUint16(169),this._send_func(this._stream)},a.prototype.social_add_friend=function(a){this._stream.reset(),this._stream.optcode=171,this._stream.writeUint16(171),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.social_sureadd_friend=function(a){this._stream.reset(),this._stream.optcode=172,this._stream.writeUint16(172),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.social_gift_friend=function(a,b){this._stream.reset(),this._stream.optcode=173,this._stream.writeUint16(173),this._stream.writeString(a),this._stream.writeUint16(b.length);for(var c=0;c<b.length;c++)b[c].write(this._stream);this._send_func(this._stream)},a.prototype.social_recommend_friend=function(){this._stream.reset(),this._stream.optcode=174,this._stream.writeUint16(174),this._send_func(this._stream)},a.prototype.social_revenge_enemy=function(a){this._stream.reset(),this._stream.optcode=176,this._stream.writeUint16(176),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.social_del_friend=function(a){this._stream.reset(),this._stream.optcode=177,this._stream.writeUint16(177),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.teleport_main_city=function(){this._stream.reset(),this._stream.optcode=178,this._stream.writeUint16(178),this._send_func(this._stream)},a.prototype.chat_by_channel=function(a,b){this._stream.reset(),this._stream.optcode=179,this._stream.writeUint16(179),this._stream.writeUint8(a),this._stream.writeString(b),this._send_func(this._stream)},a.prototype.social_clear_apply=function(){this._stream.reset(),this._stream.optcode=181,this._stream.writeUint16(181),this._send_func(this._stream)},a.prototype.msg_decline=function(a,b){this._stream.reset(),this._stream.optcode=182,this._stream.writeUint16(182),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.faction_getlist=function(a,b,c){this._stream.reset(),this._stream.optcode=184,this._stream.writeUint16(184),this._stream.writeUint8(a),this._stream.writeUint8(b),this._stream.writeUint8(c),this._send_func(this._stream)},a.prototype.faction_manager=function(a,b,c,d,e){this._stream.reset(),this._stream.optcode=185,this._stream.writeUint16(185),this._stream.writeUint8(a),this._stream.writeUint16(b),this._stream.writeUint16(c),this._stream.writeString(d),this._stream.writeString(e),this._send_func(this._stream)},a.prototype.faction_member_operate=function(a,b,c,d,e){this._stream.reset(),this._stream.optcode=186,this._stream.writeUint16(186),this._stream.writeUint8(a),this._stream.writeUint16(b),this._stream.writeUint16(c),this._stream.writeString(d),this._stream.writeString(e),this._send_func(this._stream)},a.prototype.faction_fast_join=function(){this._stream.reset(),this._stream.optcode=187,this._stream.writeUint16(187),this._send_func(this._stream)},a.prototype.social_add_friend_byname=function(a){this._stream.reset(),this._stream.optcode=188,this._stream.writeUint16(188),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.read_mail=function(a){this._stream.reset(),this._stream.optcode=190,this._stream.writeUint16(190),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.pick_mail=function(a){this._stream.reset(),this._stream.optcode=191,this._stream.writeUint16(191),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.remove_mail=function(a){this._stream.reset(),this._stream.optcode=192,this._stream.writeUint16(192),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.pick_mail_one_step=function(){this._stream.reset(),this._stream.optcode=193,this._stream.writeUint16(193),this._send_func(this._stream)},a.prototype.remove_mail_one_step=function(){this._stream.reset(),this._stream.optcode=194,this._stream.writeUint16(194),this._send_func(this._stream)},a.prototype.block_chat=function(a){this._stream.reset(),this._stream.optcode=195,this._stream.writeUint16(195),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.cancel_block_chat=function(a){this._stream.reset(),this._stream.optcode=196,this._stream.writeUint16(196),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.use_broadcast_gameobject=function(a){this._stream.reset(),this._stream.optcode=200,this._stream.writeUint16(200),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.world_boss_enroll=function(){this._stream.reset(),this._stream.optcode=201,this._stream.writeUint16(201),this._send_func(this._stream)},a.prototype.world_boss_fight=function(){this._stream.reset(),this._stream.optcode=202,this._stream.writeUint16(202),this._send_func(this._stream)},a.prototype.change_line=function(a){this._stream.reset(),this._stream.optcode=203,this._stream.writeUint16(203),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.roll_world_boss_treasure=function(){this._stream.reset(),this._stream.optcode=204,this._stream.writeUint16(204),this._send_func(this._stream)},a.prototype.rank_add_like=function(a,b){this._stream.reset(),this._stream.optcode=207,this._stream.writeUint16(207),this._stream.writeUint8(a),this._stream.writeString(b),this._send_func(this._stream)},a.prototype.res_instance_enter=function(a){this._stream.reset(),this._stream.optcode=210,this._stream.writeUint16(210),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.res_instance_sweep=function(a){this._stream.reset(),this._stream.optcode=211,this._stream.writeUint16(211),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.show_map_line=function(){this._stream.reset(),this._stream.optcode=212,this._stream.writeUint16(212),this._send_func(this._stream)},a.prototype.teleport_map=function(a,b){this._stream.reset(),this._stream.optcode=216,this._stream.writeUint16(216),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.teleport_field_boss=function(a,b){this._stream.reset(),this._stream.optcode=217,this._stream.writeUint16(217),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.get_activity_reward=function(a,b){this._stream.reset(),this._stream.optcode=218,this._stream.writeUint16(218),this._stream.writeUint8(a),this._stream.writeUint8(b),this._send_func(this._stream)},a.prototype.get_achieve_reward=function(a){this._stream.reset(),this._stream.optcode=220,this._stream.writeUint16(220),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.get_achieve_all_reward=function(){this._stream.reset(),this._stream.optcode=221,this._stream.writeUint16(221),this._send_func(this._stream)},a.prototype.set_title=function(a){this._stream.reset(),this._stream.optcode=222,this._stream.writeUint16(222),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.init_title=function(a){this._stream.reset(),this._stream.optcode=223,this._stream.writeUint16(223),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.welfare_shouchong_reward=function(){this._stream.reset(),this._stream.optcode=224,this._stream.writeUint16(224),this._send_func(this._stream)},a.prototype.welfare_checkin=function(){this._stream.reset(),this._stream.optcode=225,this._stream.writeUint16(225),this._send_func(this._stream)},a.prototype.welfare_checkin_all=function(a){this._stream.reset(),this._stream.optcode=226,this._stream.writeUint16(226),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.welfare_checkin_getback=function(a){this._stream.reset(),this._stream.optcode=227,this._stream.writeUint16(227),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.welfare_level=function(a){this._stream.reset(),this._stream.optcode=228,this._stream.writeUint16(228),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.welfare_active_getback=function(a,b,c){this._stream.reset(),this._stream.optcode=229,this._stream.writeUint16(229),this._stream.writeUint8(a),this._stream.writeUint8(b),this._stream.writeUint16(c),this._send_func(this._stream)},a.prototype.pick_quest_reward=function(a){this._stream.reset(),this._stream.optcode=230,this._stream.writeUint16(230),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.talk_with_npc=function(a,b){this._stream.reset(),this._stream.optcode=231,this._stream.writeUint16(231),this._stream.writeUint32(a),this._stream.writeUint16(b),this._send_func(this._stream)},a.prototype.use_virtual_item=function(a){this._stream.reset(),this._stream.optcode=232,this._stream.writeUint16(232),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.pick_quest_chapter_reward=function(a){this._stream.reset(),this._stream.optcode=233,this._stream.writeUint16(233),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.kuafu_3v3_match=function(){this._stream.reset(),this._stream.optcode=234,this._stream.writeUint16(234),this._send_func(this._stream)},a.prototype.kuafu_3v3_buytimes=function(a){this._stream.reset(),this._stream.optcode=236,this._stream.writeUint16(236),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.kuafu_3v3_dayreward=function(a){this._stream.reset(),this._stream.optcode=237,this._stream.writeUint16(237),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.kuafu_3v3_getranlist=function(){this._stream.reset(),this._stream.optcode=238,this._stream.writeUint16(238),this._send_func(this._stream)},a.prototype.welfare_getalllist_getback=function(a){this._stream.reset(),this._stream.optcode=240,this._stream.writeUint16(240),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.welfare_getall_getback=function(a){this._stream.reset(),this._stream.optcode=242,this._stream.writeUint16(242),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.kuafu_3v3_getmyrank=function(){this._stream.reset(),this._stream.optcode=248,this._stream.writeUint16(248),this._send_func(this._stream)},a.prototype.kuafu_3v3_cancel_match=function(a){this._stream.reset(),this._stream.optcode=252,this._stream.writeUint16(252),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.kuafu_3v3_match_oper=function(a){this._stream.reset(),this._stream.optcode=253,this._stream.writeUint16(253),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.kuafu_xianfu_match=function(a){this._stream.reset(),this._stream.optcode=255,this._stream.writeUint16(255),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.buy_xianfu_item=function(a,b,c){this._stream.reset(),this._stream.optcode=258,this._stream.writeUint16(258),this._stream.writeUint8(a),this._stream.writeUint8(b),this._stream.writeUint16(c),this._send_func(this._stream)},a.prototype.xianfu_random_respawn=function(){this._stream.reset(),this._stream.optcode=259,this._stream.writeUint16(259),this._send_func(this._stream)},a.prototype.doujiantai_fight=function(a){this._stream.reset(),this._stream.optcode=260,this._stream.writeUint16(260),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.doujiantai_buytime=function(a){this._stream.reset(),this._stream.optcode=261,this._stream.writeUint16(261),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.doujiantai_clearcd=function(){this._stream.reset(),this._stream.optcode=262,this._stream.writeUint16(262),this._send_func(this._stream)},a.prototype.doujiantai_first_reward=function(a){this._stream.reset(),this._stream.optcode=263,this._stream.writeUint16(263),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.doujiantai_get_enemys_info=function(){this._stream.reset(),this._stream.optcode=265,this._stream.writeUint16(265),this._send_func(this._stream)},a.prototype.doujiantai_get_rank=function(a,b){this._stream.reset(),this._stream.optcode=266,this._stream.writeUint16(266),this._stream.writeUint16(a),this._stream.writeUint16(b),this._send_func(this._stream)},a.prototype.doujiantai_refresh_enemys=function(){this._stream.reset(),this._stream.optcode=270,this._stream.writeUint16(270),this._send_func(this._stream)},a.prototype.doujiantai_top3=function(){this._stream.reset(),this._stream.optcode=271,this._stream.writeUint16(271),this._send_func(this._stream)},a.prototype.use_jump_point=function(a){this._stream.reset(),this._stream.optcode=272,this._stream.writeUint16(272),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.bag_item_sell=function(a,b){this._stream.reset(),this._stream.optcode=273,this._stream.writeUint16(273),this._stream.writeString(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.bag_item_sort=function(a){this._stream.reset(),this._stream.optcode=274,this._stream.writeUint16(274),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.submit_quest_daily2=function(){this._stream.reset(),this._stream.optcode=280,this._stream.writeUint16(280),this._send_func(this._stream)},a.prototype.pick_daily2_quest_reward=function(a){this._stream.reset(),this._stream.optcode=284,this._stream.writeUint16(284),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.finish_now_guide=function(){this._stream.reset(),this._stream.optcode=285,this._stream.writeUint16(285),this._send_func(this._stream)},a.prototype.get_cultivation_info=function(){this._stream.reset(),this._stream.optcode=286,this._stream.writeUint16(286),this._send_func(this._stream)},a.prototype.get_cultivation_rivals_info=function(){this._stream.reset(),this._stream.optcode=288,this._stream.writeUint16(288),this._send_func(this._stream)},a.prototype.get_cultivation_reward=function(){this._stream.reset(),this._stream.optcode=290,this._stream.writeUint16(290),this._send_func(this._stream)},a.prototype.refresh_cultivation_rivals=function(){this._stream.reset(),this._stream.optcode=291,this._stream.writeUint16(291),this._send_func(this._stream)},a.prototype.plunder_cultivation_rival=function(a){this._stream.reset(),this._stream.optcode=292,this._stream.writeUint16(292),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.revenge_cultivation_rival=function(a){this._stream.reset(),this._stream.optcode=293,this._stream.writeUint16(293),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.buy_cultivation_left_plunder_count=function(a){this._stream.reset(),this._stream.optcode=294,this._stream.writeUint16(294),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.get_login_activity_reward=function(a){this._stream.reset(),this._stream.optcode=296,this._stream.writeUint16(296),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.finish_optional_guide_step=function(a,b){this._stream.reset(),this._stream.optcode=301,this._stream.writeUint16(301),this._stream.writeUint32(a),this._stream.writeUint8(b),this._send_func(this._stream)},a.prototype.execute_quest_cmd_after_accepted=function(a){this._stream.reset(),this._stream.optcode=302,this._stream.writeUint16(302),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.back_to_famity=function(){this._stream.reset(),this._stream.optcode=320,this._stream.writeUint16(320),this._send_func(this._stream)},a.prototype.challange_boss=function(){this._stream.reset(),this._stream.optcode=322,this._stream.writeUint16(322),this._send_func(this._stream)},a.prototype.pick_offline_reward=function(){this._stream.reset(),this._stream.optcode=325,this._stream.writeUint16(325),this._send_func(this._stream)},a.prototype.smelting_equip=function(a){this._stream.reset(),this._stream.optcode=327,this._stream.writeUint16(327),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.storehouse_hand_in=function(a){this._stream.reset(),this._stream.optcode=328,this._stream.writeUint16(328),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.storehouse_exchange=function(a){this._stream.reset(),this._stream.optcode=329,this._stream.writeUint16(329),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.storehouse_destroy=function(a){this._stream.reset(),this._stream.optcode=330,this._stream.writeUint16(330),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.send_faction_gift=function(a,b,c){this._stream.reset(),this._stream.optcode=331,this._stream.writeUint16(331),this._stream.writeUint16(a.length);for(var d=0;d<a.length;d++)a[d].write(this._stream);this._stream.writeString(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.get_faction_gift_exreward=function(a){this._stream.reset(),this._stream.optcode=332,this._stream.writeUint16(332),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.get_all_faction_gift_exreward=function(){this._stream.reset(),this._stream.optcode=333,this._stream.writeUint16(333),this._send_func(this._stream)},a.prototype.get_faction_gift_rank_page=function(a){this._stream.reset(),this._stream.optcode=338,this._stream.writeUint16(338),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.divine_forge=function(a,b){this._stream.reset(),this._stream.optcode=342,this._stream.writeUint16(342),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.divine_advance=function(a){this._stream.reset(),this._stream.optcode=343,this._stream.writeUint16(343),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.divine_spirit=function(a,b,c){this._stream.reset(),this._stream.optcode=344,this._stream.writeUint16(344),this._stream.writeUint32(a),this._stream.writeUint32(b),this._stream.writeUint32(c),this._send_func(this._stream)},a.prototype.query_mass_boss_info=function(a){this._stream.reset(),this._stream.optcode=352,this._stream.writeUint16(352),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.query_mass_boss_rank=function(a){this._stream.reset(),this._stream.optcode=354,this._stream.writeUint16(354),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.try_mass_boss=function(a){this._stream.reset(),this._stream.optcode=356,this._stream.writeUint16(356),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.buy_mass_boss_times=function(a){this._stream.reset(),this._stream.optcode=357,this._stream.writeUint16(357),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.group_instance_match=function(a){this._stream.reset(),this._stream.optcode=358,this._stream.writeUint16(358),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.buy_group_instance_times=function(a){this._stream.reset(),this._stream.optcode=359,this._stream.writeUint16(359),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.talisman_active=function(a){this._stream.reset(),this._stream.optcode=360,this._stream.writeUint16(360),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.talisman_lvup=function(a){this._stream.reset(),this._stream.optcode=361,this._stream.writeUint16(361),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.wings_active=function(){this._stream.reset(),this._stream.optcode=362,this._stream.writeUint16(362),this._send_func(this._stream)},a.prototype.wings_bless=function(){this._stream.reset(),this._stream.optcode=363,this._stream.writeUint16(363),this._send_func(this._stream)},a.prototype.wings_rankup=function(){this._stream.reset(),this._stream.optcode=364,this._stream.writeUint16(364),this._send_func(this._stream)},a.prototype.wings_strength=function(){this._stream.reset(),this._stream.optcode=365,this._stream.writeUint16(365),this._send_func(this._stream)},a.prototype.meridian_practise=function(){this._stream.reset(),this._stream.optcode=366,this._stream.writeUint16(366),this._send_func(this._stream)},a.prototype.add_meridian_exp=function(a){this._stream.reset(),this._stream.optcode=367,this._stream.writeUint16(367),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.raise_mount_level_base=function(){this._stream.reset(),this._stream.optcode=368,this._stream.writeUint16(368),this._send_func(this._stream)},a.prototype.active_mount=function(){this._stream.reset(),this._stream.optcode=369,this._stream.writeUint16(369),this._send_func(this._stream)},a.prototype.match_single_pvp=function(){this._stream.reset(),this._stream.optcode=376,this._stream.writeUint16(376),this._send_func(this._stream)},a.prototype.buy_match_single_pvp_times=function(a){this._stream.reset(),this._stream.optcode=377,this._stream.writeUint16(377),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.pick_match_single_pvp_extra_reward=function(a){this._stream.reset(),this._stream.optcode=378,this._stream.writeUint16(378),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.equipdevelop_operate=function(a,b,c,d,e){this._stream.reset(),this._stream.optcode=380,this._stream.writeUint16(380),this._stream.writeUint8(a),this._stream.writeUint16(b),this._stream.writeUint16(c),this._stream.writeString(d),this._stream.writeString(e),this._send_func(this._stream)},a.prototype.active_appearance=function(a){this._stream.reset(),this._stream.optcode=381,this._stream.writeUint16(381),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.equip_appearance=function(a){this._stream.reset(),this._stream.optcode=382,this._stream.writeUint16(382),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.cancel_equip_appearance=function(a){this._stream.reset(),this._stream.optcode=383,this._stream.writeUint16(383),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.rename=function(a){this._stream.reset(),this._stream.optcode=384,this._stream.writeUint16(384),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.unlock_title=function(a){this._stream.reset(),this._stream.optcode=385,this._stream.writeUint16(385),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.social_buy_revenge_times=function(a){this._stream.reset(),this._stream.optcode=386,this._stream.writeUint16(386),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.enter_risk_instance=function(){this._stream.reset(),this._stream.optcode=387,this._stream.writeUint16(387),this._send_func(this._stream)},a.prototype.social_remove_enemy=function(a){this._stream.reset(),this._stream.optcode=388,this._stream.writeUint16(388),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.get_player_overview=function(a){this._stream.reset(),this._stream.optcode=389,this._stream.writeUint16(389),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.send_faction_invite=function(a){this._stream.reset(),this._stream.optcode=391,this._stream.writeUint16(391),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.buy_vipgift=function(a){this._stream.reset(),this._stream.optcode=393,this._stream.writeUint16(393),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.activity_opt_buy_dailygift=function(a,b){this._stream.reset(),this._stream.optcode=394,this._stream.writeUint16(394),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.draw_lottery=function(a,b){this._stream.reset(),this._stream.optcode=395,this._stream.writeUint16(395),this._stream.writeUint32(a),this._stream.writeUint8(b),this._send_func(this._stream)},a.prototype.activity_opt_get_rank_process_reward=function(a,b){this._stream.reset(),this._stream.optcode=396,this._stream.writeUint16(396),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.activity_opt_get_rank_list=function(a){this._stream.reset(),this._stream.optcode=397,this._stream.writeUint16(397),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.activity_opt_buy_limitgift=function(a,b){this._stream.reset(),this._stream.optcode=399,this._stream.writeUint16(399),this._stream.writeUint32(a),this._stream.writeUint32(b),this._send_func(this._stream)},a.prototype.welfare_get_recharge_reward=function(a){this._stream.reset(),this._stream.optcode=400,this._stream.writeUint16(400),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.welfare_get_consume_reward=function(a){this._stream.reset(),this._stream.optcode=401,this._stream.writeUint16(401),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.welfare_get_sevenday_reward=function(a){this._stream.reset(),this._stream.optcode=402,this._stream.writeUint16(402),this._stream.writeUint8(a),this._send_func(this._stream)},a.prototype.risk_get_rank=function(){this._stream.reset(),this._stream.optcode=404,this._stream.writeUint16(404),this._send_func(this._stream)},a.prototype.set_orient=function(a){this._stream.reset(),this._stream.optcode=406,this._stream.writeUint16(406),this._stream.writeUint16(a),this._send_func(this._stream)},a.prototype.use_moneytree=function(){this._stream.reset(),this._stream.optcode=407,this._stream.writeUint16(407),this._send_func(this._stream)},a.prototype.get_moneytree_gift=function(a){this._stream.reset(),this._stream.optcode=408,this._stream.writeUint16(408),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.set_world_risk_last_id=function(a){this._stream.reset(),this._stream.optcode=409,this._stream.writeUint16(409),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.enter_private_boss=function(a){this._stream.reset(),this._stream.optcode=410,this._stream.writeUint16(410),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.raise_base_spell_all=function(a,b){this._stream.reset(),this._stream.optcode=411,this._stream.writeUint16(411),this._stream.writeUint8(a),this._stream.writeString(b),this._send_func(this._stream)},a.prototype.use_restore_potion=function(){this._stream.reset(),this._stream.optcode=413,this._stream.writeUint16(413),this._send_func(this._stream)},a.prototype.pick_quest_adventure=function(a){this._stream.reset(),this._stream.optcode=414,this._stream.writeUint16(414),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.raise_adventurespell=function(a){this._stream.reset(),this._stream.optcode=415,this._stream.writeUint16(415),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.pick_quest_realmbreak=function(a){this._stream.reset(),this._stream.optcode=416,this._stream.writeUint16(416),this._stream.writeUint32(a),this._send_func(this._stream)},a.prototype.pick_realmbreak_daily_reward=function(){this._stream.reset(),this._stream.optcode=417,this._stream.writeUint16(417),this._send_func(this._stream)},a.prototype.group_create=function(){this._stream.reset(),this._stream.optcode=418,this._stream.writeUint16(418),this._send_func(this._stream)},a.prototype.group_join_request=function(a){this._stream.reset(),this._stream.optcode=419,this._stream.writeUint16(419),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.group_join_accept=function(a){this._stream.reset(),this._stream.optcode=420,this._stream.writeUint16(420),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.group_quit=function(){this._stream.reset(),this._stream.optcode=421,this._stream.writeUint16(421),this._send_func(this._stream)},a.prototype.group_give_captain=function(a){this._stream.reset(),this._stream.optcode=422,this._stream.writeUint16(422),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.group_kick=function(a){this._stream.reset(),this._stream.optcode=423,this._stream.writeUint16(423),this._stream.writeString(a),this._send_func(this._stream)},a.prototype.enter_stage_instance=function(){this._stream.reset(),this._stream.optcode=425,this._stream.writeUint16(425),this._send_func(this._stream)},a.prototype.pick_stage_instance_bonus=function(a){this._stream.reset(),this._stream.optcode=426,this._stream.writeUint16(426),this._stream.writeUint32(a),this._send_func(this._stream)},a.MSG_NULL_ACTION=0,a.MSG_PING_PONG=1,a.CMSG_FORCED_INTO=2,a.CMSG_GET_SESSION=3,a.MSG_ROUTE_TRACE=4,a.CMSG_WRITE_CLIENT_LOG=5,a.SMSG_OPERATION_FAILED=6,a.MSG_SYNC_MSTIME=7,a.SMSG_UD_OBJECT=8,a.CMSG_UD_CONTROL=9,a.SMSG_UD_CONTROL_RESULT=10,a.SMSG_GRID_UD_OBJECT=11,a.SMSG_GRID_UD_OBJECT_2=12,a.SMSG_LOGIN_QUEUE_INDEX=13,a.SMSG_KICKING_TYPE=14,a.CMSG_GET_CHARS_LIST=15,a.SMSG_CHARS_LIST=16,a.CMSG_CHECK_NAME=17,a.SMSG_CHECK_NAME_RESULT=18,a.CMSG_CHAR_CREATE=19,a.SMSG_CHAR_CREATE_RESULT=20,a.CMSG_DELETE_CHAR=21,a.SMSG_DELETE_CHAR_RESULT=22,a.CMSG_PLAYER_LOGIN=23,a.CMSG_PLAYER_LOGOUT=24,a.CMSG_REGULARISE_ACCOUNT=25,a.CMSG_CHAR_REMOTESTORE=26,a.CMSG_CHAR_REMOTESTORE_STR=27,a.CMSG_TELEPORT=28,a.MSG_MOVE_STOP=29,a.MSG_UNIT_MOVE=30,a.CMSG_USE_GAMEOBJECT=31,a.CMSG_BAG_EXCHANGE_POS=32,a.CMSG_BAG_DESTROY=33,a.CMSG_BAG_ITEM_SPLIT=34,a.CMSG_BAG_ITEM_USER=35,a.SMSG_BAG_ITEM_COOLDOWN=36,a.SMSG_GRID_UNIT_MOVE=37,a.SMSG_GRID_UNIT_MOVE_2=38,a.CMSG_EXCHANGE_ITEM=39,a.CMSG_BAG_EXTENSION=40,a.CMSG_NPC_GET_GOODS_LIST=41,a.SMSG_NPC_GOODS_LIST=42,a.CMSG_STORE_BUY=43,a.CMSG_NPC_SELL=44,a.CMSG_NPC_REPURCHASE=45,a.CMSG_AVATAR_FASHION_ENABLE=46,a.CMSG_QUESTHELP_TALK_OPTION=47,a.CMSG_TAXI_HELLO=48,a.SMSG_TAXI_STATIONS_LIST=49,a.CMSG_TAXI_SELECT_STATION=50,a.CMSG_GOSSIP_SELECT_OPTION=51,a.CMSG_GOSSIP_HELLO=52,a.SMSG_GOSSIP_MESSAGE=53,a.CMSG_QUESTGIVER_STATUS_QUERY=54,a.SMSG_QUESTGIVER_STATUS=55,a.MSG_QUERY_QUEST_STATUS=56,a.CMSG_QUESTHELP_GET_CANACCEPT_LIST=57,a.SMSG_QUESTHELP_CANACCEPT_LIST=58,a.SMSG_QUESTUPDATE_FAILD=59,a.SMSG_QUESTUPDATE_COMPLETE=60,a.CMSG_QUESTLOG_REMOVE_QUEST=61,a.CMSG_QUESTGIVER_COMPLETE_QUEST=62,a.SMSG_QUESTHELP_NEXT=63,a.CMSG_QUESTHELP_COMPLETE=64,a.SMSG_QUESTUPDATE_ACCEPT=65,a.CMSG_QUESTHELP_UPDATE_STATUS=66,a.SMSG_QUESTGETTER_COMPLETE=67,a.CMSG_QUESTGIVER_ACCEPT_QUEST=68,a.CMSG_QUESTUPDATE_USE_ITEM=69,a.CMSG_QUESTHELP_QUERY_BOOK=70,a.SMSG_QUESTHELP_BOOK_QUEST=71,a.SMSG_USE_GAMEOBJECT_ACTION=72,a.CMSG_SET_ATTACK_MODE=73,a.MSG_SELECT_TARGET=74,a.SMSG_COMBAT_STATE_UPDATE=75,a.SMSG_EXP_UPDATE=76,a.MSG_SPELL_START=77,a.MSG_SPELL_STOP=78,a.MSG_JUMP=79,a.CMSG_RESURRECTION=80,a.MSG_TRADE_REQUEST=81,a.MSG_TRADE_REPLY=82,a.SMSG_TRADE_START=83,a.MSG_TRADE_DECIDE_ITEMS=84,a.SMSG_TRADE_FINISH=85,a.MSG_TRADE_CANCEL=86,a.MSG_TRADE_READY=87,a.SMSG_CHAT_UNIT_TALK=88,a.CMSG_CHAT_NEAR=89,a.CMSG_CHAT_WHISPER=90,a.MSG_CHAT_FACTION=91,a.MSG_CHAT_WORLD=92,a.MSG_CHAT_HORN=93,a.MSG_CHAT_NOTICE=94,a.CMSG_QUERY_PLAYER_INFO=95,a.SMSG_QUERY_RESULT_UPDATE_OBJECT=96,a.CMSG_RECEIVE_GIFT_PACKS=97,a.SMSG_MAP_UPDATE_OBJECT=98,a.SMSG_FIGHTING_INFO_UPDATE_OBJECT=99,a.SMSG_FIGHTING_INFO_UPDATE_OBJECT_2=100,a.CMSG_INSTANCE_ENTER=101,a.CMSG_INSTANCE_NEXT_STATE=102,a.CMSG_INSTANCE_EXIT=103,a.CMSG_LIMIT_ACTIVITY_RECEIVE=104,a.SMSG_KILL_MAN=105,a.SMSG_PLAYER_UPGRADE=106,a.CMSG_WAREHOUSE_SAVE_MONEY=107,a.CMSG_WAREHOUSE_TAKE_MONEY=108,a.CMSG_USE_GOLD_OPT=109,a.CMSG_USE_SILVER_OPT=110,a.SMSG_GM_RIGHTFLOAT=111,a.SMSG_DEL_GM_RIGHTFLOAT=112,a.MSG_SYNC_MSTIME_APP=113,a.CMSG_OPEN_WINDOW=114,a.CMSG_PLAYER_GAG=115,a.CMSG_PLAYER_KICKING=116,a.SMSG_MERGE_SERVER_MSG=117,a.CMSG_RANK_LIST_QUERY=118,a.SMSG_RANK_LIST_QUERY_RESULT=119,a.CMSG_CLIENT_UPDATE_SCENED=120,a.SMSG_NUM_LUA=121,a.CMSG_LOOT_SELECT=122,a.CMSG_GOBACK_TO_GAME_SERVER=123,
a.CMSG_WORLD_WAR_CS_PLAYER_INFO=124,a.SMSG_JOIN_OR_LEAVE_SERVER=125,a.MSG_WORLD_WAR_SC_PLAYER_INFO=126,a.MSG_CLIENTSUBSCRIPTION=127,a.SMSG_LUA_SCRIPT=128,a.CMSG_CHAR_UPDATE_INFO=129,a.SMSG_NOTICE_WATCHER_MAP_INFO=130,a.CMSG_MODIFY_WATCH=131,a.CMSG_KUAFU_CHUANSONG=132,a.CMSG_SHOW_SUIT=133,a.CMSG_SHOW_POSITION=134,a.CMSG_GOLD_RESPAWN=135,a.SMSG_FIELD_DEATH_COOLDOWN=136,a.CMSG_MALL_BUY=137,a.CMSG_STRENGTH=139,a.SMSG_STRENGTH_SUCCESS=140,a.CMSG_FORCEINTO=141,a.CMSG_CREATE_FACTION=142,a.CMSG_FACTION_UPGRADE=143,a.CMSG_FACTION_JOIN=144,a.CMSG_RAISE_BASE_SPELL=145,a.CMSG_UPGRADE_ANGER_SPELL=146,a.CMSG_RAISE_MOUNT=147,a.CMSG_UPGRADE_MOUNT=148,a.CMSG_UPGRADE_MOUNT_ONE_STEP=149,a.CMSG_ILLUSION_MOUNT_ACTIVE=150,a.CMSG_ILLUSION_MOUNT=151,a.CMSG_RIDE_MOUNT=152,a.SMSG_GRID_UNIT_JUMP=153,a.CMSG_GEM=154,a.CMSG_CHANGE_BATTLE_MODE=155,a.SMSG_PEACE_MODE_CD=156,a.CMSG_DIVINE_ACTIVE=157,a.CMSG_DIVINE_UPLEV=158,a.CMSG_DIVINE_SWITCH=159,a.CMSG_JUMP_START=160,a.CMSG_ENTER_VIP_INSTANCE=161,a.CMSG_SWEEP_VIP_INSTANCE=162,a.CMSG_HANG_UP=163,a.CMSG_HANG_UP_SETTING=164,a.CMSG_ENTER_TRIAL_INSTANCE=165,a.CMSG_SWEEP_TRIAL_INSTANCE=166,a.CMSG_RESET_TRIAL_INSTANCE=167,a.SMSG_SWEEP_INSTANCE_REWARD=168,a.CMSG_REENTER_INSTANCE=169,a.SMSG_MERRY_GO_ROUND=170,a.CMSG_SOCIAL_ADD_FRIEND=171,a.CMSG_SOCIAL_SUREADD_FRIEND=172,a.CMSG_SOCIAL_GIFT_FRIEND=173,a.CMSG_SOCIAL_RECOMMEND_FRIEND=174,a.SMSG_SOCIAL_GET_RECOMMEND_FRIEND=175,a.CMSG_SOCIAL_REVENGE_ENEMY=176,a.CMSG_SOCIAL_DEL_FRIEND=177,a.CMSG_TELEPORT_MAIN_CITY=178,a.CMSG_CHAT_BY_CHANNEL=179,a.SMSG_SEND_CHAT=180,a.CMSG_SOCIAL_CLEAR_APPLY=181,a.CMSG_MSG_DECLINE=182,a.SMSG_FACTION_GET_LIST_RESULT=183,a.CMSG_FACTION_GETLIST=184,a.CMSG_FACTION_MANAGER=185,a.CMSG_FACTION_MEMBER_OPERATE=186,a.CMSG_FACTION_FAST_JOIN=187,a.CMSG_SOCIAL_ADD_FRIEND_BYNAME=188,a.CMSG_READ_MAIL=190,a.CMSG_PICK_MAIL=191,a.CMSG_REMOVE_MAIL=192,a.CMSG_PICK_MAIL_ONE_STEP=193,a.CMSG_REMOVE_MAIL_ONE_STEP=194,a.CMSG_BLOCK_CHAT=195,a.CMSG_CANCEL_BLOCK_CHAT=196,a.CMSG_USE_BROADCAST_GAMEOBJECT=200,a.CMSG_WORLD_BOSS_ENROLL=201,a.CMSG_WORLD_BOSS_FIGHT=202,a.CMSG_CHANGE_LINE=203,a.CMSG_ROLL_WORLD_BOSS_TREASURE=204,a.SMSG_ROLL_RESULT=205,a.SMSG_BOSS_RANK=206,a.CMSG_RANK_ADD_LIKE=207,a.SMSG_RANK_ADD_LIKE_RESULT=208,a.CMSG_RES_INSTANCE_ENTER=210,a.CMSG_RES_INSTANCE_SWEEP=211,a.CMSG_SHOW_MAP_LINE=212,a.SMSG_SEND_MAP_LINE=213,a.SMSG_ITEM_NOTICE=214,a.CMSG_TELEPORT_MAP=216,a.CMSG_TELEPORT_FIELD_BOSS=217,a.CMSG_GET_ACTIVITY_REWARD=218,a.CMSG_GET_ACHIEVE_REWARD=220,a.CMSG_GET_ACHIEVE_ALL_REWARD=221,a.CMSG_SET_TITLE=222,a.CMSG_INIT_TITLE=223,a.CMSG_WELFARE_SHOUCHONG_REWARD=224,a.CMSG_WELFARE_CHECKIN=225,a.CMSG_WELFARE_CHECKIN_ALL=226,a.CMSG_WELFARE_CHECKIN_GETBACK=227,a.CMSG_WELFARE_LEVEL=228,a.CMSG_WELFARE_ACTIVE_GETBACK=229,a.CMSG_PICK_QUEST_REWARD=230,a.CMSG_TALK_WITH_NPC=231,a.CMSG_USE_VIRTUAL_ITEM=232,a.CMSG_PICK_QUEST_CHAPTER_REWARD=233,a.CMSG_KUAFU_3V3_MATCH=234,a.SMSG_KUAFU_MATCH_START=235,a.CMSG_KUAFU_3V3_BUYTIMES=236,a.CMSG_KUAFU_3V3_DAYREWARD=237,a.CMSG_KUAFU_3V3_GETRANLIST=238,a.SMSG_KUAFU_3V3_RANLIST=239,a.CMSG_WELFARE_GETALLLIST_GETBACK=240,a.SMSG_WELFARE_REWARDLIST_GETBACK=241,a.CMSG_WELFARE_GETALL_GETBACK=242,a.CMSG_KUAFU_3V3_GETMYRANK=248,a.SMSG_KUAFU_3V3_MYRANK=249,a.SMSG_KUAFU_3V3_KILL_DETAIL=250,a.SMSG_KUAFU_3V3_WAIT_INFO=251,a.MSG_KUAFU_3V3_CANCEL_MATCH=252,a.CMSG_KUAFU_3V3_MATCH_OPER=253,a.SMSG_KUAFU_3V3_DECLINE_MATCH=254,a.CMSG_KUAFU_XIANFU_MATCH=255,a.SMSG_KUAFU_MATCH_WAIT=256,a.SMSG_KUAFU_XIANFU_MINIMAP_INFO=257,a.CMSG_BUY_XIANFU_ITEM=258,a.CMSG_XIANFU_RANDOM_RESPAWN=259,a.CMSG_DOUJIANTAI_FIGHT=260,a.CMSG_DOUJIANTAI_BUYTIME=261,a.CMSG_DOUJIANTAI_CLEARCD=262,a.CMSG_DOUJIANTAI_FIRST_REWARD=263,a.MSG_DOUJIANTAI_GET_ENEMYS_INFO=265,a.CMSG_DOUJIANTAI_GET_RANK=266,a.CMSG_DOUJIANTAI_REFRESH_ENEMYS=270,a.MSG_DOUJIANTAI_TOP3=271,a.MSG_USE_JUMP_POINT=272,a.CMSG_BAG_ITEM_SELL=273,a.CMSG_BAG_ITEM_SORT=274,a.CMSG_SUBMIT_QUEST_DAILY2=280,a.SMSG_ATTRIBUTE_CHANGED=281,a.SMSG_BAG_FIND_EQUIP_BETTER=282,a.SMSG_MODULE_ACTIVE=283,a.CMSG_PICK_DAILY2_QUEST_REWARD=284,a.CMSG_FINISH_NOW_GUIDE=285,a.CMSG_GET_CULTIVATION_INFO=286,a.SMSG_UPDATE_CULTIVATION_INFO=287,a.CMSG_GET_CULTIVATION_RIVALS_INFO=288,a.SMSG_UPDATE_CULTIVATION_RIVALS_INFO_LIST=289,a.CMSG_GET_CULTIVATION_REWARD=290,a.CMSG_REFRESH_CULTIVATION_RIVALS=291,a.CMSG_PLUNDER_CULTIVATION_RIVAL=292,a.CMSG_REVENGE_CULTIVATION_RIVAL=293,a.CMSG_BUY_CULTIVATION_LEFT_PLUNDER_COUNT=294,a.SMSG_SHOW_CULTIVATION_RESULT_LIST=295,a.CMSG_GET_LOGIN_ACTIVITY_REWARD=296,a.SMSG_CAST_SPELL_START=300,a.CMSG_FINISH_OPTIONAL_GUIDE_STEP=301,a.CMSG_EXECUTE_QUEST_CMD_AFTER_ACCEPTED=302,a.SMSG_SHOW_UNIT_ATTRIBUTE=310,a.CMSG_BACK_TO_FAMITY=320,a.SMSG_FACTION_BOSS_SEND_RESULT=321,a.CMSG_CHALLANGE_BOSS=322,a.CMSG_PICK_OFFLINE_REWARD=325,a.SMSG_OFFLINE_REWARD_RESULT=326,a.CMSG_SMELTING_EQUIP=327,a.CMSG_STOREHOUSE_HAND_IN=328,a.CMSG_STOREHOUSE_EXCHANGE=329,a.CMSG_STOREHOUSE_DESTROY=330,a.CMSG_SEND_FACTION_GIFT=331,a.CMSG_GET_FACTION_GIFT_EXREWARD=332,a.CMSG_GET_ALL_FACTION_GIFT_EXREWARD=333,a.SMSG_SHOW_FACTION_GIFT_PAGE=334,a.SMSG_SHOW_FACTION_GIFT_INFO=335,a.SMSG_SHOW_FACTION_GIFT_UNTHANK_PAGE=336,a.SMSG_SHOW_FACTION_GIFT_HISTORY_PAGE=337,a.CMSG_GET_FACTION_GIFT_RANK_PAGE=338,a.SMSG_SHOW_FACTION_GIFT_RANK_RESULT_LIST=339,a.SMSG_SHOW_FACTION_GIFT_RANK_CHANGE=340,a.SMSG_SHOW_FACTION_GIFT_RANK_INFO=341,a.CMSG_DIVINE_FORGE=342,a.CMSG_DIVINE_ADVANCE=343,a.CMSG_DIVINE_SPIRIT=344,a.CMSG_QUERY_MASS_BOSS_INFO=352,a.SMSG_MASS_BOSS_INFO_RET=353,a.CMSG_QUERY_MASS_BOSS_RANK=354,a.SMSG_MASS_BOSS_RANK_RESULT=355,a.CMSG_TRY_MASS_BOSS=356,a.CMSG_BUY_MASS_BOSS_TIMES=357,a.CMSG_GROUP_INSTANCE_MATCH=358,a.CMSG_BUY_GROUP_INSTANCE_TIMES=359,a.CMSG_TALISMAN_ACTIVE=360,a.CMSG_TALISMAN_LVUP=361,a.CMSG_WINGS_ACTIVE=362,a.CMSG_WINGS_BLESS=363,a.CMSG_WINGS_RANKUP=364,a.CMSG_WINGS_STRENGTH=365,a.CMSG_MERIDIAN_PRACTISE=366,a.CMSG_ADD_MERIDIAN_EXP=367,a.CMSG_RAISE_MOUNT_LEVEL_BASE=368,a.CMSG_ACTIVE_MOUNT=369,a.SMSG_SHOW_FACTION_BOSSDEFENSE_DAMAGE_LIST=370,a.SMSG_SHOW_FACTION_TOWER_SWEEP_LIST=371,a.SMSG_SEND_INSTANCE_RESULT=375,a.CMSG_MATCH_SINGLE_PVP=376,a.CMSG_BUY_MATCH_SINGLE_PVP_TIMES=377,a.CMSG_PICK_MATCH_SINGLE_PVP_EXTRA_REWARD=378,a.CMSG_EQUIPDEVELOP_OPERATE=380,a.CMSG_ACTIVE_APPEARANCE=381,a.CMSG_EQUIP_APPEARANCE=382,a.CMSG_CANCEL_EQUIP_APPEARANCE=383,a.CMSG_RENAME=384,a.CMSG_UNLOCK_TITLE=385,a.CMSG_SOCIAL_BUY_REVENGE_TIMES=386,a.CMSG_ENTER_RISK_INSTANCE=387,a.CMSG_SOCIAL_REMOVE_ENEMY=388,a.CMSG_GET_PLAYER_OVERVIEW=389,a.SMSG_SHOW_PLAYER_OVERVIEW=390,a.CMSG_SEND_FACTION_INVITE=391,a.SMSG_SHOW_FACTION_INVITE=392,a.CMSG_BUY_VIPGIFT=393,a.CMSG_ACTIVITY_OPT_BUY_DAILYGIFT=394,a.CMSG_DRAW_LOTTERY=395,a.CMSG_ACTIVITY_OPT_GET_RANK_PROCESS_REWARD=396,a.CMSG_ACTIVITY_OPT_GET_RANK_LIST=397,a.SMSG_ACTIVITY_OPT_SHOW_RANK_LIST=398,a.CMSG_ACTIVITY_OPT_BUY_LIMITGIFT=399,a.CMSG_WELFARE_GET_RECHARGE_REWARD=400,a.CMSG_WELFARE_GET_CONSUME_REWARD=401,a.CMSG_WELFARE_GET_SEVENDAY_REWARD=402,a.SMSG_SEND_SERVER_OPEN_TIME=403,a.CMSG_RISK_GET_RANK=404,a.SMSG_RISK_GET_RANK_RESULT=405,a.CMSG_SET_ORIENT=406,a.CMSG_USE_MONEYTREE=407,a.CMSG_GET_MONEYTREE_GIFT=408,a.CMSG_SET_WORLD_RISK_LAST_ID=409,a.CMSG_ENTER_PRIVATE_BOSS=410,a.CMSG_RAISE_BASE_SPELL_ALL=411,a.CMSG_USE_RESTORE_POTION=413,a.CMSG_PICK_QUEST_ADVENTURE=414,a.CMSG_RAISE_ADVENTURESPELL=415,a.CMSG_PICK_QUEST_REALMBREAK=416,a.CMSG_PICK_REALMBREAK_DAILY_REWARD=417,a.CMSG_GROUP_CREATE=418,a.CMSG_GROUP_JOIN_REQUEST=419,a.CMSG_GROUP_JOIN_ACCEPT=420,a.CMSG_GROUP_QUIT=421,a.CMSG_GROUP_GIVE_CAPTAIN=422,a.CMSG_GROUP_KICK=423,a.SMSG_SHOW_LOOT_ANIMATE=424,a.CMSG_ENTER_STAGE_INSTANCE=425,a.CMSG_PICK_STAGE_INSTANCE_BONUS=426,a}(),point=function(){function a(){}return a.prototype.read=function(a){this.pos_x=a.readFloat(),this.pos_y=a.readFloat()},a.prototype.write=function(a){a.writeFloat(this.pos_x),a.writeFloat(this.pos_y)},a}(),taxi_menu_info=function(){function a(){this.taxi_text=""}return a.prototype.read=function(a){this.id=a.readInt32(),this.taxi_text=a.readStringByLen(50),this.map_id=a.readUint32(),this.pos_x=a.readUint16(),this.pos_y=a.readUint16()},a.prototype.write=function(a){a.writeInt32(this.id),a.writeStringByLen(this.taxi_text,50),a.writeUint32(this.map_id),a.writeUint16(this.pos_x),a.writeUint16(this.pos_y)},a}(),char_create_info=function(){function a(){this.name="",this.guid="",this.inviteGuid="",this.faction_name=""}return a.prototype.read=function(a){this.name=a.readStringByLen(50),this.faction=a.readUint8(),this.gender=a.readUint8(),this.level=a.readUint16(),this.guid=a.readStringByLen(50),this.head_id=a.readUint32(),this.hair_id=a.readUint32(),this.race=a.readUint8(),this.inviteGuid=a.readStringByLen(50),this.faction_name=a.readStringByLen(50),this.icon=a.readUint8()},a.prototype.write=function(a){a.writeStringByLen(this.name,50),a.writeUint8(this.faction),a.writeUint8(this.gender),a.writeUint16(this.level),a.writeStringByLen(this.guid,50),a.writeUint32(this.head_id),a.writeUint32(this.hair_id),a.writeUint8(this.race),a.writeStringByLen(this.inviteGuid,50),a.writeStringByLen(this.faction_name,50),a.writeUint8(this.icon)},a}(),quest_option=function(){function a(){this.quest_title=""}return a.prototype.read=function(a){this.quest_id=a.readUint32(),this.quest_icon=a.readUint32(),this.quest_level=a.readUint16(),this.quest_title=a.readStringByLen(50),this.flags=a.readUint32()},a.prototype.write=function(a){a.writeUint32(this.quest_id),a.writeUint32(this.quest_icon),a.writeUint16(this.quest_level),a.writeStringByLen(this.quest_title,50),a.writeUint32(this.flags)},a}(),quest_canaccept_info=function(){function a(){this.title=""}return a.prototype.read=function(a){this.quest_id=a.readUint32(),this.quest_type=a.readUint8(),this.title=a.readStringByLen(50),this.npc_id=a.readUint32(),this.quest_level=a.readUint32()},a.prototype.write=function(a){a.writeUint32(this.quest_id),a.writeUint8(this.quest_type),a.writeStringByLen(this.title,50),a.writeUint32(this.npc_id),a.writeUint32(this.quest_level)},a}(),gossip_menu_option_info=function(){function a(){this.option_title=""}return a.prototype.read=function(a){this.id=a.readInt32(),this.option_icon=a.readInt32(),this.option_title=a.readStringByLen(200)},a.prototype.write=function(a){a.writeInt32(this.id),a.writeInt32(this.option_icon),a.writeStringByLen(this.option_title,200)},a}(),item_cooldown_info=function(){function a(){}return a.prototype.read=function(a){this.item=a.readUint32(),this.cooldown=a.readUint32()},a.prototype.write=function(a){a.writeUint32(this.item),a.writeUint32(this.cooldown)},a}(),quest_status=function(){function a(){}return a.prototype.read=function(a){this.quest_id=a.readUint16(),this.status=a.readUint8()},a.prototype.write=function(a){a.writeUint16(this.quest_id),a.writeUint8(this.status)},a}(),item_reward_info=function(){function a(){}return a.prototype.read=function(a){this.item_id=a.readUint16(),this.num=a.readUint32()},a.prototype.write=function(a){a.writeUint16(this.item_id),a.writeUint32(this.num)},a}(),social_friend_info=function(){function a(){this.guid="",this.name="",this.faction=""}return a.prototype.read=function(a){this.guid=a.readStringByLen(50),this.name=a.readStringByLen(50),this.faction=a.readStringByLen(50),this.level=a.readUint16(),this.icon=a.readUint16(),this.vip=a.readUint16()},a.prototype.write=function(a){a.writeStringByLen(this.guid,50),a.writeStringByLen(this.name,50),a.writeStringByLen(this.faction,50),a.writeUint16(this.level),a.writeUint16(this.icon),a.writeUint16(this.vip)},a}(),faction_info=function(){function a(){this.faction_guid="",this.faction_name="",this.faction_bz="",this.faction_gg=""}return a.prototype.read=function(a){this.faction_guid=a.readStringByLen(50),this.faction_name=a.readStringByLen(50),this.faction_bz=a.readStringByLen(50),this.faction_gg=a.readStringByLen(108),this.level=a.readUint16(),this.icon=a.readUint8(),this.player_count=a.readUint16(),this.minlev=a.readUint16()},a.prototype.write=function(a){a.writeStringByLen(this.faction_guid,50),a.writeStringByLen(this.faction_name,50),a.writeStringByLen(this.faction_bz,50),a.writeStringByLen(this.faction_gg,108),a.writeUint16(this.level),a.writeUint8(this.icon),a.writeUint16(this.player_count),a.writeUint16(this.minlev)},a}(),rank_info=function(){function a(){this.name=""}return a.prototype.read=function(a){this.name=a.readStringByLen(50),this.value=a.readFloat()},a.prototype.write=function(a){a.writeStringByLen(this.name,50),a.writeFloat(this.value)},a}(),line_info=function(){function a(){}return a.prototype.read=function(a){this.lineNo=a.readUint16(),this.rate=a.readUint8()},a.prototype.write=function(a){a.writeUint16(this.lineNo),a.writeUint8(this.rate)},a}(),wait_info=function(){function a(){this.name=""}return a.prototype.read=function(a){this.name=a.readStringByLen(50),this.state=a.readInt8()},a.prototype.write=function(a){a.writeStringByLen(this.name,50),a.writeInt8(this.state)},a}(),cultivation_rivals_info=function(){function a(){this.name=""}return a.prototype.read=function(a){this.index=a.readUint32(),this.name=a.readStringByLen(50),this.level=a.readUint32(),this.weapon=a.readUint32(),this.avatar=a.readUint32(),this.divine=a.readUint32(),this.force=a.readUint32(),this.chest=a.readUint32(),this.gender=a.readUint32()},a.prototype.write=function(a){a.writeUint32(this.index),a.writeStringByLen(this.name,50),a.writeUint32(this.level),a.writeUint32(this.weapon),a.writeUint32(this.avatar),a.writeUint32(this.divine),a.writeUint32(this.force),a.writeUint32(this.chest),a.writeUint32(this.gender)},a}(),faction_gift_info=function(){function a(){this.guid="",this.msg="",this.item_list="",this.reply_list=""}return a.prototype.read=function(a){this.rank=a.readUint32(),this.id=a.readUint32(),this.point=a.readUint32(),this.thank=a.readUint32(),this.reply=a.readUint32(),this.time=a.readUint32(),this.count_id=a.readUint32(),this.guid=a.readStringByLen(50),this.msg=a.readStringByLen(50),this.item_list=a.readStringByLen(150),this.reply_list=a.readStringByLen(100)},a.prototype.write=function(a){a.writeUint32(this.rank),a.writeUint32(this.id),a.writeUint32(this.point),a.writeUint32(this.thank),a.writeUint32(this.reply),a.writeUint32(this.time),a.writeUint32(this.count_id),a.writeStringByLen(this.guid,50),a.writeStringByLen(this.msg,50),a.writeStringByLen(this.item_list,150),a.writeStringByLen(this.reply_list,100)},a}(),faction_gift_rank_info=function(){function a(){this.queen_name="",this.faction_name="",this.guard_name=""}return a.prototype.read=function(a){this.rank=a.readUint32(),this.point=a.readUint32(),this.queen_name=a.readStringByLen(50),this.faction_name=a.readStringByLen(50),this.guard_name=a.readStringByLen(50),this.faction_flag=a.readUint32(),this.queen_vip=a.readUint32(),this.guard_vip=a.readUint32()},a.prototype.write=function(a){a.writeUint32(this.rank),a.writeUint32(this.point),a.writeStringByLen(this.queen_name,50),a.writeStringByLen(this.faction_name,50),a.writeStringByLen(this.guard_name,50),a.writeUint32(this.faction_flag),a.writeUint32(this.queen_vip),a.writeUint32(this.guard_vip)},a}(),mass_boss_info=function(){function a(){}return a.prototype.read=function(a){this.id=a.readUint8(),this.state=a.readUint8(),this.time=a.readUint32(),this.percent=a.readUint8(),this.count=a.readUint16()},a.prototype.write=function(a){a.writeUint8(this.id),a.writeUint8(this.state),a.writeUint32(this.time),a.writeUint8(this.percent),a.writeUint16(this.count)},a}(),mass_boss_rank_info=function(){function a(){this.name=""}return a.prototype.read=function(a){this.name=a.readStringByLen(50),this.dam=a.readDouble()},a.prototype.write=function(a){a.writeStringByLen(this.name,50),a.writeDouble(this.dam)},a}(),equip_info=function(){function a(){this.equip=""}return a.prototype.read=function(a){this.equip=a.readStringByLen(50),this.strength_lv=a.readUint32(),this.refine_rank=a.readUint32(),this.refine_star=a.readUint32(),this.gem1_lv=a.readUint32(),this.gem2_lv=a.readUint32(),this.gem3_lv=a.readUint32()},a.prototype.write=function(a){a.writeStringByLen(this.equip,50),a.writeUint32(this.strength_lv),a.writeUint32(this.refine_rank),a.writeUint32(this.refine_star),a.writeUint32(this.gem1_lv),a.writeUint32(this.gem2_lv),a.writeUint32(this.gem3_lv)},a}(),act_rank_info=function(){function a(){this.name=""}return a.prototype.read=function(a){this.name=a.readStringByLen(50),this.value=a.readUint32()},a.prototype.write=function(a){a.writeStringByLen(this.name,50),a.writeUint32(this.value)},a}(),OprateResult=function(){function a(){}return a.OPRATE_TYPE_LOGIN=1,a.OPRATE_TYPE_KICKING=2,a.OPRATE_TYPE_JUMP=3,a.OPRATE_TYPE_ATTK_LOSE=4,a.OPRATE_TYPE_SPELL_LOSE=5,a.OPRATE_TYPE_INTERACTION=6,a.OPRATE_TYPE_USE_GAMEOBJECT=7,a.OPRATE_TYPE_BAG=8,a.OPRATE_TYPE_TRADE=9,a.OPRATE_TYPE_CHAT=10,a.OPERTE_TYPE_RECEIVE_GIFT_PACKS=11,a.OPERTE_TYPE_QUEST=12,a.OPERTE_TYPE_NPCBUY=13,a.OPERTE_TYPE_FUBEN=14,a.OPERTE_TYPE_KUAFU=15,a.OPERTE_TYPE_RANK_LIST=16,a.OPERTE_TYPE_CLOSE=17,a.OPERTE_TYPE_HOSTING=18,a.OPERTE_TYPE_STRENGTH=19,a.OPERTE_TYPE_CHANGE_BATTLE_MODE_LOSE=20,a.OPERTE_TYPE_SOCIAL=21,a.OPERTE_TYPE_FACTION=22,a.OPERTE_TYPE_FIELD_BOSS=23,a.OPERTE_TYPE_WORLD_BOSS=24,a.OPRATE_TYPE_MOUNT_QICHENG=25,a.OPRATE_TYPE_TELEPORT=26,a.OPRATE_TYPE_UPGRADE=27,a.OPRATE_TYPE_ACTIVITY=28,a.OPRATE_TYPE_ACHIEVE=29,a.OPRATE_TYPE_ATHLETICS=30,a.OPRATE_TYPE_XIANFU=31,a.OPRATE_TYPE_REWARD=32,a.OPRATE_TYPE_DOUJIAN=33,a.OPRATE_TYPE_GEM=34,a.OPRATE_TYPE_MONEYTREE=35,a.OPRATE_TYPE_NEED_NOTICE=36,a.OPRATE_RESULT_SUCCESS=1,a.OPRATE_RESULT_NAME_REPEAT=2,a.OPRATE_RESULT_NAME_ILLEGAL=3,a.OPRATE_RESULT_CHAR_CAP=4,a.OPRATE_RESULT_SCENED_CLOSE=5,a.OPRATE_RESULT_SCENED_ERROR=6,a.OPRATE_RESULT_LOGINED_IN=7,a.OPRATE_RESULT_OTHER_LOGINED=8,a.OPRATE_RESULT_GAME_VERSION_ERROR=9,a.OPRATE_RESULT_MAP_VERSION_ERROR=10,a.OPRATE_RESULT_DATA_VERSION_ERROR=11,a.OPRATE_RESULT_VERSION_FORMAT_ERROR=12,a.OPRATE_RESULT_APPD_ERROR=13,a.OPRATE_RESULT_LOCK_ACCOUNT=14,a.OPRATE_RESULT_LOCK_IP=15,a.OPRATE_RESULT_APPD_CLOSE=16,a.OPRATE_RESULT_NAME_TOO_LONG=17,a.OPRATE_RESULT_NAME_HAS_PINGBI=18,a.OPRATE_RESULT_LOGOUT_UNFINISHED=19,a.OPRATE_RESULT_PID_OR_SID_ERROR=20,a.OPRATE_RESULT_DB_RESULT_ERROR=21,a.OPRATE_RESULT_MERGE_SERVER=22,a.OPRATE_RESULT_PLAYER_ZIBAO=23,a.OPRATE_RESULT_GENDER_ILLEGAL=24,a.KICKING_TYPE_GM_LOCK_IP=0,a.KICKING_TYPE_GM_LOCK_ACCOUNT=1,a.KICKING_TYPE_GM_KICKING=2,a.KICKING_TYPE_KUANGCHANG_RELIVE=3,a.KICKING_TYPE_FUCK_PINGBI=4,a.KICKING_TYPE_QUEST_GET_ITEM=5,a.KICKING_TYPE_NOT_MONEY=6,a.JUMP_RESULT_NOMAL=1,a.JUMP_RESULT_DEAD=2,a.JUMP_RESULT_ENERGY=3,a.JUMP_RESULT_MAP_CANT_JUMP=4,a.JUMP_RESULT_CANT_JUMP=5,a.JUMP_RESULT_MAX_DISTANCE=6,a.JUMP_RESULT_WRONG_COORD=7,a.JUMP_RESULT_SPELL_CD=8,a.JUMP_RESULT_NOT_ACTIVE_SPELL=9,a.ATTACK_LOST_CANTATTACK=1,a.ATTACK_LOST_TARGET_DEAD=2,a.ATTACK_LOST_NEED_TARGET=3,a.ATTACK_LOST_OUT_OF_RANGE=4,a.ATTACK_LOST_WRONG_TARGET=5,a.ATTACK_LOST_MOVING=6,a.LOST_RESON_SPELL_DOENT_EXIST=1,a.LOST_RESON_NOT_HAVE_SPELL=2,a.LOST_RESON_NOT_ENOUGH_ANGER=3,a.LOST_RESON_SPELL_COOLDOWN=4,a.LOST_RESON_ALREADY_CAST=5,a.LOST_RESON_TARGET_DEAD=6,a.LOST_RESON_NEED_TARGET=7,a.LOST_RESON_JUMP_DENY=8,a.LOST_RESON_SCENE_DENY=9,a.LOST_RESON_CAN_NOT_CAST=10,a.LOST_RESON_HAS_CONFLICT_SPELL=11,a.LOST_RESON_NOTHAS_CHUZHAN=12,a.LOST_RESON_WRONG_FACTION=13,a.LOST_RESON_ACTIVE_SPELL_SUCCESS=14,a.LOST_RESON_IN_SAFE_ZONE=15,a.LOST_RESON_YXT_WRONG_FACTION=16,a.LOST_RESON_PVP_STATE=17,a.INTERACTION_TOO_FAR=1,a.INTERACTION_BOOK_DAILYNUM_FULL=2,a.INTERACTION_NO_ENOUGH_ENDURANCE=3,a.INTERACTION_JHM_ERROR=4,a.INTERACTION_WORSHIP=5,a.INTERACTION_JHM_HAVE=6,a.INTERACTION_JHM_IS_USED=7,a.INTERACTION_JHM_NOT_USE_RANGE=8,a.USE_GAMEOBJECT_SUCCEED=1,a.USE_GAMEOBJECT_FAIL=2,a.USE_GAMEOBJECT_QUEST=3,a.USE_GAMEOBJECT_TOO_FAST=4,a.BAG_RESULT_NULL=1,a.BAG_RESULT_ITEM_NOT_EXIST=2,a.BAG_RESULT_CHANGE_ERROR=3,a.BAG_RESULT_DESTROY_BIND=4,a.BAG_RESULT_ITEM_NOT_SELF=5,a.BAG_RESULT_REPAIR_FULL=6,a.BAG_RESULT_BAG_NOT_EXIST=7,a.BAG_RESULT_POS_NOT_EXIST=8,a.BAG_RESULT_DESTROY_TOOMUCH=9,a.BAG_RESULT_BAN_FOR_TRADE=10,a.BAG_RESULT_SPLIT_FAILURE=11,a.BAG_RESULT_LACK_USER=12,a.BAG_RESULT_BAG_FULL=13,a.BAG_RESULT_MAX_COUNT=14,a.BAG_RESULT_SELL_BIND=15,a.BAG_RESULT_REPAIR_OK=16,a.BAG_RESULT_REPAIR_MONEY_LACK=17,a.BAG_RESULT_EXTENSION_BAG=18,a.BAG_RESULT_EXTENSION_MAX_SIZE=19,a.BAG_RESULT_EXTENSION_MATERIAL_LACK=20,a.BAG_RESULT_EXTENSION_TRADE=21,a.BAG_RESULT_USE_ITEM_COUNT_MAX=22,a.BAG_RESULT_NOT_ITEM=23,a.BAG_RESULT_ITEM_USEING=24,a.BAG_RESULT_GET_ITEMS=25,a.BAG_RESULT_USE_ITEMS=26,a.BAG_RESULT_GET_ITEMS_ORANGE=27,a.BAG_RESULT_USE_ITEMS_GENERALS=28,a.BAG_RESULT_GET_ITEMS_CABX=29,a.BAG_RESULT_GET_ITEMS_CABX_BUFF=30,a.BAG_RESULT_ALREADY_KAIGUANG=31,a.BAG_RESULT_EXCHANGE_SUCCESS=32,a.BAG_RESULT_OPEN_ITEMS_SUCCESS=33,a.BAG_RESULT_OPEN_ITEMS_FAIL=34,a.BAG_RESULT_GET_ITEMS_GENERALS_EQUIP=35,a.BAG_RESULT_GET_SHOWHAND_JIEZHI=36,a.BAG_RESULT_USE_WUJIANG_EXP_CARD=37,a.BAG_RESULT_USE_ITEMS_SUCCESS=38,a.BAG_RESULT_BAG_FULL_SEND_MAIL=39,a.BAG_RESULT_BAG_FULL_AUTO_SELL=40,a.BAG_RESULT_BAG_XIULIAN_USE=41,a.BAG_RESULT_BAG_SORT_CD=42,a.TRADE_RESULT_TYPE_NOT_TARGET=1,a.TRADE_RESULT_TYPE_TRADEING=2,a.TRADE_RESULT_TYPE_NOT_TRADE=3,a.TRADE_RESULT_TYPE_BAG_SIZE=4,a.TRADE_RESULT_TYPE_UNRECOGNISED=5,a.TRADE_RESULT_TYPE_TARGET_CANCEL=6,a.TRADE_RESULT_TYPE_LACK_MONEY=7,a.TRADE_RESULT_TYPE_IS_BIND=8,a.CHAT_RESULT_NOT_PLAYER=1,a.CHAT_RESULT_IS_GAG=2,a.CHAT_LEVEL_WHISPER_LEVEL_NO=3,a.CHAT_LEVEL_WORLD_LEVEL_NO=4,a.CHAT_RESULT_CHECK_LIMIT=5,a.CHAT_RESULT_NO_FACTION=6,a.CHAT_RESULT_NO_GROUP=7,a.RECEIVE_GIFT_PACKS_NOT_FIND=1,a.RECEIVE_GIFT_PACKS_CHAR_ERROR=2,a.RECEIVE_GIFT_PACKS_CHAR_CREATE=3,a.RECEIVE_GIFT_PACKS_RECEIVED=4,a.RECEIVE_GIFT_PACKS_ONLINE_AWARD=5,a.RECEIVE_GIFT_PACKS_ONLINE_XIANSHI=6,a.INVALIDREASON_QUEST_FAILED_LOW_LEVEL=1,a.INVALIDREASON_QUEST_FAILED_WRONG_RACE=2,a.INVALIDREASON_QUEST_ALREADY_DONE=3,a.INVALIDREASON_QUEST_ONLY_ONE_TIMED=4,a.INVALIDREASON_QUEST_ALREADY_ON=5,a.INVALIDREASON_QUEST_FAILED_EXPANSION=6,a.INVALIDREASON_QUEST_ALREADY_ON2=7,a.INVALIDREASON_QUEST_FAILED_MISSING_ITEMS=8,a.INVALIDREASON_QUEST_FAILED_NOT_ENOUGH_MONEY=9,a.INVALIDREASON_DAILY_QUESTS_REMAINING=10,a.INVALIDREASON_QUEST_FAILED_CAIS=11,a.INVALIDREASON_DAILY_QUEST_COMPLETED_TODAY=12,a.INVALIDREASON_QUEST_FINISH_ALL_RIHUAN=13,a.QUEST_TYPE_PROCESS=14,a.NPC_BUY_ITEM_NO_EXIST=0,a.NPC_BUY_ITEM_UNDER=1,a.NPC_BUY_ITEM_NO_OPEN=2,a.NPC_BUY_ITEM_OUT_TIME=3,a.NPC_BUY_BAG_OUT_SIZE=4,a.NPC_BUY_MONEY_NO_ENOUGH=5,a.NPC_BUY_MONEY_TRANSFINITE=6,a.NPC_BUY_SELL_OUT=7,a.FUBEN_OPRATE_NO_GROUP_STATE=0,a.FUBEN_OPRATE_NOT_TWO_PEOPLE=1,a.FUBEN_OPRATE_NO_ENERGY=2,a.FUBEN_OPRATE_NO_MONEY=3,a.FUBEN_OPRATE_TEAM_NO_LEVEL=4,a.FUBEN_OPRATE_TEAM_NO_ENERGY=5,a.FUBEN_OPRATE_NO_GROUP=6,a.FUBEN_OPRATE_SEND_TEAM_FRIEND=7,a.FUBEN_OPRATE_TEAM_REFUSE_ENETR=8,a.FUBEN_OPRATE_TEAM_ON_FUBEN_MAP=9,a.FUBEN_OPRATE_TEAM_HAVE_FLAGS=10,a.FUBEN_OPRATE_REFRESH_BOSS=11,a.FUBEN_OPRATE_KILLED_BOSS=12,a.FUBEN_OPRATE_MORE_TIMES=13,a.FUBEN_OPRATE_NO_CREATURES=14,a.KUAFU_OPERATE_CONN_DISCONN=0,a.KUAFU_OPERATE_HASNOT_REGISTER=1,a.RANK_LIST_OPERATE_SUCCEED=0,a.RANK_LIST_OPERATE_TYPE_ERROR=1,a.RANK_LIST_OPERATE_OUT_OF_RANGE=2,a.RANK_LIST_OPERATE_MAX_LIKE=4,a.RANK_LIST_OPERATE_HAS_LIKE=5,a.ACTIVITY_OPERATE_NOTVIP=0,a.ACTIVITY_OPERATE_NOENOUGH=1,a.ACTIVITY_OPERATE_HASGET=2,a.ACHIEVE_OPERATE_NO_FIND=0,a.ACHIEVE_OPERATE_NO_GET=1,a.ACHIEVE_OPERATE_HASGET=2,a.ACHIEVE_OPERATE_NO_ALL=3,a.ACHIEVE_OPERATE_TITLE_SUC=4,a.ACHIEVE_OPERATE_TITLE_FAL=5,a.ACHIEVE_OPERATE_NO_MONEY=6,a.ATHLETICS_OPERATE_NO_LEV=1,a.ATHLETICS_OPERATE_NO_FORCE=2,a.ATHLETICS_OPERATE_NO_OPEN=3,a.ATHLETICS_OPERATE_NO_TIME_BUY=4,a.ATHLETICS_OPERATE_NO_TIME=5,a.ATHLETICS_OPERATE_IN_MATCH=6,a.ATHLETICS_OPERATE_MAX_BUY=7,a.ATHLETICS_OPERATE_NO_MONEY=8,a.ATHLETICS_OPERATE_HAS_DAY_REWARD=9,a.ATHLETICS_OPERATE_NO_DAY_REWARD=10,a.ATHLETICS_OPERATE_BUFF_OCCUR=11,a.DOUJIAN_OPERATE_NO_LEV=0,a.DOUJIAN_OPERATE_ZHUCHENG=1,a.DOUJIAN_OPERATE_NO_TIME=2,a.DOUJIAN_OPERATE_IN_CD=3,a.DOUJIAN_OPERATE_MAX_TIME=4,a.DOUJIAN_OPERATE_NO_MONEY=5,a.DOUJIAN_OPERATE_NO_MONEY_CD=6,a.DOUJIAN_OPERATE_SELF_BATTLE=7,a.DOUJIAN_OPERATE_OTHER_BATTLE=8,a.DOUJIAN_OPERATE_COUNTDOWN=9,a.DOUJIAN_OPERATE_REFRESH=10,a.PLAYER_CLOSE_OPERTE_APPD_ONE1=1e3,a.PLAYER_CLOSE_OPERTE_APPD_ONE2=1001,a.PLAYER_CLOSE_OPERTE_APPD_ONE3=1002,a.PLAYER_CLOSE_OPERTE_APPD_ONE4=1003,a.PLAYER_CLOSE_OPERTE_APPD_ONE5=1004,a.PLAYER_CLOSE_OPERTE_APPD_ONE6=1005,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE4=2001,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE5=2002,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE6=2003,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE7=6,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE8=2004,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE9=2005,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE10=2006,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE11=2007,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE12=2008,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE13=2009,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE14=2010,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE15=2011,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE16=2012,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE17=2013,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE18=2014,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE19=2015,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE20=2016,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE21=2017,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE22=2018,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE23=2019,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE24=2020,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE25=2021,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE26=2022,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE27=2023,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE28=2024,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE39=2025,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE40=2026,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE41=2027,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE42=2028,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE43=2029,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE44=2030,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE45=2031,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE46=2032,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE47=2033,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE48=2034,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE49=2035,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE50=2036,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE51=2037,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE52=2038,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE53=2039,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE54=2040,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE55=2041,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE56=2042,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE57=2045,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE58=2043,a.PLAYER_CLOSE_OPERTE_LOGDIN_ONE59=2044,a.PLAYER_CLOSE_OPERTE_LOGDIN_2046=2046,a.PLAYER_CLOSE_OPERTE_LOGDIN_2047=2047,a.PLAYER_CLOSE_OPERTE_LOGDIN_2048=2048,a.PLAYER_CLOSE_OPERTE_SCREND_ONE29=3001,a.PLAYER_CLOSE_OPERTE_SCREND_ONE30=3002,a.PLAYER_CLOSE_OPERTE_SCREND_ONE31=3003,a.PLAYER_CLOSE_OPERTE_SCREND_ONE32=3004,a.PLAYER_CLOSE_OPERTE_SCREND_ONE33=3005,a.PLAYER_CLOSE_OPERTE_SCREND_ONE34=3006,a.PLAYER_CLOSE_OPERTE_SCREND_ONE35=3007,a.PLAYER_CLOSE_OPERTE_SCREND_ONE36=3008,a.PLAYER_CLOSE_OPERTE_SCREND_ONE37=3009,a.PLAYER_CLOSE_OPERTE_SCREND_ONE38=3010,a.PLAYER_CLOSE_OPERTE_POLICED_4001=4001,a.OPERTE_TYPE_FACTION_IS_HAVE=0,a.OPERTE_TYPE_FACTION_NAME_ERR=1,a.OPERTE_TYPE_FACTION_NAME_HAVE_FUCK=2,a.OPERTE_TYPE_FACTION_NAME_REPEAT=3,a.OPERTE_TYPE_FACTION_CREATE_MAX=4,a.OPERTE_TYPE_FACTION_CREATE_COST=5,a.OPERTE_TYPE_FACTION_NOT_MANAGER=6,a.OPERTE_TYPE_FACTION_NOTICE_ERR=7,a.OPERTE_TYPE_FACTION_NOTICE_ERR_PB=8,a.OPERTE_TYPE_FACTION_LEV_LOW=9,a.OPERTE_TYPE_FACTION_MEMBER_MAX_COUNT=10,a.OPERTE_TYPE_FACTION_JOIN_SUCESS=11,a.OPERTE_TYPE_FACTION_FACTION_REFUSED_JOIN=12,a.OPERTE_TYPE_FACTION_KICKED=13,a.OPERTE_TYPE_FACTION_KICK_SUCCESS=14,a.OPERTE_TYPE_FACTION_MAX_ZHIWEI=15,a.OPERTE_TYPE_FACTION_APPOINT_SUCCESS=16,a.OPERTE_TYPE_FACTION_PROMOTED=17,a.OPERTE_TYPE_FACTION_APPOINT_NOSELF=18,a.OPERTE_TYPE_FACTION_DONATIONMAX=19,a.OPERTE_TYPE_FACTION_DONATION_GOLD=20,a.OPERTE_TYPE_FACTION_DONATION_YB=21,a.OPERTE_TYPE_FACTION_SHOP_NUMLOW=22,a.OPERTE_TYPE_FACTION_DEVOTE=23,a.OPEATE_TYPE_FACTION_MONEY_ERR=24,a.OPEATE_TYPE_FACTION_LEVEL_UP=25,a.OPEATE_TYPE_FACTION_NOT_JOIN=26,a.OPERTE_TYPE_FACTION_PLAYER_OFFLINE=40,a.OPERTE_TYPE_FACTION_BOSS_START=50,a.OPERTE_TYPE_FACTION_GIFT_THANK=59,a.OPERTE_TYPE_FACTION_GIFT_THANK_ALL=60,a.OPERTE_TYPE_FACTION_GIFT_GET_EXREWARD=61,a.OPERTE_TYPE_FACTION_GIFT_GET_EXREWARD_ALL=62,a.OPERTE_TYPE_FACTION_GIFT_SEND=63,a.OPERTE_TYPE_FACTION_GIFT_SEND_FAIL=64,a.OPERTE_TYPE_FACTION_GIFT_NOTICE=65,a.OPERTE_TYPE_FACTION_BOSSDEFENSE_TIME_ERROR=66,a.OPERTE_TYPE_FACTION_NAME_NOT_CHINESE=67,a.OPERTE_TYPE_SOCIAL_HAS_SEND=1,a.OPERTE_TYPE_SOCIAL_NOT_FIND=2,a.OPERTE_TYPE_SOCIAL_SELF_FULL=3,a.OPERTE_TYPE_SOCIAL_TARGET_FULL=4,a.OPERTE_TYPE_SOCIAL_ALREADY_FRIEND=5,a.OPERTE_TYPE_SOCIAL_ADD_MYSELF=6,a.OPERTE_TYPE_SOCIAL_HAS_SEND_ADD=7,a.OPERTE_TYPE_SOCIAL_NO_MONEY=8,a.OPERTE_TYPE_SOCIAL_NOT_ENEMY=9,a.OPERTE_TYPE_SOCIAL_ENEMY_OFFLINE=10,a.OPERTE_TYPE_SOCIAL_ENEMY_NOT_IN_FIELD=11,a.OPERTE_TYPE_SOCIAL_REVENGE_TIMES_NOT_ENOUGH=12,a.OPERTE_TYPE_SOCIAL_RENAME_SUCCESS=13,a.OPERTE_TYPE_SOCIAL_OTHNER_FACTION=14,a.OPERTE_TYPE_SOCIAL_SAME_FACTION=15,a.HOSTING_OPERTE_IS_SELF=0,a.HOSTING_OPERTE_LEVEL_NOT=1,a.HOSTING_OPERTE_IS_HOSTING=2,a.HOSTING_OPERTE_IS_HOSTING_APPLY=3,a.HOSTING_OPERTE_FRIEND_NOT=4,a.HOSTING_OPERTE_HAS_NOT_24H=5,a.HOSTING_OPERTE_FRIEND_OUTLINE=6,a.HOSTING_OPERTE_FRIEND_ERR=7,a.HOSTING_OPERTE_NOT_HOSTING=8,a.HOSTING_OPERTE_FRIEND_ONLINE=9,a.HOSTING_OPERTE_LOGIN_HOSTING=10,a.HOSTING_OPERTE_FRIEND_APPLY=11,a.HOSTING_OPERTE_LOGIN=12,a.HOSTING_OPERTE_SUCCESS=13,a.HOSTING_OPERTE_CANCEL=14,a.HOSTING_OPERTE_REFUSED=15,a.HOSTING_OPERTE_NOT_DUE_TO=16,a.HOSTING_OPERTE_FRIEND_HOSTING_LOGIN=17,a.HOSTING_OPERTE_FRIEND_NOT_HAS_YOU=18,a.STRENGTH_OPERTE_FAIL=0,a.BATTLE_MODE_OPERTE_PEACE_MODE_DENY=0,a.BATTLE_MODE_OPERTE_PEACE_MODE_IN_CD=1,a.FIELD_BOSS_OPERTE_WILL_START=1,a.FIELD_BOSS_OPERTE_WILL_OCCUR=2,a.FIELD_BOSS_OPERTE_OCCUR=3,a.FIELD_BOSS_OPERTE_BOSS_BORN=4,a.FIELD_BOSS_OPERTE_BOSS_KILL=5,a.FIELD_BOSS_OPERTE_PROTECT=6,a.FIELD_BOSS_OPERTE_PICKED=7,a.FIELD_BOSS_OPERTE_TOO_FAR=8,a.WORLD_BOSS_OPERTE_NOT_ENROLL=0,a.WORLD_BOSS_OPERTE_WILL_START=1,a.WORLD_BOSS_OPERTE_WILL_ROLL1=2,a.WORLD_BOSS_OPERTE_WILL_ROLL2=3,a.WORLD_BOSS_OPERTE_ENROLL=4,a.MOUNT_QICHENG_FIGHT=0,a.MOUNT_QICHENG_JUMP=1,a.TELEPORT_OPRATE_PVP_STATE=0,a.UPGRADE_OPRATE_SKILL_SUCCESS=0,a.UPGRADE_OPRATE_MOUNT_EXP=1,a.UPGRADE_OPRATE_MOUNT_STAR=2,a.UPGRADE_OPRATE_MOUNT=3,a.UPGRADE_OPRATE_ANGLE_SKILL=4,a.UPGRADE_OPRATE_BLESS_SUCCESS=5,a.UPGRADE_OPRATE_BLESS_EXP=6,a.UPGRADE_OPRATE_GEM_SUCCESS=7,a.UPGRADE_OPRATE_GEM_EXP=8,a.UPGRADE_OPRATE_TALISMAN_ACTIVE=9,a.UPGRADE_OPRATE_TALISMAN_LVUP=10,a.UPGRADE_OPRATE_WINGS_ACTIVE=11,a.UPGRADE_OPRATE_WINGS_BLESS=12,a.UPGRADE_OPRATE_WINGS_RANKUP=13,a.UPGRADE_OPRATE_WINGS_STRENGTH_SUCESS=14,a.UPGRADE_OPRATE_WINGS_STRENGTH_FAIL=15,a.UPGRADE_OPRATE_EQUIPDEVELOP_STRENGTH_SUCCESS=16,a.UPGRADE_OPRATE_EQUIPDEVELOP_REFINE_STAR_SUCCESS=17,a.UPGRADE_OPRATE_EQUIPDEVELOP_REFINE_STAR_FAIL=18,a.UPGRADE_OPRATE_EQUIPDEVELOP_REFINE_RANK_SUCCESS=19,a.UPGRADE_OPRATE_EQUIPDEVELOP_REFINE_RANK_FAIL=20,a.UPGRADE_OPRATE_EQUIPDEVELOP_GEM_ACTIVE_SUCCESS=21,a.UPGRADE_OPRATE_EQUIPDEVELOP_GEM_LVUP_SUCCESS=22,a.UPGRADE_OPRATE_EQUIPDEVELOP_WASHATTRS_WASH=23,a.UPGRADE_OPRATE_EQUIPDEVELOP_WASHATTRS_SAVE=24,a.UPGRADE_OPRATE_EQUIPDEVELOP_BONUS_STRENGTH=25,a.UPGRADE_OPRATE_EQUIPDEVELOP_BONUS_REFINE=26,a.UPGRADE_OPRATE_EQUIPDEVELOP_BONUS_GEM=27,a.UPGRADE_OPRATE_FACTIONSKILL_LVUP=28,a.UPGRADE_OPRATE_MOUNT_ILLUSION_ACTIVE=29,a.UPGRADE_OPRATE_CLOTH_ILLUSION_ACTIVE=30,a.UPGRADE_OPRATE_WEAPON_ILLUSION_ACTIVE=31,a.UPGRADE_OPRATE_TITLE_ACTIVE=32,a.UPGRADE_OPRATE_MOUNT_ILLUSION_SET=33,a.UPGRADE_OPRATE_MOUNT_ILLUSION_UNSET=34,a.UPGRADE_OPRATE_FASHION_ILLUSION_SET=35,a.UPGRADE_OPRATE_FASHION_ILLUSION_UNSET=36,a.UPGRADE_OPRATE_MOUNT_LEVEL_UP=37,a.UPGRADE_OPRATE_MERIDIAN_LEVEL_UP=38,a.UPGRADE_OPRATE_MERIDIAN_UPGRADE=39,a.UPGRADE_OPRATE_WINGS_BLESS_NUM=40,a.XIANFU_TYPE_BOSS_OCCUR=0,a.XIANFU_TYPE_BOSS_KILL=1,a.REWARD_TYPE_ACTIVITY=0,a.REWARD_TYPE_RECHARGE=1,a.REWARD_TYPE_GIFT_PACKS=2,a.REWARD_TYPE_QUEST=3,a.REWARD_TYPE_NEWPLAYER=4,a.REWARD_TYPE_OPEN_ITEM=5,a.REWARD_TYPE_LOOT=6,a.REWARD_TYPE_GM_COMMAND=7,a.REWARD_TYPE_ITEM_BLEND=8,a.REWARD_TYPE_SEVEN_DAY_GIFT=9,a.REWARD_TYPE_JHM_GIFT=10,a.REWARD_TYPE_OPEN_BOX=11,a.REWARD_TYPE_FUBEN_EWAIJINAGLI=12,a.REWARD_TYPE_CAPTURE_YAOHUN=13,a.REWARD_TYPE_FSZL_EWAIJINAGLI=14,a.REWARD_TYPE_PRESTIGE=15,a.REWARD_TYPE_TIANDILINGKUANG=16,a.REWARD_TYPE_PANTAOYUAN=17,a.REWARD_TYPE_WABAO=18,a.REWARD_TYPE_HONGYAN=19,a.REWARD_TYPE_FORGE_DECOMPOSE=20,a.REWARD_TYPE_WORLD_BOSS_ROLL=21,a.REWARD_TYPE_VIP_INSTANCE_REWARD=22,a.REWARD_TYPE_TRIAL_INSTANCE_REWARD=23,
a.REWARD_TYPE_ACHIEVE=24,a.REWARD_TYPE_SHOUCHONG=25,a.REWARD_TYPE_CHECKIN=26,a.REWARD_TYPE_GETBACK=27,a.REWARD_TYPE_TOTAL_CHECKIN=28,a.REWARD_TYPE_WELFARE_LEVEL=29,a.REWARD_TYPE_3V3_KUAFU=30,a.REWARD_TYPE_INSTANCE_SWEEP=31,a.REWARD_TYPE_XIANFU=32,a.GEM_TYPE_CRIT=0,a.MONEYTREE_TYPE_NORMAL=0,a.MONEYTREE_TYPE_CRIT=1,a.NEED_NOTICE_TYPE_WING_RANKUP=0,a.NEED_NOTICE_TYPE_WING_STRENGTH=1,a.NEED_NOTICE_TYPE_MOUNT_RANKUP=2,a.NEED_NOTICE_TYPE_TALISMAN_ACTIVE=3,a.NEED_NOTICE_TYPE_TALISMAN_LVUP=4,a.NEED_NOTICE_TYPE_TRIAL_WIN=5,a.NEED_NOTICE_TYPE_RISK_CHAPTER=6,a.NEED_NOTICE_TYPE_DOUJIANTAI_RANKUP=7,a.NEED_NOTICE_TYPE_PAIWEI_RANKUP=8,a.NEED_NOTICE_TYPE_ADVENTURE_ROB=9,a.NEED_NOTICE_TYPE_ADVENTURE_ROBED=10,a}(),SharedDef=function(){function a(){}return a.MAX_MONEY=2e15,a.MAX_MONEY_TRUE=4e15,a.MAX_BUFF_DURATION=65535,a.INIT_QUEST_ID=1,a.ZHUCHENG_DITU_ID=1,a.ZHUCHENG_FUHUO_X=141,a.ZHUCHENG_FUHUO_Y=163,a.BORN_MAP=1001,a.BORN_X=143,a.BORN_Y=113,a.BORN_OR=2,a.BORN_LV=1,a.VIP_MAX_LEVEL=10,a.MAX_RMB_PLAYER_LEVEL=6,a.WORLD_SERVER_TYPE_GAME=0,a.WORLD_SERVER_TYPE_PK=1,a.KUAFU_TYPE_NONE=0,a.KUAFU_TYPE_FENGLIUZHEN=1,a.KUAFU_TYPE_XIANFU=2,a.KUAFU_TYPE_PLUNDER=3,a.KUAFU_TYPE_GROUP_INSTANCE=4,a.MATCH_TYPE_LOCAL_SINGLE_PVP=5,a.MAX_KUAFU_TYPE=6,a.MERGE_TYPE_MERGE=0,a.MERGE_TYPE_GAME_TO_PK=1,a.MERGE_TYPE_PK_TO_GAME=2,a.CONTEXT_TYPE_YEYOU=0,a.CONTEXT_TYPE_PHONE=1,a.MAX_CONTEXT_TYPE=2,a.CHAR_GENDER_MALE=0,a.CHAR_GENDER_FEMALE=1,a.CHAR_GENDER_NONE=2,a.MAX_CHAR_GENDER=3,a.RACE_NONE=0,a.RACE_STRONG=1,a.RACE_HANDSOME=2,a.RACE_LAURIE=3,a.RACE_BEAUTY=4,a.HEAD_NONE=0,a.HEAD_STRONG=1,a.HEAD_HANDSOME=2,a.HEAD_LAURIE=3,a.HEAD_BEAUTY=4,a.HEAD_TOTAL=4,a.RESURRECTION_IN_SITU=0,a.RESURRECTION_SPAWNPOINT=1,a.RESURRPCTION_FREE=2,a.RESURRPCTION_MONEY=3,a.RESURRPCTION_TIME=4,a.RESURRPCTION_HUANHUNDAN=5,a.MAX_RESURRECTION_TYPE=6,a.GM_LEVEL_0=0,a.GM_LEVEL_1=1,a.GM_LEVEL_2=2,a.GM_LEVEL_3=3,a.GO_FLAG_DYNAMIC=0,a.GO_FLAG_TELE=1,a.GO_FLAG_QUEST=2,a.GO_FLAG_LOOT=3,a.GO_FLAG_GEAR=10,a.GO_FLAG_UNUSE=4,a.GO_FLAG_FOREVER=5,a.GO_FLAG_USEMODE=8,a.GO_FLAG_CARTON=9,a.GO_FLAG_REBORN=11,a.GO_FLAG_SCRIPT=12,a.GO_FLAG_GET_ITEM_NOTICE=13,a.WORLD_MAP_DEFAULT=0,a.TYPEID_OBJECT=0,a.TYPEID_UNIT=1,a.TYPEID_PLAYER=2,a.TYPEID_GAMEOBJECT=3,a.MAX_CLIENT_OBJECT_TYPES=4,a.ITEM_QUAL_WHITE=0,a.ITEM_QUAL_GREEN=1,a.ITEM_QUAL_BLUE=2,a.ITEM_QUAL_PURPLE=3,a.ITEM_QUAL_ORANGE=4,a.ITEM_QUAL_RED=5,a.MAX_QUAL=6,a.ATTACK_MODE_PEACE=0,a.ATTACK_MODE_TEAM=1,a.ATTACK_MODE_RED=2,a.ATTACK_MODE_ALL=3,a.ATTACK_MODE_FACTION=4,a.ATTACK_MODE_BANG=5,a.MAX_ATTACK_MODE=6,a.REACT_PASSIVE=0,a.REACT_DEFENSIVE=1,a.REACT_AGGRESSIVE=2,a.REACT_AGGRESSIVE_UNIT=3,a.REACT_AGGRESSIVE_PLAYER=4,a.MAX_REACT_STATES=5,a.MERGE_OPT_TYPE_INIT=0,a.MERGE_OPT_TYPE_SAVE_DB=1,a.MERGE_OPT_TYPE_TARGET_SERVER_OK=2,a.MERGE_OPT_TYPE_END=3,a.MERGE_OPT_TYPE_SAVE_ING=4,a.MERGE_SERVER_TYPE_ORIGINAL=1,a.MERGE_SERVER_TYPE_TARGAT=2,a.BACK_OPT_TYPE_INIT=0,a.BACK_OPT_TYPE_SUCCESS=1,a.ITEM_BIND_NONE=0,a.ITEM_BIND_USE=1,a.ITEM_BIND_GET=2,a.ITEM_GIFT_GET_NONE=0,a.ITEM_GIFT_GET_MUST=1,a.PLAYER_ONLINE_STATE_OUTLINE=0,a.PLAYER_ONLINE_STATE_ONLINE=1,a.DISAPPEAR_MOTION_TYPE=9999,a.IDLE_MOTION_TYPE=0,a.RANDOM_MOTION_TYPE=1,a.WAYPOINT_MOTION_TYPE=2,a.TARGET_MOTION_TYPE=3,a.HOME_MOTION_TYPE=4,a.CONFUSED_MOTION_TYPE=5,a.FLEEING_MOTION_TYPE=6,a.FOLLOW_MOTION_TYPE=7,a.FOLLOW_INLINE_MOTION_TYPE=8,a.WAYFINDING_MOTION_TYPE=9,a.WAYFINDING_ATTACK_MOTION_TYPE=10,a.MERCENARY_MOTION_TYPE=11,a.WAYFINDDST_MOTION_TYPE=12,a.DEADLINE_MOTION_TYPE=13,a.MAX_MOTION_TYPE=14,a.TARGET_TYPE_ONESELF=0,a.TARGET_TYPE_FRIENDLY=1,a.TARGET_TYPE_ENEMY=2,a.TARGET_TYPE_ALL=3,a.TARGET_TYPE_POINT=4,a.TARGET_TYPE_SELFPOINT=5,a.TARGET_TYPE_CREATURE=6,a.TARGET_TYPE_PLAYER=7,a.TRADE_STATE_TYPE_FREE=0,a.TRADE_STATE_TYPE_APPLY=1,a.TRADE_STATE_TYPE_EXECUTION=2,a.TRADE_STATE_TYPE_PUT_ITEM_END=3,a.TRADE_STATE_TYPE_WAIT_FINISH=4,a.TRADE_TYPE_TRADE=0,a.TRADE_TYPE_STALL=1,a.MOVE_ITEM_FAIL=0,a.MOVE_ITEM_SUC=1,a.MOVE_ITEM_HAVE_BIND=2,a.MOVE_ITEM_NOT_BIND=3,a.SUB_ITEM_FAIL=0,a.SUB_ITEM_HAVE_BIND=1,a.SUB_ITEM_NOT_BIND=2,a.SUB_ITEM_HAVE_FAILTIME=3,a.ITEM_SAVE_MODE_INSERT=0,a.ITEM_SAVE_MODE_UPDATE=1,a.GOLD_INGOT_RECHARGE_NORMAL=1,a.GOLD_INGOT_RECHARGE_HANDSEL=2,a.GOLD_INGOT_RECHARGE_SUB=3,a.GOLD_INGOT_RECHARGE_HAND=4,a.MAX_GOLD_INGOT_RECHARGE_TYPE=5,a.RECHARGE_STATUS_TYPE_START=0,a.RECHARGE_STATUS_TYPE_RUNMING=1,a.RECHARGE_STATUS_TYPE_END=2,a.KICKING_STATUS_START=0,a.KICKING_STATUS_END=1,a.LOCKING_STATUS_START=0,a.LOCKING_STATUS_RUNNING=1,a.LOCKING_STATUS_END=2,a.SYSTEM_NOTICE_STATUS_START=0,a.SYSTEM_NOTICE_STATUS_RUNNING=1,a.SYSTEM_NOTICE_STATUS_END=2,a.SYSTEM_NOTICE_STATUS_DELETE=3,a.SYSTEM_NOTICE_STATUS_GARBAGE=4,a.GIFT_PACKS_STATUS_START=0,a.GIFT_PACKS_STATUS_SENDING=1,a.GIFT_PACKS_STATUS_OK=2,a.GIFT_PACKS_STATUS_END=3,a.GIFT_PACKS_AUDIENCE_TYPE_ONE=1,a.GIFT_PACKS_AUDIENCE_TYPE_ALL=2,a.GIFT_PACKS_AUDIENCE_TYPE_ALL_ONLINE=3,a.GIFT_PACKS_OPER_TYPE_RECEIVE=0,a.GIFT_PACKS_OPER_TYPE_READ=1,a.GIFT_PACKS_OPER_TYPE_DELETE=2,a.GAG_STATUS_START=0,a.GAG_STATUS_OFFLINE=1,a.GAG_STATUS_END=1,a.GM_LEVEL_TABLE_START=0,a.GM_LEVEL_TABLE_END=1,a.NOTICE_TYPE_SCROLL=1,a.NOTICE_TYPE_PROMPT=2,a.NOTICE_TYPE_FIXED=3,a.MAX_NOTICE_TYPE=10,a.CHAT_TYPE_SYSTEM=0,a.CHAT_TYPE_WORLD=1,a.CHAT_TYPE_FACTION=2,a.CHAT_TYPE_CURRENT=3,a.CHAT_TYPE_HORM=4,a.CHAT_TYPE_GROUP=5,a.CHAT_TYPE_WHISPER=6,a.MAX_CHAT_TYPE=7,a.PLATFORM_GAME2="2",a.PLATFORM_QQ="360",a.PLATFORM_NULL="9999",a.POST_TYPE_NONE=0,a.POST_TYPE_CHAT=1,a.POST_TYPE_UPGRADE=2,a.MAX_POST_TYPE=3,a.LOG_FILE_TYPE_GAME_BUY=0,a.LOG_FILE_TYPE_GAME_SELL=1,a.LOG_FILE_TYPE_RECHARGE=2,a.LOG_FILE_TYPE_SHOP_BUY=3,a.LOG_FILE_TYPE_ITEM_USE=4,a.LOG_FILE_TYPE_DEAL=5,a.LOG_FILE_TYPE_YB_INCOME=6,a.LOG_FILE_TYPE_ITEM_INCOME=7,a.LOG_FILE_TYPE_YB_EXPEND=8,a.LOG_FILE_TYPE_LOGIN=9,a.LOG_FILE_TYPE_LOGOUT=10,a.LOG_FILE_TYPE_CREATE_ROLE=11,a.LOG_FILE_TYPE_DEATH=12,a.LOG_FILE_TYPE_ACCEPT_TASK=13,a.LOG_FILE_TYPE_TASK=14,a.LOG_FILE_TYPE_UPGRADE=15,a.LOG_FILE_TYPE_GOLD=16,a.LOG_FILE_TYPE_MAP=17,a.LOG_FILE_TYPE_LONGER=18,a.LOG_FILE_TYPE_MONSTER=19,a.LOG_FILE_TYPE_TRANSCRIPT=20,a.LOG_FILE_TYPE_ONLINE=21,a.LOG_FILE_TYPE_GAME_ENTER=22,a.LOG_FILE_TYPE_ITEM_LOG=23,a.LOG_FILE_TYPE_CHAT=24,a.LOG_FILE_TYPE_RELIVE=25,a.LOG_FILE_TYPE_BIND_GOLD=26,a.LOG_FILE_TYPE_NEW_CARD_RECEIVE=27,a.LOG_FILE_TYPE_STALL=28,a.LOG_FILE_TYPE_WANTED_PACKET=29,a.LOG_FILE_TYPE_ERROR_PACKET=30,a.LOG_FILE_TYPE_CHOOSE_FACTION=31,a.LOG_FILE_TYPE_ACTIVITY_INFO=32,a.LOG_FILE_TYPE_ABNORMAL_PACKETS=33,a.LOG_FILE_TYPE_CLIENT_INFO=34,a.LOG_FILE_TYPE_GIFTMONEY_BUY=35,a.LOG_FILE_TYPE_GIFTMONEY_INCOME=36,a.LOG_FILE_TYPE_ATTACK_PACKET=37,a.LOG_FILE_TYPE_FORMAT_LOG=38,a.LOG_FILE_TYPE_CLIENT_LOG=39,a.LOG_FILE_TYPE_FORGE_LOG=40,a.LOG_FILE_TYPE_OBJECT_LOSS=41,a.MAX_LOG_FILE_TYPE=42,a.SKILL_EFFECT_TYPE_NORMAL=0,a.SKILL_EFFECT_TYPE_HUIXUE1=1,a.SKILL_EFFECT_TYPE_ROAR=2,a.SKILL_EFFECT_TYPE_BLADE_STORM=3,a.SKILL_EFFECT_TYPE_HEAL=4,a.SKILL_EFFECT_TYPE_SNOW_STORM=5,a.SKILL_EFFECT_TYPE_LOADED=99,a.LOG_FILE_TENCENT_USER=0,a.LOG_FILE_TENCENT_PLAYER=1,a.LOG_FILE_TENCENT_RECHAGRE=2,a.LOG_FILE_TENCENT_UPGRADELOG=3,a.LOG_FILE_TENCENT_NEWTASK=4,a.LOG_FILE_TENCENT_LOGIN=5,a.LOG_FILE_TENCENT_OFFLINE=6,a.LOG_FILE_TENCENT_ONLINE=7,a.LOG_FILE_TENCENT_MONEYLOG=8,a.MAX_LOG_FILE_TENCENT_TYPE=9,a.DEAD_PLACE_TYPE_FIELD=1,a.DEAD_PLACE_TYPE_XIANFU=2,a.DEAD_PLACE_TYPE_GROUP_INSTANCE=3,a.ACCACK_PACKET_TYPE_UNPACK=0,a.ACCACK_PACKET_TYPE_DATA=1,a.ACCACK_PACKET_TYPE_ORDER=2,a.ACCACK_PACKET_TYPE_DISCARD=3,a.MAX_ACCACK_PACKET_TYPE=4,a.LOG_YB_INCOME_TYPE_ACTIVITY=0,a.LOG_YB_INCOME_TYPE_RECHARGE=1,a.LOG_YB_INCOME_TYPE_USE_ITEM=2,a.LOG_YB_INCOME_TYPE_GIFT_PACKS=3,a.LOG_ITEM_OPER_TYPE_ACTIVITY=0,a.LOG_ITEM_OPER_TYPE_RECHARGE=1,a.LOG_ITEM_OPER_TYPE_GIFT_PACKS=2,a.LOG_ITEM_OPER_TYPE_QUEST=3,a.LOG_ITEM_OPER_TYPE_NEWPLAYER=4,a.LOG_ITEM_OPER_TYPE_OPEN_ITEM=5,a.LOG_ITEM_OPER_TYPE_LOOT=6,a.LOG_ITEM_OPER_TYPE_GM_COMMAND=7,a.LOG_ITEM_OPER_TYPE_ITEM_BLEND=8,a.LOG_ITEM_OPER_TYPE_SEVEN_DAY_GIFT=9,a.LOG_ITEM_OPER_TYPE_JHM_GIFT=10,a.LOG_ITEM_OPER_TYPE_OPEN_BOX=11,a.LOG_ITEM_OPER_TYPE_FUBEN_EWAIJINAGLI=12,a.LOG_ITEM_OPER_TYPE_CAPTURE_YAOHUN=13,a.LOG_ITEM_OPER_TYPE_FSZL_EWAIJINAGLI=14,a.LOG_ITEM_OPER_TYPE_PRESTIGE=15,a.LOG_ITEM_OPER_TYPE_TIANDILINGKUANG=16,a.LOG_ITEM_OPER_TYPE_PANTAOYUAN=17,a.LOG_ITEM_OPER_TYPE_WABAO=18,a.LOG_ITEM_OPER_TYPE_HONGYAN=19,a.LOG_ITEM_OPER_TYPE_FORGE_DECOMPOSE=20,a.LOG_ITEM_OPER_TYPE_WORLD_BOSS_ROLL=21,a.LOG_ITEM_OPER_TYPE_VIP_INSTANCE_REWARD=22,a.LOG_ITEM_OPER_TYPE_TRIAL_INSTANCE_REWARD=23,a.LOG_ITEM_OPER_TYPE_ACHIEVE=24,a.LOG_ITEM_OPER_TYPE_SHOUCHONG=25,a.LOG_ITEM_OPER_TYPE_CHECKIN=26,a.LOG_ITEM_OPER_TYPE_GETBACK=27,a.LOG_ITEM_OPER_TYPE_TOTAL_CHECKIN=28,a.LOG_ITEM_OPER_TYPE_WELFARE_LEVEL=29,a.LOG_ITEM_OPER_TYPE_3V3_KUAFU=30,a.LOG_ITEM_OPER_TYPE_INSTANCE_SWEEP=31,a.LOG_ITEM_OPER_TYPE_XIANFU=32,a.LOG_ITEM_OPER_TYPE_DOUJIAN_FIRST_REWARD=33,a.LOG_ITEM_OPER_TYPE_DOUJIAN_COMBAT_REWARD=34,a.LOG_ITEM_OPER_TYPE_CULTIVATION_REWARD=35,a.LOG_ITEM_OPER_TYPE_CULTIVATION_PLUNDER_REWARD=36,a.LOG_ITEM_OPER_TYPE_LOGIN_ACTIVITY_REWARD=37,a.LOG_ITEM_OPER_TYPE_GROUP_INSTANCE=38,a.LOG_ITEM_OPER_TYPE_XIANFU_PRACTISE=40,a.LOG_ITEM_OPER_TYPE_FACTION_BOSS=41,a.LOG_ITEM_OPER_TYPE_OFFLINE=42,a.LOG_ITEM_OPER_TYPE_STOREHOUSE=43,a.LOG_ITEM_OPER_TYPE_MASS_BOSS=44,a.LOG_ITEM_OPER_TYPE_SHOP_BUY=45,a.LOG_ITEM_OPER_TYPE_FACTION_BOSSDEFENSE=46,a.LOG_ITEM_OPER_TYPE_FACTION_TOWER=47,a.LOG_ITEM_OPER_TYPE_SINGLE_PVP=48,a.LOG_ITEM_OPER_TYPE_ACT_LOTTERY=49,a.LOG_ITEM_OPER_TYPE_ACT_DAILYGIFT=50,a.LOG_ITEM_OPER_TYPE_ACT_RANK=51,a.LOG_ITEM_OPER_TYPE_ACT_LIMITGIFT=52,a.LOG_ITEM_OPER_TYPE_RECHARGE_REWARD=53,a.LOG_ITEM_OPER_TYPE_CONSUME_REWARD=54,a.LOG_ITEM_OPER_TYPE_PRIVATE_BOSS=55,a.LOG_ITEM_OPER_TYPE_ESCORT=56,a.LOG_ITEM_OPER_TYPE_ESCORT_ROB=57,a.LOG_ITEM_OPER_TYPE_REALMBREAK=58,a.LOG_ITEM_OPER_TYPE_NPC_BUY=102,a.LOG_ITEM_OPER_TYPE_BIND_SHOP_BUY=103,a.LOG_ITEM_OPER_TYPE_REPURCHASE=104,a.LOG_ITEM_OPER_TYPE_ACTI_BUY=105,a.LOG_ITEM_OPER_TYPE_XIANFU_BUY=106,a.LOG_ITEM_OPER_TYPE_NPC_SELL=200,a.LOG_ITEM_OPER_TYPE_DEL_FAILTIME=201,a.LOG_ITEM_OPER_TYPE_USE=202,a.LOG_ITEM_OPER_TYPE_DISPOSE=203,a.LOG_ITEM_OPER_TYPE_HEAL=204,a.LOG_ITEM_OPER_TYPE_TRADE_GET=301,a.LOG_ITEM_OPER_TYPE_TRADE_PAY=302,a.LOG_ITEM_OPER_TYPE_STALL_OPEN=303,a.LOG_ITEM_OPER_TYPE_STALL_CLOSE=304,a.LOG_ITEM_OPER_TYPE_STALL_BUY=305,a.LOG_ITEM_OPER_TYPE_LINGDI_XUANSHANG=306,a.LOG_ITEM_OPER_TYPE_LINGDI_MIJING=307,a.LOG_ITEM_OPER_TYPE_WUJIANG_ZHENGZHAN=308,a.LOG_ITEM_OPER_TYPE_KAOZHUANGYUAN=309,a.LOG_ITEM_OPER_TYPE_MONEYTREE_GIFT=310,a.HT_MONEY_CHANGE_TYPE_RECHARGE=1,a.HT_MONEY_CHANGE_TYPE_CONSUMPTION=2,a.HT_MONEY_CHANGE_TYPE_SUB=3,a.HT_MONEY_CHANGE_TYPE_REWARD=4,a.HT_MONEY_CHANGE_TYPE_REBATE=5,a.HT_MONEY_CHANGE_TYPE_TRADING=6,a.MONEY_CHANGE_TYPE_CHARGE=0,a.MONEY_CHANGE_TYPE_STORE_BUY=1,a.MONEY_CHANGE_TYPE_MALL_BUY=2,a.MONEY_CHANGE_TYPE_STALL_SALE=3,a.MONEY_CHANGE_TYPE_TRADE=4,a.MONEY_CHANGE_MAIL=5,a.MONEY_CHANGE_QUEST=6,a.MONEY_CHANGE_DEAD=7,a.MONEY_CHANGE_RIHUAN=8,a.MONEY_CHANGE_USE_ITEM=9,a.MONEY_CHANGE_GIFT_PACKS=10,a.MONEY_CHANGE_NPC_SELL=11,a.MONEY_CHANGE_ITEM_REPAIR=12,a.MONEY_CHANGE_ITEM_APPRAISAL=13,a.MONEY_CHANGE_NPC_REPURCHASE=14,a.MONEY_CHANGE_GM_COMMAND=15,a.MONEY_CHANGE_CREATE_FACTION=16,a.MONEY_CHANGE_WAREHOUSE_HANLD=17,a.MONEY_CHANGE_SELECT_LOOT=18,a.MONEY_CHANGE_ACTIVITY=19,a.MONEY_CHANGE_TYPE_CHARGE_2=20,a.MONEY_CHANGE_TYPE_CHARGE_3=21,a.MONEY_CHANGE_TYPE_CHARGE_4=22,a.MONEY_CHANGE_USE_LABA=23,a.MONEY_CHANGE_BAG_EXTENSION=24,a.MONEY_CHANGE_ITEM_BLEND=25,a.MONEY_CHANGE_SEVEN_DAY_GIFT=26,a.MONEY_CHANGE_CLEAR_PK_VALUE=27,a.MONEY_CHANGE_JHM_REWARD=28,a.MONEY_CHANGE_ONLINE_GIFT=29,a.MONEY_CHANGE_SPELL_UP=30,a.MONEY_CHANGE_USE_BOX=31,a.MONEY_CHANGE_BOX_OPEN=32,a.MONEY_CHANGE_BOX_RANDOM=33,a.MONEY_CHANGE_JINGJIE=34,a.MONEY_CHANGE_SHENBING_BUY=35,a.MONEY_CHANGE_ATUO_GOLD_RESPAWN=36,a.MONEY_CHANGE_FUBEN_KILLALL=37,a.MONEY_CHANGE_FUBEN_EWAI=38,a.MONEY_CHANGE_FUBEN_BUY=39,a.MONEY_CHANGE_FSZL_REWARD=40,a.MONEY_CHANGE_PRESTIGE=41,a.MONEY_CHANGE_PANTAO_CAIJI=42,a.MONEY_CHANGE_LINGKUANG_CAIJI=43,a.MONEY_CHANGE_QIYU_ZHUOYAO=44,a.MONEY_CHANGE_RESET_FORGE_ADD=45,a.MONEY_CHANGE_WABAO=46,a.MONEY_CHANGE_HONGYAN_BUY_HUOLI=47,a.MONEY_CHANGE_HONGYAN_SHIJIAN=48,a.MONEY_CHANGE_HONGYAN_BUY_FASHION=49,a.MONEY_CHANGE_FORGE_STRENG=50,a.MONEY_CHANGE_FORGE_GEM=51,a.MONEY_CHANGE_LINGDI_ZHAOMU=52,a.MONEY_CHANGE_LINGDI_XUANSHANG=53,a.MONEY_CHANGE_LINGDI_MIJING=54,a.MONEY_CHANGE_WUJIANG_REFRESH_PUB=55,a.MONEY_CHANGE_FENGLIUZHEN_PUB_AUCTION=56,a.MONEY_CHANGE_WUJIANG_QINGJIU=55,a.MONEY_CHANGE_LINGDI_ZHENGBING=56,a.MONEY_CHANGE_FENGLIUZHEN_ZHUANPAN_ENTER=57,a.MONEY_CHANGE_USE_SPELL=58,a.MONEY_CHANGE_UP_ASSISTSPELL=59,a.MONEY_CHANGE_LINGDI_BUY_BINGLI=60,a.MONEY_CHANGE_WUJIANG_ZHENGZHAN=61,a.MONEY_CHANGE_BUY_JUNLLING=62,a.MONEY_CHANGE_SELL_WUJIANG_EQUIP=63,a.MONEY_CHANGE_FENGLIUZHEN_KAOZHUANGYUAN=64,a.MONEY_CHANGE_ZHUBO_SEND_GIFTS=65,a.MONEY_CHANGE_ZHUBO_GRAB_SOFA=66,a.MONEY_CHANGE_RAISE_MOUNT=67,a.MONEY_CHANGE_ILLUSION=68,a.MONEY_CHANGE_BIND_INGOT_NOT_ENOUGH=69,a.MONEY_CHANGE_ACTIVE_SPELL=70,a.MONEY_CHANGE_BUY_VIP_INSTANCE=71,a.MONEY_CHANGE_BUY_HP_ITEM=72,a.MONEY_CHANGE_RESET_TRIAL=73,a.MONEY_CHANGE_SOCIAL_GIFT=74,a.MONEY_CHANGE_FACTION_DONATION=75,a.MONEY_CHANGE_FACTION_SHOP=76,a.MONEY_CHANGE_WORLD_BOSS_ROLL=77,a.MONEY_CHANGE_VIP_INSTANCE_REWARD=78,a.MONEY_CHANGE_TRIAL_INSTANCE_REWARD=79,a.MONEY_CHANGE_WELF_ACTIVE_GETBACK=80,a.MONEY_CHANGE_SHOUCHONG=81,a.MONEY_CHANGE_CHECKIN=82,a.MONEY_CHANGE_TOTAL_CHECKIN=83,a.MONEY_CHANGE_WELFARE_LEVEL=84,a.MONEY_CHANGE_ACHIEVE=85,a.MONEY_CHANGE_3V3KUAFU=86,a.MONEY_CHANGE_VIP_INSTANCE_SWEEP=87,a.MONEY_CHANGE_GIFT_PACKET=88,a.MONEY_CHANGE_KUAFU_WORLD_3V3=89,a.MONEY_CHANGE_KUAFU_WORLD_XIANFU=90,a.MONEY_CHANGE_BUY_XIANFU_TICKET=91,a.MONEY_CHANGE_DOUJIAN_BUY_TIMES=92,a.MONEY_CHANGE_DOUJIAN_CLEARCD=93,a.MONEY_CHANGE_DOUJIAN_FIRST_REWARD=94,a.MONEY_CHANGE_DOUJIAN_COMBATWIN_REWARD=95,a.MONEY_CHANGE_CULTIVATION_PURCHASE=96,a.MONEY_CHANGE_CULTIVATION_REWARD=97,a.MONEY_CHANGE_CULTIVATION_PLUNDER_REWARD=98,a.MONEY_CHANGE_LOGIN_ACTIVITY_REWARD=99,a.MONEY_CHANGE_FACTION_BOSS=100,a.MONEY_CHANGE_OFFLINE=101,a.MONEY_CHANGE_STOREHOUSE=102,a.MONEY_CHANGE_MASS_BOSS=103,a.MONEY_CHANGE_MASS_BOSS_BUY_TIMES=104,a.MONEY_CHANGE_GROUP_INSTANCE_BUY_TIMES=105,a.MONEY_CHANGE_KUAFU_GROUP_INSTANCE=106,a.MONEY_CHANGE_MERIDIAN=107,a.MONEY_CHANGE_FACTION_BOSSDEFENSE=108,a.MONEY_CHANGE_FACTION_TOWER=109,a.MONEY_CHANGE_SINGLE_PVP=110,a.MONEY_CHANGE_EQUIPDEVELOP=111,a.MONEY_CHANGE_APPEARANCE=112,a.MONEY_CHANGE_FACTIONSKILL=113,a.MONEY_CHANGE_UNLOCKTITLE=114,a.MONEY_CHANGE_RENAME=115,a.MONEY_CHANGE_RANK_LIKE=116,a.MONEY_CHANGE_ACT_LOTTERY=117,a.MONEY_CHANGE_ACT_DAILYGIFT=118,a.MONEY_CHANGE_ACT_RANK=119,a.MONEY_CHANGE_ACT_LIMITGIFT=120,a.MONEY_CHANGE_RECHARGE_REWARD=121,a.MONEY_CHANGE_CONSUME_REWARD=122,a.MONEY_CHANGE_MONEYTREE_USE=123,a.MONEY_CHANGE_PRIVATE_BOSS=124,a.MONEY_CHANGE_ADVANTURE_KILL_BY_PLAYER=125,a.MONEY_CHANGE_ESCORT=126,a.MONEY_CHANGE_ESCORT_ROB=127,a.MONEY_CHANGE_REALMBREAK=127,a.MAX_MONEY_CHANGE_TYPE=128,a.BAG_VIRTUAL_TYPE_STALL=-1,a.BAG_VIRTUAL_TYPE_UNKNOWN=-2,a.SPECIALL_BAG_TYPE_MAIL=-3,a.ITEM_TYPE_NONE=0,a.ITEM_TYPE_EQUIP=1,a.ITEM_TYPE_BOX=15,a.ITEM_TYPE_MATERIAL=3,a.ITEM_TYPE_MEDICINE=12,a.ITEM_TYPE_FASHION=5,a.ITEM_TYPE_BUFF=25,a.ITEM_TYPE_SHELI=6,a.ITEM_TYPE_PK_MEDICINE=7,a.ITEM_TYPE_PET_MEDICINE=8,a.ITEM_TYPE_NUMBER=9,a.ITEM_RECORD_BROADCAST=1,a.ITEM_RECORD_XIANFU=2,a.ITEM_RECORD_MAP=3,a.ITEM_FLAGS_QUEST=0,a.ITEM_FLAGS_RMB=1,a.ITEM_FLAGS_APPRAISAL=2,a.ITEM_FLAGS_BROKEN=3,a.ITEM_FLAGS_USABLE=4,a.ITEM_FLAGS_LOCKED=5,a.ITEM_FLAGS_REFUNDABLE=6,a.ITEM_FLAGS_UNIQUE_EQUIPPED=7,a.ITEM_FLAGS_SPECIALUSE=8,a.ITEM_FLAGS_BOP_TRADEABLE=9,a.ITEM_FLAGS_IS_BINDED=10,a.ITEM_FLAGS_IS_JIPIN=11,a.ITEM_USE_SELF=0,a.ITEM_USE_TARGET=1,a.ITEM_USE_NULL=2,a.ITEM_USE_RESULT_DISAPPEAR=0,a.ITEM_USE_RESULT_NOT_DISAPPEAR=1,a.ITEM_USE_RESULT_SUB_DURABLE=2,a.ITEM_USE_RESULT_UN_USE=3,a.LOG_ITEM_RETURN_TYPE_HAVE=0,a.LOG_ITEM_RETURN_TYPE_LOSE=1,a.LOG_ITEM_RETURN_TYPE_CLEAR=2,a.LOG_ITEM_RETURN_TYPE_GOLD=3,a.MOUNT_STATE_FREE=0,a.MOUNT_STATE_WAS_RIDING=1,a.QUEST_STATUS_NONE=0,a.QUEST_STATUS_COMPLETE=1,a.QUEST_STATUS_UNAVAILABLE=2,a.QUEST_STATUS_INCOMPLETE=3,a.QUEST_STATUS_AVAILABLE=4,a.QUEST_STATUS_FAILED=5,a.QUEST_STATUS_END=6,a.QUEST_STATUS_SHOW_INCOMPLETE=13,a.QUEST_STATUS_SHOW_END=16,a.MAX_QUEST_STATUS=17,a.BOOK_STATUS_NONE=0,a.BOOK_STATUS_COMPLETE=1,a.BOOK_STATUS_UNAVAILABLE=2,a.BOOK_STATUS_INCOMPLETE=3,a.BOOK_STATUS_AVAILABLE=4,a.BOOK_STATUS_FAILED=5,a.BOOK_STATUS_REWARDED=6,a.DIALOG_STATUS_NONE=0,a.DIALOG_STATUS_UNAVAILABLE=1,a.DIALOG_STATUS_CHAT=2,a.DIALOG_STATUS_INCOMPLETE=5,a.DIALOG_STATUS_REWARD_REP=6,a.DIALOG_STATUS_AVAILABLE_REP=7,a.DIALOG_STATUS_AVAILABLE=8,a.DIALOG_STATUS_REWARD2=9,a.DIALOG_STATUS_REWARD=10,a.MAX_DIALOG_STATUS=11,a.QUEST_FLAGS_COMMIT_NOT_NEED_NPC=256,a.QUEST_FLAGS_ACCEPT_NOT_NEED_NPC=512,a.QUEST_FLAGS_DAILY=1024,a.QUEST_FLAGS_AUTO_FAIL_OFF=1,a.QUEST_FLAGS_AUTO_COMPLETE=16,a.QUEST_FLAGS_AUTO_REWARDED=32,a.QUEST_FLAGS_AUTO_ACCEPT=64,a.QUEST_FLAGS_MANUAL=128,a.QUEST_FLAGS_CANREMOVE=4096,a.QUEST_FLAGS_FLAGS_REPEATABLE=65536,a.QUEST_FLAGS_FLAGS_EXPLORATION_OR_EVENT=131072,a.QUEST_FLAGS_FLAGS_DB_ALLOWED=65535,a.QUEST_FLAGS_FLAGS_DELIVER=262144,a.QUEST_FLAGS_FLAGS_SPEAKTO=524288,a.QUEST_FLAGS_FLAGS_KILL_OR_CAST=1048576,a.QUEST_FLAGS_FLAGS_TIMED=2097152,a.QUEST_FLAGS_FLAGS_BUY_ITEM=4194304,a.QUEST_FLAGS_FLAGS_OPT_SYS=8388608,a.QUEST_FLAGS_FLAGS_LEVEL_CREATURE=16777216,a.QUEST_FLAGS_FLAGS_LEVEL_PLAYER=33554432,a.QUEST_RELATION_TYPE_START=0,a.QUEST_RELATION_TYPE_END=1,a.QUEST_UNCHANGED=0,a.QUEST_CHANGED=1,a.QUEST_NEW=2,a.MAX_ACHIEVE_COUNT=100,a.ACHIEVE_FIELD_REWARD=0,a.ACHIEVE_FIELD_CURRENT=1,a.MAX_ACHIEVE_FIELD=2,a.MAX_QUEST_COUNT=50,a.MAX_DAILY2_QUEST_COUNT=10,a.MAX_ADVENTURE_QUEST_COUNT=20,a.MAX_REALMBREAK_QUEST_COUNT=50,a.MAX_QUEST_TARGET_COUNT=5,a.QUEST_TARGET_INFO_SHORT0=0,a.QUEST_TARGET_INFO_PROCESS=1,a.MAX_QUEST_TARGET_INFO_COUNT=2,a.QUEST_INFO_ID=0,a.QUEST_INFO_STEP_START=1,a.QUEST_INFO_STEP_END=11,a.MAX_QUEST_INFO_COUNT=11,a.MAX_TITLE_COUNT=100,a.TITLE_FIELD_INFO=0,a.TITLE_FIELD_TIME=1,a.MAX_TITLE_FIELD=2,a.WELFA_BACK_TYPE_COUNT=10,a.WELFA_BACK_ITEM=0,a.WELFA_BACK_ITEM_END=8,a.WELFA_BACK_ITEM_NUM=9,a.MAX_WELFA_BACK_ITEM=10,a.QUEST_ESCORT_STATE_NONE=0,a.QUEST_ESCORT_STATE_NORMAL=1,a.QUEST_ESCORT_STATE_ROB=2,a.QUEST_FIELD_ACHIEVE_START=0,a.QUEST_FIELD_ACHIEVE_END=200,a.QUEST_FIELD_ACHIEVE_ALL=200,a.QUEST_FIELD_ACHIEVE_REWARD=201,a.QUEST_FIELD_QUEST_START=202,a.QUEST_FIELD_QUEST_END=752,a.QUEST_FIELD_TITLE_START=752,a.QUEST_FIELD_TITLE_END=952,a.QUEST_FIELD_WELFARE_SHOUCHONG=952,a.QUEST_FIELD_WELFARE_CHECKIN=953,a.QUEST_FIELD_WELFARE_CHECKIN_ALL=954,a.QUEST_FIELD_WELFARE_LEVEL=955,a.QUEST_FIELD_WELFARE_BACK_START=956,a.QUEST_FIELD_WELFARE_BACK_END=1056,a.QUEST_FIELD_DAILY2_FINISHED=1056,a.QUEST_FIELD_DAILY2_SUBMIT=1057,a.QUEST_FIELD_DAILY2_QUEST_START=1058,a.QUEST_FIELD_DAILY2_QUEST_END=1168,a.QUEST_FIELD_WELFARE_RECHARGE_REWARD_FLAG=1168,a.QUEST_FIELD_WELFARE_CONSUME_REWARD_FLAG=1169,a.QUEST_FIELD_WELFARE_SEVEN_DAY_PROCESS=1170,a.QUEST_FIELD_WELFARE_SEVEN_DAY_FLAG=1171,a.QUEST_FIELD_COUNT_TYPE_START=1172,a.QUEST_FIELD_COUNT_TYPE_END=1177,a.QUEST_FIELD_ADVENTURE_QUEST_START=1178,a.QUEST_FIELD_ADVENTURE_QUEST_END=1398,a.QUEST_FIELD_ESCORT_QUEST_START=1399,a.QUEST_FIELD_ESCORT_QUEST_END=1410,a.QUEST_FIELD_ESCORT_QUEST_FINISH_TIME=1411,a.QUEST_FIELD_REALMBREAK_QUEST_START=1412,a.QUEST_FIELD_REALMBREAK_QUEST_END=1962,a.COMBAT_STATE_LEAVE=0,a.COMBAT_STATE_ENTER=1,a.UNIT_STAT_DIED=1,a.UNIT_STAT_MELEE_ATTACKING=2,a.UNIT_STAT_CAST_SPELL=4,a.UNIT_STAT_SPELL_PROCESS=8,a.UNIT_STAT_ROAMING=16,a.UNIT_STAT_CHASE=32,a.UNIT_STAT_SEARCHING=64,a.UNIT_STAT_FLEEING=128,a.UNIT_STAT_IN_FLIGHT=256,a.UNIT_STAT_FOLLOW=512,a.UNIT_STAT_ROOT=1024,a.UNIT_STAT_CONFUSED=2048,a.UNIT_STAT_DISTRACTED=4096,a.UNIT_STAT_ISOLATED=8192,a.UNIT_STAT_ATTACK_PLAYER=16384,a.UNIT_STAT_ALL_STATE=65535,a.DEATH_STATE_ALIVE=0,a.DEATH_STATE_CORPSE=1,a.DEATH_STATE_DEAD=2,a.HITINFO_NORMALSWING=1,a.HITINFO_CRITHIT=2,a.HITINFO_MISS=3,a.HITINFO_GEDANG=4,a.HITINFO_CRITICALHIT=5,a.HITINFO_BLOWFLY=6,a.HITINFO_LIUXUE=7,a.HITINFO_CURE=8,a.HITINFO_JUMP_EVA=9,a.HITINFO_POISON=10,a.HITINFO_ICE=11,a.HITINFO_FANTANSHANGHAI=12,a.MOVE_STATUS_STOP=0,a.MOVE_STATUS_RUN=1,a.UNIT_NPC_FLAG_NONE=-1,a.UNIT_NPC_FLAG_GOSSIP=0,a.UNIT_NPC_FLAG_QUESTGIVER=1,a.UNIT_NPC_FLAG_UNK1=2,a.UNIT_NPC_FLAG_UNK2=3,a.UNIT_NPC_FLAG_TRAINER=4,a.UNIT_NPC_FLAG_TRAINER_CLASS=5,a.UNIT_NPC_FLAG_TRAINER_PROFESSION=6,a.UNIT_NPC_FLAG_VENDOR=7,a.UNIT_NPC_FLAG_VENDOR_PROP=8,a.UNIT_NPC_FLAG_VENDOR_WEAPON=9,a.UNIT_NPC_FLAG_VENDOR_POISON=10,a.UNIT_NPC_FLAG_VENDOR_REAGENT=11,a.UNIT_NPC_FLAG_VENDOR_EQUIPMENT=12,a.UNIT_NPC_FLAG_FLIGHTMASTER=13,a.UNIT_NPC_FLAG_SPIRITHEALER=14,a.UNIT_NPC_FLAG_SPIRITGUIDE=15,a.UNIT_NPC_FLAG_INNKEEPER=16,a.UNIT_NPC_FLAG_WAREHOUSE=17,a.UNIT_NPC_FLAG_PETITIONER=18,a.UNIT_NPC_FLAG_TABARDDESIGNER=19,a.UNIT_NPC_FLAG_BATTLEMASTER=20,a.UNIT_NPC_FLAG_AUCTIONEER=21,a.UNIT_NPC_FLAG_STABLEMASTER=22,a.UNIT_NPC_FLAG_GUILD_BANKER=23,a.UNIT_NPC_FLAG_CHALLENGE=24,a.UNIT_NPC_FLAG_ONE_ONE=25,a.BUFF_ONEPOINTFIVE_JINGYAN=101,a.BUFF_TOW_JINGYAN=102,a.BUFF_THREE_JINGYAN=103,a.BUFF_FIVE_JINGYAN=104,a.BUFF_FANTAN=105,a.BUFF_LIANJIE=106,a.BUFF_BEILIANJIE=107,a.BUFF_GANGCI=108,a.BUFF_DINGSHEN=109,a.BUFF_YUNXUAN=110,a.BUFF_YUNMIE_ELING=111,a.BUFF_HUIFU_HUDUN=112,a.BUFF_FANJI_HUDUN=113,a.BUFF_LINGXUE=114,a.BUFF_ZHUOSHAO=115,a.BUFF_JUDU=116,a.BUFF_ZHONGDU=117,a.BUFF_BINGJIA=118,a.BUFF_BINGDONG=119,a.BUFF_BAOZHA_DILEI=120,a.BUFF_SHOUWEI_ZHAOHUAN=121,a.BUFF_BIAOJI=122,a.BUFF_KUANGBAO=123,a.BUFF_JIANSU=124,a.BUFF_CHENMO=125,a.BUFF_XUECHI=126,a.BUFF_WAIGONGMIANYI=127,a.BUFF_NEIGONGMIAN=128,a.BUFF_WUDI=129,a.BUFF_ZHANSHEN_FUTI=130,a.BUFF_JINGANG_BUHUAITI=131,a.BUFF_KUANGBEN=132,a.BUFF_HUOBA=133,a.BUFF_LINGTI=134,a.BUFF_HUANHUA_ZHU=135,a.BUFF_HUANHUA_REN=136,a.BUFF_HUANHUA_GUI=137,a.BUFF_HUANHUA_XIAN=138,a.BUFF_HUANHUA_XIULUO=139,a.BUFF_XIULUOLI=140,a.BUFF_ZHENYING=141,a.BUFF_ZHANDOU_STATE=142,a.BUFF_JUMP_DOWN=144,a.BUFF_ANXIANG_SHUYING=145,a.BUFF_ZHIKONG=146,a.BUFF_FUKONG=147,a.BUFF_JUMP_JUMP=143,a.BUFF_NEW_PLAYER_PROTECTED=148,a.BUFF_DEATH_PROTECTED=149,a.BUFF_INVINCIBLE=150,a.BUFF_INVISIBLE=151,a.BUFF_YINCHANG=152,a.BUFF_ROAR=153,a.BUFF_HEAL=200,a.BUFF_ATTACK=201,a.BUFF_ARMOR=202,a.BUFF_CRIT=203,a.BUFF_ALLATTR=204,a.BUFF_DEFAULT_EFFECT_ID_JUMP_JUMP=1,a.BUFF_DEFAULT_EFFECT_ID_NEW_PLAYER_PROTECTED=2,a.BUFF_DEFAULT_EFFECT_ID_DEATH_PROTECTED=3,a.MAX_2JI_SHIJIAN_UINT32=20,a.MAX_HONGYAN_DATI_COUNT=10,a.HONGYAN_JIESHI_MEIREN=0,a.HONGYAN_DIANZAN=1,a.HONGYAN_PINGJIA=2,a.HONGYAN_SHIZHUANG_JIHUO=3,a.HONGYAN_SHIZHUANG_CHUANDAI=4,a.HONGYAN_XIANGCE_JIHUO=5,a.HONGYAN_SHIJIAN_CHULI=6,a.HONGYAN_CHUYOU=7,a.HONGYAN_HUIFU_HUOLI=8,a.HONGYAN_ADD_NEIWU_SHIJIAN=9,a.HONGYAN_PLAYER_ATTRS_XIAYI=0,a.HONGYAN_PLAYER_ATTRS_FENGLIU=1,a.HONGYAN_PLAYER_ATTRS_MINGSHENG=2,a.HONGYAN_PLAYER_ATTRS_WENTAO=3,a.HONGYAN_PLAYER_ATTRS_WULUE=4,a.HONGYAN_PLAYER_ATTRS_CAIYI=5,a.HONGYAN_PLAYER_ATTRS_QINHE=6,a.HONGYAN_PLAYER_ATTRS_LIYI=7,a.HONGYAN_PLAYER_ATTRS_XIANGMAO=8,a.HONGYAN_PLAYER_ATTRS_HUOLI=9,a.MAX_PLAYER_ATTRS=10,a.HONGYAN_MEIREN_ATTRS_JIESHI_BIT=0,a.HONGYAN_MEIREN_ATTRS_XINGGE_BIT=1,a.HONGYAN_MEIREN_ATTRS_AIHAO_BIT=2,a.HONGYAN_MEIREN_ATTRS_CHANGJING_BIT=3,a.HONGYAN_MEIREN_ATTRS_SHIZHUANG_BIT=4,a.HONGYAN_MEIREN_QINMIDU_UINT16=5,a.HONGYAN_MEIREN_XIANGCE_BIT=6,a.MAX_MEIREN_ATTRS_TYPE=7,a.HONGYAN_MEIREN_DIANZAN=0,a.HONGYAN_MEIREN_MEIHAO=1,a.HONGYAN_MEIREN_JIESHI_COUNT=2,a.MAX_MEIREN_RENQI_TYPE=3,a.HONGYAN_CAIXUE=0,a.HONGYAN_ZHENFEI=1,a.HONGYAN_YANLIN=2,a.HONGYAN_MURONGYANYAN=3,a.HONGYAN_YAORU=4,a.HONGYAN_XIANGJING=5,a.HONGYAN_HENGXIAOZHUO=6,a.HONGYAN_LIJI=7,a.HONGYAN_SIQI=8,a.HONGYAN_YOUYOU=9,a.HONGYAN_LINCHUER=10,a.HONGYAN_WANYAN_YUNNA=11,a.HONGYAN_QUANHUIQIAO=12,a.HONGYAN_TUOBALVZHU=13,a.HONGYAN_QINGYAN=14,a.HONGYAN_SUOMOER=15,a.HONGYAN_GUQIANQIAN=16,a.HONGYAN_AYIGULI=17,a.HONGYAN_ZUOYUYI=18,a.HONGYAN_ZILUO=19,a.HONGYAN_QUNUO=20,a.HONGYAN_XUANYING=21,a.MAX_MEIREN=32,a.GM_COMMAND_NULL=0,a.GM_COMMAND_JIULONGCHAO=1,a.GM_COMMAND_SUCAI=2,a.GM_COMMAND_JIAOBEN=3,a.GM_COMMAND_TI=4,a.GM_COMMAND_ZAIXIAN=5,a.GM_COMMAND_DITURENSHU=6,a.GM_COMMAND_ZHAOCAI=7,a.GM_COMMAND_ZHIZAO=8,a.GM_COMMAND_QINGLI=9,a.GM_COMMAND_ZHUANGBEI=10,a.GM_COMMAND_PAIHANGBANG=12,a.GM_COMMAND_YOUJIAN=13,a.GM_COMMAND_BENGDIAO=15,a.GM_COMMAND_BANGZHU=16,a.GM_COMMAND_GONGGAO=17,a.GM_COMMAND_SHIJIETISHI=18,a.GM_COMMAND_PAIDUI=19,a.GM_COMMAND_PINGBICI=20,a.GM_COMMAND_GUANBIFUWUQI=21,a.GM_COMMAND_CHONGZHI=22,a.GM_COMMAND_GUANBIDITU=23,a.GM_COMMAND_DENGJI=24,a.GM_COMMAND_QINGLIRENWUWUPIN=25,a.GM_COMMAND_QINGLIRENWU=26,a.GM_COMMAND_WANCHENGRENWU=27,a.GM_COMMAND_JIESHOURENWU=28,a.GM_COMMAND_GANDIAO=29,a.GM_COMMAND_SHUAGUAI=30,a.GM_COMMAND_CHUANSONG=31,a.GM_COMMAND_XIAZOU=32,a.GM_COMMAND_SUICIDE=33,a.GM_COMMAND_SERVER_INFO=34,a.GM_COMMAND_DB=35,a.GM_COMMAND_KAIFUSHIJIAN=36,a.GM_COMMAND_TEST_SHUJU=37,a.GM_COMMAND_UPDATE_SERVER=38,a.GM_COMMAND_RESESSION_OPTS=39,a.GM_COMMAND_RENWUTIAOZHUAN=40,a.GM_COMMAND_BACKUP_DATA=41,a.GM_COMMAND_RETURN_DATA=42,a.GM_COMMAND_PRINT_OBJECT=43,a.GM_COMMAND_TEST_HEFU=44,a.GM_COMMAND_CLEAR_PAIHANGBANG=45,a.GM_COMMAND_MEMORY_RECOVERY=46,a.GM_COMMAND_PRINT_MAP=47,a.GM_COMMAND_DEL_MAP_INFO=48,a.GM_COMMAND_RESTORE_SYSTEM=49,a.GM_COMMAND_CALL_REMOVE_ITEM=50,a.GM_COMMAND_SUBLINE=51,a.GM_COMMAND_CUSTOM=52,a.GM_COMMAND_VIP=53,a.GM_COMMAND_SELF_KILL=54,a.QUERY_PLAYER_FLAG_BASE=0,a.QUERY_PLAYER_FLAG_NAME=1,a.QUERY_PLAYER_FLAG_EQUIP=2,a.QUERY_PLAYER_FLAG_PIFENG=3,a.QUERY_PLAYER_FLAG_FORCE=4,a.QUERY_PLAYER_FLAG_OTHER=5,a.QUERY_PLAYER_FLAG_MOUNT=20,a.QUERY_PLAYER_FLAG_EQUIP_BAG=21,a.QUERY_PLAYER_FLAG_MAIN_BAG=22,a.QUERY_PLAYER_FLAG_STORAGE_BAG=23,a.QUERY_PLAYER_FLAG_STALL_BAG=24,a.QUEST_TYPE_MAIN=0,a.QUEST_TYPE_EXTENSIONS=1,a.QUEST_TYPE_ACTIVITY=2,a.QUEST_TYPE_QIYU=3,a.QUEST_TYPE_DAILY=4,a.QUEST_TYPE_DAILY2=5,a.QUEST_TYPE_ADVENTURE=6,a.QUEST_TYPE_ESCORT=7,a.QUEST_TYPE_REALMBREAK=8,a.QUEST_TARGET_TYPE_PLAYER_LEVEL=1,a.QUEST_TARGET_TYPE_PLAYER_FORCE=2,a.QUEST_TARGET_TYPE_FACTION=3,a.QUEST_TARGET_TYPE_FACTION_DONATION=4,a.QUEST_TARGET_TYPE_FACTION_ACTIVITY=5,a.QUEST_TARGET_TYPE_FIELD_BOSS=6,a.QUEST_TARGET_TYPE_WORLD_BOSS=7,a.QUEST_TARGET_TYPE_RESOURCE_INSTANCE=8,a.QUEST_TARGET_TYPE_TRIAL_INSTANCE=9,a.QUEST_TARGET_TYPE_OWN_DIVINE=10,a.QUEST_TARGET_TYPE_EQUIP_DIVINE=11,a.QUEST_TARGET_TYPE_STRENGTH_DIVINE=12,a.QUEST_TARGET_TYPE_RAISE_SKILL=13,a.QUEST_TARGET_TYPE_TRAIN_MOUNT=14,a.QUEST_TARGET_TYPE_RAISE_MOUNT_SKILL=15,a.QUEST_TARGET_TYPE_FRIEND_DONATION=16,a.QUEST_TARGET_TYPE_STRENGTH_SUIT=17,a.QUEST_TARGET_TYPE_STRENGTH_GEM=18,a.QUEST_TARGET_TYPE_TALK=19,a.QUEST_TARGET_TYPE_PICK_GAME_OBJECT=20,a.QUEST_TARGET_TYPE_CHECK_GAME_OBJECT=21,a.QUEST_TARGET_TYPE_KILL_MONSTER=22,a.QUEST_TARGET_TYPE_USE_ITEM=23,a.QUEST_TARGET_TYPE_SUIT=24,a.QUEST_TARGET_TYPE_MOUNT_LEVEL=25,a.QUEST_TARGET_TYPE_FRIEND_NUM=26,a.QUEST_TARGET_TYPE_KILL_MONSTER_NUM=27,a.QUEST_TARGET_TYPE_DIVINE_NUM=28,a.QUEST_TARGET_TYPE_DIVINE_LEV=29,a.QUEST_TARGET_TYPE_DOUJIANTAI=30,a.QUEST_TARGET_TYPE_TITLE_NUMBER=31,a.QUEST_TARGET_TYPE_FASHION_NUMBER=32,a.QUEST_TARGET_TYPE_ACHIEVE=40,a.QUEST_TARGET_TYPE_SUIT_TITLE=41,a.QUEST_TARGET_TYPE_SUIT_FASHION=42,a.QUEST_TARGET_TYPE_JOIN_DOUJIANTAI=43,a.QUEST_TARGET_TYPE_JOIN_KUAFU_3V3=44,a.QUEST_TARGET_TYPE_WIN_KUAFU_3V3=45,a.QUEST_TARGET_TYPE_JOIN_XIANFU=46,a.QUEST_TARGET_TYPE_WIN_XIANFU=47,a.QUEST_TARGET_TYPE_KILL_MONSTER_COLLECT=48,a.QUEST_TARGET_TYPE_TURN_ITEM_IN=49,a.QUEST_TARGET_TYPE_PASS_WORLD_RISK=50,a.QUEST_TARGET_TYPE_SMELT=51,a.QUEST_TARGET_TYPE_CONTRIBUTE_TIMES=52,a.QUEST_TARGET_TYPE_CONTRIBUTE_TOTAL_TIMES=53,a.QUEST_TARGET_TYPE_CONTRIBUTE_CHARM=54,a.QUEST_TARGET_TYPE_CONTRIBUTE_ITEM=55,a.QUEST_TARGET_TYPE_LOOT_ITEM=56,a.QUEST_TARGET_TYPE_SINGLE_THX_TIMES=57,a.QUEST_TARGET_TYPE_TOTAL_THX_TIMES=58,a.QUEST_TARGET_TYPE_WINGS_UPGRADE_LEVEL=59,a.QUEST_TARGET_TYPE_WINGS_UPDRADE_TIMES=60,a.QUEST_TARGET_TYPE_WINGS_STRENGTH_LEVEL=61,a.QUEST_TARGET_TYPE_WINGS_STRENGTH_TIMES=62,a.QUEST_TARGET_TYPE_TALISMAN_LEVEL=63,a.QUEST_TARGET_TYPE_MOUNT_STRENGTH_LEVEL=64,a.QUEST_TARGET_TYPE_REFINE_SUIT=65,a.QUEST_TARGET_TYPE_WASH_SUIT=66,a.QUEST_TARGET_TYPE_MERIDIAN_LEVEL=67,a.QUEST_TARGET_TYPE_JOIN_SINGLE_PVP=68,a.QUEST_TARGET_TYPE_SINGLE_PVP_WINS=69,a.QUEST_TARGET_TYPE_ACTIVE_TASK=70,a.QUEST_TARGET_TYPE_DAILY_TASK=71,a.QUEST_TARGET_TYPE_GEM_TOTAL_LEVEL=72,a.QUEST_TARGET_TYPE_WINGS_BLESS_TIMES=73,a.QUEST_TARGET_TYPE_MONEYTREE_TIMES=74,a.QUEST_TARGET_TYPE_JOIN_MASS_BOSS_TIMES=75,a.QUEST_TARGET_TYPE_MAIN_SKILL_UPGRADE_LEVEL=76,a.QUEST_TARGET_TYPE_SUB_SKILL_UPGRADE_LEVEL=77,a.QUEST_TARGET_TYPE_FINISH_QUEST_COUNT_TYPE_TIMES=78,a.QUEST_TARGET_TYPE_ADVENTURE_SKILL_UPGRADE_LEVEL=79,a.QUEST_TARGET_TYPE_ADVENTURE_QUEST_FINISH_TIMES=80,a.QUEST_TARGET_TYPE_EQUIPS_FIT_REQUIRE=81,a.QUEST_TARGET_TYPE_ADVENTURE_QUEST_FINISH_TODAY=82,a.QUEST_TARGET_TYPE_ADVENTURE_SKILL_ONE_LEVEL=83,a.CURRENCY_HANDLE_TYPE_ADD=0,a.CURRENCY_HANDLE_TYPE_SUB=1,a.SPELL_VALID_TIME_POTIAN_2=0,a.SPELL_VALID_TIME_POTIAN_3=1,a.SPELL_VALID_TIME_YUNFEI_2=2,a.SPELL_VALID_TIME_YUNFEI_3=3,a.SPELL_VALID_TIME_FENGFAN_2=4,a.SPELL_VALID_TIME_ZHUXIAN_2=5,a.SPELL_VALID_TIME_ZHUXIAN_3=6,a.MAX_SPELL_VALID=15,a.MAX_SPELL_SLOT=6,a.NOMAL_ATTACK_TIME=1300,a.NOMAL_MOVE_SPEED=130,a.MAX_ITEM_SPELL=3,a.MAX_BASE_ATTR_FIELD_COUNT=15,a.MAX_BUFF=50,a.MAX_UNIT_BUFF=16,a.EQUIPMENT_TYPE_OTHER=0,a.EQUIPMENT_TYPE_MAIN_WEAPON=1,a.EQUIPMENT_TYPE_COAT=2,a.EQUIPMENT_TYPE_LEG=3,a.EQUIPMENT_TYPE_BELT=4,a.EQUIPMENT_TYPE_SHOES=5,a.EQUIPMENT_TYPE_HELMET=6,a.EQUIPMENT_TYPE_NECKLACE=7,a.EQUIPMENT_TYPE_PANTS=8,a.EQUIPMENT_TYPE_LRING=9,a.EQUIPMENT_TYPE_BRACELET=10,a.EQUIPMENT_TYPE_CLOAK=11,a.EQUIPMENT_TYPE_RRING=12,a.EQUIPMENT_TYPE_FASHION=13,a.EQUIPMENT_TYPE_RESERVE3=14,a.EQUIPMENT_TYPE_RESERVE4=15,a.EQUIPMENT_TYPE_RESERVE5=16,a.EQUIPMENT_TYPE_RESERVE6=17,a.EQUIPMENT_TYPE_RESERVE7=18,a.EQUIPMENT_TYPE_RESERVE8=19,a.EQUIPMENT_TYPE_MAX_POS=20,a.FASHION_TYPE_MAIN_WEAPON=20,a.FASHION_TYPE_HELMET=21,a.FASHION_TYPE_COAT=22,a.FASHION_TYPE_BELT=23,a.FASHION_TYPE_LEG=24,a.FASHION_TYPE_PANTS=25,a.FASHION_TYPE_SHOES=26,a.FASHION_TYPE_BRACELET=27,a.FASHION_TYPE_NECKLACE=28,a.FASHION_TYPE_RING=29,a.FASHION_TYPE_CLOAK=30,a.FASHION_TYPE_RESERVE1=31,a.FASHION_TYPE_RESERVE2=32,a.FASHION_TYPE_RESERVE3=33,a.FASHION_TYPE_RESERVE4=34,a.FASHION_TYPE_RESERVE5=35,a.FASHION_TYPE_RESERVE6=36,a.FASHION_TYPE_RESERVE7=37,a.FASHION_TYPE_RESERVE8=38,a.FASHION_TYPE_RESERVE9=39,a.MAX_EQUIPMENT_TYPE=40,a.WEAPON_POS_MAIN=0,a.WEAPON_POS_OFF=1,a.WEAPON_POS_SINGLE_HAND=2,a.WEAPON_POS_BOTH_HANDS=3,a.MAX_WEAPON_POS=4,a.POWER_MANA=0,a.POWER_ENERGY=1,a.MAX_POWERS=2,a.COMBAT_RATE_CRIT=0,a.COMBAT_RATE_EVA=1,a.MAX_COMBAT_RATE=2,a.BAG_TYPE_MAIN_BAG=0,a.BAG_TYPE_EQUIP=1,a.BAG_TYPE_EQUIP_BAG=2,a.BAG_TYPE_GEM=3,a.BAG_TYPE_GEM_BAG=4,a.MAX_BAG=20,a.BAG_EXTENSION_TYPE_AUTO=0,a.BAG_EXTENSION_TYPE_GOLD=1,a.SAFETY_CODE_MODIFY_TYPE_CODE=0,a.SAFETY_CODE_MODIFY_TYPE_QUESTION=1,a.Item_Loot_Gold_Ingot=1,a.Item_Loot_Bind_Gold=2,a.Item_Loot_Silver=3,a.Item_Loot_Renown=5,a.Item_Loot_Honor=6,a.Item_Loot_Exploit=7,a.Item_Loot_Contrib=8,a.Item_Loot_Exp=104,a.Item_Loot_Mount_Exp=10,a.Item_Loot_QI=13,a.Item_Loot_BEAST=14,a.Item_Loot_GEM=15,a.Item_Loot_Realmbreak_Exp=107,a.MONEY_TYPE_GOLD_INGOT=1,a.MONEY_TYPE_BIND_GOLD=2,a.MONEY_TYPE_SILVER=3,a.MONEY_TYPE_SILVER_WAREHOUSE=4,a.MAX_MONEY_TYPE=22,a.BASE_ATTR_HP=0,a.BASE_ATTR_DAMAGE=1,a.BASE_ATTR_ARMOR=2,a.BASE_ATTR_HIT=3,a.BASE_ATTR_DODGE=4,a.BASE_ATTR_CRIT=5,a.BASE_ATTR_CRIT_RESIST=6,a.BASE_MOVE_SPEED=7,a.BASE_ATTACK_SPEED=8,a.MAX_BASE_ATTR=9,a.EQUIP_ATTR_NONE=0,a.EQUIP_ATTR_MAX_HEALTH=1,a.EQUIP_ATTR_DAMAGE=2,a.EQUIP_ATTR_ARMOR=3,a.EQUIP_ATTR_HIT=4,a.EQUIP_ATTR_MISS=5,a.EQUIP_ATTR_CRIT=6,a.EQUIP_ATTR_TOUGH=7,a.EQUIP_ATTR_ATTACK_SPEED=8,a.EQUIP_ATTR_MOVE_SPEED=9,a.EQUIP_ATTR_IGNORE_ARMOR=10,a.EQUIP_ATTR_IGNORE_MISS=11,a.EQUIP_ATTR_RECOVERY=12,a.EQUIP_ATTR_DAMAGE_AMPLIFY_RATE=13,a.EQUIP_ATTR_DAMAGE_RESIST_RATE=14,a.EQUIP_ATTR_DAMAGE_RETURN_RATE=15,a.EQUIP_ATTR_VAMPIRIC_RATE=16,a.EQUIP_ATTR_RECOVERY_RATE=17,a.EQUIP_ATTR_CRIT_RATE=18,a.EQUIP_ATTR_CRIT_RESIST_RATE=19,a.EQUIP_ATTR_CRIT_DAM_RATE=20,a.EQUIP_ATTR_CRIT_RESIST_DAM_RATE=21,a.EQUIP_ATTR_HIT_RATE=22,a.EQUIP_ATTR_MISS_RATE=23,a.EQUIP_ATTR_STUN_RATE=24,a.EQUIP_ATTR_ROOTS_RATE=25,a.EQUIP_ATTR_SILENCE_RATE=26,a.EQUIP_ATTR_CHAOS_RATE=27,a.EQUIP_ATTR_CHARM_RATE=28,a.EQUIP_ATTR_CONTROL_ENHANCE_RATE=29,a.EQUIP_ATTR_CONTROL_RESIST_RATE=30,a.EQUIP_ATTR_STRENGTH_ARMOR=31,
a.EQUIP_ATTR_DAO=32,a.MAX_EQUIP_ATTR=33,a.ITEM_OTHER_ATTR_FAIL_TIME=33,a.ITEM_OTHER_ATTR_STRONG_LV=34,a.ITEM_OTHER_ATTR_STRONG_FAIL_COUNT=35,a.ITEM_OTHER_ATTR_FORCE=36,a.SPELL_CD_BASE=0,a.SPELL_CD_SPECIAL=1,a.MAX_SPELL_CD_TYPE=2,a.QUEST_ID_OFFSET=0,a.QUEST_STATE_OFFSET=1,a.QUEST_COUNTS_OFFSET=2,a.QUEST_COUNTS_OFFSET_1=3,a.QUEST_COUNTS_OFFSET_2=4,a.QUEST_COUNTS_OFFSET_3=5,a.QUEST_TIME_OFFSET=6,a.QUEST_FLAG_OFFSET=7,a.MAX_QUEST_OFFSET=8,a.QUEST_SLOT_FLAGS_REWARD=0,a.QUEST_SLOT_FLAGS_EXPLORE=1,a.MAX_QUEST_LOG_SIZE=32,a.QUEST_OBJECTIVES_COUNT=8,a.QUEST_REWARD_CHOICES_COUNT=6,a.QUEST_REWARDS_COUNT=4,a.QUEST_LOW_LEVEL_HIDE_DIFF=4,a.QUEST_ITEMS_COUNTS=10,a.QUEST_COMPLETE_LIST=200,a.BINLOG_STRING_FIELD_GUID=0,a.BINLOG_STRING_FIELD_NAME=1,a.BINLOG_STRING_FIELD_VERSION=2,a.BINLOG_STRING_FIELD_OWNER=3,a.LOOT_PUBLIC_INT_START_POS=0,a.LOOT_PUBLIC_INT_END_POS=1,a.LOOT_PUBLIC_INT_BEGIN=2,a.LOOT_PUBLIC_INT_ENTRY=0,a.LOOT_PUBLIC_INT_MONEY_SUM=1,a.MAX_LOOT_PUBLIC_INT_FIELD=2,a.LOOT_PUBLIC_STR_OWNER=0,a.MAX_LOOT_PUBLIC_STR_FIELD=1,a.LOOT_PRIVATE_INT_FAIL_TIME=0,a.LOOT_PRIVATE_INT_EXIST_TIME=1,a.LOOT_PRIVATE_INT_OWNER_TIME=2,a.LOOT_PRIVATE_INT_FLAG=3,a.MAX_LOOT_PRIVATE_INT_FIELD=4,a.LOOT_PRIVATE_STRING_CREATE_BY=0,a.LOOT_PRIVATE_STRING_CREATE_NAME=1,a.MAX_LOOT_PRIVATE_STRING=2,a.LOOT_STR_FIELD_BEGIN=4,a.LOOT_FLAG_GET_ITEM_NOTICE=0,a.LOOT_FLAG_ITEM_BIND=1,a.PLAYER_PASSIVE_SPELL_MAX_COUNT=100,a.UNIT_CANDO_OFFSET_TYPE_CANT_CAST=0,a.UNIT_CANDO_OFFSET_TYPE_CANT_MOVE=1,a.UNIT_FIELD_BYTE_0=0,a.UNIT_FIELD_BYTE_1=1,a.UNIT_FIELD_BYTE_2=2,a.UNIT_FIELD_BYTE_3=3,a.UNIT_FIELD_BYTE_4=4,a.UNIT_FIELD_MOUNT_LEVEL=5,a.UNIT_FIELD_DIVINE_ID=6,a.UNIT_FIELD_UINT16_0=7,a.UNIT_FIELD_UINT16_1=8,a.UNIT_FIELD_UINT16_2=9,a.UNIT_FIELD_SELF_DEFENSE_GUID=10,a.UNIT_FIELD_FLAGS=11,a.GO_FIELD_FLAGS=12,a.GO_FIELD_DATA=13,a.UNIT_FIELD_NPC_FLAG=17,a.UNIT_FIELD_INSTANCE_ID=18,a.UNIT_FIELD_EQUIPMENT_COAT=19,a.UNIT_FIELD_EQUIPMENT_MAIN_WEAPON=20,a.UNIT_FIELD_BUFF=21,a.UNIT_FIELD_BUFF_TM=29,a.UNIT_FIELD_BUFF_RESERVE=37,a.UNIT_FIELD_BUFF_EFFECT_ID=53,a.UNIT_FIELD_BUFF_CASTER_GUID=69,a.UNIT_FIELD_FORCE=85,a.UNIT_FIELD_HEALTH=87,a.UNIT_FIELD_MAX_HEALTH=88,a.UNIT_FIELD_DAMAGE=89,a.UNIT_FIELD_ARMOR=90,a.UNIT_FIELD_HIT=91,a.UNIT_FIELD_MISS=92,a.UNIT_FIELD_CRIT=93,a.UNIT_FIELD_TOUGH=94,a.UNIT_FIELD_ATTACK_SPEED=95,a.UNIT_FIELD_MOVE_SPEED=96,a.UNIT_FIELD_IGNORE_ARMOR=97,a.UNIT_FIELD_IGNORE_MISS=98,a.UNIT_FIELD_RECOVERY=99,a.UNIT_FIELD_DAMAGE_AMPLIFY_RATE=100,a.UNIT_FIELD_DAMAGE_RESIST_RATE=101,a.UNIT_FIELD_DAMAGE_RETURN_RATE=102,a.UNIT_FIELD_VAMPIRIC_RATE=103,a.UNIT_FIELD_RECOVERY_RATE=104,a.UNIT_FIELD_CRIT_RATE=105,a.UNIT_FIELD_CRIT_RESIST_RATE=106,a.UNIT_FIELD_CRIT_DAM_RATE=107,a.UNIT_FIELD_CRIT_RESIST_DAM_RATE=108,a.UNIT_FIELD_HIT_RATE=109,a.UNIT_FIELD_MISS_RATE=110,a.UNIT_FIELD_STUN_RATE=111,a.UNIT_FIELD_ROOTS_RATE=112,a.UNIT_FIELD_SILENCE_RATE=113,a.UNIT_FIELD_CHAOS_RATE=114,a.UNIT_FIELD_CHARM_RATE=115,a.UNIT_FIELD_CONTROL_ENHANCE_RATE=116,a.UNIT_FIELD_CONTROL_RESIST_RATE=117,a.UNIT_FIELD_STRENGTH_ARMOR=118,a.UNIT_FIELD_DAO=119,a.UNIT_FIELD_ATTRIBUTE_END=120,a.UNIT_FIELD_MAX_HEALTH_BASE=120,a.UNIT_FIELD_DAMAGE_BASE=121,a.UNIT_FIELD_ARMOR_BASE=122,a.UNIT_FIELD_HIT_BASE=123,a.UNIT_FIELD_MISS_BASE=124,a.UNIT_FIELD_CRIT_BASE=125,a.UNIT_FIELD_TOUGH_BASE=126,a.UNIT_FIELD_ATTACK_SPEED_BASE=127,a.UNIT_FIELD_MOVE_SPEED_BASE=128,a.UNIT_FIELD_IGNORE_ARMOR_BASE=129,a.UNIT_FIELD_IGNORE_MISS_BASE=130,a.UNIT_FIELD_RECOVERY_BASE=131,a.UNIT_FIELD_DAMAGE_AMPLIFY_RATE_BASE=132,a.UNIT_FIELD_DAMAGE_RESIST_RATE_BASE=133,a.UNIT_FIELD_DAMAGE_RETURN_RATE_BASE=134,a.UNIT_FIELD_VAMPIRIC_RATE_BASE=135,a.UNIT_FIELD_RECOVERY_RATE_BASE=136,a.UNIT_FIELD_CRIT_RATE_BASE=137,a.UNIT_FIELD_CRIT_RESIST_RATE_BASE=138,a.UNIT_FIELD_CRIT_DAM_RATE_BASE=139,a.UNIT_FIELD_CRIT_RESIST_DAM_RATE_BASE=140,a.UNIT_FIELD_HIT_RATE_BASE=141,a.UNIT_FIELD_MISS_RATE_BASE=142,a.UNIT_FIELD_STUN_RATE_BASE=143,a.UNIT_FIELD_ROOTS_RATE_BASE=144,a.UNIT_FIELD_SILENCE_RATE_BASE=145,a.UNIT_FIELD_CHAOS_RATE_BASE=146,a.UNIT_FIELD_CHARM_RATE_BASE=147,a.UNIT_FIELD_CONTROL_ENHANCE_RATE_BASE=148,a.UNIT_FIELD_CONTROL_RESIST_RATE_BASE=149,a.UNIT_FIELD_STRENGTH_ARMOR_BASE=150,a.UNIT_FIELD_DAO_BASE=151,a.UNIT_FIELD_ATTRIBUTE_BASE_END=152,a.UNIT_FIELD_ANGER=152,a.UNIT_FIELD_USE_RESPAWN_MAPID=153,a.UNIT_FIELD_PROCESS_TIME=154,a.UNIT_FIELD_PROCESS_SECONDS=155,a.UINT_FIELD_BOSS_DATA=156,a.UINT_FIELD_BOSS_DATA1=157,a.UINT_FIELD_VIEW_MODE=157,a.UINT_FIELD_VIRTUAL_CAMP=158,a.UINT_FIELD_XIANFU_INFO=159,a.UINT_FIELD_VIP_LEVEL=160,a.UINT_FIELD_VIP_TIME_OUT=161,a.UINT_FIELD_VAMPIRIC=162,a.UINT_INT_FIELD_ILLUSION=164,a.UINT_FIELD_BOOS_CUR_SPELLID=165,a.UINT_FIELD_BOOS_CUR_SPELL_TIME=166,a.UINT_FIELD_BOOS_CUR_SPELL_LAST_COUNT=167,a.UINT_INT_FIELD_PASSIVE_SPELL_START=168,a.UINT_INT_FIELD_PASSIVE_SPELL_END=268,a.UINT_INT_FIELD_WINGS_RANK=268,a.UNIT_INT_FIELD_APPEARANCE=269,a.UNIT_INT_FIELD_RISK_CREATURE_ID=270,a.UNIT_INT_FIELD_OPERATE_CD=271,a.MAX_UNIT_FIELD=272,a.GO_STRING_FIELD_CREATED_BY=4,a.UNIT_STRING_FIELD_ALIAS_NAME=5,a.UNIT_STRING_FIELD_PICK_NAME=6,a.UNIT_STRING_FIELD_GROUP_PEACE_ID=7,a.UNIT_STRING_FIELD_FACTION_GUID=8,a.MAX_UNIT_STRING_FIELD=9,a.GO_ENTRY_TELETEPORT=1,a.GO_ENTRY_LOOT=9,a.GO_TELETEPORTER_TO_MAPID=13,a.GO_TELETEPORTER_TO_X=14,a.GO_TELETEPORTER_TO_Y=15,a.GO_QUEST_ID_0=13,a.GO_QUEST_ID_1=14,a.GO_QUEST_ID_2=15,a.GO_QUEST_ID_3=16,a.GO_STRING_FIELD_CREATED_NAME=5,a.GO_GEAR_STATUS=13,a.GO_GEAR_KILLER=14,a.GO_GEAR_STATUS_START=1,a.GO_GEAR_STATUS_OPEN=2,a.GO_GEAR_STATUS_CLOSE=3,a.GO_GEAR_STATUS_END=4,a.UNIT_FIELD_FLAGS_CANT_CAST=0,a.UNIT_FIELD_FLAGS_CANT_MOVE=1,a.UNIT_FIELD_FLAGS_BUFF_DAZUO=2,a.UNIT_FIELD_FLAGS_GUAJIBAOHU=3,a.UNIT_FIELD_FLAGS_FACTION_LINGXIU=4,a.UNIT_FIELD_FLAGS_FACTION_GUWU=5,a.UNIT_FIELD_FLAGS_IS_BOSS_CREATURE=6,a.UNIT_FIELD_FLAGS_USE_GAMEOBJECT=7,a.UNIT_FIELD_FLAGS_IS_FLZ_PUB_CREATURE=8,a.UNIT_FIELD_FLAGS_QUEST_FOLLOW_CREATUR=9,a.UNIT_FIELD_FLAGS_IS_PVP=10,a.UNIT_FIELD_FLAGS_IS_FIELD_BOSS_CREATURE=11,a.UNIT_FIELD_FLAGS_IS_INVISIBLE_SPELL=12,a.PLAYER_SCENED_FLAS_HUNG_UP=0,a.PLAYER_SCENED_FLAS_PVP_STATE=1,a.PLAYER_SCENED_FLAGS_FUBEN_HUNG_UP=2,a.PLAYER_APPD_INT_FIELD_FLAGS_IS_ZIBAO=0,a.PLAYER_APPD_INT_FIELD_FLAGS_YEYOU_ONLINE=1,a.PLAYER_APPD_INT_FIELD_FLAGS_PHONE_ONLINE=2,a.PLAYER_APPD_INT_FIELD_FLAGS_FROM_KUAFU=3,a.PLAYER_APPD_INT_FIELD_FLAGS_GIFT_CREATE=4,a.PLAYER_APPD_INT_FIELD_FLAGS_LIMIT_CREATE=5,a.PLAYER_APPD_INT_FIELD_FLAGS_IS_FIRST_RECHARGE=6,a.PLAYER_APPD_INT_FIELD_FLAGS_NEW_PLAYER=7,a.PLAYER_APPD_INT_FIELD_FLAGS_SAFETY_CODE_CHECK=8,a.PLAYER_APPD_INT_FIELD_FLAGS_AUTO_GROUP=9,a.PLAYER_APPD_INT_FIELD_FLAGS_IS_HOSTING_LOGIN=10,a.PLAYER_APPD_INT_FIELD_FLAGS_IS_HOSTING_APPLY=11,a.PLAYER_APPD_INT_FIELD_FLAGS_SOCIAL_CREATE=12,a.PLAYER_APPD_INT_FIELD_FLAGS_ITEM_CREATE=13,a.PLAYER_APPD_INT_FIELD_FLAGS_LOGICAL_CREATE=14,a.PLAYER_APPD_INT_FIELD_FLAGS_SPELL_CREATE=15,a.PLAYER_APPD_INT_FIELD_FLAGS_INSTANCE_CREATE=16,a.PLAYER_APPD_INT_FIELD_FLAGS_QUEST_CREATE=17,a.QIANLI_TYPE_LILIANG=0,a.QIANLI_TYPE_TIZHI=1,a.QIANLI_TYPE_SHENFA=2,a.QIANLI_TYPE_FANGYU=3,a.MAX_QIANLI_TYPE=4,a.MAX_CLIENT_UINT32_COUNT=100,a.MAX_CLIENT_STRING_COUNT=20,a.MAX_ITEMS_CD_COUNT=20,a.MAX_ITEM_USED_COUNT=5,a.MAX_SPELL_CAPACITY=20,a.SPELL_BASE_LEVEL=0,a.SPELL_BASE_FORCE=1,a.SPELL_BASE_ID=2,a.MAX_SPELLBASE=3,a.FUNCTIONAL_QING_GONG=1,a.FUNCTIONAL_TI_YUN_ZONG=2,a.FUNCTIONAL_RIDE=3,a.FUNCTIONAL_DA_ZUO=4,a.PLAYER_SLOT_SPELL_MAX_COUNT=12,a.PLAYER_IMPORTANT_CD_COUNT=20,a.SHORT_SLOT_SPELL_ID=0,a.BYTE_SLOT_SPELL_LV=2,a.BYTE_SLOT=3,a.SPELL_ACTIVE_BY_LEVEL=0,a.SPELL_ACTIVE_BY_QUEST=1,a.SPELL_ACTIVE_BY_ITEM=2,a.IMPORTANT_SPELL_ID=0,a.IMPORTANT_SPELL_CD=1,a.MAX_IMPORTANT_SPELL_ATTR_COUNT=2,a.OPEN_MENU_MAIN_ID=0,a.OPEN_MENU_SUB_FLAG=1,a.MAX_OPEN_MENU_ATTR_COUNT=2,a.GIFT_PACKS_TYPE_ITEM_GIVE=0,a.GIFT_PACKS_TYPE_SYSTEM_COMPENSATION=1,a.GIFT_PACKS_TYPE_BAG_FULL=2,a.GIFT_PACKS_TYPE_LEVEL_RANK=3,a.GIFT_PACKS_TYPE_WORLD_BOSS=4,a.GIFT_PACKS_TYPE_3V3_WEEK=5,a.GIFT_PACKS_TYPE_3V3_MONTH=6,a.GIFT_PACKS_TYPE_DOUJIAN_DAY=7,a.GIFT_PACKS_TYPE_FACTION_BOSS=8,a.GIFT_PACKS_TYPE_FACTION_GIFT_RANK=9,a.GIFT_PACKS_TYPE_ACT_RANK=10,a.GIFT_PACKS_TYPE_MASS_BOSS=11,a.GIFT_PACKS_TYPE_ESCORT_ROB=12,a.SCENED_APPD_ENTER_DAILY_INSTANCE=1,a.SCENED_APPD_ENTER_VIP_INSTANCE=2,a.SCENED_APPD_USE_ITEM=3,a.SCENED_APPD_USE_RESPAWN_ITEM=4,a.SCENED_APPD_ENTER_TRIAL_INSTANCE=5,a.SCENED_APPD_PASS_TRIAL_INSTANCE=6,a.SCENED_APPD_PASS_VIP_INSTANCE=7,a.SCENED_APPD_ADD_ENEMY=8,a.SCENED_APPD_ENTER_RES_INSTANCE=9,a.SCENED_APPD_ADD_MAIL=10,a.SCENED_APPD_PASS_RES_INSTANCE=11,a.SCENED_APPD_KILL_MONSTER=12,a.SCENED_APPD_JOIN_FIELD_BOSS=13,a.SCENED_APPD_GAMEOBJECT=14,a.SCENED_APPD_TALK=15,a.SCENED_APPD_RIDE=16,a.SCENED_APPD_GOLD_RESPAWN=17,a.SCENED_APPD_DOUJIANTAI=18,a.SCENED_APPD_KILL_MONSTER_COLLECT=19,a.SCENED_APPD_XIULIANCHANG=20,a.SCENED_APPD_XIANFU_PRACTISE=21,a.SCENED_APPD_ADD_OFFLINE_RISK_REWARD=22,a.SCENED_APPD_PASS_WORLD_RISK=23,a.SCENED_APPD_ENTER_MASS_BOSS_INSTANCE=24,a.SCENED_APPD_FACTION_TOWER_WIN=25,a.SCENED_APPD_SINGLE_PVP_RESULT=26,a.SCENED_APPD_ENTER_QUALIFY_INSTANCE=27,a.SCENED_APPD_ENTER_FACTION_TOWER_INSTANCE=28,a.SCENED_APPD_PRIVATE_BOSS_WIN=29,a.SCENED_APPD_ENTER_DOUJIANTAI_INSTANCE=30,a.SCENED_APPD_WORLD_BOSS_ENROLL=31,a.SCENED_APPD_ENTER_FACTION_BOSSDEFENSE_INSTANCE=32,a.SCENED_APPD_ENTER_PRIVATE_BOSS_INSTANCE=33,a.SCENED_APPD_PLAYER_DEAD_PROCESS=34,a.SCENED_APPD_ENTER_STAGE_INSTANCE=35,a.SCENED_APPD_PASS_STAGE_INSTANCE=36,a.APPD_SCENED_SWEEP_TRIAL_INSTANCE=1,a.APPD_SCENED_SWEEP_VIP_INSTANCE=2,a.APPD_SCENED_RESPAWN=3,a.APPD_SCENED_NEAR_BY_CHAT=4,a.APPD_SCENED_ADD_EXP=5,a.APPD_SCENED_CLEAR_FIELD_BOSS=6,a.APPD_SCENED_REBORN_FIELD_BOSS=7,a.APPD_SCENED_WORLD_BOSS_WAITING=8,a.APPD_SCENED_FIGHT_WORLD_BOSS=9,a.APPD_SCENED_WORLD_BOSS_END=10,a.APPD_SCENED_WORLD_BOSS_ENTER=11,a.APPD_SCENED_REMIND_INSTANCE_ENTER=12,a.APPD_SCENED_MASS_BOSS_REBORN=13,a.APPD_SCENED_TELEPORT=14,a.APPD_SCENED_CHECK_ENTER_FACTION_BOSSDEFENSE=15,a.APPD_SCENED_CHECK_ENTER_FACTION_TOWER=16,a.APPD_SCENED_USE_RESTORE_POTION=17,a.INSTANCE_SUB_TYPE_VIP=1,a.INSTANCE_SUB_TYPE_TRIAL=2,a.INSTANCE_SUB_TYPE_WORLD_BOSS=3,a.INSTANCE_SUB_TYPE_RES=4,a.INSTANCE_SUB_TYPE_KUAFU_3V3=5,a.INSTANCE_SUB_TYPE_XIANFU=6,a.INSTANCE_SUB_TYPE_DOUJIANTAI=7,a.INSTANCE_SUB_TYPE_XIANFU_EXPERIENCE=8,a.INSTANCE_SUB_TYPE_XIULIAN=9,a.INSTANCE_SUB_TYPE_PLOT=10,a.INSTANCE_SUB_TYPE_MASS_BOSS=11,a.INSTANCE_SUB_TYPE_KUAFU_GROUP=12,a.INSTANCE_SUB_TYPE_FACTION_BOSSDEFENSE=13,a.INSTANCE_SUB_TYPE_FACTION_TOWER=14,a.INSTANCE_SUB_TYPE_QUALIFY=15,a.INSTANCE_SUB_TYPE_RISK=16,a.INSTANCE_SUB_TYPE_PRIVATE_BOSS=17,a.INSTANCE_SUB_TYPE_STAGE=18,a.CHAT_CHANNEL_SYSTEM=0,a.CHAT_CHANNEL_WORLD=1,a.CHAT_CHANNEL_NEARBY=2,a.CHAT_CHANNEL_FAMILY=3,a.CHAT_CHANNEL_GROUP=4,a.MAX_CHAT_BLOCK_COUNT=30,a.MAX_RANK_LIKE=10,a.MAX_SHOP_LIMIT=20,a.MAX_WORLD_3V3_COUNT=3,a.MAX_BUYED_FACTION_SHOP=8,a.MAX_PLAYER_OPEN_MENU_COUNT=50,a.MAX_OPTIONAL_GUIDE_COUNT=30,a.MAX_PLAYER_CULTIVATION_RIVAL_COUNT=4,a.MAX_PLAYER_CULTIVATION_PLUNDER_RECORD_COUNT=10,a.MAX_PLAYER_FACTION_SKILL_COUNT=20,a.FACTION_DATA_INT_GIFT_ID=0,a.FACTION_DATA_INT_GIFT_POINT=1,a.FACTION_DATA_INT_GIFT_FLAG_THANK=2,a.FACTION_DATA_INT_GIFT_TIME=3,a.FACTION_DATA_INT_GIFT_COUNT_ID=4,a.MAX_FACTION_DATA_INT_GIFT=5,a.FACTION_DATA_STRING_GIFT_GUID=0,a.FACTION_DATA_STRING_GIFT_MSG=1,a.FACTION_DATA_STRING_GIFT_ITEM_LIST=2,a.FACTION_DATA_STRING_GIFT_REPLY_LIST=3,a.MAX_FACTION_DATA_STRING_GIFT=4,a.FACTION_DATA_REPLY_TYPE_TEXT=0,a.FACTION_DATA_REPLY_TYPE_VOICE=1,a.MAX_FACTION_DATA_GIFT_COUNT=150,a.MAX_FACTION_DATA_GIFT_REPLY_COUNT=200,a.MAX_FACTION_DATA_GIFT_CACHE_COUNT=1e3,a.PLAYER_FIELD_FD=0,a.PLAYER_FIELD_MERGE_DATA_INDEX=1,a.PLAYER_FIELD_ENTRY=2,a.PLAYER_FIELD_MAP_ID=3,a.PLAYER_FIELD_INSTANCE_ID=4,a.PLAYER_FIELD_LINE_NO=5,a.PLAYER_FIELD_POS_X=6,a.PLAYER_FIELD_POS_Y=7,a.PLAYER_FIELD_ORIENTATION=8,a.PLAYER_FIELD_MOVESPEED=9,a.PLAYER_FIELD_LEVEL=11,a.PLAYER_FIELD_BYTES_0=12,a.PLAYER_FIELD_NPC_FLAG=13,a.PLAYER_FIELD_DEATH_STATE=14,a.PLAYER_FIELD_HEALTH=15,a.PLAYER_FIELD_MAX_HEALTH=17,a.PLAYER_FIELD_DAMAGE=19,a.PLAYER_FIELD_ARMOR=21,a.PLAYER_FIELD_HIT=23,a.PLAYER_FIELD_MISS=25,a.PLAYER_FIELD_CRIT=27,a.PLAYER_FIELD_TOUGH=29,a.PLAYER_FIELD_ATTACK_SPEED=31,a.PLAYER_FIELD_MOVE_SPEED=33,a.PLAYER_FIELD_IGNORE_ARMOR=35,a.PLAYER_FIELD_IGNORE_MISS=37,a.PLAYER_FIELD_RECOVERY=39,a.PLAYER_FIELD_DAMAGE_AMPLIFY_RATE=41,a.PLAYER_FIELD_DAMAGE_RESIST_RATE=43,a.PLAYER_FIELD_DAMAGE_RETURN_RATE=45,a.PLAYER_FIELD_VAMPIRIC_RATE=47,a.PLAYER_FIELD_RECOVERY_RATE=49,a.PLAYER_FIELD_CRIT_RATE=51,a.PLAYER_FIELD_CRIT_RESIST_RATE=53,a.PLAYER_FIELD_CRIT_DAM_RATE=55,a.PLAYER_FIELD_CRIT_RESIST_DAM_RATE=57,a.PLAYER_FIELD_HIT_RATE=59,a.PLAYER_FIELD_MISS_RATE=61,a.PLAYER_FIELD_STUN_RATE=63,a.PLAYER_FIELD_ROOTS_RATE=65,a.PLAYER_FIELD_SILENCE_RATE=67,a.PLAYER_FIELD_CHAOS_RATE=69,a.PLAYER_FIELD_CHARM_RATE=71,a.PLAYER_FIELD_CONTROL_ENHANCE_RATE=73,a.PLAYER_FIELD_CONTROL_RESIST_RATE=75,a.PLAYER_FIELD_STRENGTH_ARMOR=77,a.PLAYER_FIELD_DAO=79,a.PLAYER_FIELD_ATTR_RESERVE0=81,a.PLAYER_FIELD_ATTR_RESERVE1=83,a.PLAYER_FIELD_ATTR_RESERVE2=85,a.PLAYER_FIELD_ATTR_RESERVE3=87,a.PLAYER_FIELD_ATTR_RESERVE4=89,a.PLAYER_FIELD_ATTR_RESERVE5=91,a.PLAYER_FIELD_ATTR_RESERVE6=93,a.PLAYER_FIELD_ATTR_RESERVE7=95,a.PLAYER_FIELD_BUFF=97,a.PLAYER_FIELD_BUFF_RESERVE=147,a.PLAYER_INT_FIELD_BUFF_GIVER_UINT_GUID=197,a.PLAYER_INT_FIELD_BUFF_EFFECT_ID_START=247,a.PLAYER_INT_FIELD_BUFF_EFFECT_ID_END=297,a.PLAYER_FIELD_SKIN=297,a.PLAYER_FIELD_BYTES_1=298,a.PLAYER_FIELD_FORCE=299,a.PLAYER_FIELD_EQUIPMENT=301,a.PLAYER_FIELD_CUR_MOUNT=321,a.PLAYER_FIELD_PEACE_MODE_CD=322,a.PLAYER_FIELD_NOTORIETY=323,a.PLAYER_FIELD_BYTES_2=324,a.PLAYER_FIELD_BYTES_3=325,a.PLAYER_FIELD_BYTES_4=326,a.PLAYER_FIELD_BYTES_5=327,a.PLAYER_FIELD_AUTO_HP=328,a.PLAYER_FIELD_AUTO_MP=330,a.PLAYER_FIELD_VIP_LEVEL=332,a.PLAYER_FIELD_VIP_TIME_OUT=333,a.PLAYER_FIELD_HOOK=334,a.PLAYER_FIELD_HOOK_BYTE0=335,a.PLAYER_FIELD_HOOK_BYTE1=336,a.PLAYER_FIELD_HOOK_SHORT=337,a.PLAYER_FIELD_HOOK_BYTE3=338,a.PLAYER_FIELD_FLAGS=339,a.PLAYER_FIELD_FLAGS_END=347,a.PLAYER_FIELD_ONLINE_TIME=347,a.PLAYER_FIELD_ANGER=348,a.PLAYER_FIELD_TRIAL_LAYERS=349,a.PLAYER_INT_FIELD_TRIAL_FINISHED_SECTIONID=350,a.PLAYER_INT_FIELD_TRIAL_PROCESS=351,a.PLAYER_FIELD_DECLINE_CHANNEL_BYTE0=352,a.PLAYER_FIELD_DECLINE_CHANNEL_BYTE1=353,a.PLAYER_SCENED_INT_FIELD_PLAYER_JUMP_CD=354,a.PLAYER_INT_FIELD_SYSTEM_MAIL_ID=355,a.PLAYER_FIELD_DIVINE_NUM=356,a.PLAYER_FIELD_DIVINE_FORCE=357,a.PLAYER_FIELD_MOUNT_FORCE=358,a.PLAYER_FIELD_SKILL_FORCE=359,a.PLAYER_FILED_GEM_FORCE=360,a.PLAYER_FIELD_STRENGTH_FORCE=361,a.PLAYER_FIELD_RANK_LIKE=362,a.PLAYER_FIELD_USE_RANK_LIKE=363,a.PLAYER_FIELD_SHOP_LIMIT_START=364,a.PLAYER_FIELD_SHOP_LIMIT_END=384,a.PLAYER_EXPAND_INT_FCM_LOGIN_TIME=384,a.PLAYER_EXPAND_INT_FCM_LOGOUT_TIME=385,a.PLAYER_EXPAND_INT_CREATE_TIME=386,a.PLAYER_EXPAND_INT_LAST_LOGIN_TIME=387,a.PLAYER_EXPAND_INT_LAST_LOGOUT_TIME=388,a.PLAYER_EXPAND_INT_NUMBER_OF_LOGINS=389,a.PLAYER_EXPAND_INT_MONEY=390,a.PLAYER_EXPAND_INT_MONEY_END=434,a.PLAYER_EXPAND_INT_USE_FASHION=434,a.PLAYER_EXPAND_INT_XP=435,a.PLAYER_EXPAND_INT_NEXT_LEVEL_XP=437,a.PLAYER_EXPAND_INT_XP_ADDED=439,a.PLAYER_EXPAND_INT_XP_PICKED=441,a.PLAYER_EXPAND_INT_MAP_STATUS=443,a.PLAYER_EXPAND_INT_GAG_END_TIME=444,a.PLAYER_EXPAND_INT_TO_MAP=445,a.PLAYER_EXPAND_INT_TO_INSTANCE_ID=446,a.PLAYER_EXPAND_INT_TO_POS_X=447,a.PLAYER_EXPAND_INT_TO_POS_Y=448,a.PLAYER_EXPAND_INT_TO_LINE_NO=449,a.PLAYER_EXPAND_INT_DB_MAP=450,a.PLAYER_EXPAND_INT_DB_POS_X=451,a.PLAYER_EXPAND_INT_DB_POS_Y=452,a.PLAYER_EXPAND_INT_CLIENT_DATA=453,a.PLAYER_APPD_INT_FIELD_FLAG=553,a.PLAYER_APPD_INT_FIELD_FLAG_END=560,a.PLAYER_APPD_INT_FIELD_DAILY_TIME=560,a.PLAYER_APPD_INT_FIELD_RESET_WEEK=561,a.PLAYER_APPD_INT_FIELD_RESET_DALIY=562,a.PLAYER_APPD_INT_FIELD_RECHARGE_SUM=586,a.PLAYER_APPD_INT_FIELD_LAST_RECHARGE_TIME=587,a.PLAYER_APPD_INT_FLELD_JHM_FLAGS=588,a.PLAYER_APPD_INT_FLELD_JHM_FLAGS_END=596,a.PLAYER_APPD_INT_FIELD_EXTENSION_END_TIME=597,a.PLAYER_APPD_INT_FIELD_EXTENSION_REMAIN_TIME=598,a.PLAYER_INT_FIELD_BLOCK_COUNT=600,a.PLAYER_INT_FIELD_WORLD_BOSS_JOIN_ID=601,a.PLAYER_INT_FIELD_WORLD_BOSS_JOIN_STATE=602,a.PLAYER_SCENED_INT_FLAGS=603,a.PLAYER_INT_FIELD_SPELL_START=611,a.PLAYER_INT_FIELD_SPELL_END=623,a.PLAYER_INT_FIELD_IMPORTANT_SPELL_CD_START=623,a.PLAYER_INT_FIELD_IMPORTANT_SPELL_CD_END=663,a.PLAYER_EXPAND_KILL_MONSTER=663,a.PLAYER_APPD_INT_FIELD_KUAFU_WARID=664,a.PLAYER_INT_FIELD_KUAFU_NUMBER=665,a.PLAYER_INT_FIELD_MAIN_QUEST_ID=666,a.PLAYER_INT_FIELD_QUEST_CHAPTER=667,a.PLAYER_INT_FIELD_MOUNT_LEVEL=668,a.PLAYER_INT_FIELD_DIVINE_ID=669,a.PLAYER_INT_FIELD_PASSIVE_SPELL_START=670,a.PLAYER_INT_FIELD_PASSIVE_SPELL_END=770,a.PLAYER_INT_FIELD_VIRTUAL_CAMP=770,a.PLAYER_INT_FIELD_WORLD_3V3_SCORE=771,a.PLAYER_INT_FIELD_WORLD_3V3_TOTAL_SCORE=772,a.PLAYER_INT_FIELD_WORLD_3V3_TREND_INFO=773,a.PLAYER_INT_FIELD_DOUJIANTAI_RANK=774,a.PLAYER_INT_FIELD_DOUJIANTAI_REFRESH_TIME=775,a.PLAYER_INT_FIELD_ARREARS=776,a.PLAYER_INT_FIELD_DAILY_QUEST_FINISHED=778,a.PLAYER_INT_FIELD_BAG_SORT_TIME=779,a.PLAYER_INT_FIELD_OPEN_MENU_INDEX=780,a.PLAYER_INT_FIELD_OPEN_MENU_START=781,a.PLAYER_INT_FIELD_OPEN_MENU_END=881,a.PLAYER_INT_FIELD_BUYED_FACTION_SHOP=882,a.PLAYER_INT_FIELD_BUYED_FACTION_SHOP_END=890,a.PLAYER_INT_FIELD_GUIDE_ID_LAST=891,a.PLAYER_INT_FIELD_GUIDE_ID_NOW=892,a.PLAYER_INT_FIELD_CULTIVATION_LAST_PLUNDER_TIME=893,a.PLAYER_INT_FIELD_CULTIVATION_LAST_REFRESH_TIME=894,a.PLAYER_INT_FIELD_CULTIVATION_TODAY_PLUNDER_EXP=895,a.PLAYER_INT_FIELD_CULTIVATION_TODAY_PLUNDER_CHEST=896,a.PLAYER_INT_FIELD_CULTIVATION_TODAY_PURCHASE_COUNT=897,a.PLAYER_INT_FIELD_CULTIVATION_LEFT_PLUNDER_COUNT=898,a.PLAYER_INT_FIELD_CULTIVATION_PLUNDER_RECORD_INDEX=899,a.PLAYER_INT_FIELD_CULTIVATION_TOTAL_BEEN_PLUNDER_COUNT=900,a.PLAYER_INT_FIELD_CULTIVATION_TODAY_TOTAL_PLUNDER_COUNT=901,a.PLAYER_INT_FIELD_CULTIVATION_START_TIME=902,a.PLAYER_INT_FIELD_CULTIVATION_LOST_INFO=903,a.PLAYER_INT_FIELD_LOGIN_ACTIVITY_TOTAL_DAYS=904,a.PLAYER_INT_FIELD_LOGIN_ACTIVITY_REWARD_STATUS_START=905,a.PLAYER_INT_FIELD_LOGIN_ACTIVITY_REWARD_STATUS_END=907,a.PLAYER_INT_FIELD_OPTIONAL_GUIDE_START=908,a.PLAYER_INT_FIELD_OPTIONAL_GUIDE_END=968,a.PLAYER_INT_FILED_LEAVE_RISK_TIME=968,a.PLAYER_INT_FILED_LEAVE_RISK_SUIT_SCORE=969,a.PLAYER_INT_FILED_FACTION_BUILDING_SPEEDUP_DAILY_COUNT=970,a.PLAYER_INT_FILED_FACTION_DONATE_GIFT_EXCHANGE_DAILY_COUNT=971,a.PLAYER_INT_FILED_CHARM_POINT=972,a.PLAYER_INT_FILED_FACTION_GIFT_NEXT_COUNT_ID=974,a.PLAYER_INT_FILED_FACTION_GIFT_START=975,a.PLAYER_INT_FILED_FACTION_GIFT_END=1725,a.PLAYER_INT_FIELD_CREATE_ICON=1725,a.PLAYER_INT_FIELD_FACTION_GIFT_POINT_COUNT=1726,a.PLAYER_INT_FIELD_FACTION_GIFT_SEND_COUNT=1728,a.PLAYER_INT_FIELD_FACTION_GIFT_BEEN_THANK_COUNT=1729,a.PLAYER_INT_FIELD_MASS_BOSS_BUYED_TIMES=1730,a.PLAYER_INT_FIELD_MASS_BOSS_TIMES=1731,a.PLAYER_INT_FIELD_MASS_BOSS_CD=1732,a.PLAYER_INT_FIELD_TALISMAN_FORCE=1733,a.PLAYER_INT_FIELD_WINGS_FORCE=1734,a.PLAYER_INT_FIELD_GROUP_INSTANCE_CLEAR_FLAG=1735,a.PLAYER_INT_FIELD_MERIDIAN_FORCE=1736,a.PLAYER_INT_FIELD_WINGS_RANK=1737,a.PLAYER_INT_FIELD_FACTION_BOSSDEFENSE_TICKETS=1738,a.PLAYER_INT_FIELD_FACTION_TOWER_CLEAR_FLOOR=1739,a.PLAYER_INT_FIELD_FACTION_TOWER_FLAG=1740,a.PLAYER_INT_FIELD_QUALIFY_SCORE=1741,a.PLAYER_INT_FIELD_FACTION_SKILL_LV_START=1742,a.PLAYER_INT_FIELD_FACTION_SKILL_LV_END=1762,a.PLAYER_INT_FIELD_APPEARANCE=1762,a.PLAYER_INT_FIELD_WEAPON_FORCE=1763,a.PLAYER_INT_FIELD_CLOTH_FORCE=1764,a.PLAYER_INT_FIELD_POKEDEX_FORCE=1765,a.PLAYER_INT_FIELD_TITLE_FORCE=1766,a.PLAYER_INT_FIELD_RENAME_TIMES=1767,a.PLAYER_INT_FIELD_REVENGE_TIMES=1768,a.PLAYER_INT_FIELD_REVENGE_BUY_TIMES=1769,a.PLAYER_INT_FIELD_WINGS_STAR=1770,a.PLAYER_INT_FIELD_VIPGIFT_FLAG=1771,a.PLAYER_APPD_INT_FIELD_CONSUME_SUM=1772,a.PLAYER_APPD_INT_FIELD_MONEYTREE_COUNT=1773,a.PLAYER_APPD_INT_FIELD_MONEYTREE_GIFT_FLAG=1774,a.PLAYER_INT_FIELD_WORLD_RISK_LAST_ID=1775,a.PLAYER_INT_FIELD_LAST_INSTANCE_TYPE=1776,a.PLAYER_INT_FIELD_LAST_INSTANCE_PARAM=1777,a.PLAYER_EXPAND_INT_LAST_IS_RISK=1778,a.PLAYER_INT_FIELD_RESTORE_POTION_CD=1779,a.PLAYER_INT_FIELD_ESCORT_ROB_COUNT=1780,a.PLAYER_INT_FIELD_ADVENTURE_ROBOT_KILL_COUNT=1781,a.PLAYER_INT_FIELD_REALMBREAK_LEVEL=1782,a.PLAYER_INT_FIELD_REALMBREAK_EXP=1783,a.PLAYER_INT_FIELD_REALMBREAK_DAILYQUEST_STATE=1784,a.PLAYER_INT_FIELD_OPERATE_CD=1785,a.PLAYER_INT_FIELD_PASSED_STAGE_INSTANCE_ID=1786,a.PLAYER_STRING_FIELD_ACCOUNT=4,a.PLAYER_STRING_FIELD_TELEPORT_GUID=5,a.PLAYER_APPD_STRING_FIELD_CLIENT_DATA=6,a.PLAYER_STRING_FIELD_LAST_LOGIN_IP=26,a.PLAYER_STRING_FIELD_RECHARGE_ID=27,a.PLAYER_STRING_FIELD_CREATE_LOGIN_IP=28,a.PLAYER_APPD_STRING_FIELD_PINGTAI_INFO=29,a.PLAYER_STRING_FIELD_DB_KUAFU_INFO=30,a.PLAYER_STRING_FIELD_FACTION_GUID=31,a.PLAYER_STRING_FIELD_FACTION_NAME=32,a.PLAYER_STRING_FIELD_BLOCK_START=33,a.PLAYER_STRING_FIELD_BLOCK_END=63,a.PLAYER_STRING_FIELD_RANKLIKE_START=63,a.PLAYER_STRING_FIELD_RANKLIKE_ENE=73,a.PLAYER_STRING_INT_FIELD_CULTIVATION_RIVAL_GUID_START=74,a.PLAYER_STRING_INT_FIELD_CULTIVATION_RIVAL_GUID_END=78,a.PLAYER_STRING_INT_FIELD_CULTIVATION_PLUNDER_RECORD_START=79,a.PLAYER_STRING_INT_FIELD_CULTIVATION_PLUNDER_RECORD_END=89,a.PLAYER_STRING_FIELD_INVITE_FACTION_GUID=89,a.PLAYER_STRING_FIELD_CREATE_FACTION_NAME=90,a.PLAYER_STRING_FILED_FACTION_GIFT_START=91,a.PLAYER_STRING_FILED_FACTION_GIFT_END=691,a.PLAYER_STRING_FIELD_GROUP_PEACE_ID=691,a.PLAYER_BASIC_SPELL_CAPACITY=30,a.PLAYER_DIVINE_SPELL_CAPACITY=15,a.PLAYER_TALISMAN_SPELL_CAPACITY=15,a.SHORT_SPELL_ID=0,a.SHORT_SPELL_LV=1,a.SLOT_COMBO=1,a.SLOT_DIVINE=5,a.SLOT_ANGER=6,a.SPELL_SLOT_COUNT=6,a.SKILL_TYPE_DIVINE=4,a.MOUNT_UPGRADE_SKILL_COUNT=10,a.MOUNT_ILLUSION_COUNT=30,a.EQUIPMENT_COUNT=10,a.DIVINE_PASSIVE_SKILL_COUNT=3,a.EQUIPDEVELOP_GEM_COUNT=10,a.ILLUSION_ATTR_ID=0,a.ILLUSION_ATTR_SPELL_START=1,a.ILLUSION_ATTR_SPELL_END=3,a.ILLUSION_ATTR_EXPIRE=3,a.MAX_ILLUSION_ATTR_COUNT=4,a.EXPIRE_TYPE_ILLUSION=0,a.EXPIRE_TYPE_DIVINE=1,a.STRENGTHEN_LEV_BLESS=0,a.MAX_STRENGTHEN_COUNT=1,a.GEM_LEV=0,a.GEM_CURID_BLESS=3,a.MAX_GEM_COUNT=4,a.DIVINE_ID_LEV_BLESS=0,a.DIVINE_TIME=1,a.DIVINE_SKILL=2,a.DIVINE_PASSIVE_SKILL=3,a.DIVINE_IMPROVE=6,a.MAX_DIVINE_COUNT=7,a.TALISMAN_ID_LV=0,a.TALISMAN_FORCE=1,a.MAX_TALISMAN_COUNT=2,a.EQUIPDEVELOP_STRENGTH_LV=0,a.EQUIPDEVELOP_REFINE_LV=1,a.EQUIPDEVELOP_GEM_LV_START=2,a.EQUIPDEVELOP_GEM_LV_END=7,a.MAX_EQUIPDEVELOP_COUNT=8,a.RAISE_BASE_SKILL=1,a.RAISE_MOUNT_SKILL=2,a.RAISE_ILLUSION_SKILL=3,a.RAISE_DIVINE_SKILL=4,a.EQUIPDEVELOP_TYPE_STRENGTH_LVUP=1,a.EQUIPDEVELOP_TYPE_REFINE_STAR_LVUP=2,a.EQUIPDEVELOP_TYPE_REFINE_RANK_LVUP=3,a.EQUIPDEVELOP_TYPE_GEM_ACTIVE=4,a.EQUIPDEVELOP_TYPE_GEM_LVUP=5,a.EQUIPDEVELOP_TYPE_WASHATTRS_WASH=6,a.EQUIPDEVELOP_TYPE_WASHATTRS_SAVE=7,a.EQUIPDEVELOP_TYPE_WASHATTRS_DEL=8,a.EQUIPDEVELOP_TYPE_STRENGTH_ALL=9,a.MAX_EXTERIOR_COUNT=200,a.PLAYER_ACTIVITTY_DATA_INT_0=0,a.PLAYER_ACTIVITTY_DATA_INT_1=1,a.PLAYER_ACTIVITTY_DATA_INT_2=2,a.PLAYER_ACTIVITTY_DATA_INT_3=3,a.MAX_PLAYERACTIVITTYDATAINT_COUNT=4,a.PLAYER_ACTIVITTY_DATA_STRING_0=0,a.MAX_PLAYERACTIVITTYDATASTRING_COUNT=1,a.MAX_PLAYERDACTIVITTYDATA_COUNT=100,a.SPELL_BASE_COUNT=0,a.SPELL_INT_FIELD_BASE_SPELL_START=1,a.SPELL_INT_FIELD_BASE_SPELL_END=31,a.SPELL_INT_FIELD_MOUNT_LEVEL=31,a.SPELL_INT_FIELD_MOUNT_TRAIN_EXP=32,a.SPELL_INT_FIELD_MOUNT_LEVEL_BASE=33,a.SPELL_INT_FIELD_MOUNT_SPELL_START=34,a.SPELL_INT_FIELD_MOUNT_SPELL_END=44,a.SPELL_INT_FIELD_MOUNT_BLESS_EXP=44,a.SPELL_INT_FIELD_MOUNT_ILLUSION_START=45,a.SPELL_INT_FIELD_MOUNT_ILLUSION_END=165,a.SPELL_STRENGTHEN_START=166,a.SPELL_STRENGTHEN_END=176,a.SPELL_STRENGTHEN_ALLMUL=177,a.SPELL_GEM_START=178,a.SPELL_GEM_END=218,a.SPELL_GEM_ALLMUL=219,a.SPELL_DIVINE_COUNT=220,a.SPELL_DIVINE_START=221,a.SPELL_DIVINE_END=326,a.SPELL_TALISMAN_START=326,a.SPELL_TALISMAN_END=356,a.SPELL_WINGS_ID=356,a.SPELL_WINGS_LEVEL=357,a.SPELL_WINGS_BLESS_EXP=358,a.SPELL_INT_FIELD_MERIDIAN_LEVEL=359,a.SPELL_INT_FIELD_MERIDIAN_EXP=360,a.SPELL_INT_FIELD_MERIDIAN_CNT_START=361,a.SPELL_INT_FIELD_MERIDIAN_CNT_END=411,a.SPELL_INT_FIELD_EQUIPDEVELOP_START=411,a.SPELL_INT_FIELD_EQUIPDEVELOP_END=491,a.SPELL_INT_FIELD_EQUIPDEVELOP_BONUS_LV=491,a.SPELL_INT_FIELD_APPEARANCE_START=492,a.SPELL_INT_FIELD_APPEARANCE_END=692,a.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_START=692,a.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_END=1092,a.SPELL_STRING_FIELD_EQUIPDEVELOP_WASHATTRS_INFO=4,a.SPELL_STRING_FIELD_PLAYER_ACTIVITY_DATA_START=5,a.SPELL_STRING_FIELD_PLAYER_ACTIVITY_DATA_END=105,a.SOCIAL_FRIEND_MAX_NUM=60,a.SOCIAL_APPLY_MAX_NUM=10,a.SOCIAL_ENEMY_MAX_NUM=20,a.SOCIAL_START=4,a.SOCIAL_ICON_VIP_LEV=0,a.SOCIAL_FAMILIAR_LEV_EXP=1,a.SOCIAL_FAMILIAR_FORCE=2,a.MAX_FRIENT_COUNT=4,a.SOCIAL_BASE_COUNT=0,a.SOCIAL_REVENGE_NUM=4,a.SOCIAL_REVENGE_CD=5,a.SOCIAL_FRIEND_START=6,a.SOCIAL_FRIEND_END=246,a.SOCIAL_ENEMY_START=246,a.SOCIAL_ENEMY_END=326,a.SOCIAL_APPLY_START=326,a.SOCIAL_APPLY_END=366,a.SOCIAL_APPLY_CLEAR_FLAG=366,a.SOCIAL_ENEMY_TIME_START=367,a.SOCIAL_ENEMY_TIME_END=387,a.FACTION_EVENT_TYPE_NULL=0,a.FACTION_EVENT_TYPE_ADD_MEMBER=1,a.FACTION_EVENT_TYPE_SUB_MEMBER=2,a.FACTION_EVENT_TYPE_APPOINT=3,a.FACTION_EVENT_TYPE_KICK_MEMBER=4,a.FACTION_EVENT_TYPE_JUANXIAN=5,a.FACTION_EVENT_TYPE_HONGBAO=6,a.FACTION_EVENT_TYPE_SHANGXIANG=7,a.FACTION_MANAGER_TYPE_AGREE_JOIN=0,a.FACTION_MANAGER_TYPE_REFUSE_JOIN=1,a.FACTION_MANAGER_TYPE_KICK=2,a.FACTION_MANAGER_TYPE_APPOINT=3,a.FACTION_MANAGER_TYPE_RECRUIT=4,a.FACTION_MANAGER_TYPE_LEVEL_UP=5,a.FACTION_MANAGER_TYPE_CHANGE_FLAGS=6,a.FACTION_MANAGER_TYPE_NOTICE=7,a.FACTION_MANAGER_TYPE_AGREE_JOIN_ALL=8,a.FACTION_MANAGER_TYPE_REFUSE_JOIN_ALL=9,a.FACTION_MANAGER_TYPE_QUIT=10,a.FACTION_MANAGER_TYPE_JUANXIAN=0,a.FACTION_MANAGER_TYPE_FULI=1,a.FACTION_MANAGER_TYPE_FA_HONGBAO=2,a.FACTION_MANAGER_TYPE_LQ_HONGBAO=3,a.FACTION_MANAGER_TYPE_SHANGXIANG=4,a.FACTION_MANAGER_TYPE_SHOP=5,a.FACTION_MANAGER_TYPE_BUY_TOKEN=6,a.FACTION_MANAGER_TYPE_CHALLENGE_BOSS=7,a.FACTION_MANAGER_TYPE_BUILDING_UPGRADE=8,a.FACTION_MANAGER_TYPE_BUILDING_UPGRADE_SPEEDUP=9,a.FACTION_MANAGER_TYPE_DONATE_GIFT_EXCHANGE=10,a.FACTION_MANAGER_TYPE_GIFT_SHOW_PAGE=11,a.FACTION_MANAGER_TYPE_GIFT_SHOW_INFO=12,a.FACTION_MANAGER_TYPE_GIFT_SHOW_UNTHANK_PAGE=13,a.FACTION_MANAGER_TYPE_GIFT_SHOW_HISTORY_PAGE=14,a.FACTION_MANAGER_TYPE_GIFT_THANK=15,a.FACTION_MANAGER_TYPE_GIFT_THANK_ALL=16,a.FACTION_MANAGER_TYPE_GIFT_THANK_AND_REPLY=17,a.FACTION_MANAGER_TYPE_GIFT_REPLY=18,a.FACTION_MANAGER_TYPE_BOSSDEFENSE_CHALLENGE=19,a.FACTION_MANAGER_TYPE_BOSSDEFENSE_DAMAGE_LIST=20,a.FACTION_MANAGER_TYPE_TOWER_CHALLENGE=21,a.FACTION_MANAGER_TYPE_TOWER_SWEEP=22,a.FACTION_MANAGER_TYPE_TOWER_CHEST=23,a.FACTION_MANAGER_TYPE_SKILL_LVUP=24,a.FACTION_BUILDING_TYPE_MAINHALL=1,a.FACTION_BUILDING_TYPE_STOREHOUSE=2,a.FACTION_BUILDING_TYPE_BANK=3,a.FACTION_BUILDING_TYPE_EVENT=4,a.FACTION_BUILDING_TYPE_SKILL=5,a.FACTION_BUILDING_TYPE_SHOP=6,a.MAX_FACTION_MENBER_BUFF_NUM=6,a.MAX_FACTION_BUFF_NUM=6,a.MAX_CUR_SCREEN_BUFF_NUM=6,a.MAX_FACTION_APLLY_MAMBER_COUNT=3,a.MAX_FACTION_MAMBER_COUNT=50,a.MAX_FACTION_EVENT_COUNT=10,a.MAX_FACTION_SHOP=8,a.MAX_FACTION_HONGBAO_COUNT=10,a.MAX_FACTION_BOSS_COUNT=10,a.MAX_FACTION_BUILDING_COUNT=10,a.FACTION_INT_MEMBER_FORCE=0,a.FACTION_INT_MEMBER_UINT16=2,a.FACTION_INT_MEMBER_BYTE=3,a.FACTION_INT_MEMBER_LOGOUT_TIME=4,a.FACTION_INT_MEMBER_FLAGS=5,a.FACTION_INT_MEMBER_TOTAL_CONTRIBUTION=6,a.FACTION_INT_MEMBER_CHARM=7,a.FACTION_INT_MEMBER_TOTAL_SEND_CHARM=9,a.FACTION_INT_MEMBER_TOWER_TODAY_FLOOR=10,a.MAX_FACTION_INT_MEMBER=11,a.FACTION_STRING_MEMBER_GUID=0,a.FACTION_STRING_MEMBER_NAME=1,a.MAX_FACTION_STRING_MEMBER=2,a.FACTION_INT_EVENT_TYPE_VALUE=0,a.FACTION_INT_EVENT_RESERVE=1,a.MAX_FACTION_INT_EVENT=2,a.FACTION_MEMBER_IDENTITY_NULL=0,a.FACTION_MEMBER_IDENTITY_BANGZHU=1,a.FACTION_MEMBER_IDENTITY_FU_BANGZHU=2,a.FACTION_MEMBER_IDENTITY_TANGZHU=3,a.FACTION_MEMBER_IDENTITY_JINGYING=4,a.FACTION_MEMBER_IDENTITY_QUNZHONG=5,a.FACTION_FLAGS_AUTO=0,a.FACTION_FLAGS_IS_BOSS_ADD=1,a.FACTION_BUFF_ID=0,a.FACTION_BUFF_END_TM=1,a.MAX_FACTION_BUFF=2,a.MAX_GROUP_MEMBER_COUNT=5,a.GROUP_MEMBER_INT_LEVEL=0,a.MAX_GROUP_MEMBER_INFO_INT_COUNT=1,a.GROUP_MEMBER_STR_GUID=0,a.MAX_GROUP_MEMBER_INFO_STR_COUNT=1,a.GROUP_INT_FIELD_MEMBER_INFO_START=0,a.GROUP_INT_FIELD_MEMBER_INFO_END=5,a.GROUP_STR_FIELD_MEMBER_INFO_START=0,a.GROUP_STR_FIELD_MEMBER_INFO_END=5,a.MAX_FACTION_STOREHOUSE_COUNT=100,a.MAX_FACTION_STOREHOUSE_RECORD_COUNT=10,a.FACTION_INT_BOSSDEFENSE_POOL_ID=0,a.FACTION_INT_BOSSDEFENSE_HP=1,a.FACTION_INT_BOSSDEFENSE_MAX_HP=2,a.FACTION_INT_BOSSDEFENSE_STATUS=3,a.MAX_FACTION_BOSSDEFENSE=4,a.MAX_FACTION_BOSSDEFENSE_COUNT=6,a.FACTION_INT_FIELD_PLAYER_NOW_INDEX=0,a.FACTION_INT_FIELD_FLAG=1,a.FACTION_INT_FIELD_PLAYER=2,a.FACTION_INT_FIELD_PLAYER_END=552,a.FACTION_INT_FIELD_APPLY_PLAYER_COUNT_INDEX=552,a.FACTION_INT_FIELD_APPLY_PLAYER=553,a.FACTION_INT_FIELD_APPLY_PLAYER_END=586,a.FACTION_INT_FIELD_EVENT=586,a.FACTION_INT_FIELD_EVENT_END=606,a.FACTION_INT_FIELD_EVENT_FALG=606,a.FACTION_INT_FIELD_SHOP=607,a.FACTION_INT_FIELD_SHOP_END=615,a.FACTION_INT_FIELD_FORCE=615,a.FACTION_INT_FIELD_MONEY=617,a.FACTION_INT_FIELD_LEVEL=619,a.FACTION_INT_FIELD_ACTIVITY=620,a.FACTION_INT_FIELD_RANK=621,a.FACTION_INT_FIELD_FLAGS_ID=622,a.FACTION_INT_FIELD_MINLEV=623,a.FACTION_INT_FIELD_TOKEN_NUM=624,a.FACTION_INT_FIELD_TOKEN_POINTS=625,a.FACTION_INT_FIELD_TOKEN_POINTS_COUNT=626,a.FACTION_INT_FIELD_TOKEN_TODAY_BUY_COUNT=627,a.FACTION_INT_FIELD_CHALLENGE_BOSS_ID_MAX=628,a.FACTION_INT_FIELD_CHALLENGE_BOSS_ID=629,a.FACTION_INT_FIELD_CHALLENGE_BOSS_START_TIME=630,a.FACTION_INT_FIELD_CHALLENGE_BOSS_HP_RATE=631,a.FACTION_INT_FIELD_CHALLENGE_BOSS_POS=632,a.FACTION_INT_FIELD_PROTECT_TARGET_HP_RATE=633,a.FACTION_INT_FIELD_PROTECT_TARGET_POS=634,a.FACTION_INT_FIELD_CHALLENGE_BOSS_DAMAGE_RANK_START=635,a.FACTION_INT_FIELD_CHALLENGE_BOSS_DAMAGE_RANK_END=685,a.FACTION_INT_FIELD_CHALLENGE_BOSS_TOTAL_RANK_START=685,a.FACTION_INT_FIELD_CHALLENGE_BOSS_TOTAL_RANK_END=735,a.FACTION_INT_FIELD_STOREHOUSE_ITEM_COUNT=735,a.FACTION_INT_FIELD_STOREHOUSE_RECORD_CURSOR=736,a.FACTION_INT_FIELD_BUILDING_ID_START=737,a.FACTION_INT_FIELD_BUILDING_ID_END=747,a.FACTION_INT_FIELD_BUILDING_LVUP_ID=747,a.FACTION_INT_FIELD_BUILDING_LVUP_FINISH_TIME=748,a.FACTION_INT_FIELD_IS_DISSOLVED=749,a.FACTION_INT_FIELD_GIFT_WEEK_POINT_START=750,a.FACTION_INT_FIELD_GIFT_WEEK_POINT_END=800,a.FACTION_INT_FIELD_GIFT_UNCHECK_COUNT_START=800,a.FACTION_INT_FIELD_GIFT_UNCHECK_COUNT_END=850,a.FACTION_INT_FIELD_CHARM_POINT=851,a.FACTION_INT_FIELD_GIFT_SEND_COUNT_START=853,a.FACTION_INT_FIELD_GIFT_SEND_COUNT_END=903,a.FACTION_INT_FIELD_GIFT_LAST_SEND_TIME=903,a.FACTION_INT_FIELD_GIFT_QUEEN_UNCHECK_COUNT=905,a.FACTION_INT_FIELD_BOSSDENFENSE_START=906,a.FACTION_INT_FIELD_BOSSDENFENSE_END=930,a.FACTION_INT_FIELD_TOWER_TODAY_TOP_FLOOR=930,a.FACTION_INT_FIELD_TOWER_TODAY_TOP_ICON=931,a.FACTION_INT_FIELD_TOWER_TODAY_TOP_FORCE=932,a.FACTION_INT_FIELD_TOTAL_FORCE=934,a.FACTION_INT_FIELD_MANGER_COAT=936,a.FACTION_INT_FIELD_MANGER_WEAPON=937,a.FACTION_INT_FIELD_MANGER_VIP=938,a.FACTION_INT_FIELD_MANGER_GENDER=939,a.FACTION_INT_FIELD_MANGER_TITLE=940,a.FACTION_INT_FIELD_MANGER_LIKE=941,a.FACTION_INT_FIELD_MANGER_WING=942,a.FACTION_STRING_FIELD_MANGER_NAME=4,a.FACTION_STRING_FIELD_MANGER_GUID=5,a.FACTION_STRING_FIELD_PLAYER=6,a.FACTION_STRING_FIELD_PLAYER_END=106,a.FACTION_STRING_FIELD_APPLY_PLAYER=106,a.FACTION_STRING_FIELD_APPLY_PLAYER_END=112,a.FACTION_STRING_FIELD_EVENT=112,a.FACTION_STRING_FIELD_EVENT_END=122,a.FACTION_STRING_FIELD_GONGGAO=122,a.FACTION_STRING_FIELD_ZHAOMU_GONGGAO=123,a.FACTION_STRING_FIELD_CHALLENGE_BOSS_DAMAGE_RANK_START=124,a.FACTION_STRING_FIELD_CHALLENGE_BOSS_DAMAGE_RANK_END=174,a.FACTION_STRING_FIELD_CHALLENGE_BOSS_TOTAL_RANK_START=174,a.FACTION_STRING_FIELD_CHALLENGE_BOSS_TOTAL_RANK_END=224,a.FACTION_STRING_FIELD_STOREHOUSE_START=224,a.FACTION_STRING_FIELD_STOREHOUSE_END=324,a.FACTION_STRING_FIELD_STOREHOUSE_RECORD_START=324,a.FACTION_STRING_FIELD_STOREHOUSE_RECORD_END=334,a.FACTION_STRING_FIELD_GIFT_PLAYER_GUID_START=334,a.FACTION_STRING_FIELD_GIFT_PLAYER_GUID_END=384,a.FACTION_STRING_FIELD_TOWER_TODAY_TOP_NAME=384,a.FACTION_DATA_INT_FIELD_BOSSDEFENSE_DAMAGE_START=0,a.FACTION_DATA_INT_FIELD_BOSSDEFENSE_DAMAGE_END=300,a.FACTION_DATA_INT_FIELD_GIFT_START=300,a.FACTION_DATA_INT_FIELD_GIFT_TMP1=7500,a.FACTION_DATA_INT_FIELD_GIFT_TOTAL_LEN=37500,a.FACTION_DATA_INT_FIELD_GIFT_TOTAL_CACHE_LEN=5e3,a.FACTION_DATA_INT_FIELD_GIFT_TMP2=37800,
a.FACTION_DATA_INT_FIELD_GIFT_END=42800,a.FACTION_DATA_INT_FIELD_GIFT_RANK_START=42800,a.FACTION_DATA_INT_FIELD_GIFT_RANK_END=50300,a.FACTION_DATA_STRING_FIELD_GIFT_START=4,a.FACTION_DATA_STRING_FIELD_GIFT_TEMP1=7500,a.FACTION_DATA_STRING_FIELD_GIFT_TEMP2=3e4,a.FACTION_DATA_STRING_FIELD_GIFT_TEMP3=4e3,a.FACTION_DATA_STRING_FIELD_GIFT_TEMP4=34e3,a.FACTION_DATA_STRING_FIELD_GIFT_END=34004,a.MAX_TRIAL_LAYER_COUNT=256,a.TRIAL_STATE_FACTOR_ACTIVE=1,a.TRIAL_STATE_FACTOR_PASS=10,a.TRIAL_STATE_FACTOR_F_PASS=100,a.MAX_ACTIVE_COUNT=50,a.MAX_ACTIVT_REWARD_COUNT=6,a.MAX_DOUJIANTAI_RECORD_COUNT=10,a.MAX_QUALIFY_RECORD_COUNT=30,a.MAX_PRIVATE_BOSS_COUNT=20,a.MAX_STAGE_INSTANCE_BONUS_FLAG_COUNT=10,a.INSTANCE_INT_FIELD_VIP_START=0,a.INSTANCE_INT_FIELD_VIP_END=3,a.INSTANCE_INT_FIELD_TRIAL_PASSED_SHORT=3,a.INSTANCE_INT_FIELD_TRIAL_SWEEP_SHORT=4,a.INSTANCE_INT_FIELD_RES_START=5,a.INSTANCE_INT_FIELD_RES_END=10,a.INSTANCE_INT_FIELD_ACTIVE_START=10,a.INSTANCE_INT_FIELD_ACTIVE_END=60,a.INSTANCE_INT_FIELD_ACTIVE=60,a.INSTANCE_INT_FIELD_ACTIVE_REWARD=61,a.INSTANCE_INT_FIELD_3V3_TIMES=62,a.INSTANCE_INT_FIELD_3V3_DAY_REWARD=63,a.INSTANCE_INT_FIELD_3V3_SEGMENT_TIME=64,a.INSTANCE_INT_FIELD_XIANFU_DAY_TIMES=65,a.INSTANCE_INT_FIELD_DOUJIANTAI_CURSOR=66,a.INSTANCE_INT_FIELD_DOUJIANTAI_ENEMY_S=67,a.INSTANCE_INT_FIELD_DOUJIANTAI_ENEMY_E=70,a.INSTANCE_INT_FIELD_DOUJIAN_TIMES=71,a.INSTANCE_INT_FIELD_DOUJIAN_FIGHT_CD=72,a.INSTANCE_INT_FIELD_DOUJIAN_FIRST_GET=73,a.INSTANCE_INT_FIELD_DOUJIAN_FIRST_REWARD=74,a.INSTANCE_INT_FIELD_DOUJIAN_COMBATWIN=75,a.INSTANCE_INT_FIELD_DOUJIAN_COMBATWIN_REWARD=76,a.INSTANCE_INT_FIELD_DOUJIAN_MAX_RANK=77,a.INSTANCE_INT_FIELD_GROUP_INSTANCE_CLEAR_FLAG=78,a.INSTANCE_INT_FIELD_GROUP_INSTANCE_CHALLENGE_COUNT=79,a.INSTANCE_INT_FIELD_GROUP_INSTANCE_BUY_COUNT=80,a.INSTANCE_INT_FIELD_QUALIFY_EXTRA=81,a.INSTANCE_INT_FIELD_QUALIFY_WINS=82,a.INSTANCE_INT_FIELD_QUALIFY_EXTRA_PICKED=83,a.INSTANCE_INT_FIELD_QUALIFY_DAILY_TIMES=84,a.INSTANCE_INT_FIELD_QUALIFY_BUY_TIMES=85,a.INSTANCE_INT_FIELD_QUALIFY_CURSOR=86,a.INSTANCE_INT_FIELD_PRIVATE_BOSS_RECOVER_TIME_START=87,a.INSTANCE_INT_FIELD_PRIVATE_BOSS_RECOVER_TIME_END=107,a.INSTANCE_INT_FIELD_STAGE_INSTANCE_BONUS_FLAG_START=108,a.INSTANCE_INT_FIELD_STAGE_INSTANCE_BONUS_FLAG_END=118,a.INSTANCE_STR_FIELD_DOUJIANTAI_RECORD_START=4,a.INSTANCE_STR_FIELD_DOUJIANTAI_RECORD_END=14,a.INSTANCE_STR_FIELD_QUALIFY_RECORD_START=14,a.INSTANCE_STR_FIELD_QUALIFY_RECORD_END=44,a.PEACE_MODE=0,a.FAMILY_MODE=1,a.GROUP_MODE=2,a.MAX_BATTLE_MODE=3,a.TYPE_SPELL_SLOT=0,a.TYPE_SPELL_PASSIVE=1,a.SPELL_SUPPORT=0,a.SPELL_INITIATIVE_DAMAGE=1,a.SPELL_INITIATIVE_PROTECT=2,a.SPELL_INITIATIVE_CONTROL=3,a.SPELL_INITIATIVE_CURE=4,a.SPELL_INITIATIVE_BUFF=5,a.SPELL_PASSIVE_DAMAGE=6,a.SPELL_PASSIVE_PROTECT=7,a.SPELL_PASSIVE_CONTROL=8,a.SPELL_PASSIVE_CURE=9,a.SPELL_PASSIVE_BUFF=10,a.GAME_CONFIG_FIELD_FLAGS_SHOW_PLATFORM_NAME=0,a.GAME_CONFIG_FIELD_FLAGS_SHOW_SERVER_ID=1,a.GAME_CONFIG_FIELD_FLAGS_SHOW_POST=2,a.GAME_CONFIG_INT_FIELD_KAIFUSHIJIAN=0,a.GAME_CONFIG_INT_FIELD_FLAGS=1,a.GAME_CONFIG_INT_FIELD_ADDTIME=9,a.GAME_CONFIG_INT_FIELD_WORLD_SVR_TYPE=10,a.GAME_CONFIG_STRING_FIELD_PLATFORM_ID=4,a.GAME_CONFIG_STRING_FIELD_GM_QQ=5,a.GAME_CONFIG_STRING_FIELD_DB_CONN=6,a.GAME_CONFIG_STRING_FIELD_LOGIN_KEY=7,a.GAME_CONFIG_STRING_FIELD_LOG_DB_CONN=8,a.GAME_CONFIG_STRING_LOCAL_HDD_PATH=9,a.GAME_CONFIG_STRING_EXT_WEB_INTERFACE=10,a.GAME_CONFIG_STRING_CONF_SVR_URL=11,a.GAME_CONFIG_STRING_WORLD_SERVER_URL=12,a.GAME_CONFIG_STRING_FIELD_SERVER=200,a.GAME_CONFIG_STRING_FIELD_SERVER_LIST_BEGIN=201,a.CLIENT_MODULE_CENTER=0,a.CLIENT_MODULE_CREATE=1,a.CLIENT_MODULE_SCENE=2,a.CLIENT_MODULE_UI=3,a.CLIENT_MODULE_SH=4,a.MAX_CLIENT_MODULE=5,a.CLIENT_VERSION_INT_CREATE_TIME=0,a.MAX_CLIENT_VERSION_INT=1,a.CLIENT_VERSION_STRING_VERSIONS=0,a.CLIENT_VERSION_STRING_COMMENT=1,a.MAX_CLIENT_VERSION_STRING=2,a.CLIENT_CONFIG_INT_FIELD_MODULE_INFO_BEGIN=0,a.CLIENT_CONFIG_INT_FIELD_MODULE_INFO_END=5,a.CLIENT_CONFIG_STRING_FIELD_MODULE_INFO_BEGIN=4,a.CLIENT_CONFIG_STRING_FIELD_MODULE_INFO_END=14,a.MAX_DEFAULT_LINE_COUNT=4,a.MAX_FIELD_BOSS_COUNT=40,a.FIELD_BOSS_PROCESS_TYPE_FINISH=0,a.FIELD_BOSS_PROCESS_START_COUNTDOWN=1,a.FIELD_BOSS_PROCESS_BORN=2,a.FIELD_BOSS_PROCESS_TREASURE=3,a.FIELD_BOSS_DATA_NEXT_BORN_TIME=0,a.FIELD_BOSS_DATA_CURR_HP=1,a.FIELD_BOSS_DATA_PROCESS_TYPE=3,a.FIELD_BOSS_DATA_PRIORITY_TIME=4,a.FIELD_BOSS_DATA_KILLED=5,a.MAX_FIELD_BOSS_INT_DATA_COUNT=6,a.FIELD_BOSS_DATA_MAX_DAMAGE_GUID=0,a.FIELD_BOSS_DATA_NAME=1,a.MAX_FIELD_BOSS_STR_DATA_COUNT=2,a.WORLD_BOSS_PROCESS_TYPE_FINISH=0,a.WORLD_BOSS_PROCESS_ENROLL=1,a.WORLD_BOSS_PROCESS_BORN=2,a.PLAYER_WORLD_BOSS_NONE=0,a.PLAYER_WORLD_BOSS_ENROLLED=1,a.PLAYER_WORLD_BOSS_ENTERED=2,a.MASS_BOSS_STATE=0,a.MASS_BOSS_TIME=1,a.MAX_MASS_BOSS_INT_FIELD_COUNT=2,a.MAX_XIANFU_RECORD_COUNT=10,a.MAX_MASS_BOSS_COUNT=30,a.MAX_LOTTERY_COUNT=10,a.MAX_LOTTERY_RECORD_COUNT=10,a.MAX_ACT_RANK_COUNT=10,a.MAX_ACT_RANK_INFO_COUNT=10,a.GLOBALVALUE_INT_FIELD_FLAGS=0,a.GLOBALVALUE_INT_FIELD_LIMIT_ACTIVITY_VERSION=8,a.GLOBALVALUE_INT_FIELD_LIMIT_ACTIVITY_END_TIME=9,a.GLOBALVALUE_INT_FIELD_LIMIT_ACTIVITY_ITEM=10,a.GLOBALVALUE_INT_FIELD_LIMIT_ACTIVITY_ITEM_END=40,a.GLOBALVALUE_INT_FIELD_ONLINE_PLAYER_NUM=40,a.GLOBALVALUE_INT_FIELD_WORLD_CONNECTION_STATUS=41,a.GLOBALVALUE_INT_FIELD_FIELD_BOSS_START=42,a.GLOBALVALUE_INT_FIELD_FIELD_BOSS_END=282,a.GLOBALVALUE_INT_FIELD_WORLD_BOSS_LEVEL=282,a.GLOBALVALUE_INT_FIELD_WORLD_BOSS_STATE=283,a.GLOBALVALUE_INT_FIELD_WORLD_BOSS_LINE_STATE=284,a.GLOBALVALUE_INT_FIELD_WORLD_BOSS_LAST_ENROLL_TIME=285,a.GLOBALVALUE_INT_FIELD_WORLD_BOSS_TIMES=286,a.GLOBALVALUE_INT_FIELD_WORLD_BOSS_ID=287,a.GLOBALVALUE_INT_FIELD_XIANFU_RECORD_CURSOR=288,a.GLOBALVALUE_INT_FIELD_GIFT_RANK_WINER_FACTION_FLAG=289,a.GLOBALVALUE_INT_FIELD_GIFT_RANK_NEXT_UPDATE_TIME=290,a.GLOBALVALUE_INT_FIELD_GIFT_RANK_CUR_ROUND=291,a.GLOBALVALUE_INT_FIELD_MASS_BOSS_START=292,a.GLOBALVALUE_INT_FIELD_MASS_BOSS_END=352,a.GLOBALVALUE_INT_FIELD_LOTTERY_RECORD_CURSOR_START=352,a.GLOBALVALUE_INT_FIELD_LOTTERY_RECORD_CURSOR_END=362,a.GLOBALVALUE_INT_FIELD_ACTIVITIES_RUNNING_START=362,a.GLOBALVALUE_INT_FIELD_ACTIVITIES_RUNNING_END=392,a.GLOBALVALUE_STRING_FIELD_LIMIT_ACTIVITY_SCRIPT=4,a.GLOBALVALUE_STRING_FIELD_FIELD_BOSS_START=5,a.GLOBALVALUE_STRING_FIELD_FIELD_BOSS_END=85,a.GLOBALVALUE_STRING_FIELD_XIANFU_RECORD_START=85,a.GLOBALVALUE_STRING_FIELD_XIANFU_RECORD_END=95,a.GLOBALVALUE_STRING_FIELD_GIFT_RANK_WINER_QUEEN_NAME=95,a.GLOBALVALUE_STRING_FIELD_GIFT_RANK_WINER_FACTION_NAME=96,a.GLOBALVALUE_STRING_FIELD_GIFT_RANK_WINER_GUARD_NAME=97,a.GLOBALVALUE_STRING_FIELD_LOTTERY_RECORD_START=98,a.GLOBALVALUE_STRING_FIELD_LOTTERY_RECORD_END=198,a.MAX_DOUJIANTAI_RANK_COUNT=1e3,a.MAX_RISK_RANK_COUNT=10,a.MAX_RISK_RANK_SWAPED_COUNT=11,a.RISK_RANK_INFO_SECTION_ID=0,a.RISK_RANK_INFO_TIME=1,a.MAX_RISK_RANK_INFO_COUNT=2,a.GLOBALCOUNTER_INT_FIELD_DOUJIANTAI_FLAG_START=0,a.GLOBALCOUNTER_INT_FIELD_DOUJIANTAI_FLAG_END=40,a.GLOBALCOUNTER_INT_FIELD_ACTIVITIES_FINISH_START=40,a.GLOBALCOUNTER_INT_FIELD_ACTIVITIES_FINISH_END=240,a.GLOBALCOUNTER_INT_FIELD_ACT_RANK_INFO_START=240,a.GLOBALCOUNTER_INT_FIELD_ACT_RANK_INFO_END=340,a.GLOBALCOUNTER_INT_FIELD_RISK_RANK_INFO_START=340,a.GLOBALCOUNTER_INT_FIELD_RISK_RANK_INFO_END=362,a.GLOBALCOUNTER_STRING_FIELD_DOUJIANTAI_START=4,a.GLOBALCOUNTER_STRING_FIELD_DOUJIANTAI_END=1004,a.GLOBALCOUNTER_STRING_FIELD_DOUJIANTAI_RECORD_START=1004,a.GLOBALCOUNTER_STRING_FIELD_DOUJIANTAI_RECORD_END=11004,a.GLOBALCOUNTER_STRING_FIELD_ACT_RANK_INFO_START=11004,a.GLOBALCOUNTER_STRING_FIELD_ACT_RANK_INFO_END=11104,a.GLOBALCOUNTER_STRING_FIELD_RISK_RANK_NAME_START=11104,a.GLOBALCOUNTER_STRING_FIELD_RISK_RANK_NAME_END=11115,a.GLOBALCOUNTER_INT_FIELD_ONLINE_AWARD_COUNT=0,a.GLOBALCOUNTER_INT_FIELD_DAILY_ADD_BIND_GOLD=2,a.GLOBALCOUNTER_INT_FIELD_DAILY_SUB_BIND_GOLD=4,a.GLOBALCOUNTER_INT_FIELD_DAILY_ADD_GOLD_INGOT=6,a.GLOBALCOUNTER_INT_FIELD_DAILY_SUB_GOLD_INGOT=8,a.GLOBALCOUNTER_INT_FIELD_DAILY_ADD_SILVER=10,a.GLOBALCOUNTER_INT_FIELD_DAILY_SUB_SILVER=12,a.MAX_GLOBALCOUNTER_INT_FIELD=13,a.MAP_TYPE_MAIN=0,a.MAP_TYPE_FIELD=1,a.MAP_TYPE_INSTANCE=2,a.MAP_TYPE_ACTIVITY=3,a.MAP_TYPE_PVP=4,a.INSTANCE_QUEST_TYPE_KILL_MONSTER=1,a.INSTANCE_QUEST_TYPE_PICK_ITEM=2,a.INSTANCE_QUEST_TYPE_ACTIVE_MACHINE=3,a.INSTANCE_QUEST_TYPE_PROTECT_NPC=4,a.INSTANCE_QUEST_TYPE_ESCORT_NPC=5,a.INSTANCE_QUEST_TYPE_DEFENSE=6,a.INSTANCE_QUEST_TYPE_BREAK_THROUGH=7,a.MAX_INSTANCE_QUEST_COUNT=12,a.MAP_INT_FIELD_MAP_ID=0,a.MAP_INT_FIELD_INSTANCE_ID=1,a.MAP_INT_FIELD_LINE_NO=2,a.MAP_INT_FIELD_WARID=2,a.MAP_INT_FIELD_KUAFU_TYPE=3,a.MAP_INT_FIELD_STATE=4,a.MAP_INT_FIELD_KILL_NUM=5,a.MAP_INT_FIELD_RESERVE1=6,a.MAP_INT_FIELD_RESERVE2=7,a.MAP_INT_FIELD_RESERVE3=8,a.MAP_INT_FIELD_RESERVE4=9,a.MAP_INT_FIELD_INSTANCE_WAVE=10,a.MAP_INT_FIELD_QUESTS_START=11,a.MAP_INT_FIELD_QUESTS_END=35,a.MAP_INT_FIELD_QUESTS_PROCESS_START=35,a.MAP_INT_FIELD_QUESTS_PROCESS_END=38,a.MAP_INT_FIELD_CREATE_TM=38,a.MAP_INT_FIELD_START_TM=39,a.MAP_INT_FIELD_QUEST_END_TM=40,a.MAP_INT_FIELD_END_TM=41,a.MAP_INT_FIELD_INSTANCE_TYPE=42,a.MAP_STR_GENERAL_ID=4,a.MAP_STR_REWARD=5,a.REFRESH_MONSTER_FIELD_ID=46,a.REFRESH_MONSTER_FIELD_INFO_START=47,a.KUAFU_3V3_PLAYER_DAMAGE=0,a.KUAFU_3V3_PLAYER_SHOW_INFO=2,a.KUAFU_3V3_PLAYER_SETTLEMENT=3,a.KUAFU_3V3_PLAYER_HONOR=4,a.MAX_KUAFU_3V3_INT_COUNT=5,a.KUAFU_3V3_PLAYER_NAME=0,a.KUAFU_3V3_PLAYER_GUID=1,a.MAX_KUAFU_3V3_STR_COUNT=2,a.MAX_KUAFU_3V3_COUNT=6,a.KUAFU_3V3_FIELDS_INT_INFO_START=43,a.KUAFU_3V3_FIELDS_INT_INFO_END=73,a.KUAFU_3V3_FIELDS_STR_INFO_START=6,a.KUAFU_3V3_FIELDS_STR_INFO_END=18,a.KUAFU_XIANFU_PLAYER_SETTLEMENT=0,a.KUAFU_XIANFU_PLAYER_MONEY=2,a.KUAFU_XIANFU_PLAYER_MONEY_CHANGED=4,a.KUAFU_XIANFU_PLAYER_SHOW_INFO=6,a.MAX_KUAFU_XIANFU_INT_COUNT=7,a.KUAFU_XIANFU_PLAYER_NAME=0,a.KUAFU_XIANFU_PLAYER_GUID=1,a.MAX_KUAFU_XIANFU_STR_COUNT=2,a.KUAFU_XIANFU_BOSS_SHOW_INFO=0,a.KUAFU_XIANFU_BOSS_BORN_INFO=1,a.KUAFU_XIANFU_BOSS_BORN_TIME=2,a.MAX_KUAFU_XIANFU_BOSS_INT_COUNT=3,a.MAX_KUAFU_XIANFU_COUNT=10,a.MAX_KUAFU_XIANFU_BOSS_COUNT=5,a.KUAFU_XIANFU_FIELDS_INT_INFO_START=43,a.KUAFU_XIANFU_FIELDS_INT_INFO_END=113,a.KUAFU_XIANFU_FIELDS_INT_BOSS_INDX=113,a.KUAFU_XIANFU_FIELDS_INT_BOSS_INFO_START=114,a.KUAFU_XIANFU_FIELDS_INT_BOSS_INFO_END=129,a.KUAFU_XIANFU_FIELDS_HARD=129,a.XIANFU_TEST_DUMMY_COUNT=130,a.KUAFU_XIANFU_FIELDS_STR_INFO_START=6,a.KUAFU_XIANFU_FIELDS_STR_INFO_END=26,a.KUAFU_GROUP_INSTANCE_PLAYER_DAED_TIMES=0,a.KUAFU_GROUP_INSTANCE_PLAYER_REBRON_CD=1,a.MAX_KUAFU_GROUP_INSTANCE_PLAYER_INT_COUNT=2,a.KUAFU_GROUP_INSTANCE_PLAYER_NAME=0,a.KUAFU_GROUP_INSTANCE_PLAYER_GUID=1,a.KUAFU_GROUP_INSTANCE_PLAYER_REWARDS=2,a.MAX_KUAFU_GROUP_INSTANCE_PLAYER_STR_COUNT=3,a.MAX_GROUP_INSTANCE_PLAYER_COUNT=3,a.KUAFU_GROUP_INSTANCE_FIELDS_HARD=43,a.KUAFU_GROUP_INSTANCE_FIELDS_PART=44,a.KUAFU_GROUP_INSTANCE_INT_FIELDS_PLAYER_INFO_START=45,a.KUAFU_GROUP_INSTANCE_INT_FIELDS_PLAYER_INFO_END=51,a.KUAFU_GROUP_INSTANCE_STR_FIELDS_PLAYER_INFO_START=45,a.KUAFU_GROUP_INSTANCE_STR_FIELDS_PLAYER_INFO_END=54,a.DOUJIANTAI_FIELDS_INT_RANK=43,a.DOUJIANTAI_FIELDS_INT_COMBAT_WIN_INFO=44,a.XIULIANCHANG_FIELDS_INT_RANK=43,a.XIULIANCHANG_FIELDS_INT_ROBOT_ID=44,a.XIULIANCHANG_FIELDS_INT_LEVEL=45,a.XIULIANCHANG_FIELDS_STR_INFO_GUID=6,a.XIULIANCHANG_FIELDS_STR_INFO_CONTENT=7,a.XIULIANCHANG_FIELDS_STR_INFO_NAME=8,a.VIP_INSTANCE_FIELD_ID=43,a.MAP_MASS_BOSS_INT_FIELD_ID=43,a.MAP_MASS_BOSS_INT_FIELD_MAX_HP=44,a.MAP_PRIVATE_BOSS_INT_FIELD_ID=43,a.MAP_PRIVATE_BOSS_INT_FIELD_BUFFEFFECT_ID=44,a.WORLDBOSS_FIELDS_WAIT_TIME=43,a.WORLDBOSS_FIELDS_BORN_TIME=44,a.RES_INSTANCE_FIELD_ID=43,a.STAGE_INSTANCE_BUFF_ID=44,a.TRIAL_INSTANCE_FIELD_CURSOR=43,a.TRIAL_INSTANCE_FIELD_SECTION_ID=44,a.TRIAL_INSTANCE_FIELD_ORDER=45,a.TRIAL_INSTANCE_FIELD_BOSS_REFRESHED=47,a.TRIAL_INSTANCE_FIELD_LAST_RANDOM_TIMESTAMP=48,a.FACTION_INSTANCE_FIELD_GUID=6,a.FACTION_BOSSDEFENSE_INSTANCE_FIELD_BUILDING_LV=43,a.FACTION_BOSSDEFENSE_INSTANCE_FIELD_INDEX=44,a.FACTION_BOSSDEFENSE_INSTANCE_FIELD_POOL_ID=45,a.FACTION_BOSSDEFENSE_INSTANCE_FIELD_HP=46,a.FACTION_BOSSDEFENSE_INSTANCE_FIELD_PLAYER_GUID=6,a.FACTION_BOSSDEFENSE_INSTANCE_FIELD_FACTION_GUID=7,a.FACTION_TOWER_INSTANCE_FIELD_FLOOR=43,a.FACTION_TOWER_INSTANCE_FIELD_BUFF=44,a.FACTION_TOWER_INSTANCE_FIELD_DEBUFF=45,a.FACTION_TOWER_INSTANCE_FIELD_MONSTER_NUM=46,a.TRIAL_INSTANCE_FIELD_ID=43,a.TAOHUA_REFRESH_TIMES=10,a.TAOHUA_INT_FIELD_REFRESH_TIMES=43,a.TAOHUA_INT_FIELD_BOSS_CURR_HP=44,a.TAOHUA_STR_FIELD_REAL_BOSS_GUID=5,a.TOWER_MAX_FLOOR=2,a.TAGUAI_INT_FIELD_FIRST_FLOOR=43,a.FIGHTING_INFO_STRING_CASTER=0,a.FIGHTING_INFO_STRING_TARGET=1,a.MAX_FIGHTING_INFO_STRING=2,a.MAX_FIGHTING_INFO_COUNT=100,a.FIGHTING_INFO_INT_VALUES=0,a.FIGHTING_INFO_INT_UINT8=2,a.FIGHTING_INFO_INT_SPELL_ID=3,a.FIGHTING_INFO_INT_HP=4,a.FIGHTING_INFO_INT_RESERVE_0=5,a.FIGHTING_INFO_INT_RESERVE_1=6,a.FIGHTING_INFO_INT_RESERVE_2=7,a.FIGHTING_INFO_INT_RESERVE_3=8,a.MAX_FIGHTING_INFO_INT=9,a.MAX_FIGHTING_INFO_INT_NOW_INDEX=0,a.MAX_FIGHTING_INFO_INT_START=1,a.MAX_FIGHTING_INFO_INT_FIELD=901,a.FIGHTING_INFO_STRING_FIELD_START=4,a.MAX_FIGHTING_INFO_STRING_FIELD=204,a.QUERY_PLAYER_INT_UINT16=0,a.QUERY_PLAYER_INT_BYTE1=1,a.QUERY_PLAYER_INT_BYTE2=2,a.QUERY_PLAYER_INT_BASE_ATTR_START=3,a.QUERY_PLAYER_INT_BASE_ATTR_END=21,a.QUERY_PLAYER_INT_FIXED_ATTR_START=21,a.QUERY_PLAYER_INT_FIXED_ATTR_END=39,a.QUERY_PLAYER_INT_LUCKY=39,a.QUERY_PLAYER_INT_MEILI=41,a.QUERY_PLAYER_INT_BEAR=43,a.QUERY_PLAYER_INT_POISON=45,a.QUERY_PLAYER_INT_ICE=47,a.QUERY_PLAYER_MOVESPEED=49,a.QUERY_PLAYER_PHYSICAL=51,a.QUERY_PLAYER_INT_FORCE=53,a.QUERY_PLAYER_ONLINE_TIME=55,a.QUERY_PLAYER_INT_EQUIPMENT=56,a.QUERY_PLAYER_INT_EQUIPMENT_END=76,a.QUERY_PLAYER_INT_FLAG=76,a.QUERY_PLAYER_INT_FORCE_LEVEL=77,a.QUERY_PLAYER_INT_FORCE_ITEM=79,a.QUERY_PLAYER_INT_FORCE_FACTION=81,a.QUERY_PLAYER_INT_FLAG_TYPE=83,a.QUERY_PLAYER_INT_FORGING_STRENG=84,a.QUERY_PLAYER_STRING_GUID=4,a.QUERY_PLAYER_STRING_NAME=5,a.QUERY_PLAYER_STRING_FACTION_ID=6,a.QUERY_PLAYER_STRING_FACTION_NAME=7,a.MAX_QUERY_PLAYER_STRING_FIELD=8,a.ITEM_QUERY_INT_FIELD_COUNT=0,a.ITEM_QUERY_STR_FIELD_START=4,a.GIFTPACKS_INFO_INT_ID=0,a.GIFTPACKS_INFO_INT_START_TIME=1,a.GIFTPACKS_INFO_INT_END_TIME=2,a.GIFTPACKS_INFO_INT_BYTE=3,a.MAX_GIFTPACKS_INFO_INT=4,a.GIFTPACKS_INFO_STRING_GIFT_NAME=0,a.GIFTPACKS_INFO_STRING_GIFT_DESC=1,a.GIFTPACKS_INFO_STRING_GIFT_FROM=2,a.GIFTPACKS_INFO_STRING_GIFT_ITEM=3,a.MAX_GIFTPACKS_INFO_STRING=4,a.MAX_GIFTPACKS_INFO_COUNT=100,a.MAX_GIFTPACKS_INFO_INT_NOW_INDEX=0,a.GIFTPACKS_INT_FIELD_BEGIN=1,a.MAX_GIFTPACKS_INT_FIELD=401,a.GIFTPACKS_STRING_FIELD_BEGIN=4,a.MAX_GIFTPACKS_STRING_FIELD=404,a.RANK_TYPE_POWER=0,a.RANK_TYPE_LEVEL=1,a.RANK_TYPE_MONEY=2,a.RANK_TYPE_ONLINE_TIME=3,a.RANK_TYPE_TRIAL=4,a.RANK_TYPE_FACTION=5,a.RANK_TYPE_DIVINE=6,a.RANK_TYPE_MOUNT=7,a.RANK_TYPE_SINGLE_PVP=8,a.RANK_TYPE_WINGS=9,a.MAX_RANK_TYPE=10,a.RANK_TYPE_DOUJIANTAI=11,a.RANK_LIST_MAX_VALUES=100,a.RANK_LIST_MAX_SHOW=4,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_TYPE=0,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_RANKING=1,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE=2,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE2=3,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_TITLE=4,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_FORCE=5,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_LEVEL=7,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_MONEY=8,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_ONLINE_TIME=10,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_TRIAL=11,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_SHOW=12,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_SHOW_END=16,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_LIKE=17,a.RANK_LIST_CURRENT_OBJ_INT_FIELD_WING=18,a.RANK_LIST_CURRENT_OBJ_STR_FIELD_GUID=4,a.RANK_LIST_CURRENT_OBJ_STR_FIELD_PLAYER_GUID=5,a.RANK_LIST_CURRENT_OBJ_STR_FIELD_PLAYER_NAME=6,a.RANK_LIST_CURRENT_OBJ_STR_FIELD_FACTION_NAME=7,a.RANK_LIST_INT_FIELD_FACTION_LEV=2,a.RANK_LIST_INT_FIELD_FACTION_COUNT=3,a.RANK_LIST_INT_FIELD_FACTION_BYTE=4,a.RANK_LIST_STR_FIELD_FACTION_GUID=4,a.RANK_LIST_STR_FIELD_FACTION_NAME=5,a.RANK_LIST_STR_FIELD_FACTION_SQGG=6,a.ITEM_SHOW_TYPE_DEFAULT=0,a.ITEM_SHOW_TYPE_MINI_QUEST_BAR=1,a.ITEM_SHOW_TYPE_MINI_QUEST_DAILY2=2,a.RIGHTFLOAT_INFO_INT_ID=0,a.RIGHTFLOAT_INFO_INT_START_TIME=1,a.RIGHTFLOAT_INFO_INT_END_TIME=2,a.RIGHTFLOAT_INFO_INT_ZONE_1=3,a.RIGHTFLOAT_INFO_INT_ZONE_2=4,a.RIGHTFLOAT_INFO_INT_ZONE_3=5,a.RIGHTFLOAT_INFO_INT_BYTE=6,a.RIGHTFLOAT_INFO_INT_ADD_TIME=7,a.MAX_RIGHTFLOAT_INFO_INT=8,a.RIGHTFLOAT_INFO_STRING_SUBJECT=0,a.RIGHTFLOAT_INFO_STRING_CONTENT=1,a.RIGHTFLOAT_INFO_STRING_LINK=2,a.MAX_RIGHTFLOAT_INFO_STRING=3,a.MAX_RIGHTFLOAT_INFO_COUNT=100,a.MAX_RIGHTFLOAT_INFO_INT_NOW_INDEX=0,a.RIGHTFLOAT_INT_FIELD_START=1,a.MAX_RIGHTFLOAT_INT_FIELD=801,a.RIGHTFLOAT_STRING_FIELD_START=4,a.MAX_RIGHTFLOAT_STRING_FIELD=304,a.LIMIT_ACTIVITY_INT_FIELD_VERSION=0,a.LIMIT_ACTIVITY_INT_FIELD_START_TIME=1,a.LIMIT_ACTIVITY_INT_FIELD_END_TIME=2,a.LIMIT_ACTIVITY_INT_FIELD_RECHARGE_SUM=3,a.LIMIT_ACTIVITY_INT_FIELD_RECHARGE_TIME=4,a.LIMIT_ACTIVITY_INT_FIELD_REWARD_COUNT=100,a.LIMIT_ACTIVITY_INT_FIELD_REWARD_COUNT_END=500,a.LIMIT_ACTIVITY_STRING_FIELD_RECHARGE_ID=4,a.LIMIT_ACTIVITY_STRING_FIELD_CLIENT_CONFIG=5,a.MAX_NOTICE_MESSAGE_NUMBER=100,a.NOTICE_MESSAGE_INFO_TYPE_FISHING=0,a.NOTICE_MESSAGE_INFO_TYPE_MINING=1,a.NOTICE_MESSAGE_INFO_TYPE_WORLD_BOSS=2,a.NOTICE_MESSAGE_INFO_TYPE_KAIFUJIJIN=3,a.MAX_MESSAGE_INFO_TYPE=4,a.NOTICE_MESSAGE_INT_FIELD_INDEX=0,a.NOTICE_MESSAGE_INT_FIELD_INDEX_END=4,a.NOTICE_MESSAGE_STRING_FIELD_START=4,a.NOTICH_MESSAGE_STRING_FIELD_END=404,a.SYSTEM_MAIL_INFO_INT_ID=0,a.SYSTEM_MAIL_INFO_INT_START_TIME=1,a.SYSTEM_MAIL_INFO_INT_END_TIME=2,a.SYSTEM_MAIL_INFO_INT_TYPE=3,a.MAX_SYSTEM_MAIL_INFO_INT=4,a.SYSTEM_MAIL_INFO_STRING_NAME=0,a.SYSTEM_MAIL_INFO_STRING_DESC=1,a.SYSTEM_MAIL_INFO_STRING_FROM=2,a.SYSTEM_MAIL_INFO_STRING_ITEM=3,a.MAX_SYSTEM_MAIL_INFO_STRING=4,a.MAX_SYSTEM_MAIL_INFO_COUNT=8192,a.SYSTEM_MAIL_COUNT=0,a.MAX_SYSTEM_MAIL_INFO_INT_NOW_INDEX=1,a.SYSTEM_MAIL_INT_FIELD_BEGIN=2,a.SYSTEM_MAIL_INT_FIELD_END=32770,a.SYSTEM_MAIL_STRING_FIELD_BEGIN=4,a.SYSTEM_MAIL_STRING_FIELD_END=32772,a.MAX_OFFLINE_MAIL_INFO_COUNT=16384,a.OFFLINE_MAIL_STORE_RANK_LEVEL=0,a.MAX_OFFLINE_MAIL_STORE_COUNT=1,a.HOSTING_OPT_TYPE_APPLY=0,a.HOSTING_OPT_TYPE_AGREED=1,a.HOSTING_OPT_TYPE_CANCEL=2,a.HOSTING_OPT_TYPE_LOGIN=3,a.HOSTING_OPT_TYPE_REFUSE=4,a.HOSTING_OPT_TYPE_DUE_TO=5,a.HOSTING_OPT_TYPE_APPLY_DUE_TO=6,a.MAX_EQUIP_PART_NUMBER=10,a.ONE_EQUIP_PART_GEM_NUMBER=6,a.EQUIP_PART_OPT_TYPE_STRENGTH_LEVEL_OFFSET=0,a.EQUIP_PART_OPT_TYPE_GEM_INFO_OFFSET=1,a.EQUIP_PART_OPT_TYPE_GEM_LEVEL_OFFSET=0,a.EQUIP_PART_OPT_TYPE_GEM_EXP_OFFSET=1,a.EQUIP_PART_OPT_TYPE_ONE_GEM_INFO_LENGTH=2,a.EQUIP_PART_OPT_TYPE_ONE_PART_INFO_LENGTH=13,a.EQUIP_PART_OPT_TYPE_PARTS_INFO_LENGTH=130,a.APPD_LOGICAL_INFO_INT_FIELD_STRENGTH_START=0,a.APPD_LOGICAL_INFO_INT_FIELD_STRENGTH_END_EXCLUDE=130,a.TEXT_TYPE_POSITION=1,a.TEXT_TYPE_SUIT=2,a.TEXT_TYPE_GROUP=3,a.TEXT_TYPE_INSTANCE=4,a.PASSIVE_EFFECT_TYPE_SPELL_AMPLIFY=1,a.PASSIVE_EFFECT_TYPE_ADD_BUFF=2,a.PASSIVE_EFFECT_TYPE_CHANGE_SPELL=3,a.PASSIVE_EFFECT_TYPE_PLAYER_ATTR=4,a.PASSIVE_EFFECT_TYPE_ADDITIONAL_SPELL=5,a.PASSIVE_EFFECT_TYPE_PLAYER_LOOT_ATTR=6,a.PASSIVE_DISPATCH_TYPE_FOREVER=0,a.PASSIVE_DISPATCH_TYPE_ATTR_CHANGE=1,a.PASSIVE_DISPATCH_TYPE_HIT=2,a.PASSIVE_DISPATCH_TYPE_HURT=3,a.PASSIVE_DISPATCH_TYPE_DEAD=4,a.PASSIVE_DISPATCH_TYPE_ENEMY_DEAD=5,a.PASSIVE_DISPATCH_TYPE_ON_BUFF=6,a.PASSIVE_DISPATCH_TYPE_ENEMY_ON_BUFF=7,a.MODULE_SETTING=101,a.MODULE_BAG=102,a.MODULE_RONGLIAN=103,a.MODULE_QUEST=104,a.MODULE_DAILY_TASKS=105,a.MODULE_CHAT=106,a.MODULE_MAIL=107,a.MODULE_MAP=108,a.MODULE_STRENGTH=109,a.MODULE_CHATPERSON=110,a.MODULE_ACTIVE=111,a.MODULE_MONEYTREE=112,a.MODULE_FISH=113,a.MODULE_REALM=115,a.MODULE_ROLE=201,a.MODULE_SPELL=202,a.MODULE_DIVINE=203,a.MODULE_FASHION=204,a.MODULE_MOUNT=205,a.MODULE_MIX=206,a.MODULE_WING=207,a.MODULE_TCM=208,a.MODULE_GW=209,a.MODULE_SOCIAL=301,a.MODULE_FACTION=302,a.MODULE_RANK=303,a.MODULE_FACTIONMAIN=304,a.MODULE_FACTIONSKILL=305,a.MODULE_FACTIONACTIVE=306,a.MODULE_FACTIONBOX=307,a.MODULE_MALL=401,a.MODULE_VIP=402,a.MODULE_INSTANCE=501,a.MODULE_WORLD_RISK=502,a.MODULE_ARENA=503,a.MODULE_BOSS=504,a.MODULE_EXP=505,a.MODULE_WELFARE=601,a.MODULE_OPENSERVICE=701,a.MODULE_FIRST_RECHARGE=801,a.MODULE_TEST=1001,a.MODULE_SETTING_SYSTEM=1,a.MODULE_BAG_ITEM=1,a.MODULE_RONGLIAN_ALL=1,a.MODULE_QUEST_MAIN=1,a.MODULE_QUEST_EXTENSION=2,a.MODULE_QUEST_ACTIVITY=3,a.MODULE_DAILY_TASKS_ALL=1,a.MODULE_CHAT_ALL=1,a.MODULE_MAIL_ALL=1,a.MODULE_MAP_REGION=1,a.MODULE_MAP_WORLD=2,a.MODULE_STRENGTH_ALL=1,a.MODULE_CHATPERSON_ALL=1,a.MODULE_ACTIVE_ALL=1,a.MODULE_MONEYTREE_ALL=1,a.MODULE_FISH_ALL=1,a.MODULE_REALM_ALL=1,a.MODULE_ROLE_ATTR=1,a.MODULE_ROLE_ACHIEVE=2,a.MODULE_ROLE_TITLE=3,a.MODULE_SPELL_ALL=1,a.MODULE_DIVINE_ALL=1,a.MODULE_FASHION_CLOTHES=1,a.MODULE_FASHION_WEAPON=2,a.MODULE_MOUNT_UPGRADE=1,a.MODULE_MOUNT_LEVEL=2,a.MODULE_MOUNT_SKILL=3,a.MODULE_MOUNT_ILLUSION=4,a.MODULE_MIX_STRENGTH=1,a.MODULE_MIX_POLISHED=2,a.MODULE_MIX_GEM=3,a.MODULE_MIX_WASH=4,a.MODULE_WING_UPGRADE=1,a.MODULE_WING_STRENGTH=2,a.MODULE_TCM_ALL=1,a.MODULE_GW_ALL=1,a.MODULE_SOCIAL_FRIEND=1,a.MODULE_SOCIAL_ENEMY=2,a.MODULE_FACTION_RECRUIT=1,a.MODULE_FACTION_CREATE=2,a.MODULE_FACTION_MEMBER=3,a.MODULE_FACTION_FUNCTION=4,a.MODULE_RANK_LOCAL=1,a.MODULE_RANK_KUAFU=2,a.MODULE_FACTIONMAIN_ALL=1,a.MODULE_FACTIONSKILL_ALL=1,a.MODULE_FACTIONACTIVE_TRIAL=1,a.MODULE_FACTIONACTIVE_BOSS=2,a.MODULE_FACTIONBOX_DEVOTE=1,a.MODULE_FACTIONBOX_ITEM=2,a.MODULE_MALL_GOLD=1,a.MODULE_MALL_SCORE=2,a.MODULE_MALL_RECHARGE=3,a.MODULE_VIP_ALL=1,a.MODULE_INSTANCE_PLOT=1,a.MODULE_INSTANCE_RES=2,a.MODULE_INSTANCE_TRIAL=3,a.MODULE_INSTANCE_TEAM=4,a.MODULE_WORLD_RISK_MAIN=1,a.MODULE_ARENA_DOUJIANTAI=1,a.MODULE_ARENA_XIANMO=2,a.MODULE_ARENA_XIANFU=3,a.MODULE_ARENA_RANK=4,a.MODULE_BOSS_PERSON_BOSS=1,a.MODULE_BOSS_RISK_BOSS=2,a.MODULE_BOSS_WORLD_BOSS=3,a.MODULE_EXP_QUEST=1,a.MODULE_EXP_ARTIFACT=2,a.MODULE_WELFARE_MONTH=1,a.MODULE_WELFARE_LEVEL=2,a.MODULE_WELFARE_SEVEN=3,a.MODULE_WELFARE_RECHARGE=4,a.MODULE_WELFARE_CONSUME=5,a.MODULE_OPENSERVICE_SEVEN=1,a.MODULE_OPENSERVICE_DRAW=2,a.MODULE_OPENSERVICE_EVERYDAY=3,a.MODULE_OPENSERVICE_NEW=4,a.MODULE_FIRST_RECHARGE_ALL=1,a.MODULE_TEST_WORLD=1,a.MODULE_TEST_REGION=2,a.MODULE_TEST_RISK=3,a.MERIDIAN_EXP_SOURCE_GROUP_INSTANCE=1,a.MERIDIAN_EXP_SOURCE_TALISMAN_ZHULING=2,a.MERIDIAN_EXP_SOURCE_WINGS_STRENGTH=3,a.VITALITY_TYPE_SMELT_EQUIP=1,a.VITALITY_TYPE_RES_INSTANCE=2,a.VITALITY_TYPE_TRIAL_INSTANCE=3,a.VITALITY_TYPE_GROUP_INSTANCE=4,a.VITALITY_TYPE_MASS_BOSS=5,a.VITALITY_TYPE_WORLD_BOSS=6,a.VITALITY_TYPE_FACTION_BOSS=7,a.VITALITY_TYPE_FACTION_TOWER=8,a.VITALITY_TYPE_FACTION_DONATE=9,a.VITALITY_TYPE_DOUJIANTAI=10,a.VITALITY_TYPE_SINGLE_PVP=11,a.VITALITY_TYPE_PRIVATE_BOSS=12,a.VITALITY_TYPE_SHOP_BUY=13,a.VITALITY_TYPE_RANK_LIKE=14,a.VITALITY_TYPE_DAILY_QUEST=15,a.VITALITY_TYPE_EQUIPDEVELOP_STRENGTH=16,a.VITALITY_TYPE_EQUIPDEVELOP_REFINE=17,a.VITALITY_TYPE_EQUIPDEVELOP_WASHATTR=18,a.VITALITY_TYPE_WINGS_BLESS=19,a.VITALITY_TYPE_WINGS_STRENGTH=20,a.VITALITY_TYPE_MOUNT_BLESS=21,a.VITALITY_TYPE_MOUNT_STRENGTH=22,a.VITALITY_TYPE_MOUNT_SKILLUP=23,a.VITALITY_TYPE_TALISMAN_UPGRADE=24,a.VITALITY_TYPE_ADVENTURE_QUEST=25,a.VITALITY_TYPE_PLAYER_SKILLUP=26,a.VITALITY_TYPE_ADVENTURE_SKILLUP=27,a.ADVENTURE_UNLOCK_LIMIT_WORLDRISK=1,a.ADVENTURE_UNLOCK_LIMIT_KILLMONSTER=2,a.ADVENTURE_UNLOCK_LIMIT_FORCE=3,a.ADVENTURE_UNLOCK_LIMIT_LEVEL=4,a.ADVENTURE_UNLOCK_LIMIT_WING=5,a.ADVENTURE_UNLOCK_LIMIT_MOUNT=6,a}(),NetManager=function(){function a(){var a=this;this.connectState=0,this._handlerMap=new Object,this.protocolos=new Protocols(function(b){a.send(b)})}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.connect=function(a,b,c){var d=this;this._socket=new WebSocket("ws://"+a+":"+b),this._socket.binaryType="arraybuffer",this._socket.onopen=function(a){d.onopenEvent(a)},this._socket.onmessage=function(a){d.onmessageEvent(a)},this._socket.onclose=function(a){d.oncloseEvent(a)},this._socket.onerror=function(a){d.onErrorEvent(a)},this._connetFun=c,this.connectState=1},a.prototype.onErrorEvent=function(a){console.log("socket error",a),this.connectState=0},a.prototype.onopenEvent=function(a){console.log("连接服务器成功"),this._connetFun(),this.connectState=2},a.prototype.onmessageEvent=function(a){var b=new ByteArray(a.data);b.endian=Endian.LITTLE_ENDIAN;var c=b.readUnsignedShort();this._handlerMap[c]?this._handlerMap[c](b):console.log("未注册的消息号:"+c+":"+this.protocolos.getFuncName(c))},a.prototype.oncloseEvent=function(a){this.connectState=2,console.log("服务器断开")},a.prototype.reg=function(a){var b=a.getHanderMap();for(var c in b)this._handlerMap[c]=b[c]},a.prototype.unReg=function(a){delete this._handlerMap[a]},a.prototype.send=function(a){this._socket.send(a.buffer)},a.prototype.close=function(){this._socket.close()},a}(),DualQuatFloat32Array=function(){function a(){}return a}(),AnimData=function(){function a(){this.inLoop=0,this.inter=new Array,this.bounds=new Array,this.nameHeight=0,this.posAry=new Array,this.hasProcess=!1}return a.prototype.processMesh=function(a){if(this.hasProcess)return void console.log("has process logic error");for(var b=0;b<this.matrixAry.length;b++)for(var c=this.matrixAry[b],d=0;d<c.length;d++)c[d].prepend(a.bindPosMatrixAry[d]);this.makeFrameDualQuatFloatArray(a),this.hasProcess=!0},a.prototype.makeFrameDualQuatFloatArray=function(a){this.boneQPAry=new Array;for(var b=new Matrix3D,c=0;c<a.meshAry.length;c++){for(var d=new Array,e=a.meshAry[c].boneNewIDAry,f=0;f<this.matrixAry.length;f++){var g=this.matrixAry[f],h=new DualQuatFloat32Array;h.quat=new Float32Array(4*e.length),h.pos=new Float32Array(3*e.length);for(var i=0;i<e.length;i++){var j=g[e[i]].clone(b);j.appendScale(-1,1,1);var k=new Quaternion;k.fromMatrix(j);var l=j.position;h.quat[4*i+0]=k.x,h.quat[4*i+1]=k.y,h.quat[4*i+2]=k.z,h.quat[4*i+3]=k.w,h.pos[3*i+0]=l.x,h.pos[3*i+1]=l.y,h.pos[3*i+2]=l.z}d.push(h)}this.boneQPAry.push(d)}},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkinMesh=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.meshAry=new Array,b.fileScale=1,b.tittleHeight=0,b.hitBox=new Vector2D(0,0),b.type=0,b.animDic=new Object,b.ready=!1,b}return __extends(b,a),b.prototype.makeHitBoxItem=function(){this.hitPosItem=new Array;var a=this.hitBox.x,b=this.hitBox.y,c=new Vector3D(-a,0,-a),d=new Vector3D(a,0,-a),e=new Vector3D(a,0,a),f=new Vector3D(-a,0,a);this.hitPosItem.push(c),this.hitPosItem.push(d),this.hitPosItem.push(e),this.hitPosItem.push(f);var g=new Vector3D(-a,b,-a),h=new Vector3D(a,b,-a),i=new Vector3D(a,b,a),j=new Vector3D(-a,b,a);this.hitPosItem.push(g),this.hitPosItem.push(h),this.hitPosItem.push(i),this.hitPosItem.push(j)},b.prototype.addMesh=function(a){a.uid=this.meshAry.length,this.meshAry.push(a)},b.prototype.loadParticle=function(){},b.prototype.loadMaterial=function(a){void 0===a&&(a=null);for(var b=0;b<this.meshAry.length;b++)this.loadByteMeshDataMaterial(this.meshAry[b],a)},b.prototype.loadByteMeshDataMaterial=function(a,b){void 0===b&&(b=null);var c=Scene_data.fileRoot+a.materialUrl;c=c.replace("_byte.txt",".txt"),c=c.replace(".txt","_byte.txt"),MaterialManager.getInstance().getMaterialByte(c,function(c){a.material=c,c.usePbr?MeshDataManager.getInstance().uploadPbrMesh(a,c.useNormal):(c.lightProbe||c.directLight)&&MeshDataManager.getInstance().uploadPbrMesh(a,!1),a.materialParamData&&(a.materialParam=new MaterialBaseParam,a.materialParam.setData(a.material,a.materialParamData)),b&&b(c)},null,!0,MaterialAnimShader.MATERIAL_ANIM_SHADER,MaterialAnimShader)},b.prototype.setAction=function(a,b){this.animUrlAry=new Array;for(var c=0;c<a.length;c++){var d=a[c],e=b+a[c],f=AnimManager.getInstance().getAnimDataImmediate(e);f.processMesh(this),this.animDic[d]=f,this.animUrlAry.push(e)}},b.prototype.destory=function(){if(this.allParticleDic){for(var a in this.allParticleDic)ParticleManager.getInstance().releaseUrl(a);this.allParticleDic=null}for(var b=0;b<this.meshAry.length;b++)this.meshAry[b].destory();this.meshAry.length=0,this.meshAry=null,this.bindPosMatrixAry.length=0,this.bindPosMatrixAry=null,this.bindPosInvertMatrixAry.length=0,this.bindPosInvertMatrixAry=null,this.boneSocketDic=null;for(var b=0;b<this.animUrlAry.length;b++)AnimManager.getInstance().clearAnim(this.animUrlAry[b]);for(var a in this.animDic)delete this.animDic[a];this.animDic=null},b}(ResCount),BoneSocketData=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),CollisionVo=function(a){function b(b,c,d){return void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),a.call(this)||this}return __extends(b,a),b}(Object3D),CollisionItemVo=function(){function a(){}return a}(),CollisionType=function(){function a(){}return a.Polygon=0,a.BOX=1,a.BALL=2,a.Cylinder=3,a.Cone=4,a}(),CapsuleVo=function(){function a(a,b){this.radius=a,this.height=b}return a}(),LightVo=function(){function a(){this.sunDirect=new Array(0,1,0),this.sunColor=new Array(2,0,0),this.ambientColor=new Array(0,0,0)}return a.prototype.setData=function(a,b,c){this.sunDirect[0]=a.x,this.sunDirect[1]=a.y,this.sunDirect[2]=a.z,this.sunColor[0]=b.x,this.sunColor[1]=b.y,this.sunColor[2]=b.z,this.ambientColor[0]=c.x,this.ambientColor[1]=c.y,this.ambientColor[2]=c.z},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),LineDisplayShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Position"),a.bindAttribLocation(this.program,1,"v3Color")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Position;attribute vec3 v3Color;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec4 colorData;void main(void){   vec4 vt0= vec4(v3Position, 1.0);   colorData =vec4(v3Color,1) ;   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nvarying vec4 colorData;\nvoid main(void)\n{\ngl_FragColor =colorData;\n}";return a},b.LineShader="LineShader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),LineDisplaySprite=function(a){function b(){var b=a.call(this)||this;return b.baseColor=new Vector3D(1,0,0),b.objData=new ObjData,b.shader=ProgrmaManager.getInstance().getProgram(LineDisplayShader.LineShader),b.program=b.shader.program,b.makeLineMode(new Vector3D(0,0,0),new Vector3D(100,0,0),new Vector3D),b.makeLineMode(new Vector3D(0,0,0),new Vector3D(100,0,100),new Vector3D),b.makeLineMode(new Vector3D(100,0,0),new Vector3D(100,0,100),new Vector3D),b.upToGpu(),b}return __extends(b,a),b.prototype.makeLineMode=function(a,b,c){void 0===c&&(c=null),this.lineVecPos&&this.lineIndex||this.clear(),c&&(this.baseColor=c),this.lineVecPos.push(a.x,a.y,a.z),this.lineVecPos.push(b.x,b.y,b.z),this.lineColor.push(this.baseColor.x,this.baseColor.y,this.baseColor.z),this.lineColor.push(this.baseColor.x,this.baseColor.y,this.baseColor.z),this.lineIndex.push(this.lineIndex.length+0,this.lineIndex.length+1)},b.prototype.clear=function(){this.lineVecPos=new Array,this.lineIndex=new Array,this.lineColor=new Array,
this.objData.indexBuffer&&(this.objData.indexBuffer=null)},b.prototype.upToGpu=function(){this.lineIndex.length&&(console.log("A星长度",this.lineIndex.length),this.objData.treNum=this.lineIndex.length,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.lineVecPos),this.objData.normalsBuffer=Scene_data.context3D.uploadBuff3D(this.lineColor),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.lineIndex))},b.prototype.update=function(){this.objData&&this.objData.indexBuffer&&(Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",Scene_data.viewMatrx3D.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",Scene_data.cam3D.cameraMatrix.m),Scene_data.context3D.setVcMatrix4fv(this.shader,"posMatrix3D",this.posMatrix.m),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,3,this.objData.normalsBuffer),Scene_data.context3D.drawLine(this.objData.indexBuffer,this.objData.treNum))},b}(Display3D),MulLineSprite=function(a){function b(){var b=a.call(this)||this;return b.itemSprite||(b.itemSprite=new Array),b}return __extends(b,a),b.prototype.makeLineMode=function(b,c,d){void 0===d&&(d=null),a.prototype.makeLineMode.call(this,b,c,d);var e=this.getSprite();e.makeLineMode(b,c,d)},b.prototype.getSprite=function(){var a=Math.floor(this.lineIndex.length/1e4);if(!this.itemSprite[a]){var b=new LineDisplaySprite;b.clear(),b.baseColor=this.baseColor,this.itemSprite.push(b)}return this.itemSprite[a]},b.prototype.update=function(){for(var a=0;a<this.itemSprite.length;a++)this.itemSprite[a].posMatrix=this.posMatrix,this.itemSprite[a].update()},b.prototype.upToGpu=function(){for(var a=0;a<this.itemSprite.length;a++)this.itemSprite[a].upToGpu()},b.prototype.clear=function(){a.prototype.clear.call(this),this.itemSprite||(this.itemSprite=new Array);for(var b=0;this.itemSprite&&b<this.itemSprite.length;b++)this.itemSprite[b].clear()},b}(LineDisplaySprite),GridLineSprite=function(a){function b(){var b=a.call(this)||this;return b.makeGridData(),b}return __extends(b,a),b.prototype.makeGridData=function(){var a=100,b=10,c=a/b;this.clear();var d,e;d=new Vector3D(0,0,+a),e=new Vector3D(0,0,-a),this.makeLineMode(d,e,new Vector3D(0,0,1,1)),d=new Vector3D(+a,0,0),e=new Vector3D(-a,0,0),this.makeLineMode(d,e,new Vector3D(1,0,0,1)),this.baseColor=new Vector3D(128/255,128/255,128/255,1);for(var f=1;b>=f;f++)d=new Vector3D(+f*c,0,+a),e=new Vector3D(+f*c,0,-a),this.makeLineMode(d,e),d=new Vector3D(-f*c,0,+a),e=new Vector3D(-f*c,0,-a),this.makeLineMode(d,e),d=new Vector3D(+a,0,+f*c),e=new Vector3D(-a,0,+f*c),this.makeLineMode(d,e),d=new Vector3D(+a,0,-f*c),e=new Vector3D(-a,0,-f*c),this.makeLineMode(d,e);this.upToGpu()},b}(LineDisplaySprite),FpsMc=function(){function a(){this.drawNum=0,this.fpsStr=""}return a.update=function(){},a.prototype.getStr=function(){return a.fpsNowNum=Math.min(this.drawNum,600),this.fpsStr="Fps:"+String(a.fpsNowNum)+"-"+a.tipStr,this.fpsStr},a.addFps=0,a.fpsNowNum=0,a.tipStr="",a}(),FpsStage=function(){function a(){this.lastTime=0,this.cPos=new Vector2D(150,100)}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.init=function(a,b){var c=this;this.canvas2D=a,this.loadCav=b,this.fps=new FpsMc,this.canvasUi=this.canvas2D.getContext("2d"),this.loadCtx=this.loadCav.getContext("2d"),TimeUtil.addFrameTick(function(){c.upData()})},a.prototype.showLoadInfo=function(a){this.loadCtx.clearRect(0,0,this.loadCav.width,this.loadCav.height),this.loadCtx.font="40px Helvetica",this.loadCtx.fillStyle="#ffffff",this.loadCtx.textBaseline="top",this.loadCtx.textAlign="left",this.loadCtx.fillText(a,0,0)},a.prototype.removeShowLoad=function(){this.loadCav.parentElement&&this.loadCav.parentElement.removeChild(this.loadCav),a.showFps=!0},a.prototype.upData=function(){if(this.fps.drawNum++,!(this.lastTime>=TimeUtil.getTimer()-1e3)){if(this.lastTime=TimeUtil.getTimer(),!a.showFps)return void this.canvasUi.clearRect(0,0,this.canvas2D.width,this.canvas2D.height);this.canvasUi.font="40px Helvetica";var b=this.canvasUi.measureText(this.fps.getStr()).width;this.canvas2D.width=b,this.canvas2D.height=30,this.canvasUi.clearRect(50,0,this.canvas2D.width-50,this.canvas2D.height),this.canvasUi.fillStyle="#000000",this.canvasUi.fillRect(50,0,this.canvas2D.width-50,this.canvas2D.height),this.canvasUi.font="30px Helvetica",this.canvasUi.fillStyle="#ffffff",this.canvasUi.textBaseline=TextAlign.TOP,this.canvasUi.textAlign=TextAlign.LEFT,this.canvasUi.fillText(this.fps.getStr(),50,0),this.fps.drawNum=0}},a.prototype.makeXyzLine=function(){var a=new Vector3D(80,0,0),b=new Vector3D(0,70,0),c=new Vector3D(0,0,80),d=new Matrix3D;d.appendRotation(Scene_data.cam3D.rotationY,Vector3D.Y_AXIS),d.appendRotation(Scene_data.cam3D.rotationX,Vector3D.X_AXIS),a=d.transformVector(a),b=d.transformVector(b),c=d.transformVector(c),this.drawLine(new Vector2D(0,0),new Vector2D(a.x,-a.y),"#ff0000"),this.drawLine(new Vector2D(0,0),new Vector2D(b.x,-b.y),"#00ff00"),this.drawLine(new Vector2D(0,0),new Vector2D(c.x,-c.y),"#0000ff"),this.canvasUi.font="12px Helvetica",this.canvasUi.fillStyle="#ff0000",this.canvasUi.fillText("x",a.x+this.cPos.x,-a.y+this.cPos.y),this.canvasUi.fillStyle="#00ff00",this.canvasUi.fillText("y",b.x+this.cPos.x,-b.y+this.cPos.y),this.canvasUi.fillStyle="#0000ff",this.canvasUi.fillText("z",c.x+this.cPos.x,-c.y+this.cPos.y)},a.prototype.drawLine=function(a,b,c){void 0===c&&(c="red"),this.canvasUi.beginPath(),this.canvasUi.lineWidth=2,this.canvasUi.strokeStyle=c,this.canvasUi.moveTo(a.x+this.cPos.x,a.y+this.cPos.y),this.canvasUi.lineTo(b.x+this.cPos.x,b.y+this.cPos.y),this.canvasUi.stroke()},a.prototype.resetSize=function(){this.cPos=new Vector2D(150,Scene_data.stageHeight-100)},a.showFps=!1,a}(),Module=function(){function a(){this.processorMap=new Object}return a.prototype.getModuleName=function(){throw new Error("module必须复写命名")},a.prototype.listProcessors=function(){return null},a.prototype.registerProcessors=function(){var a=this.listProcessors();if(null!=a&&a.length>0)for(var b=0;b<a.length;b++)this.registerProcessor(a[b])},a.prototype.registerProcessor=function(a){if(null!=this.processorMap[a.getName()])throw new Error("同一Module不能注册两个相同的Processor");this.processorMap[a.getName()]=a,a.registerEvents(),NetManager.getInstance().reg(a)},a.registerModule=function(b){if(null!=a.moduleMap[b.getModuleName()])throw new Error("不能注册两个相同的Module");a.moduleMap[b.getModuleName()]=b,b.registerProcessors()},a.moduleMap=new Object,a}(),ModuleEventManager=function(){function a(){}return a.addEvents=function(b,c,d){for(var e=0;e<b.length;e++)a._instance.addEventListener(b[e].type,c,d)},a.dispatchEvent=function(b){a._instance.dispatchEvent(b)},a._instance=new EventDispatcher,a}(),Processor=function(){function a(){}return a.prototype.getName=function(){throw new Error("process必须复写命名")},a.prototype.receivedModuleEvent=function(a){},a.prototype.listenModuleEvents=function(){return null},a.prototype.registerEvents=function(){var a=this.listenModuleEvents();null!=a&&a.length>0&&ModuleEventManager.addEvents(a,this.receivedModuleEvent,this)},a.prototype.getHanderMap=function(){var a=new Object;return a},a}();!function(a,b){"use strict";var c=a.GreenSockGlobals=a.GreenSockGlobals||a;if(!c.TweenLite){var d,e,f,g,h,i=function(a){var b,d=a.split("."),e=c;for(b=0;d.length>b;b++)e[d[b]]=e=e[d[b]]||{};return e},j=i("com.greensock"),k=1e-10,l=function(a){var b,c=[],d=a.length;for(b=0;b!==d;c.push(a[b++]));return c},m=function(){},n=function(){var a=Object.prototype.toString,b=a.call([]);return function(c){return null!=c&&(c instanceof Array||"object"==typeof c&&!!c.push&&a.call(c)===b)}}(),o={},p=function(d,e,f,g){this.sc=o[d]?o[d].sc:[],o[d]=this,this.gsClass=null,this.func=f;var h=[];this.check=function(j){for(var k,l,m,n,q=e.length,r=q;--q>-1;)(k=o[e[q]]||new p(e[q],[])).gsClass?(h[q]=k.gsClass,r--):j&&k.sc.push(this);if(0===r&&f)for(l=("com.greensock."+d).split("."),m=l.pop(),n=i(l.join("."))[m]=this.gsClass=f.apply(f,h),g&&(c[m]=n,"function"==typeof define&&define.amd?define((a.GreenSockAMDPath?a.GreenSockAMDPath+"/":"")+d.split(".").pop(),[],function(){return n}):d===b&&"undefined"!=typeof module&&module.exports&&(module.exports=n)),q=0;this.sc.length>q;q++)this.sc[q].check()},this.check(!0)},q=a._gsDefine=function(a,b,c,d){return new p(a,b,c,d)},r=j._class=function(a,b,c){return b=b||function(){},q(a,[],function(){return b},c),b};q.globals=c;var s=[0,0,1,1],t=[],u=r("easing.Ease",function(a,b,c,d){this._func=a,this._type=c||0,this._power=d||0,this._params=b?s.concat(b):s},!0),v=u.map={},w=u.register=function(a,b,c,d){for(var e,f,g,h,i=b.split(","),k=i.length,l=(c||"easeIn,easeOut,easeInOut").split(",");--k>-1;)for(f=i[k],e=d?r("easing."+f,null,!0):j.easing[f]||{},g=l.length;--g>-1;)h=l[g],v[f+"."+h]=v[h+f]=e[h]=a.getRatio?a:a[h]||new a};for(f=u.prototype,f._calcEnd=!1,f.getRatio=function(a){if(this._func)return this._params[0]=a,this._func.apply(null,this._params);var b=this._type,c=this._power,d=1===b?1-a:2===b?a:.5>a?2*a:2*(1-a);return 1===c?d*=d:2===c?d*=d*d:3===c?d*=d*d*d:4===c&&(d*=d*d*d*d),1===b?1-d:2===b?d:.5>a?d/2:1-d/2},d=["Linear","Quad","Cubic","Quart","Quint,Strong"],e=d.length;--e>-1;)f=d[e]+",Power"+e,w(new u(null,null,1,e),f,"easeOut",!0),w(new u(null,null,2,e),f,"easeIn"+(0===e?",easeNone":"")),w(new u(null,null,3,e),f,"easeInOut");v.linear=j.easing.Linear.easeIn,v.swing=j.easing.Quad.easeInOut;var x=r("events.EventDispatcher",function(a){this._listeners={},this._eventTarget=a||this});f=x.prototype,f.addEventListener=function(a,b,c,d,e){e=e||0;var f,i,j=this._listeners[a],k=0;for(null==j&&(this._listeners[a]=j=[]),i=j.length;--i>-1;)f=j[i],f.c===b&&f.s===c?j.splice(i,1):0===k&&e>f.pr&&(k=i+1);j.splice(k,0,{c:b,s:c,up:d,pr:e}),this!==g||h||g.wake()},f.removeEventListener=function(a,b){var c,d=this._listeners[a];if(d)for(c=d.length;--c>-1;)if(d[c].c===b)return void d.splice(c,1)},f.dispatchEvent=function(a){var b,c,d,e=this._listeners[a];if(e)for(b=e.length,c=this._eventTarget;--b>-1;)d=e[b],d&&(d.up?d.c.call(d.s||c,{type:a,target:c}):d.c.call(d.s||c))};var y=a.requestAnimationFrame,z=a.cancelAnimationFrame,A=Date.now||function(){return(new Date).getTime()},B=A();for(d=["ms","moz","webkit","o"],e=d.length;--e>-1&&!y;)y=a[d[e]+"RequestAnimationFrame"],z=a[d[e]+"CancelAnimationFrame"]||a[d[e]+"CancelRequestAnimationFrame"];r("Ticker",function(a,b){var c,d,e,f,i,j=this,l=A(),n=b!==!1&&y,o=500,p=33,q="tick",r=function(a){var b,g,h=A()-B;h>o&&(l+=h-p),B+=h,j.time=(B-l)/1e3,b=j.time-i,(!c||b>0||a===!0)&&(j.frame++,i+=b+(b>=f?.004:f-b),g=!0),a!==!0&&(e=d(r)),g&&j.dispatchEvent(q)};x.call(j),j.time=j.frame=0,j.tick=function(){r(!0)},j.lagSmoothing=function(a,b){o=a||1/k,p=Math.min(b,o,0)},j.sleep=function(){null!=e&&(n&&z?z(e):clearTimeout(e),d=m,e=null,j===g&&(h=!1))},j.wake=function(){null!==e?j.sleep():j.frame>10&&(B=A()-o+5),d=0===c?m:n&&y?y:function(a){return setTimeout(a,0|1e3*(i-j.time)+1)},j===g&&(h=!0),r(2)},j.fps=function(a){return arguments.length?(c=a,f=1/(c||60),i=this.time+f,void j.wake()):c},j.useRAF=function(a){return arguments.length?(j.sleep(),n=a,void j.fps(c)):n},j.fps(a),setTimeout(function(){n&&(!e||5>j.frame)&&j.useRAF(!1)},1500)}),f=j.Ticker.prototype=new j.events.EventDispatcher,f.constructor=j.Ticker;var C=r("core.Animation",function(a,b){if(this.vars=b=b||{},this._duration=this._totalDuration=a||0,this._delay=Number(b.delay)||0,this._timeScale=1,this._active=b.immediateRender===!0,this.data=b.data,this._reversed=b.reversed===!0,R){h||g.wake();var c=this.vars.useFrames?Q:R;c.add(this,c._time),this.vars.paused&&this.paused(!0)}});g=C.ticker=new j.Ticker,f=C.prototype,f._dirty=f._gc=f._initted=f._paused=!1,f._totalTime=f._time=0,f._rawPrevTime=-1,f._next=f._last=f._onUpdate=f._timeline=f.timeline=null,f._paused=!1;var D=function(){h&&A()-B>2e3&&g.wake(),setTimeout(D,2e3)};D(),f.play=function(a,b){return null!=a&&this.seek(a,b),this.reversed(!1).paused(!1)},f.pause=function(a,b){return null!=a&&this.seek(a,b),this.paused(!0)},f.resume=function(a,b){return null!=a&&this.seek(a,b),this.paused(!1)},f.seek=function(a,b){return this.totalTime(Number(a),b!==!1)},f.restart=function(a,b){return this.reversed(!1).paused(!1).totalTime(a?-this._delay:0,b!==!1,!0)},f.reverse=function(a,b){return null!=a&&this.seek(a||this.totalDuration(),b),this.reversed(!0).paused(!1)},f.render=function(){},f.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},f.isActive=function(){var a,b=this._timeline,c=this._startTime;return!b||!this._gc&&!this._paused&&b.isActive()&&(a=b.rawTime())>=c&&c+this.totalDuration()/this._timeScale>a},f._enabled=function(a,b){return h||g.wake(),this._gc=!a,this._active=this.isActive(),b!==!0&&(a&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!a&&this.timeline&&this._timeline._remove(this,!0)),!1},f._kill=function(){return this._enabled(!1,!1)},f.kill=function(a,b){return this._kill(a,b),this},f._uncache=function(a){for(var b=a?this:this.timeline;b;)b._dirty=!0,b=b.timeline;return this},f._swapSelfInParams=function(a){for(var b=a.length,c=a.concat();--b>-1;)"{self}"===a[b]&&(c[b]=this);return c},f.eventCallback=function(a,b,c,d){if("on"===(a||"").substr(0,2)){var e=this.vars;if(1===arguments.length)return e[a];null==b?delete e[a]:(e[a]=b,e[a+"Params"]=n(c)&&-1!==c.join("").indexOf("{self}")?this._swapSelfInParams(c):c,e[a+"Scope"]=d),"onUpdate"===a&&(this._onUpdate=b)}return this},f.delay=function(a){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+a-this._delay),this._delay=a,this):this._delay},f.duration=function(a){return arguments.length?(this._duration=this._totalDuration=a,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==a&&this.totalTime(this._totalTime*(a/this._duration),!0),this):(this._dirty=!1,this._duration)},f.totalDuration=function(a){return this._dirty=!1,arguments.length?this.duration(a):this._totalDuration},f.time=function(a,b){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(a>this._duration?this._duration:a,b)):this._time},f.totalTime=function(a,b,c){if(h||g.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>a&&!c&&(a+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var d=this._totalDuration,e=this._timeline;if(a>d&&!c&&(a=d),this._startTime=(this._paused?this._pauseTime:e._time)-(this._reversed?d-a:a)/this._timeScale,e._dirty||this._uncache(!1),e._timeline)for(;e._timeline;)e._timeline._time!==(e._startTime+e._totalTime)/e._timeScale&&e.totalTime(e._totalTime,!0),e=e._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==a||0===this._duration)&&(this.render(a,b,!1),I.length&&S())}return this},f.progress=f.totalProgress=function(a,b){return arguments.length?this.totalTime(this.duration()*a,b):this._time/this.duration()},f.startTime=function(a){return arguments.length?(a!==this._startTime&&(this._startTime=a,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,a-this._delay)),this):this._startTime},f.endTime=function(a){return this._startTime+(0!=a?this.totalDuration():this.duration())/this._timeScale},f.timeScale=function(a){if(!arguments.length)return this._timeScale;if(a=a||k,this._timeline&&this._timeline.smoothChildTiming){var b=this._pauseTime,c=b||0===b?b:this._timeline.totalTime();this._startTime=c-(c-this._startTime)*this._timeScale/a}return this._timeScale=a,this._uncache(!1)},f.reversed=function(a){return arguments.length?(a!=this._reversed&&(this._reversed=a,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},f.paused=function(a){if(!arguments.length)return this._paused;if(a!=this._paused&&this._timeline){h||a||g.wake();var b=this._timeline,c=b.rawTime(),d=c-this._pauseTime;!a&&b.smoothChildTiming&&(this._startTime+=d,this._uncache(!1)),this._pauseTime=a?c:null,this._paused=a,this._active=this.isActive(),!a&&0!==d&&this._initted&&this.duration()&&this.render(b.smoothChildTiming?this._totalTime:(c-this._startTime)/this._timeScale,!0,!0)}return this._gc&&!a&&this._enabled(!0,!1),this};var E=r("core.SimpleTimeline",function(a){C.call(this,0,a),this.autoRemoveChildren=this.smoothChildTiming=!0});f=E.prototype=new C,f.constructor=E,f.kill()._gc=!1,f._first=f._last=f._recent=null,f._sortChildren=!1,f.add=f.insert=function(a,b){var c,d;if(a._startTime=Number(b||0)+a._delay,a._paused&&this!==a._timeline&&(a._pauseTime=a._startTime+(this.rawTime()-a._startTime)/a._timeScale),a.timeline&&a.timeline._remove(a,!0),a.timeline=a._timeline=this,a._gc&&a._enabled(!0,!0),c=this._last,this._sortChildren)for(d=a._startTime;c&&c._startTime>d;)c=c._prev;return c?(a._next=c._next,c._next=a):(a._next=this._first,this._first=a),a._next?a._next._prev=a:this._last=a,a._prev=c,this._recent=a,this._timeline&&this._uncache(!0),this},f._remove=function(a,b){return a.timeline===this&&(b||a._enabled(!1,!0),a._prev?a._prev._next=a._next:this._first===a&&(this._first=a._next),a._next?a._next._prev=a._prev:this._last===a&&(this._last=a._prev),a._next=a._prev=a.timeline=null,a===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},f.render=function(a,b,c){var d,e=this._first;for(this._totalTime=this._time=this._rawPrevTime=a;e;)d=e._next,(e._active||a>=e._startTime&&!e._paused)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(a-e._startTime)*e._timeScale,b,c):e.render((a-e._startTime)*e._timeScale,b,c)),e=d},f.rawTime=function(){return h||g.wake(),this._totalTime};var F=r("TweenLite",function(b,c,d){if(C.call(this,c,d),this.render=F.prototype.render,null==b)throw"Cannot tween a null target.";this.target=b="string"!=typeof b?b:F.selector(b)||b;var e,f,g,h=b.jquery||b.length&&b!==a&&b[0]&&(b[0]===a||b[0].nodeType&&b[0].style&&!b.nodeType),i=this.vars.overwrite;if(this._overwrite=i=null==i?P[F.defaultOverwrite]:"number"==typeof i?i>>0:P[i],(h||b instanceof Array||b.push&&n(b))&&"number"!=typeof b[0])for(this._targets=g=l(b),this._propLookup=[],this._siblings=[],e=0;g.length>e;e++)f=g[e],f?"string"!=typeof f?f.length&&f!==a&&f[0]&&(f[0]===a||f[0].nodeType&&f[0].style&&!f.nodeType)?(g.splice(e--,1),this._targets=g=g.concat(l(f))):(this._siblings[e]=T(f,this,!1),1===i&&this._siblings[e].length>1&&V(f,this,null,1,this._siblings[e])):(f=g[e--]=F.selector(f),"string"==typeof f&&g.splice(e+1,1)):g.splice(e--,1);else this._propLookup={},this._siblings=T(b,this,!1),1===i&&this._siblings.length>1&&V(b,this,null,1,this._siblings);(this.vars.immediateRender||0===c&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-k,this.render(-this._delay))},!0),G=function(b){return b&&b.length&&b!==a&&b[0]&&(b[0]===a||b[0].nodeType&&b[0].style&&!b.nodeType)},H=function(a,b){var c,d={};for(c in a)O[c]||c in b&&"transform"!==c&&"x"!==c&&"y"!==c&&"width"!==c&&"height"!==c&&"className"!==c&&"border"!==c||!(!L[c]||L[c]&&L[c]._autoCSS)||(d[c]=a[c],delete a[c]);a.css=d};f=F.prototype=new C,f.constructor=F,f.kill()._gc=!1,f.ratio=0,f._firstPT=f._targets=f._overwrittenProps=f._startAt=null,f._notifyPluginsOfEnabled=f._lazy=!1,F.version="1.15.1",F.defaultEase=f._ease=new u(null,null,1,1),F.defaultOverwrite="auto",F.ticker=g,F.autoSleep=!0,F.lagSmoothing=function(a,b){g.lagSmoothing(a,b)},F.selector=a.$||a.jQuery||function(b){var c=a.$||a.jQuery;return c?(F.selector=c,c(b)):"undefined"==typeof document?b:document.querySelectorAll?document.querySelectorAll(b):document.getElementById("#"===b.charAt(0)?b.substr(1):b)};var I=[],J={},K=F._internals={isArray:n,isSelector:G,lazyTweens:I},L=F._plugins={},M=K.tweenLookup={},N=0,O=K.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1},P={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},Q=C._rootFramesTimeline=new E,R=C._rootTimeline=new E,S=K.lazyRender=function(){var a,b=I.length;for(J={};--b>-1;)a=I[b],a&&a._lazy!==!1&&(a.render(a._lazy[0],a._lazy[1],!0),a._lazy=!1);I.length=0};R._startTime=g.time,Q._startTime=g.frame,R._active=Q._active=!0,setTimeout(S,1),C._updateRoot=F.render=function(){var a,b,c;if(I.length&&S(),R.render((g.time-R._startTime)*R._timeScale,!1,!1),Q.render((g.frame-Q._startTime)*Q._timeScale,!1,!1),I.length&&S(),!(g.frame%120)){for(c in M){for(b=M[c].tweens,a=b.length;--a>-1;)b[a]._gc&&b.splice(a,1);0===b.length&&delete M[c]}if(c=R._first,(!c||c._paused)&&F.autoSleep&&!Q._first&&1===g._listeners.tick.length){for(;c&&c._paused;)c=c._next;c||g.sleep()}}},g.addEventListener("tick",C._updateRoot);var T=function(a,b,c){var d,e,f=a._gsTweenID;if(M[f||(a._gsTweenID=f="t"+N++)]||(M[f]={target:a,tweens:[]}),b&&(d=M[f].tweens,d[e=d.length]=b,c))for(;--e>-1;)d[e]===b&&d.splice(e,1);return M[f].tweens},U=function(a,b,c,d){var e,f,g=a.vars.onOverwrite;return g&&(e=g(a,b,c,d)),g=F.onOverwrite,g&&(f=g(a,b,c,d)),e!==!1&&f!==!1},V=function(a,b,c,d,e){var f,g,h,i;if(1===d||d>=4){for(i=e.length,f=0;i>f;f++)if((h=e[f])!==b)h._gc||U(h,b)&&h._enabled(!1,!1)&&(g=!0);else if(5===d)break;return g}var j,l=b._startTime+k,m=[],n=0,o=0===b._duration;for(f=e.length;--f>-1;)(h=e[f])===b||h._gc||h._paused||(h._timeline!==b._timeline?(j=j||W(b,0,o),0===W(h,j,o)&&(m[n++]=h)):l>=h._startTime&&h._startTime+h.totalDuration()/h._timeScale>l&&((o||!h._initted)&&2e-10>=l-h._startTime||(m[n++]=h)));for(f=n;--f>-1;)if(h=m[f],2===d&&h._kill(c,a,b)&&(g=!0),2!==d||!h._firstPT&&h._initted){if(2!==d&&!U(h,b))continue;h._enabled(!1,!1)&&(g=!0)}return g},W=function(a,b,c){for(var d=a._timeline,e=d._timeScale,f=a._startTime;d._timeline;){if(f+=d._startTime,e*=d._timeScale,d._paused)return-100;d=d._timeline}return f/=e,f>b?f-b:c&&f===b||!a._initted&&2*k>f-b?k:(f+=a.totalDuration()/a._timeScale/e)>b+k?0:f-b-k};f._init=function(){var a,b,c,d,e,f=this.vars,g=this._overwrittenProps,h=this._duration,i=!!f.immediateRender,j=f.ease;if(f.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),e={};for(d in f.startAt)e[d]=f.startAt[d];if(e.overwrite=!1,e.immediateRender=!0,e.lazy=i&&f.lazy!==!1,e.startAt=e.delay=null,this._startAt=F.to(this.target,0,e),i)if(this._time>0)this._startAt=null;else if(0!==h)return}else if(f.runBackwards&&0!==h)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(i=!1),c={};for(d in f)O[d]&&"autoCSS"!==d||(c[d]=f[d]);if(c.overwrite=0,c.data="isFromStart",c.lazy=i&&f.lazy!==!1,c.immediateRender=i,this._startAt=F.to(this.target,0,c),i){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=j=j?j instanceof u?j:"function"==typeof j?new u(j,f.easeParams):v[j]||F.defaultEase:F.defaultEase,f.easeParams instanceof Array&&j.config&&(this._ease=j.config.apply(j,f.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(a=this._targets.length;--a>-1;)this._initProps(this._targets[a],this._propLookup[a]={},this._siblings[a],g?g[a]:null)&&(b=!0);else b=this._initProps(this.target,this._propLookup,this._siblings,g);if(b&&F._onPluginEvent("_onInitAllProps",this),g&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),f.runBackwards)for(c=this._firstPT;c;)c.s+=c.c,c.c=-c.c,c=c._next;this._onUpdate=f.onUpdate,this._initted=!0},f._initProps=function(b,c,d,e){var f,g,h,i,j,k;if(null==b)return!1;J[b._gsTweenID]&&S(),this.vars.css||b.style&&b!==a&&b.nodeType&&L.css&&this.vars.autoCSS!==!1&&H(this.vars,b);for(f in this.vars){if(k=this.vars[f],O[f])k&&(k instanceof Array||k.push&&n(k))&&-1!==k.join("").indexOf("{self}")&&(this.vars[f]=k=this._swapSelfInParams(k,this));else if(L[f]&&(i=new L[f])._onInitTween(b,this.vars[f],this)){for(this._firstPT=j={_next:this._firstPT,t:i,p:"setRatio",s:0,c:1,f:!0,n:f,pg:!0,pr:i._priority},g=i._overwriteProps.length;--g>-1;)c[i._overwriteProps[g]]=this._firstPT;(i._priority||i._onInitAllProps)&&(h=!0),(i._onDisable||i._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=c[f]=j={_next:this._firstPT,t:b,p:f,f:"function"==typeof b[f],n:f,pg:!1,pr:0},j.s=j.f?b[f.indexOf("set")||"function"!=typeof b["get"+f.substr(3)]?f:"get"+f.substr(3)]():parseFloat(b[f]),j.c="string"==typeof k&&"="===k.charAt(1)?parseInt(k.charAt(0)+"1",10)*Number(k.substr(2)):Number(k)-j.s||0;j&&j._next&&(j._next._prev=j)}return e&&this._kill(e,b)?this._initProps(b,c,d,e):this._overwrite>1&&this._firstPT&&d.length>1&&V(b,this,c,this._overwrite,d)?(this._kill(c,b),this._initProps(b,c,d,e)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(J[b._gsTweenID]=!0),h)},f.render=function(a,b,c){var d,e,f,g,h=this._time,i=this._duration,j=this._rawPrevTime;if(a>=i)this._totalTime=this._time=i,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(d=!0,e="onComplete"),0===i&&(this._initted||!this.vars.lazy||c)&&(this._startTime===this._timeline._duration&&(a=0),(0===a||0>j||j===k&&"isPause"!==this.data)&&j!==a&&(c=!0,j>k&&(e="onReverseComplete")),this._rawPrevTime=g=!b||a||j===a?a:k);else if(1e-7>a)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==h||0===i&&j>0&&j!==k)&&(e="onReverseComplete",d=this._reversed),0>a&&(this._active=!1,0===i&&(this._initted||!this.vars.lazy||c)&&(j>=0&&(j!==k||"isPause"!==this.data)&&(c=!0),this._rawPrevTime=g=!b||a||j===a?a:k)),this._initted||(c=!0);else if(this._totalTime=this._time=a,this._easeType){var l=a/i,m=this._easeType,n=this._easePower;(1===m||3===m&&l>=.5)&&(l=1-l),3===m&&(l*=2),1===n?l*=l:2===n?l*=l*l:3===n?l*=l*l*l:4===n&&(l*=l*l*l*l),this.ratio=1===m?1-l:2===m?l:.5>a/i?l/2:1-l/2}else this.ratio=this._ease.getRatio(a/i);if(this._time!==h||c){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!c&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=h,this._rawPrevTime=j,I.push(this),void(this._lazy=[a,b]);this._time&&!d?this.ratio=this._ease.getRatio(this._time/i):d&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==h&&a>=0&&(this._active=!0),0===h&&(this._startAt&&(a>=0?this._startAt.render(a,b,c):e||(e="_dummyGS")),this.vars.onStart&&(0!==this._time||0===i)&&(b||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||t))),f=this._firstPT;f;)f.f?f.t[f.p](f.c*this.ratio+f.s):f.t[f.p]=f.c*this.ratio+f.s,f=f._next;this._onUpdate&&(0>a&&this._startAt&&a!==-1e-4&&this._startAt.render(a,b,c),b||(this._time!==h||d)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||t)),e&&(!this._gc||c)&&(0>a&&this._startAt&&!this._onUpdate&&a!==-1e-4&&this._startAt.render(a,b,c),d&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!b&&this.vars[e]&&this.vars[e].apply(this.vars[e+"Scope"]||this,this.vars[e+"Params"]||t),0===i&&this._rawPrevTime===k&&g!==k&&(this._rawPrevTime=0))}},f._kill=function(a,b,c){if("all"===a&&(a=null),null==a&&(null==b||b===this.target))return this._lazy=!1,this._enabled(!1,!1);b="string"!=typeof b?b||this._targets||this.target:F.selector(b)||b;var d,e,f,g,h,i,j,k,l;if((n(b)||G(b))&&"number"!=typeof b[0])for(d=b.length;--d>-1;)this._kill(a,b[d])&&(i=!0);else{if(this._targets){for(d=this._targets.length;--d>-1;)if(b===this._targets[d]){h=this._propLookup[d]||{},this._overwrittenProps=this._overwrittenProps||[],e=this._overwrittenProps[d]=a?this._overwrittenProps[d]||{}:"all";break}}else{if(b!==this.target)return!1;h=this._propLookup,e=this._overwrittenProps=a?this._overwrittenProps||{}:"all"}if(h){if(j=a||h,k=a!==e&&"all"!==e&&a!==h&&("object"!=typeof a||!a._tempKill),c&&(F.onOverwrite||this.vars.onOverwrite)){for(f in j)h[f]&&(l||(l=[]),l.push(f));if(!U(this,c,b,l))return!1}for(f in j)(g=h[f])&&(g.pg&&g.t._kill(j)&&(i=!0),g.pg&&0!==g.t._overwriteProps.length||(g._prev?g._prev._next=g._next:g===this._firstPT&&(this._firstPT=g._next),g._next&&(g._next._prev=g._prev),g._next=g._prev=null),delete h[f]),k&&(e[f]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return i},f.invalidate=function(){return this._notifyPluginsOfEnabled&&F._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],C.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-k,this.render(-this._delay)),this},f._enabled=function(a,b){if(h||g.wake(),a&&this._gc){var c,d=this._targets;if(d)for(c=d.length;--c>-1;)this._siblings[c]=T(d[c],this,!0);else this._siblings=T(this.target,this,!0)}return C.prototype._enabled.call(this,a,b),this._notifyPluginsOfEnabled&&this._firstPT?F._onPluginEvent(a?"_onEnable":"_onDisable",this):!1},F.to=function(a,b,c){return new F(a,b,c)},F.from=function(a,b,c){return c.runBackwards=!0,c.immediateRender=0!=c.immediateRender,new F(a,b,c)},F.fromTo=function(a,b,c,d){return d.startAt=c,d.immediateRender=0!=d.immediateRender&&0!=c.immediateRender,new F(a,b,d)},F.delayedCall=function(a,b,c,d,e){return new F(b,0,{delay:a,onComplete:b,onCompleteParams:c,onCompleteScope:d,onReverseComplete:b,onReverseCompleteParams:c,onReverseCompleteScope:d,immediateRender:!1,lazy:!1,useFrames:e,overwrite:0})},F.set=function(a,b){return new F(a,0,b)},F.getTweensOf=function(a,b){if(null==a)return[];a="string"!=typeof a?a:F.selector(a)||a;var c,d,e,f;if((n(a)||G(a))&&"number"!=typeof a[0]){for(c=a.length,d=[];--c>-1;)d=d.concat(F.getTweensOf(a[c],b));for(c=d.length;--c>-1;)for(f=d[c],e=c;--e>-1;)f===d[e]&&d.splice(c,1)}else for(d=T(a).concat(),c=d.length;--c>-1;)(d[c]._gc||b&&!d[c].isActive())&&d.splice(c,1);return d},F.killTweensOf=F.killDelayedCallsTo=function(a,b,c){"object"==typeof b&&(c=b,b=!1);for(var d=F.getTweensOf(a,b),e=d.length;--e>-1;)d[e]._kill(c,a)};var X=r("plugins.TweenPlugin",function(a,b){this._overwriteProps=(a||"").split(","),this._propName=this._overwriteProps[0],this._priority=b||0,this._super=X.prototype},!0);if(f=X.prototype,X.version="1.10.1",X.API=2,f._firstPT=null,f._addTween=function(a,b,c,d,e,f){var g,h;return null!=d&&(g="number"==typeof d||"="!==d.charAt(1)?Number(d)-c:parseInt(d.charAt(0)+"1",10)*Number(d.substr(2)))?(this._firstPT=h={_next:this._firstPT,t:a,p:b,s:c,c:g,f:"function"==typeof a[b],n:e||b,r:f},h._next&&(h._next._prev=h),h):void 0},f.setRatio=function(a){for(var b,c=this._firstPT,d=1e-6;c;)b=c.c*a+c.s,c.r?b=Math.round(b):d>b&&b>-d&&(b=0),c.f?c.t[c.p](b):c.t[c.p]=b,c=c._next},f._kill=function(a){var b,c=this._overwriteProps,d=this._firstPT;if(null!=a[this._propName])this._overwriteProps=[];else for(b=c.length;--b>-1;)null!=a[c[b]]&&c.splice(b,1);for(;d;)null!=a[d.n]&&(d._next&&(d._next._prev=d._prev),d._prev?(d._prev._next=d._next,d._prev=null):this._firstPT===d&&(this._firstPT=d._next)),d=d._next;return!1},f._roundProps=function(a,b){for(var c=this._firstPT;c;)(a[this._propName]||null!=c.n&&a[c.n.split(this._propName+"_").join("")])&&(c.r=b),c=c._next},F._onPluginEvent=function(a,b){var c,d,e,f,g,h=b._firstPT;if("_onInitAllProps"===a){for(;h;){for(g=h._next,d=e;d&&d.pr>h.pr;)d=d._next;(h._prev=d?d._prev:f)?h._prev._next=h:e=h,(h._next=d)?d._prev=h:f=h,h=g}h=b._firstPT=e}for(;h;)h.pg&&"function"==typeof h.t[a]&&h.t[a]()&&(c=!0),h=h._next;return c},X.activate=function(a){for(var b=a.length;--b>-1;)a[b].API===X.API&&(L[(new a[b])._propName]=a[b]);
return!0},q.plugin=function(a){if(!(a&&a.propName&&a.init&&a.API))throw"illegal plugin definition.";var b,c=a.propName,d=a.priority||0,e=a.overwriteProps,f={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},g=r("plugins."+c.charAt(0).toUpperCase()+c.substr(1)+"Plugin",function(){X.call(this,c,d),this._overwriteProps=e||[]},a.global===!0),h=g.prototype=new X(c);h.constructor=g,g.API=a.API;for(b in f)"function"==typeof a[b]&&(h[f[b]]=a[b]);return g.version=a.version,X.activate([g]),g},d=a._gsQueue){for(e=0;d.length>e;e++)d[e]();for(f in o)o[f].func||a.console.log("GSAP encountered missing dependency: com.greensock."+f)}h=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenLite"),function(a){if("object"==typeof module&&"object"==typeof module.exports)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b=a();window.astar=b.astar,window.Graph=b.Graph}}(function(){function a(a){for(var b=a,c=[];b.parent;)c.unshift(b),b=b.parent;return c}function b(){return new e(function(a){return a.f})}function c(a,b){b=b||{},this.nodes=[],this.diagonal=!!b.diagonal,this.grid=[];for(var c=0;c<a.length;c++){this.grid[c]=[];for(var e=0,f=a[c];e<f.length;e++){var g=new d(c,e,f[e]);this.grid[c][e]=g,this.nodes.push(g)}}this.init()}function d(a,b,c){this.x=a,this.y=b,this.weight=c}function e(a){this.content=[],this.scoreFunction=a}var f={search:function(c,d,e,g){c.cleanDirty(),g=g||{};var h=g.heuristic||f.heuristics.manhattan,i=g.closest||!1,j=b(),k=d;for(d.h=h(d,e),c.markDirty(d),j.push(d);j.size()>0;){var l=j.pop();if(l===e)return a(l);l.closed=!0;for(var m=c.neighbors(l),n=0,o=m.length;o>n;++n){var p=m[n];if(!p.closed&&!p.isWall()){var q=l.g+p.getCost(l),r=p.visited;(!r||q<p.g)&&(p.visited=!0,p.parent=l,p.h=p.h||h(p,e),p.g=q,p.f=p.g+p.h,c.markDirty(p),i&&(p.h<k.h||p.h===k.h&&p.g<k.g)&&(k=p),r?j.rescoreElement(p):j.push(p))}}}return i?a(k):[]},heuristics:{manhattan:function(a,b){var c=Math.abs(b.x-a.x),d=Math.abs(b.y-a.y);return c+d},diagonal:function(a,b){var c=1,d=Math.sqrt(2),e=Math.abs(b.x-a.x),f=Math.abs(b.y-a.y);return c*(e+f)+(d-2*c)*Math.min(e,f)}},cleanNode:function(a){a.f=0,a.g=0,a.h=0,a.visited=!1,a.closed=!1,a.parent=null}};return c.prototype.init=function(){this.dirtyNodes=[];for(var a=0;a<this.nodes.length;a++)f.cleanNode(this.nodes[a])},c.prototype.cleanDirty=function(){for(var a=0;a<this.dirtyNodes.length;a++)f.cleanNode(this.dirtyNodes[a]);this.dirtyNodes=[]},c.prototype.markDirty=function(a){this.dirtyNodes.push(a)},c.prototype.neighbors=function(a){var b=[],c=a.x,d=a.y,e=this.grid;return e[c-1]&&e[c-1][d]&&b.push(e[c-1][d]),e[c+1]&&e[c+1][d]&&b.push(e[c+1][d]),e[c]&&e[c][d-1]&&b.push(e[c][d-1]),e[c]&&e[c][d+1]&&b.push(e[c][d+1]),this.diagonal&&(e[c-1]&&e[c-1][d-1]&&b.push(e[c-1][d-1]),e[c+1]&&e[c+1][d-1]&&b.push(e[c+1][d-1]),e[c-1]&&e[c-1][d+1]&&b.push(e[c-1][d+1]),e[c+1]&&e[c+1][d+1]&&b.push(e[c+1][d+1])),b},c.prototype.toString=function(){for(var a=[],b=this.grid,c=0;c<b.length;c++){for(var d=[],e=b[c],f=0;f<e.length;f++)d.push(e[f].weight);a.push(d.join(" "))}return a.join("\n")},d.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},d.prototype.getCost=function(a){return a&&a.x!=this.x&&a.y!=this.y?1.41421*this.weight:this.weight},d.prototype.isWall=function(){return 0===this.weight},e.prototype={push:function(a){this.content.push(a),this.sinkDown(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();return this.content.length>0&&(this.content[0]=b,this.bubbleUp(0)),a},remove:function(a){var b=this.content.indexOf(a),c=this.content.pop();b!==this.content.length-1&&(this.content[b]=c,this.scoreFunction(c)<this.scoreFunction(a)?this.sinkDown(b):this.bubbleUp(b))},size:function(){return this.content.length},rescoreElement:function(a){this.sinkDown(this.content.indexOf(a))},sinkDown:function(a){for(var b=this.content[a];a>0;){var c=(a+1>>1)-1,d=this.content[c];if(!(this.scoreFunction(b)<this.scoreFunction(d)))break;this.content[c]=b,this.content[a]=d,a=c}},bubbleUp:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var e,f=a+1<<1,g=f-1,h=null;if(b>g){var i=this.content[g];e=this.scoreFunction(i),d>e&&(h=g)}if(b>f){var j=this.content[f],k=this.scoreFunction(j);(null===h?d:e)>k&&(h=f)}if(null===h)break;this.content[a]=this.content[h],this.content[h]=c,a=h}}},{astar:f,Graph:c}});var hexcase=0,b64pad="",chrsz=8,BaoshiMeshVo=function(){function a(){}return a}(),EquMeshVo=function(){function a(){var b=float2int(a.nameArr.length*Math.random());this.name=a.nameArr[b],this.zl=float2int(99999*Math.random()),this.zbpj=float2int(99*Math.random()),this.qhdj=float2int(99*Math.random()),this.jcgj=float2int(99999*Math.random()),this.qhgj=float2int(99999*Math.random()),this.txt0=String(float2int(100*Math.random())),this.txt1=String(float2int(100*Math.random()))+"/"+String(float2int(100*Math.random())),this.txt2=String(float2int(999*Math.random())),this.txt3=String(float2int(999*Math.random())),this.txt4=String(float2int(100*Math.random())),this.txt5=String(float2int(100*Math.random()))+"/"+String(float2int(100*Math.random())),this.txt6=String(float2int(999*Math.random())),this.txt7=String(float2int(999*Math.random())),this.bigIconUrl="ui/eqicon/qi00"+float2int(4*Math.random())+".png"}return a.nameArr=["铁鞭","石子镖","流星锤","金锁甲","网羽","绝刃"],a}(),ChengjiuMeshVo=function(){function a(){}return a}(),RoleMeshVo=function(){function a(){}return a}(),CharAction=function(){function a(){}return a.STANAD="stand",a.WALK="walk",a.DEATH="death",a.JUMP="jump",a.SIT="sit",a.ATTACK_01="attack_01",a.ATTACK_02="attack_02",a.ATTACK_03="attack_03",a.ATTACK_04="attack_04",a.ATTACK_05="attack_05",a.ATTACK_06="attack_06",a.ATTACK_010="attack_010",a.ATTACK_020="attack_020",a.STAND_MOUNT="stand_mount_01",a.WALK_MOUNT="walk_mount_01",a.s_attack_01="s_attack_01",a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),UIPanelEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.DISPOSE_PANEL_EVENT="dispose_panel_event",b}(BaseEvent),UIPanel=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.onAdd=function(){this._disposeEventFun&&TimeUtil.removeTimeOut(this._disposeEventFun)},b.prototype.onRemove=function(){var a=this;this._disposeEventFun||(this._disposeEventFun=function(){var b=new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT);b.panel=a,ModuleEventManager.dispatchEvent(b)}),TimeUtil.addTimeOut(2e7,this._disposeEventFun)},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BaseProcessor=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(Processor),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneBaseChar=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._avatar=-1,b._visible=!0,b}return __extends(b,a),Object.defineProperty(b.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible=a},enumerable:!0,configurable:!0}),b.prototype.setAvatar=function(a){this._avatar!=a&&(this._avatar=a,this.setRoleUrl(this.getSceneCharAvatarUrl(a)))},b.prototype.update=function(){this.visible&&a.prototype.update.call(this),this._shadow&&(this._shadow._visible=this.visible)},b.prototype.getSceneCharAvatarUrl=function(a){getRoleUrl(String(a));return getRoleUrl(String(a))},b.prototype.getSceneCharWeaponUrl=function(a,b){return void 0===b&&(b=""),getModelUrl(String(a+b))},b}(Display3dMovie),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ScenePerfab=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.setPerfabName=function(a){this.addPart("abcdef","abcdef",getModelUrl(a))},b}(Display3dMovie),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),TestUIEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.CREAT_TESTUI_EVENT="creat_testui_event",b.ADD_TESTUI_EVENT="add_testui_event",b.HIDE_TESTUI_EVENT="hide_testui_event",b}(BaseEvent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),EquipmentEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.INIT_EQU_EVENT="init_equ_event",b.SHOW_EQU_EVENT="show_equ_event",b.HIDE_EQU_EVENT="hide_equ_event",b}(BaseEvent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneChar=function(a){function b(){var b=a.call(this)||this;return b.speedTX=.075,b.life=0,b.isMount=!1,b._px=0,b._py=0,b._pz=0,b._pRotationY=0,b._isBoss=!1,b._weaponNum=-1,b._wingID=-1,b.tittleHeight=50,b.jumpEndTime=0,b.lastJumpDan=-1,b.toRotationY=0,b._showHitBox=!1,b.triIndex=[0,1,2,0,2,3,4,5,6,4,6,7,0,4,5,0,5,1,1,5,6,1,6,2,2,6,7,2,7,3,3,7,4,3,4,0],b.shadow=!0,b.skillitem=new Array,b}return __extends(b,a),Object.defineProperty(b.prototype,"isDeath",{get:function(){return this.unit.getAlivestate()!=SharedDef.DEATH_STATE_ALIVE},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isBoss",{get:function(){return this._isBoss},set:function(a){this._isBoss=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"px",{get:function(){return this._px},set:function(a){this._px=a,this.isMount?(this.mountChar.x=a,this._shadow&&(this._shadow.x=a)):this.x=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"py",{get:function(){return this._py},set:function(a){this._py=a,this.isMount?(this.mountChar.y=a,this._shadow&&(this._shadow.y=a)):this.y=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"pz",{get:function(){return this._pz},set:function(a){this._pz=a,this.isMount?(this.mountChar.z=a,this._shadow&&(this._shadow.z=a)):this.z=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"forceRotationY",{set:function(a){this.pRotationY=a,this.rotationY=a,this.toRotationY=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"pRotationY",{get:function(){return this._pRotationY},set:function(a){this._pRotationY=a,this.isMount?this.mountChar.rotationY=a:this.rotationY=a},enumerable:!0,configurable:!0}),b.prototype.play=function(b,c,d){return void 0===c&&(c=0),void 0===d&&(d=!0),this.isSinging&&(c=0,b==CharAction.WALK||b==CharAction.STANAD)?!0:this.isMount?(this.mountChar.visible=Boolean(b!=CharAction.JUMP),b==CharAction.STANAD?a.prototype.play.call(this,CharAction.STAND_MOUNT):b==CharAction.WALK?a.prototype.play.call(this,CharAction.WALK_MOUNT):this.mountChar.visible?a.prototype.play.call(this,CharAction.STAND_MOUNT):a.prototype.play.call(this,CharAction.JUMP),this.mountChar.play(b,c,d)):a.prototype.play.call(this,b,c,d)},b.prototype.getCurrentAction=function(){return this.isMount?this.mountChar.curentAction:this.curentAction},b.prototype.getSceneCharAvatarUrl=function(a){var b=String(a);if(0==a)throw console.log("衣服为0"),new Error("衣服为getSceneCharAvatarUrl");var c=getRoleUrl(b);return c},b.prototype.setMount=function(){if(this.unit.hasMount()){this.isMount=!0;var a=this.unit.getMountRank(),c=this.unit.getMountIllusionID();this.mountChar||(this.mountChar=new MountChar),this.mountChar.x=this.px,this.mountChar.y=this.py,this.mountChar.z=this.pz,this.mountChar.rotationY=this._pRotationY,this.mountChar.setData(a,c),this.setBind(this.mountChar,b.MOUNT_SLOT),this.onStage&&!this.mountChar.onStage&&(SceneManager.getInstance().addMovieDisplay(this.mountChar),this.play(this.curentAction))}else this.isMount=!1,this.mountChar&&this.mountChar.onStage&&(SceneManager.getInstance().removeMovieDisplay(this.mountChar),this.curentAction==CharAction.WALK_MOUNT?this.play(CharAction.WALK):this.play(CharAction.STANAD)),this.bindTarget=null,this.x=this.px,this.z=this.pz,this.y=this.py,this.rotationY=this._pRotationY;this.refreshPos(),this.unit&&this.unit.isMain&&(this.isMount?console.log("有坐骑1"):console.log("无坐骑1"))},b.prototype.setWeaponDivine=function(){this.setBaseRoleWeapon(this.unit.getDivine(),this.unit.getCharType())},b.prototype.setAvatarExterior=function(){this.setBaseRoleAvatar(this.unit.getAvatar(),this.unit.getCharType())},b.prototype.setBaseRoleAvatar=function(a,b){var c=0;c=0==a?tb.TB_char_info.getTempVo(b).avatar:tb.TB_appearance_info.getTempVo(a).avatar,this.setAvatar(c)},b.prototype.setBaseRoleWeapon=function(a,b){void 0===b&&(b=1),a?this.setWeaponByAvatar(tb.TB_appearance_info.getTempVo(a).avatar):this.setWeaponByAvatar(tb.TB_char_info.getTempVo(b).weapon)},b.prototype.setWeapon=function(a){if(this._weaponNum!=a)if(this._weaponNum=a,0>=a)this.removePart(b.WEAPON_PART);else{var c=tb.TB_item_template.get_TB_item_template(a);c&&this.setWeaponByAvatar(c.avatar)}},b.prototype.setWeaponByAvatar=function(a,c){void 0===c&&(c="");var d=tb.TB_item_slot.getTempVo(a);d?this.addPart(b.WEAPON_PART,d.slot,this.getSceneCharWeaponUrl(a,c)):this.addPart(b.WEAPON_PART,b.WEAPON_DEFAULT_SLOT,this.getSceneCharWeaponUrl(a,c))},b.prototype.setWing=function(){var a=this.unit.getWing();if(0!=a&&a!=this._wingID){var c=TableData.getInstance().getData(TableData.tb_wings_base,a);c&&(this._wingID=a,this._wingDisplay||(this._wingDisplay=new SceneBaseChar),this._wingDisplay.setRoleUrl(getRoleUrl(c.model)),this._wingDisplay.setBind(this,b.WING_SLOT),this.onStage&&!this._wingDisplay.onStage&&SceneManager.getInstance().addMovieDisplay(this._wingDisplay))}},b.prototype.addTestWeapon=function(){this.addPart("test"+Math.random(),b.WEAPON_DEFAULT_SLOT,this.getSceneCharWeaponUrl(Math.random()>.5?5202:5201))},b.prototype.refreshIllusion=function(){var a=this.unit.getIllusionId();if(a>0){var b=tb.TB_item_illusion.get_TB_item_illusion(a);this.setAvatar(b.avatar),this.setWeaponByAvatar(b.divine)}this.unit.isMain&&ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.RESET_SKILL_ICON))},b.prototype.refreshTittle=function(){var a=this.unit.getCharTittle(),b=0;0!=a&&(b=a),this.unit.getXianfuBaoXiang()>0&&(b=999);var c=this.unit.getAnger();switch(c){case SharedDef.QUEST_ESCORT_STATE_NORMAL:b=888;break;case SharedDef.QUEST_ESCORT_STATE_ROB:b=888}0==b?this._charTitleVo&&(this._charTitleVo.destory(),this._charTitleVo=null):this._charTitleVo?this._charTitleVo.num=b:this._charTitleVo=BloodManager.getInstance().getCharTitleMeshVo(b),this.refreshPos()},b.prototype.showName=function(a){if(void 0===a&&(a=null),!this.unit.isSkillNpc()){var b=this.unit.getName().split(","),c=b[b.length-1];if(!a)switch(this.unit.getTypeID()){case SharedDef.TYPEID_OBJECT:a="[00ff00]";break;case SharedDef.TYPEID_UNIT:a="[ffffff]";break;case SharedDef.TYPEID_PLAYER:a="[ffffff]";break;case SharedDef.TYPEID_GAMEOBJECT:a="[00ff00]";break;case SharedDef.MAX_CLIENT_OBJECT_TYPES:a="[00ff00]"}var d=a+c+"("+String(this.unit.getEntry())+")";this._charNameVo?this._charNameVo.name=d:this._charNameVo=BloodManager.getInstance().getCharNameMeshVo(d),this.refreshPos()}},b.prototype.showBlood=function(a){void 0===a&&(a=0),this._charBloodVo?this._charBloodVo.colortype=a:(this.unit.isPlayer()||this.unit.isMonster())&&(this.unit.isSkillNpc()||(this._charBloodVo=BloodManager.getInstance().getBloodLineMeshVo(),this._charBloodVo.colortype=a)),this.refreshPos()},b.prototype.onMeshLoaded=function(){this._skinMesh&&(this.tittleHeight=this._skinMesh.tittleHeight)},b.prototype.refreshPos=function(){this._charBloodVo&&(this._charBloodVo.pos.x=this.px,this.isMount?this._charBloodVo.pos.y=this.py+this.tittleHeight-6+20:this._charBloodVo.pos.y=this.py+this.tittleHeight-6,this._charBloodVo.pos.z=this.pz,this._charBloodVo.visible=this.visible),this._charNameVo&&(this._charNameVo.pos.x=this.px,this.isMount?this._charNameVo.pos.y=this.py+this.tittleHeight+20:this._charNameVo.pos.y=this.py+this.tittleHeight,this._charNameVo.pos.z=this.pz,this._charNameVo.visible=this.visible),this._charTitleVo&&(this._charTitleVo.pos.x=this.px,this.isMount?this._charTitleVo.pos.y=this.py+this.tittleHeight+20+10:this._charTitleVo.pos.y=this.py+this.tittleHeight+10,this._charTitleVo.pos.z=this.pz,this._charTitleVo.visible=this.visible)},Object.defineProperty(b.prototype,"walkPath",{set:function(a){0!=a.length&&((this.curentAction==CharAction.STANAD||this.curentAction==CharAction.STAND_MOUNT)&&this.play(CharAction.WALK),this._walkPath=a,this.setTarget(),this._speedDirect=null)},enumerable:!0,configurable:!0}),b.prototype.fixAstartData=function(a){if(this._walkPath)for(var b=0;b<this._walkPath.length;b++)this._walkPath[b].x+=a.x,this._walkPath[b].z=a.y-this._walkPath[b].z,this._walkPath[b].y=AstarUtil.getHeightByPos(this._walkPath[b]);this.px+=a.x,this.pz=a.y-this.pz,this._astatTopos&&(this._astatTopos.x+=a.x,this._astatTopos.z=a.y-this._astatTopos.z,this.setAstarNrmAndRotation()),this.refreshY()},b.prototype.applyWalk=function(a){if(a&&2==a.length&&a[0].x==a[1].x&&a[0].y==a[1].y){console.log("收到寻路坐标是在原地==>",a),this._speedDirect=null,this._walkPath=null,this.curentAction==CharAction.WALK&&this.play(CharAction.STANAD);var b=AstarUtil.getWorldPosByStart2D(a[0]);return this.px=b.x,void(this.pz=b.z)}this.walkPath=AstarUtil.Path2dTo3d(a)},b.prototype.applyJump=function(a,b){this.unit.isMain&&(JumpModel.jumpNow=!0),this.jumpNeedTime=b,this.jumpEndTime=TimeUtil.getTimer()+this.jumpNeedTime,this.jumpItem=a,this.stopMove(),this.play(CharAction.JUMP)},b.prototype.refreshJump=function(){if(this.jumpItem){var a=this.unit.isMain?75:40,b=this.jumpEndTime-TimeUtil.getTimer(),c=this.jumpItem.length-1,d=this.jumpNeedTime/c,e=Math.floor(b/d),f=c-e;f=Math.max(f,1);var g=this.jumpItem[f-1],h=this.jumpItem[f];if(this.lastJumpDan!=f&&(this.lastJumpDan=f,this._actionTime=0,h)){var i=new Display3D;i.x=h.x,i.y=h.y,i.z=h.z,this.watch(i)}if(0>b)this.px=this.jumpItem[c].x,this.py=this.jumpItem[c].y,this.pz=this.jumpItem[c].z,this.jumpItem=null,this.stopMove(),this.jumpEndFun&&this.jumpEndFun();else{var j=1-b%d/d,k=h.subtract(g);k.scaleBy(j);var l=g.add(k);this.px=l.x,this.pz=l.z;var m=g.y+(h.y-g.y)*j;this.py=m+Math.sin(j*Math.PI)*a,this.refreshPos(),this._shadow&&(this._shadow.y=m)}}},Object.defineProperty(b.prototype,"moveToPos2D",{set:function(a){this._walkPath=null,this.play(this._defaultAction);var b=AstarUtil.getWorldPosByStart2D(a);this.px=b.x,this.pz=b.z,this.refreshY()},enumerable:!0,configurable:!0}),b.prototype.stopToPos=function(a){var b=AstarUtil.getWorldPosByStart2D(a),c=new Array;c.push(b),this.walkPath=c},b.prototype.moveTile=function(a,b){this.moveToPos2D=new Vector2D(a,b)},b.prototype.updateFrame=function(b){a.prototype.updateFrame.call(this,b),this.jumpItem?this.refreshJump():this._walkPath&&(this.curentAction!=CharAction.WALK&&this.play(CharAction.WALK),this.walkAstar(b),this.refreshY()),this._rotationMatrix&&this.rotationToNew(this.toRotationY,2)},b.prototype.refreshY=function(){this.py=AstarUtil.getHeightByPos(this.getCurrentPos()),this.refreshPos()},b.prototype.refreshHP=function(){this.refreshLifeNum()},b.prototype.refreshUnitFieldByte=function(){var a=this.unit.getAlivestate();a==SharedDef.DEATH_STATE_ALIVE?(this.play(CharAction.STANAD,2),this.visible=!0):a==SharedDef.DEATH_STATE_CORPSE?(this.play(CharAction.DEATH,1),this.visible=!0):a==SharedDef.DEATH_STATE_DEAD&&(this.visible=!1),this.refreshLifeNum(),this.refreshPos()},b.prototype.unitFieldByteChg=function(){var a=this.unit.getAlivestate();a==SharedDef.DEATH_STATE_ALIVE?(this.play(CharAction.STANAD,2),this.visible=!0):a==SharedDef.DEATH_STATE_CORPSE?this.visible=!0:a==SharedDef.DEATH_STATE_DEAD&&(this.visible=!1),this.refreshLifeNum(),this.refreshPos()},b.prototype.setHp=function(a){var b=this.unit.getHp();return this.unit.setHp(a),this.unit.isMain&&ModuleEventManager.dispatchEvent(new topui.TopUiEvent(topui.TopUiEvent.REFRESH_TOP_LEFT_BLOOD)),a-b},b.prototype.refreshLifeNum=function(){if(this.life=this.unit.getHp()/this.unit.getMaxHp()*100,this._charBloodVo&&(this._charBloodVo.num=this.life),this._isBoss){var a=this.life/100,b=new boss.BossEvent(boss.BossEvent.BOSS_HP_CHANGE_EVENT);b.data={num:a,id:this.unit.getEntry()},ModuleEventManager.dispatchEvent(b)}},b.prototype.rotationToNew=function(a,b){void 0===b&&(b=1);var c=a-this.pRotationY;if(0!=c){if(1>c)return void(this.pRotationY=a);var d=((a-this.pRotationY)%360+360)%360;d>180?this.pRotationY-=(360-d)/b:this.pRotationY+=d/b}},Object.defineProperty(b.prototype,"speedUseTime",{set:function(a){this.speedTX=.01*(a/10)},enumerable:!0,configurable:!0}),b.prototype.refreshSpeed=function(){this.speedUseTime=this.unit.getSpeed()},b.prototype.walkAstar=function(a){this.unit&&this.unit.isMain;var b=Math.min(a,50),c=Vector3D.distance(new Vector3D(this.px,0,this.pz),this._astatTopos);if(c>5){var d=b*this.speedTX;if(d>c){this.px=this._astatTopos.x,this.pz=this._astatTopos.z;var e=(d-c)/this.speedTX;this.walkAstar(e)}else this.px+=this._astarDirect.x*d,this.pz+=this._astarDirect.z*d}else this.setTarget(),this._walkPath?this.walkAstar(a):(this.px=this._astatTopos.x,this.pz=this._astatTopos.z,this.walkComplete())},b.prototype.walkComplete=function(){this.walkCompleteBackFun&&this.walkCompleteBackFun()},b.prototype.setTarget=function(){if(this._walkPath){if(0==this._walkPath.length)return this._walkPath=null,void this.play(CharAction.STANAD);this._astatTopos=this._walkPath.shift(),this.setAstarNrmAndRotation()}},b.prototype.setAstarNrmAndRotation=function(){this._astatTopos&&(this._astarDirect=this._astatTopos.subtract(this.getCurrentPos()),this._astarDirect.y=0,this._astarDirect.normalize(),Vector3D.distance(this.getCurrentPos(),this._astatTopos)>10&&(this.toRotationY=this.mathAngle(this._astatTopos.z,this._astatTopos.x,this.pz,this.px)+180))},b.prototype.mathAngle=function(a,b,c,d){return 180*Math.atan2(d-b,c-a)/Math.PI},b.prototype.setSpeedDirect=function(a){this.isDeath||(this._speedDirect=a,(this.curentAction==CharAction.STANAD||this.curentAction==CharAction.STAND_MOUNT)&&this.play(CharAction.WALK),this._walkPath=null)},b.prototype.stopMove=function(){this.play(CharAction.STANAD),this._speedDirect=null,this._walkPath=null},b.prototype.getEndWalkPathPos=function(){return this._walkPath?this._walkPath[this._walkPath.length-1]:null},b.prototype.watch=function(a,b){if(void 0===b&&(b=!1),!a)return void console.log("面向对象无");var c=a.x-this.px,d=a.z-this.pz,e=Math.sqrt(c*c+d*d);c/=e,d/=e;var f=Math.asin(c)/Math.PI*180;0>=d&&(f=180-f),isNaN(f)||(this.forceRotationY=f)},b.prototype.getCurrentPos=function(){return new Vector3D(this.px,this.py,this.pz)},b.prototype.getAstarPos=function(){return AstarUtil.getGrapIndexByPos(this.getCurrentPos())},b.prototype.changeAction=function(b){if(this.unit.isMain)switch(b){case CharAction.ATTACK_01:this.play(CharAction.ATTACK_010,2);break;case CharAction.ATTACK_02:this.play(CharAction.ATTACK_020,2);break;default:a.prototype.changeAction.call(this,b)}else a.prototype.changeAction.call(this,b)},b.prototype.playSkill=function(a){this._walkPath=null,SkillManager.getInstance().playSkill(a),this.skillVo=a},b.prototype.msgSpellStop=function(){this.skillVo&&(this.skillVo.removeSkillForce(),this.changeAction(this._defaultAction),this.skillVo=null),this.isSinging=!1},b.prototype.destory=function(){this._hasDestory||(a.prototype.destory.call(this),this._charNameVo&&(this._charNameVo.destory(),this._charNameVo=null),this._charBloodVo&&(this._charBloodVo.destory(),this._charBloodVo=null),this._charTitleVo&&(this._charTitleVo.destory(),this._charTitleVo=null),this._isBoss&&(console.log("---隐藏111--"),ModuleEventManager.dispatchEvent(new boss.BossEvent(boss.BossEvent.HIDE_BOSSHP_EVENT)),GuidData.map.isFamilyScene()&&ModuleEventManager.dispatchEvent(new boss.BossEvent(boss.BossEvent.HIDE_OFTENRANK_PANEL))),this.skillVo&&(this.skillVo.removeSkillForce(),this.skillVo=null),this._wingDisplay&&this._wingDisplay.destory(),this._hasDestory=!0)},b.prototype.removeStage=function(){a.prototype.removeStage.call(this),this._charNameVo&&(this._charNameVo.visible=!1),this._charBloodVo&&(this._charBloodVo.visible=!1),this.mountChar&&SceneManager.getInstance().removeMovieDisplay(this.mountChar),this._wingDisplay&&SceneManager.getInstance().removeMovieDisplay(this._wingDisplay)},b.prototype.addStage=function(){a.prototype.addStage.call(this),this._charNameVo&&(this._charNameVo.visible=!0),this._charBloodVo&&(this._charBloodVo.visible=!0),this.mountChar&&SceneManager.getInstance().addMovieDisplay(this.mountChar),this._wingDisplay&&SceneManager.getInstance().addMovieDisplay(this._wingDisplay)},b.prototype.math_distance=function(a){return MathClass.math_distance(this.px,this.pz,a.x,a.z)},Object.defineProperty(b.prototype,"visible",{get:function(){return this.unit&&this.unit.isInvishibel()&&!this.unit.isMain?!1:this._visible},set:function(a){if(this._visible=a,this._partDic&&this._partDic[b.WEAPON_PART])for(var c=0,d=this._partDic[b.WEAPON_PART];c<d.length;c++){var e=d[c];e.sceneVisible=a}this._wingDisplay&&(this._wingDisplay.visible=a),this._charBloodVo&&(this._charBloodVo.visible=a),this._charNameVo&&(this._charNameVo.visible=a),this._charTitleVo&&(this._charTitleVo.visible=a)},enumerable:!0,configurable:!0}),b.prototype.update=function(){if(this._skinMesh&&(a.prototype.update.call(this),this._showHitBox)){if(!this.lineSprite){ProgrmaManager.getInstance().registe(LineDisplayShader.LineShader,new LineDisplayShader),this.lineSprite=new LineDisplaySprite,this.lineSprite.clear();for(var b=0;b<this.triIndex.length/3;b++){var c=this._skinMesh.hitPosItem[this.triIndex[3*b+0]],d=this._skinMesh.hitPosItem[this.triIndex[3*b+1]],e=this._skinMesh.hitPosItem[this.triIndex[3*b+2]];this.lineSprite.makeLineMode(c,d),this.lineSprite.makeLineMode(d,e),this.lineSprite.makeLineMode(e,c)}this.lineSprite.upToGpu()}this.lineSprite.posMatrix=this.posMatrix.clone(),this.lineSprite.update()}},b.prototype.mouseClik=function(a,b){var c=Scene_data.cam3D.cameraMatrix.transformVector(this.getCurrentPos());if(c.z<Scene_data.cam3D.distance/3)return null;var d=MathUtil.math3DWorldtoDisplay2DPos(b);if(this._skinMesh){this.hitBox2DItem||(this.hitBox2DItem=new Array),this.hitBox2DItem.length=0;for(var e=0;e<this._skinMesh.hitPosItem.length;e++){var f=this.posMatrix.transformVector(this._skinMesh.hitPosItem[e]);this.hitBox2DItem.push(MathUtil.math3DWorldtoDisplay2DPos(f))}for(var g=0;g<this.triIndex.length/3;g++)if(TestTriangle.baseTri.p1=this.hitBox2DItem[this.triIndex[3*g+0]],TestTriangle.baseTri.p2=this.hitBox2DItem[this.triIndex[3*g+1]],TestTriangle.baseTri.p3=this.hitBox2DItem[this.triIndex[3*g+2]],TestTriangle.baseTri.checkPointIn(d))return!0}else if(Vector2D.distance(d,MathUtil.math3DWorldtoDisplay2DPos(this.posMatrix.position))<20)return!0;return!1},b.WEAPON_PART="weapon",b.WEAPON_DEFAULT_SLOT="w_01",b.MOUNT_SLOT="mount_01",b.WING_SLOT="wing_01",b.SEL_PART="select",b.NONE_SLOT="none",b.Defaul_Man_Avatar=2002,b.Defaul_WoMan_Avater=2012,b}(SceneBaseChar),MainCharControlModel=function(){function a(){this.singingToPos=new Vector2D,this.lastOutStr=""}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.update=function(a){var b=GameInstance.mainChar;b.jumpItem||b._speedDirect&&((b.curentAction==CharAction.WALK||b.curentAction==CharAction.WALK_MOUNT||b.isSinging)&&this.walkDirect(a),b.refreshY())},a.prototype.frameUpData=function(){var b=GameInstance.mainChar;if(b.isDeath)return!0;if(GameInstance.useYaoGan)return!0;if(AotuSkillManager.getInstance().aotuBattle){if(b.isSinging&&GameInstance.mainChar.skillVo&&1==tb.TB_skill_base.get_TB_skill_base(GameInstance.mainChar.skillVo.tbSkillId).can_move){if(GameInstance.attackTarget?GameInstance.attackTarget.onStage||(GameInstance.attackTarget=null):(console.log("没有对像"),GameInstance.attackTarget=RelationManager.getInstance().findNearCanAttackScene()),GameInstance.attackTarget&&GameInstance.attackTarget.onStage){var c=GameInstance.attackTarget.getAstarPos();if(Vector2D.distance(c,this.singingToPos)>3){this.singingToPos=c;var d=AstarUtil.findPath2D(b.getAstarPos(),c);d&&d.length&&a.getInstance().setWalkPathFun(d)}}return!0}}else{if(!GameInstance.attackTarget)return!0;if(GameInstance.attackTarget.unit.isPlayer())return!0;GameInstance.attackTarget.onStage||(GameInstance.attackTarget=null)}return!1},a.prototype.setSpeedDirect=function(a){var b=GameInstance.mainChar;b.isDeath||b.setSpeedDirect(a)},a.prototype.sendStop=function(){var a=GameInstance.mainChar;if(a.stopMove(),a.unit){var b=[a.getAstarPos(),a.getAstarPos()];a.unit.sendPath(b)}},a.prototype.sendPath=function(a){var b=GameInstance.mainChar;b.unit&&b.unit.sendPath(a)},a.prototype.setWalkPathFun=function(a,b){if(void 0===b&&(b=null),SceneManager.getInstance().ready){var c=GameInstance.mainChar;this.sendPath(a),a.shift(),c.applyWalk(a),c.walkCompleteBackFun=b}},a.prototype.clikEat=function(){var a=tb.SkillData.getCdMeshBySkillId(SharedDef.PLAYER_INT_FIELD_RESTORE_POTION_CD);(isNaN(a)||a-TimeUtil.getTimer()<0)&&(tb.SkillData.setCdMeshData(SharedDef.PLAYER_INT_FIELD_RESTORE_POTION_CD,12e3),NetManager.getInstance().protocolos.use_restore_potion())},a.prototype.downMount=function(){var a=GameInstance.mainChar;a.isMount&&(a.unit.setDownMount(),a.setMount())},a.prototype.isWalkOrStand=function(){var a=GameInstance.mainChar,b=a.unit.buffUnit;for(var c in b.item)if(152==Number(c))return console.log("有吟唱buff时可移动"),!0;if(a.isMount)return!0;var d=a.getCurrentAction();return d==CharAction.WALK||d==CharAction.STANAD?!0:!1},a.prototype.isWalk=function(){var a=GameInstance.mainChar,b=a.getCurrentAction();return b==CharAction.WALK||b==CharAction.WALK_MOUNT||a.isSinging?!0:!1},a.prototype.walkDirect=function(a){a=Math.min(Math.max(1e3/60,a),30);var b=GameInstance.mainChar;if(this.nextAstartNoCanWalk){var c=this.getNearFiledRoad();return void(c&&this.walkToNearPosBy2D(c,a))}var d=a*b.speedTX,e=new Vector3D,f=b._speedDirect.x*d,g=b._speedDirect.z*d;b.toRotationY=180*-Math.atan2(g,f)/Math.PI+90,e.x=b.px+f,e.z=b.pz+g,AstarUtil.getPosIsCanMove(e)&&(b.px=e.x,b.pz=e.z),bottomui.Progress_line.getInstance()&&bottomui.Progress_line.getInstance().hide()},a.prototype.walkToNearPosBy2D=function(a,b){var c=GameInstance.mainChar,d=b*c.speedTX,e=c.getCurrentPos(),f=AstarUtil.getWorldPosByStart2D(a),g=f.subtract(e);g.y=0,g.normalize(),g.scaleBy(d);for(var h,i=0,j=new Vector3D(c.px,c.py,c.pz),k=new Matrix3D;60>i;){
if(k.identity(),k.appendRotation(0+i,Vector3D.Y_AXIS),h=k.transformVector(g),h.x=c.px+h.x,h.z=c.pz+h.z,AstarUtil.getPosIsCanMove(h)){j=h;break}if(k.identity(),k.appendRotation(0-i,Vector3D.Y_AXIS),h=k.transformVector(g),h.x=c.px+h.x,h.z=c.pz+h.z,AstarUtil.getPosIsCanMove(h)){j=h;break}i++}AstarUtil.getPosIsCanMove(j)&&(c.px=j.x,c.pz=j.z)},a.prototype.getNearFiledRoad=function(){var a=GameInstance.mainChar,b=a.getAstarPos();if(!b)return null;var c=b.x,d=b.y,e=new Array,f=new Array;f.push(new Vector2D(c-1,d-1)),f.push(new Vector2D(c,d-1)),f.push(new Vector2D(c+1,d-1)),f.push(new Vector2D(c-1,d)),f.push(new Vector2D(c,d)),f.push(new Vector2D(c+1,d)),f.push(new Vector2D(c-1,d+1)),f.push(new Vector2D(c,d+1)),f.push(new Vector2D(c+1,d+1)),e.push(f[5]),e.push(f[8]),e.push(f[7]),e.push(f[6]),e.push(f[3]),e.push(f[0]),e.push(f[1]),e.push(f[2]);for(var g="",h=0;h<f.length;h++)g+=AstarUtil.isGridCanWalk(f[h])?"1,":"0,",h%3==2&&(g+="\n");for(var i=this.lastOutStr.length!=g.length,j=0;j<this.lastOutStr.length;j++)this.lastOutStr[j]!=g[j]&&(i=!0);var k=180*-Math.atan2(a._speedDirect.z,a._speedDirect.x)/Math.PI;k=(k%360+360)%360;for(var l=45,m=Math.floor((k+l/2)/l),n=1;3>n;){var o=(m+n+8)%8,p=(m-n+8)%8,q=e[o],r=e[p];if(AstarUtil.isGridCanWalk(q)||AstarUtil.isGridCanWalk(r)){if(AstarUtil.isGridCanWalk(q)&&AstarUtil.isGridCanWalk(r));else{if(AstarUtil.isGridCanWalk(q))return q;if(AstarUtil.isGridCanWalk(r))return r}n=3;break}n++}return this.lastOutStr=g,null},Object.defineProperty(a.prototype,"nextAstartNoCanWalk",{get:function(){var a=GameInstance.mainChar,b=5*a._speedDirect.x,c=5*a._speedDirect.z,d=new Vector3D;return d.x=a.px+b,d.z=a.pz+c,AstarUtil.getPosIsCanMove(d)?!1:!0},enumerable:!0,configurable:!0}),a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),WarningEffectChar=function(a){function b(){var b=a.call(this)||this;return b.shadow=!1,b}return __extends(b,a),b.prototype.removeStage=function(){a.prototype.removeStage.call(this)},b.prototype.showBlood=function(a){void 0===a&&(a=0)},b.prototype.updateFrame=function(b){this._disappearTm<TimeUtil.getTimer()?SceneManager.getInstance().removeMovieDisplay(this):a.prototype.updateFrame.call(this,b)},b.prototype.setSpellName=function(a){this.addPart("abc","cde",getModelUrl(String(a))),this.tittleHeight=20,this._disappearTm=TimeUtil.getTimer()+2e3},b.prototype.addStage=function(){a.prototype.addStage.call(this)},b}(SceneChar),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MountChar=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.setData=function(a,b){if(b>0){var c=TableData.getInstance().getData(TableData.tb_mount_illusion,b),d=c.mountID;return void this.setAvatar(d)}if(a>0){var c=TableData.getInstance().getData(TableData.tb_mount_base,a),d=c.mountID;this.setAvatar(d)}},b}(SceneBaseChar),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneBaseCollection=function(a){function b(){return a.call(this)||this}return __extends(b,a),b}(SceneChar),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ScenePortal=function(a){function b(){var b=a.call(this)||this;return b.shadow=!1,b}return __extends(b,a),b.prototype.removeStage=function(){a.prototype.removeStage.call(this)},b.prototype.showBlood=function(a){void 0===a&&(a=0)},b.prototype.setAvatar=function(a){this.addPart("abc","cde",getModelUrl(String(a))),this.tittleHeight=20},b.prototype.addStage=function(){a.prototype.addStage.call(this)},b}(SceneChar),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneLoot=function(a){function b(){var b=a.call(this)||this;return b.shadow=!0,b}return __extends(b,a),b.prototype.removeStage=function(){a.prototype.removeStage.call(this)},b.prototype.showBlood=function(a){void 0===a&&(a=0)},b.prototype.setAvatar=function(a){this.addPart("abc","cde",getModelUrl(String(a))),this.tittleHeight=20},b.prototype.addStage=function(){a.prototype.addStage.call(this)},Object.defineProperty(b.prototype,"loot",{get:function(){return this.unit},enumerable:!0,configurable:!0}),b.prototype.getOwnderGuid=function(){return this.loot.getOwnerGuid(this.lootIndex)},b.prototype.showName=function(a){void 0===a&&(a=null),this._charNameVo?this._charNameVo.name=a:this._charNameVo=BloodManager.getInstance().getCharNameMeshVo(a),this.refreshPos()},Object.defineProperty(b.prototype,"px",{get:function(){return this._px},set:function(a){this._px=a,this.x=a,this.refreshPos()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"py",{get:function(){return this._py},set:function(a){this._py=a,this.y=a,this.refreshPos()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"pz",{get:function(){return this._pz},set:function(a){this._pz=a,this.z=a,this.refreshPos()},enumerable:!0,configurable:!0}),b}(SceneChar),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneCollection=function(a){function b(){var b=a.call(this)||this;return b._currentOprateState=!1,b}return __extends(b,a),b.prototype.showBlood=function(a){void 0===a&&(a=0)},b.prototype.setSpecialType=function(a){this._specialType=a},b.prototype.isBx=function(){return 1==this._specialType},b.prototype.getBossInfo=function(a){var b=GuidData.globelValue.getCurrentBossInfo(),c=1e3*GameInstance.getGameSecond(b.time);return console.log("boss时间-------------------"+c),b.outTime=c,b},b.prototype.setOprateState=function(a){var b=this.unit.getPickName(),c=GameInstance.mainChar.unit.getName(),d=!1;d=a?""!=b&&c!=b?!1:!0:!1,d!=this._currentOprateState&&(d?this.showOprateState():this.hideOprateState(),this._currentOprateState=d)},b.prototype.changeState=function(){var a=this.unit.getPickName(),b=GameInstance.mainChar.unit.getName();console.log("当前正在采集:"+a+"当前名字："+b);var c=this.unit.getPickTime();console.log("采集时间:"+c),c=5e3;var d=new boss.BossEvent(boss.BossEvent.CHEST_CHANGE_EVENT);d.data={name:a,time:c},ModuleEventManager.dispatchEvent(d)},b.prototype.showOprateState=function(){var a=this,b=new mainUi.MainOperatEvent(mainUi.MainOperatEvent.SHOW_MAIN_OPERAT_EVENT);b.data=null,b.triggerOne=!1,b.fun=function(b){NetManager.getInstance().protocolos.use_broadcast_gameobject(a.unit.getUintGuid())},ModuleEventManager.dispatchEvent(b)},b.prototype.hideOprateState=function(){var a=new mainUi.MainOperatEvent(mainUi.MainOperatEvent.HIDE_MAIN_OPERAT_EVENT);ModuleEventManager.dispatchEvent(a)},b.prototype.destory=function(){a.prototype.destory.call(this),1==this._specialType&&this.hideOprateState()},b}(SceneChar),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillServesVo=function(){function a(){}return a}(),BuffUnit=function(){function a(a){this.unit=a}return a.prototype.changeBuffById=function(a){var b=a>>1,c=1&a,d=this.unit.GetUInt16(SharedDef.UNIT_FIELD_BUFF+b,c),e=this.unit.GetUInt16(SharedDef.UNIT_FIELD_BUFF_TM+b,c);if(0!=d){var f=e;this.item[d]=TimeUtil.getTimer()+1e3*f}},a.prototype.getBuffGiverByBuffId=function(a){for(var b=0;b<SharedDef.MAX_UNIT_BUFF;b++){var c=b>>1,d=1&b,e=this.unit.GetUInt16(SharedDef.UNIT_FIELD_BUFF+c,d);if(a==e)return this.unit.GetUInt32(SharedDef.UNIT_FIELD_BUFF_CASTER_GUID+b)}return-1},a.prototype.resetAllBufData=function(){this.item=new Object;for(var a=0;a<SharedDef.MAX_UNIT_BUFF;a++)this.changeBuffById(a);this.resetVisible()},a.prototype.resetVisible=function(){this.unit.sceneChar&&this.unit.sceneChar.showName(),this.unit.isMain&&ModuleEventManager.dispatchEvent(new topui.TopUiEvent(topui.TopUiEvent.REFRESH_TOP_LEFT_BUFF))},a.prototype.isBuffNeedGetByID=function(a){var b=!1,c=a>>1,d=1&a,e=this.unit.GetUInt16(SharedDef.UNIT_FIELD_BUFF+c,d);this.unit.GetUInt16(SharedDef.UNIT_FIELD_BUFF_TM+c,d);return 0!=e&&(b=!0),b},a.prototype.getSubscribeInfo=function(){for(var a=!1,b=SharedDef.UNIT_FIELD_BUFF_CASTER_GUID;b<SharedDef.UNIT_FIELD_FORCE;b++){var c=b-SharedDef.UNIT_FIELD_BUFF_CASTER_GUID;this.isBuffNeedGetByID(c)&&(a=!0)}a?NetManager.getInstance().protocolos.clientSubscription(this.unit.uintGuid):(this.item=null,this.resetVisible())},a.prototype.isBuffByID=function(a){return this.item&&this.item[a]?!0:!1},a}(),Unit=function(a){function b(b){void 0===b&&(b="");var c=a.call(this,b)||this;return c.path=new Array,c.isMain=!1,c.originalRotation=0,c._hasCreated=!1,c.tempSendPath=new Array,c}return __extends(b,a),b.prototype.ReadFromCopy=function(b,c,d){return void 0===d&&(d=null),this.buffUnit||(this.buffUnit=new BuffUnit(this)),a.prototype.ReadFrom.call(this,b,c,d)},b.prototype.ReadFrom=function(a,b,c){if(void 0===c&&(c=null),!this.ReadFromCopy(a,b,c))return!1;if(a&SyncEvent.OBJ_OPT_NEW){var d=b.readShort(),e=b.readShort(),f=d,g=e;this.path.push(new Vector2D(f,g));for(var h=b.readShort(),i=0;h>i;i+=2)f+=b.readByte(),g+=b.readByte(),this.path.push(new Vector2D(f,g));var j=b.readFloat()-Math.PI;this.originalRotation=-radian2angle(j),this.onCreated()}return!0},b.prototype.onBaseCreated=function(){var a=this;this.buffUnit=new BuffUnit(this),this._after_update=function(b,c,d){a.dataUpdate(c,d)}},b.prototype.getUnitStringFieldGroupPeaceId=function(){return this.GetStr(SharedDef.UNIT_STRING_FIELD_FACTION_GUID)},b.prototype.getUnitStringFieldFactionGuid=function(){return this.GetStr(SharedDef.UNIT_STRING_FIELD_FACTION_GUID)},b.prototype.dataUpdate=function(a,b){var c=new Object;for(var d in a){var e=Number(d);if(!(e<SharedDef.UNIT_FIELD_BUFF_CASTER_GUID||e>=SharedDef.UNIT_FIELD_FORCE)){var f=e-SharedDef.UNIT_FIELD_BUFF_CASTER_GUID;c[f]||(c[f]=1)}}var g=!1;for(var h in c)g=!0;g&&this.buffUnit.getSubscribeInfo()},b.prototype.onCreated=function(){var a=this;this.uintGuid=ObjectDef.getGUIDIndex(this._guid),this.buffUnit.getSubscribeInfo();var b;b=this._hasCreated?this.sceneChar?!0:!1:SceneCharManager.getInstance().creatChar(this),b&&(this._hasCreated||(this.sceneChar.moveToPos2D=this.path[0],!this.isMain&&this.path.length>1&&(this.path.shift(),this.sceneChar.applyWalk(this.path))),this.sceneChar.speedUseTime=this.getSpeed(),this.sceneChar.forceRotationY=this.originalRotation,this.sceneChar.setAstarNrmAndRotation(),this.sceneChar.refreshHP(),RelationManager.getInstance().refresh()),this.sceneChar.isBoss=this.getIsBoss(),this._hasCreated||(this.AddListen(SharedDef.UNIT_FIELD_MOVE_SPEED,function(b){a.sceneChar.refreshSpeed()}),this.AddListen(SharedDef.UNIT_FIELD_EQUIPMENT_COAT,function(b){a.changeCoat()}),this.AddListen(SharedDef.UNIT_FIELD_EQUIPMENT_MAIN_WEAPON,function(b){a.changeWeapon()}),this.AddListen(SharedDef.UNIT_FIELD_DIVINE_ID,function(b){a.changeWeapon()}),this.AddListen(SharedDef.UNIT_FIELD_ANGER,function(b){a.changeAnger()}),this.AddListen(SharedDef.UNIT_FIELD_MOUNT_LEVEL,function(b){a.mountChange()}),this.AddListen(SharedDef.UINT_INT_FIELD_WINGS_RANK,function(b){a.wingChange()}),this.AddListen(SharedDef.UNIT_FIELD_MAX_HEALTH,function(b){a.sceneChar.refreshHP()}),this.AddListen(SharedDef.UNIT_FIELD_BYTE_0,function(b){a.sceneChar.unitFieldByteChg()}),this.AddListen(SharedDef.UINT_FIELD_XIANFU_INFO,function(b){a.sceneChar.refreshTittle()}),this.AddListen(SharedDef.UNIT_FIELD_BYTE_2,function(b){a.sceneChar.refreshTittle()}),this.AddListen(SharedDef.UINT_INT_FIELD_ILLUSION,function(b){a.sceneChar.refreshIllusion()}),this.AddListenString(SharedDef.UNIT_STRING_FIELD_PICK_NAME,function(b){a.sceneChar instanceof SceneCollection&&a.sceneChar.changeState()}),this.AddListenString(SharedDef.BINLOG_STRING_FIELD_OWNER,function(a){RelationManager.getInstance().refresh()}),this._hasCreated=!0)},b.prototype.getIllusionId=function(){return this.GetUInt32(SharedDef.UINT_INT_FIELD_ILLUSION)},b.prototype.isInvishibel=function(){return this.buffUnit.isBuffByID(SharedDef.BUFF_INVISIBLE)},b.prototype.isBuffRoad=function(){return this.buffUnit.isBuffByID(SharedDef.BUFF_ROAR)},b.prototype.getXianfuBaoXiang=function(){return this.GetByte(SharedDef.UINT_FIELD_XIANFU_INFO,0)},b.prototype.getForce=function(){return Math.floor(this.GetDouble(SharedDef.UNIT_FIELD_FORCE))},b.prototype.mountChange=function(){this.sceneChar.setMount()},b.prototype.wingChange=function(){this.sceneChar.setWing()},b.prototype.getWing=function(){return this.GetUInt32(SharedDef.UINT_INT_FIELD_WINGS_RANK)},b.prototype.hasMount=function(){return 1==this.GetByte(SharedDef.UNIT_FIELD_MOUNT_LEVEL,2)},b.prototype.setDownMount=function(){this.SetByte(SharedDef.UNIT_FIELD_MOUNT_LEVEL,2,0)},b.prototype.getMountRank=function(){return this.GetByte(SharedDef.UNIT_FIELD_MOUNT_LEVEL,0)},b.prototype.getMountIllusionID=function(){return this.GetByte(SharedDef.UNIT_FIELD_MOUNT_LEVEL,3)},b.prototype.changeAnger=function(){this.sceneChar&&this.sceneChar.refreshTittle()},b.prototype.changeCoat=function(){this.sceneChar&&this.sceneChar.setAvatarExterior()},b.prototype.changeWeapon=function(){this.sceneChar.setWeaponDivine()},b.prototype.getTabelAvater=function(a){var b;return b=0==a?tb.TB_char_info.getTempVo(this.getCharType()).avatar:tb.TB_appearance_info.getTempVo(a).avatar},b.prototype.getAvatar=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_EQUIPMENT_COAT)},b.prototype.getDivine=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_DIVINE_ID)},b.prototype.getWeapon=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_EQUIPMENT_MAIN_WEAPON)},b.prototype.getCharType=function(){return this.GetUInt8(SharedDef.UNIT_FIELD_BYTE_1,0)},b.prototype.getCharTittle=function(){return this.GetUInt8(SharedDef.UNIT_FIELD_BYTE_2,3)},b.prototype.getPickName=function(){return this.GetStr(SharedDef.UNIT_STRING_FIELD_PICK_NAME)},b.prototype.getPickTime=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_PROCESS_TIME)},b.prototype.sendPath=function(a){if(this.isMain){var b=a[0];this.tempSendPath.length=0;for(var c=1;c<a.length;c++)this.tempSendPath.push(a[c].x-a[c-1].x,a[c].y-a[c-1].y);b||console.log("有错"),NetManager.getInstance().protocolos.unit_move(this.uintGuid,b.x,b.y,this.tempSendPath)}},b.prototype.sendStop=function(a){this.isMain&&NetManager.getInstance().protocolos.move_stop(this.uintGuid,a.x,a.y)},b.prototype.setSceneChar=function(a){a&&(this.sceneChar=a,a.unit=this)},b.prototype.setPath=function(a){!this.isMain&&this.sceneChar&&this.sceneChar.applyWalk(a)},b.prototype.setJump=function(a){if(this.sceneChar){var b=new Array,c=AstarUtil.getWorldPosByStart2D(a);c.y=AstarUtil.getHeightByPos(c),b.push(this.sceneChar.getCurrentPos()),b.push(c),this.sceneChar.applyJump(b,1e3)}},b.prototype.msgSpellStop=function(){this.sceneChar&&this.sceneChar.msgSpellStop()},b.prototype.setJumpShow=function(a,b){if(this.sceneChar){var c=new Array;c.push(this.sceneChar.getCurrentPos());for(var d=0;d<a.length;d++){var e=AstarUtil.getWorldPosByStart2D(new Vector2D(a[d][0],a[d][1]));e.y=AstarUtil.getHeightByPos(e),this.sceneChar.isMount&&d<a.length-1&&(e.y-=40),c.push(e)}}this.sceneChar.applyJump(c,b)},b.prototype.stop=function(a,b){this.sceneChar&&(this.sceneChar.moveToPos2D=new Vector2D(a,b))},b.prototype.dispose=function(){this.sceneChar&&SceneCharManager.getInstance().removeSceneChar(this.sceneChar),a.prototype.dispose.call(this)},b.prototype.getSpeed=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_MOVE_SPEED)},b.prototype.getLevel=function(){return this.GetUInt16(SharedDef.UNIT_FIELD_UINT16_0,1)},b.prototype.getVipLevel=function(){return this.GetUInt32(SharedDef.UINT_FIELD_VIP_LEVEL)},b.prototype.getHp=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_HEALTH)},b.prototype.getAnger=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_ANGER)},b.prototype.setHp=function(a){this.SetUInt32(SharedDef.UNIT_FIELD_HEALTH,a)},b.prototype.getMaxHp=function(){return this.GetUInt32(SharedDef.UNIT_FIELD_MAX_HEALTH)},b.prototype.getCurHpView=function(){return Math.floor(this.getHp()/100)},b.prototype.getMaxHpView=function(){return Math.floor(this.getMaxHp()/100)},b.prototype.getTypeID=function(){return this.GetByte(SharedDef.UNIT_FIELD_BYTE_0,0)},b.prototype.getAlivestate=function(){return this.GetByte(SharedDef.UNIT_FIELD_BYTE_0,1)},b.prototype.getEntry=function(){return this.GetUInt16(SharedDef.UNIT_FIELD_UINT16_0,0)},b.prototype.getIsBoss=function(){return this.GetBit(SharedDef.UNIT_FIELD_FLAGS,SharedDef.UNIT_FIELD_FLAGS_IS_BOSS_CREATURE)},b.prototype.isMonster=function(){return this.getTypeID()==SharedDef.TYPEID_UNIT&&0==this.GetUInt32(SharedDef.UNIT_FIELD_NPC_FLAG)},b.prototype.isNpc=function(){return this.getTypeID()==SharedDef.TYPEID_UNIT&&1==this.GetUInt32(SharedDef.UNIT_FIELD_NPC_FLAG)},b.prototype.isSkillNpc=function(){return this.GetBit(SharedDef.UNIT_FIELD_FLAGS,SharedDef.UNIT_FIELD_FLAGS_IS_INVISIBLE_SPELL)},b.prototype.getOwner=function(){return this.GetStr(SharedDef.BINLOG_STRING_FIELD_OWNER)},b.prototype.isPlayer=function(){return this.getTypeID()==SharedDef.TYPEID_PLAYER},b.prototype.getPlayerGUID=function(){var a=this.getGuid(),b=a.split(".");return 3==b.length?b[1]+"."+b[2]:""},b.prototype.getUintGuid=function(){var a=this.getGuid();return a=a.substring(1),Number(a)},b}(GuidObject),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Loot=function(a){function b(b){void 0===b&&(b="");var c=a.call(this,b)||this;return c.gridWidth=0,c.lootCount=0,c.sceneLootDic=new Object,c}return __extends(b,a),b.prototype.ReadFrom=function(b,c,d){return void 0===d&&(d=null),a.prototype.ReadFromCopy.call(this,b,c,d)?(b&SyncEvent.OBJ_OPT_NEW&&this.onCreated(),!0):!1},b.prototype.onCreated=function(){this.readBaseData()},b.prototype.readBaseData=function(){var a=this.GetUInt16(SharedDef.LOOT_PUBLIC_INT_START_POS,0),b=this.GetUInt16(SharedDef.LOOT_PUBLIC_INT_START_POS,1),c=this.GetUInt16(SharedDef.LOOT_PUBLIC_INT_END_POS,0),d=this.GetUInt16(SharedDef.LOOT_PUBLIC_INT_END_POS,1);this.gridtx=a,this.gridty=b,this.gridWidth=(c-a>>1)+1,this.lootCount=((c-a>>1)+1)*((d-b>>1)+1),this.readAry()},b.prototype.readAry=function(){for(var a=0;a<this.lootCount;++a){var b=SharedDef.LOOT_PUBLIC_INT_BEGIN+a*SharedDef.MAX_LOOT_PUBLIC_INT_FIELD;if(b<this._uint32_values_len){var c=this.GetUInt32(b+SharedDef.LOOT_PUBLIC_INT_ENTRY);if(c>0){var d=a%this.gridWidth,e=Math.floor(a/this.gridWidth),f=(d<<1)+this.gridtx,g=(e<<1)+this.gridty;if(!this.sceneLootDic[a]){var h=this.getSceneLoot(),i=tb.TB_item_template.get_TB_item_template(c);h.setAvatar(i.avatar),h.lootIndex=a,h.forceRotationY=180-Scene_data.gameAngle,h.gridX=f,h.gridY=g,h.unit=this,console.log("grix----------",f,g,a,this.gridtx,this.gridty,this.gridWidth,this.lootCount),h.moveToPos2D=new Vector2D(f,g),GameInstance.addSceneChar(h),this.sceneLootDic[a]=h}}else if(this.sceneLootDic[a]){var h=this.sceneLootDic[a];GameInstance.removeSceneChar(h),this.sceneLootDic[a]=null,delete this.sceneLootDic[a]}}}},b.prototype.getOwnerGuid=function(a){return this.GetStr(SharedDef.LOOT_STR_FIELD_BEGIN+a*SharedDef.MAX_LOOT_PUBLIC_STR_FIELD+SharedDef.LOOT_PUBLIC_STR_OWNER)},b.prototype.dataUpdate=function(a,b){this.readBaseData()},b.prototype.getSceneLoot=function(){var a=new SceneLoot;return a.x=0,a.y=2,a.z=0,a.setShadowSize(10),a},b.prototype.getLootIndxByGuid=function(a){var b=a.split(".");return Number(b[1])},b.prototype.dispose=function(){a.prototype.dispose.call(this);for(var b in this.sceneLootDic){var c=this.sceneLootDic[b];c&&GameInstance.removeSceneChar(c)}},b}(Unit),keyProp=["生命","攻击","防御","命中","闪避","暴击","抗暴","攻速","移速","破防","忽视闪避","生命值回复","伤害加深","伤害减免","反弹伤害","吸血","回复效率","暴击","抗暴","暴击伤害","暴伤减免","命中率","闪避率","眩晕","定身","沉默","混乱","魅惑","控制增强","控制减免","防御"],btnClickTime=300,professionalKey=["","枪客","枪客","道士","道士","剑客","剑客"],quaColorAry=[ColorType.Whitefff4d6,ColorType.color2daa35,ColorType.color4392ff,ColorType.colorb759ff,ColorType.colorff7200,ColorType.colorce0a00],__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),RedPointManager=function(){function a(){this._dic=new Object}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.init=function(){this._root=new RedPointNode,this._root.isRoot=!0;for(var a=TableData.getInstance().getTabMaxID(TableData.tb_red_point),b=1;a>=b;b++){var c=TableData.getInstance().getData(TableData.tb_red_point,b);if(c&&c.parent>=0){var d=new RedPointNode;d.id=c.id,d.name=c.desc,c.parent?d.parent=this._dic[c.parent]:d.parent=this._root,d.parent.addChild(d),c.list&&(d.isList=!0),this._dic[c.id]=d}}this.initAtlas()},a.prototype.initAtlas=function(){var a=new UIAtlas,b=UIManager.getInstance().getContext2D(64,64);UiDraw.cxtDrawImg(b,PuiData.A_RED_POINT,new Rectangle(0,0,17,16),UIData.publicUi),UiDraw.cxtDrawImg(b,PuiData.A_JIANTOU,new Rectangle(20,0,26,33),UIData.publicUi);var c=TextureManager.getInstance().getCanvasTexture(b);a.textureRes=c,a.configData=new Array,a.layoutData=new Object,a.configData.push(this.getConfigData("Style",new Rectangle(0,0,17,16),64,64)),a.configData.push(this.getConfigData("Style1",new Rectangle(20,0,26,33),64,64)),a.layoutData.s0=this.getLayoutData(new Rectangle(0,0,17,16),"Style","style"),a.layoutData.s1=this.getLayoutData(new Rectangle(0,0,26,33),"Style1","style1"),this.uiAtlas=a},a.prototype.getLayoutData=function(a,b,c){var d=new Array,e=new Object;return e.type=0,e.rect=a,e.dataItem=[b],e.name=c,d.push(e),e.item=d,{item:[e]}},a.prototype.getConfigData=function(a,b,c,d){var e=new Object;return e.x=b.x/c,e.y=b.y/d,e.width=b.width/c,e.height=b.height/d,e.ow=b.width,e.oh=b.height,e.ox=b.x,e.oy=b.y,e.type=0,e.cellX=0,e.cellY=0,e.name=a,e},a.prototype.getNodeByID=function(a){return this._dic[a]},a}(),RedPointRender=function(a){function b(){var b=a.call(this)||this;return b._getSrcList=new Array,b.uiAtlas=RedPointManager.getInstance().uiAtlas,b}return __extends(b,a),b.prototype.getRedPointUI=function(a,b,c,d){void 0===d&&(d="style");var e=this.getRedPointComponent(d);if(e.preParent=a,e.x=c.x-16,e.y=c.y,b>0){var f=RedPointManager.getInstance().getNodeByID(b);f.bindUI(e),e.node=f}return e},b.prototype.getRedPointComponent=function(a){var b=this.uiAtlas.getLayoutData(a),c=this.creatRedPointComponent(b.dataItem[0]);return c.width=b.rect.width,c.height=b.rect.height,c.x=b.rect.x,c.y=b.rect.y,c.baseRec=b.rect,c.name=a,this._getSrcList.push(c),c},b.prototype.creatRedPointComponent=function(a){var b=new RedPointCompenent;b.skinName=a;var c=this.uiAtlas.getRec(a);return b.tr.setRec(c),b.width=c.pixelWitdh,b.height=c.pixelHeight,b.uiRender=this,b},b.prototype.dispose=function(){this.uiAtlas=null;for(var b=0;b<this._getSrcList.length;b++){var c=this._getSrcList[b];c.node&&c.node.unBind()}a.prototype.dispose.call(this)},b.prototype.update=function(){a.prototype.update.call(this);for(var b=1+.1*(Math.sin(.008*TimeUtil.getTimer())+1),c=0;c<this._uiList.length;c++)this._uiList[c].uvScale=b},b}(UIRenderComponent),RedPointCompenent=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.bindNode=function(a){this.node&&this.node.unBind();var b=RedPointManager.getInstance().getNodeByID(a);b.bindUI(this),this.node=b},b.prototype.applyRenderSize=function(){if(this.parent){this.renderX=this.absoluteX/Scene_data.stageWidth,this.renderY=this.absoluteY/Scene_data.stageHeight,this.renderWidth=this.absoluteWidth/Scene_data.stageWidth,this.renderHeight=this.absoluteHeight/Scene_data.stageHeight;var a=Math.abs(this._uvScale);this.renderData[0]=this.renderX+this.renderWidth*(1-a)*.5,this.renderData[1]=this.renderY+this.renderHeight*(1-a)*.5,this.renderData[2]=this.renderWidth*this.scale*a,this.renderData[3]=this.renderHeight*this.scale*a,this.renderData2[0]=this.tr.width,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x,this.renderData2[3]=this.tr.y,this.uiRender.makeRenderDataVc(this.vcId)}},b}(UICompenent),RedPointEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_REDPOINT_EVENT="SHOW_REDPOINT_EVENT",b.HIDE_REDPOINT_EVENT="HIDE_REDPOINT_EVENT",b}(BaseEvent),RedPointNode=function(){function a(){this.children=new Array,this.isList=!1,this.isRoot=!1,this._show=!1}return a.prototype.addChild=function(a){a.parent=this,this.children.push(a)},a.prototype.removeAllChild=function(){for(var a=0;a<this.children.length;a++)this.children[a].parent=null;this.children=[]},Object.defineProperty(a.prototype,"show",{get:function(){return this._show},set:function(a){if(this._show!=a){this._show=a,this.applyUI(),this.parent&&(a?this.parent.show=!0:this.parent.sunHide());var b;a?(b=new RedPointEvent(RedPointEvent.SHOW_REDPOINT_EVENT),b.node=this,ModuleEventManager.dispatchEvent(b)):(b=new RedPointEvent(RedPointEvent.HIDE_REDPOINT_EVENT),b.node=this,ModuleEventManager.dispatchEvent(b))}},enumerable:!0,configurable:!0}),a.prototype.sunHide=function(){for(var a=0;a<this.children.length;a++)if(this.children[a].show)return;this.show=!1},a.prototype.applyUI=function(){this._ui&&(this._show?this._ui.preShow():this._ui.preHide())},a.prototype.bindUI=function(a){this._ui=a,this.applyUI()},a.prototype.unBind=function(){this._ui&&this._ui.preHide(),this._ui=null},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SystemOpenData=function(){function a(){}return a}(),factionShopNumData=function(){function a(){}return a}(),SkillUintVo=function(){function a(){}return a}(),PlayerGuidObject=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.nextCanJumpTM=0,b.lastLevel=1,b}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;GuidData.player=this,this.loginTime(),this.initData(),this.AddListen(SharedDef.PLAYER_EXPAND_INT_TO_MAP,function(b){a.teleMap()}),this.AddListen(SharedDef.PLAYER_FIELD_LEVEL,function(b){a.playerFieldLevelChange()}),this.AddListen(SharedDef.PLAYER_FIELD_FORCE,function(b){a.playerFieldForceChange()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_MERIDIAN_FORCE,function(a){ModuleEventManager.dispatchEvent(new meridian.MeridianEvent(meridian.MeridianEvent.CHG_MERIDIAL_FORCE))}),this.AddListen(SharedDef.PLAYER_FIELD_VIP_LEVEL,function(b){a.playerFieldVipChange()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_RESTORE_POTION_CD,function(b){a.playIntFieldRestorePotioncd()}),this.AddListen(SharedDef.PLAYER_EXPAND_INT_XP,function(b){a.playerFieldExpandIntXpChange()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_DIVINE_ID,function(b){a.playerFieldDivineIdChange()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_TRIAL_PROCESS,function(b){a.playerIntFieldTrialProcess()}),this.AddListen(SharedDef.PLAYER_FIELD_EQUIPMENT+SharedDef.EQUIPMENT_TYPE_COAT,function(b){a.chgAvatar()}),this.AddListen(SharedDef.PLAYER_FIELD_EQUIPMENT+SharedDef.EQUIPMENT_TYPE_MAIN_WEAPON,function(b){a.chgWeapon()}),this.AddListen(SharedDef.PLAYER_FIELD_EQUIPMENT+SharedDef.EQUIPMENT_TYPE_MAIN_WEAPON,function(b){a.chgWeapon()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_REVENGE_TIMES,function(b){a.chgRevengeNum()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_TITLE_FORCE,function(b){a.titleforceChg()}),this.AddListenString(SharedDef.BINLOG_STRING_FIELD_NAME,function(b){a.Chgname()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_TALISMAN_FORCE,function(b){a.talismantotalzhanli()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_GROUP_INSTANCE_CLEAR_FLAG,function(b){a.teamflagchange()}),this.AddListen(SharedDef.PLAYER_APPD_INT_FIELD_MONEYTREE_GIFT_FLAG,function(b){a.moneyTreeChg()}),this.AddListen(SharedDef.PLAYER_FIELD_USE_RANK_LIKE,function(b){a.rankLikeChg()}),this.AddListen(SharedDef.PLAYER_APPD_INT_FIELD_RECHARGE_SUM,function(a){ModuleEventManager.dispatchEvent(new charbg.CharBgEvent(charbg.CharBgEvent.VIP_CHG_EVENT))}),this.AddListen(SharedDef.PLAYER_INT_FIELD_VIPGIFT_FLAG,function(a){ModuleEventManager.dispatchEvent(new charbg.CharBgEvent(charbg.CharBgEvent.VIP_GIFT_EVENT))}),this.AddListen(SharedDef.PLAYER_FIELD_MOUNT_FORCE,function(a){ModuleEventManager.dispatchEvent(new mountui.MountUiEvent(mountui.MountUiEvent.CHG_MOUNT_FORCE))}),this.AddListen(SharedDef.PLAYER_INT_FIELD_GUIDE_ID_LAST,function(a){console.log("上次完成的引导")}),this.AddListen(SharedDef.PLAYER_INT_FIELD_APPEARANCE,function(a){ModuleEventManager.dispatchEvent(new exterior.ExteriorEvent(exterior.ExteriorEvent.REFRISH_EXTERIOR_PANEL))}),this.AddListen(SharedDef.PLAYER_INT_FIELD_GUIDE_ID_NOW,function(b){console.log("当前进行中的引导"),a.changePlayerIntFieldGuid()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_MASS_BOSS_TIMES,function(a){ModuleEventManager.dispatchEvent(new sboss.SbossEvent(sboss.SbossEvent.REFRISH_SBOSS_PANEL))}),this.AddListen(SharedDef.PLAYER_FIELD_NOTORIETY,function(b){a.changeUnitFieldNotoriety()}),this.AddListen(SharedDef.PLAYER_INT_FIELD_MOUNT_LEVEL,function(b){a.changeHuanhuaMountLevel()}),this.AddListen(SharedDef.PLAYER_FIELD_BYTES_2,function(a){ModuleEventManager.dispatchEvent(new role.RoleUiEvent(role.RoleUiEvent.CHANGE_MY_Designation_EVENT))}),this.AddListen(SharedDef.PLAYER_INT_FIELD_REALMBREAK_LEVEL,function(a){ModuleEventManager.dispatchEvent(new stateup.StateUpEvent(stateup.StateUpEvent.REFRESH_LEV_PANEL)),ModuleEventManager.dispatchEvent(new stateup.StateUpEvent(stateup.StateUpEvent.POP_SHOW_PANEL))}),this.AddListen(SharedDef.PLAYER_INT_FIELD_REALMBREAK_EXP,function(a){ModuleEventManager.dispatchEvent(new stateup.StateUpEvent(stateup.StateUpEvent.REFRESH_EXP_PANEL))}),this.AddListen(SharedDef.PLAYER_INT_FIELD_REALMBREAK_DAILYQUEST_STATE,function(a){ModuleEventManager.dispatchEvent(new stateup.StateUpEvent(stateup.StateUpEvent.REFRESH_TASK_PANEL))}),this.AddListen(SharedDef.PLAYER_INT_FILED_FACTION_DONATE_GIFT_EXCHANGE_DAILY_COUNT,function(a){ModuleEventManager.dispatchEvent(new warehousetreasure.WarehouseEvent(warehousetreasure.WarehouseEvent.TREASURE_NUM_REFRESH))}),this.AddListen(SharedDef.PLAYER_INT_FIELD_FACTION_TOWER_FLAG,function(a){
ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONACTIVE_TRIP_CHANGE_EVENT))}),this._after_update=function(b,c,d){a.dataUpdate(c,d)},ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.playIntFieldRestorePotioncd=function(){var a=this.GetUInt32(SharedDef.PLAYER_INT_FIELD_RESTORE_POTION_CD);a-=GameInstance.getServerNow(),a=1e3*a,console.log("吃药CD变化",a),tb.SkillData.setCdMeshData(SharedDef.PLAYER_INT_FIELD_RESTORE_POTION_CD,a)},b.prototype.getPlayerIntFieldAppearance=function(a){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_APPEARANCE,a)},b.prototype.playerIntFieldTrialProcess=function(){ModuleEventManager.dispatchEvent(new adventureinfo.AdventurInfoEvent(adventureinfo.AdventurInfoEvent.ADVENTURE_TRIAL_PROCESS))},b.prototype.getPlayerIntFieldTrialProcessCur=function(){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_TRIAL_PROCESS,0)},b.prototype.getPlayerIntFieldTrialProcessTotal=function(){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_TRIAL_PROCESS,1)},b.prototype.getPlayerIntFieldTrialFinishedSectionid=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_TRIAL_FINISHED_SECTIONID)},b.prototype.getPlayerIntFieldMassBossBuyedTimes=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_MASS_BOSS_BUYED_TIMES)},b.prototype.getPlayerIntFieldMassBossTimes=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_MASS_BOSS_TIMES)},b.prototype.getPlayerIntFieldMassBossCd=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_MASS_BOSS_CD)},b.prototype.getPlayerIntFiledLevaeRiskTime=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FILED_LEAVE_RISK_TIME)},b.prototype.getPlaerExpAndIntLastLogoutTime=function(){return this.GetUInt32(SharedDef.PLAYER_EXPAND_INT_LAST_LOGOUT_TIME)},b.prototype.getPlayerIntFiledLeaveRiskPicked=function(){return 0},b.prototype.getPlayerIntFiledFactionDonateGiftExchangeDailyCount=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FILED_FACTION_DONATE_GIFT_EXCHANGE_DAILY_COUNT)},b.prototype.changePlayerIntFieldGuid=function(){ModuleEventManager.dispatchEvent(new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_GUIDE_POP_VIEW))},b.prototype.getPlayerIntFieldGuidIdLast=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_GUIDE_ID_LAST)},b.prototype.getPlayerIntFieldGuideIdNow=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_GUIDE_ID_NOW)},Object.defineProperty(b.prototype,"needGuididPop",{get:function(){return this.getPlayerIntFieldGuidIdLast()!=this.getPlayerIntFieldGuideIdNow()},enumerable:!0,configurable:!0}),b.prototype.jumpButcanClik=function(){return GuidData.player.nextCanJumpTM<TimeUtil.getTimer()},b.prototype.initData=function(){this.lastForceNum=this.getForce(),this.resetSystemItem(),this.resetSkillItem(),this.resetOptionalGuidItem()},b.prototype.resetSkillItem=function(){this.skillItem=this.getBaseSkillItem()},b.prototype.getPlayerIntFieldDailyQuestFinished=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_DAILY_QUEST_FINISHED)},b.prototype.getFactionstate=function(){console.log("帮派："+this.getFactionName())},b.prototype.getSocial_revenge_num=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_REVENGE_TIMES)},b.prototype.getSocial_friend_max_num=function(){return SharedDef.SOCIAL_FRIEND_MAX_NUM},b.prototype.getPlayerIntFieldWorld3V3Score1=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_WORLD_3V3_SCORE)},b.prototype.getPlayerIntFieldWorld3V3TotalScore1=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_WORLD_3V3_TOTAL_SCORE)},b.prototype.getPlayerIntFieldWorld3V3TrendInfo=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_WORLD_3V3_TREND_INFO)},b.prototype.getUnitfieldhook_num=function(){return this.GetUInt16(SharedDef.PLAYER_FIELD_HOOK_SHORT,0)},b.prototype.isPlayerIntFieldGroupClearFlag=function(a){return this.GetBit(SharedDef.PLAYER_INT_FIELD_GROUP_INSTANCE_CLEAR_FLAG,a)},b.prototype.getPlayerFieldDeclineChanel=function(){var a=new Array;return a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_DECLINE_CHANNEL_BYTE0,0)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_DECLINE_CHANNEL_BYTE0,1)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_DECLINE_CHANNEL_BYTE0,2)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_DECLINE_CHANNEL_BYTE0,3)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_DECLINE_CHANNEL_BYTE1,0)),a},b.prototype.getUnitfieldhook_id=function(){return this.GetUInt16(SharedDef.PLAYER_FIELD_HOOK_SHORT,1)},b.prototype.getHangUpResurrection=function(){return this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE3,0)},b.prototype.getHangupdata=function(){var a=new Array;return a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE0,0)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE0,1)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE0,2)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE0,3)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE1,0)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE1,1)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE1,2)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE1,3)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE3,1)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE3,2)),a.push(this.GetUInt8(SharedDef.PLAYER_FIELD_HOOK_BYTE3,3)),a},b.prototype.changeHuanhuaMountLevel=function(){var a=this.GetByte(SharedDef.PLAYER_INT_FIELD_MOUNT_LEVEL,2),b=this.GetByte(SharedDef.PLAYER_INT_FIELD_MOUNT_LEVEL,3);console.log("========监听到幻化坐骑位置======>",a,b),ModuleEventManager.dispatchEvent(new mountui.MountUiEvent(mountui.MountUiEvent.POP_THE_UNREAL_PANEL))},b.prototype.getMountHuanhua=function(){var a=this.GetByte(SharedDef.PLAYER_INT_FIELD_MOUNT_LEVEL,2),b=this.GetByte(SharedDef.PLAYER_INT_FIELD_MOUNT_LEVEL,3);return console.log("========当前幻化坐骑位置======>",a,b),b},b.prototype.playerFieldExpandIntXpChange=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.PLAYER_EXPAND_INT_XP))},b.prototype.playerFieldDivineIdChange=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.PLAYER_FIELD_DIVINE)),console.log("神兵改变&^^^^^^^^^^^^^^^^^^^^^^^^^"),this.resetSkillItem()},b.prototype.playerFieldForceChange=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.PLAYER_FIELD_FORCE))},b.prototype.playerFieldVipChange=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.PLAYER_FIELD_VIP_LEVEL)),ModuleEventManager.dispatchEvent(new charbg.CharBgEvent(charbg.CharBgEvent.VIP_CHG_EVENT)),console.log("vip等级变化")},b.prototype.changeUnitFieldNotoriety=function(){console.log("========战斗模式换======>"),ModuleEventManager.dispatchEvent(new topui.TopUiEvent(topui.TopUiEvent.UNIT_FIELD_NOTORIETY))},b.prototype.getPlayerIntFieldDivineId=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_DIVINE_ID)},b.prototype.getUnitFieldNotoriety=function(){return this.GetUInt16(SharedDef.PLAYER_FIELD_NOTORIETY,0)},b.prototype.getUnitFieldNotorietyValue=function(){return this.GetUInt16(SharedDef.PLAYER_FIELD_NOTORIETY,1)},b.prototype.playerFieldLevelChange=function(){var a=this.getLevel();a!=this.lastLevel&&(this.lastLevel=a,ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL)),ModuleEventManager.dispatchEvent(new adventureinfo.AdventurInfoEvent(adventureinfo.AdventurInfoEvent.ADVENTURE_TRIAL_PROCESS)))},b.prototype.money_type_qi_change=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.MONEY_TYPE_QI))},b.prototype.money_type_silver_change=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.MONEY_TYPE_SILVER))},b.prototype.money_type_beast=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.MONEY_TYPE_BEAST))},b.prototype.gemgoldChange=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.MONEY_TYPE_GOLD_INGOT))},b.prototype.factionChange=function(){ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONGX_EVENT))},b.prototype.gemChange=function(){ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.MONEY_TYPE_GEM))},b.prototype.dataUpdate=function(a,b){var c=!1,d=!1;for(var e in a){var f=Number(e);if(f>=SharedDef.PLAYER_INT_FIELD_SPELL_START&&f<SharedDef.PLAYER_INT_FIELD_SPELL_END)c=!0;else if(f>=SharedDef.PLAYER_STRING_FIELD_BLOCK_START&&f<SharedDef.PLAYER_STRING_FIELD_BLOCK_END)this.playerChatBlockChange(f);else if(f>=SharedDef.PLAYER_FIELD_SHOP_LIMIT_START&&f<SharedDef.PLAYER_FIELD_SHOP_LIMIT_END){this.GetUInt16(f,0),this.GetUInt16(f,1);ModuleEventManager.dispatchEvent(new store.StoreEvent(store.StoreEvent.STORE_NUM_EVENT))}else if(f>=SharedDef.PLAYER_FIELD_MAX_HEALTH&&f<SharedDef.PLAYER_FIELD_CONTROL_RESIST_RATE);else if(f>=SharedDef.PLAYER_INT_FIELD_LOGIN_ACTIVITY_REWARD_STATUS_START&&f<SharedDef.PLAYER_INT_FIELD_LOGIN_ACTIVITY_REWARD_STATUS_END)ModuleEventManager.dispatchEvent(new logingift.LogingiftEvent(logingift.LogingiftEvent.REFRESH_Logingift_EVENT));else if(f>=SharedDef.PLAYER_INT_FIELD_BUYED_FACTION_SHOP&&f<SharedDef.PLAYER_INT_FIELD_BUYED_FACTION_SHOP_END)this._factionShopNumList=this.refreshFactionShopNumList(),ModuleEventManager.dispatchEvent(new store.StoreEvent(store.StoreEvent.STORE_NUM_EVENT));else if(f>=SharedDef.PLAYER_INT_FIELD_OPTIONAL_GUIDE_START&&f<SharedDef.PLAYER_INT_FIELD_OPTIONAL_GUIDE_END)this.resetOptionalGuidItem(),console.log("非强制引导有变化");else if(f>=SharedDef.PLAYER_INT_FILED_FACTION_GIFT_START&&f<SharedDef.PLAYER_INT_FILED_FACTION_GIFT_END){var g=(f-SharedDef.PLAYER_INT_FILED_FACTION_GIFT_START)%SharedDef.MAX_FACTION_DATA_INT_GIFT;if(g==SharedDef.FACTION_DATA_INT_GIFT_COUNT_ID&&0==this.GetUInt32(f-2))return;g==SharedDef.FACTION_DATA_INT_GIFT_FLAG_THANK}else f>=SharedDef.PLAYER_INT_FIELD_FACTION_SKILL_LV_START&&f<SharedDef.PLAYER_INT_FIELD_FACTION_SKILL_LV_END?ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONSKILL_CHG_EVENT)):f>=SharedDef.PLAYER_EXPAND_INT_MONEY&&f<SharedDef.PLAYER_EXPAND_INT_MONEY_END?d=!0:f>=SharedDef.PLAYER_INT_FIELD_OPEN_MENU_START&&f<SharedDef.PLAYER_INT_FIELD_OPEN_MENU_END&&ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT))}for(var h=!1,i=SharedDef.PLAYER_INT_FIELD_PASSIVE_SPELL_START;i<SharedDef.PLAYER_INT_FIELD_PASSIVE_SPELL_END;i++)if(a[i]&&(h=!0,this._passiveskillLevDic)){var j=this.GetUInt16(i,SharedDef.SHORT_SPELL_ID);if(0==j)break;var k=this.GetUInt16(i,SharedDef.SHORT_SPELL_LV);this._passiveskillLevDic[j]=k}h&&ModuleEventManager.dispatchEvent(new divinesword.DivineswordEvent(divinesword.DivineswordEvent.REFRESH_SKILL_PANEL));for(var e in b)var l=Number(e);c&&this.sendChangeSkillEvent(),d&&ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.MONEY_CHANGE))},b.prototype.sendChangeSkillEvent=function(){console.log("技能更新 -----");for(var a=!1,b=this.getBaseSkillItem(),c=0;c<b.length;c++){for(var d=!1,e=0;e<this.skillItem.length;e++)b[c].slot==this.skillItem[e].slot&&(d=!0);if(!d){if(console.log("新插口开启",b[c].slot),b[c].slot>=2&&b[c].slot<=4){var f=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.OPEN_SKILL_SLOT);f.data=b[c],ModuleEventManager.dispatchEvent(f)}else this.resetSkillItem(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.RESET_SKILL_ICON));a=!0}}a||this.resetSkillItem()},b.prototype.getsyspageopen=function(a,b){for(var c=SharedDef.PLAYER_INT_FIELD_OPEN_MENU_START;c<SharedDef.PLAYER_INT_FIELD_OPEN_MENU_END;c+=SharedDef.MAX_OPEN_MENU_ATTR_COUNT){var d=this.GetUInt32(c+SharedDef.OPEN_MENU_MAIN_ID),e=this.GetUInt32(c+SharedDef.OPEN_MENU_SUB_FLAG);if(d==a){if(1&e)return!0;for(var f=1,g=1;10>g;g++)if(f<<=1,e&f&&b==g)return!0}}return!1},b.prototype.resetSystemItem=function(){console.log("开启系统刷新getTimer()",TimeUtil.getTimer()),this.systemOpenItem=new Array;for(var a=SharedDef.PLAYER_INT_FIELD_OPEN_MENU_START;a<SharedDef.PLAYER_INT_FIELD_OPEN_MENU_END;a+=SharedDef.MAX_OPEN_MENU_ATTR_COUNT){var b=this.GetUInt32(a+SharedDef.OPEN_MENU_MAIN_ID),c=this.GetUInt32(a+SharedDef.OPEN_MENU_SUB_FLAG);if(b>0){var d=new SystemOpenData;if(d.systemId=b,d.data=new Array,this.systemOpenItem.push(d),console.log("---------------------系统===============",b),502==b&&console.log("---------------------家族"),1&c)d.needShowIcon=!0;else for(var e=1,f=1;10>f;f++)e<<=1,c&e&&(d.data.push(f),tb.TB_system_base.getTempVo(10*b+f).show&&(d.needShowIcon=!0,console.log("显示图标=>",b)))}}return this.systemOpenItem},b.prototype.resetOptionalGuidItem=function(){this.optionalGuidItem=new Array;for(var a=SharedDef.PLAYER_INT_FIELD_OPTIONAL_GUIDE_START;a<SharedDef.PLAYER_INT_FIELD_OPTIONAL_GUIDE_END;a+=2){var b=this.GetUInt32(a+0),c=this.GetUInt32(a+1);b>0&&(console.log("$optionalId",b,c),this.optionalGuidItem.push(new Vector2D(b,c)))}return this.optionalGuidItem},b.prototype.isOpenSystemNeedShow=function(a){for(var b=0;b<this.systemOpenItem.length;b++)if(this.systemOpenItem[b].systemId==a)return this.systemOpenItem[b].needShowIcon;return!1},b.prototype.isOpenSystemById=function(a){for(var b=0;b<this.systemOpenItem.length;b++)if(this.systemOpenItem[b].systemId==a)return this.systemOpenItem[b].needShowIcon;return!1},b.prototype.getLimShopNum=function(a){for(var b=SharedDef.PLAYER_FIELD_SHOP_LIMIT_START;b<SharedDef.PLAYER_FIELD_SHOP_LIMIT_END;b++){var c=this.GetUInt16(b,0);if(c==a)return this.GetUInt16(b,1)}return 0},b.prototype.getFactionShopNumList=function(){return this._factionShopNumList?this._factionShopNumList:(this._factionShopNumList=this.refreshFactionShopNumList(),console.log("---家族商店购买物品个数---",this._factionShopNumList),this._factionShopNumList)},b.prototype.refreshFactionShopNumList=function(){for(var a=new Array,b=SharedDef.PLAYER_INT_FIELD_BUYED_FACTION_SHOP;b<SharedDef.PLAYER_INT_FIELD_BUYED_FACTION_SHOP_END;b++){var c=this.getShopData(b);c&&a.push(c)}return console.log("---880aa---",a),a},b.prototype.getShopData=function(a){var b=new factionShopNumData,c=this.GetUInt16(a,0);return b.id=c,b.num=this.GetUInt16(a,1),b},b.prototype.playerChatBlockChange=function(a){ModuleEventManager.dispatchEvent(new shieldui.ShieldUiEvent(shieldui.ShieldUiEvent.PLAYER_STRING_FIELD_BLOCK))},b.prototype.getPlayChatBlock=function(){for(var a=new Array,b=SharedDef.PLAYER_STRING_FIELD_BLOCK_START;b<SharedDef.PLAYER_STRING_FIELD_BLOCK_END;b++){var c=this.GetStr(b);a.push(c)}return a},b.prototype.teleMap=function(){var a=this.GetUInt32(SharedDef.PLAYER_EXPAND_INT_TO_MAP);if(a){var b=tb.TB_map.getTB_map(a);GameInstance.mapName=b.mapres}},b.prototype.loginTime=function(){GameInstance.skillCdItem=new Array;for(var a=this.GetUInt32(SharedDef.PLAYER_EXPAND_INT_LAST_LOGIN_TIME),b=SharedDef.PLAYER_INT_FIELD_IMPORTANT_SPELL_CD_START;b<SharedDef.PLAYER_INT_FIELD_IMPORTANT_SPELL_CD_END;b+=SharedDef.MAX_IMPORTANT_SPELL_ATTR_COUNT){var c=this.GetUInt32(b),d=this.GetUInt32(b+1)-a;GameInstance.skillCdItem.push({id:c,cd:d})}},b.prototype.getForce=function(){return this.GetDouble(SharedDef.PLAYER_FIELD_FORCE)},b.prototype.getPlayerIntFieldMeridianForce=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_MERIDIAN_FORCE)},b.prototype.get1v1Rank=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_DOUJIANTAI_RANK)},b.prototype.getVipLevel=function(){return this.GetUInt32(SharedDef.PLAYER_FIELD_VIP_LEVEL)},b.prototype.getIsVIP=function(){return this.getVipLevel()>0},b.prototype.getVIPBuyGift=function(a){return this.GetBit(SharedDef.PLAYER_INT_FIELD_VIPGIFT_FLAG,a)},b.prototype.getFactionName=function(){return this.GetStr(SharedDef.PLAYER_STRING_FIELD_FACTION_NAME)},b.prototype.getFactionID=function(){return this.GetStr(SharedDef.PLAYER_STRING_FIELD_FACTION_GUID)},b.prototype.getChongZhiSum=function(){return this.GetUInt32(SharedDef.PLAYER_APPD_INT_FIELD_RECHARGE_SUM)},b.prototype.getTitleID=function(){return this.GetByte(SharedDef.PLAYER_FIELD_BYTES_2,3)},b.prototype.chgAvatar=function(){var a=new charbg.CharBgEvent(charbg.CharBgEvent.EQUVIEW_CHANGE_EVENT);a.showType=0,ModuleEventManager.dispatchEvent(a)},b.prototype.chgWeapon=function(){var a=new charbg.CharBgEvent(charbg.CharBgEvent.EQUVIEW_CHANGE_EVENT);a.showType=1,ModuleEventManager.dispatchEvent(a)},b.prototype.getBaseSkillItem=function(){for(var a=new Array,b=SharedDef.PLAYER_INT_FIELD_SPELL_END-SharedDef.PLAYER_INT_FIELD_SPELL_START,c=0;b>c;c++){var d=this.getSkill(c);d&&a.push(d)}return a},b.prototype.getSkill=function(a){var b=SharedDef.PLAYER_INT_FIELD_SPELL_START+a,c=this.GetUInt16(b,0);if(0==c)return null;var d=new SkillUintVo;return d.id=this.GetUInt16(b,0),d.lev=this.GetUInt8(b,2),d.slot=this.GetUInt8(b,3),d},b.prototype.getPlayerIntFieldPassiveSpell=function(){for(var a=new Array,b=SharedDef.PLAYER_INT_FIELD_PASSIVE_SPELL_START;b<this._uint32_values_len;b++){var c=this.GetUInt16(b,SharedDef.SHORT_SPELL_ID);if(0==c)break;var d=new SkillUintVo;d.id=c,d.lev=this.GetUInt16(b,SharedDef.SHORT_SPELL_LV),a.push(d)}return a},b.prototype.getPassiveSkillLev=function(a){if(!this._passiveskillLevDic){this._passiveskillLevDic=new Object;for(var b=SharedDef.PLAYER_INT_FIELD_PASSIVE_SPELL_START;b<SharedDef.PLAYER_INT_FIELD_PASSIVE_SPELL_END;b++){var c=this.GetUInt16(b,SharedDef.SHORT_SPELL_ID);if(0==c)break;var d=this.GetUInt16(b,SharedDef.SHORT_SPELL_LV);this._passiveskillLevDic[c]=d}}return this._passiveskillLevDic[a]?this._passiveskillLevDic[a]:0},b.prototype.getExp=function(){return this.GetDouble(SharedDef.PLAYER_EXPAND_INT_XP)},b.prototype.getMaxExp=function(){return this.GetDouble(SharedDef.PLAYER_EXPAND_INT_NEXT_LEVEL_XP)},b.prototype.getGoldIngot=function(){var a=SharedDef.PLAYER_EXPAND_INT_MONEY+2*SharedDef.MONEY_TYPE_GOLD_INGOT;return this.GetDouble(a)},b.prototype.getBindGold=function(){var a=SharedDef.PLAYER_EXPAND_INT_MONEY+2*SharedDef.MONEY_TYPE_BIND_GOLD;return this.GetDouble(a)},b.prototype.getSilver=function(){var a=SharedDef.PLAYER_EXPAND_INT_MONEY+2*SharedDef.MONEY_TYPE_SILVER;return this.GetDouble(a)},b.prototype.getQI=function(){return 0},b.prototype.getDouHun=function(){return 0},b.prototype.getHonor=function(){return 0},b.prototype.getBeast=function(){return 0},b.prototype.getGem=function(){return 0},b.prototype.getFactionBG=function(){return 0},b.prototype.getResType=function(a){var b=SharedDef.PLAYER_EXPAND_INT_MONEY+2*a;return this.GetDouble(b)},b.prototype.getResTypeStr=function(a){return Snum(this.getResType(a))},b.prototype.getCharType=function(){return this.GetUInt8(SharedDef.PLAYER_FIELD_BYTES_0,0)},b.prototype.getLevel=function(){return this.GetUInt32(SharedDef.PLAYER_FIELD_LEVEL)},b.prototype.getConsume=function(){return this.GetUInt32(SharedDef.PLAYER_APPD_INT_FIELD_CONSUME_SUM)},b.prototype.getBaseName=function(){var a=this.getName();return a.split(",")[2]},b.prototype.getAvatar=function(){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_APPEARANCE,1)},b.prototype.getWeapon=function(){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_APPEARANCE,0)},b.prototype.getFactionSpeedUpNum=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FILED_FACTION_BUILDING_SPEEDUP_DAILY_COUNT)},b.prototype.getPropById=function(a){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_MAX_HEALTH+2*(a-1))/100)},b.prototype.getAllArmor=function(){return Math.floor((this.GetDouble(SharedDef.PLAYER_FIELD_ARMOR)+this.GetDouble(SharedDef.PLAYER_FIELD_STRENGTH_ARMOR))/100)},b.prototype.getStunRate=function(){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_STUN_RATE)/100)},b.prototype.getRootsRate=function(){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_ROOTS_RATE)/100)},b.prototype.getSilenceRate=function(){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_SILENCE_RATE)/100)},b.prototype.getChaosRate=function(){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_CHAOS_RATE)/100)},b.prototype.getCharmRate=function(){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_CHARM_RATE)/100)},b.prototype.getControlEnhanceRate=function(){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_CONTROL_ENHANCE_RATE)/100)},b.prototype.getControlResistRate=function(){return Math.floor(this.GetDouble(SharedDef.PLAYER_FIELD_CONTROL_RESIST_RATE)/100)},b.prototype.getDivineID=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_DIVINE_ID)},b.prototype.getRankLikeState=function(){for(var a=new Array,b=0;32>b;b++)a.push(this.GetBit(SharedDef.PLAYER_FIELD_USE_RANK_LIKE,b));return a},b.prototype.rankLikeChg=function(){console.log("---===="),ModuleEventManager.dispatchEvent(new ranking.RankingEvent(ranking.RankingEvent.RANKING_LIKE_CHG_EVENT))},b.prototype.testAddLike=function(a,b){for(var c="",d=b+c+a,e=SharedDef.PLAYER_STRING_FIELD_RANKLIKE_START;e<SharedDef.PLAYER_STRING_FIELD_RANKLIKE_ENE;e++)if(this.GetStr(e)==d)return!0;return!1},b.prototype.getDivineForce=function(){return this.GetUInt32(SharedDef.PLAYER_FIELD_DIVINE_FORCE)},b.prototype.getSkillForce=function(){return this.GetUInt32(SharedDef.PLAYER_FIELD_SKILL_FORCE)},b.prototype.getDivineNum=function(){return this.GetUInt32(SharedDef.PLAYER_FIELD_DIVINE_NUM)},b.prototype.getMountForce=function(){return this.GetUInt32(SharedDef.PLAYER_FIELD_MOUNT_FORCE)},b.prototype.getMountLevel=function(){return this.GetByte(SharedDef.PLAYER_INT_FIELD_MOUNT_LEVEL,0)},b.prototype.getMountStar=function(){return this.GetByte(SharedDef.PLAYER_INT_FIELD_MOUNT_LEVEL,1)},b.prototype.getTraininglasttime=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_LAST_PLUNDER_TIME)},b.prototype.getTrainingplunderexp=function(){return console.log("--expnum--",this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_TODAY_PLUNDER_EXP)),this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_TODAY_PLUNDER_EXP)},b.prototype.getTrainingplunderchest=function(){return console.log("--bosnum--",this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_TODAY_PLUNDER_CHEST)),this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_TODAY_PLUNDER_CHEST)},b.prototype.getTrainingplundercount=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_TODAY_PURCHASE_COUNT)},b.prototype.getTrainingleftplundercount=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_LEFT_PLUNDER_COUNT)},b.prototype.getTrainingStartTime=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_START_TIME)},b.prototype.getTrainingLostinfo=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_LOST_INFO)},b.prototype.getTrainingTotalCount=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_CULTIVATION_TOTAL_BEEN_PLUNDER_COUNT)},b.prototype.getTrainingcombatlog=function(){for(var a=new Array,b=SharedDef.PLAYER_STRING_INT_FIELD_CULTIVATION_PLUNDER_RECORD_START;b<SharedDef.PLAYER_STRING_INT_FIELD_CULTIVATION_PLUNDER_RECORD_END;b++)a.push(this.GetStr(b));return a},b.prototype.getLogingiftDay=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_LOGIN_ACTIVITY_TOTAL_DAYS)},b.prototype.getLogingiftReward=function(){for(var a=new Array,b=0;32>b;b++)a.push(this.GetBit(SharedDef.PLAYER_INT_FIELD_LOGIN_ACTIVITY_REWARD_STATUS_START,b));return a},b.prototype.getWingForce=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_WINGS_FORCE)},b.prototype.talismantotalzhanli=function(){ModuleEventManager.dispatchEvent(new treasure.TreasureUiEvent(treasure.TreasureUiEvent.CHANGE_ZHANLI_EVENT))},b.prototype.gettalismantotalzhanli=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_TALISMAN_FORCE)},b.prototype.teamflagchange=function(){ModuleEventManager.dispatchEvent(new treasure.TreasureUiEvent(treasure.TreasureUiEvent.CHANGE_ZHANLI_EVENT))},b.prototype.getteamflag=function(){for(var a=new Array,b=0;32>b;b++)a.push(this.GetBit(SharedDef.PLAYER_INT_FIELD_GROUP_INSTANCE_CLEAR_FLAG,b));return a},b.prototype.getFactionLeadNum=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_FACTION_BOSSDEFENSE_TICKETS)},b.prototype.getFactionTripLev=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_FACTION_TOWER_CLEAR_FLOOR)},b.prototype.getFactionTripReward=function(){for(var a=new Array,b=1;6>b;b++)a.push(this.GetBit(SharedDef.PLAYER_INT_FIELD_FACTION_TOWER_FLAG,b));return a},b.prototype.getFactionTripSweep=function(){return this.GetBit(SharedDef.PLAYER_INT_FIELD_FACTION_TOWER_FLAG,0)},b.prototype.getQualifyScore=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_QUALIFY_SCORE)},b.prototype.getFactionSkillLv=function(a){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_FACTION_SKILL_LV_START+a-1,0)},b.prototype.getChgNameTime=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_RENAME_TIMES)},b.prototype.getTitleForce=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_TITLE_FORCE)},b.prototype.titleforceChg=function(){ModuleEventManager.dispatchEvent(new role.RoleUiEvent(role.RoleUiEvent.TITLE_FORCE_CHG_EVENT))},b.prototype.Chgname=function(){ModuleEventManager.dispatchEvent(new role.RoleUiEvent(role.RoleUiEvent.NAME_CHG_EVENT))},b.prototype.chgRevengeNum=function(){ModuleEventManager.dispatchEvent(new social.SocialUiEvent(social.SocialUiEvent.REVENGE_NUM_CHG_EVENT))},b.prototype.getRevengeBuyNum=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_REVENGE_BUY_TIMES)},b.prototype.getMoneyTreeNum=function(){return this.GetUInt32(SharedDef.PLAYER_APPD_INT_FIELD_MONEYTREE_COUNT)},b.prototype.getMoneyTreeState=function(a){return this.GetBit(SharedDef.PLAYER_APPD_INT_FIELD_MONEYTREE_GIFT_FLAG,a)},b.prototype.moneyTreeChg=function(){ModuleEventManager.dispatchEvent(new moneytree.MoneyTreeEvent(moneytree.MoneyTreeEvent.CHG_MoneyTree_REWARD_EVENT))},b.prototype.getworldrisklastid=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_WORLD_RISK_LAST_ID)},b.prototype.getLastMapType=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_LAST_INSTANCE_TYPE)},b.prototype.getLastMapParam=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_LAST_INSTANCE_PARAM)},b.prototype.getCDtime=function(){return this.GetUInt32(SharedDef.PLAYER_FIELD_PEACE_MODE_CD)},b.prototype.getStateLev=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_REALMBREAK_LEVEL)},b.prototype.getStateExp=function(){return this.GetUInt32(SharedDef.PLAYER_INT_FIELD_REALMBREAK_EXP)},b.prototype.getStateTaskNum=function(){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_REALMBREAK_DAILYQUEST_STATE,0)},b.prototype.getStateTaskRecive=function(){return this.GetUInt16(SharedDef.PLAYER_INT_FIELD_REALMBREAK_DAILYQUEST_STATE,1)},b}(GuidObject),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),PersonChar=function(a){function b(){return a.call(this)||this}return __extends(b,a),b}(SceneChar),Display3DSprite2DBind=function(a){function b(){var b=a.call(this)||this;return b.vpMatrix=new Matrix3D,b}return __extends(b,a),b.prototype.setCam=function(){this.vpMatrix.identity(),this.vpMatrix.prepend(this.uiViewMatrix),this.vpMatrix.prepend(this.uiMatrix),Scene_data.context3D.setVpMatrix(this.material.shader,this.vpMatrix.m)},b.prototype.updateBind=function(){this.bindTarget&&(this.posMatrix.identity(),this.posMatrix.appendScale(this.scaleX,this.scaleY,this.scaleZ),this.bindTarget.getSocket(this.bindSocket,this.bindMatrix),this.posMatrix.append(this.bindMatrix),this.bindMatrix.copyTo(this._rotationMatrix),this._rotationMatrix.identityPostion(),this._rotationData&&this._rotationMatrix.getRotaion(this._rotationData))},b.prototype.setCamPos=function(a){a.updateCam(this.uiCamPos.x,this.uiCamPos.y,this.uiCamPos.z)},b.prototype.setDirectLight=function(a){a.directLight&&this.lightData&&(Scene_data.context3D.setVc3fv(a.shader,"ambientColor",this.lightData[0]),Scene_data.context3D.setVc3fv(a.shader,"sunDirect",this.lightData[1]),Scene_data.context3D.setVc3fv(a.shader,"sunColor",this.lightData[2]))},b}(Display3DSprite),TestModel=function(){function a(){this.objData=new ObjData;var a=[],b=[],c=[],d=[],e=[];this.objData.indexs=new Array,this.objData.uvs=new Array,this.objData.lightuvs=new Array,this.objData.normals=new Array,this.objData.indexs=new Array;var f=0;for(f=0;f<a.length;f++)this.objData.vertices.push(a[f]);for(f=0;f<b.length;f++)this.objData.uvs.push(b[f]);for(f=0;f<c.length;f++)this.objData.lightuvs.push(c[f]);for(f=0;f<d.length/3;f++)this.objData.normals.push(1*d[3*f+0]),this.objData.normals.push(-1*d[3*f+2]),this.objData.normals.push(1*d[3*f+1]);for(f=0;f<e.length;f++)this.objData.indexs.push(e[f]);this.upToGpu()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.upToGpu=function(){var a=this.objData;a.treNum=a.indexs.length,a.vertexBuffer=Scene_data.context3D.uploadBuff3D(a.vertices),a.uvBuffer=Scene_data.context3D.uploadBuff3D(a.uvs),a.lightUvBuffer=Scene_data.context3D.uploadBuff3D(a.lightuvs),a.normalsBuffer=Scene_data.context3D.uploadBuff3D(a.normals),a.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(a.indexs)},a}(),Person2DChar=function(a){function b(){var b=a.call(this)||this;b.vpMatrix=new Matrix3D,b._camRx=0,b._camRy=0,b.needUIUrl=!0,b.bindZero=!1,b.showAvatarVisibel=!0,b.deltTime=0,b.uiMatrix=new Matrix3D,b.uiMatrix.prependTranslation(0,0,600),b.uiMatrix.prependRotation(-10,Vector3D.X_AXIS),b.uiMatrix.prependRotation(180,Vector3D.Y_AXIS);var c=b.uiMatrix.clone();return c.invert(),b.uiCamPos=c.position,b.uiViewMatrix=new Matrix3D,b.resize(),b.addStage(),b}return __extends(b,a),b.prototype.setCamData=function(a,b,c){this.uiMatrix=new Matrix3D,this.uiMatrix.prependTranslation(0,0,c),this.uiMatrix.prependRotation(a,Vector3D.X_AXIS),this.uiMatrix.prependRotation(b,Vector3D.Y_AXIS);var d=this.uiMatrix.clone();d.invert(),this.uiCamPos=d.position,this.resize(),this._camRx=a,this._camRy=b},b.prototype.updateMaterialMesh=function(b){this.showAvatarVisibel&&a.prototype.updateMaterialMesh.call(this,b)},b.prototype.resize=function(){this.uiViewMatrix.identity();var a=.003;this.uiViewMatrix.appendScale(a,a,.001),this.uiViewMatrix.appendScale(1e3/Scene_data.stageWidth,1e3/Scene_data.stageHeight,1)},b.prototype.onMeshLoaded=function(){if(this._skinMesh.lightData)for(var a=0;this._displayItem&&a<this._displayItem.length;a++)this._displayItem[a].lightData=this._skinMesh.lightData},b.prototype.getSceneCharAvatarUrl=function(b){return this.needUIUrl?getRoleUIUrl(String(b)):a.prototype.getSceneCharAvatarUrl.call(this,b)},b.prototype.getSceneCharWeaponUrl=function(a){return getModelUIUrl(String(a))},b.prototype.removePart=function(a){for(var b=0;this._displayItem&&b<this._displayItem.length;b++)this._displayItem[b].destory();for(var c=0;this._particleItem&&c<this._particleItem.length;c++)this._particleItem[c].destory();this._displayItem=new Array,this._particleItem=new Array,this._partUrl=new Object},b.prototype.getSocket=function(b,c){return this.bindZero?void a.prototype.getSocket.call(this,b,c):void(this._skinMesh?a.prototype.getSocket.call(this,b,c):(c.identity(),c.appendTranslation(0,1e5,0)))},b.prototype.addPart=function(a,b,c){var d=this;if(this._partUrl[a]==c)return void(this.loadPartComFun&&this.loadPartComFun());this._partUrl[a]&&this.removePart(a),this._partUrl[a]=c;var e=new Array,f=new GroupRes;f.load(Scene_data.fileRoot+c,function(){d.loadPartResA(b,f,e)})},b.prototype.loadPartResA=function(a,b,c){this._displayItem=new Array,this._particleItem=new Array;for(var d=0;d<b.dataAry.length;d++){var e,f,g,h=b.dataAry[d];if(h.isGroup&&(e=new Vector3D(h.x,h.y,h.z),f=new Vector3D(h.rotationX,h.rotationY,h.rotationZ),g=new Vector3D(h.scaleX,h.scaleY,h.scaleZ)),h.types==BaseRes.SCENE_PARTICLE_TYPE){var i=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+h.particleUrl);c.push(i),i.bindTarget=this,i.bindSocket=a,i.dynamic=!0,this._particleItem.push(i),h.isGroup&&i.setGroup(e,f,g)}if(h.types==BaseRes.PREFAB_TYPE){var j=new Display3DSprite2DBind;j.uiCamPos=this.uiCamPos,this._skinMesh?j.lightData=this._skinMesh.lightData:this.lightData&&(j.lightData=this.lightData),j.setObjUrl(h.objUrl),j.setMaterialUrl(h.materialUrl,h.materialInfoArr),
j.dynamic=!0,c.push(j),j.setBind(this,a),this._displayItem.push(j),h.isGroup&&j.setGroup(e,f,g)}}this.loadPartComFun&&this.loadPartComFun()},b.prototype.addSkinMeshParticle=function(){if(this._skinMesh){var a=this._skinMesh.meshAry;if(a)for(var b=0;b<a.length;b++)for(var c=a[b].particleAry,d=0;d<c.length;d++){var e,f=c[d];e=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+f.url),e.dynamic=!0,e.bindSocket=f.socketName,this._particleItem.push(e),e.bindTarget=this}}},b.prototype.removeSkinMeshParticle=function(){this.removePart("mesh")},b.prototype.updataBindDis=function(a){for(var b=0;this._displayItem&&b<this._displayItem.length;b++)this._displayItem[b].uiViewMatrix=this.uiViewMatrix,this._displayItem[b].uiMatrix=this.uiMatrix,this._displayItem[b].scale=.8*this.scale,this._displayItem[b].update();Scene_data.context3D.setDepthTest(!0),Scene_data.context3D.setWriteDepth(!1);var c=Scene_data.cam3D.rotationX,d=Scene_data.cam3D.rotationY;Scene_data.cam3D.rotationX=this._camRx,Scene_data.cam3D.rotationY=this._camRy;for(var e=0;this._particleItem&&e<this._particleItem.length;e++)this._particleItem[e].scaleX=.8*this.scale,this._particleItem[e].scaleY=.8*this.scale,this._particleItem[e].scaleZ=.8*this.scale,this.upParticleData(this._particleItem[e],a);Scene_data.cam3D.rotationX=c,Scene_data.cam3D.rotationY=d},b.prototype.upParticleData=function(a,b){a.updateTime(b);for(var c=0;c<a.displayAry.length;c++){var d=a.displayAry[c];Scene_data.context3D.setBlendParticleFactors(d.data._alphaMode),Scene_data.context3D.cullFaceBack(d.data.materialParam.material.backCull),d.data.materialParam&&Scene_data.context3D.setProgram(d.data.materialParam.program),d.updateMatrix(),d.setVc(),d.data.setFloat32Mat("viewMatrix3D",this.uiViewMatrix.m),d.data.setFloat32Mat("camMatrix3D",this.uiMatrix.m),d.pushVc(),d.setVa(),d.resetVa()}},b.prototype.setVcMatrix=function(a){this.vpMatrix.identity(),this.vpMatrix.prepend(this.uiViewMatrix),this.vpMatrix.prepend(this.uiMatrix),Scene_data.context3D.setVpMatrix(a.material.shader,this.vpMatrix.m),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"posMatrix3D",this.posMatrix.m),Scene_data.context3D.setVcMatrix4fv(a.material.shader,"rotationMatrix3D",this._rotationMatrix.m)},b.prototype.refreshY=function(){},b.prototype.rotationToNew=function(a,b){void 0===b&&(b=1)},b.prototype.setCamPos=function(a){a.updateCam(this.uiCamPos.x,this.uiCamPos.y,this.uiCamPos.z)},b.prototype.setDirectLight=function(a){a.directLight&&this._skinMesh&&this._skinMesh.lightData&&(Scene_data.context3D.setVc3fv(a.shader,"ambientColor",this._skinMesh.lightData[0]),Scene_data.context3D.setVc3fv(a.shader,"sunDirect",this._skinMesh.lightData[1]),Scene_data.context3D.setVc3fv(a.shader,"sunColor",this._skinMesh.lightData[2]))},b.prototype.update=function(){if(this.visible){var b=TimeUtil.getTimer()-this.deltTime;this.updateFrame(b),Scene_data.context3D.setDepthTest(!0),Scene_data.context3D.setWriteDepth(!0),a.prototype.update.call(this),this.updataBindDis(b),Scene_data.context3D.setDepthTest(!1),Scene_data.context3D.setWriteDepth(!1),this.deltTime=TimeUtil.getTimer()}},b}(SceneChar),MonsterUIChar=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getSceneCharAvatarUrl=function(a){return getRoleUrl(String(a))},b.prototype.getSceneCharWeaponUrl=function(a){return getModelUrl(String(a))},b}(Person2DChar),DialogueUIChar=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.uiRoleScale=1,b.num1000=960,b.uiRole=!1,b}return __extends(b,a),b.prototype.onMeshLoaded=function(){if(a.prototype.onMeshLoaded.call(this),this._skinMesh){for(var b=0,c=0;c<this._skinMesh.hitPosItem.length;c++)b=Math.max(this._skinMesh.hitPosItem[c].y,b);this.uiRoleScale=50/b}this.loadFinishFun&&this.loadFinishFun()},b.prototype.updateMatrix=function(){this.posMatrix.identity(),this.posMatrix.appendScale(this._scaleX*this.uiRoleScale,this._scaleY*this.uiRoleScale,this._scaleZ*this.uiRoleScale),this.posMatrix.appendRotation(this._rotationX,Vector3D.X_AXIS),this.posMatrix.appendRotation(this._rotationY,Vector3D.Y_AXIS),this.posMatrix.appendRotation(this._rotationZ,Vector3D.Z_AXIS);var a=this.num1000/3*UIData.Scale-this.x*(2/3)*UIData.Scale,b=180*UIData.Scale-this.y*(2/3)*UIData.Scale;this.posMatrix.appendTranslation(a,b,0)},b.prototype.resize=function(){this.uiViewMatrix.identity();var a=this.num1000,b=3/a;this.uiViewMatrix.appendScale(b,b,1/a),this.uiViewMatrix.appendScale(a/Scene_data.stageWidth,a/Scene_data.stageHeight,1)},b.prototype.getSceneCharAvatarUrl=function(a){return this.uiRole?getRoleUIUrl(String(a)):getRoleUrl(String(a))},b.prototype.setAvatarUI=function(b){this.uiRole=!0,a.prototype.setAvatar.call(this,b)},b}(MonsterUIChar),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),InputPanel=function(a){function b(){var b=a.call(this)||this;return b.textureRect=new Rectangle(0,0,256,256),b.lastVerticalState=!1,b.uiAtlasComplet=!1,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),GameData.getPublicUiAtlas(function(a){b.makePanelUi(a)}),b}return __extends(b,a),b.prototype.makePanelUi=function(a){this._bottomRender.uiAtlas=a,this._midRender.uiAtlas=a,this._topRender.uiAtlas=a,this.winBg=this.addEvntBut("bg_black",this._bottomRender),this.guiBg=this.addEvntBut("guiBg1",this._midRender),this.buta=this.addEvntBut("but_0",this._midRender),this.butb=this.addEvntBut("but_0",this._midRender),this.qx=this.addChild(this._topRender.getComponent("qx")),this.qr=this.addChild(this._topRender.getComponent("qr")),this.winBg.x=0,this.winBg.y=0,this.uiAtlasComplet=!0,this.resize()},b.prototype.initData=function(a,b){this.width=UIData.designWidth,this.height=UIData.designHeight,this.top=0,this.left=0,this.bFun=a,this.lastVerticalState=Engine.needVertical,Engine.needVertical=!1,Engine.resetSize(),this.setHtmlInputVisible(!0),this.chatHtmlInput.value=b},b.prototype.setInputTxtPos=function(){this.chatHtmlInput||(this.chatHtmlInput=document.createElement("textarea"),this.chatHtmlInput.style.position="absolute",this.chatHtmlInput.style["z-index"]=100,this.chatHtmlInput.style.background="transparent",this.chatHtmlInput.style.color="white"),this.chatHtmlInput.parentElement&&document.body.removeChild(this.chatHtmlInput),document.body.appendChild(this.chatHtmlInput),this.chatHtmlInput.style["z-index"]=3;var a=Scene_data.stageWidth-20,b=300,c=100;Scene_data.isPc?this.chatHtmlInput.style.fontSize=String(Math.floor(.9*c))+"px":this.chatHtmlInput.style.fontSize=String(Math.floor(.5*c))+"px",this.chatHtmlInput.style.width=String(a)+"px",this.chatHtmlInput.style.height=String(b)+"px"},b.prototype.setHtmlInputVisible=function(a){a?this.setInputTxtPos():this.chatHtmlInput&&this.chatHtmlInput.parentElement&&document.body.removeChild(this.chatHtmlInput)},b.prototype.resize=function(){this.uiAtlasComplet&&(this.winBg.width=Scene_data.stageWidth/UIData.Scale,this.winBg.height=Scene_data.stageHeight/UIData.Scale,this.setHtmlInputVisible(!0),this.buta.y=350/UIData.Scale,this.buta.x=Scene_data.stageWidth/3/UIData.Scale-this.buta.width/2,this.butb.y=350/UIData.Scale,this.butb.x=Scene_data.stageWidth/3/UIData.Scale*2-this.buta.width/2,this.guiBg.x=0,this.guiBg.y=0,this.guiBg.width=Scene_data.stageWidth/UIData.Scale,this.guiBg.height=300/UIData.Scale,this.qx.x=this.buta.x+(this.buta.width-this.qx.width)/2,this.qx.y=this.buta.y+15,this.qr.x=this.butb.x+(this.butb.width-this.qr.width)/2,this.qr.y=this.butb.y+15,this._bottomRender.applyObjData(),this._midRender.applyObjData(),this._topRender.applyObjData()),a.prototype.resize.call(this)},b.prototype.resetsize=function(a){this._topRender.applyObjData(),this._midRender.applyObjData()},b.prototype.butClik=function(a){switch(a.target){case this.butb:this.bFun(this.chatHtmlInput.value),this.close();break;case this.buta:this.close()}},b.prototype.close=function(){this.setHtmlInputVisible(!1),UIManager.getInstance().removeUIContainer(this),Engine.needVertical=this.lastVerticalState,Engine.resetSize()},b.show=function(a,c,d,e){return void 0===d&&(d=0),void 0===e&&(e=100),this.inputPanel||(this.inputPanel=new b),this.inputPanel.initData(a,c),UIManager.getInstance().addUIContainer(this.inputPanel),this.inputPanel},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),AlertUtil=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topRender.setInfo("ui/uidata/alert/alert.xml","ui/uidata/alert/alert.png",function(){b.loadConfigCom()}),b}return __extends(b,a),b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas;var a=this.addChild(this._topRender.getComponent("a_round0"));a.isU=!0,a.isV=!0;var b=this.addChild(this._topRender.getComponent("a_round1"));b.isV=!0;var c=this.addChild(this._topRender.getComponent("a_round2"));c.isU=!0;this.addChild(this._topRender.getComponent("a_round3"));this.a_basebg=this.addEvntButUp("a_basebg",this._bottomRender),this.a_basebg.addEventListener(InteractiveEvent.Down,function(){},this),this.addChild(this._bottomRender.getComponent("a_bg")),this.addChild(this._midRender.getComponent("a_tittle_bg")),this.a_context=this.addChild(this._topRender.getComponent("a_context")),this.btnname0=this.addChild(this._topRender.getComponent("btnname0")),this.btnname1=this.addChild(this._topRender.getComponent("btnname1")),this.a_confirm=this.addEvntButUp("a_confirm",this._midRender),this.a_cancel=this.addEvntButUp("a_cancel",this._midRender),this.refrish()},b.prototype.resize=function(){this.a_basebg&&(this.a_basebg.top=0,this.a_basebg.left=0,this.a_basebg.y=0,this.a_basebg.x=0,this.a_basebg.height=Scene_data.stageHeight/UIData.Scale,this.a_basebg.width=Scene_data.stageWidth/UIData.Scale),a.prototype.resize.call(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){if(this.hide(),this.handlerFun)switch(a.target){case this.a_confirm:this.handlerFun(1);break;case this.a_cancel:this.handlerFun(0)}},b.prototype.initData=function(a,b,c,d,e){void 0===a&&(a=""),void 0===b&&(b=""),void 0===c&&(c=4),void 0===d&&(d=null),this.handlerFun=d,this._contentTxt=a,this._tittleTxt=b,this._flags=c,this._btnname=e,this.refrish()},b.prototype.refrish=function(){this.a_context&&(LabelTextFont.writeTextAutoCenterByAnchor(this._topRender.uiAtlas,this.a_context.skinName,this._contentTxt,16,ColorType.Brown6a4936,300),1==this._flags?this.a_confirm.x=this.btnname0.x=427:(this.a_confirm.x=this.btnname0.x=345,this.a_cancel.x=this.btnname1.x=520),this.setUiListVisibleByItem([this.a_cancel,this.btnname1],1!=this._flags),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.btnname0.skinName,this._btnname[0],16,TextAlign.CENTER,ColorType.Brown6a4936),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.btnname1.skinName,this._btnname[1],16,TextAlign.CENTER,ColorType.Brown6a4936)),this.resize()},b.show=function(a,c,d,e,f){return void 0===a&&(a=""),void 0===c&&(c=""),void 0===d&&(d=null),void 0===e&&(e=2),void 0===f&&(f=["确定","取消"]),this.alertUtilPan||(this.alertUtilPan=new b),this.alertUtilPan.initData(a,c,e,d,f),UIManager.getInstance().addUIContainer(this.alertUtilPan),this.alertUtilPan},b.YES=1,b.NO=2,b}(UIConatiner),AreaType=function(){function a(){}return a.restAreaPanel=function(){GuidData.map.showAreaById(a.fubenLeftPane_20)&&ModuleEventManager.dispatchEvent(new fb.FubenEvent(fb.FubenEvent.FUBEN_SHOW_LEFT_PANEL_EVENT)),GuidData.map.showAreaById(a.worldboos_22),GuidData.map.showAreaById(a.kuafu1V1top_23)&&ModuleEventManager.dispatchEvent(new kuafu.KuaFu1v1Event(kuafu.KuaFu1v1Event.SHOW_1V1_SCENE_PANEL)),GuidData.map.showAreaById(a.xiuliantop_26)&&ModuleEventManager.dispatchEvent(new kuafu.KuaFu1v1Event(kuafu.KuaFu1v1Event.SHOW_1V1_SCENE_PANEL))},a.topleft_1=1,a.topleftpalce_2=2,a.toprightPanda_3=3,a.toprightmap_4=4,a.rightChange_6=6,a.fightSKill_7=7,a.sceneExit_30=30,a.fubenLeftPane_20=20,a.worldboos_22=22,a.kuafu1V1top_23=23,a.kuafu3V3top_24=24,a.kuafuXFtop_25=25,a.xiuliantop_26=26,a.sceneExit_27=27,a}(),Play_Skill_Vo=function(){function a(){}return a.get_Play_Skill_Vo=function(b){var c=new a;return c.tb_skill_base=tb.TB_skill_base.get_TB_skill_base(b),c},a.prototype.destory=function(){this.skill=null},a}(),tb;!function(a){var b=function(){function b(){var a=TableData.getInstance().getData(TableData.tb_skill_show,GuidData.player.getCharType());this.parse(a)}return b.prototype.parse=function(a){this.zhudong_list=new Array,this.anger_list=new Array,this.passive_list=new Array,makeArray(a.zhudong_list,this.zhudong_list),makeArray(a.anger_list,this.anger_list),makeArray(a.passive_list,this.passive_list)},b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.initData=function(){b.threeSkillList||(b.threeSkillList=new Array,b.skillList=this.getZhuDongList(),b.passiveSkillList=this.getPassiveList(),this.initeCdMesh())},b.getZhuDongList=function(){for(var b=new Array,c=0;c<a.SkillData.getInstance().zhudong_list.length;c++){var d=a.SkillData.getInstance().zhudong_list[c],e=a.SkillDataVo.getSkillBaseDataById(d);b.push(e)}return b},b.getPassiveList=function(){for(var b=new Array,c=0;c<a.SkillData.getInstance().passive_list.length;c++){var d=a.SkillData.getInstance().passive_list[c],e=a.SkillDataVo.getSkillBaseDataById(d);b.push(e)}return b},b.initeCdMesh=function(){if(!this.cdMeshObj){this.cdMeshObj=new Object;for(var a=0;a<GameInstance.skillCdItem.length;a++){var b=GameInstance.skillCdItem[a];b.cd<=0?this.cdMeshObj[b.id]=TimeUtil.getTimer():this.cdMeshObj[b.id]=b.cd+TimeUtil.getTimer()}}},b.setCdMeshData=function(a,b){this.cdMeshObj[a]=TimeUtil.getTimer()+b},b.getCdMeshBySkillId=function(a){return this.cdMeshObj?this.cdMeshObj[a]:0},b.resetSkillData=function(){a.SkillData.skillList||a.SkillData.initData();for(var b=GuidData.player.skillItem,d=0;d<b.length;d++){var e=b[d];if(e){if(0==e.lev||0==e.slot)break;1==e.slot?this.addThreeSkillList(e.id,e.lev,e.slot):this.setDataToSkillVo(e.id,e.lev,e.slot),this.initPreSkill(e.id)}}this.jumpSkillVo=c.getSkillBaseDataById(10001)},b.initPreSkill=function(b){var c=a.SkillDataVo.getSkillBaseDataById(b);c.tb_skill_base.effect_file&&(SkillManager.getInstance().preLoadSkill(getSkillUrl(c.tb_skill_base.effect_file)),SkillManager.getInstance().preLoadSkill(getSkillUrl("nuqi")))},b.setDataToSkillVo=function(b,c,d){for(var e=0;e<a.SkillData.skillList.length;e++)a.SkillData.skillList[e].id==b&&(a.SkillData.skillList[e].level=c,a.SkillData.skillList[e].slot=d,a.SkillData.skillList[e].activation=!0);6==d&&(a.SkillData.angerSkillVo||(a.SkillData.angerSkillVo=a.SkillDataVo.getSkillBaseDataById(b)),a.SkillData.angerSkillVo.level=c,a.SkillData.angerSkillVo.slot=d)},b.addThreeSkillList=function(b,c,d){var e=this.gteThreeSillById(b);e||(e=a.SkillDataVo.getSkillBaseDataById(b),a.SkillData.threeSkillList.push(e)),e.level=c,e.slot=d},b.gteThreeSillById=function(b){for(var c=0;c<a.SkillData.threeSkillList.length;c++)if(a.SkillData.threeSkillList[c].id==b)return a.SkillData.threeSkillList[c];return null},b}();a.SkillData=b;var c=function(){function b(a){a||console.log("技能表无"),this.id=a.id,this.is_initiative=a.is_initiative,this.singleCD=a.singleCD,this.levelUpStat=a.uplevel_id[0],this.maxLev=a.uplevel_id[1]-this.levelUpStat+1,this.drawChange=!0}return Object.defineProperty(b.prototype,"showGreenUp",{get:function(){return this._showGreenUp},set:function(a){this._showGreenUp!=a&&(this.drawChange=!0),this._showGreenUp=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"activation",{get:function(){return this._activation},set:function(a){this._activation!=a&&(this.drawChange=!0),this._activation=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"level",{get:function(){return this._level},set:function(b){this._level!=b&&(this.drawChange=!0),this._level=b,this.tb_skill_uplevel=a.TB_skill_uplevel.get_TB_skill_uplevel(this.levelUpStat+this.level-1)},enumerable:!0,configurable:!0}),b.getSkillBaseDataById=function(b){var c=TableData.getInstance().getData(TableData.tb_skill_base,b),d=new a.SkillDataVo(c);return d.tb_skill_base=a.TB_skill_base.get_TB_skill_base(b),d},b.getLevelUpInof=function(b,c){var d=TableData.getInstance().getData(TableData.tb_skill_uplevel,c),e=new a.SkillLearnVo;return d||console.log("没有数据"),e.resource=d.uplevel_cost,e.playerLevel=d.need_level,e},b.isCanUpLevel=function(a){return a.skillLearnVo.playerLevel&&a.skillLearnVo.playerLevel>GameInstance.mainChar.unit.getLevel()?!1:a.skillLearnVo.item&&!this.havaMoreDaojuItem(a.skillLearnVo.item)?!1:a.skillLearnVo.resource&&!this.havaMoreResourceItem(a.skillLearnVo.resource)?!1:a.level==a.maxLev&&a.typtId!=skillUi.SkillBaseType.NUQI?!1:!0},b.havaMoreDaojuItem=function(a){for(var b=0;b<a.length;b++){var c=a[b][0],d=a[b][1];if(!skillUi.SkillUiModel.haveMoneyType(c,d))return!1}return!0},b.havaMoreResourceItem=function(a){for(var b=0;b<a.length;b++){var c=a[b][0],d=a[b][1];if(!skillUi.SkillUiModel.haveMoneyType(c,d))return!1}return!0},b.prototype.refresh=function(){var a=TableData.getInstance().getData(TableData.tb_skill_uplevel,this.levelUpStat+this.level-1);if(this.singleCDA=this.singleCD-a.mcd,this.infoA=this.replaceInfo(a,!0),this.fight_value=a.fight_value,this.level<this.maxLev){var b=TableData.getInstance().getData(TableData.tb_skill_uplevel,this.levelUpStat+this.level);this.infoB=this.replaceInfo(b,!1),this.singleCDB=this.singleCD-b.mcd}else this.infoB="",this.singleCDB=NaN},b.prototype.replaceInfo=function(a,b){var c=this.getStrByInfo(this.tb_skill_base.info);for(var d in a){var e="{"+d+"}";c=c.replace(e,b?"[ffffff]"+a[d]+"[8595ae]":"[00ff00]"+a[d]+"[8595ae]")}return c},b.prototype.getStrByInfo=function(a){for(var b="",c=!0,d=0;d<a.length;d++)c?"<"!=a.substr(d,1)?b+=a.substr(d,1):c=!1:">"==a.substr(d,1)&&(c=!0);return b},b.getSkillDesc=function(b,c){void 0===c&&(c=1);var d=a.TB_skill_base.get_TB_skill_base(b),e=d.info,f=e.match(/\{\w+#*\d*\_*\d*\}/g);if(!f||0==f.length)return e;for(var g=TableData.getInstance().getData(TableData.tb_skill_uplevel,d.uplevel_id[0]+c-1),h=0;h<f.length;h++){var i,j=f[h],k=j.substring(1,j.length-1);if(-1!=k.indexOf("#")){var l=k.split("#");k=l[0];for(var m=l[1].split("_"),n=g[k],o="passive_type"==k,p=0;p<m.length;p++){if(!n){n=0;break}n=n[Number(m[p])]}i=n,o&&(i=float2int(n/100))}else i=g[k];e=e.replace(j,i.toFixed(1))}return e},b}();a.SkillDataVo=c}(tb||(tb={}));var MergeServerMsgVo=function(){function a(){var a=443,b=localStorage.getItem("ipurl");(!b||b.length<5)&&(b="192.168.88.5",localStorage.setItem("ipurl",b)),GameStart.outNet&&(b="xy.turaing.com",localStorage.setItem("ipurl",b)),this.port=a,this.host=b,this.type=3}return a.prototype.makeBaseKey=function(){var a=sessionStorage.getItem("name");Boolean(a)||(a=localStorage.getItem("name"));var b=sessionStorage.getItem("sid");Boolean(b)||(b=localStorage.getItem("sid"));var c=localStorage.getItem("platformid");GameStart.outNet&&(""==b&&(b="1001"),c="3"),a&&(this.key=this.makesession(a,b,c,!1,!1))},a.prototype.makesession=function(a,b,c,d,e){void 0===d&&(d=!1),void 0===e&&(e=!1),GameInstance.sid=b;var f;f=c&&c.length?Number(c):2;var g=a,h="",i="84adc98ee63b26e2063a796ac982ad77",j="",k="n";d&&(k="y");var l=(new Date).getTime()/1e3|0,m=null;getUrlParam("inviteGuid")&&(m=getUrlParam("inviteGuid"));var n;n="pid="+f+"&sid="+b+"&uid="+g+"&time="+l+"&indulge="+k+"&mobile="+(e?"y":"n")+"&remote_ip="+h+(m?"&factionguid="+m:"");var o=new Base64,p=o.encode(n),q=hex_md5(p+i),j="?auth="+p+"&sign="+q;return j},a.prototype.readData=function(a){this.host=a.readUTF(),this.port=a.readUint32(),this.key=a.readUTF(),this.type=a.readUint32(),this.reserve=a.readUint32(),this.reserve2=a.readUint32()},a}(),GameConfigData=function(){function a(){this._open_prompting_pboss="",this._open_prompting_sboss=""}return a.prototype.read=function(){if(localStorage.getItem("gameconfig_block_other_plr")?this._block_other_plr=Number(localStorage.getItem("gameconfig_block_other_plr")):this._block_other_plr=0,localStorage.getItem("gameconfig_block_effect_ski")?this._block_effect_ski=Number(localStorage.getItem("gameconfig_block_effect_ski")):this._block_effect_ski=0,localStorage.getItem("gameconfig_block_plr_flyword")?this._block_plr_flyword=Number(localStorage.getItem("gameconfig_block_plr_flyword")):this._block_plr_flyword=0,localStorage.getItem("gameconfig_block_volume_set")?this._block_volume_set=Number(localStorage.getItem("gameconfig_block_volume_set")):this._block_volume_set=1,SoundManager.getInstance().setVolume(this._block_volume_set),localStorage.getItem("gameconfig_block_sound_set")?this._block_sound_set=Number(localStorage.getItem("gameconfig_block_sound_set")):this._block_sound_set=1,SoundManager.getInstance().setSkillVolume(this._block_sound_set),localStorage.getItem("gameconfig_open_prompting_pboss"))this._open_prompting_pboss=localStorage.getItem("gameconfig_open_prompting_pboss");else for(var a=tb.Tb_private_boss_info.get_Tb_private_boss_info(),b=0;b<a.length;b++)this._open_prompting_pboss+="1|";if(localStorage.getItem("gameconfig_open_prompting_sboss"))this._open_prompting_sboss=localStorage.getItem("gameconfig_open_prompting_sboss");else for(var c=tb.TB_mass_boss_info.getItem(),b=0;b<c.length;b++)this._open_prompting_sboss+="1|"},Object.defineProperty(a.prototype,"block_other_plr",{get:function(){return this._block_other_plr},set:function(a){this._block_other_plr=a,localStorage.setItem("gameconfig_block_other_plr",String(this._block_other_plr))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"block_effect_ski",{get:function(){return this._block_effect_ski},set:function(a){this._block_effect_ski=a,localStorage.setItem("gameconfig_block_effect_ski",String(a))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"block_plr_flyword",{get:function(){return this._block_plr_flyword},set:function(a){this._block_plr_flyword=a,localStorage.setItem("gameconfig_block_plr_flyword",String(a))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"block_volume_set",{get:function(){return this._block_volume_set},set:function(a){this._block_volume_set=a,SoundManager.getInstance().setVolume(this._block_volume_set),localStorage.setItem("gameconfig_block_volume_set",String(a))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"block_sound_set",{get:function(){return this._block_sound_set},set:function(a){this._block_sound_set=a,SoundManager.getInstance().setSkillVolume(this._block_sound_set),localStorage.setItem("gameconfig_block_sound_set",String(a))},enumerable:!0,configurable:!0}),a.prototype.setopen_prompting_pboss=function(a,b){var c=this._open_prompting_pboss.split("|");c[a]=b?"1":"0";for(var d="",e=0;e<c.length;e++)d+=c[e].concat("|");this._open_prompting_pboss=d,console.log("----cccccccccccccc-------------------",d),localStorage.setItem("gameconfig_open_prompting_pboss",d)},a.prototype.getopen_prompting_pboss=function(a){var b=this._open_prompting_pboss.split("|");return console.log("--------------------dddddddddddddddddd----------",a,b),1==Number(b[a])},a.prototype.setopen_prompting_sboss=function(a,b){var c=this._open_prompting_sboss.split("|");c[a]=b?"1":"0";for(var d="",e=0;e<c.length;e++)d+=c[e].concat("|");this._open_prompting_sboss=d,console.log("----cccccccccccccc-------------------",a,d,b),localStorage.setItem("gameconfig_open_prompting_sboss",d)},a.prototype.getopen_prompting_sboss=function(a){var b=this._open_prompting_sboss.split("|");return console.log("--------------------dddddddddddddddddd----------",a,b),1==Number(b[a])},a}(),GameData=function(){function a(){}return a.changeMsgToMainUi=function(b,c){a.changeMsgToMainUi,msgtip.MsgTipManager.outStrById(22,7)},a.getIconCopyUrl=function(a){var b=tb.TB_item_template.get_TB_item_template(a);return geteqiconIconUrl(b.icon)},a.getPropName=function(a){var b=tb.TB_item_template.get_TB_item_template(a);return b.name},a.getAvataCopyUrl=function(a){var b=tb.TB_creature_template.get_TB_creature_template(a);return b.avatar},a.getJoinTimeByItem=function(a){var b="";return a[0]<10&&(b+="0"),b+=a[0]+":",a[1]<10&&(b+="0"),b+=a[1],b+="-",a[2]<10&&(b+="0"),b+=a[2]+":",a[3]<10&&(b+="0"),b+=a[3]},a.drawEquToSkinName=function(b,c,d,e){LoadManager.getInstance().load(Scene_data.fileRoot+a.getIconCopyUrl(c),LoadManager.IMG_TYPE,function(a){var c=e.getRec(b),f=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.A_BLACK_F,new Rectangle(0,0,c.pixelWitdh,c.pixelHeight),UIData.publicUi),f.drawImage(a,2,2,c.pixelWitdh-4,c.pixelHeight-4),d>1&&ArtFont.getInstance().writeFontToCtxRight(f,String(d),ArtFont.num1,c.pixelWitdh-2,c.pixelHeight-20,3),e.updateCtx(f,c.pixelX,c.pixelY)})},a.getPublicUiAtlas=function(a){var b=this;this.publicbgUiAtlas?a(this.publicbgUiAtlas):(this.publicbgUiAtlas=new UIAtlas,this.publicbgUiAtlas.setInfo("ui/uidata/public/publicbg.xml","ui/uidata/public/publicbg.png",function(){a(b.publicbgUiAtlas)}))},a.needCreatChar=!0,a.roleInitPos=new Vector2D,a.initGMbg=!1,a.collectionType=0,a.configData=new GameConfigData,a}(),QuestMoveVo=function(){function a(){}return a}(),GameInstance=function(){function a(){}return a.getGameEndMillisecond=function(b){return TimeUtil.getTimer()+1e3*(b-a.gameSyncTime.time_now)},a.getGameSecond=function(a){var b=this.getServerNow();return a-b},a.getServerNow=function(){var b=(TimeUtil.getTimer()-a.appSyncClientTime)/1e3+a.appSynctTime.time_now;return float2int(b)},Object.defineProperty(a,"threeBattarId",{get:function(){return this._threeBattarId},set:function(a){this._threeBattarId=a},enumerable:!0,configurable:!0}),a.init=function(){ModuleEventManager.dispatchEvent(new LoginEvent(LoginEvent.LOGIN_CONNET_EVENT))},Object.defineProperty(a,"attackTarget",{get:function(){return a._attackTarget},set:function(b){a._attackTarget&&a._attackTarget.removePart(SceneChar.SEL_PART),a._attackTarget=b,a._attackTarget&&a._attackTarget.addPart(SceneChar.SEL_PART,SceneChar.NONE_SLOT,getModelUIUrl("6301"))},enumerable:!0,configurable:!0}),a.addSceneChar=function(a){this.roleList.push(a),SceneManager.getInstance().addMovieDisplay(a)},a.removeSceneChar=function(a){this.removeAttackTarget(a);var b=this.roleList.indexOf(a);-1!=b&&this.roleList.splice(b,1),SceneManager.getInstance().removeMovieDisplay(a)},a.clearRoleList=function(){for(;this.roleList&&this.roleList.length;)SceneCharManager.getInstance().removeSceneChar(this.roleList.pop())},a.removeAttackTarget=function(b){a.attackTarget==b&&(a.attackTarget=null)},a.getSceneCharByID=function(a){for(var b=0;b<this.roleList.length;b++)if(this.roleList[b].id==a)return this.roleList[b];return null},a.initGameConfig=function(){},a.intLoadScene=function(b){SceneManager.getInstance().testUrl(b)?(a.sceneResEqu=!0,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT))):(a.sceneResEqu=!1,UIManager.getInstance().removeAll()),a.setMapData(),a.loadScene(b,this.configFinish)},a.loadScene=function(b,c,d){void 0===c&&(c=null),void 0===d&&(d=null),a.mapName=b,a.loadComplteFun=c,a.loadProgressFun=d;var e=new SceneLoadEvent(SceneLoadEvent.SHOW_LOAD_EVENT);e.backImgUrl="ui/load/001.jpg",ModuleEventManager.dispatchEvent(e);var f=new EngineEvent(EngineEvent.CREAT_SCENE_EVENT);f.sceneName=a.mapName,f.sceneLoadcomplteFun=a.mainSceneComplete,f.sceneAnylsizFun=a.mainSceneAnalysisComplete,f.sceneProgressFun=a.mainSceneProgress,ModuleEventManager.dispatchEvent(f)},a.setMapData=function(){Scene_data.focus3D.rotationX=-45,Scene_data.cam3D.distance=281,Scene_data.focus3D.x=0,Scene_data.focus3D.z=0,Scene_data.focus3D.y=0,SceneManager.mapQudaTreeDistance=2e3},a.mainSceneAnalysisComplete=function(){a.loadComplteFun&&a.loadComplteFun(),ModuleEventManager.dispatchEvent(new SceneLoadEvent(SceneLoadEvent.REMOVE_LOAD_EVENT)),a.firstEnterScene()},a.configFinish=function(){msgtip.GuideModel.getInstance().stepGuideId=0,msgtip.GuideModel.getInstance().lastPage=null,GameData.enterSceneNextOpenEvent?(ModuleEventManager.dispatchEvent(GameData.enterSceneNextOpenEvent),GameData.enterSceneNextOpenEvent=null):(SceneManager.getInstance().render=!0,GuidData.map.showAreaById(AreaType.fightSKill_7)&&(mainUi.MainUiModel.skillTabIndex=0),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),AotuSkillManager.getInstance().aotuBattle=Boolean(1==GuidData.map.tbMapVo.aotubattle),AotuSkillManager.getInstance().aotuBattle&&MainCharControlModel.getInstance().downMount(),ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.ENTER_SCENE_EVENT)))},a.firstEnterScene=function(){a.first||(a.first=!0,GuidData.bag&&GuidData.bag.setBagAlert(),GameData.configData.read())},a.mainSceneComplete=function(){var a=new SceneLoadEvent(SceneLoadEvent.ANALYSIS_LOAD_EVENT);ModuleEventManager.dispatchEvent(a)},a.mainSceneProgress=function(b){a.loadProgressFun&&a.loadProgressFun(b);var c=new SceneLoadEvent(SceneLoadEvent.PROGRESS_LOAD_EVENT);c.progress=b,ModuleEventManager.dispatchEvent(c)},a.teleportMap=function(a,b){var c=tb.TB_map.getTB_map(a);c.is_PK?AlertUtil.show(ColorType.Brown7a2f21+"当前前往地图为PVP地图，可能会被家族外的其他玩家攻击，是否继续前往？","提示",function(c){1==c&&NetManager.getInstance().protocolos.teleport_map(a,b)},2,["是","否"]):NetManager.getInstance().protocolos.teleport_map(a,b)},a.pandaVisibel=!0,a.canclikFightui=!0,a.roleList=new Array,a.bagCdItem=new Object,a.useYaoGan=!1,a._threeBattarId=0,a.sceneResEqu=!1,a.first=!1,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),tb;!function(a){var b=function(){function a(){}return a}();a.SkillLevelVo=b;var c=function(){function b(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.info=a.info,this.output_info=a.output_info,this.zhuangbility=a.zhuangbility,this.icon=a.icon,this.avatar=a.avatar,this.level=a.level,this.money_type=a.money_type,this.rank=a.rank,this.bind_type=a.bind_type,this.type=a.type,this.type_c=a.type_c,this.type_name=a.type_name,this.pos=a.pos,this.quality=a.quality,this.sex=a.sex,this.price=a.price,this.is_transaction=a.is_transaction,this.max_overlap=a.max_overlap,this.Auto=a.Auto,this.is_slather=a.is_slather,this.output=new Array,makeArray(a.output,this.output),this.use_result=a.use_result,this.isdoubleclick=a.isdoubleclick,this.double_click=new Array,makeArray(a.double_click,this.double_click),this.basic_properties=new Array,makeArray(a.basic_properties,this.basic_properties),this.suit_id=new Array,makeArray(a.suit_id,this.suit_id),this.using_effect=new Array,makeArray(a.using_effect,this.using_effect),this.category=a.category,this.category_cooldown=a.category_cooldown,this.cooldown=a.cooldown,this.goods_id=a.goods_id,this.arrange=a.arrange,this.expend_data=a.expend_data,this.use_object=a.use_object,this.quest=a.quest,this.forge_pro_max=new Array,makeArray(a.forge_pro_max,this.forge_pro_max),this.forge_pro=new Array,
makeArray(a.forge_pro,this.forge_pro),this.is_auction=a.is_auction,this.auction_money=a.auction_money,this.out_bag=a.out_bag,this.suitId=a.suitId,this.handInReward=new Array,makeArray(a.handInReward,this.handInReward),this.exchangeCost=new Array,makeArray(a.exchangeCost,this.exchangeCost),this.destroyReward=a.destroyReward,this.avatar||(this.avatar=this.id)}return b.get_TB_item_template=function(a){var c=TableData.getInstance().getData(TableData.tb_item_template,a);return new b(c)},b.getAvatarById=function(a){return 0==a?0:this.get_TB_item_template(a).avatar},b.prototype.getColorName=function(){var b="["+a.TB_item_quality_color.getTempVo(this.quality).color+"]";return console.log("--------颜色---------",b),b+this.name},b}();a.TB_item_template=c;var d=function(){function a(){}return a.prototype.parse=function(a){this.playerLevel=a.playerLevel,this.questid=a.questid,this.Pre_skill=a.Pre_skill,this.item=new Array,makeArray(a.item,this.item),this.resource=new Array,makeArray(a.resource,this.resource)},a}();a.SkillLearnVo=d;var e=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cd=a.cd}return a.get_TB_restore_potion_base=function(b){var c=TableData.getInstance().getData(TableData.tb_restore_potion_base,b),d=new a(c);return d},a}();a.TB_restore_potion_base=e;var f=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.output=new Array,makeArray(a.output,this.output)}return a.get_TB_item_output=function(b){var c=TableData.getInstance().getData(TableData.tb_item_output,b),d=new a(c);return console.log("----id---",b,d),d},a}();a.TB_item_output=f;var g=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.distance=a.distance,this.mcd=a.mcd,this.num=a.num,this.hurt_percent=a.hurt_percent,this.cannot_defence_hure=a.cannot_defence_hure,this.fight_value=a.fight_value,this.uplevel_item=new Array,makeArray(a.uplevel_item,this.uplevel_item),this.need_level=a.need_level,this.uplevel_cost=new Array,makeArray(a.uplevel_cost,this.uplevel_cost)}return a.get_TB_skill_uplevel=function(b){var c=TableData.getInstance().getData(TableData.tb_skill_uplevel,b),d=new a(c);return d},a}();a.TB_skill_uplevel=g;var h=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.mapid=a.mapid,this.x=a.x,this.y=a.y,this.info=a.info}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_world_map);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_world_map,b),d=new a(c);return d},a}();a.TB_world_map=h;var i=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.avatar=a.avatar,this.weapon=a.weapon,this.waiguan=new Array,makeArray(a.waiguan,this.waiguan),this.weaponwg=new Array,makeArray(a.weaponwg,this.weaponwg),this.waiguantj=new Array,makeArray(a.waiguantj,this.waiguantj)}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_char_info,b),d=new a(c);return d},a}();a.TB_char_info=i;var j=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.avatar=a.avatar,this.icon=a.icon,this.level=a.level,this.attrKeys=new Array,makeArray(a.attrKeys,this.attrKeys),this.attrValues=new Array,makeArray(a.attrValues,this.attrValues),this.costs=new Array,makeArray(a.costs,this.costs)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_appearance_info);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_appearance_info,b),d=new a(c);return d},a}();a.TB_appearance_info=j;var k=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.attrKeys=new Array,makeArray(a.attrKeys,this.attrKeys),this.attrValues=new Array,makeArray(a.attrValues,this.attrValues),this.exterior=new Array,makeArray(a.exterior,this.exterior)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_appearance_pokedex);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_appearance_pokedex,b),d=new a(c);return d},a}();a.TB_appearance_pokedex=k;var l=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.itemId=a.itemId,this.name=a.name,this.exp=a.exp,this["goto"]=a["goto"],this.goto_sub=new Array,makeArray(a.goto_sub,this.goto_sub)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_meridian_item);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_meridian_item,b),d=new a(c);return d},a}();a.TB_meridian_item=l;var m=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.exp=a.exp,this.limit=a.limit,this["goto"]=new Array,makeArray(a["goto"],this["goto"])}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_meridian_source);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_meridian_source,b),d=new a(c);return d},a}();a.TB_meridian_source=m;var n=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.costExp=a.costExp,this.pic=a.pic,this.costMoney=new Array,makeArray(a.costMoney,this.costMoney),this.attrKeys0=new Array,makeArray(a.attrKeys0,this.attrKeys0),this.attrValues0=new Array,makeArray(a.attrValues0,this.attrValues0),this.attrKeys1=new Array,makeArray(a.attrKeys1,this.attrKeys1),this.attrValues1=new Array,makeArray(a.attrValues1,this.attrValues1),this.attrKeys2=new Array,makeArray(a.attrKeys2,this.attrKeys2),this.attrValues2=new Array,makeArray(a.attrValues2,this.attrValues2),this.pos=new Array,makeArray(a.pos,this.pos)}return a.prototype.refrishById=function(a){var b=Math.floor((a-1)/2);0==b&&(this.attrKeys=this.attrKeys0,this.attrValues=this.attrValues0),1==b&&(this.attrKeys=this.attrKeys1,this.attrValues=this.attrValues1),2==b&&(this.attrKeys=this.attrKeys2,this.attrValues=this.attrValues2)},a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_meridian_info);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_meridian_info,b),d=new a(c);return d},a}();a.TB_meridian_info=n;var o=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.mapid=a.mapid,this.name=a.name,this.info=a.info,this.need_Num=a.need_Num,this.recom_force=a.recom_force,this.map_pic=a.map_pic,this.monster=new Array,makeArray(a.monster,this.monster),this.passRewardId=new Array,makeArray(a.passRewardId,this.passRewardId),this.passRewardCnt=new Array,makeArray(a.passRewardCnt,this.passRewardCnt),this.fpRewardId=new Array,makeArray(a.fpRewardId,this.fpRewardId),this.fpRewardCnt=new Array,makeArray(a.fpRewardCnt,this.fpRewardCnt),this.times=a.times,this.limLev=a.limLev}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_group_instance_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_group_instance_base,b),d=new a(c);return d},a}();a.TB_group_instance_base=o;var p=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.daily_reset=a.daily_reset,this.buy_type=new Array,makeArray(a.buy_type,this.buy_type),this.buy_price=new Array,makeArray(a.buy_price,this.buy_price)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_group_instance_buy);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_group_instance_buy,b),d=new a(c);return d},a}();a.TB_group_instance_buy=p;var q=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.mapid=a.mapid,this.bossEntry=a.bossEntry,this.permitLevel=a.permitLevel,this.show=new Array,makeArray(a.show,this.show)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_mass_boss_info);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_mass_boss_info,b),d=new a(c);return d},a}();a.TB_mass_boss_info=q;var r=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cd=a.mapid,this.dailytimes=a.dailytimes}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_mass_boss_base,b),d=new a(c);return d},a}();a.TB_mass_boss_base=r;var s=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cost=new Array,makeArray(a.cost,this.cost)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_mass_boss_times);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_mass_boss_times,b),d=new a(c);return d},a}();a.TB_mass_boss_times=s;var t=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.limit=a.limit}return a.get_TB_anger_limit=function(b){var c=TableData.getInstance().getData(TableData.tb_anger_limit,b),d=new a(c);return d},a}();a.TB_anger_limit=t;var u=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.divine=a.divine,this.avatar=a.avatar,this.skills=new Array,makeArray(a.skills,this.skills)}return a.get_TB_item_illusion=function(b){var c=TableData.getInstance().getData(TableData.tb_item_illusion,b),d=new a(c);return d},a}();a.TB_item_illusion=u;var v=function(){function a(a){if(a){this.id=a.id,this.params=a.params,this.skinName=this.params.split(",")[1],this.isMainui=Boolean(1==Number(this.params.split(",")[0])),this.isfinish=a.isfinish,this.type=a.type,this.text=a.text,this.area=new Array,makeArray(a.area,this.area);var b=a.layout.split(",");this.layout=new Object;for(var c=0;c<b.length;c++){var d=b[c].split(":"),e=trim(d[0]);this.layout[e]=Number(d[1])}}}return a.get_TB_system_guide=function(b){var c=TableData.getInstance().getData(TableData.tb_system_guide,b);if(c){var d=new a(c);return d}return null},a}();a.TB_system_guide=v;var w=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.dailyLimit=a.dailyLimit,this.questshow=a.questshow}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_daily2_base,b),d=new a(c);return d},a}();a.TB_quest_daily2_base=w;var x=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.indx=a.indx,this.entry=a.entry,this.show=new Array,makeArray(a.show,this.show)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_map_field_boss);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_map_field_boss,b),d=new a(c);return d},a}();a.TB_map_field_boss=x;var y=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.slot=a.slot}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_item_slot);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_item_slot,b);if(c){var d=new a(c);return d}return null},a}();a.TB_item_slot=y;var z=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.questSet=new Array,makeArray(a.questSet,this.questSet),this.rewards=new Array,makeArray(a.rewards,this.rewards),this.quality=a.quality}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_daily2_set,b),d=new a(c);return d},a}();a.TB_quest_daily2_set=z;var A=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.rewards=new Array,makeArray(a.rewards,this.rewards)}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_daily2_finish_reward,b),d=new a(c);return d},a}();a.TB_quest_daily2_finish_reward=A;var B=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.levelrange=new Array,makeArray(a.levelrange,this.levelrange),this.questSet=new Array,makeArray(a.questSet,this.questSet),this.questSelectNum=new Array,makeArray(a.questSelectNum,this.questSelectNum),this.finishQuestsNum=new Array,makeArray(a.finishQuestsNum,this.finishQuestsNum),this.rewardsSelect=new Array,makeArray(a.rewardsSelect,this.rewardsSelect),this.allFinishrewards=new Array,makeArray(a.allFinishrewards,this.allFinishrewards)}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_daily2,b),d=new a(c);return d},a}();a.TB_quest_daily2=B;var C=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.color=a.color}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_item_quality_color,b),d=new a(c);return d},a}();a.TB_item_quality_color=C;var D=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.dailyLimit=a.dailyLimit}return a.getTempByID=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_daily_base,b),d=new a(c);return d},a}();a.TB_quest_daily_base=D;var E=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.score=a.score,this.title=a.title,this.type=a.type,this.reward=new Array,makeArray(a.reward,this.reward),this.rewardtype=new Array,makeArray(a.rewardtype,this.rewardtype)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_kuafu3v3_month_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempByID=function(b){var c=TableData.getInstance().getData(TableData.tb_kuafu3v3_month_reward,b),d=new a(c);return d},a}();a.TB_kuafu3v3_month_reward=E;var F=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.last=a.last,this.show=new Array,makeArray(a.show,this.show)}return a.getTempByID=function(b){var c=TableData.getInstance().getData(TableData.tb_map_jump_point_detail,b),d=new a(c);return d},a}();a.TB_map_jump_point_detail=F;var G=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.reward=new Array,makeArray(a.reward,this.reward),this.rank=new Array,makeArray(a.rank,this.rank)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_kuafu3v3_week_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempByID=function(b){var c=TableData.getInstance().getData(TableData.tb_kuafu3v3_week_reward,b),d=new a(c);return d},a}();a.TB_kuafu3v3_week_reward=G;var H=function(){function a(a){a||traceNoTabelData(),this.daytimes=a.daytimes,this.daybuytimes=a.daybuytimes,this.daybuycost=new Array,makeArray(a.daybuycost,this.daybuycost)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_kuafu3v3_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_kuafu3v3_base=H;var I=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.num=a.num,this.reward=new Array,makeArray(a.reward,this.reward)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_kuafu3v3_day_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempByID=function(b){var c=TableData.getInstance().getData(TableData.tb_kuafu3v3_day_reward,b),d=new a(c);return d},a}();a.TB_kuafu3v3_day_reward=I;var J=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.type=a.type,this.rank=a.rank,this.reward=a.reward,this.title=a.title}return a.getTempByID=function(b,c){var d=10*b+c,e=TableData.getInstance().getData(TableData.tb_rank_reward,d),f=new a(e);return f},a}();a.Tb_rank_reward=J;var K=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cost=new Array,makeArray(a.cost,this.cost),this.maxnum=a.maxnum}return a.getItemById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_creat,b),d=new a(c);return d},a}();a.TB_faction_creat=K;var L=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.icon=a.icon}return a.getTempByID=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_icon);for(var d in c.data){var e=new a(c.data[d]);e.isactivityflag=!1,e.isvisiable=!1,b.push(e)}return b},Object.defineProperty(a.prototype,"isactivityflag",{get:function(){return this.isactivity},set:function(a){this.isactivity=a},enumerable:!0,configurable:!0}),a}();a.Tb_faction_icon=L;var M=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cost=a.cost,this.maxnum=a.maxnum,this.golddonation=a.golddonation,this.ybdonation=a.ybdonation,this.shop=a.shop,this.token_max_buy=a.token_max_buy,this.token_buy_price=new Array,makeArray(a.token_buy_price,this.token_buy_price),this.token_daily=a.token_daily,this.token_max_keep=a.token_max_keep,this.token_points=a.token_points,this.gift_points_must_reply=a.gift_points_must_reply,this.gift_view_rows=a.gift_view_rows}return a.get_Tb_faction_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_Tb_faction_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_base,b),d=new a(c);return d},a}();a.Tb_faction_base=M;var N=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.num=a.num,this.reward=a.reward,this.info=a.info,this.title=a.title}return a.get_Tb_faction_zhiwei=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_zhiwei);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_Tb_faction_zhiweiById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_zhiwei,b),d=new a(c);return d},a}();a.Tb_faction_zhiwei=N;var O=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.devote=a.devote,this.money=a.money,this.cost=new Array,makeArray(a.cost,this.cost)}return a.get_Tb_faction_donation=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_donation);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_Tb_faction_donationById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_donation,b),d=new a(c);return d},a}();a.Tb_faction_donation=O;var P=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.itemId=a.itemId,this.itemNum=a.itemNum,this.num=a.num,this.lev=a.lev,this.costResource=new Array,makeArray(a.costResource,this.costResource),this.discount_flag=a.discount_flag}return a.get_Tb_faction_shop=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_shop);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_Tb_faction_shopById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_shop,b),d=new a(c);return d},a}();a.Tb_faction_shop=P;var Q=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.desc=a.desc,this.info=a.info,this.icon=a.icon,this.is_initiative=a.is_initiative,this.skill_type=a.skill_type,this.type=a.type,this.target_type=a.target_type,this.pre=a.pre,this.is_end=a.is_end,this.follow=new Array,makeArray(a.follow,this.follow),this.time_change=new Array,makeArray(a.time_change,this.time_change),this.singleCD=a.singleCD,this.groupCD=a.groupCD,this.self_cd=a.self_cd,this.group=a.group,this.uplevel_id=new Array,makeArray(a.uplevel_id,this.uplevel_id),this.magic_type=a.magic_type,this.nuqi_change=a.nuqi_change,this.attack_mast=new Array,makeArray(a.attack_mast,this.attack_mast),this.is_fix=a.is_fix,this.effect_file=a.effect_file,this.effect=a.effect,this.isOrbit=a.isOrbit,this.condition_skill=a.condition_skill,this.study_requirement=a.study_requirement,this.alarmEffect=a.alarmEffect,this.can_move=a.can_move,this.is_remain=a.is_remain,this.is_play_forbid=a.is_play_forbid,this.lock_type=a.lock_type,this.timeout=a.timeout,this.specialtype=a.specialtype}return a.get_TB_skill_base=function(b){var c=TableData.getInstance().getData(TableData.tb_skill_base,b),d=new a(c);return d},a}();a.TB_skill_base=Q;var R=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.mountID=a.mountID,this.addTrainExp=a.addTrainExp,this.speed=a.speed,this.skills=new Array,makeArray(a.skills,this.skills)}return a.get_TB_mount_base_vo=function(b){var c=TableData.getInstance().getData(TableData.tb_mount_base,b),d=new a(c);return d},a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_mount_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_mount_base_vo=R;var S=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.items=new Array,makeArray(a.items,this.items)}return a.get_TB_quest_chapter=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_chapter,b),d=new a(c);return d},a}();a.TB_quest_chapter=S;var T=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.icon=a.icon,this.iconpos=new Array,makeArray(a.iconpos,this.iconpos)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_risk_chapter);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_risk_chapter=function(b){var c=TableData.getInstance().getData(TableData.tb_risk_chapter,b),d=new a(c);return d},a}();a.TB_risk_chapter=T;var U=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.count=a.count}return a.get_TB_risk_menu=function(b){var c=TableData.getInstance().getData(TableData.tb_risk_menu,b),d=new a(c);return d},a}();a.TB_risk_menu=U;var V=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.mapid=a.mapid,this.name=a.name,this.nextId=a.nextId,this.advisepoint=a.advisepoint,this.parentid=a.parentid,this.bossId=a.bossId,this.suitScore=a.suitScore,this.suitScoreChange=a.suitScoreChange,this.level=a.level,this.goldReward=new Array,makeArray(a.goldReward,this.goldReward),this.expReward=new Array,makeArray(a.expReward,this.expReward),this.showitems=new Array,makeArray(a.showitems,this.showitems),this.chapterId=Math.floor(this.id%1e6/1e3),this.cardId=Math.floor(this.id%1e3),this.bossmap=Math.floor(this.id/1e6)}return a.get_TB_risk_data=function(b){var c=TableData.getInstance().getData(TableData.tb_risk_data,b),d=new a(c);return d},a}();a.TB_risk_data=V;var W=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.firstSection=a.firstSection}return a.get_TB_risk_base=function(b){var c=TableData.getInstance().getData(TableData.tb_risk_base,b),d=new a(c);return d},a}();a.TB_risk_base=W;var X=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.quality=a.quality,this.text=a.text}return a}();a.TB_hook_quality_Vo=X;var Y=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.items=new Array,makeArray(a.items,this.items)}return a.get_TB_hook_hp_item_Vo=function(b){var c=TableData.getInstance().getData(TableData.tb_hook_hp_item,b),d=new a(c);return d},a}();a.TB_hook_hp_item_Vo=Y;var Z=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.level=a.level,this.star=a.star,this.exp=a.exp,this.prosKeys=new Array,makeArray(a.prosKeys,this.prosKeys),this.prosValues=new Array,makeArray(a.prosValues,this.prosValues),this.traincost=new Array,makeArray(a.traincost,this.traincost)}return a.getTB_mount_train_vo=function(b,c){var d=11*(b-1)+c+1,e=TableData.getInstance().getData(TableData.tb_mount_train,d),f=new a(e);return f},a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_mount_train);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_mount_train_vo=Z;var $=function(){function a(a){this.id=a.id,this.upgradeExp=a.upgradeExp,this.upgradeMode=a.upgradeMode,this.upgradecost=new Array,makeArray(a.upgradecost,this.upgradecost)}return a.get_TB_mount_upgrade=function(b){var c=TableData.getInstance().getData(TableData.tb_mount_upgrade,b),d=new a(c);return d},a}();a.TB_mount_upgrade=$;var _=function(){function a(a){this.spellVolist=new Array,this.prosKeys=new Array,this.prosValues=new Array,a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.mountID=a.mountID,this.condition=a.condition,this.mountLevel=a.mountLevel,this.last=a.last,this.battlepoint=a.battlepoint,this.force=a.force,this.costResource=new Array,this.costItem=new Array,this.spells=new Array,makeArray(a.costResource,this.costResource),makeArray(a.costItem,this.costItem),makeArray(a.spells,this.spells),this.prosKeys=new Array,makeArray(a.prosKeys,this.prosKeys),this.prosValues=new Array,makeArray(a.prosValues,this.prosValues)}return a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_mount_illusion);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_mount_illusion_vo=function(b){var c=TableData.getInstance().getData(TableData.tb_mount_illusion,b),d=new a(c);return d},a}();a.TB_mount_illusion_vo=_;var aa=function(){function a(){}return a.prototype.parse=function(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.desc=a.desc,this.info=a.info,this.icon=a.icon,this.is_initiative=a.is_initiative,this.uplevel_id=new Array,makeArray(a.uplevel_id,this.uplevel_id)},a}();a.SpellVo=aa;var ba=function(b){function c(a){return b.call(this,a)||this}return __extends(c,b),c.getTB_divine_skillById=function(b){var c=TableData.getInstance().getData(TableData.tb_skill_base,b),d=new a.TB_divine_skill_vo(c);return d},c}(a.SkillDataVo);a.TB_divine_skill_vo=ba;var ca=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.divineid=a.divineid,this.lev=a.lev,this.props=new Array,makeArray(a.props,this.props)}return a.get_TB_divine_streng=function(b){var c=TableData.getInstance().getData(TableData.tb_divine_streng,b),d=new a(c);return d},a}();a.TB_divine_streng=ca;var da=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.bless=a.bless,this.cost=new Array,makeArray(a.cost,this.cost)}return a.get_TB_divine_bless=function(b){var c=TableData.getInstance().getData(TableData.tb_divine_bless,b),d=new a(c);return d},a}();a.TB_divine_bless=da;var ea=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.info=a.info,this.npcflag=a.npcflag,this.monster_type=a.monster_type,this.hp_num=a.hp_num,this.level=a.level,this.ainame=a.ainame,this.attack_type=a.attack_type,this.avatar=Number(a.avatar),this.lockfaceto=a.lockfaceto,this.title_flag=a.title_flag,this.drop_belong=a.drop_belong,this.dialogue_id=a.dialogue_id}return a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_creature_template);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_creature_template=function(b){var c=TableData.getInstance().getData(TableData.tb_creature_template,b),d=new a(c);return d},a}();a.TB_creature_template=ea;var fa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.texst=a.texst}return a.get_TB_quest_vip_instance=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_vip_instance,b),d=new a(c);return d},a}();a.TB_quest_vip_instance=fa;var ga=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.model=Number(a.model),this.skill=a.skill,this.avtivetype=a.avtivetype,this.icon=a.icon,this.time=a.time,this.strength=a.strength,this.type=a.type,this.avtivedata=new Array,makeArray(a.avtivedata,this.avtivedata),this.passiveskill=new Array,makeArray(a.passiveskill,this.passiveskill)}return a.get_TB_divine_base=function(b){var c=TableData.getInstance().getData(TableData.tb_divine_base,b),d=new a(c);return d},a}();a.TB_divine_base=ga;var ha=function(){function b(b){b||traceNoTabelData(),this.tb=ga.get_TB_divine_base(b.id),this.skillvo=a.SkillDataVo.getSkillBaseDataById(b.skill),this.passiveskillItem=new Array;for(var c=0;c<this.tb.passiveskill.length;c++){var d=this.tb.passiveskill[c],e=a.TB_divine_skill_vo.getTB_divine_skillById(d[0]);e.openSart=d[1],this.passiveskillItem.push(e)}}return b.getTabelItem=function(){var a=new Array,c=TableData.getInstance().getTableByName(TableData.tb_divine_base);for(var d in c.data){var e=new b(c.data[d]);a.push(e)}return a},b.get_TB_divine_base=function(a){var c=TableData.getInstance().getData(TableData.tb_divine_base,a),d=new b(c);return d},b}();a.TB_divine_baseVO=ha;var ia=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.type=a.type,this.mapres=a.mapres,this.levellimit=a.levellimit,this.is_PK=a.is_PK,this.inst_sub_type=a.inst_sub_type,this.aotubattle=a.aotubattle,this.allowChangeMode=a.allowChangeMode,this.types=a.types,this.inst_type=a.inst_type,this.is_instance=a.is_instance;var b=new Array;makeArray(a.mainshow,b);var c=new Array;makeArray(a.show,c),this.show=b.concat(c),this.path=new Array,makeArray(a.path,this.path)}return a.prototype.showAreaById=function(a){for(var b=0;b<this.show.length;b++)if(this.show[b]==a)return!0;return!1},a.getTB_map=function(b){var c=TableData.getInstance().getData(TableData.tb_map,b),d=new a(c);return d},a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_map);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_map=ia;var ja=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.model=a.model,this.force=a.force,this.resetgold=a.resetgold,this.time=a.time,this.firstReward=new Array,makeArray(a.firstReward,this.firstReward),this.showreward=new Array,makeArray(a.showreward,this.showreward)}return a.get_TB_map_trial=function(b){var c=TableData.getInstance().getData(TableData.tb_instance_trial,b),d=new a(c);return d},a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_instance_trial);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_map_trial=ja;var ka=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.limit=a.limit,this.costResource=new Array,makeArray(a.costResource,this.costResource)}return a.get_TB_store=function(b){var c=TableData.getInstance().getData(TableData.tb_store,b),d=new a(c);return d},a}();a.TB_store=ka;var la=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.typename=a.typename}return a.get_TB_shop_base=function(b){var c=TableData.getInstance().getData(TableData.tb_shop_base,b),d=new a(c);return d},a}();a.TB_shop_base=la;var ma=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.itemId=a.itemId,this.tab=a.tab,this.type=a.type,this.recommend=a.recommend,this.limtime=a.limtime,this.limtype=a.limtype,this.limdata=a.limdata,this.discount=a.discount,this.count=a.count,this.time=a.time,this.limit=a.limit,this.costResource=new Array,makeArray(a.costResource,this.costResource)}return a.get_TB_shopById=function(b){var c=TableData.getInstance().getData(TableData.tb_shop,b),d=new a(c);return d},a.get_TB_shop=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_shop);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_shop=ma;var na=function(){function a(a){return this.navi=new Array,a?(this.id=a.id,void makeArray(a.navi,this.navi)):void traceNoTabelData()}return a.get_TB_map_navigation=function(b){var c=TableData.getInstance().getData(TableData.tb_map_navigation,b),d=new a(c);return d},a}();a.TB_map_navigation=na;var oa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.type=a.type,this.name=a.name,this.color=a.color,this.position=new Vector2D,this.position.x=a.position[0],this.position.y=a.position[1]}return a.get_TB_map_object=function(b){var c=TableData.getInstance().getData(TableData.tb_map_object,b),d=new a(c);return d},a}();a.TB_map_object=oa;var pa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.vip=a.vip,this.times=a.times,this.forces=new Array,makeArray(a.forces,this.forces),this.reward=new Array,makeArray(a.reward,this.reward),this.cost=new Array,
makeArray(a.cost,this.cost),this.creatures=new Array,makeArray(a.creatures,this.creatures)}return a.get_TB_map_vip=function(b){var c=TableData.getInstance().getData(TableData.tb_map_vip,b),d=new a(c);return d},a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_map_vip);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_map_vip=pa;var qa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.exp=a.exp}return a.get_Tb_social_familiay=function(b){var c=TableData.getInstance().getData(TableData.tb_social_familiay,b),d=new a(c);return d},a}();a.Tb_social_familiay=qa;var ra=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.itemId=a.itemId,this.familiay=a.familiay,this.costResource=new Array,makeArray(a.costResource,this.costResource)}return a.get_Tb_social_shopItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_social_shop);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.Tb_social_shop=ra;var sa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.content=a.content}return a.get_TB_msg_text_type=function(b){var c=TableData.getInstance().getData(TableData.tb_msg_text_type,b),d=new a(c);return d},a}();a.TB_msg_text_type=sa;var ta=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.entry=a.entry,this.items=new Array,makeArray(a.items,this.items)}return a.get_TB_worldboss_base=function(b){var c=TableData.getInstance().getData(TableData.tb_worldboss_base,b),d=new a(c);return d},a}();a.TB_worldboss_base=ta;var ua=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.enrolllast=a.enrolllast,this.time_last=a.time_last,this.time=new Array,makeArray(a.time,this.time)}return a.get_TB_worldboss_time=function(b){var c=TableData.getInstance().getData(TableData.tb_worldboss_time,b),d=new a(c);return d},a}();a.TB_worldboss_time=ua;var va=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.factiondonation=a.factiondonation,this.factionybdonation=a.factionybdonation,this.resReward=a.resReward,this.djtReward=a.djtReward,this.qualifyReward=a.qualifyReward,this.groupReward=a.groupReward,this.worldbossReward=a.worldbossReward,this.trialReward=a.trialReward,this.riskReward=a.riskReward,this.massbossBuyTimes=a.massbossBuyTimes,this.djtBuyTimes=a.djtBuyTimes,this.chongzhi=a.chongzhi,this.treeTimes=a.treeTimes,this.desc=a.desc,this.gift=new Array,makeArray(a.gift,this.gift),this.cost=new Array,makeArray(a.cost,this.cost),this.fake_cost=new Array,makeArray(a.fake_cost,this.fake_cost)}return a.get_TB_vip_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_vip_base,b),d=new a(c);return d},a.getTB_vip_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_vip_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_vip_base=va;var wa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.id2=a.id2,this.reward=a.reward}return a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_worldboss_rank_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_worldboss_rank_reward=wa;var xa=function(){function a(a){a||traceNoTabelData(),this.zhudong_list=new Array,makeArray(a.zhudong_list,this.zhudong_list),this.anger_list=new Array,makeArray(a.anger_list,this.anger_list),this.passive_list=new Array,makeArray(a.passive_list,this.passive_list)}return a.get_TB_skill_show=function(b){var c=TableData.getInstance().getData(TableData.tb_skill_show,b),d=new a(c);return d},a}();a.TB_skill_show=xa;var ya=function(){function a(a){return a?(this.id=a.id,this.type=a.type,this.reason=a.reason,this.text=a.text,void(this.msgtype=a.msgtype)):void traceNoTabelData()}return a.get_TB_msg=function(b){var c=TableData.getInstance().getData(TableData.tb_msg,b),d=new a(c);return d},a}();a.TB_msg=ya;var za=function(){function a(a){return a?(this.id=a.id,this.name=a.name,this.nums=a.nums,this.active=a.active,this.icon=a.icon,this.greptimelim=a.greptimelim,this.grepone=a.grepone,this.grepgroup=a.grepgroup,this.grepfaction=a.grepfaction,this.recommend=a.recommend,this.pvp=a.pvp,this.limtype=a.limtype,this.limdata=a.limdata,this["goto"]=a["goto"],this.goto_sub=a.goto_sub,this.vipnums=new Array,makeArray(a.vipnums,this.vipnums),this.time=new Array,makeArray(a.time,this.time),this.basereward=new Array,makeArray(a.basereward,this.basereward),this.reward=new Array,makeArray(a.reward,this.reward),void(this.info=a.info)):void traceNoTabelData()}return a.get_TB_activity_baseByid=function(b){var c=TableData.getInstance().getData(TableData.tb_activity_base,b),d=new a(c);return d},a.get_TB_activity_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_activity_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_activity_base=za;var Aa=function(){function a(a){return a?(this.id=a.id,this.active=a.active,this.reward=new Array,makeArray(a.reward,this.reward),this.vipreward=new Array,void makeArray(a.vipreward,this.vipreward)):void traceNoTabelData()}return a.get_TB_activity_rewardByid=function(b){var c=TableData.getInstance().getData(TableData.tb_activity_reward,b),d=new a(c);return d},a.get_TB_activity_reward=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_activity_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_activity_reward=Aa;var Ba=function(){function a(a){return a?(this.id=a.id,void(this.num=a.num)):void traceNoTabelData()}return a.get_TB_social_num=function(b){var c=TableData.getInstance().getData(TableData.tb_social_num,b),d=new a(c);return d},a}();a.TB_social_num=Ba;var Ca=function(){function a(a){return a?(this.id=a.id,this.npc_dialogue=a.npc_dialogue,this.next_id=a.next_id,this.type=a.type,void(this.typedata=a.typedata)):void traceNoTabelData()}return a.get_TB_creature_dialogue=function(b){var c=TableData.getInstance().getData(TableData.tb_creature_dialogue,b),d=new a(c);return d},a}();a.TB_creature_dialogue=Ca;var Da=function(){function a(a){return a?(this.id=a.id,this.start=a.start,this.type=a.type,this.ctype=a.ctype,this.showpage=Number(a.showpage),this.level=a.level,this.chapterName=a.chapterName,this.chapter=a.chapter,this.questName=a.questName,this.desc=a.desc,this.popup=a.popup,this.flag=a.flag,this.dialogue=a.dialogue,this.belongSet=a.belongSet,this.specialButton=a.specialButton,this.hint=new Array,makeArray(a.hint,this.hint),this.icon=new Array,makeArray(a.icon,this.icon),this.text=new Array,makeArray(a.text,this.text),this.targetsPosition=new Array,makeArray(a.targetsPosition,this.targetsPosition),this.rewards=new Array,void makeArray(a.rewards,this.rewards)):void traceNoTabelData()}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_quest);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTbById=function(b){var c=TableData.getInstance().getData(TableData.tb_quest,b),d=new a(c);return d},a}();a.TB_quest=Da;var Ea=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.mapid=a.mapid,this.name=a.name,this.type=a.type,this.time=a.time,this.times=a.times,this.limLev=a.limLev,this.boss=a.boss,this.refresnum=a.refresnum,this.randomreward=new Array,makeArray(a.randomreward,this.randomreward),this.basereward=new Array,makeArray(a.basereward,this.basereward),console.log("TB_instance_res",this,a)}return a.getTabelItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_instance_res);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_TB_instance_res=function(b){var c=TableData.getInstance().getData(TableData.tb_instance_res,b),d=new a(c);return d},a}();a.TB_instance_res=Ea;var Fa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.type=a.type,this.stype=a.stype,this.info=a.info,this.maxnum=a.maxnum,this.icon=a.icon,this.linktype=a.linktype,this.reward=new Array,makeArray(a.reward,this.reward),this.achval=a.achval,this.title=a.title}return a.getTB_achieve_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_achieve_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_achieve_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_achieve_base,b),d=new a(c);return d},a}();a.TB_achieve_base=Fa;var Ga=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.achval=a.achval,this.reward=new Array,makeArray(a.reward,this.reward)}return a.getTB_achieve_progress=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_achieve_progress);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_achieve_progressById=function(b){var c=TableData.getInstance().getData(TableData.tb_achieve_progress,b),d=new a(c);return d},a}();a.TB_achieve_progress=Ga;var Ha=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.type=a.type,this.info=a.info,this.getinfo=a.getinfo,this.limtime=a.limtime,this.unlock_type=a.unlock_type,this.qua=a.qua,this.prop=new Array,makeArray(a.prop,this.prop),this.unlock_cost=new Array,makeArray(a.unlock_cost,this.unlock_cost)}return a.getTB_title_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_title_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_title_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_title_base,b),d=new a(c);return d},a}();a.TB_title_base=Ha;var Ia=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.yuanbao=a.yuanbao}return a.getTB_shop_chongzhi=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_shop_chongzhi);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_shop_chongzhi=Ia;var Ja=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.time=a.time,this.actionState=a.actionState,this.regX=a.regX,this.regY=a.regY,this.taskShow=a.taskShow,this.judge=a.judge,this.quest_id0=a.quest_id0,this.quest_id1=a.quest_id1,this.quest_id2=a.quest_id2,this.quest_id3=a.quest_id3,this.trigger_width=a.trigger_width,this.trigger_height=a.trigger_height,this.avatar=Number(a.avatar),this.style=a.style}return a.get_TB_gameobject_template=function(b){var c=TableData.getInstance().getData(TableData.tb_gameobject_template,b),d=new a(c);return d},a}();a.TB_gameobject_template=Ja;var Ka=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.item=new Array,makeArray(a.item,this.item)}return a.get_TB_welfare_shouchongById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_shouchong,b),d=new a(c);return d},a.get_TB_welfare_shouchong=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_shouchong);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_shouchong=Ka;var La=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.item=new Array,makeArray(a.item,this.item),this.vip=a.vip,this.times=a.times}return a.get_TB_welfare_checkinById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_checkin,b),d=new a(c);return d},a.get_TB_welfare_checkin=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_checkin);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_checkin=La;var Ma=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.num=a.num,this.item=new Array,makeArray(a.item,this.item)}return a.get_TB_welfare_checkin_allById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_checkin_all,b),d=new a(c);return d},a.get_TB_welfare_checkin_all=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_checkin_all);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_checkin_all=Ma;var Na=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.lev=a.lev,this.item=new Array,makeArray(a.item,this.item)}return a.get_TB_welfare_levelById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_level,b),d=new a(c);return d},a.get_TB_welfare_level=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_level);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_level=Na;var Oa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.basecost=new Array,makeArray(a.basecost,this.basecost),this.allcost=new Array,makeArray(a.allcost,this.allcost),this.basedc=a.basedc,this.alldc=a.alldc,this.name=a.name,this.basereward=new Array,makeArray(a.basereward,this.basereward),this.allreward=new Array,makeArray(a.allreward,this.allreward)}return a.get_TB_welfare_backById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_back,b),d=new a(c);return d},a.get_TB_welfare_back=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_back);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_back=Oa;var Pa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.levelrange=new Array,makeArray(a.levelrange,this.levelrange),this.ticket=new Array,makeArray(a.ticket,this.ticket),this.price=new Array,makeArray(a.price,this.price),this.boxid=a.boxid,this.joinReward=new Array,makeArray(a.joinReward,this.joinReward),this.ticketid=a.ticketid,this.showReward=new Array,makeArray(a.showReward,this.showReward)}return a.get_TB_kuafu_xianfu_conditionById=function(b){var c=TableData.getInstance().getData(TableData.tb_kuafu_xianfu_condition,b),d=new a(c);return d},a.get_TB_kuafu_xianfu_condition=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_kuafu_xianfu_condition);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_kuafu_xianfu_condition=Pa;var Qa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.item=new Array,makeArray(a.item,this.item)}return a.get_TB_welfare_level_show=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_level_show);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_level_show=Qa;var Ra=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.dailytimes=a.dailytimes,this.boxid=a.boxid,this.joinTime=new Array,makeArray(a.joinTime,this.joinTime)}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_kuafu_xianfu_base,b),d=new a(c);return d},a}();a.TB_kuafu_xianfu_base=Ra;var Sa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.rank=a.rank,this.reward=new Array,makeArray(a.reward,this.reward)}return a.get_TB_doujiantai_firstById=function(b){var c=TableData.getInstance().getData(TableData.tb_doujiantai_first,b),d=new a(c);return d},a.get_TB_doujiantai_first=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_doujiantai_first);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_doujiantai_first=Sa;var Ta=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.rank=a.rank,this.reward=a.reward}return a.get_TB_doujiantai_dayById=function(b){var c=TableData.getInstance().getData(TableData.tb_doujiantai_day,b),d=new a(c);return d},a.get_TB_doujiantai_day=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_doujiantai_day);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_doujiantai_day=Ta;var Ua=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.type2=a.type2,this.name=a.name,this.level=a.level,this.level_start=a.level_start,this.info=a.info,this.system_id=new Array,makeArray(a.system_id,this.system_id)}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_system_preview,b),d=new a(c);return d},a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_system_preview);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_system_preview=Ua;var Va=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.position=a.position,this.index=a.index,this.move=a.move,this.index=a.index,this.text=a.text,this.list=new Array,this.bindactive=new Array,makeArray(a.list,this.list),makeArray(a.bindactive,this.bindactive),this.optional_list=new Array,a.optional_list&&makeArray(a.optional_list,this.optional_list)}return a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_system_icon);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_system_icon,b),d=new a(c);return d},a}();a.TB_system_icon=Va;var Wa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.level=a.level,this.position=a.position,this.index=a.index,this.view=a.view,this.isguide=a.isguide,this.guide_id=a.guide_id,this.condition_info=a.condition_info,this.info=a.info,this.show=a.show}return a.getTempVo=function(b){var c=TableData.getInstance().getData(TableData.tb_system_base,b),d=new a(c);return d},a.getItem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_system_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_system_base=Wa;var Xa=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.reward=a.reward}return a.get_TB_doujiantai_combat_winById=function(b){var c=TableData.getInstance().getData(TableData.tb_doujiantai_combat_win,b);if(c){var d=new a(c);return d}return null},a.get_TB_doujiantai_combat_win=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_doujiantai_combat_win);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_doujiantai_combat_win=Xa;var Ya=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.joinTime=new Array,makeArray(a.joinTime,this.joinTime),this.dailytimes=a.dailytimes,this.level=a.level,this.changeRate=a.changeRate,this.refreshCountdown=a.refreshCountdown,this.tryReward=new Array,makeArray(a.tryReward,this.tryReward),this.buyInfo=new Array,makeArray(a.buyInfo,this.buyInfo),this.battleCountdown=new Array,makeArray(a.battleCountdown,this.battleCountdown)}return a.get_TB_doujiantai_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_doujiantai_base,b),d=new a(c);return d},a.get_TB_doujiantai_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_doujiantai_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_doujiantai_base=Ya;var Za=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.parent_id=a.parent_id,this.icon=a.icon,this.name=a.name,this.info=a.info,this.value_type=a.value_type,this.priority=a.priority,this["goto"]=a["goto"],this.goto_sub=new Array,makeArray(a.goto_sub,this.goto_sub),this.limitlev=a.limitlev}return a.get_TB_bianqiang_subById=function(b){var c=TableData.getInstance().getData(TableData.tb_bianqiang_sub,b),d=new a(c);return d},a.get_TB_bianqiang_sub=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_bianqiang_sub);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_bianqiang_sub=Za;var $a=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.value=a.value,this.value_devide=new Array,makeArray(a.value_devide,this.value_devide)}return a.get_TB_bianqiang_valueById=function(b){var c=TableData.getInstance().getData(TableData.tb_bianqiang_value,b),d=new a(c);return d},a.get_TB_bianqiang_value=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_bianqiang_value);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_bianqiang_value=$a;var _a=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.info=a.info,this.color=a.color,this.percent=a.percent,this.icon=a.icon}return a.get_TB_bianqiang_rankById=function(b){var c=TableData.getInstance().getData(TableData.tb_bianqiang_rank,b),d=new a(c);return d},a.get_TB_bianqiang_rank=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_bianqiang_rank);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_bianqiang_rank=_a;var ab=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.max_plunder_recover_count=a.max_plunder_recover_count,this.plunder_recover_time=a.plunder_recover_time,this.rival_refresh_cd=a.rival_refresh_cd,this.module_id=a.module_id,this.base_exp_reward=a.base_exp_reward,this.plunder_exp_reward=a.plunder_exp_reward,this.get_reward_time_limit=a.get_reward_time_limit,this.base_exp_time_unit=a.base_exp_time_unit,this.max_been_plunder_count=a.max_been_plunder_count,this.plunder_exp_lost=a.plunder_exp_lost}return a.get_TB_xiulianchang_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_xiulianchang_base,b),d=new a(c);return d},a.get_TB_xiulianchang_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_xiulianchang_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_xiulianchang_base=ab;var bb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.time_limit=a.time_limit,this.buy_limit=a.buy_limit,this.plunder_limit=a.plunder_limit,this.extend_exp_reward=a.extend_exp_reward,this.buy_price=new Array,makeArray(a.buy_price,this.buy_price)}return a.get_TB_xiulianchang_vipById=function(b){var c=TableData.getInstance().getData(TableData.tb_xiulianchang_vip,b),d=new a(c);return d},a.get_TB_xiulianchang_vip=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_xiulianchang_vip);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_xiulianchang_vip=bb;var cb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.destroyItem=a.destroyItem,this.manager=a.manager,this.coreManager=a.coreManager,this.replaceFlag=a.replaceFlag,this.handInQuality=a.handInQuality}return a.get_TB_faction_privilege=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_privilege,b),d=new a(c);return d},a}();a.TB_faction_privilege=cb;var db=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.time=a.time,this.vip_label=a.vip_label,this.reward=new Array,makeArray(a.reward,this.reward)}return a.get_TB_xiulianchang_rewardById=function(b){var c=TableData.getInstance().getData(TableData.tb_xiulianchang_reward,b),d=new a(c);return d},a.get_TB_xiulianchang_reward=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_xiulianchang_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_xiulianchang_reward=db;var eb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.next_exp=a.next_exp}return a.get_TB_char_levelById=function(b){var c=TableData.getInstance().getData(TableData.tb_char_level,b),d=new a(c);return d},a.get_TB_char_level=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_char_level);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_char_level=eb;var fb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.day=a.day,this.reward=new Array,makeArray(a.reward,this.reward),this.menu_title=a.menu_title,this.indx=a.indx}return a.get_TB_login_activity_rewardById=function(b){var c=TableData.getInstance().getData(TableData.tb_login_activity_reward,b),d=new a(c);return d},a.get_TB_login_activity_reward=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_login_activity_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_login_activity_reward=fb;var gb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.preview_name=a.preview_name,this.preview_model=a.preview_model,this.preview_effect=a.preview_effect,this.preview_info=a.preview_info,this.day=a.day,this.type=a.type}return a.get_TB_login_activity_previewById=function(b){var c=TableData.getInstance().getData(TableData.tb_login_activity_preview,b),d=new a(c);return d},a.get_TB_login_activity_preview=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_login_activity_preview);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_login_activity_preview=gb;var hb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.itemid=a.itemid}return a.get_TB_worldboss_rollById=function(b){var c=TableData.getInstance().getData(TableData.tb_worldboss_roll,b),d=new a(c);return d},a.get_TB_worldboss_roll=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_worldboss_roll);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_worldboss_roll=hb;var ib=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.entry=a.entry,this.faction_zhiwei_limit=new Array,makeArray(a.faction_zhiwei_limit,this.faction_zhiwei_limit),this.faction_lv_limit=a.faction_lv_limit,this.wait_time=a.wait_time,this.time=a.time,this.token_cost=a.token_cost,this.difficult=a.difficult,this.all_rewards=new Array,makeArray(a.all_rewards,this.all_rewards)}return a.get_TB_faction_bossById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_boss,b),d=new a(c);return d},a.get_TB_faction_boss=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_boss);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_faction_boss=ib;var jb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.monster_id=a.monster_id,this.rank=new Array,makeArray(a.rank,this.rank),this.reward=new Array,makeArray(a.reward,this.reward),this.fail_reward=new Array,makeArray(a.fail_reward,this.fail_reward)}return a.get_TB_faction_boss_rewardById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_boss_reward,b),d=new a(c);return d},a.get_TB_faction_boss_reward=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_boss_reward);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_faction_boss_reward=jb;var kb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.zhiwei_limit=new Array,makeArray(a.zhiwei_limit,this.zhiwei_limit),this.speedup_cost=new Array,makeArray(a.speedup_cost,this.speedup_cost),this.speedup_time=a.speedup_time,this.speedup_limit=a.speedup_limit,this.speedup_donate=a.speedup_donate}return a.get_TB_faction_building_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_building_base,b),d=new a(c);return d},a.get_TB_faction_building_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_building_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_faction_building_base=kb;var lb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.type=a.type,this.level=a.level,this.name=a.name,this.unlock=a.unlock,this.need_buildinglv=new Array,makeArray(a.need_buildinglv,this.need_buildinglv),this.cost=a.cost,this.time=a.time,this.can_lvup=a.can_lvup,this.desc=new Array,makeArray(a.desc,this.desc),this.params=new Array,makeArray(a.params,this.params),this["goto"]=a["goto"],this.icon=a.icon,this.goto_sub=new Array,makeArray(a.goto_sub,this.goto_sub),this.pos=new Array,makeArray(a.pos,this.pos)}return a.get_TB_faction_buildingById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_building,b),d=new a(c);return d},a.get_TB_faction_building=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_building);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_faction_building=lb;var mb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.point=a.point,this.reward=new Array,makeArray(a.reward,this.reward),this.ex_reward=new Array,makeArray(a.ex_reward,this.ex_reward)}return a.get_TB_faction_giftById=function(b){var c=TableData.getInstance().getData(TableData.tb_faction_gift,b),d=new a(c);return d},a.get_TB_faction_gift=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_faction_gift);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_faction_gift=mb;var nb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.quality=a.quality,this.model=a.model,this.icon=a.icon,this.avtivetype=a.avtivetype,this.passiveskill=new Array,makeArray(a.passiveskill,this.passiveskill),this.avtivedata=new Array,makeArray(a.avtivedata,this.avtivedata),this.props=new Array,makeArray(a.props,this.props)}return a.get_TB_talisman_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_talisman_base,b),d=new a(c);return d},a.get_TB_talisman_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_talisman_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_talisman_base=nb;var ob=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cost=new Array,makeArray(a.cost,this.cost),this.prosKeys=new Array,makeArray(a.prosKeys,this.prosKeys),this.prosValues=new Array,makeArray(a.prosValues,this.prosValues)}return a.get_TB_mount_raise_levelById=function(b){var c=TableData.getInstance().getData(TableData.tb_mount_raise_level,b),d=new a(c);return d},a.get_TB_mount_raise_level=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_mount_raise_level);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_mount_raise_level=ob;var pb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.talisman_id=a.talisman_id,this.level=a.level,this.attr_id=new Array,makeArray(a.attr_id,this.attr_id),this.attr_value=new Array,makeArray(a.attr_value,this.attr_value),this.item_cost=new Array,makeArray(a.item_cost,this.item_cost),this.money_cost=new Array,makeArray(a.money_cost,this.money_cost)}return a.get_TB_talisman_spiritById=function(b,c){var d=1e3*b+c,e=TableData.getInstance().getData(TableData.tb_talisman_spirit,d),f=new a(e);return f},a.get_TB_talisman_spirit=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_talisman_spirit);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a.get_TB_talisman_spiritByIdArray=function(b){var c=new Array,d=TableData.getInstance().getTableByName(TableData.tb_talisman_spirit);for(var e in d.data){var f=new a(d.data[e]);b==f.talisman_id&&c.push(f)}return c},a}();a.TB_talisman_spirit=pb;var qb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.part=a.part,this.level=a.level,this.props0=new Array,makeArray(a.props0,this.props0),this.props1=new Array,makeArray(a.props1,this.props1),this.props2=new Array,makeArray(a.props2,this.props2),this.cost=new Array,makeArray(a.cost,this.cost)}return a.prototype.refrishById=function(a){var b=Math.floor((a-1)/2);0==b&&(this.props=this.props0),1==b&&(this.props=this.props1),2==b&&(this.props=this.props2)},a.get_TB_equipdevelop_strengthById=function(b,c){var d=1e3*b+c,e=TableData.getInstance().getData(TableData.tb_equipdevelop_strength,d),f=new a(e);return f.refrishById(GuidData.player.getCharType()),f},a.get_TB_equipdevelop_strength=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_equipdevelop_strength);for(var d in c.data){var e=new a(c.data[d]);e.refrishById(GuidData.player.getCharType()),b.push(e)}return b},a}();a.TB_equipdevelop_strength=qb;var rb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.part=a.part,this.rank=a.rank,this.star=a.star,this.lvup_type=a.lvup_type,this.chance=a.chance,this.cost=new Array,makeArray(a.cost,this.cost),this.props0=new Array,makeArray(a.props0,this.props0),this.props1=new Array,makeArray(a.props1,this.props1),this.props2=new Array,
makeArray(a.props2,this.props2)}return a.prototype.refrishById=function(a){var b=Math.floor((a-1)/2);0==b&&(this.props=this.props0),1==b&&(this.props=this.props1),2==b&&(this.props=this.props2)},a.get_TB_equipdevelop_refineById=function(b,c,d){var e=1e4*b+100*c+d,f=TableData.getInstance().getData(TableData.tb_equipdevelop_refine,e),g=new a(f);return g.refrishById(GuidData.player.getCharType()),g},a.get_TB_equipdevelop_refine=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_equipdevelop_refine);for(var d in c.data){var e=new a(c.data[d]);e.refrishById(GuidData.player.getCharType()),b.push(e)}return b},a}();a.TB_equipdevelop_refine=rb;var sb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.gem_array=new Array,makeArray(a.gem_array,this.gem_array),this.unlock_strength_lv=new Array,makeArray(a.unlock_strength_lv,this.unlock_strength_lv),this.unlock_refine_lv=new Array,makeArray(a.unlock_refine_lv,this.unlock_refine_lv)}return a.get_TB_equipdevelop_gem_partById=function(b){var c=TableData.getInstance().getData(TableData.tb_equipdevelop_gem_part,b),d=new a(c);return d},a.get_TB_equipdevelop_gem_part=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_equipdevelop_gem_part);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_equipdevelop_gem_part=sb;var tb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.type=a.type,this.level=a.level,this.props=new Array,makeArray(a.props,this.props),this.cost=new Array,makeArray(a.cost,this.cost)}return a.get_TB_equipdevelop_gemById=function(b,c){var d=1e3*b+c,e=TableData.getInstance().getData(TableData.tb_equipdevelop_gem,d),f=new a(e);return f},a.get_TB_equipdevelop_gem=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_equipdevelop_gem);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_equipdevelop_gem=tb;var ub=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.part=a.part,this.rare=a.rare,this.cost=new Array,makeArray(a.cost,this.cost)}return a.get_TB_equipdevelop_washattrsById=function(b,c){var d=100*b+c,e=TableData.getInstance().getData(TableData.tb_equipdevelop_washattrs,d),f=new a(e);return f},a.get_TB_equipdevelop_washattrs=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_equipdevelop_washattrs);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_equipdevelop_washattrs=ub;var vb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.type=a.type,this.level=a.level,this.need_lv=new Array,makeArray(a.need_lv,this.need_lv),this.props0=new Array,makeArray(a.props0,this.props0),this.props1=new Array,makeArray(a.props1,this.props1),this.props2=new Array,makeArray(a.props2,this.props2)}return a.prototype.refrishById=function(a){var b=Math.floor((a-1)/2);0==b&&(this.props=this.props0),1==b&&(this.props=this.props1),2==b&&(this.props=this.props2)},a.get_TB_equipdevelop_bonusById=function(b,c){var d=100*b+c,e=TableData.getInstance().getData(TableData.tb_equipdevelop_bonus,d),f=new a(e);return f.refrishById(GuidData.player.getCharType()),f},a.get_TB_equipdevelop_bonus=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_equipdevelop_bonus);for(var d in c.data){var e=new a(c.data[d]);e.refrishById(GuidData.player.getCharType()),b.push(e)}return b},a}();a.TB_equipdevelop_bonus=vb;var wb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.unlocklev=a.unlocklev}return a.get_TB_equipdevelop_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_equipdevelop_base,b),d=new a(c);return d},a.get_TB_equipdevelop_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_equipdevelop_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_equipdevelop_base=wb;var xb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.rate0=a.rate0,this.rate1=a.rate1,this.rate2=a.rate2}return a.prototype.refrishById=function(a){var b=Math.floor((a-1)/2);0==b&&(this.rate=this.rate0),1==b&&(this.rate=this.rate1),2==b&&(this.rate=this.rate2)},a.get_TB_battle_forceById=function(b){var c=TableData.getInstance().getData(TableData.tb_battle_force,b),d=new a(c);return d.refrishById(GuidData.player.getCharType()),d},a.get_TB_battle_force=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_battle_force);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_battle_force=xb;var yb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.range=new Array,makeArray(a.range,this.range),this.costs=new Array,makeArray(a.costs,this.costs)}return a.get_TB_rename_infoById=function(b){var c=TableData.getInstance().getData(TableData.tb_rename_info,b),d=new a(c);return d},a.get_TB_rename_info=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_rename_info);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_rename_info=yb;var zb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cost=new Array,makeArray(a.cost,this.cost)}return a.get_TB_enemy_revenge_buyById=function(b){var c=TableData.getInstance().getData(TableData.tb_enemy_revenge_buy,b),d=new a(c);return d},a.get_TB_enemy_revenge_buy=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_enemy_revenge_buy);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_enemy_revenge_buy=zb;var Ab=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.daily_revenge_times=a.daily_revenge_times}return a.get_TB_enemy_revenge_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_enemy_revenge_base,b),d=new a(c);return d},a}();a.TB_enemy_revenge_base=Ab;var Bb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.lev_info=a.lev_info,this.recharge_info=a.recharge_info,this.expense_info=a.expense_info}return a.get_TB_welfare_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_base,b),d=new a(c);return d},a}();a.TB_welfare_base=Bb;var Cb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.money=a.money,this.item=new Array,makeArray(a.item,this.item)}return a.get_TB_welfare_consumeById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_consume,b),d=new a(c);return d},a.get_TB_welfare_consume=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_consume);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_consume=Cb;var Db=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.money=a.money,this.item=new Array,makeArray(a.item,this.item)}return a.get_TB_welfare_rechargeById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_recharge,b),d=new a(c);return d},a.get_TB_welfare_recharge=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_recharge);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_recharge=Db;var Eb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.item=new Array,makeArray(a.item,this.item),this.show=a.show}return a.get_TB_welfare_sevengiftById=function(b){var c=TableData.getInstance().getData(TableData.tb_welfare_sevengift,b),d=new a(c);return d},a.get_TB_welfare_sevengift=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_welfare_sevengift);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_welfare_sevengift=Eb;var Fb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.cost=new Array,makeArray(a.cost,this.cost),this.rate=a.rate}return a.get_TB_moneytree_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_moneytree_base,b),d=new a(c);return d},a.get_TB_moneytree_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_moneytree_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_moneytree_base=Fb;var Gb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.reward=new Array,makeArray(a.reward,this.reward)}return a.get_TB_moneytree_lvById=function(b){var c=TableData.getInstance().getData(TableData.tb_moneytree_lv,b),d=new a(c);return d},a.get_TB_moneytree_lv=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_moneytree_lv);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_moneytree_lv=Gb;var Hb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.rewards=new Array,makeArray(a.rewards,this.rewards),this.count=a.count}return a.get_TB_moneytree_giftById=function(b){var c=TableData.getInstance().getData(TableData.tb_moneytree_gift,b),d=new a(c);return d},a.get_TB_moneytree_gift=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_moneytree_gift);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_moneytree_gift=Hb;var Ib=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.unlocks=new Array,makeArray(a.unlocks,this.unlocks)}return a.get_TB_char_skillById=function(b){var c=TableData.getInstance().getData(TableData.tb_char_skill,b),d=new a(c);return d},a.get_TB_char_skill=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_char_skill);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_char_skill=Ib;var Jb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.value=a.value}return a.get_Tb_buff_effectById=function(b){var c=TableData.getInstance().getData(TableData.tb_buff_effect,b),d=new a(c);return d},a.get_Tb_buff_effect=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_buff_effect);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.Tb_buff_effect=Jb;var Kb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.mapId=a.mapId,this.bossEntry=a.bossEntry,this.rebornTime=a.rebornTime,this.maxTimes=a.maxTimes,this.permitLevel=a.permitLevel,this.force=a.force,this.show_0=new Array,makeArray(a.show_0,this.show_0),this.show_1=new Array,makeArray(a.show_1,this.show_1),this.show_2=new Array,makeArray(a.show_2,this.show_2)}return a.prototype.refrishById=function(a){var b=Math.floor((a-1)/2);0==b&&(this.show=this.show_0),1==b&&(this.show=this.show_1),2==b&&(this.show=this.show_2)},a.get_Tb_private_boss_infoById=function(b){var c=TableData.getInstance().getData(TableData.tb_private_boss_info,b),d=new a(c);return d.refrishById(GuidData.player.getCharType()),d},a.get_Tb_private_boss_info=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_private_boss_info);for(var d in c.data){var e=new a(c.data[d]);e.refrishById(GuidData.player.getCharType()),b.push(e)}return b},a}();a.Tb_private_boss_info=Kb;var Lb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.force_range_left=a.force_range_left,this.force_range_right=a.force_range_right,this.buffeffect_id=a.buffeffect_id}return a.get_Tb_private_boss_buffById=function(b){var c=TableData.getInstance().getData(TableData.tb_private_boss_buff,b),d=new a(c);return d},a.get_Tb_private_boss_buff=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_private_boss_buff);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.Tb_private_boss_buff=Lb;var Mb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.name=a.name,this.tip=a.tip,this.link=new Array,makeArray(a.link,this.link)}return a.get_TB_red_pointById=function(b){var c=TableData.getInstance().getData(TableData.tb_red_point,b),d=new a(c);return d},a}();a.TB_red_point=Mb;var Nb=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.type=a.type,this.quest_id=a.quest_id,this.map_id=a.map_id,this.upres=new Array,makeArray(a.upres,this.upres)}return a.get_TB_quest_adventure_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_quest_adventure_base,b),d=new a(c);return d},a.get_TB_quest_adventure_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_quest_adventure_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_quest_adventure_base=Nb;var Ob=function(){function a(a){a||traceNoTabelData(),this.id=a.id,this.line=a.line,this.order=a.order,this.prev_limit=new Array,makeArray(a.prev_limit,this.prev_limit),this.cost=new Array,makeArray(a.cost,this.cost),this["goto"]=new Array,makeArray(a["goto"],this["goto"])}return a.get_TB_adventure_skill_baseById=function(b){var c=TableData.getInstance().getData(TableData.tb_adventure_skill_base,b),d=new a(c);return d},a.get_TB_quest_adventure_base=function(){var b=new Array,c=TableData.getInstance().getTableByName(TableData.tb_adventure_skill_base);for(var d in c.data){var e=new a(c.data[d]);b.push(e)}return b},a}();a.TB_adventure_skill_base=Ob}(tb||(tb={}));var ResTabelVo=function(){function a(){this.size=0,this.maxId=0}return a.prototype.parseTable=function(a,b,c,d){this.name=a,this.field=c.split(","),this.typs=b.split(",");var e=d.split(String.fromCharCode(1)),f=this.field.length,g=e.length/f,h=0;this.data=new Object;for(var i=0,j=0;g>j;j++){for(var k=new Object,l=0;f>l;l++){var m=e[h];switch(this.typs[l]){case"int":k[this.field[l]]=Number(m);break;case"string":k[this.field[l]]=m;break;case"array":try{k[this.field[l]]=JSON.parse(m)}catch(n){throw console.log(a,j,this.field[l],m),new Error("数据表有错")}break;default:k[this.field[l]]=m}h++}this.data[k.id]=k,k.id>i&&(i=k.id)}this.size=g,this.maxId=i},a.prototype.getDataByID=function(a){return this.data[a]},a}(),TableData=function(){function a(){this.tb=new Object}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.loadGameData=function(a,b){var c=this;void 0===a&&(a=null),void 0===b&&(b=null);var d=Scene_data.fileRoot+"data/scene.txt",e=Scene_data.fileRoot+"data/tb.txt",f=!1,g=!1,h=function(){f&&g&&a()};LoadManager.getInstance().load(d,LoadManager.XML_TYPE,function(a){SceneRes.sceneConfigData=JSON.parse(a),f=!0,h()}),LoadManager.getInstance().load(e,LoadManager.XML_TYPE,function(a){c.parseLineByStr(a),g=!0,h()},null,b)},a.prototype.loadZipGameData=function(a,b){var c=this;void 0===a&&(a=null),void 0===b&&(b=null);var d=Scene_data.fileRoot+"data/tb.zip.txt?v="+GameStart.appVersion;LoadManager.getInstance().load(d,LoadManager.BYTE_TYPE,function(b){var d=new ByteArray(b),e=d.readInt(),f=b.slice(4,4+e);d.position+=e;var g=d.readInt(),h=d.readUTFBytes(g);SceneRes.sceneConfigData=JSON.parse(h),f=unZip(f),d=new ByteArray(f),h=d.readUTFBytes(d.length),c.parseLineByStr(h),a()},null,b)},a.prototype.loadTbDataByName=function(a,b){var c=this;void 0===b&&(b=null);var d=Scene_data.fileRoot+"data/"+a+".txt";LoadManager.getInstance().load(d,LoadManager.XML_TYPE,function(a){c.parseLineByStr(a),b&&b()})},a.prototype.loadTbItemByArr=function(a,b){var c=this;if(a.length>0){var d=Scene_data.fileRoot+"data/"+a.pop()+".txt";LoadManager.getInstance().load(d,LoadManager.XML_TYPE,function(d){c.parseLineByStr(d),c.loadTbItemByArr(a,b)})}else b()},a.prototype.parseLineByStr=function(a){for(var b=a.split(String.fromCharCode(13)),c=b.length/4,d=0;c>d;++d){var e=b[4*d+0],f=b[4*d+1],g=b[4*d+2],h=b[4*d+3],i=new ResTabelVo;i.parseTable(e,g,f,h),this.tb[e]=i}this.processExtData()},a.prototype.getData=function(a,b){return this.tb[a]?this.tb[a].getDataByID(b):null},a.prototype.getTabSize=function(a){return this.tb[a]?this.tb[a].size:0},a.prototype.getTabMaxID=function(a){return this.tb[a]?this.tb[a].maxId:0},a.prototype.getTableByName=function(a){return this.tb[a]?this.tb[a]:null},a.prototype.processExtData=function(){var b=this.tb[a.tb_risk_data].data;for(var c in b){var d=b[c];b[d.nextId]&&(b[d.nextId].parentid=d.id)}},a.tb_creature_template="tb_creature_template",a.tb_item_slot="tb_item_slot",a.tb_skill_base="tb_skill_base",a.tb_skill_uplevel="tb_skill_uplevel",a.tb_gameobject_template="tb_gameobject_template",a.tb_skill_show="tb_skill_show",a.tb_char_skill="tb_char_skill",a.tb_anger_limit="tb_anger_limit",a.tb_learn_spell="tb_learn_spell",a.tb_assistangerspell_upgrade="tb_assistangerspell_upgrade",a.tb_mount_illusion="tb_mount_illusion",a.tb_mount_base="tb_mount_base",a.tb_mount_upgrade="tb_mount_upgrade",a.tb_mount_train="tb_mount_train",a.tb_item_template="tb_item_template",a.tb_strengthen_bless="tb_strengthen_bless",a.tb_strengthen_base="tb_strengthen_base",a.tb_strengthen_mul="tb_strengthen_mul",a.tb_gem_pos="tb_gem_pos",a.tb_gem_cost="tb_gem_cost",a.tb_gem_icon="tb_gem_icon",a.tb_gem_base="tb_gem_base",a.tb_gem_mul="tb_gem_mul",a.tb_divine_base="tb_divine_base",a.tb_divine_streng="tb_divine_streng",a.tb_divine_clinet="tb_divine_clinet",a.tb_divine_bless="tb_divine_bless",a.tb_map_vip="tb_map_vip",a.tb_map="tb_map",a.tb_map_field_boss_time="tb_map_field_boss_time",a.tb_instance_trial="tb_instance_trial",a.tb_quest_vip_instance="tb_quest_vip_instance",a.tb_hook_quality="tb_hook_quality",a.tb_hook_hp_item="tb_hook_hp_item",a.tb_store="tb_store",a.tb_shop="tb_shop",a.tb_shop_item_relate_id="tb_shop_item_relate_id",a.tb_shop_base="tb_shop_base",a.tb_social_familiay="tb_social_familiay",a.tb_social_shop="tb_social_shop",a.tb_msg_text_type="tb_msg_text_type",a.tb_map_field_boss="tb_map_field_boss",a.tb_world_map="tb_world_map",a.tb_faction_icon="tb_faction_icon",a.tb_faction_creat="tb_faction_creat",a.tb_faction_base="tb_faction_base",a.tb_faction_zhiwei="tb_faction_zhiwei",a.tb_faction_donation="tb_faction_donation",a.tb_faction_shop="tb_faction_shop",a.tb_map_object="tb_map_object",a.tb_map_navigation="tb_map_navigation",a.tb_worldboss_base="tb_worldboss_base",a.tb_worldboss_rank_reward="tb_worldboss_rank_reward",a.tb_worldboss_time="tb_worldboss_time",a.tb_instance_res="tb_instance_res",a.tb_vip_base="tb_vip_base",a.tb_rank_reward="tb_rank_reward",a.tb_msg="tb_msg",a.tb_social_num="tb_social_num",a.tb_activity_base="tb_activity_base",a.tb_activity_reward="tb_activity_reward",a.tb_quest="tb_quest",a.tb_achieve_base="tb_achieve_base",a.tb_achieve_progress="tb_achieve_progress",a.tb_activity_time="tb_activity_time",a.tb_activity_lottery_base="tb_activity_lottery_base",a.tb_activity_lottery_high="tb_activity_lottery_high",a.tb_activity_lottery_middle="tb_activity_lottery_middle",a.tb_activity_lottery_low="tb_activity_lottery_low",a.tb_activity_rank_base="tb_activity_rank_base",a.tb_activity_rank_process_reward="tb_activity_rank_process_reward",a.tb_activity_rank_rank_reward="tb_activity_rank_rank_reward",a.tb_activity_limit_gift_base="tb_activity_limit_gift_base",a.tb_activity_daily_gift_base="tb_activity_daily_gift_base",a.tb_activity_limit_gift="tb_activity_limit_gift",a.tb_activity_daily_gift="tb_activity_daily_gift",a.tb_title_base="tb_title_base",a.tb_shop_chongzhi="tb_shop_chongzhi",a.tb_creature_dialogue="tb_creature_dialogue",a.tb_quest_chapter="tb_quest_chapter",a.tb_welfare_shouchong="tb_welfare_shouchong",a.tb_welfare_checkin="tb_welfare_checkin",a.tb_welfare_checkin_all="tb_welfare_checkin_all",a.tb_welfare_level="tb_welfare_level",a.tb_welfare_back="tb_welfare_back",a.tb_welfare_level_show="tb_welfare_level_show",a.tb_kuafu3v3_base="tb_kuafu3v3_base",a.tb_kuafu3v3_month_reward="tb_kuafu3v3_month_reward",a.tb_kuafu3v3_day_reward="tb_kuafu3v3_day_reward",a.tb_kuafu3v3_week_reward="tb_kuafu3v3_week_reward",a.tb_kuafu_xianfu_base="tb_kuafu_xianfu_base",a.tb_kuafu_xianfu_condition="tb_kuafu_xianfu_condition",a.tb_doujiantai_first="tb_doujiantai_first",a.tb_doujiantai_day="tb_doujiantai_day",a.tb_doujiantai_combat_win="tb_doujiantai_combat_win",a.tb_doujiantai_base="tb_doujiantai_base",a.tb_map_jump_point_detail="tb_map_jump_point_detail",a.tb_quest_daily_base="tb_quest_daily_base",a.tb_quest_daily2_base="tb_quest_daily2_base",a.tb_quest_daily2="tb_quest_daily2",a.tb_quest_daily2_set="tb_quest_daily2_set",a.tb_system_preview="tb_system_preview",a.tb_quest_daily2_finish_reward="tb_quest_daily2_finish_reward",a.tb_system_base="tb_system_base",a.tb_item_quality_color="tb_item_quality_color",a.tb_system_icon="tb_system_icon",a.tb_bianqiang_sub="tb_bianqiang_sub",a.tb_bianqiang_value="tb_bianqiang_value",a.tb_bianqiang_rank="tb_bianqiang_rank",a.tb_system_guide="tb_system_guide",a.tb_xiulianchang_base="tb_xiulianchang_base",a.tb_xiulianchang_vip="tb_xiulianchang_vip",a.tb_xiulianchang_reward="tb_xiulianchang_reward",a.tb_char_level="tb_char_level",a.tb_item_illusion="tb_item_illusion",a.tb_login_activity_preview="tb_login_activity_preview",a.tb_login_activity_reward="tb_login_activity_reward",a.tb_worldboss_roll="tb_worldboss_roll",a.tb_faction_boss="tb_faction_boss",a.tb_faction_boss_reward="tb_faction_boss_reward",a.tb_faction_gift_rank_reward="tb_faction_gift_rank_reward",a.tb_risk_data="tb_risk_data",a.tb_risk_base="tb_risk_base",a.tb_risk_chapter="tb_risk_chapter",a.tb_risk_menu="tb_risk_menu",a.tb_faction_building_base="tb_faction_building_base",a.tb_faction_building="tb_faction_building",a.tb_faction_gift="tb_faction_gift",a.tb_faction_privilege="tb_faction_privilege",a.tb_talisman_base="tb_talisman_base",a.tb_talisman_spirit="tb_talisman_spirit",a.tb_mass_boss_info="tb_mass_boss_info",a.tb_mass_boss_base="tb_mass_boss_base",a.tb_mass_boss_times="tb_mass_boss_times",a.tb_wings_bless="tb_wings_bless",a.tb_wings_base="tb_wings_base",a.tb_wings_strength="tb_wings_strength",a.tb_group_instance_base="tb_group_instance_base",a.tb_group_instance_buy="tb_group_instance_buy",a.tb_meridian_info="tb_meridian_info",a.tb_meridian_source="tb_meridian_source",a.tb_mount_raise_level="tb_mount_raise_level",a.tb_meridian_item="tb_meridian_item",a.tb_faction_bossdefense_pool="tb_faction_bossdefense_pool",a.tb_faction_bossdefense_point="tb_faction_bossdefense_point",a.tb_faction_bossdefense_base="tb_faction_bossdefense_base",a.tb_faction_tower_base="tb_faction_tower_base",a.tb_faction_tower_floor="tb_faction_tower_floor",a.tb_single_pvp_base="tb_single_pvp_base",a.tb_single_pvp_extra="tb_single_pvp_extra",a.tb_single_pvp_grade="tb_single_pvp_grade",a.tb_single_pvp_times="tb_single_pvp_times",a.tb_buff_effect="tb_buff_effect",a.tb_equipdevelop_strength="tb_equipdevelop_strength",a.tb_equipdevelop_refine="tb_equipdevelop_refine",a.tb_equipdevelop_gem_part="tb_equipdevelop_gem_part",a.tb_equipdevelop_gem="tb_equipdevelop_gem",a.tb_equipdevelop_washattrs="tb_equipdevelop_washattrs",a.tb_equipdevelop_bonus="tb_equipdevelop_bonus",a.tb_faction_skill_base="tb_faction_skill_base",a.tb_faction_skill_building="tb_faction_skill_building",a.tb_faction_skill_lvup="tb_faction_skill_lvup",a.tb_appearance_info="tb_appearance_info",a.tb_appearance_pokedex="tb_appearance_pokedex",a.tb_char_info="tb_char_info",a.tb_battle_force="tb_battle_force",a.tb_equipdevelop_base="tb_equipdevelop_base",a.tb_rename_info="tb_rename_info",a.tb_enemy_revenge_base="tb_enemy_revenge_base",a.tb_enemy_revenge_buy="tb_enemy_revenge_buy",a.tb_red_point="tb_red_point",a.tb_welfare_base="tb_welfare_base",a.tb_welfare_consume="tb_welfare_consume",a.tb_welfare_recharge="tb_welfare_recharge",a.tb_welfare_sevengift="tb_welfare_sevengift",a.tb_moneytree_base="tb_moneytree_base",a.tb_moneytree_lv="tb_moneytree_lv",a.tb_moneytree_gift="tb_moneytree_gift",a.tb_creature_worldrisk="tb_creature_worldrisk",a.tb_private_boss_info="tb_private_boss_info",a.tb_private_boss_buff="tb_private_boss_buff",a.tb_restore_potion_base="tb_restore_potion_base",a.tb_item_output="tb_item_output",a.tb_quest_adventure_base="tb_quest_adventure_base",a.tb_adventure_skill_base="tb_adventure_skill_base",a.tb_equip_suit_base="tb_equip_suit_base",a.tb_equip_suit_effect="tb_equip_suit_effect",a.tb_achieve_page="tb_achieve_page",a.tb_realmbreak_dailyquest_base="tb_realmbreak_dailyquest_base",a.tb_realmbreak_base="tb_realmbreak_base",a}(),GameControlManager=function(){function a(){var a=this;this._lastMousePos=new Vector3D,this._lastFocus=new Vector3D,this._isMouseDown=!1,this._lock=!1,document.addEventListener(MouseType.KeyDown,function(b){a.onKeyDown(b)})}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.init=function(){},a.prototype.onMouseMove=function(a){this._isMouseDown&&(Scene_data.focus3D.rotationY=this._lastFocus.y-(a.x-this._lastMousePos.x)/10)},a.prototype.onMouseDown=function(a){this._lastMousePos.x=a.x,this._lastFocus.y=Scene_data.focus3D.rotationY,this._isMouseDown=!0},a.prototype.onMouseUp=function(a){this._isMouseDown=!1},a.oneByone=function(){var a=this;if(this.waitGmItem.length){var b=this.waitGmItem[0];console.log("gm",SharedDef.CHAT_TYPE_WORLD,b),NetManager.getInstance().protocolos.chat_by_channel(SharedDef.CHAT_TYPE_WORLD,b),TimeUtil.addTimeOut(1500,function(){a.waitGmItem.shift(),a.oneByone()})}},a.sendGmCom=function(a){this.waitGmItem.push(a),this.waitGmItem.length<=1&&this.oneByone()},a.prototype.onKeyDown=function(b){if(!b.shiftKey){if(b.keyCode==KeyboardType.G&&a.sendGmCom("@完成当前主线"),b.keyCode==KeyboardType.T&&ModulePageManager.openNpcPanel(SharedDef.MODULE_ARENA,[4,1],1),b.keyCode==KeyboardType.Z&&this.showEffectsMove(),b.keyCode==KeyboardType.R&&this.upPopTxt(),b.keyCode==KeyboardType.U){var c=new linklist.LinkListPanel;c.load(function(){UIManager.getInstance().addUIContainer(c)},!1)}return b.keyCode==KeyboardType.Up&&Scene_data.cam3D.distance--,b.keyCode==KeyboardType.Down&&Scene_data.cam3D.distance++,b.keyCode==KeyboardType.Left&&(Engine.sceneCamScale+=.03,Engine.resetViewMatrx3D()),b.keyCode==KeyboardType.Right&&(Engine.sceneCamScale-=.03,Engine.resetViewMatrx3D()),void console.log("距离",Scene_data.cam3D.distance,"张口",Engine.sceneCamScale)}if(b.keyCode==KeyboardType.Up)msgtip.GuideModel.getInstance().hideGuidePop();else if(b.keyCode==KeyboardType.B){var d=new charbg.CharBgEvent(charbg.CharBgEvent.SHOW_CHAR_BG_PANEL);d.showType=2,ModuleEventManager.dispatchEvent(d)}else if(b.keyCode==KeyboardType.R)a.sendGmCom("@Script");else if(b.keyCode==KeyboardType.Q);else if(b.keyCode==KeyboardType.X)ModuleEventManager.dispatchEvent(new selectserver.SelectServerEvent(selectserver.SelectServerEvent.HIDE_JOINGAME_EVENT));else if(b.keyCode==KeyboardType.Z)ModuleEventManager.dispatchEvent(new selectserver.SelectServerEvent(selectserver.SelectServerEvent.SHOW_JOINGAME_EVENT));else if(b.keyCode==KeyboardType.E)ModuleEventManager.dispatchEvent(new SceneLoadEvent(SceneLoadEvent.SCENE_TRANSITION_EVENT));else if(b.keyCode==KeyboardType.F1){var e=document.getElementById("FpsTipsCanvas");0==e.style["z-index"]?e.style["z-index"]=2:e.style["z-index"]=0}if(b.keyCode==KeyboardType.P)for(var f=(GameInstance.roleList,0);f<GameInstance.roleList.length;f++)console.log(GameInstance.roleList[f].unit.getName(),GameInstance.roleList[f].unit.getGuid(),GameInstance.roleList[f].isDeath)},a.prototype.showTopCenterPic=function(){var a=new msgtip.MsgPicData;a.type=1,a.info=random(99),Math.random()>.5&&(a.type=2,a.info="ui/load/toptip/success.png");var b=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_MSG_PIC_DATA);b.data=a,ModuleEventManager.dispatchEvent(b)},a.prototype.showEffectsMove=function(){var a=new msgtip.MsgEffectsMoveData,b=new Vector2D(UIData.designWidth/2,UIData.designHeight/2);a.startTM=TimeUtil.getTimer()+random(200),a.endTM=a.startTM+500,a.pos=b,a.MONEY_TYPE=1,a.bezierPos=new Vector2D(b.x+400*Math.random()-200,b.y+400*Math.random()-200),a.toPos=new Vector2D(150,178);var c=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_EFFECTS_DATA);c.data=a,ModuleEventManager.dispatchEvent(c)},a.prototype.upPopTxt=function(){var a=new s2c_send_chat;a.content="[ffffff]玩家名字[00ff00]获得[ffffff][ffffff]玩家名字[00ff00]获得[ffffff]玩家名字[00ff00][ffffff]玩家名字[00ff00]获得[ffffff]bbcc[00ff00]",a.channel=SharedDef.CHAT_TYPE_HORM;var b=new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_SYSTIME_HORM_INFO);b.data=a,ModuleEventManager.dispatchEvent(b)},a.prototype.backFun=function(a){console.log(a)},a.prototype.makeTBvo=function(){var a="id, name, info, output_info, zhuangbility, icon, avatar, level, rank, bind_type, type, type_c, type_name, pos, quality, sex, price, is_transaction, max_overlap, is_slather, output, use_result, isdoubleclick, double_click, basic_properties, suit_id, using_effect, category, category_cooldown, cooldown, goods_id, arrange, expend_data, use_object, quest, forge_pro_max, is_auction, auction_money",b="int, string, string, string, string, string, int, int, int, int, int, int, string, int, int, int, int, int, int, int, array, int, int, array, array, array, array, int, int, int, int, int, int, int, int, array, int, int",c=a.split(","),d=b.split(",");console.log("-------##############--------");for(var e=0;e<c.length;e++){c[e]=c[e].replace(" ",""),d[e]=d[e].replace(" ","");var f=d[e].replace(" ",""),g="";switch(f){case"int":g="number;";break;case"string":g="string;";break;case"array":g="Array<any>;"}console.log("public "+c[e]+":"+g)}console.log("-----------------");for(var e=0;e<c.length;e++){var f=d[e].replace(" ","");switch(f){case"array":console.log("this."+c[e]+"=new Array;"),console.log("makeArray($obj."+c[e]+",this."+c[e]+");");break;default:console.log("this."+c[e]+"=$obj."+c[e]+";")}}console.log("--#########################----")},a.prototype.test=function(){console.log("回城回城"),NetManager.getInstance().protocolos.teleport_main_city();var a=!0,b=!0,c=!0,d=!0,e=tb.TB_hook_hp_item_Vo.get_TB_hook_hp_item_Vo(2).items[0],f=GameInstance.mainChar.unit;f.getHp()/f.getMaxHp();b||(c=!1,d=!1),console.log(GuidData.player.getHangupdata());GuidData.bag.getItemByEntry(e);if(a){var g=this.useItem(e);if(g)console.log("从背包中得到复活丹");else{var h=tb.TB_shop.get_TB_shopById(e);if(c||d){var i=h.costResource[0][1];h&&GuidData.player.getBindGold()>=i?console.log("使用绑定元宝"):d&&(h&&GuidData.player.getGoldIngot()>=i?console.log("使用非绑元宝"):console.log("无钱购买"))}}}},a.prototype.useItem=function(a){if(GuidData.bag.hasItem(a,1)){var b=GuidData.bag.getItemByEntry(a);return NetManager.getInstance().protocolos.bag_item_user(b.guid,1),console.log("吃药了"),!0}return!1},a.waitGmItem=new Array,a}(),FocusRect=function(){function a(a,b,c,d,e,f,g,h){this.centX=a,this.centZ=b,this.minx=c,this.minz=d,this.maxx=e,this.maxz=f,this.mindis=g,this.maxdis=h}return a}(),KeyControlManager=function(){function a(){this.focusRect=new FocusRect(0,0,-200,-200,200,200,500,1500),this.lastFopcus3DPos=new Vector3D,this.lastMouseHit=new Vector3D,this.lastRotationY=0,this._lastMousePos=new Vector3D,this._lastFocus=new Vector3D,this._isMouseDown=!1,this._lock=!1}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.init=function(){var a=this;Scene_data.uiBlankStage.addEventListener(InteractiveEvent.Down,this.onMouseDown,this),Scene_data.uiBlankStage.addEventListener(InteractiveEvent.Up,this.onMouseUp,this),Scene_data.uiBlankStage.addEventListener(InteractiveEvent.Move,this.onMouseMove,this),Scene_data.uiBlankStage.addEventListener(InteractiveEvent.PinchStart,this.onMousePinchStart,this),Scene_data.uiBlankStage.addEventListener(InteractiveEvent.Pinch,this.onMouseSwipe,this),document.addEventListener(MouseType.MouseWheel,function(b){a.onMouseWheel(b)})},a.prototype.onMousePinchStart=function(a){this.lastCamDis=Scene_data.cam3D.distance},a.prototype.onMouseSwipe=function(a){Math.max(.2,Math.min(a.data,2));Scene_data.cam3D.distance=this.lastCamDis*(2-a.data),this.upData()},a.prototype.onMouseWheel=function(a){Scene_data.cam3D.distance+=a.wheelDelta/10},a.prototype.onMouseMove=function(a){if(this._isMouseDown){var b=Groundposition.getGroundPos(a.x,a.y);Scene_data.focus3D.x=this.lastFopcus3DPos.x-(b.x-this.lastMouseHit.x),Scene_data.focus3D.z=this.lastFopcus3DPos.z-(b.z-this.lastMouseHit.z)}this.upData()},a.prototype.upData=function(){this.focusRect&&(Scene_data.focus3D.x<this.focusRect.minx+this.focusRect.centX&&(Scene_data.focus3D.x=this.focusRect.minx+this.focusRect.centX),Scene_data.focus3D.x>this.focusRect.maxx+this.focusRect.centX&&(Scene_data.focus3D.x=this.focusRect.maxx+this.focusRect.centX),
Scene_data.focus3D.z<this.focusRect.minz+this.focusRect.centZ&&(Scene_data.focus3D.z=this.focusRect.minz+this.focusRect.centZ),Scene_data.focus3D.z>this.focusRect.maxz+this.focusRect.centZ&&(Scene_data.focus3D.z=this.focusRect.maxz+this.focusRect.centZ)),Scene_data.cam3D.distance=Math.max(Scene_data.cam3D.distance,this.focusRect.mindis),Scene_data.cam3D.distance=Math.min(Scene_data.cam3D.distance,this.focusRect.maxdis)},a.prototype.addCentZ=function(a){Scene_data.focus3D.z+=a,this.focusRect.centZ+=a,this.upData()},a.prototype.onMouseDown=function(a){this._lastMousePos.x=a.x,this.lastRotationY=Scene_data.focus3D.rotationY,this._isMouseDown=!0,this.lastFopcus3DPos.x=Scene_data.focus3D.x,this.lastFopcus3DPos.y=Scene_data.focus3D.y,this.lastFopcus3DPos.z=Scene_data.focus3D.z,this.lastMouseHit=Groundposition.getGroundPos(a.x,a.y)},a.prototype.onMouseUp=function(a){this._isMouseDown=!1},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GuidObjManager=function(a){function b(){var b=a.call(this)||this;return b._hashGUID=function(a){return ObjectDef.UNIT==ObjectDef.getPrefix(a)?ObjectDef.getGUIDIndex(a):ObjectDef.LOOT==ObjectDef.getPrefix(a)?ObjectDef.getGUIDIndex(a):0},b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.CreateObject=function(a){var b=this._objs[a];if(!b){var c=ObjectDef.getPrefix(a);c==ObjectDef.STRENGTH?b=new StrengGuidObject(a):c==ObjectDef.MAP?(b=new MapInfo(a),GuidData.map=b):c==ObjectDef.UNIT?b=new Unit(a):c==ObjectDef.LOOT?b=new Loot(a):c==ObjectDef.PLAYER?(b=new PlayerGuidObject(a),GuidData.player=b):c==ObjectDef.BAG?(b=new BagData(a),GuidData.bag=b):c==ObjectDef.FACTION?(b=new FactionData(a),GuidData.faction=b):c==ObjectDef.GROW?(b=new GrowData(a),GuidData.grow=b):c==ObjectDef.INSTANCE?(b=new InstanceData(a),GuidData.instanceData=b):c==ObjectDef.SOCIAL?(b=new SocialData(a),GuidData.social=b):c==ObjectDef.EMAIL?(b=new GiftPacksData(a),GuidData.giftPacks=b):c==ObjectDef.QUEST?(b=new QuestData(a),GuidData.quest=b):c==ObjectDef.GLOBEL&&a==ObjectDef.GLOBAL_VALUE?(b=new GlobelValueData(a),GuidData.globelValue=b):b=new GuidObject(a),b.guid=a}return this.AttachObject(b),b},b.prototype.getGuidObject=function(a){for(var b in this._objs)if(b.charAt(0)==a)return this._objs[b];return null},b.prototype.getUnitByID=function(a){var b=this._u_2_guid[a];if(b){var c=this._objs[b];return c}return null},b.prototype.applyJumpShow=function(a,b,c){var d=this._u_2_guid[a];if(d){var e=this._objs[d];e.setJumpShow(b,c)}},b.prototype.msgSpellStop=function(a){var b=this._objs[a];b&&b.msgSpellStop()},b.prototype.applyGridJump=function(a){for(var b=a.readShort(),c=0;b>c;c++){var d=a.readUnsignedInt(),e=a.readUnsignedShort(),f=a.readUnsignedShort(),g=this._u_2_guid[d];if(g){var h=this._objs[g];if(h.setJump(new Vector2D(e,f)),h.isMain){var i=new mainUi.MainUiEvent(mainUi.MainUiEvent.PLAYER_SKILL_CD_REFRESH);i.data=1,ModuleEventManager.dispatchEvent(i)}}}},b.prototype.applyGridMove=function(a){for(var b=a.readShort(),c=0;b>c;c++){var d=a.readUnsignedInt(),e=(a.readByte(),new Array),f=a.readUnsignedShort(),g=a.readUnsignedShort();e.push(new Vector2D(f,g));for(var h=a.readUnsignedShort(),i=0;h>i;i+=2){f+=a.readByte(),g+=a.readByte();var j=new Vector2D(f,g);e.push(j)}var k=this._u_2_guid[d];if(k){var l=this._objs[k];l.setPath(e)}}},b.prototype.applyGridStop=function(a){var b=a.readUnsignedInt(),c=a.readUnsignedShort(),d=a.readUnsignedShort(),e=this._u_2_guid[b];if(e){var f=this._objs[e];f.stop(c,d)}},b}(GuidObjectTable),GuidData=function(){function a(){}return a}(),RelationManager=function(){function a(){this.attackItem=new Array,this.jumpItem=new Array}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.refresh=function(){this.attackItem.length=0,this.jumpItem.length=0,this.refreshBaseAttackList(),GameInstance.attackTarget&&-1==this.attackItem.indexOf(GameInstance.attackTarget)&&(GameInstance.attackTarget=null)},a.prototype.findNearAttackMonsterTaget=function(){for(var a,b,c=0;c<this.attackItem.length;c++){var d=this.attackItem[c];if(!d.isDeath&&d.onStage&&d.unit.isMonster()&&!d.unit.isSkillNpc()){var e=GameInstance.mainChar.math_distance(d);(isNaN(a)||a>e)&&(a=e,b=d)}}return b},a.prototype.findNearAttackPlayerTaget=function(){for(var a,b,c=0;c<this.attackItem.length;c++){var d=this.attackItem[c];if(!d.isDeath&&d.onStage&&d.unit.isPlayer()&&!d.unit.isSkillNpc()){var e=GameInstance.mainChar.math_distance(d);(isNaN(a)||a>e)&&(a=e,b=d)}}return b},a.prototype.findNearCanAttackScene=function(){if(GameInstance.attackTarget&&GameInstance.attackTarget.onStage&&!GameInstance.attackTarget.isDeath)return GameInstance.attackTarget;var a=this.findNearAttackMonsterTaget();return a||(a=this.findNearAttackPlayerTaget()),a},a.prototype.isBuffRoadFind=function(){if(GameInstance.mainChar.unit.isBuffRoad())for(var a=GameInstance.mainChar.unit.buffUnit.getBuffGiverByBuffId(SharedDef.BUFF_ROAR),b=0;b<GameInstance.roleList.length;b++)if(console.log(GameInstance.roleList[b].unit.guid),GameInstance.roleList[b].unit.uintGuid==a)return GameInstance.attackTarget==GameInstance.roleList[b],console.log("锁定攻击对象",a),!0;return!1},a.prototype.findNearAttackBySkill=function(){if(!this.isBuffRoadFind()){if(GameInstance.attackTarget&&GameInstance.attackTarget.onStage&&!GameInstance.attackTarget.isDeath)return GameInstance.attackTarget;var a=this.findNearAttackMonsterTaget(),b=this.findNearAttackPlayerTaget();return a&&b?GameInstance.mainChar.math_distance(a)<GameInstance.mainChar.math_distance(b)?a:b:a?a:b?b:null}},a.prototype.refreshBaseAttackList=function(){if(GameInstance.mainChar){for(var a=GameInstance.mainChar.unit.getUnitStringFieldFactionGuid(),b=GameInstance.mainChar.unit.getUnitStringFieldGroupPeaceId(),c=GuidData.player.getUnitFieldNotoriety(),d=GameInstance.mainChar.unit.getGuid(),e=0;GameInstance.roleList&&e<GameInstance.roleList.length;e++){var f=GameInstance.roleList[e];if(f.unit&&!f.unit.isMain)if(f instanceof ScenePortal)4==f.tb.judge&&(this.jumpItem.push(f),f.showName("[ff00ff]"));else if(f.unit.isMonster())f.unit.getOwner()!=d&&this.attackItem.push(f);else if(f.unit.isPlayer())switch(c){case SharedDef.FAMILY_MODE:a&&a==f.unit.getUnitStringFieldFactionGuid()||this.attackItem.push(f);break;case SharedDef.GROUP_MODE:b!=f.unit.getUnitStringFieldGroupPeaceId()&&(this.attackItem.push(f),f.showBlood(2))}}GuidData.map&&(GuidData.map.isXianfu()||GuidData.map.is3V3())&&(GuidData.map.is3V3()?(GameInstance.mainChar.showName("[00ff00]"),GameInstance.mainChar.showBlood(2)):GameInstance.mainChar.showBlood(1))}},a.prototype.inAttackItemByChar=function(a){for(var b=0;b<this.attackItem.length;b++)if(this.attackItem[b]==a)return!0;return!1},a.prototype.In3V3isAttack=function(a){for(var b,c=GuidData.map.getKuafu3V3DataItem(),d=0;d<c.length;d++)c[d].name==GuidData.player.getName()&&(b=c[d].group);for(var e=0;e<c.length;e++)if(a.unit.getName()==c[e].name&&b!=c[e].group)return!0;return!1},a}(),SceneCharManager=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.creatChar=function(a){var b,c=a.getTypeID(),d=0;if(c==SharedDef.TYPEID_UNIT){if(d=a.getAvatar(),0==d){var e=a.getEntry();d=tb.TB_creature_template.get_TB_creature_template(e).avatar}else d=tb.TB_item_template.getAvatarById(d);b=this.getSceneChar()}else if(c==SharedDef.TYPEID_PLAYER)b=this.getSceneChar();else if(c==SharedDef.TYPEID_GAMEOBJECT){var e=a.getEntry(),f=tb.TB_gameobject_template.get_TB_gameobject_template(e);d=f.avatar;var g=f.judge;1==g?(b=this.getCollection(),b.setSpecialType(g)):(b=this.getScenePortal(),b.tb=f)}return b||console.log("没创建正确的对象"),a.sceneChar=b,b.unit=a,ObjectDef.testUG(a.guid,GuidData.player.guid)&&(a.isMain=!0,GameInstance.mainChar=b,Scene_data.cam3D.lookAtTarget=GameInstance.mainChar,b.setHp(b.unit.getHp()),console.log("角色创建自己==========>",a.guid,b.unit.getHp(),b.unit.getMaxHp()),console.log("----------------------------------")),c==SharedDef.TYPEID_PLAYER?(b.setAvatarExterior(),b.setWeaponDivine()):b.setAvatar(d),GameInstance.addSceneChar(b),b.setMount(),b.setWing(),b.showName(),b.unit.isPlayer()?(b.refreshTittle(),b.showBlood(0)):b.showBlood(1),b.refreshUnitFieldByte(),a.isSkillNpc()&&(b.meshVisible=!1),!0},a.prototype.sendGm=function(){GuidData.player&&GameData.initGMbg&&(GameStart.outNet,GameData.initGMbg=!1)},a.prototype.removeSceneChar=function(a){a.unit&&a.unit.isMain&&console.log("移除自己"),GameInstance.removeSceneChar(a),a.destory()},a.prototype.getSceneChar=function(){var a=new SceneChar;return a.x=0,a.y=5,a.z=0,a.setShadowSize(10),a},a.prototype.getScenePortal=function(){var a=new ScenePortal;return a.x=0,a.y=5,a.z=0,a.setShadowSize(10),a},a.prototype.getCollection=function(){var a=new SceneCollection;return a.x=0,a.y=5,a.z=0,a.setShadowSize(10),a},a.prototype.addWarningEffectChar=function(a,b){var c=new WarningEffectChar;return c.x=a.x,c.y=a.y,c.z=a.z,c.forceRotationY=180*a.w/Math.PI+90,SceneManager.getInstance().addMovieDisplay(c),c.setSpellName(b),c},a.prototype.getSceneBaseCollection=function(){var a=new SceneBaseCollection;return a.x=0,a.y=5,a.z=0,a.setShadowSize(10),a},a.prototype.getSceneCharByUID=function(a){var b=GuidObjManager.getInstance().getUnitByID(a);return b?b.sceneChar:null},a}(),FightDataVo=function(){function a(){this.typeUp=-1}return a}(),AttackEffectsManager=function(){function a(){}return a.playLyf=function(a,b,c){var d=this;void 0===c&&(c=null),this.lyfItem||(this.lyfItem=new Array),GroupDataManager.getInstance().getGroupData(Scene_data.fileRoot+a,function(a){for(var e=0;e<a.dataAry.length;e++){var f=a.dataAry[e];if(f.types==BaseRes.SCENE_PARTICLE_TYPE){var g=ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+f.particleUrl);ParticleManager.getInstance().addParticle(g),g.addEventListener(BaseEvent.COMPLETE,d.onPlayCom,d),d.lyfItem.push({dis:g,tg:b,offset:c})}else console.log("播放的不是单纯特效")}})},a.frameUpData=function(){if(this.lyfItem)for(var a=new Vector3D(Scene_data.cam3D.x,Scene_data.cam3D.y,Scene_data.cam3D.z),b=0;b<this.lyfItem.length;b++){var c=this.lyfItem[b].dis,d=this.lyfItem[b].tg,e=new Vector3D(d.x,d.y+d.tittleHeight/3,d.z);this.lyfItem[b].offset&&(e=e.add(this.lyfItem[b].offset));var f=a.subtract(e);f.normalize(),f.scaleBy(10),e=e.add(f),c.setPos(e.x,e.y,e.z)}},a.onPlayCom=function(a){for(var b=a.target,c=-1,d=0;d<this.lyfItem.length;d++)this.lyfItem[d].dis==b&&(c=d);-1!=c&&this.lyfItem.splice(c,1),b.removeEventListener(BaseEvent.COMPLETE,this.onPlayCom,this),ParticleManager.getInstance().removeParticle(b)},a}(),FightManager=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.fightUpdate=function(a){for(var b=this,c=a.readUnsignedInt(),d=a.readUnsignedByte(),e=new Array,f=0;d>f;f++){var g=new SkillBeAttackData;g.target=a.readUnsignedInt(),g.lastHp=a.readUnsignedInt(),g.utype=a.readUnsignedByte(),g.isKilled=a.readUnsignedByte(),g.damage=a.readDouble(),0==g.lastHp&&(g.isKilled=1),e.push(g)}var h,i=a.readUnsignedInt(),j=a.readShort(),k=a.readShort(),l=this.getFightDataItem(e,c);e.length&&(h=SceneCharManager.getInstance().getSceneCharByUID(e[0].target)),h&&h.unit.isMain,this.showSkill(c,i,e,new Vector2D(j,k),h,function(){b.showFightDataByItem(l)})},a.prototype.showFightDataByItem=function(a){for(var b=0;a&&b<a.length;b++){var c=a[b],d=SceneCharManager.getInstance().getSceneCharByUID(c.target);if(!d)return;if(c.type==SharedDef.HITINFO_NORMALSWING||c.type==SharedDef.HITINFO_CRITHIT){var e=GuidData.player.getCharType();1==e||2==e?AttackEffectsManager.playLyf(getModelUrl("beiji_lyf"),d):3==e||4==e?AttackEffectsManager.playLyf(getModelUrl("beiji_ds_lyf"),d):AttackEffectsManager.playLyf(getModelUrl("beiji_jk_lyf"),d)}if(d.setHp(c.lastHp),0!=c.txtNum){var f=new bloodTittle.TextJumpUiVo;f.str=c.damagenum,f.type=c.type,f.starttime=TimeUtil.getTimer(),f.endtime=TimeUtil.getTimer()+1200;var g=d.py+Math.min(d.tittleHeight-5,40);f.pos=new Vector3D(d.px,g,d.pz),BloodManager.getInstance().setJumpNum(f),c.isKilled||d.refreshLifeNum()}else{var f=new bloodTittle.TextJumpUiVo;f.type=c.type,f.starttime=TimeUtil.getTimer(),f.endtime=TimeUtil.getTimer()+1200,f.pos=new Vector3D(d.x,d.y+d.tittleHeight-5,d.z),BloodManager.getInstance().setJumpNum(f)}c.isKilled&&(d.setHp(0),GameInstance.removeAttackTarget(d),d.refreshUnitFieldByte(),d.play(CharAction.DEATH,1),c.casterme&&!c.isme&&this.attackFly(d))}},a.prototype.needdrawNum=function(a,b){for(var c,d=0;d<a.length;d++)if(c=SceneCharManager.getInstance().getSceneCharByUID(a[d].target),c&&c.unit.isMain)return!0;return c=SceneCharManager.getInstance().getSceneCharByUID(b),c&&c.unit.isMain?!0:!1},a.prototype.getFightDataItem=function(a,b){var c=SceneCharManager.getInstance().getSceneCharByUID(b);if(this.needdrawNum(a,b)){for(var d=new Array,e=0;e<a.length;e++)if(0!=a[e].target){var f=SceneCharManager.getInstance().getSceneCharByUID(a[e].target);if(f){var g=new FightDataVo;if(g.target=a[e].target,g.txtNum=0,g.lastHp=a[e].lastHp,a[e].utype!=SharedDef.HITINFO_CURE)g.txtNum=Math.floor(a[e].damage/100),g.damagenum=String(Math.abs(g.txtNum));else{var h=Math.floor((Math.abs(g.lastHp)-f.unit.getHp())/100);g.damagenum=String(h),g.txtNum=100}f.unit.isMain?a[e].utype==SharedDef.HITINFO_CRITHIT||a[e].utype==SharedDef.HITINFO_NORMALSWING?(g.type=bloodTittle.TextJumpType.MYNORMALDAMAGE,g.typeUp=bloodTittle.TextJumpType.MYNORMALDAMAGEUP):a[e].utype==SharedDef.HITINFO_CURE?(g.typeUp=-1,g.type=bloodTittle.TextJumpType.TREATMENT,Number(g.damagenum)<=0?g.damagenum="":g.damagenum="+"+g.damagenum):a[e].utype==SharedDef.HITINFO_MISS&&(g.typeUp=-1,g.type=bloodTittle.TextJumpType.DODGE):a[e].utype==SharedDef.HITINFO_MISS?(g.typeUp=-1,g.type=bloodTittle.TextJumpType.MISS):a[e].utype==SharedDef.HITINFO_NORMALSWING?(g.type=bloodTittle.TextJumpType.NORMALDAMAGE,g.typeUp=bloodTittle.TextJumpType.NORMALDAMAGEUP):a[e].utype==SharedDef.HITINFO_CRITHIT&&(g.type=bloodTittle.TextJumpType.CRIT,g.typeUp=bloodTittle.TextJumpType.CRITUP),g.isme=f.unit.isMain,g.casterme=c.unit.isMain,a[e].isKilled&&(g.isKilled=!0),d.push(g)}}return d}for(var e=0;e<a.length;e++)if(0!=a[e].target){var f=SceneCharManager.getInstance().getSceneCharByUID(a[e].target);f&&(a[e].isKilled?f.setHp(0):f.setHp(a[e].lastHp),f.refreshLifeNum())}return null},a.prototype.setSelfSkillCd=function(a){var b=tb.TB_skill_base.get_TB_skill_base(a);if(b.effect_file&&b.effect&&!b.is_remain){var c=new mainUi.MainUiEvent(mainUi.MainUiEvent.PLAYER_SKILL_CD_REFRESH);c.data=a,ModuleEventManager.dispatchEvent(c)}},a.prototype.showSkill=function(a,b,c,d,e,f){if(0==b)return void f();var g=SceneCharManager.getInstance().getSceneCharByUID(a);if(!g)return console.log("技能释放找不到施法者："+a),void f();var h=Play_Skill_Vo.get_Play_Skill_Vo(b),i=h.tb_skill_base.timeout;if(g.unit.isMain)return this.setSelfSkillCd(b),void(i>0?TimeUtil.addTimeOut(i,f):f());if(1==h.tb_skill_base.specialtype)return void f();if(g.isDeath)return void f();if(0==h.tb_skill_base.is_play_forbid&&h.tb_skill_base.effect_file&&h.tb_skill_base.effect){var j=SkillManager.getInstance().getSkill(getSkillUrl(h.tb_skill_base.effect_file),h.tb_skill_base.effect);j&&(j.reset(),j.needSound=g.unit.isMain,1==h.tb_skill_base.isOrbit?this.playDynamicTarget(j,h,g,e,f):0==h.tb_skill_base.is_remain&&this.playFixEffect(j,h,d,g,c))}i>0?TimeUtil.addTimeOut(i,f):f()},a.prototype.playDynamicTarget=function(a,b,c,d,e){a.configTrajectory(c,d,function(){},0,e),this.playBaseSkill(a,b,c)},a.prototype.playBaseSkill=function(a,b,c){c.isMount&&(c.unit.setDownMount(),c.setMount()),0!=b.tb_skill_base.group&&c.unit.isMain?b.skill=a:c.playSkill(a)},a.prototype.playFixEffect=function(a,b,c,d,e){var f,g=AstarUtil.getWorldPosByStart2D(c);if(4==b.tb_skill_base.target_type&&(f=new Array,g.y=AstarUtil.getHeightByPos(g),f.push(g)),c.x&&c.y){var h=new Display3D;h.x=g.x,h.z=g.z,d.watch(h,!0)}if(a.configFixEffect(d,null,f),e&&e.length&&1==b.tb_skill_base.lock_type){var i=SceneCharManager.getInstance().getSceneCharByUID(e[0].target);d.watch(i)}this.playBaseSkill(a,b,d)},a.prototype.attackFly=function(a){var b=GameInstance.mainChar,c=b.getAstarPos(),d=a.getAstarPos(),e=d.sub(c);e.normalize(),e.scaleBy(-5),d=d.add(e);var f=AstarUtil.getWorldPosByStart2D(d);f.y=AstarUtil.getHeightByPos(f);var g=a,h=function(){a.refreshPos()};TweenLite.to(g,.3,{px:f.x,py:f.y,pz:f.z,onUpdate:h})},a}(),SkillBeAttackData=function(){function a(){}return a}(),DamageShowManage=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.showHP=function(a,b){console.log(a.unit.getName()+"掉血:"+b)},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GrowData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this._after_update=function(b,c,d){a.dataUpdate(c,d)},this.AddListen(SharedDef.SPELL_INT_FIELD_MOUNT_BLESS_EXP,function(b){a.mountBlessChange()}),this.AddListen(SharedDef.SPELL_STRENGTHEN_ALLMUL,function(b){a.strengMulChg()}),this.AddListen(SharedDef.SPELL_GEM_ALLMUL,function(b){a.gemMulChg()}),this.AddListen(SharedDef.SPELL_WINGS_ID,function(b){a.wingIDChg()}),this.AddListen(SharedDef.SPELL_WINGS_BLESS_EXP,function(b){a.wingExpChg()}),this.AddListen(SharedDef.SPELL_WINGS_LEVEL,function(b){a.wingLevChg()}),this.AddListen(SharedDef.SPELL_INT_FIELD_MOUNT_LEVEL_BASE,function(b){a.spellIntFieldMountlevChg()}),this.AddListen(SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_BONUS_LV,function(b){a.masterLevChg()}),this.AddListenString(SharedDef.SPELL_STRING_FIELD_EQUIPDEVELOP_WASHATTRS_INFO,function(b){a.washChg()}),ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.getHuanhuaID=function(){return this._aryhuanhuaid?this._aryhuanhuaid:(this._aryhuanhuaid=this.refresharyhuanhuaid(),this._aryhuanhuaid)},b.prototype.refresharyhuanhuaid=function(){for(var a=new Array,b=SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_START;b<SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_END&&0!=this.GetInt32(b);b+=SharedDef.MAX_ILLUSION_ATTR_COUNT)a.push(this.GetInt32(b));return a},b.prototype.getzuoqiJinengList=function(){for(var a=new Array,b=SharedDef.SPELL_INT_FIELD_MOUNT_SPELL_END-SharedDef.SPELL_INT_FIELD_MOUNT_SPELL_START,c=0;b>c;c++){var d=SharedDef.SPELL_INT_FIELD_MOUNT_SPELL_START+c,e=GuidData.grow.GetUInt16(d,0),f=GuidData.grow.GetUInt16(d,1);0!=e&&a.push({id:e,lev:f})}return console.log("-----------zhuoqi jineng----------",a),a},b.prototype.getHuanhuaJinengList=function(){for(var a=new Array,b=SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_START;b<SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_END;b+=SharedDef.MAX_ILLUSION_ATTR_COUNT)for(var c=SharedDef.ILLUSION_ATTR_SPELL_START;c<SharedDef.ILLUSION_ATTR_SPELL_END;c++){var d=b+c,e=GuidData.grow.GetUInt16(d,0),f=GuidData.grow.GetUInt16(d,1);0!=e&&(console.log("-----------huanhuajineng----------",e,f),a.push({id:e,lev:f}))}return a},b.prototype.mountBlessChange=function(){var a=SharedDef.SPELL_INT_FIELD_MOUNT_BLESS_EXP;console.log("-----------祝福值-----------",this.GetInt32(a)),ModuleEventManager.dispatchEvent(new mountui.MountUiEvent(mountui.MountUiEvent.MOUNT_LEVET_STAR_CHANGE_EVENT))},b.prototype.dataUpdate=function(a,b){(a[SharedDef.SPELL_INT_FIELD_MERIDIAN_LEVEL]||a[SharedDef.SPELL_INT_FIELD_MERIDIAN_EXP])&&ModuleEventManager.dispatchEvent(new meridian.MeridianEvent(meridian.MeridianEvent.REFRISH_MERIDIAL_PANEL)),(a[SharedDef.SPELL_INT_FIELD_MOUNT_LEVEL]||a[SharedDef.SPELL_INT_FIELD_MOUNT_TRAIN_EXP])&&(console.log("---经验和等级变化--"),ModuleEventManager.dispatchEvent(new mountui.MountUiEvent(mountui.MountUiEvent.MOUNT_LEVET_STAR_CHANGE_EVENT)));for(var c=!1,d=SharedDef.SPELL_INT_FIELD_BASE_SPELL_START;d<SharedDef.SPELL_INT_FIELD_BASE_SPELL_END;d++)if(a[d]&&(c=!0,this._skillLevDic)){var e=GuidData.grow.GetUInt16(d,0),f=GuidData.grow.GetUInt16(d,1);this._skillLevDic[e]=f}c&&ModuleEventManager.dispatchEvent(new skillUi.SkillUiEvent(skillUi.SkillUiEvent.RESET_SKILL_UI_DATA));for(var d=SharedDef.SPELL_INT_FIELD_MOUNT_SPELL_START;d<SharedDef.SPELL_INT_FIELD_MOUNT_SPELL_END;d++)a[d]&&(this.zuoqiSkillChange(d),ModuleEventManager.dispatchEvent(new mountui.MountUiEvent(mountui.MountUiEvent.SKILL_CHANGE_EVENT)));for(var d=SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_START;d<SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_END;d+=SharedDef.MAX_ILLUSION_ATTR_COUNT)for(var g=SharedDef.ILLUSION_ATTR_SPELL_START;g<SharedDef.ILLUSION_ATTR_SPELL_END;g++)a[d+g]&&this.huanhuaSkillChange(d+g);for(var d=SharedDef.SPELL_STRENGTHEN_START;d<SharedDef.SPELL_STRENGTHEN_END;d+=SharedDef.MAX_STRENGTHEN_COUNT)a[d]&&this.strengDataChg(d-SharedDef.SPELL_STRENGTHEN_START);for(var h in a){var i=Number(h);if(i>=SharedDef.SPELL_GEM_START&&i<SharedDef.SPELL_GEM_END){i-=SharedDef.SPELL_GEM_START;var j=float2int(i/SharedDef.MAX_GEM_COUNT),k=i%SharedDef.MAX_GEM_COUNT;3>k?this.gemLevChg(j):this.gemBlessChg(j)}}var l=!1;for(var h in a){var i=Number(h);i>=SharedDef.SPELL_INT_FIELD_APPEARANCE_START&&i<SharedDef.SPELL_INT_FIELD_APPEARANCE_END&&(l=!0)}l&&ModuleEventManager.dispatchEvent(new exterior.ExteriorEvent(exterior.ExteriorEvent.REFRISH_EXTERIOR_PANEL));for(var h in a){var i=Number(h);if(i>=SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_START&&i<SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_END){var m=i-SharedDef.SPELL_INT_FIELD_MOUNT_ILLUSION_START,j=float2int(m/SharedDef.MAX_ILLUSION_ATTR_COUNT),k=m%SharedDef.MAX_ILLUSION_ATTR_COUNT;if(k==SharedDef.ILLUSION_ATTR_ID){var n=this.GetInt32(i);if(n>0){for(var o=!1,d=0;d<this._aryhuanhuaid.length;d++)if(this._aryhuanhuaid[d]==n){o=!0;break}this._aryhuanhuaid=this.refresharyhuanhuaid();var p=new mountui.MountUiEvent(mountui.MountUiEvent.POP_THE_UNREAL_PANEL);p.data=3,ModuleEventManager.dispatchEvent(p),o||console.log("--2222")}}}}for(var h in a){var i=Number(h);if(i>=SharedDef.SPELL_DIVINE_START&&i<SharedDef.SPELL_DIVINE_END){var q=i-SharedDef.SPELL_DIVINE_START,j=float2int(q/SharedDef.MAX_DIVINE_COUNT),k=q%SharedDef.MAX_DIVINE_COUNT;if(k==SharedDef.DIVINE_ID_LEV_BLESS){var r=this.getDivineID(i);if(r>0)for(var o=!1,d=0;d<this._divineList.length;d++)if(this._divineList[d].id==r){o=!0;break}}this._divineList=this.refreshDivineList(),this.changeDivineData()}}for(var h in a){var i=Number(h);if(i>=SharedDef.SPELL_TALISMAN_START&&i<SharedDef.SPELL_TALISMAN_END){var q=i-SharedDef.SPELL_TALISMAN_START,j=float2int(q/SharedDef.MAX_TALISMAN_COUNT),k=q%SharedDef.MAX_TALISMAN_COUNT;if(k==SharedDef.TALISMAN_ID_LV){var s=this.GetByte(i,0);if(s>0){console.log("talismanid---",s);for(var o=!1,d=0;d<this._treasureList.length;d++)if(this._treasureList[d].id==s){o=!0;break}this._treasureList=this.refreshTreasureList(),o?ModuleEventManager.dispatchEvent(new treasure.TreasureUiEvent(treasure.TreasureUiEvent.CHANGE_WEAPON_EVENT)):ModuleEventManager.dispatchEvent(new treasure.TreasureUiEvent(treasure.TreasureUiEvent.UNLOCK_WEAPON_EVENT))}}}}for(var h in a){var i=Number(h);if(i>=SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_START&&i<SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_END){var t,q=i-SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_START,j=float2int(q/SharedDef.MAX_EQUIPDEVELOP_COUNT),k=q%SharedDef.MAX_EQUIPDEVELOP_COUNT;t=k==SharedDef.EQUIPDEVELOP_STRENGTH_LV?strengthgem.StrengthGemEvent.STRENG_LEV_EVENT:k==SharedDef.EQUIPDEVELOP_REFINE_LV?strengthgem.StrengthGemEvent.REFINING_LEV_EVENT:strengthgem.StrengthGemEvent.GEM_LEV_EVENT;var u=new strengthgem.StrengthGemEvent(t);u.data=j+1,ModuleEventManager.dispatchEvent(u)}}for(var h in a){var i=Number(h);i>=SharedDef.SPELL_INT_FIELD_MERIDIAN_CNT_START&&i<SharedDef.SPELL_INT_FIELD_MERIDIAN_CNT_END&&ModuleEventManager.dispatchEvent(new meridian.MeridianEvent(meridian.MeridianEvent.REFRISH_MERIDIAL_LIST))}var v=!1;for(var h in a){var i=Number(h);i>=SharedDef.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_START&&i<SharedDef.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_END&&(v=!0)}v&&ModuleEventManager.dispatchEvent(new ActiveEvent(ActiveEvent.ACTIVE_PLAYER_CHANGE_EVENT))},b.prototype.changeDivineData=function(){},b.prototype.strengDataChg=function(a){console.log("----强化数据变化了-----");var b=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.STRENGTHGEM_DATA_CHG);b.dataType=1,b.data=a,ModuleEventManager.dispatchEvent(b)},b.prototype.strengMulChg=function(){console.log("----全身奖励变化了-----");var a=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.STRENGTHGEM_MUL_CHG);ModuleEventManager.dispatchEvent(a)},b.prototype.gemLevChg=function(a){console.log("--gemLevChg--");var b=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.GEM_UPLEV_CHG);b.data=a,ModuleEventManager.dispatchEvent(b)},b.prototype.gemBlessChg=function(a){console.log("--gemBlessChg--");var b=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.GEM_BLESS_CHG);b.data=a,ModuleEventManager.dispatchEvent(b)},b.prototype.gemMulChg=function(){var a=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.GEM_MUL_CHG);ModuleEventManager.dispatchEvent(a)},b.prototype.getSpellInitFieldBaseSpeell=function(){for(var a=new Array,b=SharedDef.SPELL_INT_FIELD_BASE_SPELL_END-SharedDef.SPELL_INT_FIELD_BASE_SPELL_START,c=0;b>c;c++){var d=SharedDef.SPELL_INT_FIELD_BASE_SPELL_START+c,e=GuidData.grow.GetUInt16(d,0),f=GuidData.grow.GetUInt16(d,1);0!=e&&(console.log("-----------基础技能----------",e,f),a.push({id:e,lev:f}))}return a},b.prototype.getSkillLev=function(a){if(!this._skillLevDic){this._skillLevDic=new Object;for(var b=SharedDef.SPELL_INT_FIELD_BASE_SPELL_END-SharedDef.SPELL_INT_FIELD_BASE_SPELL_START,c=0;b>c;c++){var d=SharedDef.SPELL_INT_FIELD_BASE_SPELL_START+c,e=GuidData.grow.GetUInt16(d,0),f=GuidData.grow.GetUInt16(d,1);this._skillLevDic[e]=f}}return this._skillLevDic[a]?this._skillLevDic[a]:0},b.prototype.huanhuaSkillChange=function(a){console.log("-----------huanhuajinengenxing-----------",this.GetInt16(a,0),this.GetInt16(a,1))},b.prototype.zuoqiSkillChange=function(a){console.log("-----------zuoqijinenggengxin-----------",this.GetInt16(a,0),this.GetInt16(a,1)),ModuleEventManager.dispatchEvent(new mountui.MountUiEvent(mountui.MountUiEvent.CHANGE_jingjie_SKILL_PANEL))},b.prototype.getMountLevel=function(){var a=SharedDef.SPELL_INT_FIELD_MOUNT_LEVEL,b=this.GetInt16(a,0);return b},b.prototype.getMountStart=function(){var a=SharedDef.SPELL_INT_FIELD_MOUNT_LEVEL,b=this.GetInt16(a,1);return b},b.prototype.spellIntFieldMountlevChg=function(){console.log("--坐骑等级变化--"),ModuleEventManager.dispatchEvent(new mountui.MountUiEvent(mountui.MountUiEvent.MOUNT_LEV_CHANGE_EVENT))},b.prototype.getMountlev=function(){return this.GetUInt32(SharedDef.SPELL_INT_FIELD_MOUNT_LEVEL_BASE)},b.prototype.getSpellIntFieldMeridianLevel=function(a){return this.GetInt16(SharedDef.SPELL_INT_FIELD_MERIDIAN_LEVEL,a)},b.prototype.getSpellIntFieldMeridianExp=function(){return this.GetInt32(SharedDef.SPELL_INT_FIELD_MERIDIAN_EXP)},b.prototype.getSpellIntFieldMeridianCnt=function(){for(var a=new Array,b=SharedDef.SPELL_INT_FIELD_MERIDIAN_CNT_END-SharedDef.SPELL_INT_FIELD_MERIDIAN_CNT_START,c=0;b>c;c++){var d=SharedDef.SPELL_INT_FIELD_MERIDIAN_CNT_START+c;a.push(this.GetByte(d,0)),a.push(this.GetByte(d,1)),a.push(this.GetByte(d,2)),a.push(this.GetByte(d,3))}return a},b.prototype.getSpellIntFieldAppearanceId=function(){for(var a=new Array,b=SharedDef.SPELL_INT_FIELD_APPEARANCE_END-SharedDef.SPELL_INT_FIELD_APPEARANCE_START,c=0;b>c;c++){var d=this.GetUInt32(SharedDef.SPELL_INT_FIELD_APPEARANCE_START+c);d&&a.push(d)}return a},b.prototype.isSpellIntFieldAppearanceById=function(a){for(var b=this.getSpellIntFieldAppearanceId(),c=0;c<b.length;c++)if(b[c]==a)return!0;return!1},b.prototype.getMountExp=function(){var a=SharedDef.SPELL_INT_FIELD_MOUNT_TRAIN_EXP;return this.GetInt32(a)},b.prototype.getMountBless=function(){var a=SharedDef.SPELL_INT_FIELD_MOUNT_BLESS_EXP;return this.GetInt32(a)},b.prototype.getStrengLev=function(a){return this.GetUInt16(SharedDef.SPELL_STRENGTHEN_START+(a-1)*SharedDef.MAX_STRENGTHEN_COUNT,0)},b.prototype.getStrengValue=function(a){var b=this.getPartStrengLev(a);if(0>=b||a==SharedDef.EQUIPMENT_TYPE_FASHION)return 0;var c=tb.TB_equipdevelop_strength.get_TB_equipdevelop_strengthById(a,b);return c.props[0][1]},b.prototype.getStrengValueByLev=function(a,b){if(0>=b||a==SharedDef.EQUIPMENT_TYPE_FASHION)return 0;var c=tb.TB_equipdevelop_strength.get_TB_equipdevelop_strengthById(a,b);return c.props[0][1]},b.prototype.getStrengBless=function(a){return this.GetUInt16(SharedDef.SPELL_STRENGTHEN_START+(a-1)*SharedDef.MAX_STRENGTHEN_COUNT,1)},b.prototype.getStrengMul=function(){return this.GetUInt32(SharedDef.SPELL_STRENGTHEN_ALLMUL)},b.prototype.getGemLev=function(a,b){return this.GetUInt32(SharedDef.SPELL_GEM_START+(a-1)*SharedDef.MAX_GEM_COUNT+b)},b.prototype.getGemByIndex=function(a){return this.GetUInt32(a)},b.prototype.getGemBless=function(a){return this.GetUInt16(SharedDef.SPELL_GEM_START+(a-1)*SharedDef.MAX_GEM_COUNT+SharedDef.GEM_CURID_BLESS,1)},b.prototype.getGemCurrentID=function(a){return this.GetUInt16(SharedDef.SPELL_GEM_START+(a-1)*SharedDef.MAX_GEM_COUNT+SharedDef.GEM_CURID_BLESS,0)},b.prototype.getGemMul=function(){return this.GetUInt32(SharedDef.SPELL_GEM_ALLMUL)},b.prototype.getDivineLev=function(a){return this.GetByte(a,1)},b.prototype.getDivineBless=function(a){return this.GetUInt16(a,1)},b.prototype.getDivineID=function(a){return this.GetByte(a,0)},b.prototype.getDivineSkillDirect=function(a){var b=new Object;return b.id=this.GetUInt16(a,0),b.lev=this.GetUInt16(a,1),b},b.prototype.getDivineSkill=function(a){var b=new Object;return b.id=this.GetUInt16(a+SharedDef.DIVINE_SKILL,0),b.lev=this.GetUInt16(a+SharedDef.DIVINE_SKILL,1),b},b.prototype.getDivinePassiveSkill=function(a){for(var b=new Array,c=0;c<SharedDef.DIVINE_PASSIVE_SKILL_COUNT;c++){var d=new Object;d.id=this.GetUInt16(a+SharedDef.DIVINE_PASSIVE_SKILL+c,0),d.lev=this.GetUInt16(a+SharedDef.DIVINE_PASSIVE_SKILL+c,1),b.push(d)}return b},b.prototype.getDivineList=function(){return this._divineList?this._divineList:(this._divineList=this.refreshDivineList(),this._divineList)},b.prototype.refreshDivineList=function(){for(var a=new Array,b=SharedDef.SPELL_DIVINE_START;b<SharedDef.SPELL_DIVINE_END;b+=SharedDef.MAX_DIVINE_COUNT){var c=this.GetByte(b,0);if(0!=c){var d=new DivineVo;d.id=c,d.index=b,d.lev=this.GetByte(b,1),d.bless=this.GetUInt16(b,1),d.outTime=this.GetUInt32(b+1),a.push(d)}}return a},b.prototype.getTreasureList=function(){return this._treasureList?this._treasureList:(this._treasureList=this.refreshTreasureList(),this._treasureList)},b.prototype.refreshTreasureList=function(){for(var a=new Array,b=SharedDef.SPELL_TALISMAN_START;b<SharedDef.SPELL_TALISMAN_END;b+=SharedDef.MAX_TALISMAN_COUNT){var c=this.GetByte(b,0);if(0==c)b=SharedDef.SPELL_TALISMAN_END;else{var d=new TreasureVo;d.id=c,d.lev=this.GetByte(b,1),d.power=this.GetUInt32(b+1),a.push(d)}}return a},b.prototype.getWingIsActive=function(){return 0!=this.GetUInt32(SharedDef.SPELL_WINGS_ID)},b.prototype.getWingID=function(){return this.GetUInt32(SharedDef.SPELL_WINGS_ID)},b.prototype.getWingModel=function(){if(0==this.getWingID())return 0;var a=TableData.getInstance().getData(TableData.tb_wings_bless,this.getWingID()),b=TableData.getInstance().getData(TableData.tb_wings_base,a.rank);return b.model},b.prototype.getWingQh=function(){return this.GetUInt32(SharedDef.SPELL_WINGS_LEVEL)},b.prototype.getWingExp=function(){return this.GetUInt32(SharedDef.SPELL_WINGS_BLESS_EXP)},b.prototype.wingIDChg=function(){
ModuleEventManager.dispatchEvent(new wing.WingEvent(wing.WingEvent.WING_ID_CHANG_EVENT))},b.prototype.wingExpChg=function(){ModuleEventManager.dispatchEvent(new wing.WingEvent(wing.WingEvent.WING_EXP_CHANG_EVENT))},b.prototype.wingLevChg=function(){ModuleEventManager.dispatchEvent(new wing.WingEvent(wing.WingEvent.WING_LEV_CHANG_EVENT))},b.prototype.getPartStrengLev=function(a){return this.GetUInt16(SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_START+SharedDef.EQUIPDEVELOP_STRENGTH_LV+(a-1)*SharedDef.MAX_EQUIPDEVELOP_COUNT,0)},b.prototype.getPartRefineVo=function(a){var b=SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_START+SharedDef.EQUIPDEVELOP_REFINE_LV+(a-1)*SharedDef.MAX_EQUIPDEVELOP_COUNT,c=new Array;return c.push(this.GetUInt16(b,0)),c.push(this.GetUInt16(b,1)),c},b.prototype.getPartGemVo=function(a){for(var b=tb.TB_equipdevelop_gem_part.get_TB_equipdevelop_gem_partById(a),c=SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_START+(a-1)*SharedDef.MAX_EQUIPDEVELOP_COUNT,d=new Array,e=0;e<b.gem_array.length;e++)d.push(this.GetUInt16(c+SharedDef.EQUIPDEVELOP_GEM_LV_START+Math.floor(e/2),e%2));return d},b.prototype.getWashVo=function(){return this.GetStr(SharedDef.SPELL_STRING_FIELD_EQUIPDEVELOP_WASHATTRS_INFO)},b.prototype.washChg=function(){ModuleEventManager.dispatchEvent(new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.WASH_CHG_EVENT))},b.prototype.getMasterLevVo=function(){var a=new Array;return a.push(this.GetUInt8(SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_BONUS_LV,0)),a.push(this.GetUInt8(SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_BONUS_LV,1)),a.push(this.GetUInt8(SharedDef.SPELL_INT_FIELD_EQUIPDEVELOP_BONUS_LV,2)),console.log("-----取用大师等级------"),a},b.prototype.masterLevChg=function(){ModuleEventManager.dispatchEvent(new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.WASH_CHG_EVENT)),console.log("-----监听到等级变化了------")},b.prototype.getActivePlayerData=function(a){return[this.GetUInt32(SharedDef.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_START+a*SharedDef.MAX_PLAYERACTIVITTYDATAINT_COUNT),this.GetUInt32(SharedDef.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_START+a*SharedDef.MAX_PLAYERACTIVITTYDATAINT_COUNT+1),this.GetUInt32(SharedDef.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_START+a*SharedDef.MAX_PLAYERACTIVITTYDATAINT_COUNT+2),this.GetUInt32(SharedDef.SPELL_INT_FIELD_PLAYER_ACTIVITY_DATA_START+a*SharedDef.MAX_PLAYERACTIVITTYDATAINT_COUNT+3)]},b}(GuidObject),DivineVo=function(){function a(){}return a}(),TreasureVo=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GiftPacksData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._dataState=0,b}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this._after_update=function(b,c,d){a.dataUpdate(c,d)},ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.dataUpdate=function(a,b){var c=new Object;for(var d in a){var e=Number(d);if(!(e<SharedDef.GIFTPACKS_INT_FIELD_BEGIN)){var f=Math.floor((e-SharedDef.GIFTPACKS_INT_FIELD_BEGIN)/SharedDef.MAX_GIFTPACKS_INFO_INT);c[f]||(c[f]=1)}}for(var d in b){var e=Number(d);if(!(e<SharedDef.GIFTPACKS_STRING_FIELD_BEGIN)){var f=Math.floor((e-SharedDef.GIFTPACKS_STRING_FIELD_BEGIN)/SharedDef.MAX_GIFTPACKS_INFO_STRING);c[f]||(c[f]=1)}}this._dataState=0;for(var g in c)this.changeGiftDataByKey(Number(g));if(this._dataState>0){var h=new email.MailEvent(email.MailEvent.MAIL_CHG_EVENT);h.data=this._dataState,ModuleEventManager.dispatchEvent(h)}},b.prototype.changeGiftDataByKey=function(a){var b=SharedDef.GIFTPACKS_INT_FIELD_BEGIN+a*SharedDef.MAX_GIFTPACKS_INFO_INT,c=SharedDef.GIFTPACKS_STRING_FIELD_BEGIN+a*SharedDef.MAX_GIFTPACKS_INFO_STRING,d=new GiftBaseVo;d.makeData(this,b,c,a),this.refreshGiftList(d),ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON))},b.prototype.getGiftDataItem=function(){if(this._giftList)return this._giftList;for(var a=new Array,b=0;b<SharedDef.MAX_GIFTPACKS_INFO_COUNT;b++){var c=SharedDef.GIFTPACKS_INT_FIELD_BEGIN+b*SharedDef.MAX_GIFTPACKS_INFO_INT,d=SharedDef.GIFTPACKS_STRING_FIELD_BEGIN+b*SharedDef.MAX_GIFTPACKS_INFO_STRING,e=new GiftBaseVo;e.makeData(this,c,d,b),e.isDele||0==e.startTime||a.push(e)}return this._giftList=a,a},b.prototype.refreshGiftList=function(a){if(this._giftList){for(var b=0;b<this._giftList.length;b++)if(a.indx==this._giftList[b].indx)return a.isDele||0==a.startTime?(this._giftList.splice(b,1),void(this._dataState=2)):(this._giftList[b].isGetItem=a.isGetItem,this._giftList[b].isRead=a.isRead,this._giftList[b].item=a.item,void(this._dataState=1));this._dataState=2,this._giftList.push(a)}},b}(GuidObject),GiftBaseVo=function(){function a(){}return a.prototype.makeData=function(a,b,c,d){this.id=a.GetInt32(b+SharedDef.GIFTPACKS_INFO_INT_ID),this.indx=d,this.startTime=a.GetInt32(b+SharedDef.GIFTPACKS_INFO_INT_START_TIME),this.endTime=a.GetInt32(b+SharedDef.GIFTPACKS_INFO_INT_END_TIME),this.type=a.GetUInt8(b+SharedDef.GIFTPACKS_INFO_INT_BYTE,0),this.isGetItem=1==a.GetUInt8(b+SharedDef.GIFTPACKS_INFO_INT_BYTE,1),this.isRead=1==a.GetUInt8(b+SharedDef.GIFTPACKS_INFO_INT_BYTE,2),this.isDele=1==a.GetUInt8(b+SharedDef.GIFTPACKS_INFO_INT_BYTE,3),this.name=a.GetStr(c+SharedDef.GIFTPACKS_INFO_STRING_GIFT_NAME),this.desc=a.GetStr(c+SharedDef.GIFTPACKS_INFO_STRING_GIFT_DESC),this.from=a.GetStr(c+SharedDef.GIFTPACKS_INFO_STRING_GIFT_FROM),this.item=a.GetStr(c+SharedDef.GIFTPACKS_INFO_STRING_GIFT_ITEM)},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),InstanceData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this._after_update=function(b,c,d){a.dataUpdate(c,d)},this.AddListen(SharedDef.INSTANCE_INT_FIELD_ACTIVE,function(a){ModuleEventManager.dispatchEvent(new activity.ActivityEvent(activity.ActivityEvent.ACTIVITY_CHANGE_EVENT))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_ACTIVE_REWARD,function(a){ModuleEventManager.dispatchEvent(new activity.ActivityEvent(activity.ActivityEvent.ACTIVITY_REWARD_EVENT))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_3V3_TIMES,function(a){ModuleEventManager.dispatchEvent(new kuafu.KuaFuEvent(kuafu.KuaFuEvent.INSTANCE_INT_FIELD_3V3_TIMES))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_3V3_DAY_REWARD,function(a){ModuleEventManager.dispatchEvent(new kuafu.KuaFuEvent(kuafu.KuaFuEvent.INSTANCE_INT_FIELD_3V3_DAY_REWARD))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_FIRST_REWARD,function(b){a.FirstvictoryrewardChange()}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_TIMES,function(a){ModuleEventManager.dispatchEvent(new kuafu.KuaFuEvent(kuafu.KuaFuEvent.KUAFU_1V1_REFRESH))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_GROUP_INSTANCE_CHALLENGE_COUNT,function(a){ModuleEventManager.dispatchEvent(new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.CHG_TEAM_NUM))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_QUALIFY_EXTRA_PICKED,function(a){ModuleEventManager.dispatchEvent(new kuafu.KuaFuEvent(kuafu.KuaFuEvent.KUAFU_ARENA_QUALIFY_REWARD_EVENT))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_QUALIFY_DAILY_TIMES,function(a){ModuleEventManager.dispatchEvent(new kuafu.KuaFuEvent(kuafu.KuaFuEvent.KUAFU_ARENA_QUALIFY_NUM_EVENT))}),this.AddListen(SharedDef.INSTANCE_INT_FIELD_TRIAL_SWEEP_SHORT,function(a){ModuleEventManager.dispatchEvent(new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.TOWER_FUBEN_SWEEP))}),ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.dataUpdate=function(a,b){for(var c in a){var d=Number(c);if(d>=SharedDef.INSTANCE_INT_FIELD_VIP_START&&d<SharedDef.INSTANCE_INT_FIELD_VIP_END)ModuleEventManager.dispatchEvent(new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.RES_FUBEN_REFRESH));else if(d>=SharedDef.INSTANCE_INT_FIELD_RES_START&&d<SharedDef.INSTANCE_INT_FIELD_RES_END)ModuleEventManager.dispatchEvent(new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.RES_FUBEN_REFRESH));else if(d>=SharedDef.INSTANCE_INT_FIELD_ACTIVE_START&&d<SharedDef.INSTANCE_INT_FIELD_ACTIVE_END){var e=new activity.ActivityEvent(activity.ActivityEvent.ACTIVITY_ITEM_CHANGE_EVENT);e.data=d,ModuleEventManager.dispatchEvent(e)}else d>=SharedDef.INSTANCE_INT_FIELD_PRIVATE_BOSS_RECOVER_TIME_START&&d<SharedDef.INSTANCE_INT_FIELD_PRIVATE_BOSS_RECOVER_TIME_END}},b.prototype.getHasChallengeNum=function(){return this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_TIMES,0)},b.prototype.getwinningstreakrecord=function(){return this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_COMBATWIN,0)},b.prototype.getvictoryrecord=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_MAX_RANK)},b.prototype.getCanbuyChallengeNum=function(){return this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_TIMES,1)},b.prototype.getDJcdtime=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_FIGHT_CD)},b.prototype.getFirstvictoryList=function(){for(var a=new Array,b=0;20>b;b++){var c=new FirstvictoryVo,d=this.GetBit(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_FIRST_GET,b+1);if(d){var e=this.GetBit(SharedDef.INSTANCE_INT_FIELD_DOUJIAN_FIRST_REWARD,b+1);e?c.state=2:c.state=0}else c.state=1;c.data=tb.TB_doujiantai_first.get_TB_doujiantai_firstById(b+1),a.push(c)}return a.sort(function(a,b){return a.state==b.state?a.data.id-b.data.id:a.state-b.state}),a},b.prototype.FirstvictoryrewardChange=function(){ModuleEventManager.dispatchEvent(new kuafu.KuaFuEvent(kuafu.KuaFuEvent.FIRSTREWARD_DJ_EVENT))},b.prototype.instanceIntFieldTrialSweep=function(){ModuleEventManager.dispatchEvent(new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.RES_FUBEN_REFRESH))},b.prototype.getInstanceIntFieldVipSatrt=function(){for(var a=new Array,b=SharedDef.INSTANCE_INT_FIELD_VIP_START;b<SharedDef.INSTANCE_INT_FIELD_VIP_END;b++){var c=b,d=this.GetByte(c,1),e=this.GetByte(c,2),f=this.GetByte(c,3);a.push({num:e,passed:d,buys:f})}return a},b.prototype.getInstanceIntFieldResSatrt=function(){for(var a=new Array,b=SharedDef.INSTANCE_INT_FIELD_RES_START;b<SharedDef.INSTANCE_INT_FIELD_RES_END;b++){var c=b,d=this.GetByte(c,0),e=this.GetByte(c,1);a.push({num:d,passed:e})}return console.log("===$arr==",a),a},b.prototype.getInstanceIntFieldTrialPassed=function(){var a=this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_TRIAL_PASSED_SHORT,0),b=this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_TRIAL_PASSED_SHORT,1);return[a,b]},b.prototype.getInstanceIntFieldXianfuDayTimes=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_XIANFU_DAY_TIMES)},b.prototype.getInstanceIntFieldTrialSweep=function(){var a=this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_TRIAL_SWEEP_SHORT,0),b=this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_TRIAL_SWEEP_SHORT,1);return[a,b]},b.prototype.getActivityNum=function(a){return this.GetUInt32(a)},b.prototype.getActivityNumByID=function(a){var b=a-1+SharedDef.INSTANCE_INT_FIELD_ACTIVE_START;return this.GetUInt32(b)},b.prototype.getActivity=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_ACTIVE)},b.prototype.getInstanceIntField3V3Times0=function(){return this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_3V3_TIMES,0)},b.prototype.getInstanceIntField3V3Times1=function(){return this.GetUInt16(SharedDef.INSTANCE_INT_FIELD_3V3_TIMES,1)},b.prototype.getInstanceIntField3V3DayReward=function(){var a=new Array;return a.push(this.GetByte(SharedDef.INSTANCE_INT_FIELD_3V3_DAY_REWARD,0)),a.push(this.GetByte(SharedDef.INSTANCE_INT_FIELD_3V3_DAY_REWARD,1)),a.push(this.GetByte(SharedDef.INSTANCE_INT_FIELD_3V3_DAY_REWARD,2)),a.push(this.GetByte(SharedDef.INSTANCE_INT_FIELD_3V3_DAY_REWARD,3)),console.log(a),a},b.prototype.getActivityRewardState=function(){for(var a=new Array,b=0;b<SharedDef.MAX_ACTIVE_COUNT;b++){var c=2*b+2;a.push(this.GetBit(SharedDef.INSTANCE_INT_FIELD_ACTIVE_REWARD,c)),a.push(this.GetBit(SharedDef.INSTANCE_INT_FIELD_ACTIVE_REWARD,c+1))}return a},b.prototype.get1v1Records=function(){var a=new Array,b=this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_DOUJIANTAI_CURSOR),c=(b-1)%SharedDef.MAX_DOUJIANTAI_RECORD_COUNT,d=b%SharedDef.MAX_DOUJIANTAI_RECORD_COUNT;d>c&&(c+=SharedDef.MAX_DOUJIANTAI_RECORD_COUNT),console.log(d,c);for(var e=d;c>=e;++e){var f=e%SharedDef.MAX_DOUJIANTAI_RECORD_COUNT,g=this.GetStr(SharedDef.INSTANCE_STR_FIELD_DOUJIANTAI_RECORD_START+f);console.log(g),g&&a.push(g)}return a},b.prototype.getBuyTeamCopyNum=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_GROUP_INSTANCE_BUY_COUNT)},b.prototype.getTeamCopyNum=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_GROUP_INSTANCE_CHALLENGE_COUNT)},b.prototype.getQualifyExtra=function(){for(var a=new Array,b=0;3>b;b++)a.push(this.GetBit(SharedDef.INSTANCE_INT_FIELD_QUALIFY_EXTRA,b));return a},b.prototype.getQualifyExtraPicked=function(){for(var a=new Array,b=0;3>b;b++)a.push(this.GetBit(SharedDef.INSTANCE_INT_FIELD_QUALIFY_EXTRA_PICKED,b));return a},b.prototype.getQualifyDailyTimes=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_QUALIFY_DAILY_TIMES)},b.prototype.getQualifyBuyTimes=function(){return this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_QUALIFY_BUY_TIMES)},b.prototype.getQualify1Log=function(){var a=new Array,b=this.GetUInt32(SharedDef.INSTANCE_INT_FIELD_QUALIFY_CURSOR),c=(b-1)%SharedDef.MAX_QUALIFY_RECORD_COUNT,d=b%SharedDef.MAX_QUALIFY_RECORD_COUNT;d>c&&(c+=SharedDef.MAX_QUALIFY_RECORD_COUNT),console.log(d,c);for(var e=d;c>=e;++e){var f=e%SharedDef.MAX_QUALIFY_RECORD_COUNT,g=this.GetStr(SharedDef.INSTANCE_STR_FIELD_QUALIFY_RECORD_START+f);g&&a.push(g)}return a},b.prototype.getPersonbosstime=function(){for(var a=new Array,b=SharedDef.INSTANCE_INT_FIELD_PRIVATE_BOSS_RECOVER_TIME_START;b<SharedDef.INSTANCE_INT_FIELD_PRIVATE_BOSS_RECOVER_TIME_END;b++)a.push(this.GetUInt32(b));return a},b}(GuidObject),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SocialData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.enemyredstate=!1,b}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this._after_update=function(b,c,d){a.dataUpdate(c,d)},ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.dataUpdate=function(a,b){var c=new Array;for(var d in a){var e=Number(d);if(e>=SharedDef.SOCIAL_FRIEND_START&&e<SharedDef.SOCIAL_APPLY_END){var f=e-SharedDef.SOCIAL_FRIEND_START;f%SharedDef.MAX_FRIENT_COUNT!=0&&e--,-1==c.indexOf(e)&&c.push(e)}}for(var d in b){var e=Number(d);if(e>=SharedDef.SOCIAL_FRIEND_START&&e<SharedDef.SOCIAL_APPLY_END){var f=e-SharedDef.SOCIAL_FRIEND_START;f%SharedDef.MAX_FRIENT_COUNT!=0&&e--,-1==c.indexOf(e)&&c.push(e)}}for(var g=new Object,h=0;h<c.length;h++){var i=this.refreshData(c[h]);g[i]=!0}for(var d in g){var e=Number(d);if(1==e)this._friendList&&this._friendList.length>1&&this.sortList(this._friendList),ModuleEventManager.dispatchEvent(new social.SocialUiEvent(social.SocialUiEvent.REFRESHFRIENDlIST_EVENT)),ModuleEventManager.dispatchEvent(new whisper.WhisperUiEvent(whisper.WhisperUiEvent.REFRESHFRIENDlIST_EVENT));else if(2==e)ModuleEventManager.dispatchEvent(new social.SocialUiEvent(social.SocialUiEvent.REVENGE_PANEL_EVENT));else if(3==e){var j=new social.SocialUiEvent(social.SocialUiEvent.REFRESHAPPLYlIST_EVENT);this._applyList.length>0?j.isvisiable=!0:j.isvisiable=!1,ModuleEventManager.dispatchEvent(j)}}},b.prototype.getItemName=function(a){return this._str_values[a]},b.prototype.getInfo=function(a){return this._str_values[a+1]},b.prototype.refreshData=function(a){var b=!1;if(a<SharedDef.SOCIAL_FRIEND_END){if(!this._friendList)return;for(var c=0;c<this._friendList.length;c++)if(this._friendList[c].index==a){var d=this.getData(a);d?(!this._friendList[c].inOnline&&d.inOnline?console.log("好友："+d.name+"上线了"):this._friendList[c].inOnline&&!d.inOnline&&console.log("好友："+d.name+"下线了"),this._friendList[c]=d):(this._friendList.splice(c,1),b=!0);break}if(c==this._friendList.length&&!b){var e=this.getData(a);e&&this._friendList.push(e)}return 1}if(a<SharedDef.SOCIAL_ENEMY_END){if(!this._enemyList)return;for(var c=0;c<this._enemyList.length;c++)if(this._enemyList[c].index==a){var d=this.getData(a);d?this._enemyList[c]=d:(this._enemyList.splice(c,1),b=!0);break}if(c==this._enemyList.length&&!b){var f=this.getData(a);f&&this._enemyList.push(f),this.enemyredstate=!0,console.log("---列表增加")}return 2}if(a<SharedDef.SOCIAL_APPLY_END){if(!this._applyList)return;for(var c=0;c<this._applyList.length;c++)if(this._applyList[c].index==a){var d=this.getData(a);d?this._applyList[c]=d:(this._applyList.splice(c,1),b=!0);break}if(c==this._applyList.length&&!b){var f=this.getData(a);f&&this._applyList.push(f)}return 3}},b.prototype.traceList=function(a){console.log("--ary-",a);for(var b=0;b<a.length;b++){var c=a[b];console.log("item "+c.index+","+c.guid+","+c.name+",等级"+c.level+","+c.familiayLev+","+c.familiayExp+","+(c.inOnline?"在线":"离线"))}},b.prototype.getData=function(a){if(!this.getItemName(a)||!this.getInfo(a)||""==this.getItemName(a)||""==this.getInfo(a))return null;var b=new SocialItemData;b.id=a,b.index=a,b.guid=this.getItemName(a);var c=this.getInfo(a);console.log("==infoStr==",c);var d=c.split("");return b.name=d[0],b.faction=d[1],b.gender=this.GetByte(a,0),b.vip=this.GetByte(a,1),b.level=this.GetUInt16(a,1),b.familiayExp=this.GetUInt16(a+1,0),b.familiayLev=this.GetByte(a+1,2),b.inOnline=1==this.GetByte(a+1,3)?!0:!1,b.force=this.GetDouble(a+2),b},b.prototype.sortList=function(a){a.sort(function(a,b){return a.inOnline&&!b.inOnline?-1:!a.inOnline&&b.inOnline?1:a.inOnline&&b.inOnline?a.familiayLev>b.familiayLev?-1:a.familiayLev==b.familiayLev?a.familiayExp>b.familiayExp?-1:1:void 0:0})},b.prototype.getFriendList=function(){if(this._friendList)return this._friendList;for(var a=new Array,b=Math.min(this._str_values.length,SharedDef.SOCIAL_FRIEND_END),c=SharedDef.SOCIAL_FRIEND_START;b>c;c+=SharedDef.MAX_FRIENT_COUNT){var d=this.getData(c);d&&a.push(d)}return this.sortList(a),this._friendList=a,this._friendList},b.prototype.getApplyList=function(){if(!this._applyList){for(var a=new Array,b=Math.min(this._str_values.length,SharedDef.SOCIAL_APPLY_END),c=SharedDef.SOCIAL_APPLY_START;b>c;c+=SharedDef.MAX_FRIENT_COUNT){var d=this.getData(c);d&&a.push(d)}this._applyList=a}return this._applyList},b.prototype.getApplyFlag=function(){return this.GetUInt32(SharedDef.SOCIAL_APPLY_CLEAR_FLAG)},b.prototype.getEnemyList=function(){if(this._enemyList)return this._enemyList;for(var a=new Array,b=Math.min(this._str_values.length,SharedDef.SOCIAL_ENEMY_END),c=SharedDef.SOCIAL_ENEMY_START;b>c;c+=SharedDef.MAX_FRIENT_COUNT){var d=this.getData(c);d&&a.push(d)}return this.sortList(a),this._enemyList=a,this._enemyList},b}(GuidObject),SocialItemData=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),FactionData=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._playerIdentity=-1,b._goldDonation=0,b._ybDonation=0,b}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this.AddListen(SharedDef.FACTION_INT_FIELD_TOKEN_NUM,function(b){a.bossTokenNum()}),this.AddListen(SharedDef.FACTION_INT_FIELD_TOKEN_POINTS,function(b){a.bossTokenPoints()}),this.AddListen(SharedDef.FACTION_INT_FIELD_TOKEN_POINTS_COUNT,function(b){a.bossTokenPointscount()}),this.AddListen(SharedDef.FACTION_INT_FIELD_TOKEN_TODAY_BUY_COUNT,function(b){a.bossTokentodaybuycount()}),this.AddListen(SharedDef.FACTION_INT_FIELD_CHALLENGE_BOSS_ID_MAX,function(b){a.bosschallengeidMax()}),this.AddListen(SharedDef.FACTION_INT_FIELD_CHALLENGE_BOSS_ID,function(b){a.bosschallengeidCur()}),this.AddListen(SharedDef.FACTION_INT_FIELD_BUILDING_LVUP_ID,function(b){a.buildCur()}),this.AddListen(SharedDef.FACTION_INT_FIELD_BUILDING_LVUP_FINISH_TIME,function(b){a.buildEnd()}),this.AddListen(SharedDef.FACTION_INT_FIELD_TOWER_TODAY_TOP_FLOOR,function(b){a.tripFloorChg()});this.getFactionList(),this.getApplyList(),this.getEventList(),this.getShopList();this._after_update=function(b,c,d){a.dataUpdate(c,d)},ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.JOINFACTIONITEM_EVENT))},b.prototype.getFactionStorehouse=function(){for(var a=new Array,b=SharedDef.FACTION_STRING_FIELD_STOREHOUSE_START;b<SharedDef.FACTION_STRING_FIELD_STOREHOUSE_END;b++){var c=this.GetStr(b);if(c.length){var d=BagData.paserItemData(c);d.pos=b-SharedDef.FACTION_STRING_FIELD_STOREHOUSE_START,a.push(d)}else a.push(null)}return a},b.prototype.getFactionStorehouseLog1111=function(){for(var a=new Array,b=SharedDef.FACTION_STRING_FIELD_STOREHOUSE_RECORD_START;b<SharedDef.FACTION_STRING_FIELD_STOREHOUSE_RECORD_END;b++){var c=this.GetStr(b);c.length&&(console.log(c),a.push(c))}return a},b.prototype.getFactionStorehouseLog=function(){var a=new Array,b=this.GetUInt32(SharedDef.FACTION_INT_FIELD_STOREHOUSE_RECORD_CURSOR),c=(b-1)%SharedDef.MAX_FACTION_STOREHOUSE_RECORD_COUNT,d=b%SharedDef.MAX_FACTION_STOREHOUSE_RECORD_COUNT;d>c&&(c+=SharedDef.MAX_FACTION_STOREHOUSE_RECORD_COUNT);for(var e=d;c>=e;++e){var f=e%SharedDef.MAX_FACTION_STOREHOUSE_RECORD_COUNT,g=this.GetStr(SharedDef.FACTION_STRING_FIELD_STOREHOUSE_RECORD_START+f);g&&g.length&&a.push(g)}return a},b.prototype.dispose=function(){GuidData.faction=null,ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.FACTION_QUIT_EVENT)),a.prototype.dispose.call(this)},b.prototype.traceList=function(a){for(var b=["族长","副族长","长老","精英","群众"],c=0;c<a.length;c++){var d=a[c];console.log("成员："+d.name+" idx:"+d.index+" 职位："+b[d.identity-1]+" 历史贡献："+d.contribution+" 最后登录时间："+d.logoutTime+(d.isOnline?"在线":"离线"))}console.log("-------------------------")},b.prototype.traceEvtList=function(a){for(var b=0;b<a.length;b++){var c=a[b];console.log(c.name+" 捐献方式:"+c.type+" 捐献数量："+c.value)}console.log("-------------------------")},b.prototype.traceShopList=function(a){for(var b=0;b<a.length;b++){var c=a[b];console.log("商品id："+c.id+" 数量:"+c.num)}console.log("-------------------------")},b.prototype.dataUpdate=function(a,b){var c=new Array,d=new Array,e=new Array,f=new Array,g=new Array,h=new Array;for(var i in a){var j=Number(i);if(j>=SharedDef.FACTION_INT_FIELD_PLAYER&&j<SharedDef.FACTION_INT_FIELD_PLAYER_END){var k=j-(j-SharedDef.FACTION_INT_FIELD_PLAYER)%SharedDef.MAX_FACTION_INT_MEMBER;this.pushList(c,k)}else if(j>=SharedDef.FACTION_INT_FIELD_APPLY_PLAYER&&j<SharedDef.FACTION_INT_FIELD_APPLY_PLAYER_END){var k=j-(j-SharedDef.FACTION_INT_FIELD_APPLY_PLAYER)%SharedDef.MAX_FACTION_INT_MEMBER;this.pushList(d,k)}else if(j>=SharedDef.FACTION_INT_FIELD_EVENT&&j<SharedDef.FACTION_INT_FIELD_EVENT_END){var k=float2int((j-SharedDef.FACTION_INT_FIELD_EVENT)/SharedDef.MAX_FACTION_INT_EVENT);this.pushList(e,k)}else j>=SharedDef.FACTION_INT_FIELD_SHOP&&j<SharedDef.FACTION_INT_FIELD_SHOP_END?f.push(j):j==SharedDef.FACTION_INT_FIELD_MONEY?ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONMONEY_EVENT)):j==SharedDef.FACTION_INT_FIELD_LEVEL?ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONLEV_EVENT)):j>=SharedDef.FACTION_INT_FIELD_GIFT_WEEK_POINT_START&&j<SharedDef.FACTION_INT_FIELD_GIFT_WEEK_POINT_END||(j>=SharedDef.FACTION_INT_FIELD_BOSSDENFENSE_START&&j<SharedDef.FACTION_INT_FIELD_BOSSDENFENSE_END?this.leadChange():j>=SharedDef.FACTION_INT_FIELD_BUILDING_ID_START&&j<SharedDef.FACTION_INT_FIELD_BUILDING_ID_END&&this.buildChange())}for(var i in b){var j=Number(i);if(j==SharedDef.FACTION_STRING_FIELD_GONGGAO){var l=this.getNotice();l.split("");ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONGG_EVENT))}else if(j>=SharedDef.FACTION_STRING_FIELD_PLAYER&&j<SharedDef.FACTION_STRING_FIELD_PLAYER_END){var k=float2int((j-SharedDef.FACTION_STRING_FIELD_PLAYER)/SharedDef.MAX_FACTION_STRING_MEMBER)*SharedDef.MAX_FACTION_INT_MEMBER+SharedDef.FACTION_INT_FIELD_PLAYER;this.pushList(c,k)}else if(j>=SharedDef.FACTION_STRING_FIELD_APPLY_PLAYER&&j<SharedDef.FACTION_STRING_FIELD_APPLY_PLAYER_END){var k=float2int((j-SharedDef.FACTION_STRING_FIELD_APPLY_PLAYER)/SharedDef.MAX_FACTION_STRING_MEMBER)*SharedDef.MAX_FACTION_INT_MEMBER+SharedDef.FACTION_INT_FIELD_APPLY_PLAYER;this.pushList(d,k)}else j>=SharedDef.FACTION_STRING_FIELD_STOREHOUSE_START&&j<SharedDef.FACTION_STRING_FIELD_STOREHOUSE_END?g.push(j):j>=SharedDef.FACTION_STRING_FIELD_STOREHOUSE_RECORD_START&&j<SharedDef.FACTION_STRING_FIELD_STOREHOUSE_RECORD_END&&h.push(j)}g.length&&(console.log("仓库发生变化"),ModuleEventManager.dispatchEvent(new warehousetreasure.WarehouseEvent(warehousetreasure.WarehouseEvent.WAREHOUSE_BAG_REFRESH))),h.length&&(console.log("记录发生变化"),ModuleEventManager.dispatchEvent(new warehousetreasure.WarehouseEvent(warehousetreasure.WarehouseEvent.WAREHOUSE_LOG_REFRESH))),c.length&&(this.factionListChg(c),ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONITEM_EVENT))),d.length&&(this.applyListChg(d),ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONITEMAPPLY_EVENT))),e.length&&(this.evtListChg(e),ModuleEventManager.dispatchEvent(new warehousetreasure.WarehouseEvent(warehousetreasure.WarehouseEvent.TREASURE_LOG_REFRESH))),f.length&&(this.shopChg(f),ModuleEventManager.dispatchEvent(new store.StoreEvent(store.StoreEvent.STORE_NUM_EVENT)));this.getFactionList(),this.getApplyList(),this.getEventList(),this.getShopList()},b.prototype.pushList=function(a,b){-1==a.indexOf(b)&&a.push(b)},b.prototype.factionListChg=function(a){for(var b=0;b<a.length;b++){for(var c=this._factionList.length-1;c>=0;c--)if(this._factionList[c].index==a[b]){var d=this.getData(a[b],this.baseIdxint2str(a[b]));d?this._factionList[c]=d:this._factionList.splice(c,1);break}if(-1==c){var d=this.getData(a[b],this.baseIdxint2str(a[b]));d&&this._factionList.push(d)}}},b.prototype.applyListChg=function(a){for(var b=0;b<a.length;b++){for(var c=this._applyList.length-1;c>=0;c--)if(this._applyList[c].index==a[b]){var d=this.getData(a[b],this.applyIdxint2str(a[b]));d?this._applyList[c]=d:this._applyList.splice(c,1);break}if(-1==c){var d=this.getData(a[b],this.applyIdxint2str(a[b]));d&&this._applyList.push(d)}}},b.prototype.evtListChg=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=this.getEventData(c);d&&(this._eventList[c]=d)}},b.prototype.shopChg=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=a[b]-SharedDef.FACTION_INT_FIELD_SHOP,e=this.getShopData(c);e?this._shopList[d]=e:this._shopList[d]&&this._shopList.splice(d,1)}},b.prototype.getLev=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_LEVEL)},b.prototype.getMoney=function(){return this.GetDouble(SharedDef.FACTION_INT_FIELD_MONEY)},b.prototype.getNotice=function(){return this.GetStr(SharedDef.FACTION_STRING_FIELD_GONGGAO)},b.prototype.getIcon=function(){return this.GetByte(SharedDef.FACTION_INT_FIELD_FLAGS_ID,0)},b.prototype.getAutoJoin=function(){return this.GetBit(SharedDef.FACTION_INT_FIELD_FLAG,SharedDef.FACTION_FLAGS_AUTO)},b.prototype.getJoinLimtLev=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_MINLEV)},b.prototype.getZhaomuGG=function(){return this.GetStr(SharedDef.FACTION_STRING_FIELD_ZHAOMU_GONGGAO)},b.prototype.getManagerName=function(){return this.GetStr(SharedDef.FACTION_STRING_FIELD_MANGER_NAME)},b.prototype.getManagerGuid=function(){return this.GetStr(SharedDef.FACTION_STRING_FIELD_MANGER_GUID)},b.prototype.getActive=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_ACTIVITY)},b.prototype.getFactionForce=function(){return this.GetDouble(SharedDef.FACTION_INT_FIELD_TOTAL_FORCE)},b.prototype.getFactionList=function(){if(this._factionList)return this._factionList;this._factionList=new Array;for(var a=SharedDef.FACTION_INT_FIELD_PLAYER;a<SharedDef.FACTION_INT_FIELD_PLAYER_END;a+=SharedDef.MAX_FACTION_INT_MEMBER){var b=this.baseIdxint2str(a),c=this.getData(a,b);c&&this._factionList.push(c)}return this._factionList},b.prototype.getFactionListSortDuty=function(a){var b=this.getFactionList();return b.sort(function(b,c){return a?c.identity-b.identity:b.identity-c.identity}),b},b.prototype.getFactionListSortActive=function(a){var b=this.getFactionList();return b.sort(function(b,c){return a?c.active-b.active:b.active-c.active}),b},b.prototype.getFactionListSortContribution=function(a){var b=this.getFactionList();return b.sort(function(b,c){return a?b.contribution-c.contribution:c.contribution-b.contribution}),b},b.prototype.getFactionListSortForce=function(a){var b=this.getFactionList();return b.sort(function(b,c){return a?b.force-c.force:c.force-b.force}),b},b.prototype.getFactionListSortLevel=function(a){var b=this.getFactionList();return b.sort(function(b,c){return a?b.level-c.level:c.level-b.level}),b},b.prototype.getFactionListBySortType=function(a,b){var c;switch(a){case 0:c=this.getFactionListSortDuty(b);break;case 1:c=this.getFactionListSortLevel(b);break;case 2:c=this.getFactionListSortForce(b);break;case 3:c=this.getFactionListSortContribution(b);break;case 4:c=this.getFactionListSortActive(b)}return c},b.prototype.baseIdxint2str=function(a){return(a-SharedDef.FACTION_INT_FIELD_PLAYER)/SharedDef.MAX_FACTION_INT_MEMBER*SharedDef.MAX_FACTION_STRING_MEMBER+SharedDef.FACTION_STRING_FIELD_PLAYER},b.prototype.applyIdxint2str=function(a){return(a-SharedDef.FACTION_INT_FIELD_APPLY_PLAYER)/SharedDef.MAX_FACTION_INT_MEMBER*SharedDef.MAX_FACTION_STRING_MEMBER+SharedDef.FACTION_STRING_FIELD_APPLY_PLAYER},b.prototype.getApplyList=function(){if(this._applyList)return this._applyList;this._applyList=new Array;for(var a=SharedDef.FACTION_INT_FIELD_APPLY_PLAYER;a<SharedDef.FACTION_INT_FIELD_APPLY_PLAYER_END;a+=SharedDef.MAX_FACTION_INT_MEMBER){var b=this.applyIdxint2str(a),c=this.getData(a,b);c&&this._applyList.push(c)}return this._applyList},b.prototype.getEventList=function(){if(this._eventList)return this._eventList;this._eventList=new Array;for(var a=SharedDef.FACTION_INT_FIELD_EVENT;a<SharedDef.FACTION_INT_FIELD_EVENT_END;a+=SharedDef.MAX_FACTION_INT_EVENT){var b=float2int((a-SharedDef.FACTION_INT_FIELD_EVENT)/SharedDef.MAX_FACTION_INT_EVENT),c=this.getEventData(b);c&&this._eventList.push(c)}return this._eventList},b.prototype.getEventFlag=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_EVENT_FALG)},b.prototype.getShopList=function(){if(this._shopList)return this._shopList;this._shopList=new Array;for(var a=SharedDef.FACTION_INT_FIELD_SHOP;a<SharedDef.FACTION_INT_FIELD_SHOP_END;a++){var b=this.getShopData(a);b&&this._shopList.push(b)}return this._shopList},b.prototype.getShopData=function(a){var b=this.GetUInt16(a,0);if(0==b)return null;var c=new FactionShopData;return c.id=b,c.num=this.GetUInt16(a,1),c},b.prototype.getEventData=function(a){var b=SharedDef.FACTION_STRING_FIELD_EVENT+a,c=this.GetStr(b);if(!c||""==c)return null;var d=new FactionEventData;d.name=c;var e=SharedDef.FACTION_INT_FIELD_EVENT+a*SharedDef.MAX_FACTION_INT_EVENT;return d.type=this.GetUInt16(e,0),
d.value=this.GetUInt16(e,1),d},Object.defineProperty(b.prototype,"playerIdentity",{get:function(){return this._playerIdentity},set:function(a){this._playerIdentity=a,ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONIDENTITY_EVENT))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"goldDonation",{get:function(){return this._goldDonation},set:function(a){this._goldDonation=a,ModuleEventManager.dispatchEvent(new warehousetreasure.WarehouseEvent(warehousetreasure.WarehouseEvent.TREASURE_NUM_REFRESH))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ybDonation",{get:function(){return this._ybDonation},set:function(a){this._ybDonation=a,ModuleEventManager.dispatchEvent(new warehousetreasure.WarehouseEvent(warehousetreasure.WarehouseEvent.TREASURE_NUM_REFRESH))},enumerable:!0,configurable:!0}),b.prototype.getData=function(a,b){var c=this.GetStr(b+SharedDef.FACTION_STRING_MEMBER_GUID);if(!c||""==c)return null;var d=new FactionItemData;return d.force=this.GetDouble(a+SharedDef.FACTION_INT_MEMBER_FORCE),d.level=this.GetUInt16(a+SharedDef.FACTION_INT_MEMBER_UINT16,0),d.isOnline=1==this.GetByte(a+SharedDef.FACTION_INT_MEMBER_BYTE,0)?!0:!1,d.identity=this.GetByte(a+SharedDef.FACTION_INT_MEMBER_BYTE,1),d.vipLev=this.GetByte(a+SharedDef.FACTION_INT_MEMBER_BYTE,2),d.logoutTime=this.GetUInt32(a+SharedDef.FACTION_INT_MEMBER_LOGOUT_TIME),d.active=this.GetUInt32(a+SharedDef.FACTION_INT_MEMBER_FLAGS),d.contribution=this.GetUInt32(a+SharedDef.FACTION_INT_MEMBER_TOTAL_CONTRIBUTION),d.guid=c,c==GuidData.player.guid&&(this.playerIdentity=d.identity,this.goldDonation=this.GetByte(a+SharedDef.FACTION_INT_MEMBER_UINT16,2),this.ybDonation=this.GetByte(a+SharedDef.FACTION_INT_MEMBER_UINT16,3)),d.name=this.GetStr(b+SharedDef.FACTION_STRING_MEMBER_NAME),d.index=a,d},b.prototype.bossTokenNum=function(){console.log("--令牌数目变化--"),ModuleEventManager.dispatchEvent(new faction.FactionBossEvent(faction.FactionBossEvent.CHANGE_BOSS_CURRENTNUM)),ModuleEventManager.dispatchEvent(new faction.FactionBossEvent(faction.FactionBossEvent.BOSS_NEED_REDPOINT))},b.prototype.getBossTokenNum=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_TOKEN_NUM)},b.prototype.bossTokenPoints=function(){console.log("--令牌今日积分进度--"),ModuleEventManager.dispatchEvent(new faction.FactionBossEvent(faction.FactionBossEvent.CHANGE_BOSS_INTEGRAL))},b.prototype.getBossTokenPoints=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_TOKEN_POINTS)},b.prototype.bossTokenPointscount=function(){console.log("--令牌今日积分完成次数--"),ModuleEventManager.dispatchEvent(new faction.FactionBossEvent(faction.FactionBossEvent.CHANGE_BOSS_RESIDUE))},b.prototype.getBossTokenPointscount=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_TOKEN_POINTS_COUNT)},b.prototype.bossTokentodaybuycount=function(){console.log("--今日令牌购买次数--")},b.prototype.getBossTokentodaybuycount=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_TOKEN_TODAY_BUY_COUNT)},b.prototype.bosschallengeidMax=function(){console.log("--已挑战最大boss id--")},b.prototype.getBosschallengeidMax=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_CHALLENGE_BOSS_ID_MAX)},b.prototype.bosschallengeidCur=function(){console.log("--当前挑战boss id--"),ModuleEventManager.dispatchEvent(new faction.FactionBossEvent(faction.FactionBossEvent.CHANGE_BOSS_CURRENTID))},b.prototype.getBosschallengeidCur=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_CHALLENGE_BOSS_ID)},b.prototype.getBosschallengeStartTime=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_CHALLENGE_BOSS_START_TIME)},b.prototype.getRankList=function(){for(var a=new Array,b=0;b<SharedDef.MAX_FACTION_MAMBER_COUNT;b++){var c=this.GetStr(SharedDef.FACTION_STRING_FIELD_CHALLENGE_BOSS_DAMAGE_RANK_START+b);if(c.length>0){var d=new FactionBossRankData;d.guid=c,d.output=this.GetUInt32(SharedDef.FACTION_INT_FIELD_CHALLENGE_BOSS_DAMAGE_RANK_START+b),a.push(d)}}return a.sort(function(a,b){return b.output-a.output}),a},b.prototype.buildCur=function(){console.log("--当前正在升级的建筑id--"),ModuleEventManager.dispatchEvent(new faction.FactionBuildEvent(faction.FactionBuildEvent.BUILD_STATE))},b.prototype.getBuildCur=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_BUILDING_LVUP_ID)},b.prototype.buildEnd=function(){console.log("--完成时间--"),ModuleEventManager.dispatchEvent(new faction.FactionBuildEvent(faction.FactionBuildEvent.BUILD_ENDTIME))},b.prototype.getBuildEndTime=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_BUILDING_LVUP_FINISH_TIME)},b.prototype.getHaveBuild=function(){for(var a=new Array,b=SharedDef.FACTION_INT_FIELD_BUILDING_ID_START;b<SharedDef.FACTION_INT_FIELD_BUILDING_ID_END;b++)a.push(this.GetUInt32(b));return a},b.prototype.buildChange=function(){ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.FUNBUILD_CHG_EVENT))},b.prototype.getWeekRankGiftList=function(){for(var a=new Array,b=SharedDef.FACTION_STRING_FIELD_GIFT_PLAYER_GUID_START;b<SharedDef.FACTION_STRING_FIELD_GIFT_PLAYER_GUID_END;b++){var c=SharedDef.FACTION_INT_FIELD_GIFT_WEEK_POINT_START+(b-SharedDef.FACTION_STRING_FIELD_GIFT_PLAYER_GUID_START),d=this.GetUInt32(c),e=this.GetStr(b);if(0!=d&&e&&e.length>0){var f=this.getInfomation(e);f.point=d,a.push(f)}}return a.sort(function(a,b){return b.point-a.point}),a},b.prototype.getInfomation=function(a){for(var b=this.getFactionList(),c=0;c<b.length;c++)if(b[c].guid==a)return b[c];return null},b.prototype.Giftflag=function(){console.log("--当前正在升级的建筑id--"),ModuleEventManager.dispatchEvent(new faction.FactionBuildEvent(faction.FactionBuildEvent.BUILD_STATE))},b.prototype.getGiftflag=function(){return this.GetUInt32(SharedDef.FACTION_INT_FIELD_BUILDING_LVUP_ID)},b.prototype.getLeaderData=function(){if(this._listAry)return this._listAry;this._listAry=new Array;for(var a=0,b=SharedDef.FACTION_INT_FIELD_BOSSDENFENSE_START;b<SharedDef.FACTION_INT_FIELD_BOSSDENFENSE_END;b+=SharedDef.MAX_FACTION_BOSSDEFENSE){var c=new FactionLeadData;c.idx=a,c.id=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_POOL_ID),c.hp=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_HP),c.maxHp=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_MAX_HP),c.state=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_STATUS),c.pool=TableData.getInstance().getData(TableData.tb_faction_bossdefense_pool,c.id),c.boos=tb.TB_creature_template.get_TB_creature_template(c.pool.entry),this._listAry.push(c),a++}return this._listAry},b.prototype.leadChange=function(){if(this._listAry){for(var a=0,b=SharedDef.FACTION_INT_FIELD_BOSSDENFENSE_START;b<SharedDef.FACTION_INT_FIELD_BOSSDENFENSE_END;b+=SharedDef.MAX_FACTION_BOSSDEFENSE){var c=this._listAry[a],d=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_POOL_ID);d!=c.id&&(c.id=d,c.pool=TableData.getInstance().getData(TableData.tb_faction_bossdefense_pool,c.id),c.boos=tb.TB_creature_template.get_TB_creature_template(c.pool.entry)),c.id=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_POOL_ID),c.hp=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_HP),c.maxHp=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_MAX_HP),c.state=this.GetUInt32(b+SharedDef.FACTION_INT_BOSSDEFENSE_STATUS),a++}ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONACTIVE_LEAD_CHANGE_EVENT))}},b.prototype.getTripNum=function(a){for(var b=0,c=SharedDef.FACTION_INT_FIELD_PLAYER;c<SharedDef.FACTION_INT_FIELD_PLAYER_END;c+=SharedDef.MAX_FACTION_INT_MEMBER){var d=this.GetUInt32(c+SharedDef.FACTION_INT_MEMBER_TOWER_TODAY_FLOOR);d>=a&&b++}return b},b.prototype.getMaxTripRole=function(){var a=new Object;return a.name=this.GetStr(SharedDef.FACTION_STRING_FIELD_TOWER_TODAY_TOP_NAME),a.icon=this.GetUInt32(SharedDef.FACTION_INT_FIELD_TOWER_TODAY_TOP_ICON),a.floor=this.GetUInt32(SharedDef.FACTION_INT_FIELD_TOWER_TODAY_TOP_FLOOR),a.force=this.GetDouble(SharedDef.FACTION_INT_FIELD_TOWER_TODAY_TOP_FORCE),a},b.prototype.tripFloorChg=function(){ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONACTIVE_TRIP_CHANGE_EVENT))},b}(GuidObject),FactionItemData=function(){function a(){this.force=0,this.level=0,this.isOnline=!1,this.identity=0,this.logoutTime=0,this.vipLev=0,this.active=0,this.contribution=0}return a}(),FactionEventData=function(){function a(){}return a}(),FactionShopData=function(){function a(){}return a}(),FactionBossRankData=function(){function a(){}return a}(),FactionLeadData=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),GlobelValueData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this.AddListen(SharedDef.GLOBALVALUE_INT_FIELD_WORLD_BOSS_STATE,function(a){ModuleEventManager.dispatchEvent(new sboss.SbossEvent(sboss.SbossEvent.WBOSS_STATE_CHG))}),this._after_update=function(b,c,d){a.dataUpdate(c,d)},ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.getWorldBossId=function(){var a=SharedDef.GLOBALVALUE_INT_FIELD_WORLD_BOSS_ID,b=this.GetByte(a,0),c=this.GetByte(a,1);this.GetByte(a,2),this.GetByte(a,3);return[b,c]},b.prototype.dataUpdate=function(a,b){var c=!1,d=!1;for(var e in a){var f=Number(e);f>=SharedDef.GLOBALVALUE_INT_FIELD_MASS_BOSS_START&&f<SharedDef.GLOBALVALUE_INT_FIELD_MASS_BOSS_START+SharedDef.MAX_MASS_BOSS_INT_FIELD_COUNT*SharedDef.MAX_MASS_BOSS_COUNT?c=!0:f>=SharedDef.GLOBALVALUE_INT_FIELD_LOTTERY_RECORD_CURSOR_START&&f<SharedDef.GLOBALVALUE_INT_FIELD_LOTTERY_RECORD_CURSOR_END&&(d=!0)}d&&ModuleEventManager.dispatchEvent(new ActiveEvent(ActiveEvent.ACTIVE_GLOBEL_CHOUJIANG_EVENT)),c&&ModuleEventManager.dispatchEvent(new sboss.SbossEvent(sboss.SbossEvent.REFRISH_LIST_DATA))},b.prototype.getXianfuRecords=function(){var a=new Array,b=this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_XIANFU_RECORD_CURSOR),c=(b-1)%SharedDef.MAX_XIANFU_RECORD_COUNT,d=b%SharedDef.MAX_XIANFU_RECORD_COUNT;d>c&&(c+=SharedDef.MAX_XIANFU_RECORD_COUNT),console.log(d,c);for(var e=d;c>=e;++e){var f=e%SharedDef.MAX_XIANFU_RECORD_COUNT,g=this.GetStr(SharedDef.GLOBALVALUE_STRING_FIELD_XIANFU_RECORD_START+f);g&&g.length&&a.push(g)}return a},b.prototype.getCurrentBossInfo=function(){var a=this.getBossIndex(GuidData.map.getMapID(),GuidData.map.getLineID());return this.getBaseBossInfo(a)},b.prototype.getBossInfo=function(a,b){var c=this.getBossIndex(a,b);return this.getBaseBossInfo(c)},b.prototype.getFieldMassBoss=function(a){var b=SharedDef.GLOBALVALUE_INT_FIELD_MASS_BOSS_START+SharedDef.MAX_MASS_BOSS_INT_FIELD_COUNT*a,c=this.GetUInt32(b+SharedDef.MASS_BOSS_STATE),d=this.GetUInt32(b+SharedDef.MASS_BOSS_TIME);return{state:c,time:d}},b.prototype.getMoneyChangeMassBossBuyTimes=function(){return this.GetUInt32(SharedDef.MONEY_CHANGE_MASS_BOSS_BUY_TIMES)},b.prototype.getWorldBossState=function(){var a=SharedDef.GLOBALVALUE_INT_FIELD_WORLD_BOSS_STATE;return this.GetUInt32(a)},b.prototype.getBossIndex=function(a,b){var c=TableData.getInstance().getData(TableData.tb_map_field_boss,a),d=c.indx;return d*SharedDef.MAX_DEFAULT_LINE_COUNT+b-1},b.prototype.getBaseBossInfo=function(a){var b=this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_FIELD_BOSS_START+a*SharedDef.MAX_FIELD_BOSS_INT_DATA_COUNT+SharedDef.FIELD_BOSS_DATA_PRIORITY_TIME),c=this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_FIELD_BOSS_START+a*SharedDef.MAX_FIELD_BOSS_INT_DATA_COUNT+SharedDef.FIELD_BOSS_DATA_NEXT_BORN_TIME),d=this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_FIELD_BOSS_START+a*SharedDef.MAX_FIELD_BOSS_INT_DATA_COUNT+SharedDef.FIELD_BOSS_DATA_PROCESS_TYPE),e=this.GetStr(SharedDef.GLOBALVALUE_STRING_FIELD_FIELD_BOSS_START+a*SharedDef.MAX_FIELD_BOSS_STR_DATA_COUNT+SharedDef.FIELD_BOSS_DATA_MAX_DAMAGE_GUID),f=this.GetStr(SharedDef.GLOBALVALUE_STRING_FIELD_FIELD_BOSS_START+a*SharedDef.MAX_FIELD_BOSS_STR_DATA_COUNT+SharedDef.FIELD_BOSS_DATA_NAME);return console.log("----111---",{time:b,refreshTime:c,type:d,owner:e,name:f}),{time:b,refreshTime:c,type:d,owner:e,name:f}},b.prototype.getQueenChampion=function(){var a=this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_GIFT_RANK_WINER_FACTION_FLAG),b=this.GetStr(SharedDef.GLOBALVALUE_STRING_FIELD_GIFT_RANK_WINER_QUEEN_NAME),c=this.GetStr(SharedDef.GLOBALVALUE_STRING_FIELD_GIFT_RANK_WINER_GUARD_NAME);return{img:a,queen:b,qs:c}},b.prototype.getQueenRankRound=function(){return this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_GIFT_RANK_CUR_ROUND)},b.prototype.getQueenRankTime=function(){return this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_GIFT_RANK_NEXT_UPDATE_TIME)},b.prototype.getActiveList=function(){for(var a=new Array,b=SharedDef.GLOBALVALUE_INT_FIELD_ACTIVITIES_RUNNING_START;b<SharedDef.GLOBALVALUE_INT_FIELD_ACTIVITIES_RUNNING_END;b++){var c=this.GetUInt32(b);c>0&&a.push(c)}return a},b.prototype.getKaiFuActiveList=function(){for(var a=new Array,b=this.getActiveList(),c=0;c<b.length;c++){var d=TableData.getInstance().getData(TableData.tb_activity_time,b[c]);1==d.type&&a.push(b[c])}return a},b.prototype.getLotteryRecord=function(a){var b=new Array;a--;for(var c=this.GetUInt32(SharedDef.GLOBALVALUE_INT_FIELD_LOTTERY_RECORD_CURSOR_START+a),d=SharedDef.GLOBALVALUE_STRING_FIELD_LOTTERY_RECORD_START+a*SharedDef.MAX_LOTTERY_RECORD_COUNT,e=d+c,f=d+SharedDef.MAX_LOTTERY_RECORD_COUNT,g=e;f>g;++g){var h=this.GetStr(g);h&&b.push(h)}for(var g=d;e>g;++g){var h=this.GetStr(g);h&&b.push(h)}return b.reverse()},b}(GuidObject),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),RankData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getRankGuid=function(){return this.GetStr(SharedDef.RANK_LIST_CURRENT_OBJ_STR_FIELD_PLAYER_GUID)},b.prototype.getRankName=function(){return this.GetStr(SharedDef.RANK_LIST_CURRENT_OBJ_STR_FIELD_PLAYER_NAME)},b.prototype.getRankFaction=function(){return this.GetStr(SharedDef.RANK_LIST_CURRENT_OBJ_STR_FIELD_FACTION_NAME)},b.prototype.getRankPower=function(){return this.GetDouble(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_FORCE)},b.prototype.getRankCoat=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_SHOW)},b.prototype.getRankWeapon=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_SHOW+1)},b.prototype.getRankVip=function(){return this.GetByte(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE,2)},b.prototype.getRankGender=function(){return this.GetByte(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE,0)},b.prototype.getLevel=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_LEVEL)},b.prototype.getMoney=function(){return this.GetDouble(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_MONEY)},b.prototype.getDivineNum=function(){return this.GetByte(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE,2)},b.prototype.getFactionActive=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE2)},b.prototype.getFactionIcon=function(){return this.GetUInt16(SharedDef.RANK_LIST_INT_FIELD_FACTION_BYTE,0)},b.prototype.getRank=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_RANKING)},b.prototype.getTitle=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_TITLE)},b.prototype.getMountLev=function(){return this.GetByte(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE2,0)},b.prototype.getMountStart=function(){return this.GetByte(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_BYTE2,1)},b.prototype.getLike=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_LIKE)},b.prototype.getWingId=function(){return this.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_WING)},b}(GuidObject),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),QuestDataVo=function(){function a(){}return a}(),QuestDataMeshVo=function(){function a(){}return a}(),QuestData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this.refreshTitleList(),this._after_update=function(b,c,d){a.dataUpdate(c,d)},ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.dataUpdate=function(a,b){for(var c in a){var d=Number(c);if(d>=SharedDef.QUEST_FIELD_ACHIEVE_START&&d<SharedDef.QUEST_FIELD_ACHIEVE_END){var e=float2int((d-SharedDef.QUEST_FIELD_ACHIEVE_START)/SharedDef.MAX_ACHIEVE_FIELD)+1,f=(d-SharedDef.QUEST_FIELD_ACHIEVE_START)%SharedDef.MAX_ACHIEVE_FIELD;if(f==SharedDef.ACHIEVE_FIELD_REWARD){var g=this.getAchieveInfo(e);if(g.hasReach&&!g.hasReward){g.data=tb.TB_achieve_base.get_TB_achieve_baseById(e);var h=new SceneEvent(SceneEvent.SCENE_NEW_ACHIEVEMENT_EVENT);h.data=g,ModuleEventManager.dispatchEvent(h)}}ModuleEventManager.dispatchEvent(new role.RoleUiEvent(role.RoleUiEvent.Achievement_RECEIVE_EVENT))}else if(d>=SharedDef.QUEST_FIELD_TITLE_START&&d<SharedDef.QUEST_FIELD_TITLE_END){var i,j=d-SharedDef.QUEST_FIELD_TITLE_START,k=j%SharedDef.MAX_TITLE_FIELD;i=k==SharedDef.TITLE_FIELD_TIME?d-1:d;var l=this.getrefreshByidx(i);if(!l)return;var m=this.hasTitleVo(l);if(m){this.titleAry.push(l);var n=tb.TB_title_base.get_TB_title_baseById(l.id),h=new SceneEvent(SceneEvent.SCENE_NEW_DESIGNATION_EVENT);h.data=n,ModuleEventManager.dispatchEvent(h)}else this.refreshTitleList();k==SharedDef.TITLE_FIELD_TIME?ModuleEventManager.dispatchEvent(new role.RoleUiEvent(role.RoleUiEvent.CHANGE_MY_Designation_EVENT)):ModuleEventManager.dispatchEvent(new role.RoleUiEvent(role.RoleUiEvent.INIT_Designation_EVENT))}else if(d==SharedDef.QUEST_FIELD_ACHIEVE_REWARD);else{if(d>=SharedDef.QUEST_FIELD_WELFARE_BACK_START&&d<SharedDef.QUEST_FIELD_WELFARE_BACK_END){ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.GETBACKREWARD_Welfare_EVENT));break}d==SharedDef.QUEST_FIELD_WELFARE_CHECKIN?ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.EveryDayCHECKIN_Welfare_EVENT)):d==SharedDef.QUEST_FIELD_WELFARE_CHECKIN_ALL?ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.ALLCHECKIN_Welfare_EVENT)):d==SharedDef.QUEST_FIELD_WELFARE_LEVEL?ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.RECEIVELEVELREWARD_Welfare_EVENT)):d==SharedDef.QUEST_FIELD_WELFARE_CONSUME_REWARD_FLAG?ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.RECEIVECOSTREWARD_Welfare_EVENT)):d==SharedDef.QUEST_FIELD_WELFARE_RECHARGE_REWARD_FLAG?ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.RECEIVERECHARGEREWARD_Welfare_EVENT)):d==SharedDef.QUEST_FIELD_WELFARE_SEVEN_DAY_FLAG?ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.RECEIVESEVENDAYREWARD_Welfare_EVENT)):d==SharedDef.QUEST_FIELD_WELFARE_SHOUCHONG&&ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.REFRESHTAB_Welfare_EVENT))}}var o=new Object,p=!1;for(var c in a){var d=Number(c);if(d>=SharedDef.QUEST_FIELD_QUEST_START&&d<SharedDef.QUEST_FIELD_QUEST_END){var q=Math.floor((d-SharedDef.QUEST_FIELD_QUEST_START)/SharedDef.MAX_QUEST_INFO_COUNT);o[q]||(o[q]=1,p=!0)}if(d>=SharedDef.QUEST_FIELD_ESCORT_QUEST_START&&d<=SharedDef.QUEST_FIELD_ESCORT_QUEST_END&&(p=!0,this._questDataItem=null),d>=SharedDef.QUEST_FIELD_DAILY2_QUEST_START&&d<SharedDef.QUEST_FIELD_DAILY2_QUEST_END){var q=Math.floor((d-SharedDef.QUEST_FIELD_DAILY2_QUEST_START)/SharedDef.MAX_QUEST_INFO_COUNT);this._dailyQuestDataItem=this.refreshDailyQuestVo(),ModuleEventManager.dispatchEvent(new quest.QuestEvent(quest.QuestEvent.REFRESH_DAILY_QUEST_EVENT)),p=!0}else d==SharedDef.QUEST_FIELD_DAILY2_SUBMIT&&(ModuleEventManager.dispatchEvent(new quest.QuestEvent(quest.QuestEvent.REFRESH_DAILY_QUEST_EVENT)),p=!0);d>=SharedDef.QUEST_FIELD_ADVENTURE_QUEST_START&&d<SharedDef.QUEST_FIELD_ADVENTURE_QUEST_END&&(this._trainingTaskDataItem=this.refreshTrainingTaskList(),ModuleEventManager.dispatchEvent(new training.TrainingEvent(training.TrainingEvent.REFRESH_TRAINING_PANEL)),p=!0),d>=SharedDef.QUEST_FIELD_REALMBREAK_QUEST_START&&d<SharedDef.QUEST_FIELD_REALMBREAK_QUEST_END&&(this._stateupTaskDataItem=this.refreshStateUpTaskList(),stateup.StateUpModel.getInstance().refreshTaskAry(),ModuleEventManager.dispatchEvent(new stateup.StateUpEvent(stateup.StateUpEvent.REFRESH_LIST_PANEL)),p=!0)}for(var r in o)this._questDataItem=null;p&&ModuleEventManager.dispatchEvent(new leftui.LeftUiEvent(leftui.LeftUiEvent.REFRESH_QUEST_EVENT))},b.prototype.hasTitleVo=function(a){for(var b=0;b<this.titleAry.length;b++)if(a.id==this.titleAry[b].id)return!1;return!0},b.prototype.getTaskList=function(){if(!this._questDataItem){this._questDataItem=new Array;for(var a=0;a<SharedDef.MAX_QUEST_INFO_COUNT;a++){var b=this.changeQuestDataByKey(SharedDef.QUEST_FIELD_QUEST_START,a);b&&this._questDataItem.push(b)}var c=this.changeQuestDataByKey(SharedDef.QUEST_FIELD_ESCORT_QUEST_START,0);c&&this._questDataItem.push(c),this._questDataItem.sort(function(a,b){return a.taskState-b.taskState})}return this._questDataItem},b.prototype.getDaliyQuestList=function(){return this._dailyQuestDataItem||(this._dailyQuestDataItem=this.refreshDailyQuestVo()),this._dailyQuestDataItem},b.prototype.refreshDailyQuestVo=function(){for(var a=new Array,b=0;b<SharedDef.MAX_QUEST_INFO_COUNT;b++){var c=this.changeQuestDataByKey(SharedDef.QUEST_FIELD_DAILY2_QUEST_START,b);c&&a.push(c)}return a},b.prototype.getTrainingTaskList=function(){return this._trainingTaskDataItem||(this._trainingTaskDataItem=this.refreshTrainingTaskList()),this._trainingTaskDataItem},b.prototype.refreshTrainingTaskList=function(){for(var a=new Array,b=0;b<SharedDef.MAX_ADVENTURE_QUEST_COUNT;b++){var c=this.changeQuestDataByKey(SharedDef.QUEST_FIELD_ADVENTURE_QUEST_START,b);c&&a.push(c)}return a},b.prototype.getStateUpTaskList=function(){return this._stateupTaskDataItem||(this._stateupTaskDataItem=this.refreshStateUpTaskList()),this._stateupTaskDataItem},b.prototype.refreshStateUpTaskList=function(){for(var a=new Array,b=0;b<SharedDef.MAX_REALMBREAK_QUEST_COUNT;b++){var c=this.changeQuestDataByKey(SharedDef.QUEST_FIELD_REALMBREAK_QUEST_START,b);c&&a.push(c)}return a},b.prototype.changeQuestDataByKey=function(a,b){var c=a+b*SharedDef.MAX_QUEST_INFO_COUNT,d=this.GetUInt16(c+SharedDef.QUEST_INFO_ID,0),e=this.GetUInt16(c+SharedDef.QUEST_INFO_ID,1);if(0!=d){var f=new QuestDataVo;f.id=d,f.indx=b,f.taskState=e,f.items=new Array;for(var g=SharedDef.QUEST_INFO_STEP_START;g<SharedDef.QUEST_INFO_STEP_END;g+=SharedDef.MAX_QUEST_TARGET_INFO_COUNT){var h=c+g,i=this.GetUInt16(h+SharedDef.QUEST_TARGET_INFO_SHORT0,0),j=this.GetUInt16(h+SharedDef.QUEST_TARGET_INFO_SHORT0,1),k=this.GetUInt32(h+SharedDef.QUEST_TARGET_INFO_PROCESS);if(0!=j){var l=new QuestDataMeshVo;l.state=i,l.num=j,l.process=k,f.items.push(l)}}return f}return null},b.prototype.getAchieveInfo=function(a){var b=(a-1)*SharedDef.MAX_ACHIEVE_FIELD+SharedDef.QUEST_FIELD_ACHIEVE_START,c=new AchieveItemData;return c.hasReach=1==this.GetByte(b+SharedDef.ACHIEVE_FIELD_REWARD,1)?!0:!1,c.hasReward=1==this.GetByte(b+SharedDef.ACHIEVE_FIELD_REWARD,0)?!0:!1,c.progress=this.GetUInt32(b+SharedDef.ACHIEVE_FIELD_CURRENT),c.id=a,c},b.prototype.getAchieveAllNum=function(){return this.GetUInt32(SharedDef.QUEST_FIELD_ACHIEVE_ALL)},b.prototype.getAchieveAllRewardID=function(){return this.GetUInt32(SharedDef.QUEST_FIELD_ACHIEVE_REWARD)},b.prototype.IsReceiveShouChongReward=function(){return 1==this.GetUInt32(SharedDef.QUEST_FIELD_WELFARE_SHOUCHONG)},b.prototype.getSigninEveryDayList=function(){for(var a=new Array,b=0;32>b;b++)a.push(this.GetBit(SharedDef.QUEST_FIELD_WELFARE_CHECKIN,b));return a},b.prototype.getSigninEveryDayVoList=function(){for(var a=new Array,b=0;b<this.getcurMonthDays();b++){var c=tb.TB_welfare_checkin.get_TB_welfare_checkinById(b+1),d=new SigninEveryDayItemData;d.data=c;var e=this.GetBit(SharedDef.QUEST_FIELD_WELFARE_CHECKIN,b);e?d.state=3:this.getcurDays()>b+1?d.state=4:this.getcurDays()==b+1?d.state=2:d.state=1,a.push(d)}return a},b.prototype.getcurDays=function(){var a=GameInstance.getServerNow(),b=new Date(1e3*a);return b.getDate()},b.prototype.getLoginDay=function(){return this.GetUInt32(SharedDef.QUEST_FIELD_WELFARE_SEVEN_DAY_PROCESS)},b.prototype.getcurMonthDays=function(){var a=new Date,b=new Date(a.getFullYear(),a.getMonth()+1,0).getDate();return b},b.prototype.getSigninWeekList=function(){for(var a=new Array,b=0;5>b;b++){var c=tb.TB_welfare_checkin_all.get_TB_welfare_checkin_allById(b+1),d=new SigninWeekItemData;d.data=c;var e=this.GetBit(SharedDef.QUEST_FIELD_WELFARE_CHECKIN_ALL,b+1);e?d.state=3:this.getSigninDayNum()>=c.num?d.state=2:d.state=1,a.push(d)}return a},b.prototype.getLevelUpRewardList=function(){for(var a=new Array,b=tb.TB_welfare_level.get_TB_welfare_level(),c=0;c<b.length;c++){var d=new LevelUpRewardItemData;d.data=b[c];var e=this.GetBit(SharedDef.QUEST_FIELD_WELFARE_LEVEL,c);e?d.state=3:GuidData.player.getLevel()>=b[c].lev?d.state=1:d.state=2,a.push(d)}return a.sort(function(a,b){return a.state==b.state?a.data.id<b.data.id?-1:1:a.state<b.state?-1:1}),a},b.prototype.getCostRewardList=function(){for(var a=new Array,b=tb.TB_welfare_consume.get_TB_welfare_consume(),c=0;c<b.length;c++){var d=new CostRewardItemData;d.data=b[c];var e=this.GetBit(SharedDef.QUEST_FIELD_WELFARE_CONSUME_REWARD_FLAG,c);e?d.state=3:GuidData.player.getConsume()>=b[c].money?d.state=1:d.state=2,d.type=SharedDef.MODULE_WELFARE_CONSUME,a.push(d)}return a.sort(function(a,b){return a.state==b.state?a.data.id<b.data.id?-1:1:a.state<b.state?-1:1}),a},b.prototype.getRechargeRewardList=function(){for(var a=new Array,b=tb.TB_welfare_recharge.get_TB_welfare_recharge(),c=0;c<b.length;c++){var d=new RechargeRewardItemData;d.data=b[c];var e=this.GetBit(SharedDef.QUEST_FIELD_WELFARE_RECHARGE_REWARD_FLAG,c);e?d.state=3:GuidData.player.getChongZhiSum()>=b[c].money?d.state=1:d.state=2,d.type=SharedDef.MODULE_WELFARE_RECHARGE,a.push(d)}return a.sort(function(a,b){return a.state==b.state?a.data.id<b.data.id?-1:1:a.state<b.state?-1:1}),a},b.prototype.getSevenDayList=function(){for(var a=new Array,b=tb.TB_welfare_sevengift.get_TB_welfare_sevengift(),c=0;c<b.length;c++){var d=new SevenDayaItemData;d.data=b[c];var e=this.GetBit(SharedDef.QUEST_FIELD_WELFARE_SEVEN_DAY_FLAG,c);e?d.state=0:this.getLoginDay()>=c+1?d.state=1:d.state=2,a.push(d)}return a},b.prototype.getSigninDayNum=function(){for(var a=0,b=this.getSigninEveryDayList(),c=0;c<b.length;c++)b[c]&&a++;return a},b.prototype.getBackList=function(){for(var a=new Array,b=tb.TB_welfare_back.get_TB_welfare_back(),c=0;c<b.length;c++){var d=new RewardBackItemData;d.data=b[c];var e=SharedDef.QUEST_FIELD_WELFARE_BACK_START+SharedDef.WELFA_BACK_ITEM_NUM+c*SharedDef.MAX_WELFA_BACK_ITEM;d.num=this.GetUInt32(e),0==d.num?d.state=2:d.state=1,a.push(d)}return a.sort(function(a,b){return a.state==b.state?a.data.id<b.data.id?-1:1:a.state<b.state?-1:1}),a},b.prototype.getTitleList=function(){return this.titleAry?this.titleAry:(this.titleAry=new Array,this.refreshTitleList(),this.titleAry)},b.prototype.getrefreshByidx=function(a){var b=this.GetUInt16(a,0);if(0!=b){var c=new TitleItemData;return c.id=b,c.init=1==this.GetUInt16(a,1),c.time=this.GetUInt32(a+SharedDef.TITLE_FIELD_TIME),c}return null},b.prototype.refreshTitleList=function(){this.titleAry||(this.titleAry=new Array),this.titleAry.length=0;for(var a=SharedDef.QUEST_FIELD_TITLE_START;a<SharedDef.QUEST_FIELD_TITLE_END;a+=SharedDef.MAX_TITLE_FIELD){var b=this.GetUInt16(a,0);if(0!=b){var c=new TitleItemData;c.id=b,c.init=1==this.GetUInt16(a,1),c.time=this.GetUInt32(a+SharedDef.TITLE_FIELD_TIME),this.titleAry.push(c)}}},b.prototype.traceAchieve=function(a){console.log("成就ID:"+a.id+(a.hasReach?" 已完成":" 未完成")+(a.hasReward?" 已领奖":" 未领奖")+" 当前进度："+a.progress)},b.prototype.traceTitle=function(){console.log("------称号列表_id-----------------",this._id);for(var a=0;a<this.titleAry.length;a++)console.log("------称号列表-----------------",this.titleAry[a].id,this.titleAry[a]),this.titleAry[a].id!=this._id&&(this._id=this.titleAry[a].id)},b.prototype.getDailyQuestCompleteNum=function(){return this.GetUInt32(SharedDef.QUEST_FIELD_DAILY2_FINISHED)},b.prototype.getDailyQuestSubmitState=function(){return this.GetUInt32(SharedDef.QUEST_FIELD_DAILY2_SUBMIT)>0},b}(GuidObject),AchieveItemData=function(){function a(){}return a}(),TitleItemData=function(){function a(){}return a}(),SigninWeekItemData=function(){function a(){}return a}(),SigninEveryDayItemData=function(){function a(){}return a}(),LevelUpRewardItemData=function(){function a(){}return a}(),CostRewardItemData=function(){function a(){}return a}(),RechargeRewardItemData=function(){function a(){}return a}(),SevenDayaItemData=function(){function a(){}return a}(),RewardBackItemData=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),EngineModule=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"EngineModule"},b.prototype.listProcessors=function(){return[new EngineProcessor,new NetBaseProcessor]},b}(Module),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),EngineProcessor=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.coreDataNum=0,b.hasCoreDataInit=!1,b}return __extends(b,a),b.prototype.getName=function(){return"EngineProcessor"},b.prototype.receivedModuleEvent=function(a){var b=a;if(b.type==EngineEvent.CREAT_SCENE_EVENT){GameInstance.threeBattarId=0;var c=b.sceneName;SceneManager.getInstance().loadScene(c,b.sceneLoadcomplteFun,b.sceneProgressFun,b.sceneAnylsizFun)}else b.type==EngineEvent.ENTER_SCENE_EVENT?(GameControlManager.getInstance().init(),this.AnalysisMapData(),this.enterSceneDothing()):b.type==EngineEvent.MAP_INT_FIELD_QUESTS_PROCESS?this.mapIntFieldQuestsProcess():b.type==EngineEvent.CORE_DATA_CREATED_EVENT&&this.addCoreNum()},b.prototype.addCoreNum=function(){this.hasCoreDataInit||(this.coreDataNum++,this.coreDataNum>=9&&(this.hasCoreDataInit=!0,ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT))))},b.prototype.findNextTaskPos=function(){TimeUtil.addTimeOut(250,function(){GameInstance.questMoveVo&&GuidData.map.isBaseMap()&&(console.log("寻路到下个坐标点"),quest.QuestModel.getInstance().toplay(GameInstance.questMoveVo.pos))})},b.prototype.enterSceneDothing=function(){GuidData.map.isBaseMap()&&this.findNextTaskPos(),17==GuidData.player.getLastMapType()&&ModulePageManager.openPanel(SharedDef.MODULE_BOSS,SharedDef.MODULE_BOSS_PERSON_BOSS)},b.prototype.mapIntFieldQuestsProcess=function(){GuidData.map.isFuBen()&&ModuleEventManager.dispatchEvent(new fb.FubenEvent(fb.FubenEvent.REFRESH_FUBEN_SCENE_LEFT_QUEST));
},b.prototype.AnalysisMapData=function(){if(GuidData.map.tbMapVo.path.length){for(var a=new Array,b=0;b<GuidData.map.tbMapVo.path.length;b++)a.push(new Vector2D(GuidData.map.tbMapVo.path[b][0],GuidData.map.tbMapVo.path[b][1]));AotuSkillManager.getInstance().pathItem=a,console.log(a)}else AotuSkillManager.getInstance().pathItem=null;quest.QuestModel.getInstance().changeTab()},b.prototype.loadSecenCom=function(){console.log("over")},b.prototype.loadProgress=function(a){console.log("loading "+float2int(100*a)+"%")},b.prototype.listenModuleEvents=function(){return[new EngineEvent(EngineEvent.CREAT_SCENE_EVENT),new EngineEvent(EngineEvent.CREAT_MAINCHAR_EVENT),new EngineEvent(EngineEvent.ENTER_SCENE_EVENT),new EngineEvent(EngineEvent.MAP_INT_FIELD_QUESTS_PROCESS),new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT)]},b}(BaseProcessor),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),EngineEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.CREAT_SCENE_EVENT="creat_scene_event",b.CREAT_MAINCHAR_EVENT="creat_mainchar_event",b.ENTER_SCENE_EVENT="enter_scene_event",b.MONEY_CHANGE="MONEY_CHANGE",b.MONEY_TYPE_GOLD_INGOT="MONEY_TYPE_GOLD_INGOT",b.MONEY_TYPE_BIND_GOLD="MONEY_TYPE_BIND_GOLD",b.MONEY_TYPE_SILVER="MONEY_TYPE_SILVER",b.MONEY_TYPE_SILVER_WAREHOUSE="MONEY_TYPE_SILVER_WAREHOUSE",b.MONEY_TYPE_GOLD_WAREHOUSE="MONEY_TYPE_GOLD_WAREHOUSE",b.MONEY_TYPE_BIND_GOLD_WAREHOUSE="MONEY_TYPE_BIND_GOLD_WAREHOUSE",b.MONEY_TYPE_QI="MONEY_TYPE_QI",b.MONEY_TYPE_BEAST="MONEY_TYPE_BEAST",b.MONEY_TYPE_GEM="MONEY_TYPE_GEM",b.PLAYER_FIELD_VIP_LEVEL="PLAYER_FIELD_VIP_LEVEL",b.PLAYER_FIELD_LEVEL="PLAYER_FIELD_LEVEL",b.PLAYER_FIELD_FORCE="PLAYER_FIELD_FORCE",b.PLAYER_FIELD_DIVINE="PLAYER_FIELD_DIVINE",b.PLAYER_EXPAND_INT_XP="PLAYER_EXPAND_INT_XP",b.MAP_INT_FIELD_QUESTS_PROCESS="MAP_INT_FIELD_QUESTS_PROCESS",b.CORE_DATA_CREATED_EVENT="CORE_DATA_CREATED_EVENT",b.CORE_DATA_COMPLETE_EVENT="CORE_DATA_COMPLETE_EVENT",b.SYSTEM_OPEN_EVENT="SYSTEM_OPEN_EVENT",b}(BaseEvent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),NetBaseProcessor=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._lasttime=0,b}return __extends(b,a),b.prototype.getName=function(){return"NetBaseProcessor"},b.prototype.receivedModuleEvent=function(a){},b.prototype.getError=function(a){var b=new s2c_operation_failed;s2c_operation_failed.read(b,a);OperationFailedToString(b.type,b.reason,b.data);if(msgtip.MsgTipManager.setMsgData(b),27!=b.type||22!=b.reason&&37!=b.reason)if(20==b.type&&1==b.reason){var c=GameInstance.getGameSecond(GuidData.player.getCDtime());c>0&&msgtip.MsgTipManager.outStr(getScencdStr(c)+"后可设置为和平模式",99)}else if(27==b.type&&0==b.reason)this.showLevelUp(5),ModuleEventManager.dispatchEvent(new skillUi.SkillUiEvent(skillUi.SkillUiEvent.SKILL_UP_EVENT));else if(27==b.type&&1==b.reason){var d=new mountui.MountUiEvent(mountui.MountUiEvent.EFF_EVENT);d.data=b.data,ModuleEventManager.dispatchEvent(d)}else if(27==b.type&&2==b.reason)this.showLevelUp(1);else if(27==b.type&&10==b.reason)this.showLevelUp(12);else if(27==b.type&&3==b.reason)this.showLevelUp(55);else if(27!=b.type||9!=b.reason&&29!=b.reason&&30!=b.reason&&31!=b.reason&&32!=b.reason){if(27==b.type&&12==b.reason)this.showLevelUp(4);else if(27==b.type&&14==b.reason)this.showLevelUp(13);else if(27==b.type&&15==b.reason)this.showLevelUp(14);else if(27==b.type&&16==b.reason)ModuleEventManager.dispatchEvent(new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.EFF_EVENT)),this.showLevelUp(2);else if(27==b.type&&17==b.reason)ModuleEventManager.dispatchEvent(new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.EFF_EVENT)),this.showLevelUp(15);else if(27==b.type&&18==b.reason)this.showLevelUp(16);else if(27==b.type&&21==b.reason)this.showLevelUp(17);else if(27==b.type&&b.reason>=25&&b.reason<=27){var e=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.POP_TIPS_EVENT);e.data=[b.reason,b.data],ModuleEventManager.dispatchEvent(e)}else if(27==b.type&&33==b.reason)this.showLevelUp(8);else if(27==b.type&&34==b.reason)this.showLevelUp(9);else if(27==b.type&&35==b.reason)this.showLevelUp(6);else if(27==b.type&&36==b.reason)this.showLevelUp(7);else if(27==b.type&&39==b.reason)this.showLevelUp(18);else if(27==b.type&&40==b.reason){var f=new wing.WingEvent(wing.WingEvent.EFF_EVENT);f.data=b.data,ModuleEventManager.dispatchEvent(f)}else if(35==b.type&&0==b.reason)ModuleEventManager.dispatchEvent(new moneytree.MoneyTreeEvent(moneytree.MoneyTreeEvent.SHOW_EFF_MoneyTree_EVENT));else if(35==b.type&&1==b.reason){var f=new moneytree.MoneyTreeEvent(moneytree.MoneyTreeEvent.EFF_EVENT);f.data=b.data,ModuleEventManager.dispatchEvent(f)}}else this.showLevelUp(3),console.log("---$msgVo.type，$msgVo.type----",b.type,b.reason);else this.showLevelUp(5);if(b.type==OprateResult.OPRATE_TYPE_LOGIN&&b.reason==OprateResult.OPRATE_RESULT_LOGINED_IN&&(NetManager.getInstance().protocolos.forced_into(),TimeUtil.addTimeOut(200,function(){var a=new LoginEvent(LoginEvent.LOGIN_RECONNET_EVENT);ModuleEventManager.dispatchEvent(a)}),console.log("强制登录")),b.type==OprateResult.OPRATE_TYPE_LOGIN&&b.reason==OprateResult.OPRATE_RESULT_SCENED_ERROR){var g=window.location.toString();window.location.href=g}},b.prototype.showLevelUp=function(a){var b=new msgtip.MsgPicData;b.type=2,b.info=getSuccesspromptUrl(String(a));var c=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_MSG_PIC_DATA);c.data=b,ModuleEventManager.dispatchEvent(c)},b.prototype.guidObj=function(a){GuidObjManager.getInstance().ApplyBlock(a)},b.prototype.gridObj=function(a){GuidObjManager.getInstance().ApplyBlock(a)},b.prototype.guidCtrl=function(a){},b.prototype.sysTime=function(a){GameInstance.gameSyncTime=new both_sync_mstime,both_sync_mstime.read(GameInstance.gameSyncTime,a),GameInstance.gameSyncClientTime=TimeUtil.getTimer()},b.prototype.sysOpenTime=function(a){var b=new s2c_send_server_open_time;s2c_send_server_open_time.read(b,a),GameInstance.serverOpenTime=b.open_time},b.prototype.sysAppTime=function(a){GameInstance.appSynctTime=new both_sync_mstime_app,both_sync_mstime_app.read(GameInstance.appSynctTime,a),GameInstance.appSyncClientTime=TimeUtil.getTimer(),ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.gridMove=function(a){GuidObjManager.getInstance().applyGridMove(a)},b.prototype.gridJump=function(a){console.log("收到gridJump=>>"),GuidObjManager.getInstance().applyGridJump(a)},b.prototype.gridStop=function(a){GuidObjManager.getInstance().applyGridStop(a)},b.prototype.fight=function(a){FightManager.getInstance().fightUpdate(a)},b.prototype.task=function(a){},b.prototype.aiChat=function(a){var b=new s2c_chat_unit_talk;s2c_chat_unit_talk.read(b,a)},b.prototype.listenModuleEvents=function(){return[]},b.prototype.smsgRankListQueryResult=function(a){for(var b=a.readUint32(),c=a.readInt(),d=a.readUint32(),e=new Array,f=a.readShort(),g=0;f>g;g++){for(var h=new RankData,i=a.readShort(),j=0;i>j;j++){var k=a.readUint32();h.SetUInt32(j,k)}for(var l=a.readShort(),m=0;l>m;m++){var n=a.readUTF();h.SetStr(m,n)}e.push(h)}switch(b){case SharedDef.RANK_TYPE_TRIAL:var o=new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.SHOW_TOWER_RANK);o.data={list:e,self:c},ModuleEventManager.dispatchEvent(o);break;case SharedDef.RANK_TYPE_SINGLE_PVP:var p=new kuafu.KuaFuEvent(kuafu.KuaFuEvent.KUAFU_ARENA_QUALIFY_RANK_EVENT);p.data=c,ModuleEventManager.dispatchEvent(p);break;case SharedDef.RANK_TYPE_FACTION:break;case SharedDef.RANK_TYPE_POWER:var q=new ranking.RankingEvent(ranking.RankingEvent.RANKING_DATA_EVENT),r=new ranking.RankQueryData;r.type=b,r.rank=c,r.list=e,r.allNum=d,q.data=r,ModuleEventManager.dispatchEvent(q);break;case SharedDef.RANK_TYPE_DOUJIANTAI:var s=new kuafu.KuaFuEvent(kuafu.KuaFuEvent.SHOW_DJT_RANK);s.data={list:e,self:c},ModuleEventManager.dispatchEvent(s)}},b.prototype.smsgExpUpData=function(a){var b=a.readInt32(),c=(a.readUint8(),a.readInt32(),(b>0?"+":"")+b),d=GameInstance.mainChar,e=new bloodTittle.TextJumpUiVo;e.str=String(c),e.type=bloodTittle.TextJumpType.EXPERIENCE,e.starttime=TimeUtil.getTimer(),e.starttime-this._lasttime<250&&(e.starttime=this._lasttime+250),e.endtime=e.starttime+1200,this._lasttime=e.starttime,d?e.pos=new Vector3D(d.x,d.y+d.tittleHeight-5,d.z):e.pos=new Vector3D(Scene_data.focus3D.x,Scene_data.focus3D.y,Scene_data.focus3D.z),BloodManager.getInstance().setJumpNum(e)},b.prototype.smsgItemNotice=function(a){var b=new s2c_item_notice;s2c_item_notice.read(b,a);for(var c=0;c<b.list.length;c++){var d=b.list[c],e=tb.TB_item_template.get_TB_item_template(d.item_id),f="[FFE57E]获得 "+getColorQua(e.quality)+e.name+"[FFE57E]×"+d.num;this.showTempTime(150*c,f,3)}switch(b.showType){case SharedDef.ITEM_SHOW_TYPE_MINI_QUEST_BAR:var g=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_SMSG_ITEM_NOTICE);g.data=b,ModuleEventManager.dispatchEvent(g);break;case SharedDef.ITEM_SHOW_TYPE_MINI_QUEST_DAILY2:}},b.prototype.showTempTime=function(a,b,c){TimeUtil.addTimeOut(a,function(){msgtip.MsgTipManager.outStr(b,msgtip.MsgTipManager.getPopTypeByTB(c))})},b.prototype.msgClientsubscription=function(a){GuidObjManager.getInstance().msgClientsubscription(a)},b.prototype.smsgCastSpellStart=function(a){var b=new s2c_cast_spell_start;s2c_cast_spell_start.read(b,a);var c=b.data.split("|"),d=new Vector2D(Number(c[1]),Number(c[2])),e=AstarUtil.getWorldPosByStart2D(d),f=tb.TB_skill_base.get_TB_skill_base(b.spellid);if(f.alarmEffect)console.log("预警特效---->预警特效"),e.y=AstarUtil.getHeightByPos(e)+1,e.w=Number(c[0]),SceneCharManager.getInstance().addWarningEffectChar(e,f.alarmEffect);else{var g=SkillManager.getInstance().getSkill(getSkillUrl(f.effect_file),f.effect);if(g){g.reset();var h=Play_Skill_Vo.get_Play_Skill_Vo(f.id),i=SceneCharManager.getInstance().getSceneCharByUID(b.caster_guid);if(console.log("连续技能",TimeUtil.getTimer()),1==f.is_remain?i.isSinging=!0:i.isSinging=!1,g.tbSkillId=f.id,FightManager.getInstance().playFixEffect(g,h,d,i,null),i.unit.isMain){var j=new mainUi.MainUiEvent(mainUi.MainUiEvent.PLAYER_SKILL_CD_REFRESH);j.data=f.id,ModuleEventManager.dispatchEvent(j)}}}},b.prototype.msgUseJumpPoint=function(a){console.log("接收到跳跃消息");var b=a.readUint32(),c=a.readUint32(),d=tb.TB_map_jump_point_detail.getTempByID(b);d.show.length;GuidObjManager.getInstance().applyJumpShow(c,d.show,1e3*d.last)},b.prototype.msgSpellStop=function(a){var b=a.readString();console.log("msgSpellStop",b),GuidObjManager.getInstance().msgSpellStop(b)},b.prototype.smsgOfflineRewardResult=function(a){console.log("---离线数据");var b=new s2c_offline_reward_result;s2c_offline_reward_result.read(b,a);var c=new offlinereward.OfflineRewardEvent(offlinereward.OfflineRewardEvent.SHOW_OFFLINE_REWARD_PANEL);c.data=b,TimeUtil.addTimeOut(2e3,function(){ModuleEventManager.dispatchEvent(c)})},b.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_OPERATION_FAILED]=function(b){a.getError(b)},b[Protocols.SMSG_UD_OBJECT]=function(b){a.guidObj(b)},b[Protocols.CMSG_UD_CONTROL]=function(b){a.guidCtrl(b)},b[Protocols.MSG_SYNC_MSTIME]=function(b){a.sysTime(b)},b[Protocols.MSG_SYNC_MSTIME_APP]=function(b){a.sysAppTime(b)},b[Protocols.SMSG_GRID_UD_OBJECT]=function(b){a.gridObj(b)},b[Protocols.SMSG_GRID_UD_OBJECT_2]=function(b){a.gridObj(b)},b[Protocols.SMSG_QUESTHELP_CANACCEPT_LIST]=function(b){a.task(b)},b[Protocols.SMSG_CHAT_UNIT_TALK]=function(b){a.aiChat(b)},b[Protocols.SMSG_GRID_UNIT_MOVE]=function(b){a.gridMove(b)},b[Protocols.SMSG_GRID_UNIT_JUMP]=function(b){a.gridJump(b)},b[Protocols.SMSG_EXP_UPDATE]=function(b){a.smsgExpUpData(b)},b[Protocols.SMSG_ITEM_NOTICE]=function(b){a.smsgItemNotice(b)},b[Protocols.MSG_CLIENTSUBSCRIPTION]=function(b){a.msgClientsubscription(b)},b[Protocols.SMSG_GRID_UNIT_MOVE_2]=function(b){a.gridMove(b)},b[Protocols.MSG_MOVE_STOP]=function(b){a.gridStop(b)},b[Protocols.SMSG_FIGHTING_INFO_UPDATE_OBJECT]=function(b){a.fight(b)},b[Protocols.SMSG_FIGHTING_INFO_UPDATE_OBJECT_2]=function(b){a.fight(b)},b[Protocols.SMSG_RANK_LIST_QUERY_RESULT]=function(b){a.smsgRankListQueryResult(b)},b[Protocols.MSG_USE_JUMP_POINT]=function(b){a.msgUseJumpPoint(b)},b[Protocols.SMSG_CAST_SPELL_START]=function(b){a.smsgCastSpellStart(b)},b[Protocols.MSG_SPELL_STOP]=function(b){a.msgSpellStop(b)},b[Protocols.SMSG_OFFLINE_REWARD_RESULT]=function(b){a.smsgOfflineRewardResult(b)},b[Protocols.SMSG_SEND_SERVER_OPEN_TIME]=function(b){a.sysOpenTime(b)},b},b}(BaseProcessor),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),DeathPanel=function(a){function b(){var b=a.call(this)||this;return b.showType=0,b.showVal=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._bg2Render=new UIRenderComponent,b.addRender(b._bg2Render),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b.uiAtlas=new UIAtlas,b._baseRender.uiAtlas=b.uiAtlas,b._bgRender.uiAtlas=b.uiAtlas,b._bg2Render.uiAtlas=b.uiAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this.uiAtlas.setInfo("ui/uidata/public/deathnew.xml","ui/uidata/public/deathnew.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){var a=this;this._mainBg=this._bgRender.getComponent("t_bg"),this.addChild(this._mainBg),this._mainBg.addEventListener(InteractiveEvent.Up,this.onClick,this),this.addUIList(["t_basebg"],this._bg2Render),this.addUIList(["t_title"],this._baseRender),this._label1=this._baseRender.getComponent("t_lab1"),this.addChild(this._label1),this._val1=this._baseRender.getComponent("t_val1"),this.addChild(this._val1),this._label2=this._baseRender.getComponent("t_lab2"),this.addChild(this._label2),this._val2=this._baseRender.getComponent("t_val2"),this.addChild(this._val2),this._mainLabel=this._baseRender.getComponent("t_death"),this.addChild(this._mainLabel),LabelTextFont.writeSingleLabel(this.uiAtlas,this._mainLabel.skinName,"您已经死亡！",16,TextAlign.CENTER,ColorType.Brown7a2f21),this._leftBtn=this._baseRender.getComponent("t_btn1"),this.addChild(this._leftBtn),this._leftBtn.addEventListener(InteractiveEvent.Up,this.onClick,this),this._rightBtn=this._baseRender.getComponent("t_btn2"),this.addChild(this._rightBtn),this._rightBtn.addEventListener(InteractiveEvent.Up,this.onClick,this),this._tickFun=function(){a.tick()},LabelTextFont.writeSingleLabel(this.uiAtlas,this._label2.skinName,"自动复活：",14,TextAlign.LEFT,ColorType.Orange9a683f),this.applyLoadComplete()},b.prototype.onClick=function(a){var b=this;if(a.target==this._leftBtn){if(1==this.showType&&this.showVal>0)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"原地复活时间未到",99);costRes([SharedDef.MONEY_TYPE_BIND_GOLD,this.showVal],function(){NetManager.getInstance().protocolos.gold_respawn(1),TimeUtil.removeTimeTick(b._tickFun),UIManager.getInstance().removeUIContainer(b)},function(){})}else a.target==this._rightBtn&&(NetManager.getInstance().protocolos.xianfu_random_respawn(),TimeUtil.removeTimeTick(this._tickFun),UIManager.getInstance().removeUIContainer(this))},b.prototype.resize=function(){this._mainBg&&(this._mainBg.top=0,this._mainBg.left=0,this._mainBg.width=Scene_data.stageWidth/UIData.Scale,this._mainBg.height=Scene_data.stageHeight/UIData.Scale),a.prototype.resize.call(this)},b.prototype.setData=function(a,b,c){this.showType=a,this.showVal=b,this._timeNum=c,0==a?(LabelTextFont.writeSingleLabel(this.uiAtlas,this._label1.skinName,"消耗：",14,TextAlign.LEFT,ColorType.Orange9a683f),UiDraw.drawRewardIconAndtxt(this._val1,[SharedDef.MONEY_TYPE_BIND_GOLD,b],!0,TextAlign.LEFT,20)):(LabelTextFont.writeSingleLabel(this.uiAtlas,this._label1.skinName,"等待：",14,TextAlign.LEFT,ColorType.Orange9a683f),LabelTextFont.writeSingleLabel(this.uiAtlas,this._val1.skinName,String(b),16,TextAlign.LEFT,ColorType.colorcd2000,"",12)),LabelTextFont.writeSingleLabel(this.uiAtlas,this._val2.skinName,this._timeNum+"秒",14,TextAlign.LEFT,ColorType.Green2ca937),TimeUtil.addTimeTick(1e3,this._tickFun)},b.prototype.tick=function(){this._timeNum--,this._timeNum<=0&&(UIManager.getInstance().removeUIContainer(this),TimeUtil.removeTimeTick(this._tickFun),NetManager.getInstance().protocolos.xianfu_random_respawn()),1==this.showType&&(this.showVal--,this.showVal<0&&(this.showVal=0,UIManager.getInstance().removeUIContainer(this),TimeUtil.removeTimeTick(this._tickFun),NetManager.getInstance().protocolos.gold_respawn(1)),LabelTextFont.writeSingleLabel(this.uiAtlas,this._val1.skinName,String(this.showVal),16,TextAlign.LEFT,ColorType.colorcd2000,"",12)),LabelTextFont.writeSingleLabel(this.uiAtlas,this._val2.skinName,this._timeNum+"秒",14,TextAlign.LEFT,ColorType.Green2ca937)},b.prototype.onRemove=function(){TimeUtil.removeTimeTick(this._tickFun),a.prototype.onRemove.call(this)},b.show=function(a,c,d){var e=this;this._instance||(this._instance=new b),this._instance.load(function(){UIManager.getInstance().addUIContainer(e._instance),e._instance.setData(a,c,d)},!1)},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),PopMenuUtil=function(a){function b(){var b=a.call(this)||this;return b._canclick=!0,b._complete=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topRender.setInfo("ui/uidata/dropmenu/dropmenu.xml","ui/uidata/dropmenu/dropmenu.png",function(){b.loadConfigCom()}),b}return __extends(b,a),b.prototype.initData=function(a,b,c,d){void 0===d&&(d=null),this._canclick&&(this._canclick=!1,UIManager.getInstance().addUIContainer(this),this._data=a,this._posx=b,this._posy=c,this._backFun=d,this.RefreshItems())},b.prototype.RefreshItems=function(){this._complete&&this.showItems(this._data,this._posx,this._posy)},b.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._topRender.uiAtlas,this.initUI(),this._complete=!0,this.RefreshItems()},b.prototype.initUI=function(){this.AList=new Array,this.Aline=new Array;for(var a=0;12>a;a++){var b=this._topRender.getComponent("b_"+a);b.addEventListener(InteractiveEvent.Down,this.butClik,this),this.AList.push(b)}for(var c=0;11>c;c++)this.Aline.push(this._topRender.getComponent("line"));this.bg=this.addChild(this._bgRender.getComponent("bg"))},b.prototype.addtip=function(a){this.setUiListVisibleByItem(this.AList,!1),this.setUiListVisibleByItem(this.Aline,!1),this.bg.height=38*a.data.items.length;for(var b=0;b<a.data.items.length;b++)this.addChild(this.AList[a.data.items[b]]),this.AList[a.data.items[b]].y=2+38*b;for(var c=0;c<a.data.items.length-1;c++)this.setUiListVisibleByItem([this.Aline[c]],!0),this.Aline[c].y=38*(c+1);this._panelheight=this.bg.height,this._panelwidth=this.bg.width,this._bgRender.applyObjData()},b.prototype.movetip=function(a,b){var c=a+25,d=b+25;c+this._panelwidth>UIData.designWidth&&(c=UIData.designWidth-this._panelwidth),d+this._panelheight>UIData.designHeight&&(d=UIData.designHeight-this._panelheight),this.left=c,this.top=d},b.prototype.butClik=function(a){var b=a.target.name;this._backFun&&this._backFun(Number(b.substring(2,b.length))),this.close()},b.prototype.showItems=function(a,b,c){this._data=a,this.addtip(a),this.movetip(b,c),Scene_data.uiStage.addEventListener(InteractiveEvent.Down,this.clickEvt,this)},b.prototype.close=function(){var a=this;this._data=null,this._backFun=null,this.hasStage&&(UIManager.getInstance().removeUIContainer(this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Down,this.clickEvt,this)),TimeUtil.addTimeOut(1e3,function(){a._canclick=!0})},b.prototype.clickEvt=function(a){this.close()},b.show=function(a,c,d,e){return void 0===c&&(c=null),void 0===d&&(d=136),void 0===e&&(e=115),this.popMenuUtil||(this.popMenuUtil=new b),this.popMenuUtil.initData(a,d,e,c),this.popMenuUtil},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),PopNewPromptUtil=function(a){function b(){var b=a.call(this)||this;return b._complete=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._bottomRender.setInfo("ui/uidata/poptimeout/popnewprompt.xml","ui/uidata/poptimeout/popnewprompt.png",function(){b.loadConfigCom()}),b}return __extends(b,a),b.prototype.initData=function(a){this._aryItems&&this.hasStage?this._aryItems.push(a):(this._aryItems||(this._aryItems=new Array),this._aryItems.push(a),UIManager.getInstance().addUIContainer(this),this.selectItem())},b.prototype.selectItem=function(){console.log("_ary------",this._aryItems),this._aryItems&&this._aryItems.length>0?(this._type=this._aryItems[0].type,this._endtime=this._aryItems[0].times+TimeUtil.getTimer(),this.RefreshItems()):this.close()},b.prototype.RefreshItems=function(){this._complete&&(this.type2draw(),TimeUtil.addFrameTick(this._tickFun))},b.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._bottomRender.uiAtlas,this.initUI(),this._complete=!0,this.RefreshItems()},b.prototype.initUI=function(){var a=this,b=this._baseRender;this.addChild(this._bottomRender.getComponent("bg")),this.c_info=this.addChild(b.getComponent("c_info")),b.applyObjData(),this._aryachive=new Array,this._aryachive.push(b.getComponent("c_name")),this._aryachive.push(b.getComponent("c_reward2")),this.a_1=this.addChild(b.getComponent("a_1")),this._arytitle=new Array,this._arytitle.push(b.getComponent("c_icon")),this._tickFun=function(b){a.tickRefreshState(b)}},b.prototype.tickRefreshState=function(a){var b=Math.floor((this._endtime-TimeUtil.getTimer())/1e3);this._curtime!=b&&(this._curtime=b,console.log("刷新",b),0>b&&this.nextprompt()),this.hasStage||TimeUtil.removeFrameTick(this._tickFun)},b.prototype.nextprompt=function(){this._aryItems.shift(),this.selectItem()},b.prototype.drawicon=function(a,b){var c=this;LoadManager.getInstance().load(Scene_data.fileRoot+b,LoadManager.IMG_TYPE,function(b){var d=c._bottomRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1),f=Math.min(d.pixelWitdh/b.width,d.pixelHeight/b.height);e.drawImage(b,0,0,b.width,b.height,d.pixelWitdh-b.width*f,d.pixelHeight-b.height*f,b.width*f,b.height*f),c._bottomRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},b.prototype.drawReward=function(a,b){var c=this;IconManager.getInstance().getIcon(GameData.getIconCopyUrl(b[0]),function(d){var e=c._baseRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.A_BLACK_F,new Rectangle(0,0,64,64),UIData.publicUi),f.drawImage(d,0,0,60,60,2,2,60,60),ArtFont.getInstance().writeFontToCtxRight(f,String(b[1]),ArtFont.num1,64,45),c._baseRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},b.prototype.showachievement=function(){var a=this._aryItems[0].data;LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this._aryachive[0].skinName,a.data.name,18,TextAlign.CENTER,ColorType.Green56da35);var b="奖励： ";if(a.data.title&&a.data.title>0){var c=tb.TB_title_base.get_TB_title_baseById(a.data.title);a.data.reward.length>0&&(b+=getResName(a.data.reward[0][0])+" x"+a.data.reward[0][1]+"   "),b+=c.name+" x1"}else for(var d=0;d<a.data.reward.length;d++)b+=getResName(a.data.reward[d][0])+" x"+a.data.reward[d][1]+"   ";LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this._aryachive[1].skinName,b,16,TextAlign.LEFT,ColorType.Whiteffffff),LabelTextFont.writeTextAutoCenter(this._baseRender.uiAtlas,this.c_info.skinName,a.data.info,16,ColorType.Whiteffffff,315,!0)},b.prototype.showdesignation=function(){var a=this._aryItems[0].data;this.drawicon(this._arytitle[0],"ui/load/tittle/"+a.id+".png"),LabelTextFont.writeTextAutoCenter(this._baseRender.uiAtlas,this.c_info.skinName,a.info,16,ColorType.Whiteffffff,315,!0)},b.prototype.type2draw=function(){switch(this._type){case b.NEW_ACHIEVEMENT:this.setUiListVisibleByItem(this._aryachive,!0),this.setUiListVisibleByItem(this._arytitle,!1),this.a_1.goToAndStop(0),this.showachievement();break;case b.NEW_DESIGNATION:this.setUiListVisibleByItem(this._arytitle,!0),this.setUiListVisibleByItem(this._aryachive,!1),this.a_1.goToAndStop(1),this.showdesignation()}},b.prototype.close=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.show=function(a,c){console.log("---shuju-----",c,a);var d=new NewPromptVo;return d.data=c,d.type=a,this.popNewPromptUtil||(this.popNewPromptUtil=new b),this.popNewPromptUtil.initData(d),this.popNewPromptUtil},b.NEW_ACHIEVEMENT=0,b.NEW_DESIGNATION=1,b}(UIConatiner),NewPromptVo=function(){function a(){this.id=1,this.times=3e3}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),PopTimeOutUtil=function(a){function b(){var b=a.call(this)||this;return b._complete=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._bottomRender.setInfo("ui/uidata/poptimeout/poptimeout.xml","ui/uidata/poptimeout/poptimeout.png",function(){b.loadConfigCom()}),b}return __extends(b,a),b.prototype.initData=function(a,b,c){void 0===a&&(a=null),this._backFun=a,this._type=b,this._endtime=c+TimeUtil.getTimer(),this.RefreshItems()},b.prototype.RefreshItems=function(){this._complete&&this.showItems()},b.prototype.loadConfigCom=function(){this.initUI(),this._complete=!0,this.RefreshItems()},b.prototype.initUI=function(){var a=this,b=this._bottomRender;this._icon=this.addChild(b.getComponent("type0")),this._a_time=this.addChild(b.getComponent("a_time")),this._tickFun=function(b){a.tickRefreshState(b)}},b.prototype.tickRefreshState=function(a){var b=Math.floor((this._endtime-TimeUtil.getTimer())/1e3);this._curtime!=b&&(this._curtime=b,ArtFont.getInstance().writeFontToSkinName(this._bottomRender.uiAtlas,this._a_time.skinName,String(b+1),this.type2font(),TextAlign.CENTER),0>b&&(this._backFun&&this._backFun(),this.close())),this.hasStage||TimeUtil.removeFrameTick(this._tickFun)},b.prototype.showItems=function(){var a=this;LoadManager.getInstance().load(Scene_data.fileRoot+getUItimeOutUrl(String(this._type)),LoadManager.IMG_TYPE,function(b){var c=a._bottomRender.uiAtlas.getRec(a._icon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),e=c.pixelWitdh/2-b.width/2,f=c.pixelHeight-b.height;d.drawImage(b,0,0,b.width,b.height,e,f,b.width,b.height),a._bottomRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY),TimeUtil.addFrameTick(a._tickFun)})},b.prototype.type2font=function(){switch(this._type){case b.MATCHINGOK:return ArtFont.num61;case b.PLAYGO:return ArtFont.num61;case b.FUHUO:return ArtFont.num101}},b.prototype.close=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.show=function(a,c,d){return void 0===c&&(c=5e3),void 0===d&&(d=null),this.popTimeOutUtil||(this.popTimeOutUtil=new b),this.popTimeOutUtil.hasStage?void 0:(this.popTimeOutUtil.initData(d,a,c),UIManager.getInstance().addUIContainer(this.popTimeOutUtil),this.popTimeOutUtil)},b.FUHUO=2,b.PLAYGO=1,b.MATCHINGOK=0,b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MenuKeyUtil=function(a){function b(){var b=a.call(this)||this;return b._complete=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topRender.setInfo("ui/uidata/dropmenu/dropmenu.xml","ui/uidata/dropmenu/dropmenu.png",function(){b.loadConfigCom()}),b}return __extends(b,a),b.prototype.initData=function(a,b,c){void 0===c&&(c=null),this._posx=a,this._posy=b,this._backFun=c,this.RefreshItems()},b.prototype.RefreshItems=function(){this._complete&&this.showItems(this._posx,this._posy)},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._baseRender.uiAtlas=this._topRender.uiAtlas,this.initUI(),this._complete=!0,this.RefreshItems()},b.prototype.initUI=function(){var a=this._baseRender;this.keyPanel=this.addChild(this._bottomRender.getComponent("keyPanel")),this.one=this.addEvntBut("1",a),this.one.data=1,this.two=this.addEvntBut("2",a),this.two.data=2,this.three=this.addEvntBut("3",a),this.three.data=3,this.four=this.addEvntBut("4",a),this.four.data=4,this.five=this.addEvntBut("5",a),this.five.data=5,this.six=this.addEvntBut("6",a),this.six.data=6,this.seven=this.addEvntBut("7",a),this.seven.data=7,this.eight=this.addEvntBut("8",a),this.eight.data=8,this.nine=this.addEvntBut("9",a),this.nine.data=9,this["delete"]=this.addEvntBut("delete",a),this["delete"].data=-1,this.zero=this.addEvntBut("0",a),this.zero.data=0,this.ok=this.addEvntBut("ok",a),this.ok.data=10,this.addChild(this._topRender.getComponent("key_1")),this.addChild(this._topRender.getComponent("key_2")),this.addChild(this._topRender.getComponent("key_3")),this.addChild(this._topRender.getComponent("key_4")),this.addChild(this._topRender.getComponent("key_6")),this.addChild(this._topRender.getComponent("key_5")),this.addChild(this._topRender.getComponent("key_0")),this.addChild(this._topRender.getComponent("key_9")),this.addChild(this._topRender.getComponent("key_8")),this.addChild(this._topRender.getComponent("key_7"))},b.prototype.movetip=function(a,b){this.left=a/UIData.Scale,this.top=b/UIData.Scale},b.prototype.butClik=function(a){var b=a.target.data;this._backFun&&this._backFun(b)},b.prototype.showItems=function(a,b){this.movetip(a,b),Scene_data.uiStage.addEventListener(InteractiveEvent.Down,this.clickEvt,this)},b.prototype.close=function(){this.hasStage&&(UIManager.getInstance().removeUIContainer(this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Down,this.clickEvt,this))},b.closeMune=function(){this.menuKeyUtil&&this.menuKeyUtil.close()},b.prototype.clickEvt=function(a){var b=new Rectangle(this.keyPanel.absoluteX,this.keyPanel.absoluteY,this.keyPanel.absoluteWidth,this.keyPanel.absoluteHeight);b.isHitByPoint(a.x,a.y)||this.close()},b.show=function(a,c,d){return void 0===a&&(a=null),this.menuKeyUtil||(this.menuKeyUtil=new b),this.menuKeyUtil.initData(c,d,a),UIManager.getInstance().addUIContainer(this.menuKeyUtil),
this.menuKeyUtil},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),DataSlist=function(a){function b(){var b=a.call(this)||this;return b.pageId=-1,b._requestTimes=!0,b.listResoureArr=new Array,b.backFun=function(a,c,d){b.moveEndFun(a,c,d)},NetManager.getInstance().reg(b),b}return __extends(b,a),b.prototype.pushDataToList=function(a){for(var b,c=!0,d=0;d<this.listResoureArr.length;d++)if(this.listResoureArr[d].id==a.id){c=!1,b=d;break}c?(this.listResoureArr.push(a),this.pageId=Math.floor(a.id/this.contextNum)+1,console.log("--同步页数--",this.pageId,a.id,this.contextNum)):this.listResoureArr.splice(b,1,a)},b.prototype.moveEndFun=function(a,b,c){var d=this;if(this._requestTimes){var e=Math.floor(Math.abs(this.p_scrollY)/this.p_itemHeight),f=Math.floor((Math.abs(this.p_scrollY)+this._height)/this.p_itemHeight);c>0&&e==(this.pageId-1)*this.contextNum&&(console.log("--上一页--"),this._requestTimes=!1,1==this.pageId?this.sendPageByNum(this.pageId,this.typeId):this.sendPageByNum(this.pageId-1,this.typeId)),0>c&&(f==this.pageId*this.contextNum-1?(console.log("--下一页--"),this._requestTimes=!1,this.sendPageByNum(this.pageId+1,this.typeId)):b||(console.log("--当前页--"),this._requestTimes=!1,this.sendPageByNum(this.pageId,this.typeId)))}this._requestTimes||TimeUtil.addTimeOut(3e3,function(){d._requestTimes=!0})},b.prototype.sendPageByNum=function(a,b){void 0===b&&(b=0),this.pageId=a,this.typeId=b,this.toSeversUrl()},b.prototype.getSeverFunData=function(a){var b=0==this.listResoureArr.length;console.log("---555--",this.listResoureArr),this.meshSeverData(a),b?this.refreshData(this.listResoureArr):this.changeMinScrollY()},b.prototype.changeMinScrollY=function(){this.listResoureArr.sort(function(a,b){return a.id-b.id}),a.prototype.changeMinScrollY.call(this)},b.prototype.getHanderMap=function(){return null},b.prototype.toSeversUrl=function(){},b.prototype.meshSeverData=function(a){},b.prototype.clearAryData=function(){for(;this.listResoureArr.length>0;)this.listResoureArr.pop()},b}(SList),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),WindowUi=function(a){function b(b){void 0===b&&(b=0);var c=a.call(this)||this;return c._titlenum=b,c.addWinUiPanel(),c}return __extends(b,a),b.prototype.addWinUiPanel=function(){this._baImg=new UIBackImg,this._baImg.alpha=.5,this._baImg.setFbo(),this.addRender(this._baImg),this.winbgRender=new UIRenderComponent,this.addRender(this.winbgRender),this.bigPic=new UIRenderOnlyPicComponent,this.addRender(this.bigPic),this.winmidRender=new UIRenderComponent,this.addRender(this.winmidRender),this.wintopRender=new UIRenderComponent,this.addRender(this.wintopRender)},b.prototype.loadBigPicByUrl=function(a){return this.bigPic.setImgUrl(a),this.bigPicUI||(this.bigPicUI=this.addChild(this.bigPic.getComponent("w_bg"))),this.bigPicUI},b.prototype.addBigPic=function(){this.bigPicUI&&!this.bigPicUI.parent&&this.addChild(this.bigPicUI)},b.prototype.removeBigPic=function(){this.bigPicUI&&this.bigPicUI.parent&&this.removeChild(this.bigPicUI)},b.prototype.makeBaseWinUi=function(){var a=this;b.winUIAtlas||(b.winUIAtlas=new UIAtlas),b.winUIAtlas.configData?this.wintopRender.uiAtlas?this.applyLoad():this.winComplete():b.winUIAtlas.setInfo("ui/uidata/window/window.xml","ui/uidata/window/window.png",function(){a.winComplete()})},b.prototype.winComplete=function(){this.wintopRender.uiAtlas=b.winUIAtlas,this.winbgRender.uiAtlas=b.winUIAtlas,this.bigPic.uiAtlas=b.winUIAtlas,this.addChild(this.winbgRender.getComponent("w_bg")),this.w_height_left=this.addChild(this.wintopRender.getComponent("w_height")),this.w_height_right=this.addChild(this.wintopRender.getComponent("w_height")),this.w_width=this.addChild(this.wintopRender.getComponent("w_width")),this.w_tittle_bg_left=this.addChild(this.wintopRender.getComponent("w_tittle_bg")),this.w_tittle_bg_right=this.addChild(this.wintopRender.getComponent("w_tittle_bg")),this.w_angle_right=this.addChild(this.wintopRender.getComponent("w_angle")),this.w_angle_left=this.addChild(this.wintopRender.getComponent("w_angle")),this.w_close=this.addEvntButUp("w_close",this.wintopRender),this.applyLoad()},b.prototype.resize=function(){a.prototype.resize.call(this),this.w_tittle_bg_right&&(this.w_tittle_bg_right.isU=!0,this.w_tittle_bg_right.x=this.w_tittle_bg_left.x+this.w_tittle_bg_left.width-0,this.w_angle_right.isU=!0,this.w_angle_right.x=this.w_tittle_bg_right.x+this.w_tittle_bg_right.width-this.w_angle_right.width-7,this.w_height_right.isU=!0,this.w_height_right.x=this.w_angle_right.x+this.w_angle_right.width-this.w_height_right.width-9,this.wintopRender.applyObjData())},b.prototype.hide=function(){ModuleEventManager.dispatchEvent(new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.HIDE_WINDOW_RES_TITTLE_PANEL))},b.prototype.onAdd=function(){a.prototype.onAdd.call(this),SceneManager.getInstance().updateFBO()},b.prototype.dispose=function(){this.winbgRender&&(this.winbgRender.uiAtlas=null,this.winbgRender.dispose()),this.bigPic&&(this.bigPic.uiAtlas=null,this.bigPic.dispose()),this.winmidRender&&(this.winmidRender.uiAtlas=null,this.winmidRender.dispose()),this.wintopRender&&(this.wintopRender.uiAtlas=null,this.wintopRender.dispose()),this._baImg&&this._baImg.dispose()},b}(UIPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),WindowCentenMin=function(a){function b(b){void 0===b&&(b=0);var c=a.call(this)||this;return c._needBlackBg=!1,c._hasInit=!1,c._titlenum=b,c.addWinUiPanel(),c}return __extends(b,a),b.prototype.dispose=function(){this.winbgRender&&(this.winbgRender.uiAtlas=null,this.winbgRender.dispose()),this.winBlackBgRender&&(this.winBlackBgRender.uiAtlas=null,this.winBlackBgRender.dispose()),this.winmidRender&&(this.winmidRender.uiAtlas=null,this.winmidRender.dispose()),this.wintopRender&&(this.wintopRender.uiAtlas=null,this.wintopRender.dispose())},b.prototype.setBlackBg=function(){this._needBlackBg=!0,this._hasInit&&this.addBlackBg()},b.prototype.addBlackBg=function(){this.winBlackBgRender=new UIRenderComponent,this.winBlackBgRender.uiAtlas=WindowUi.winUIAtlas,this.addRenderAt(this.winBlackBgRender,0),this._blackBgUI=this.winBlackBgRender.getComponent("w_black_bg"),this.addChild(this._blackBgUI),this._blackBgUI.addEventListener(InteractiveEvent.Down,function(a){},this),this._blackBgUI.addEventListener(InteractiveEvent.Up,function(a){},this)},b.prototype.addWinUiPanel=function(){this.winbgRender=new UIRenderComponent,this.addRender(this.winbgRender),this.winmidRender=new UIRenderComponent,this.addRender(this.winmidRender),this.wintopRender=new UIRenderComponent,this.addRender(this.wintopRender)},b.prototype.makeBaseWinUi=function(){var a=this;WindowUi.winUIAtlas||(WindowUi.winUIAtlas=new UIAtlas),WindowUi.winUIAtlas.configData?this.wintopRender.uiAtlas?this.applyLoad():this.winComplete():WindowUi.winUIAtlas.setInfo("ui/uidata/window/window.xml","ui/uidata/window/window.png",function(){a.winComplete()})},b.prototype.winComplete=function(){this.wintopRender.uiAtlas=WindowUi.winUIAtlas,this.winbgRender.uiAtlas=WindowUi.winUIAtlas,this.c_bg=this.addChild(this.winbgRender.getComponent("c_bg")),this.c_bg.addEventListener(InteractiveEvent.Up,this.butClik,this),this.c_tittle_bg_left=this.addChild(this.wintopRender.getComponent("c_tittle_bg")),this.c_height_left=this.addChild(this.winbgRender.getComponent("c_height")),this.c_angle_left=this.addChild(this.wintopRender.getComponent("c_angle")),this.c_tittle_bg_right=this.addChild(this.wintopRender.getComponent("c_tittle_bg")),this.c_height_right=this.addChild(this.winbgRender.getComponent("c_height")),this.c_angle_right=this.addChild(this.wintopRender.getComponent("c_angle")),this.c_width=this.addChild(this.wintopRender.getComponent("c_width")),this.c_close=this.addEvntButUp("c_close",this.wintopRender),this._needBlackBg&&this.addBlackBg(),this._hasInit=!0,this.applyLoad()},b.prototype.resize=function(){a.prototype.resize.call(this),this.winbgRender&&(this.c_tittle_bg_right.isU=!0,this.c_tittle_bg_right.x=this.c_tittle_bg_left.x+this.c_tittle_bg_left.width-1,this.c_angle_right.isU=!0,this.c_angle_right.x=this.c_tittle_bg_right.x+this.c_tittle_bg_right.width-this.c_angle_right.width-21,this.c_height_right.isU=!0,this.c_height_right.x=this.c_angle_right.x+this.c_angle_right.width-this.c_height_right.width+2,this.winbgRender.applyObjData(),this.wintopRender.applyObjData(),this._blackBgUI&&(this._blackBgUI.left=0,this._blackBgUI.top=0,this._blackBgUI.height=Scene_data.stageHeight/UIData.Scale,this._blackBgUI.width=Scene_data.stageWidth/UIData.Scale))},b.prototype.hide=function(){},b}(UIPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),WindowMinUi=function(a){function b(){var b=a.call(this)||this;return b._needBlackBg=!1,b._hasInit=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.right=0,b.middle=0,b.addWinUiPanel(),b}return __extends(b,a),b.prototype.dispose=function(){this.winbgRender&&(this.winbgRender.uiAtlas=null,this.winbgRender.dispose()),this.winBlackBgRender&&(this.winBlackBgRender.uiAtlas=null,this.winBlackBgRender.dispose()),this.bigPic&&(this.bigPic.uiAtlas=null,this.bigPic.dispose()),this.winmidRender&&(this.winmidRender.uiAtlas=null,this.winmidRender.dispose()),this.wintopRender&&(this.wintopRender.uiAtlas=null,this.wintopRender.dispose())},b.prototype.addWinUiPanel=function(){this.winbgRender=new UIRenderComponent,this.addRender(this.winbgRender),this.bigPic=new UIRenderOnlyPicComponent,this.addRender(this.bigPic),this.winmidRender=new UIRenderComponent,this.addRender(this.winmidRender),this.wintopRender=new UIRenderComponent,this.addRender(this.wintopRender)},b.prototype.setBlackBg=function(){this._needBlackBg=!0,this._hasInit&&this.addBlackBg()},b.prototype.addBlackBg=function(){this.winBlackBgRender=new UIRenderComponent,this.winBlackBgRender.uiAtlas=WindowUi.winUIAtlas,this.addRenderAt(this.winBlackBgRender,0),this._blackBgUI=this.winBlackBgRender.getComponent("w_black_bg"),this.addChild(this._blackBgUI),this._blackBgUI.addEventListener(InteractiveEvent.Down,function(a){},this),this._blackBgUI.addEventListener(InteractiveEvent.Up,function(a){},this)},b.prototype.makeBaseWinUi=function(){var a=this;WindowUi.winUIAtlas||(WindowUi.winUIAtlas=new UIAtlas),WindowUi.winUIAtlas.configData?this.wintopRender.uiAtlas?this.applyLoad():this.winComplete():WindowUi.winUIAtlas.setInfo("ui/uidata/window/window.xml","ui/uidata/window/window.png",function(){a.winComplete()})},b.prototype.winComplete=function(){this.wintopRender.uiAtlas=WindowUi.winUIAtlas,this.winbgRender.uiAtlas=WindowUi.winUIAtlas,this.baseBg=this.addEvntBut("baseBg",this.winbgRender),this.e_bg=this.addEvntBut("e_bg",this.winbgRender),this.e_bg.addEventListener(InteractiveEvent.Up,this.butClik,this),this.e_tittle_bg_left=this.addChild(this.wintopRender.getComponent("e_tittle_bg")),this.e_height_left=this.addChild(this.winbgRender.getComponent("e_height")),this.e_angle_left=this.addChild(this.wintopRender.getComponent("e_angle")),this.e_tittle_bg_right=this.addChild(this.wintopRender.getComponent("e_tittle_bg")),this.e_height_right=this.addChild(this.winbgRender.getComponent("e_height")),this.e_angle_right=this.addChild(this.wintopRender.getComponent("e_angle")),this.e_width=this.addChild(this.wintopRender.getComponent("e_width")),this.e_close=this.addEvntButUp("e_close",this.wintopRender),this._needBlackBg&&this.addBlackBg(),this._hasInit=!0,this.applyLoad(),this.resize()},b.prototype.resize=function(){a.prototype.resize.call(this),this.wintopRender.uiAtlas&&(this.e_tittle_bg_right.isU=!0,this.e_tittle_bg_right.x=this.e_tittle_bg_left.x+this.e_tittle_bg_left.width-0,this.e_angle_right.isU=!0,this.e_angle_right.x=this.e_tittle_bg_right.x+this.e_tittle_bg_right.width-this.e_angle_right.width-8,this.e_height_right.isU=!0,this.e_height_right.x=this.e_angle_right.x+this.e_angle_right.width-this.e_height_right.width-9,this.winbgRender.applyObjData(),this.wintopRender.applyObjData(),this._blackBgUI&&(this._blackBgUI.left=0,this._blackBgUI.top=0,this._blackBgUI.height=Scene_data.stageHeight/UIData.Scale,this._blackBgUI.width=Scene_data.stageWidth/UIData.Scale))},b.prototype.hide=function(){},b}(UIPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),WindowPopUi=function(a){function b(b){void 0===b&&(b=0);var c=a.call(this)||this;return c._needBlackBg=!1,c._hasInit=!1,c._titlenum=b,c.addWinUiPanel(),c}return __extends(b,a),b.prototype.dispose=function(){this.winbgRender&&(this.winbgRender.uiAtlas=null,this.winbgRender.dispose()),this.winBlackBgRender&&(this.winBlackBgRender.uiAtlas=null,this.winBlackBgRender.dispose()),this.winmidRender&&(this.winmidRender.uiAtlas=null,this.winmidRender.dispose()),this.wintopRender&&(this.wintopRender.uiAtlas=null,this.wintopRender.dispose())},b.prototype.setBlackBg=function(){this._needBlackBg=!0,this._hasInit&&this.addBlackBg()},b.prototype.addBlackBg=function(){this.winBlackBgRender=new UIRenderComponent,this.winBlackBgRender.uiAtlas=WindowUi.winUIAtlas,this.addRenderAt(this.winBlackBgRender,0),this._blackBgUI=this.winBlackBgRender.getComponent("w_black_bg"),this._blackBgUI.addEventListener(InteractiveEvent.Down,function(a){},this),this._blackBgUI.addEventListener(InteractiveEvent.Up,function(a){},this),this.addChild(this._blackBgUI)},b.prototype.addWinUiPanel=function(){this.winbgRender=new UIRenderComponent,this.addRender(this.winbgRender),this.winmidRender=new UIRenderComponent,this.addRender(this.winmidRender),this.wintopRender=new UIRenderComponent,this.addRender(this.wintopRender)},b.prototype.makeBaseWinUi=function(){var a=this;WindowUi.winUIAtlas||(WindowUi.winUIAtlas=new UIAtlas),WindowUi.winUIAtlas.configData?this.wintopRender.uiAtlas?this.applyLoad():this.winComplete():WindowUi.winUIAtlas.setInfo("ui/uidata/window/window.xml","ui/uidata/window/window.png",function(){a.winComplete()})},b.prototype.winComplete=function(){this.wintopRender.uiAtlas=WindowUi.winUIAtlas,this.winbgRender.uiAtlas=WindowUi.winUIAtlas,this.f_bg=this.addChild(this.winbgRender.getComponent("f_bg")),this.f_width=this.addChild(this.wintopRender.getComponent("f_width")),this.f_height_left=this.addChild(this.wintopRender.getComponent("f_height")),this.f_tittle_bg_left=this.addChild(this.wintopRender.getComponent("f_tittle_bg")),this.f_angle_left=this.addChild(this.wintopRender.getComponent("f_angle")),this.f_height_right=this.addChild(this.wintopRender.getComponent("f_height")),this.f_tittle_bg_right=this.addChild(this.wintopRender.getComponent("f_tittle_bg")),this.f_angle_right=this.addChild(this.wintopRender.getComponent("f_angle")),this.f_close=this.addEvntButUp("f_close",this.wintopRender),this._needBlackBg&&this.addBlackBg(),this._hasInit=!0,this.applyLoad()},b.prototype.resize=function(){a.prototype.resize.call(this),this._blackBgUI&&(this._blackBgUI.width=UIData.designWidth,this._blackBgUI.height=UIData.designHeight),this.winbgRender.uiAtlas&&(this.f_tittle_bg_right.isU=!0,this.f_tittle_bg_right.x=this.f_tittle_bg_left.x+this.f_tittle_bg_left.width-1,this.f_height_right.isU=!0,this.f_height_right.x=this.f_tittle_bg_right.x+this.f_tittle_bg_right.width-this.f_height_right.width-19,this.f_angle_right.isU=!0,this.f_angle_right.x=this.f_tittle_bg_right.x+this.f_tittle_bg_right.width-this.f_angle_right.width-21,this.wintopRender.applyObjData())},b.prototype.hide=function(){},b}(UIPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wintittle;!function(a){var b=function(){function a(){}return a}();a.TittleUi=b;var c=function(a){function c(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.tittleUiList=new Array,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(c,a),c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/window/window.xml","ui/uidata/window/window.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._topRender.uiAtlas=this._midRender.uiAtlas,this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.refresh=function(a){if(void 0===a&&(a=null),a){console.log("---到了"),this.clear(),this.showData=a;for(var c=0;c<this.showData.length;c++){var d=new b;d.bg=this.addChild(this._midRender.getComponent("t_res_bg")),d.addbtn=this.addEvntButUp("t_res_add",this._midRender),d.label=this.addChild(this._topRender.getComponent("t_res_frame")),d.label.goToAndStop(c),3==this.showData.length?d.bg.x=145+250*c:2==this.showData.length?d.bg.x=250+300*c:d.bg.x=100+200*c,d.addbtn.x=d.bg.x+d.bg.width,d.label.x=d.bg.x+30,d.typeId=this.showData[c],d.addbtn.data=d,this.tittleUiList.push(d)}}this.drawTxtToCtx()},c.prototype.drawTxtToCtx=function(){for(var a=0;a<this.tittleUiList.length;a++){var b=this.tittleUiList[a],c=b.label,d=c.getSkinCtxRect(),e=GuidData.player.getResTypeStr(b.typeId),f=UIManager.getInstance().getContext2D(d.width,d.height,!1);UiDraw.cxtDrawImg(f,UIuitl.getInstance().costtype(b.typeId),new Rectangle(0,0,35,35),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(f,e,16,0,13,TextAlign.CENTER),c.drawToCtx(this._topRender.uiAtlas,f)}},c.prototype.butClik=function(a){var b=4011,c=a.target.data,d=SharedDef.MODULE_MALL,e=[SharedDef.MODULE_MALL_RECHARGE];c.typeId==SharedDef.MONEY_TYPE_SILVER&&(d=SharedDef.MODULE_MONEYTREE,e=SharedDef.MODULE_MONEYTREE_ALL,b=1121);var f=tb.TB_system_base.getTempVo(b);f.level<=GuidData.player.getLevel()?ModulePageManager.openPanel(d,e):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+f.level+"级后解锁",99)},c.prototype.clear=function(){for(;this.tittleUiList.length;){var a=this.tittleUiList.pop();this.removeChild(a.bg),this.removeChild(a.label),this.removeChild(a.addbtn)}},c}(UIPanel);a.WindowRestTittlePanel=c}(wintittle||(wintittle={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),WindowRankPanel=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b.setBlackBg(),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/window/windowrank.xml","ui/uidata/window/windowrank.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this.labAry=new Array;for(var a=0;3>a;a++)this.labAry.push(this.addChild(this._baseRender.getComponent("t_lab"+a)));this.addUIList(["t_line1","t_line2","t_line3","t_title"],this._baseRender),this.myInfo=this.addChild(this._baseRender.getComponent("t_my")),this.addLists(),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.addLists=function(){this.windowRankSList=new WindowRankSList,this.windowRankSList.init(this._baseUiAtlas)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.butClik=function(a){a.target==this.c_close&&this.hide()},b.prototype.hide=function(){this.windowRankSList.hide(),UIManager.getInstance().removeUIContainer(this)},b.prototype.show=function(a,b,c){for(var d=0;d<this.labAry.length;d++)LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.labAry[d].skinName,a[d],16,TextAlign.CENTER,ColorType.color9a683f);UIManager.getInstance().addUIContainer(this),this.windowRankSList.show(),this.windowRankSList.setRankData(b),""!=c?UiDraw.drawTxtLab(this.myInfo,ColorType.Brown7a2f21+c,14,TextAlign.CENTER,0,5):UiDraw.clearUI(this.myInfo)},b}(WindowCentenMin),WindowRankSList=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){WindowRankSListRender.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array,b=400,c=330;this.setData(a,WindowRankSListRender,b,c,400,33,10,256,512,1,12),this.center=20,this.middle=30},b.prototype.setRankData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;a[c]&&(d.data=a[c],d.id=c,b.push(d))}this.refreshData(b)},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.setShowLevel(2)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList),WindowRankSListRender=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this.r_num=this.creatSUI(e,b.baseAtlas,"s_lab2",261,6,100,20),c.addChild(this.r_num),this.r_name=this.creatSUI(e,b.baseAtlas,"s_lab1",112,6,130,20),c.addChild(this.r_name),this.r_rank=this.creatSUI(e,b.baseAtlas,"s_lab0",20,6,60,20),c.addChild(this.r_rank),this.r_bg=this.creatGrid9SUI(d,b.baseAtlas,"s_bg",0,0,356,33,5,5),c.addChild(this.r_bg)},b.prototype.applyRender=function(){this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.r_bg.skinName,UIData.publicUi,PuiData.LISTITEMBG);var a=this.itdata.data;LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_name.skinName,ColorType.Brown7a2f21+a.name,14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_num.skinName,ColorType.Brown7a2f21+a.val,14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_rank.skinName,ColorType.Brown7a2f21+a.rank,14,TextAlign.CENTER)},b.prototype.render=function(a){this.itdata=a,console.log("--$data----",a),this.itdata&&this.itdata.data?this.applyRender():this.setnull()},b.prototype.setnull=function(){UiDraw.clearUI(this.r_bg),UiDraw.clearUI(this.r_rank),UiDraw.clearUI(this.r_name),UiDraw.clearUI(this.r_num)},b}(SListItem),WindowRankVo=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),WindowResPanel=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b._basebgRender=new UIRenderComponent,b.addRender(b._basebgRender),b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b.layer=310,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/window/windowres.xml","ui/uidata/window/windowres.png",function(){a.loadConfigCom()},"ui/uidata/window/windowpc.png")},b.prototype.loadConfigCom=function(){this._basebgRender.uiAtlas=this._baseUiAtlas,this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.c_basebg=this.addEvntButUp("c_basebg",this._basebgRender),this.c_basebg.addEventListener(InteractiveEvent.Down,function(){},this),this.c_bg=this.addChild(this._bgRender.getComponent("c_bg")),this.c_bg.addEventListener(InteractiveEvent.Up,function(){},this),this.t_slistindex=this.addChild(this._baseRender.getComponent("t_slistindex")),this.c_name=this.addChild(this._baseRender.getComponent("c_name")),this.c_icon=this.addChild(this._baseRender.getComponent("c_icon")),this.addLists(),this.resize(),this.applyLoadComplete()},b.prototype.addLists=function(){this.windowResSList=new WindowResSList,this.windowResSList.init(this._baseUiAtlas)},b.prototype.resize=function(){this.c_basebg.top=0,this.c_basebg.left=0,this.c_basebg.y=0,this.c_basebg.x=0,this.c_basebg.height=Scene_data.stageHeight/UIData.Scale,this.c_basebg.width=Scene_data.stageWidth/UIData.Scale,a.prototype.resize.call(this),this.windowResSList&&(this.windowResSList.left=this.t_slistindex.parent.x/UIData.Scale+this.t_slistindex.x,this.windowResSList.top=this.t_slistindex.parent.y/UIData.Scale+this.t_slistindex.y)},b.prototype.butClik=function(a){a.target==this.c_basebg&&this.hide()},b.prototype.hide=function(){this.windowResSList.hide(),UIManager.getInstance().removeUIContainer(this)},b.prototype.show=function(a){this.hasStage||(UIManager.getInstance().addUIContainer(this),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.c_name.skinName,getResName(a),16,TextAlign.CENTER,ColorType.Whiteffeed0),IconManager.getInstance().drawItemIcon60(this.c_icon,a,0,!1,!1),this.windowResSList.show(a))},b}(UIPanel),WindowResSList=function(a){function b(){var b=a.call(this)||this;return b.layer=320,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,WindowResSListRender,373,120,0,55,2,128,256,1,4)},b.prototype.setResData=function(a){var b=tb.TB_item_template.get_TB_item_template(a);if(b.output&&b.output.length>0){for(var c=new Array,d=0;d<b.output.length;d++){var e=tb.TB_item_output.get_TB_item_output(b.output[d]),f=new SListItemData;f.data=e,f.id=d,c.push(f)}this.refreshData(c)}else console.log(a,"道具表没有配置获取途径      ")},b.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),this.setResData(a)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList),WindowResSListRender=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.Resinfo=this.creatSUI(d,this.parentTarget.baseAtlas,"Resinfo",47,16,120,20),b.addChild(this.Resinfo),this.Resbg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"Resbg",0,0,373,51,4,4),b.addChild(this.Resbg),this.Resbtn=this.creatSUI(d,this.parentTarget.baseAtlas,"Resbtn",275,8,82,36),b.addChild(this.Resbtn),this.Resbtn.addEventListener(InteractiveEvent.Up,this.RewardClik,this)},b.prototype.applyRender=function(){var a=this.itdata.data;UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Resbg.skinName,UIData.publicUi,PuiData.RESBG),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Resinfo.skinName,ColorType.color903713+(this.itdata.id+1)+"."+a.name,16,TextAlign.LEFT),UiDraw.SharedDrawImg(this._baseRender.uiAtlas,this.parentTarget.baseAtlas,this.Resbtn.skinName,"GoBtn")},b.prototype.render=function(a){this.itdata=a,console.log("--$data----",a),this.itdata&&this.itdata.data?this.applyRender():this.setnull()},b.prototype.RewardClik=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){ModuleEventManager.dispatchEvent(new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.HIDE_WINDOW_RES_PANEL));var b=this.itdata.data,c=b.output.shift();ModulePageManager.openPanel(c,b.output)}},b.prototype.setnull=function(){UiDraw.clearUI(this.Resbtn),UiDraw.clearUI(this.Resbg),UiDraw.clearUI(this.Resinfo)},b}(SListItem),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wintittle;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"WindowRestTittleModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.WindowRestTittleModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_WINDOW_RES_TITTLE_PANEL="SHOW_WINDOW_RES_TITTLE_PANEL",b.HIDE_WINDOW_RES_TITTLE_PANEL="HIDE_WINDOW_RES_TITTLE_PANEL",b.SHOW_WINDOW_RES_PANEL="SHOW_WINDOW_RES_PANEL",b.HIDE_WINDOW_RES_PANEL="HIDE_WINDOW_RES_PANEL",b}(BaseEvent);a.WindowRestTittleEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"WindowRestTittleProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_WINDOW_RES_TITTLE_PANEL&&(this.hidePanel(),this.showPanel(b.data)),this.donationPanel&&b.type==c.HIDE_WINDOW_RES_TITTLE_PANEL&&(UIManager.getInstance().hasWindowUI()||this.hidePanel()),b.type==c.SHOW_WINDOW_RES_PANEL?this.showResPanel(b.data):b.type==c.HIDE_WINDOW_RES_PANEL&&this.hideResPanel()}a instanceof EngineEvent&&this.donationPanel&&this.donationPanel.refresh()},d.prototype.hidePanel=function(){this.donationPanel&&UIManager.getInstance().removeUIContainer(this.donationPanel)},d.prototype.showPanel=function(b){var c=this;this.donationPanel||(this.donationPanel=new a.WindowRestTittlePanel),this.donationPanel.load(function(){c.donationPanel.refresh(b),UIManager.getInstance().addUIContainer(c.donationPanel)},!1)},d.prototype.showResPanel=function(a){var b=this;this.windowResPanel||(this.windowResPanel=new WindowResPanel),this.windowResPanel.load(function(){b.windowResPanel.show(a)},!1)},d.prototype.hideResPanel=function(){this.windowResPanel&&this.windowResPanel.hide()},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_WINDOW_RES_TITTLE_PANEL),new c(c.HIDE_WINDOW_RES_TITTLE_PANEL),new c(c.SHOW_WINDOW_RES_PANEL),new c(c.HIDE_WINDOW_RES_PANEL),new EngineEvent(EngineEvent.MONEY_CHANGE)]},d}(BaseProcessor);a.WindowRestTittleProcessor=d}(wintittle||(wintittle={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),popbuy;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.isEnough=!1,b.selectNum=1,b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;
this._midRender.uiAtlas.setInfo("ui/uidata/window/popbuy/popbuy.xml","ui/uidata/window/popbuy/popbuy.png",function(){a.loadConfigCom()})},b.prototype.setSizeForPanelUi=function(a,b){var c=this._midRender.getComponent(b);a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.a_cancal=this.addEvntButUp("a_cancal",this._midRender),this.a_submit=this.addEvntButUp("a_submit",this._midRender),this.addChild(this._bottomRender.getComponent("a_bg")),this.addChild(this._bottomRender.getComponent("a_tatol_label")),this.addChild(this._bottomRender.getComponent("a_num_bg1")),this.addChild(this._bottomRender.getComponent("a_num_bg0")),this.a_info_tittle=this.addChild(this._bottomRender.getComponent("a_info_tittle")),this.a_tittle=this.addChild(this._bottomRender.getComponent("a_tittle")),this.a_sub_but=this.addEvntButUp("a_sub_but",this._bottomRender),this.a_add_but=this.addEvntButUp("a_add_but",this._bottomRender),this.a_res_icon=this.addChild(this._topRender.getComponent("a_res_icon")),this.a_need_money=this.addChild(this._topRender.getComponent("a_need_money")),this.a_select_num=this.addChild(this._topRender.getComponent("a_select_num")),this.uiAtlasComplet=!0,this.a_info2=this.addChild(this._topRender.getComponent("a_buildinfo")),this.applyLoadComplete()},b.prototype.refresh=function(a){console.log(a),this.selectNum=1,this.seletEvent=a,this.drawLabelNum()},b.prototype.butClik=function(a){switch(a.target){case this.a_sub_but:this.toPrent();break;case this.a_add_but:this.toNext();break;case this.a_submit:this.sendSelectNum();break;case this.a_cancal:case this.f_close:this.hide()}},b.prototype.sendSelectNum=function(){var a=this;costRes([this.seletEvent.resoureItem[0][0],this._totalNum],function(){a.seletEvent.SubmitFun(a.selectNum)},function(){})},b.prototype.drawLabelNum=function(){var a=this.seletEvent.cutNum,b=ColorType.Orange853d07+this.seletEvent.Info1+ColorType.colorce0a00+a+ColorType.Orange853d07+"次";LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_info_tittle.skinName,b,18,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_info2.skinName,ColorType.Orange853d07+this.seletEvent.Info2,16,TextAlign.CENTER),this.selectNum=Math.max(0,this.selectNum),this.selectNum=Math.min(a,this.selectNum),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_select_num.skinName,ColorType.Orange853d07+String(this.selectNum),18,TextAlign.CENTER);for(var c=0,d=0;d<this.selectNum;d++)if(this.seletEvent.resoureItem.length>1){var e=this.seletEvent.resoureItem.length-a;c+=this.seletEvent.resoureItem[d+e][1]}else c+=this.seletEvent.resoureItem[0][1];this._totalNum=c;var f=this.seletEvent.resoureItem[0][0];UiDraw.uiAtlasDrawImg(this._midRender.uiAtlas,this.a_res_icon.skinName,UIData.publicUi,UIuitl.getInstance().costtype(f));var g=0;g=GuidData.player.getResType(f),this.isEnough=g>=c,console.log(f,g,"/",c);var h=this.isEnough?ColorType.Orange853d07:ColorType.colorce0a00;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_need_money.skinName,h+String(c),18,TextAlign.CENTER)},b.prototype.toPrent=function(){this.selectNum--,this.drawLabelNum()},b.prototype.toNext=function(){this.selectNum++,this.drawLabelNum()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(WindowPopUi);a.PopBuyPanel=b}(popbuy||(popbuy={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),popbuy;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"PopBuyModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.PopBuyModule=b;var c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Info1="次数剩余",b.Info2="",b}return __extends(b,a),b.SHOW_POPBUY_PANEL="SHOW_POPBUY_PANEL",b.HIDE_POPBUY_PANEL="HIDE_POPBUY_PANEL",b}(BaseEvent);a.PopBuyEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"PopBuyProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_POPBUY_PANEL&&(a.resoureItem.length>0?this.showPanel(a):msgtip.MsgTipManager.outStr("[ff0000]今日次数已用完",99)),this.exchangepPanel&&b.type==c.HIDE_POPBUY_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.exchangepPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.exchangepPanel||(this.exchangepPanel=new a.PopBuyPanel),this.exchangepPanel.load(function(){UIManager.getInstance().addUIContainer(c.exchangepPanel),c.exchangepPanel.refresh(b)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_POPBUY_PANEL),new c(c.HIDE_POPBUY_PANEL)]},d}(BaseProcessor);a.PopBuyProcessor=d}(popbuy||(popbuy={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),PopWindowMin=function(a){function b(){var b=a.call(this)||this;return b.addWinUiPanel(),b}return __extends(b,a),b.prototype.addWinUiPanel=function(){this.winbgRender=new UIRenderComponent,this.addRender(this.winbgRender),this.winmidRender=new UIRenderComponent,this.addRender(this.winmidRender),this.wintopRender=new UIRenderComponent,this.addRender(this.wintopRender)},b.prototype.makeBaseWinUi=function(){var a=this;b.winUIAtlas||(b.winUIAtlas=new UIAtlas),b.winUIAtlas.configData?this.wintopRender.uiAtlas?this.applyLoad():this.winComplete():b.winUIAtlas.setInfo("ui/uidata/window/popwin/popwin.xml","ui/uidata/window/popwin/popwin.png",function(){a.winComplete()})},b.prototype.winComplete=function(){this.wintopRender.uiAtlas=b.winUIAtlas,this.winbgRender.uiAtlas=b.winUIAtlas,this.addChild(this.winbgRender.getComponent("b_win_bg")),this.addChild(this.wintopRender.getComponent("b_tittle_bg")),this.applyLoad()},b.prototype.hide=function(){},b}(UIPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),linklist;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b._midRender=new UIRenderComponent,b.addRender(b._midRender),b}return __extends(b,a),b.prototype.applyLoad=function(){this._midRender.uiAtlas=new UIAtlas,this.applyLoadComplete()},b.prototype.butClik=function(a){UIManager.getInstance().removeUIContainer(this)},b}(WindowCentenMin);a.LinkListPanel=b}(linklist||(linklist={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),login;!function(a){var b=function(a){function b(){return a.call(this)||this}return __extends(b,a),b}(Person2DChar),c=function(a){function c(){var b=a.call(this)||this;return b._mainType=1,b._raceBgPos=[[18,89],[30,229],[55,357]],b._raceBgSelPos=[-15,-13],b._roYNum=0,b._raceType=0,b._genderType=0,b.genderUint=1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._baImg=new UIBackImg,b._baImg.setImgInfo("ui/load/charbg.jpg",1024,512),b.addRender(b._baImg),b._baseBgRender=new UIRenderComponent,b.addRender(b._baseBgRender),b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._baseUiAtlas=new UIAtlas,b._leftTop=new UIVirtualContainer,b._leftTop.width=b.width,b._leftTop.height=b.height,b._leftTop.left=0,b._leftTop.top=0,b.addVirtualContainer(b._leftTop),b._rightTop=new UIVirtualContainer,b._rightTop.width=b.width,b._rightTop.height=b.height,b._rightTop.right=0,b._rightTop.top=0,b.addVirtualContainer(b._rightTop),b._leftBottom=new UIVirtualContainer,b._leftBottom.width=b.width,b._leftBottom.height=b.height,b._leftBottom.left=0,b._leftBottom.bottom=0,b.addVirtualContainer(b._leftBottom),b._rightBottom=new UIVirtualContainer,b._rightBottom.width=b.width,b._rightBottom.height=b.height,b._rightBottom.right=0,b._rightBottom.bottom=0,b.addVirtualContainer(b._rightBottom),Engine.resReady(),b}return __extends(c,a),c.prototype.dispose=function(){this._baImg.dispose(),this._baImg=null,this._baseRender.dispose(),this._baseRender=null,this._bgRender.dispose(),this._bgRender=null},c.prototype.setData=function(a){var b=this;this._data=a,""!=this._data.queen_name&&(this._mainType=1),this._baseUiAtlas.setInfo("ui/uidata/login/loginnew.xml","ui/uidata/login/loginnew.png",function(){b.loadConfigCom()})},c.prototype.initUI=function(){this.bg1=this._baseBgRender.getComponent("t_bg1"),this._leftTop.addChild(this.bg1),this.bg2=this._baseBgRender.getComponent("t_bg2"),this._rightTop.addChild(this.bg2);var a=this._bgRender.getComponent("t_back1");this._leftTop.addChild(a);var b=this._bgRender.getComponent("t_back2");this._leftTop.addChild(b);var c=this._bgRender.getComponent("t_info0");this._rightBottom.addChild(c),this._qiangkeBtn=this._baseRender.getComponent("t_qiangke"),this.addChild(this._qiangkeBtn),this._qiangkeBtn.addEventListener(InteractiveEvent.Down,this.raceClick,this),this._jiankeBtn=this._baseRender.getComponent("t_jianke"),this.addChild(this._jiankeBtn),this._jiankeBtn.addEventListener(InteractiveEvent.Down,this.raceClick,this),this._daoshiBtn=this._baseRender.getComponent("t_daoshi"),this.addChild(this._daoshiBtn),this._daoshiBtn.addEventListener(InteractiveEvent.Down,this.raceClick,this),this._raceUnselBg1=this._bgRender.getComponent("t_unsel1"),this.addChild(this._raceUnselBg1),this._raceUnselBg2=this._bgRender.getComponent("t_unsel2"),this.addChild(this._raceUnselBg2),this._raceSelBg=this._bgRender.getComponent("t_sel"),this.addChild(this._raceSelBg),0!=this._mainType?(this.maleBtn=this._baseRender.getComponent("t_male"),this._leftBottom.addChild(this.maleBtn),this.maleBtn.addEventListener(InteractiveEvent.Down,this.genderClick,this),this.femaleBtn=this._baseRender.getComponent("t_female"),this._leftBottom.addChild(this.femaleBtn),this.femaleBtn.addEventListener(InteractiveEvent.Down,this.genderClick,this),this.genderBg=this._baseRender.getComponent("t_sex_bg"),this._leftBottom.addChild(this.genderBg)):this._genderType=1,this.nameBgUI=this.addEvntBut("t_name_bg",this._bgRender),this.nameUI=this._baseRender.getComponent("t_name"),this.addChild(this.nameUI),this.timeUI=this._bgRender.getComponent("t_sec"),this._rightBottom.addChild(this.timeUI),this.randomBtn=this.addEvntBut("t_random",this._baseRender),this.enterBtn=this._baseRender.getComponent("t_enter"),this._rightBottom.addChild(this.enterBtn),this.enterBtn.addEventListener(InteractiveEvent.Up,this.enterGame,this),this.addChar();var d=Math.random(),e=0;d=.333>d?0:.666>e?1:2,this.setRaceType(d),this.setGenderType(Math.random()>.5?0:1),this.getRandomName(),sessionStorage.getItem("name")&&""!=sessionStorage.getItem("name")&&this.setNameLable(sessionStorage.getItem("name"))},c.prototype.initQueenUI=function(){var a=this;this.iconUI=this._baseRender.getComponent("t_icon"),this._rightTop.addChild(this.iconUI),this.facUI=this._baseRender.getComponent("t_fac"),this._rightTop.addChild(this.facUI),this.queenUI=this._baseRender.getComponent("t_queen"),this._rightTop.addChild(this.queenUI),LoadManager.getInstance().load(getQueenIconUrl(this._data.icon),LoadManager.IMG_TYPE,function(b){var c=a._baseUiAtlas.getRec(a.iconUI.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(b,0,0,60,60,0,0,60,60),a._baseUiAtlas.updateCtx(d,c.pixelX,c.pixelY)}),1==this._mainType&&(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.facUI.skinName,"家族:"+getBaseName(this._data.faction_name),15,TextAlign.LEFT,ColorType.Yellowedce7e),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.queenUI.skinName,"女王:"+getBaseName(this._data.queen_name),15,TextAlign.LEFT,ColorType.Yellowedce7e))},c.prototype.butClik=function(a){var b=this;switch(a.target){case this.nameBgUI:InputPanel.show(function(a){b.setNameLable(a)},"");break;case this.randomBtn:this.getRandomName();break;case this.enterBtn:this.enterGame()}},c.prototype.addChar=function(){var a=this;this["char"]=new b,this["char"].bindZero=!0,this["char"].setCamData(-10,-90,800),this._baseRender.addModel(this["char"]),this["char"].lightData=[[.2,.2,.2*202/255],[-.6126,.783,-.1],[.5,.5,101/255]],TimeUtil.addFrameTick(function(){a._roYNum+=.01,a["char"].rotationY=30*Math.sin(a._roYNum)}),this.resize()},c.prototype.resize=function(){a.prototype.resize.call(this),this["char"]&&(this["char"].resize(),this["char"].scale=1.8*UIData.Scale,this["char"].y=-120*UIData.Scale),this.bg1&&this.bg2&&(this.bg1.height=Scene_data.stageHeight/UIData.Scale,this.bg2.height=(Scene_data.stageHeight-60)/UIData.Scale)},c.prototype.raceClick=function(a){switch(a.target){case this._jiankeBtn:this.setRaceType(0);break;case this._qiangkeBtn:this.setRaceType(1);break;case this._daoshiBtn:this.setRaceType(2)}},c.prototype.genderClick=function(a){switch(a.target){case this.maleBtn:this.setGenderType(0);break;case this.femaleBtn:this.setGenderType(1)}},c.prototype.setRaceType=function(a){0==a?(this._jiankeBtn.goToAndStop(1),this._qiangkeBtn.goToAndStop(0),this._daoshiBtn.goToAndStop(0),this._raceSelBg.setPos(this._raceBgPos[0][0]+this._raceBgSelPos[0],this._raceBgPos[0][1]+this._raceBgSelPos[1]),this._raceUnselBg1.setPos(this._raceBgPos[1][0],this._raceBgPos[1][1]),this._raceUnselBg2.setPos(this._raceBgPos[2][0],this._raceBgPos[2][1])):1==a?(this._jiankeBtn.goToAndStop(0),this._qiangkeBtn.goToAndStop(1),this._daoshiBtn.goToAndStop(0),this._raceUnselBg1.setPos(this._raceBgPos[0][0],this._raceBgPos[0][1]),this._raceSelBg.setPos(this._raceBgPos[1][0]+this._raceBgSelPos[0],this._raceBgPos[1][1]+this._raceBgSelPos[1]),this._raceUnselBg2.setPos(this._raceBgPos[2][0],this._raceBgPos[2][1])):2==a&&(this._jiankeBtn.goToAndStop(0),this._qiangkeBtn.goToAndStop(0),this._daoshiBtn.goToAndStop(1),this._raceUnselBg1.setPos(this._raceBgPos[0][0],this._raceBgPos[0][1]),this._raceUnselBg2.setPos(this._raceBgPos[1][0],this._raceBgPos[1][1]),this._raceSelBg.setPos(this._raceBgPos[2][0]+this._raceBgSelPos[0],this._raceBgPos[2][1]+this._raceBgSelPos[1])),this._raceType=a,this.applyShow()},c.prototype.setGenderType=function(a){var b=!1;this._genderType!=a&&(b=!0),this.genderBg.goToAndStop(a),this._genderType=a,this.applyShow(),b&&this.getRandomName()},c.prototype.applyShow=function(){var a=0;0==this._raceType?(a=0==this._genderType?5:6,this["char"].setCamData(-10,-20,800)):1==this._raceType?(a=0==this._genderType?1:2,this["char"].setCamData(-10,-90,800)):2==this._raceType&&(a=0==this._genderType?3:4,this["char"].setCamData(-10,0,800)),this.genderUint=a,this["char"].addPart("sss","none",getModelUrl(String(50020+a)))},c.prototype.loadConfigCom=function(){this._baseBgRender.uiAtlas=this._baseUiAtlas,this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.initUI(),this.timeEnter(),this.loadName()},c.prototype.loadName=function(){var a=this;LoadManager.getInstance().load(Scene_data.fileRoot+"data/gamename.txt",LoadManager.XML_TYPE,function(b){var c=b.split("\n");a.nameDic=new Object,a.nameDic.xing=c[0].split(","),a.nameDic.nan=c[1].split(","),a.nameDic.nv=c[2].split(","),a.nameDic.xingl=a.nameDic.xing.length,a.nameDic.nanl=a.nameDic.nan.length,a.nameDic.nvl=a.nameDic.nv.length,a.getRandomName()})},c.prototype.timeEnter=function(){var a=this,b=30,c=function(){b--,LabelTextFont.writeSingleLabel(a._baseUiAtlas,a.timeUI.skinName,String(b),16,TextAlign.RIGHT,ColorType.colorce0a00),0==b&&(a.enterGame(),TimeUtil.removeTimeTick(c))};TimeUtil.addTimeTick(1e3,c)},c.prototype.enterGame=function(a){void 0===a&&(a=null);var b=this._nameStr;if(b.length>6)return void AlertUtil.show("名字不能超过6个字符","",null,1);if(b.length){var c=new char_create_info;c.faction=0,c.hair_id=0,c.head_id=0,c.level=1,c.race=0,c.gender=this.genderUint,c.name=b,c.inviteGuid="",getUrlParam("inviteGuid")?c.inviteGuid=getUrlParam("inviteGuid"):c.faction_name=b+"的家族",console.log(" info.inviteGuid=======>",c.inviteGuid),NetManager.getInstance().protocolos.char_create(c)}document.body.ontouchend=function(a){a.preventDefault()}},c.prototype.getRandomName=function(){var a;if(this.nameDic)a=this.nameDic.xing[float2int(this.nameDic.xingl*Math.random())],a+=0==this._genderType?this.nameDic.nan[float2int(this.nameDic.nanl*Math.random())]:this.nameDic.nv[float2int(this.nameDic.nvl*Math.random())];else{var b=["陈","成","程","池","褚","淳于","崔","代","单","单于","福","澹台","狄","帝","东","龚","东方","东郭","独孤","杜","端木","段","朵","樊","范"],c=["傲风","傲之","霸","柏舟","半夏","邦少","彼岸","伯光","伯雷","伯庸","博风","不败","不悔","展天","残夜","残竹","沧海","浩云","皓轩","皓月","和风"];a=b[float2int(b.length*Math.random())]+c[float2int(c.length*Math.random())]}this.setNameLable(a)},c.prototype.setNameLable=function(a){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.nameUI.skinName,a,16,TextAlign.CENTER,ColorType.Yellowffe9b4),0==this._mainType&&LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.facUI.skinName,"家族:"+a+"的家族",15,TextAlign.LEFT,ColorType.Yellowedce7e),this._nameStr=a},c.prototype.close=function(){UIManager.getInstance().removeUIContainer(this)},c}(UIPanel);a.LoginNewPanel=c}(login||(login={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),LoginProcessor=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getName=function(){return"LoginProcessor"},b.prototype.receivedModuleEvent=function(a){var b=this;if(a instanceof LoginEvent){GameData.mergeServerMsgVo||(GameData.mergeServerMsgVo=new MergeServerMsgVo);var c=a;if(c.type==LoginEvent.CREAT_LOGIN_UI_EVENT);else if(c.type==LoginEvent.LOGIN_CONNET_EVENT)FpsMc.tipStr="正在连接服务器..",GameData.mergeServerMsgVo.type==SharedDef.MERGE_TYPE_GAME_TO_PK&&(console.log("跨服进行中$$$$$$$$$$$$$$$$$$$"),console.log(GameData.mergeServerMsgVo.host,GameData.mergeServerMsgVo.port),console.log(GameData.mergeServerMsgVo)),NetManager.getInstance().connect(GameData.mergeServerMsgVo.host,GameData.mergeServerMsgVo.port,function(){b.onConnet()});else if(c.type==LoginEvent.LOGIN_RECONNET_EVENT)this.onConnet();else if(c.type==LoginEvent.LOGIN_OUTLINE_RECONNET_EVENT)this.reConnet();else if(c.type==LoginEvent.LOGIN_ENTER_EVENT){if(!this._scList)return;TimeUtil.addTimeOut(300,function(){b.sendEnterServer()})}}},b.prototype.reConnet=function(){},b.prototype.onConnet=function(){GuidData.map&&(GuidData.map.dispose(),GuidData.map=null),FpsMc.tipStr="服务器连接成功..";var a=sessionStorage.getItem("name");Boolean(a)||(a=localStorage.getItem("name")),GameStart.outNet&&(a||(a="test"+float2int(1e4*Math.random()),localStorage.setItem("name",a))),a?(-1!=a.search("MO")&&(Scene_data.isPanGm=!0),GameData.mergeServerMsgVo.key?(console.log("跨服的key","----------------------"),console.log(GameData.mergeServerMsgVo.key)):GameData.mergeServerMsgVo.makeBaseKey(),console.log("#############################发送",GameData.mergeServerMsgVo.key),NetManager.getInstance().protocolos.get_session(GameData.mergeServerMsgVo.key,"","")):window.location.href="login.html"},b.prototype.loadSceneCom=function(){var a=new SceneLoadEvent(SceneLoadEvent.ANALYSIS_LOAD_EVENT);ModuleEventManager.dispatchEvent(a)},b.prototype.initUI=function(){this._loginNewPanel||(this._loginNewPanel=new login.LoginNewPanel,this._loginNewPanel.setData(this._scList)),UIManager.getInstance().addUIContainer(this._loginNewPanel)},b.prototype.loadProgress=function(a){var b=new SceneLoadEvent(SceneLoadEvent.PROGRESS_LOAD_EVENT);b.progress=a,ModuleEventManager.dispatchEvent(b)},b.prototype.listenModuleEvents=function(){return[new LoginEvent(LoginEvent.CREAT_LOGIN_UI_EVENT),new LoginEvent(LoginEvent.LOGIN_CONNET_EVENT),new LoginEvent(LoginEvent.LOGIN_RECONNET_EVENT),new LoginEvent(LoginEvent.LOGIN_ENTER_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},b.prototype.getCharList=function(a){var b=this;console.log("getUrlParam",getUrlParam("name")),this._scList=new s2c_chars_list,s2c_chars_list.read(this._scList,a),this._time=TimeUtil.getTimer(),GameStart.ready&&(GameData.mergeServerMsgVo.type==SharedDef.MERGE_TYPE_GAME_TO_PK?TimeUtil.addTimeOut(300,function(){kuafu.KuaFu3v3Model.getInstance().mergeTypeGameToPk()}):TimeUtil.addTimeOut(300,function(){console.log("直接发送登录"),b.sendEnterServer()}))},b.prototype.sendEnterServer=function(){if(this._scList){if(0==this._scList.list.length)this.initUI(),GameData.initGMbg=!0;else{var a=this._scList.list[0];NetManager.getInstance().protocolos.player_login(a.guid)}FpsStage.getInstance().removeShowLoad()}},b.prototype.enterServer=function(a){var b=new s2c_join_or_leave_server;s2c_join_or_leave_server.read(b,a),console.log("进入服务器："+b.server_fd+","+b.server_pid+","+new Date(b.time).toDateString()),this._loginNewPanel&&(this._loginNewPanel.close(),this._loginNewPanel=null)},b.prototype.setGmBg=function(){GuidData.player&&GameData.initGMbg&&(GameData.initGMbg=!1)},b.prototype.smsgMergeServerMsg=function(a){NetManager.getInstance().close(),GuidObjManager.getInstance().dispose(),UIManager.getInstance().removeAll(),GameData.mergeServerMsgVo=new MergeServerMsgVo,GameData.mergeServerMsgVo.readData(a),ModuleEventManager.dispatchEvent(new LoginEvent(LoginEvent.LOGIN_CONNET_EVENT))},b.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_CHARS_LIST]=function(b){a.getCharList(b)},b[Protocols.SMSG_JOIN_OR_LEAVE_SERVER]=function(b){a.enterServer(b)},b[Protocols.SMSG_MERGE_SERVER_MSG]=function(b){a.smsgMergeServerMsg(b)},b},b}(BaseProcessor),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),LoginEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.LOGIN_CONNET_EVENT="login_connet_event",b.CREAT_LOGIN_UI_EVENT="creat_login_ui_event",b.REMOVE_LOGIN_UI_EVENT="remove_login_ui_event",b.LOGIN_RECONNET_EVENT="login_reconnet_event",b.LOGIN_OUTLINE_RECONNET_EVENT="login_outline_reconnet_event",b.LOGIN_ENTER_EVENT="login_enter_event",b}(BaseEvent),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),LoginModule=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"LoginModule"},b.prototype.listProcessors=function(){return[new LoginProcessor]},b}(Module),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneLoadUI=function(a){function b(){var b=a.call(this)||this;return b.skipNum=0,b.width=400,b.height=80,b.center=0,b.bottom=50,b._baImg=new UIBackImg,b.addRender(b._baImg),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b.loadConfigCom(),b}return __extends(b,a),b.prototype.loadBackImg=function(a){this._baImg.setImgInfo(a,1024,512)},b.prototype.loadConfigCom=function(){var a=this;this._baseRender.uiAtlas=new UIAtlas,this._midRender.uiAtlas=this._baseRender.uiAtlas;var b=this._baseRender.uiAtlas;b.configData=new Array,b.configData.push(b.getObject("numLabel",0,40,100,18,256,64)),b.configData.push(b.getObject("numText",100,40,60,20,256,64)),b.configData.push(b.getObject("barA",0,0,15,16,256,64)),b.configData.push(b.getObject("barB",15,0,24,16,256,64)),b.configData.push(b.getObject("barC",39,0,15,16,256,64)),b.configData.push(b.getObject("backA",100,0,20,32,256,64)),b.configData.push(b.getObject("backB",122,0,15,32,256,64)),b.configData.push(b.getObject("backC",144,0,20,32,256,64)),b.configData.push(b.getObject("flashMc",192,0,64,64,256,64)),b.ctx=UIManager.getInstance().getContext2D(256,64,!1),UiDraw.cxtDrawImg(b.ctx,"load_yellow_bar",new Rectangle(0,0,54,16),UIData.textlist),UiDraw.cxtDrawImg(b.ctx,"load_yellow_bg",new Rectangle(100,0,64,32),UIData.textlist),UiDraw.cxtDrawImg(b.ctx,"load_flash",new Rectangle(192,0,64,64),UIData.textlist),UiDraw.cxtDrawImg(b.ctx,"load_txt",new Rectangle(0,40,100,20),UIData.textlist),b.textureRes=TextureManager.getInstance().getCanvasTexture(b.ctx);var c=this._baseRender.creatBaseComponent("backA");c.x=-20,this.addChild(c);var d=this._baseRender.creatBaseComponent("backB");d.x=0,d.width=398,this.addChild(d);var e=this._baseRender.creatBaseComponent("backC");e.x=d.width+d.x,this.addChild(e);var f=this._midRender.creatBaseComponent("barA");f.x=2,f.y=7,this.addChild(f),this.barB=this._midRender.creatBaseComponent("barB"),this.barB.x=13,this.barB.y=f.y,this.addChild(this.barB),this.barC=this._midRender.creatBaseComponent("barC"),this.barC.x=26,this.barC.y=f.y,this.addChild(this.barC);var g=this._baseRender.creatBaseComponent("numLabel");g.y=42,g.x=3,this.addChild(g);var h=this._baseRender.creatBaseComponent("numText");h.y=40,h.x=100,this.addChild(h),this.flashMc=this._midRender.creatBaseComponent("flashMc"),this.flashMc.x=0,this.flashMc.y=-15,this.addChild(this.flashMc),this.setProgress(.01),this.upDataFun=function(){a.updData(0)}},b.prototype.remove=function(){TimeUtil.removeFrameTick(this.upDataFun)},b.prototype.show=function(){TimeUtil.addFrameTick(this.upDataFun)},b.prototype.updData=function(a){if(this.barB){this.skipNum>50&&(this.skipNum=0);for(var b="",c=0;c<this.skipNum/10;c++)b+=".";ArtFont.getInstance().upArtFont(this._baseRender.uiAtlas,"numText",b,15,ArtFont.Yellow,TextAlign.LEFT),this.skipNum++}},b.prototype.setProgress=function(a){this.barB&&(this.barB.width=369*a,this.barC.x=this.barB.width+this.barB.x,this.barB.x=13,this.flashMc.x=this.barC.x-20)},b.prototype.setTxt=function(a){},b.prototype.resize=function(){a.prototype.resize.call(this),this._baImg.resize()},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneTransitionUI=function(a){function b(){var b=a.call(this)||this;return b.width=400,b.height=80,b.center=0,b.bottom=50,b._baImg=new SceneTransitionImg,b.addRender(b._baImg),b._baImg.setImgInfo("ui/load/transition.jpg",1024,512),b._baImg.sortnum=-1,b}return __extends(b,a),b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this._baImg.alpha=0,TweenLite.to(this._baImg,.5,{alpha:1})},b.prototype.hide=function(){TweenLite.to(this._baImg,.5,{alpha:0})},b.prototype.resize=function(){a.prototype.resize.call(this),this._baImg.resize()},b}(UIConatiner),SceneTransitionImg=function(a){function b(){var b=a.call(this)||this;return b._scaleData=[1,1],b.alpha=1,b.vOffset=0,b}return __extends(b,a),b.prototype.initData=function(){this.objData=new ObjData,ProgrmaManager.getInstance().registe(SceneTransitionShader.SCENE_TRANSITION_SHADER,new SceneTransitionShader),this.shader=ProgrmaManager.getInstance().getProgram(SceneTransitionShader.SCENE_TRANSITION_SHADER),this.program=this.shader.program,this.objData.vertices.push(-1,1,0,1,1,0,1,-1,0,-1,-1,0),this.objData.uvs.push(0,0,1,0,1,1,0,1),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=6,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)},b.prototype.resize=function(){this.appleyPos()},b.prototype.setImgInfo=function(a,b,c){this.setImgUrl(a),this._width=b,this._height=c},b.prototype.appleyPos=function(){var a=this._width/Scene_data.stageWidth,b=this._height/Scene_data.stageHeight;b>a?(this._scaleData[0]=1,this._scaleData[1]=this._height/Scene_data.stageHeight/a):(this._scaleData[0]=this._width/Scene_data.stageWidth/b,this._scaleData[1]=1)},b.prototype.update=function(){this.vOffset-=.08,this.objData&&this.texture&&(Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),Scene_data.context3D.setVc2fv(this.shader,"scale",this._scaleData),Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),Scene_data.context3D.setVcFloat(this.shader,"alpha",[this.alpha]),Scene_data.context3D.setVcFloat(this.shader,"voffset",[this.vOffset]),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},b.prototype.interactiveEvent=function(a){return!0},b}(UIRenderComponent),SceneTransitionShader=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec2 v2uv;uniform vec2 scale;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2uv.x, v2uv.y);   vec4 vt0= vec4(v3Pos.x*scale.x,v3Pos.y*scale.y,v3Pos.z,1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nuniform float alpha;uniform float voffset;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec2 uvs = vec2(v_texCoord.x,v_texCoord.y + voffset);\nvec4 infoUv = texture2D(s_texture, uvs);\ninfoUv.w = alpha;\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}";return a},b.SCENE_TRANSITION_SHADER="Scene_Transition_Shader",b}(Shader3D),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneLoadEvent=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.progress=0,b}return __extends(b,a),b.SHOW_LOAD_EVENT="show_load_event",b.REMOVE_LOAD_EVENT="remove_load_event",b.PROGRESS_LOAD_EVENT="progress_load_event",b.ANALYSIS_LOAD_EVENT="analysis_load_event",b.INFO_EVENT="info_event",b.SCENE_TRANSITION_EVENT="scene_transition_event",b.SCENE_TRANSITION_HIDE_EVENT="scene_transition_hide_event",b}(BaseEvent),SceneLoadModule=function(a){
function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"SceneLoadModule"},b.prototype.listProcessors=function(){return[new SceneLoadProcessor]},b}(Module),SceneLoadProcessor=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._tempNum=0,b}return __extends(b,a),b.prototype.getName=function(){return"SceneLoadProcessor"},b.prototype.receivedModuleEvent=function(a){var b=a;b.type==SceneLoadEvent.SHOW_LOAD_EVENT?(this.showLoadPanel(b),this._sceneLoadUI.setTxt("正在加载地图资源...")):b.type==SceneLoadEvent.REMOVE_LOAD_EVENT?this.removeUI():b.type==SceneLoadEvent.PROGRESS_LOAD_EVENT?this._sceneLoadUI.setProgress(b.progress):b.type==SceneLoadEvent.ANALYSIS_LOAD_EVENT||(b.type==SceneLoadEvent.INFO_EVENT?this._sceneLoadUI.setTxt(b.str):b.type==SceneLoadEvent.SCENE_TRANSITION_EVENT?this.showTransition():b.type==SceneLoadEvent.SCENE_TRANSITION_HIDE_EVENT&&this.hideTransition())},b.prototype.showLoadPanel=function(a){this._sceneLoadUI||(this._sceneLoadUI=new SceneLoadUI),this._sceneLoadUI.show(),this._sceneLoadUI.resize(),this._sceneLoadUI.loadBackImg(a.backImgUrl),UIManager.getInstance().addUIContainer(this._sceneLoadUI)},b.prototype.removeUI=function(){this._sceneLoadUI.remove(),UIManager.getInstance().removeUIContainer(this._sceneLoadUI),this.initTransition()},b.prototype.initTransition=function(){this.sceneTransitionUI||(this.sceneTransitionUI=new SceneTransitionUI)},b.prototype.showTransition=function(){var a=this;this.sceneTransitionUI||(this.sceneTransitionUI=new SceneTransitionUI),GameInstance.mainChar.toRotationY=180-Scene_data.cam3D.rotationY,GameInstance.mainChar.refreshPos();var b=GameInstance.mainChar,c=GameInstance.mainChar.py;this._target=b,this._baseY=c,this._showTime=TimeUtil.getTimer();var d=function(){GameInstance.mainChar.refreshPos()};AttackEffectsManager.playLyf(getModelUrl("ef_xiaosi_lyf"),GameInstance.mainChar,new Vector3D(0,-30,0)),TimeUtil.addTimeOut(200,function(){TimeUtil.addTimeOut(300,function(){a.sceneTransitionUI.show()}),GameInstance.mainChar.visible=!1,TweenLite.to(b,1,{py:c+200,onComplete:function(){},onUpdate:d})})},b.prototype.hideTransition=function(){var a=this;if(this._target){var b=2300-(TimeUtil.getTimer()-this._showTime);b>0?TimeUtil.addTimeOut(b,function(){a.applyHide()}):this.applyHide()}},b.prototype.applyHide=function(){var a=this;this._target!=GameInstance.mainChar&&(this._target=GameInstance.mainChar,this._baseY=GameInstance.mainChar.py,GameInstance.mainChar.py+=200,GameInstance.mainChar.visible=!1);var b=function(){GameInstance.mainChar.refreshPos()};this.sceneTransitionUI&&this.sceneTransitionUI.hide(),TweenLite.to(this._target,.5,{py:this._baseY,onUpdate:b,onComplete:function(){AttackEffectsManager.playLyf(getModelUrl("ef_xiaosi_lyf"),GameInstance.mainChar,new Vector3D(0,-30,0)),a.sceneTransitionUI&&UIManager.getInstance().removeUIContainer(a.sceneTransitionUI),TimeUtil.addTimeOut(300,function(){GameInstance.mainChar.visible=!0,a._target=null})}})},b.prototype.listenModuleEvents=function(){return[new SceneLoadEvent(SceneLoadEvent.SHOW_LOAD_EVENT),new SceneLoadEvent(SceneLoadEvent.REMOVE_LOAD_EVENT),new SceneLoadEvent(SceneLoadEvent.PROGRESS_LOAD_EVENT),new SceneLoadEvent(SceneLoadEvent.ANALYSIS_LOAD_EVENT),new SceneLoadEvent(SceneLoadEvent.INFO_EVENT),new SceneLoadEvent(SceneLoadEvent.SCENE_TRANSITION_EVENT),new SceneLoadEvent(SceneLoadEvent.SCENE_TRANSITION_HIDE_EVENT)]},b}(BaseProcessor),msgtip;!function(a){var b=function(){function a(){var a=this;this.closeGuild=!1,this._stepGuideId=0,this.listName=["FubenResList"],UIManager.popClikNameFun&&(UIManager.popClikNameFun=function(b,c){void 0===c&&(c=0),a.uiClikName(b,c)})}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.hideGuidePop=function(){this.closeGuild=!0,this.hidePopView(),console.log("关闭引导")},a.prototype.showMainUIGuidePopView=function(){if(!this.closeGuild&&!UIManager.getInstance().hasWindowUI()&&!GuidData.map.showAreaById(AreaType.sceneExit_30)){this.hidePopView();var a=GuidData.player.getPlayerIntFieldGuideIdNow();if(console.log("当前进度",GuidData.player.getPlayerIntFieldGuidIdLast(),GuidData.player.getPlayerIntFieldGuideIdNow()),console.log("刷新系统--------",a),this.stepGuideId=0,GuidData.player.needGuididPop&&SceneManager.getInstance().render){var b=tb.TB_system_guide.get_TB_system_guide(10*a);if(b&&this.getSysIsOpenBySkinName(b.skinName))switch(b.skinName){case"sys202":case"sys201":case"sys205":case"sys206":case"sys207":case"sys501":if(console.log(mainUi.MainUiModel.skillTabIndex,mainUi.MainUiModel.systemTab),1!=mainUi.MainUiModel.skillTabIndex)return void this.c_qiehuanBut();if(2==mainUi.MainUiModel.systemTab)this.e_anBut();else{var c=Number(b.skinName.substring(3,b.skinName.length)),d=mainUi.MainUiModel.getPandaPostionBySysId(c);this.popCreatByRect(new Rectangle(d.x-2,d.y-2,75,75),{bottom:0,right:0},b)}break;default:if(-1!=b.skinName.search("panda")){if(GameInstance.pandaVisibel){var e=mainUi.MainUiModel.getPandaPostionBySysId(Number(b.skinName.substring(5,b.skinName.length)));this.popCreatByRect(new Rectangle(e.x,e.y,60,60),{top:0,right:0})}}else this.popTempView(b)}}this.showMainuiOptional(0)}},a.prototype.showPandaListhButGuide=function(){},a.prototype.showMainuiOptional=function(a){ModuleEventManager.dispatchEvent(new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.HIDE_OPTIONL_GUIDE_EVENT));for(var b=0;b<GuidData.player.optionalGuidItem.length;b++){var c=GuidData.player.optionalGuidItem[b].x,d=GuidData.player.optionalGuidItem[b].y,e=tb.TB_system_guide.get_TB_system_guide(10*c+d);if(e&&0==a&&e.isMainui){var f=!1;switch(console.log(e),e.skinName){case"sys202":case"sys201":case"sys205":case"sys206":case"sys207":case"sys302":case"sys501":if(1==mainUi.MainUiModel.skillTabIndex)if(2==mainUi.MainUiModel.systemTab);else{var g=Number(e.skinName.substring(3,e.skinName.length)),h=mainUi.MainUiModel.getPandaPostionBySysId(g);e.area[0]=h.x,e.area[1]=h.y,f=!0}break;default:if(-1!=e.skinName.search("panda")){var i=mainUi.MainUiModel.getPandaPostionBySysId(Number(e.skinName.substring(5,e.skinName.length)));e.area[0]=i.x,e.area[1]=i.y,f=!0}}if(f){console.log("主UI",e.skinName);var j=new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.SHOW_OPTIONL_GUIDE_EVENT);j.data=e,ModuleEventManager.dispatchEvent(j)}}}},a.prototype.showPanda=function(){this.popCreatByRect(new Rectangle(740,1,60,60),{top:0,right:0})},a.prototype.c_qiehuanBut=function(){this.popCreatByRect(new Rectangle(890,145,60,60),{right:0})},a.prototype.e_anBut=function(){this.popCreatByRect(new Rectangle(900,470,60,60),{bottom:0,right:0})},a.prototype.getSysIsOpenBySkinName=function(a){var b=0;switch(a){case"f_qichen":b=210;break;case"a_boss_but":if(!GuidData.map.isAdventureBaseScene())return!1;case"a_list_cell":case"a_skill_2":case"a_family":case"a_bag":case"a_map_icon":return!0;default:-1!=a.search("panda")&&(b=Number(a.substring(5,a.length))),-1!=a.search("sys")&&(b=Number(a.substring(3,a.length)),console.log(a,b))}return GuidData.player.isOpenSystemById(b)},a.prototype.popCreatByRect=function(a,b,c){void 0===c&&(c=null);var d=new tb.TB_system_guide(null);d.type=1,d.area=[a.x,a.y,a.width,a.height],d.text="",c&&(d.text=c.text,d.area[2]=c.area[2],d.area[3]=c.area[3]),d.layout=b,this.popTempView(d)},a.prototype.popTempView=function(a){if(a){console.log(a);var b=new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.SHOW_BIEGUIDE_EVENT);b.data=a,ModuleEventManager.dispatchEvent(b)}},a.prototype.showModuleGuidePage=function(a){if(void 0===a&&(a=null),!this.closeGuild){this.hidePopView(),a&&a!=this.lastPage?(this.stepGuideId=1,this.lastPage=a):(a=this.lastPage,this.stepGuideId=Math.max(1,this.stepGuideId));for(var b=GuidData.player.getPlayerIntFieldGuideIdNow(),c=tb.TB_system_icon.getTempVo(a).list,d=0;d<c.length;d++)if(c[d]==b){var e=10*b+this.stepGuideId,f=tb.TB_system_guide.get_TB_system_guide(e);f?this.popTempView(f):(console.log("已经结束了"),this.stepGuideId=0)}}},a.prototype.hidePopView=function(){ModuleEventManager.dispatchEvent(new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.HIDE_BIEGUIDE_EVENT))},Object.defineProperty(a.prototype,"stepGuideId",{get:function(){return this._stepGuideId},set:function(a){this._stepGuideId=a},enumerable:!0,configurable:!0}),a.prototype.uiClikName=function(a,b){var c=this;if(console.log("按钮名字------>",a),this.hidePopView(),"c_qiehuan"==a||"e_an"==a||"t_show_but"==a)return void TimeUtil.addTimeOut(1,function(){c.showMainUIGuidePopView()});var d=GuidData.player.getPlayerIntFieldGuideIdNow();if(GuidData.player.needGuididPop||this.stepGuideId>0){var e=10*d+this.stepGuideId,f=tb.TB_system_guide.get_TB_system_guide(e);f?f.skinName==a&&(1==f.isfinish&&(console.log("完成引导",d,f),NetManager.getInstance().protocolos.finish_now_guide(),GuidData.player.resetSystemItem()),f.isMainui?console.log("在主面板准备开启模块"):(this.stepGuideId++,this.showModuleGuidePage())):this.stepGuideId=0}else b>0&&this.clikOptionalGuide(a,b)},a.prototype.clikOptionalGuide=function(a,b){var c=tb.TB_system_icon.getTempVo(b);if(c)for(var d=c.optional_list,e=0;e<d.length;e++)for(var f=0;f<GuidData.player.optionalGuidItem.length;f++){var g=GuidData.player.optionalGuidItem[f].x,h=Math.max(GuidData.player.optionalGuidItem[f].y,1);if(g==d[e]){var i=tb.TB_system_guide.get_TB_system_guide(10*g+h);i&&(console.log(i),console.log("$tb.skinName",i.skinName),i.skinName==a&&(this.sendToSaveOptional(g,h),console.log("结束这次引导",g,h),this.showModuleOptionalPage(b)))}}},a.prototype.sendToSaveOptional=function(a,b){NetManager.getInstance().protocolos.finish_optional_guide_step(a,b);for(var c=0;c<GuidData.player.optionalGuidItem.length;c++)GuidData.player.optionalGuidItem[c].x==a&&(GuidData.player.optionalGuidItem[c].y+=1)},a.prototype.showModuleOptionalPage=function(a){if(ModuleEventManager.dispatchEvent(new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.HIDE_OPTIONL_GUIDE_EVENT)),a)for(var b=tb.TB_system_icon.getTempVo(a).optional_list,c=0;c<b.length;c++)for(var d=0;d<GuidData.player.optionalGuidItem.length;d++){var e=GuidData.player.optionalGuidItem[d].x,f=GuidData.player.optionalGuidItem[d].y;if(0==f&&(this.sendToSaveOptional(e,f),f+=1),e==b[c]){console.log("需要显示的对象",e,f);var g=tb.TB_system_guide.get_TB_system_guide(10*e+f);if(g){var h=new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.SHOW_OPTIONL_GUIDE_EVENT);h.data=g,ModuleEventManager.dispatchEvent(h)}}}},a}();a.GuideModel=b}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/msg/zhanli.xml","ui/uidata/msg/zhanli.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this.b_info_bg=this.addChild(this._bottomRender.getComponent("b_info_bg")),this.applyLoadComplete()},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.getBaseData=function(){for(var a=new Array,b=random(12),c=0;b>c;c++)a.push(new Vector2D(random(30),random(1e3)));return a},b.prototype.setData=function(a){var b=this;console.log(a),this.clearNameItem(),this.clearTxtItem();for(var c=0;c<a.length&&12>c;c++){var d=this.addChild(this._midRender.getComponent("b_cell_name"));d.y+=25*c,d.goToAndStop(c);var e=a[c].x-1;this.cellNameItem.push(d),this.drawCellNameToStr(d,ColorType.Yellowffe9b4+getKeyProById(a[c].x));var f=this.addChild(this._midRender.getComponent("b_cell_txt"));f.y+=25*c,f.goToAndStop(c),this.cellTextItem.push(f),this.drawTextToName(f,a[c].y,e)}this.b_info_bg.height=25*a.length+30,TimeUtil.addTimeOut(2e3,function(){b.close()})},b.prototype.drawCellNameToStr=function(a,b){var c=a.getSkinCtxRect(),d=UIManager.getInstance().getContext2D(c.width,c.height,!1);LabelTextFont.writeSingleLabelToCtx(d,b,16,0,0,TextAlign.CENTER),a.drawToCtx(this._bottomRender.uiAtlas,d)},b.prototype.drawTextToName=function(a,b,c){var d,e=a.getSkinCtxRect(),f=UIManager.getInstance().getContext2D(e.width,e.height,!1);b>0?ArtFont.num7:ArtFont.num6;d=12>c?String(Math.floor(b)):String(Math.floor(b)/100)+"%",b>0&&(d="+"+d);var g=b>0?ColorType.Green20a200:ColorType.Reddb4051;LabelTextFont.writeSingleLabelToCtx(f,g+d,16,0,0,TextAlign.LEFT),a.drawToCtx(this._bottomRender.uiAtlas,f)},b.prototype.clearNameItem=function(){for(;this.cellNameItem&&this.cellNameItem.length;)this.removeChild(this.cellNameItem.pop());this.cellNameItem=new Array},b.prototype.clearTxtItem=function(){for(;this.cellTextItem&&this.cellTextItem.length;)this.removeChild(this.cellTextItem.pop());this.cellTextItem=new Array},b}(UIConatiner);a.MsgZhanliInfoPanel=b}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.waitTime2000=2e3,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._midRender.uiAtlas=new UIAtlas,b.frameUpFun=function(a){b.upData(a)},b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/msg/zhanli.xml","ui/uidata/msg/zhanli.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_bg")),this.a_zanli_txt=this.addChild(this._midRender.getComponent("a_zanli_txt")),this.a_up_txt=this.addChild(this._midRender.getComponent("a_up_txt")),this.a_jiantou=this.addChild(this._midRender.getComponent("a_jiantou")),this.applyLoadComplete()},b.prototype.upData=function(a){if(this.endTime>TimeUtil.getTimer()){var b=this.forceVect.x,c=this.forceVect.y,d=(this.endTime-TimeUtil.getTimer())/this.waitTime2000;d=1-Math.max(0,Math.min((d-.2)*(1/.6),1));var e=MathClass.easeInOut(d,0,c-b,1),f=String(Math.floor(e+b));ArtFont.getInstance().writeFontToSkinName(this._midRender.uiAtlas,this.a_zanli_txt.skinName,f,ArtFont.num61,TextAlign.CENTER),c>b?(this.a_jiantou.goToAndStop(0),ArtFont.getInstance().writeFontToSkinName(this._midRender.uiAtlas,this.a_up_txt.skinName,String(Math.floor(c-b)),ArtFont.num61,TextAlign.LEFT)):(this.a_jiantou.goToAndStop(1),ArtFont.getInstance().writeFontToSkinName(this._midRender.uiAtlas,this.a_up_txt.skinName,String(Math.abs(c-b)),ArtFont.num61,TextAlign.LEFT))}else this.close()},b.prototype.close=function(){TimeUtil.removeFrameTick(this.frameUpFun),UIManager.getInstance().removeUIContainer(this)},b.prototype.setData=function(a){this.forceVect=a,this.endTime=TimeUtil.getTimer()+this.waitTime2000,TimeUtil.addFrameTick(this.frameUpFun)},b}(UIConatiner);a.MsgZhanliPanel=b}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a._winBgRender=new UIRenderComponent,a.addRender(a._winBgRender),a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a._winBgRender.uiAtlas=b,a._midRender.uiAtlas.setInfo("ui/uidata/msg/systemopen.xml","ui/uidata/msg/systemopen.png",function(){a.loadConfigCom()})})},c.prototype.addBg=function(){var a=this.addEvntBut("t_rightbg2",this._winBgRender);a.x=0,a.y=0,a.width=UIData.designWidth,a.height=UIData.designHeight,this.uiItem.push(a),this.win_bg=a,this.resize()},c.prototype.resize=function(){this.win_bg.top=0,this.win_bg.left=0,this.win_bg.width=Scene_data.stageWidth/UIData.Scale,this.win_bg.height=Scene_data.stageHeight/UIData.Scale,b.prototype.resize.call(this)},c.prototype.loadConfigCom=function(){this.uiItem=new Array,this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addBg(),this.uiItem.push(this.addChild(this._bottomRender.getComponent("a_bg"))),this.uiItem.push(this.addChild(this._midRender.getComponent("a_icon_bg"))),this.a_icon=this.addChild(this._topRender.getComponent("a_icon")),this.a_tittle=this.addChild(this._topRender.getComponent("a_tittle")),this.uiItem.push(this.a_tittle),this.uiItem.push(this.addChild(this._topRender.getComponent("a_txt_bg"))),this.a_text=this.addChild(this._topRender.getComponent("a_text")),this.baseIonPos=new Vector2D(this.a_icon.x,this.a_icon.y),this.uiItem.push(this.a_text),this.applyLoadComplete()},c.prototype.getOpenSkillIconUrl=function(a){return"ui/load/activity/skillopen/openskill1.png"},c.prototype.drawSkillOpen=function(a){var b=this,c=getSkillIconUrl(tb.TB_skill_base.get_TB_skill_base(a).icon);LoadManager.getInstance().load(Scene_data.fileRoot+c,LoadManager.IMG_TYPE,function(a){var c=b._topRender.uiAtlas.getRec(b.a_icon.skinName);b._topRender.uiAtlas.ctx=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),UiDraw.cxtDrawImg(b._topRender.uiAtlas.ctx,PuiData.SKILL_BG68,new Rectangle(0,0,71,71),UIData.publicUi),b._topRender.uiAtlas.ctx.drawImage(a,4,4,62,62),TextureManager.getInstance().updateTexture(b._topRender.uiAtlas.texture,c.pixelX,c.pixelY,b._topRender.uiAtlas.ctx)})},c.prototype.setData=function(a){var b=this;GameMouseManager.getInstance().useMouseEvent=!1;var c=this.getIconByID(a.id),d=ColorType.Yellowffe9b4+a.text;if(this.setUiListVisibleByItem(this.uiItem,!0),99==a.position?(this.drawSkillOpen(a.id),this.a_tittle.goToAndStop(1)):(this._topRender.uiAtlas.upDataPicToTexture(c,this.a_icon.skinName),this.a_tittle.goToAndStop(0)),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_text.skinName,d,14,TextAlign.CENTER,ColorType.Yellowffe9b4),this.a_icon.x=this.baseIonPos.x,this.a_icon.y=this.baseIonPos.y,this.toPos=new Vector2D(UIData.designWidth,UIData.designHeight),4==a.position||5==a.position||6==a.position||7==a.position)0==mainUi.MainUiModel.skillTabIndex?this.toPos=UiTweenVo.getPosByPanel(new Vector2D(900,150),{width:UIData.designWidth,height:UIData.designHeight,right:0},this):this.toPos=UiTweenVo.getPosByPanel(this.getPandaPos(a),{width:UIData.designWidth,height:UIData.designHeight,right:0,bottom:0},this);else if(3==a.position)this.toPos=UiTweenVo.getPosByPanel(new Vector2D(3,471),{width:UIData.designWidth,height:UIData.designHeight,left:0,bottom:0},this);else if(9==a.position)this.toPos=UiTweenVo.getPosByPanel(new Vector2D(750,170),{width:UIData.designWidth,height:UIData.designHeight,right:0,top:0},this);else if(99==a.position)switch(a.index){case 2:this.toPos=UiTweenVo.getPosByPanel(new Vector2D(727,454),{width:UIData.designWidth,height:UIData.designHeight,left:0,bottom:0},this);break;case 3:this.toPos=UiTweenVo.getPosByPanel(new Vector2D(728,374),{width:UIData.designWidth,height:UIData.designHeight,left:0,bottom:0},this);break;case 4:this.toPos=UiTweenVo.getPosByPanel(new Vector2D(787,316),{width:UIData.designWidth,height:UIData.designHeight,left:0,bottom:0},this)}else this.toPos=UiTweenVo.getPosByPanel(this.getPandaPos(a),{width:UIData.designWidth,height:UIData.designHeight,right:0,top:0},this);TimeUtil.addTimeOut(1500,function(){b.setUiListVisibleByItem(b.uiItem,!1),TweenMoveTo(b.a_icon,.6,{x:b.toPos.x,y:b.toPos.y,onComplete:function(){b.changeButEnd()}})})},c.prototype.getPandaPos=function(a){for(var b=1,c=0;c<GuidData.player.systemOpenItem.length;c++)if(GuidData.player.systemOpenItem[c].needShowIcon){var d=tb.TB_system_icon.getTempVo(GuidData.player.systemOpenItem[c].systemId);d.position==a.position&&d.index<a.index&&b++}var e=new Vector2D;return 1==a.position&&(e.x=780-65*b,e.y=10),2==a.position&&(e.x=780-65*b,e.y=75),4==a.position&&(e.x=890-70*b,e.y=464),5==a.position&&(e.x=890,e.y=464-68*b),e},c.prototype.getMoveToPos=function(a,b){var c=new Vector2D(896,466);return mainUi.MainUiModel.systemTab==b?UiTweenVo.getPosByPanel(a,{width:UIData.designWidth,height:UIData.designHeight,right:0,bottom:0},this):UiTweenVo.getPosByPanel(c,{width:UIData.designWidth,height:UIData.designHeight,center:0,bottom:0},this)},c.prototype.getIconByID=function(a){return"ui/load/systemicon/"+a+".png"},c.prototype.changeButEnd=function(){UIManager.getInstance().removeUIContainer(this),GuidData.player.resetSystemItem(),GuidData.player.resetSkillItem(),SceneManager.getInstance().render&&(ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.RESET_SKILL_ICON)),ModuleEventManager.dispatchEvent(new homeui.HomeUiEvent(homeui.HomeUiEvent.REFRESH_HOME_UI_PANEL)),ModuleEventManager.dispatchEvent(new topui.TopUiEvent(topui.TopUiEvent.SHOW_TOP_UI_PANEL)),ModuleEventManager.dispatchEvent(new rightui.RightUiEvent(rightui.RightUiEvent.SHOW_RIGHT_UI_PANEL)),ModuleEventManager.dispatchEvent(new a.MsgTipEvent(a.MsgTipEvent.SHOW_GUIDE_POP_VIEW)),ModuleEventManager.dispatchEvent(new leftui.LeftUiEvent(leftui.LeftUiEvent.SHOW_LEFT_UI_PANEL))),GameMouseManager.getInstance().useMouseEvent=!0},c}(UIConatiner);a.SystemOpenPanel=b}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlas=new UIAtlas,b.uiAtlas.configData=new Array,b}return __extends(b,a),b.prototype.makeSamplePic=function(){var a=this;this.uiAtlas.configData.push(this.uiAtlas.getObject("picSkin",0,0,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height)),this.picUi=this.creatBaseComponent("picSkin");var b=UiTweenVo.getPosByPanel(new Vector2D(150,123),{width:UIData.designWidth,height:UIData.designHeight,left:0,middle:0});this.picUi.width=50,this.picUi.height=50,this.picUi.x=b.x,this.picUi.y=b.y,this.container.addChild(this.picUi);var c=UiTweenVo.getPosByPanel(new Vector2D(277,476),{width:UIData.designWidth,height:UIData.designHeight,center:0,bottom:0});TweenMoveTo(this.picUi,1,{x:c.x,y:c.y,width:30,height:30,onComplete:function(){a.changeButEnd()}})},b.prototype.changeButEnd=function(){this.bFun&&this.bFun()},b.prototype.setTextures=function(a){this.uiAtlas.textureRes=a,this.makeSamplePic()},b}(AlphaUIRenderComponent);a.MoveTipUiRender=b;var c=function(){function a(a){this.container=a,this.moveTipUiRender=new b,this.container.addRender(this.moveTipUiRender)}return a.prototype.loadPicData=function(a){var b=this,c=GameData.getIconCopyUrl(a);this.moveTipUiRender.bFun=function(){b.playEnd()},TextureManager.getInstance().getTexture(Scene_data.fileRoot+c,function(a){b.moveTipUiRender.setTextures(a)})},a.prototype.playEnd=function(){this.container.removeRender(this.moveTipUiRender),this.moveTipUiRender.dispose()},a}();a.MoveTipUi=c;var d=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.left=0,b.frameUpFun=function(a){b.upData(a)},TimeUtil.addFrameTick(b.frameUpFun),b}return __extends(b,a),b.prototype.upData=function(a){this.renderList.length<=0&&this.close()},b.prototype.setSystemData=function(a){var b=new c(this);b.loadPicData(a)},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),this.dispose()},b.prototype.dispose=function(){b.msgEquMoveToBag=null,TimeUtil.removeFrameTick(this.frameUpFun),this.frameUpFun=null},b.show=function(a){this.msgEquMoveToBag||(this.msgEquMoveToBag=new b),this.msgEquMoveToBag.setSystemData(a),UIManager.getInstance().addUIContainer(this.msgEquMoveToBag)},b}(UIConatiner);a.MsgEquMoveToBag=d}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlas=new UIAtlas,b.uiAtlas.configData=new Array,b}return __extends(b,a),b.prototype.makeSamplePic=function(){var a=this;this.uiAtlas.configData.push(this.uiAtlas.getObject("picSkin",0,0,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height)),this.picUi=this.creatBaseComponent("picSkin");var b=new Vector2D(UIData.designWidth/2-150,UIData.designHeight/2-50);this.picUi.width=this.uiAtlas.textureRes.width,this.picUi.height=this.uiAtlas.textureRes.height,this.picUi.x=-this.picUi.width/2+b.x,this.picUi.y=-this.picUi.height/2+b.y,this.container.addChild(this.picUi);var c=new UiTweenVo;c.ui=this.picUi,c.scale=1,this.picUi.alpha=0,TweenMoveTo(this.picUi,.2,{alpha:1}),TweenMoveTo(c,.2,{scale:1.3}),TimeUtil.addTimeOut(1500,function(){TweenMoveTo(a.picUi,.1,{alpha:.3}),TweenMoveTo(c,.1,{scale:.6,onComplete:function(){a.changeButEnd()}})})},b.prototype.changeButEnd=function(){this.bFun&&this.bFun()},b.prototype.setTextures=function(a){this.uiAtlas.textureRes=a,this.makeSamplePic()},b}(AlphaUIRenderComponent);a.SkillTipPicRender=b;var c=function(){function a(a){this.container=a,this.picRender=new b,this.container.addRender(this.picRender)}return a.prototype.loadPicData=function(a){var b=this;console.log("技能图标",a),this.picRender.bFun=function(){b.playEnd()},TextureManager.getInstance().getTexture(Scene_data.fileRoot+this.getIconById(a),function(a){b.picRender.setTextures(a)})},a.prototype.getIconById=function(a){var b="ui/load/toptip/skillpic/"+a+".png";return b},a.prototype.playEnd=function(){this.container.removeRender(this.picRender),this.picRender.dispose()},a}();a.SkillTipUi=c;var d=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b.frameUpFun=function(a){b.upData(a)},TimeUtil.addFrameTick(b.frameUpFun),b}return __extends(b,a),b.prototype.upData=function(a){this.renderList.length<=0&&this.close()},b.prototype.setSystemData=function(a){var b=new c(this);b.loadPicData(a)},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),this.dispose()},b.prototype.dispose=function(){b.msgSkillTipPanel=null,TimeUtil.removeFrameTick(this.frameUpFun),this.frameUpFun=null},b.show=function(a){this.msgSkillTipPanel||(this.msgSkillTipPanel=new b),this.msgSkillTipPanel.setSystemData(a),UIManager.getInstance().addUIContainer(this.msgSkillTipPanel)},b}(UIConatiner);a.MsgSkillTipPanel=d}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(){function a(){}return a}();a.MsgEffectsMoveData=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.makeData=function(){if(this._data){this.msgEffectsMoveData=this.data;var a=PuiData.A_YUANBAO;switch(this.msgEffectsMoveData.MONEY_TYPE){case SharedDef.MONEY_TYPE_SILVER:a=PuiData.A_YINBI;break;case 1:a=PuiData.A_SHOULING;break;case 2:a=PuiData.A_JINGHUA;break;case 101:a=PuiData.A_HIGHT_START;break;case 107:a=PuiData.A_HIGHT_START}this.afterStr!=a&&(console.log("更新"),UiDraw.uiAtlasDrawImg(this.parent.uiAtlas,this.textureStr,UIData.publicUi,a)),this.afterStr=a,this.ui.width=24,this.ui.height=24}},b.prototype.update=function(){if(this.msgEffectsMoveData.startTM<TimeUtil.getTimer())if(this.msgEffectsMoveData.endTM<TimeUtil.getTimer())this.ui.parent.removeChild(this.ui),this._data=null;else{var a=(TimeUtil.getTimer()-this.msgEffectsMoveData.startTM)/(this.msgEffectsMoveData.endTM-this.msgEffectsMoveData.startTM),c=MathClass.easeInOut(a,0,1,1);this.ui.height=24-14*c,this.ui.width=24-14*c;var d=b.drawbezier([this._data.pos,this._data.bezierPos,this._data.toPos],a);this.ui.x=d.x,this.ui.y=d.y}else this.ui.x=3e3},b.drawbezier=function(a,b){var c=new Array;if(0==a.length)return new Vector2D;for(var d=0;d<a.length;d++)c.push(new Vector2D(a[d].x,a[d].y));for(;c.length>1;){for(var e=0;e<c.length-1;e++)this.mathmidpoint(c[e],c[e+1],b);c.pop()}return c[0]},b.mathmidpoint=function(a,b,c){var d,e;d=a.x+(b.x-a.x)*c,e=a.y+(b.y-a.y)*c,a.x=d,a.y=e},b}(Disp2DBaseText);a.MsgEffectsIconRender=c;var d=function(){function a(){var a=this;this._dis2DUIContianerPanel=new Dis2DUIContianerPanel(c,new Rectangle(0,0,32,32),15),this.frameUpFun=function(b){a.upData(b)}}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.show=function(){this._dis2DUIContianerPanel.hasStage||(UIManager.getInstance().addUIContainer(this._dis2DUIContianerPanel),TimeUtil.addFrameTick(this.frameUpFun))},a.prototype.setPopMsgVo=function(a){this.show(),this._dis2DUIContianerPanel.showTemp(a)},a.prototype.upData=function(a){this._dis2DUIContianerPanel.update(0);for(var b=0;b<this._dis2DUIContianerPanel.renderList.length;b++)this._dis2DUIContianerPanel.renderList[b].update();this._dis2DUIContianerPanel.hasStage?0==this._dis2DUIContianerPanel.getUiItemLen()&&UIManager.getInstance().removeUIContainer(this._dis2DUIContianerPanel):TimeUtil.removeFrameTick(this.frameUpFun)},a}();a.MsgEffectsManager=d}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(){function a(){}return a.type1=1,a.type2=2,a.type3=3,a.type4=4,a.type5=5,a.type6=6,a.type7=7,a.type8=8,a.HH=35,a}();a.PopMsgVo=b;var c=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;return b.waitTime2000=3e3,b}return __extends(c,a),c.prototype.makeData=function(){this.ui.width=768,this.ui.height=.75*b.HH,this._msgTipVo=this._data,this._msgTipVo&&(this.waitTime2000=3e3,this._msgTipVo.moveType==b.type1&&(this.waitTime2000=1e3),this._msgTipVo.moveType==b.type2&&(this.waitTime2000=1500),this._msgTipVo.moveType==b.type4&&(this.waitTime2000=1e3),this._msgTipVo.moveType==b.type5&&(this.waitTime2000=1e3),this._msgTipVo.moveType==b.type7&&(this.waitTime2000=1500),this.endTime=TimeUtil.getTimer()+this.waitTime2000,
this.drawCtx(),this.update())},c.prototype.drawCtx=function(){var a=this.parent.uiAtlas.getRec(this.textureStr),d=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),e=1*(25*FaceFontLabel.getFaceTxtStrLen(this._msgTipVo.text)+20);UiDraw.cxtDrawImg(d,PuiData.HASSEL,new Rectangle((c.textureSize1024-e)/2,0,e,36),UIData.publicUi);var f="[ff0000]";this._msgTipVo.moveType==b.type1&&(f="[ffffff]"),this._msgTipVo.moveType==b.type2&&(f="[0000ff]"),LabelTextFont.writeSingleLabelToCtx(d,f+this._msgTipVo.text,25,0,0,TextAlign.CENTER,"#ffffff","#27262e"),this.parent.uiAtlas.updateCtx(d,a.pixelX,a.pixelY)},c.prototype.update=function(){if(this._msgTipVo){var a=1-(this.endTime-TimeUtil.getTimer())/this.waitTime2000,c=MathClass.easeInOut(a,0,50,1),d=0,e=this.ui;e.alpha=Math.max(Math.min(2*(1-a),1),0),this._msgTipVo.moveType==b.type1&&(c=0),this._msgTipVo.moveType==b.type2&&(c=0),this._msgTipVo.moveType==b.type3&&(c=0),this._msgTipVo.moveType==b.type7&&(c=75*a),this._msgTipVo.moveType==b.type6&&(c=40*a*2),this._msgTipVo.moveType==b.type4&&(d=c),this._msgTipVo.moveType==b.type5&&(c=-c,d=c);var f=new Vector2D;this._msgTipVo.v2d&&(f.x=this._msgTipVo.v2d.x/UIData.Scale-d,f.y=this._msgTipVo.v2d.y/UIData.Scale-c),this._msgTipVo.v3d,this.ui.x=f.x-this.ui.width/2,this.ui.y=f.y,this.endTime<TimeUtil.getTimer()&&(this.ui.parent.removeChild(this.ui),this._data=null)}},c.textureSize1024=1024,c}(Disp2DBaseText);a.MsgTipItemRender=c;var d=function(a){function c(b,c,d){return a.call(this,b,c,d)||this}return __extends(c,a),c.prototype.update=function(a){for(var c=0,d=0;d<this._uiItem.length;d++)if(this._uiItem[d].data){var e=this._uiItem[d].data;e.moveType==b.type1&&(e.v2d.y=200+40*c,c++),this._uiItem[d].update()}},c.prototype.getType6MaxTy=function(){for(var a=0,c=0;c<this._uiItem.length;c++)if(this._uiItem[c].data){var d=this._uiItem[c].data;d.moveType==b.type6&&(a=Math.max(this._uiItem[c].ui.y,a))}return a*UIData.Scale},c.prototype.clearType2=function(){for(var a=0;a<this._uiItem.length;a++)if(this._uiItem[a].data){var c=this._uiItem[a].data;if(c.moveType==b.type2){var d=this._uiItem[a];d.endTime=TimeUtil.getTimer()}}},c.prototype.tureType6moveTy=function(){for(var a=this.getType6MaxTy(),c=Math.max(0,a-210),d=0;d<this._uiItem.length;d++)if(this._uiItem[d].data){var e=this._uiItem[d].data;e.moveType==b.type6&&(e.v2d.y-=c)}},c}(AlphaUiContianer);a.MsTip2DUIContianerPanel=d;var e=function(a){function e(){var e=a.call(this)||this;return e._totalNum=20,e._jumpTxtContianerPanel=new d(c,new Rectangle(0,0,c.textureSize1024,b.HH),e._totalNum),SceneManager.getInstance().addDisplay2DList(e),e}return __extends(e,a),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setPopMsgVo=function(a){a.moveType==b.type6&&this._jumpTxtContianerPanel.tureType6moveTy(),a.moveType==b.type2&&this._jumpTxtContianerPanel.clearType2();var c=this._jumpTxtContianerPanel.showTemp(a);if(c&&a.moveType==b.type6){var d=c.data;d.v2d.y=250,c.ui.y=d.v2d.y/UIData.Scale}},e.setMsgId=function(a){for(var b=tb.TB_msg.get_TB_msg(a),c=random(10)+10,d="",e=0;c>e;e++)d+="中";b.msgtype=7;var f="xxxxxxx";return 1==b.msgtype?(f="[ffde13]玩家名字aecf[00ff00]获得/脸g[0000ff]神器[]",void this.toSysHorn("[ffffff]"+b.text)):(2==b.msgtype&&(f="升级提示升级提示升级提示升级提示"),3==b.msgtype&&(f="拾取提示拾取提示"),7==b.msgtype&&(f="操作反馈操作反馈"),this.outStr(f,this.getPopTypeByTB(b.msgtype)),void this.id++)},e.getPopTypeByTB=function(a){var c=b.type1;return 2==a&&(c=b.type1),3==a&&(c=b.type6),4==a&&(c=b.type2),7==a&&(c=b.type1),c},e.setMsgData=function(a){var b=65536*a.type+a.reason,c=tb.TB_msg.get_TB_msg(b);if(c&&c.id){var d=c.text;if(""!=a.data)for(var e=a.data.split("|"),f=0;f<e.length;f++){var g="{"+(f+1)+"}";d=d.replace(g,e[f])}if(1==c.msgtype)return void this.toSysHorn("[ffffff]"+d);15==c.msgtype?AlertUtil.show(d,"",null,1):13!=c.msgtype&&this.outStr(d,this.getPopTypeByTB(c.msgtype))}},e.outStrById=function(a,b,c){void 0===c&&(c=null);for(var d=65536*a+b,e=tb.TB_msg.get_TB_msg(d),f=e.text,g=0;c&&g<c.length;g++){var h="{"+(g+1)+"}";f=f.replace(h,c[g])}this.outStr(f,this.getPopTypeByTB(e.msgtype))},e.outStr=function(a,c,d){void 0===d&&(d=null),(1==c||99==c)&&(c=2);var f=new b;f.text=ColorType.Redd92200+a,f.moveType=c,f.v2d=new Vector2D(Scene_data.stageWidth/2,Scene_data.stageHeight/2),d&&(f.v2d.x=d.x,f.v2d.y=d.y),f.moveType==b.type1&&(f.v2d.x=Scene_data.stageWidth/2),f.moveType==b.type2&&(f.v2d.x=Scene_data.stageWidth/2,f.v2d.y=Scene_data.stageHeight/2),f.moveType==b.type3&&(f.v2d.x=Scene_data.stageWidth/2,f.v2d.y=Scene_data.stageHeight/2),f.moveType==b.type4&&(f.v2d.x=Scene_data.stageWidth/2-150,f.v2d.y=Scene_data.stageHeight/2-100),f.moveType==b.type5&&(f.v2d.x=Scene_data.stageWidth/2+150,f.v2d.y=Scene_data.stageHeight/2-100),e.getInstance().setPopMsgVo(f)},e.toSysHorn=function(a){var b=new s2c_send_chat;b.content=a,b.channel=SharedDef.CHAT_TYPE_HORM;var c=new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_SYSTIME_HORM_INFO);c.data=b,ModuleEventManager.dispatchEvent(c)},e.prototype.update=function(){this._jumpTxtContianerPanel.update(0);for(var a=0;a<this._jumpTxtContianerPanel.renderList.length;a++)this._jumpTxtContianerPanel.renderList[a].update()},e.prototype.resize=function(){this._jumpTxtContianerPanel.resize();for(var a=0;a<this._jumpTxtContianerPanel.renderList.length;a++)this._jumpTxtContianerPanel.renderList[a].resize()},e.id=0,e}(Display3D);a.MsgTipManager=e}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(){function a(){}return a}();a.MsgPicData=b;var c=function(){function a(){}return a}();a.MsgPicVo=c;var d=function(){function a(a){this.container=a,this.bottomRender=new f,this.topRender=new e,this.container.addRender(this.bottomRender),this.container.addRender(this.topRender)}return a.prototype.loadPic=function(a){var b=this;this.bottomRender.endFun=function(){b.playEndFun()};var c,d="ui/load/toptip/ui_sj.png";c=2==a.type?String(a.info):"ui/load/toptip/leveluptxtnew.png",this.bottomRender.scale=1.5,TextureManager.getInstance().getTexture(Scene_data.fileRoot+d,function(d){TextureManager.getInstance().getTexture(Scene_data.fileRoot+c,function(c){b.bottomRender.setTextureTo(d),b.topRender.setTextureTo(c,a)})})},a.prototype.playEndFun=function(){var a=this;TimeUtil.addTimeOut(1,function(){a.container.removeRender(a.bottomRender),a.container.removeRender(a.topRender)})},a}();a.FrameTipUi=d;var e=function(a){function b(){var b=a.call(this)||this;return b.uiAtlas=new UIAtlas,b.uiAtlas.configData=new Array,b}return __extends(b,a),b.prototype.setTextureTo=function(a,b){this.uiAtlas.configData=new Array,this.uiAtlas.textureRes=a,1==b.type?this.makeLevelUpPic(b.info):this.makeSamplePic()},b.prototype.makeLevelUpPic=function(a){var b=String(a),c=new Rectangle(0,0,20*b.length+90),d=new Vector2D(UIData.designWidth/2,100);d.x-=c.width/2,this.uiAtlas.configData.push(this.uiAtlas.getObject("leftSkin",1,31,60,28,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height)),this.uiAtlas.configData.push(this.uiAtlas.getObject("rightSkin",61,31,30,28,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height)),this.uiAtlas.configData.push(this.uiAtlas.getObject("frameskill",2,4,170,25,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height,10,1));for(var e=0;e<b.length;e++){var f=this.createFrame("frameskill");f.width=17,f.height=25,f.x=20*e+d.x+60,f.y=d.y-0,f.goToAndStop(Number(b.charAt(e))),this.container.addChild(f)}var g=this.creatBaseComponent("leftSkin");g.x=d.x,g.y=d.y,this.container.addChild(g);var h=this.creatBaseComponent("rightSkin");h.x=d.x+(c.width-h.width),h.y=d.y,this.container.addChild(h),this.container.resize()},b.prototype.makeSamplePic=function(){this.uiAtlas.configData.push(this.uiAtlas.getObject("picSkin",0,0,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height,this.uiAtlas.textureRes.width,this.uiAtlas.textureRes.height)),this.picUi=this.creatBaseComponent("picSkin");var a=new Vector2D(UIData.designWidth/2,100);this.picUi.width=this.uiAtlas.textureRes.width,this.picUi.height=this.uiAtlas.textureRes.height,this.picUi.x=-this.picUi.width/2+a.x,this.picUi.y=-this.picUi.height/2+a.y,this.container.addChild(this.picUi)},b}(UIRenderComponent);a.MovePicComponent=e;var f=function(a){function b(){var b=a.call(this)||this;return b.uiAtlas=new UIAtlas,b.uiAtlas.configData=new Array,b}return __extends(b,a),b.prototype.setTextureTo=function(a){var b=2,c=8,d=new Rectangle(0,0,a.width,a.height),e=new Rectangle(0,0,Math.pow(2,Math.ceil(Math.log(a.width)/Math.log(2))),Math.pow(2,Math.ceil(Math.log(a.height)/Math.log(2))));this.uiAtlas.textureRes=a,this.uiAtlas.configData=new Array,this.uiAtlas.configData.push(this.uiAtlas.getObject("frameskill",0,0,d.width,d.height,e.width,e.height,b,c)),this.moveUi=this.createFrame("frameskill"),this.moveUi.width=d.width/b*this.scale,this.moveUi.height=d.height/c*this.scale;var f=new Vector2D(UIData.designWidth/2,100);this.moveUi.x=-this.moveUi.width/2+f.x,this.moveUi.y=-this.moveUi.height/2+f.y,this.moveUi.speed=2,this.container.addChild(this.moveUi),this.applyObjData()},b.prototype.update=function(){this.moveUi&&(this.moveUi.current>=this.moveUi.totalcurrent-2?this.endFun&&this.endFun():a.prototype.update.call(this))},b.prototype.dispose=function(){a.prototype.dispose.call(this),this.moveUi=null},b}(UIRenderComponent);a.MoveFrameComponent=f;var g=function(a){function b(){var b=a.call(this)||this;return b.frameItem=new Array,b._msgPicVoItem=new Array,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b.frameUpFun=function(a){b.upData(a)},TimeUtil.addFrameTick(b.frameUpFun),b}return __extends(b,a),b.prototype.upData=function(a){this.renderList.length<=0&&this.close()},b.prototype.pushData=function(a){var b=new d(this);b.loadPic(a),this.frameItem.push(b)},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),this.dispose()},b.prototype.dispose=function(){TimeUtil.removeFrameTick(this.frameUpFun),this.frameUpFun=null,b._msgTopCenterPic=null},b.show=function(a){this._msgTopCenterPic||(this._msgTopCenterPic=new b),this._msgTopCenterPic.pushData(a),UIManager.getInstance().addUIContainer(this._msgTopCenterPic)},b}(UIConatiner);a.MsgTopCenterPic=g}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),msgtip;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MSG_PIC_DATA="SHOW_MSG_PIC_DATA",b.SHOW_EFFECTS_DATA="SHOW_EFFECTS_DATA",b.SHOW_SKILL_TIP_DATA="SHOW_SKILL_TIP_DATA",b.SHOW_EQU_MOVE_DATA="SHOW_EQU_MOVE_DATA",b.SHOW_SMSG_ITEM_NOTICE="SHOW_SMSG_ITEM_NOTICE",b.OPEN_SKILL_SLOT="OPEN_SKILL_SLOT",b.SHOW_GUIDE_POP_VIEW="SHOW_GUIDE_POP_VIEW",b.SHOW_PAGE_POP_VIEW="SHOW_PAGE_POP_VIEW",b}(BaseEvent);a.MsgTipEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MsgTipModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.MsgTipModule=c;var d=function(c){function d(){var a=null!==c&&c.apply(this,arguments)||this;return a.nextCanShowOpenSysTM=0,a.zhanliNearTime=0,a}return __extends(d,c),d.prototype.getName=function(){return"MsgTipProcessor"},d.prototype.receivedModuleEvent=function(c){if(GuidData.map){if(Scene_data.isPanGm,c instanceof b){var d=c;d.type==b.SHOW_MSG_PIC_DATA&&this.showMsgTopCenterPic(d.data),d.type==b.SHOW_EFFECTS_DATA&&this.showEffectsMove(d.data),d.type==b.SHOW_SKILL_TIP_DATA&&this.showSkillTip(Number(d.data)),d.type==b.SHOW_EQU_MOVE_DATA&&this.showEquMoveTip(Number(d.data)),d.type==b.SHOW_SMSG_ITEM_NOTICE&&this.showSmsgItemNotice(d.data),d.type==b.OPEN_SKILL_SLOT&&this.showOpenSkill(d.data),d.type==b.SHOW_GUIDE_POP_VIEW&&GuidData.map&&SceneManager.getInstance().render&&a.GuideModel.getInstance().showMainUIGuidePopView(),d.type==b.SHOW_PAGE_POP_VIEW&&(a.GuideModel.getInstance().showModuleOptionalPage(d.data),GuidData.player.needGuididPop&&a.GuideModel.getInstance().showModuleGuidePage(d.data))}if(c instanceof EngineEvent){var e=c;e.type==EngineEvent.PLAYER_FIELD_FORCE&&(GuidData.player.lastForceNum!=GuidData.player.getForce()&&GuidData.player.lastForceNum>0&&this.showMsgZhanliPanel(),GuidData.player.lastForceNum=GuidData.player.getForce()),e.type==EngineEvent.PLAYER_FIELD_LEVEL&&this.playerFieldLevel(),this.nextCanShowOpenSysTM=TimeUtil.getTimer()+1e3}}},d.prototype.showOpenSkill=function(a){var b=new tb.TB_system_icon({list:[],bindactive:[]});b.id=a.id,b.move=1,b.position=99,b.index=a.slot,b.text=tb.TB_skill_base.get_TB_skill_base(a.id).name,console.log(b),console.log(a),this.showSystemOpenPanel(b)},d.prototype.playerFieldLevel=function(){var b=new a.MsgPicData;b.type=1,b.info=GuidData.player.getLevel();var c=new a.MsgTipEvent(a.MsgTipEvent.SHOW_MSG_PIC_DATA);c.data=b,ModuleEventManager.dispatchEvent(c)},d.prototype.showMsgZhanliPanel=function(){var b=this,c=new Vector2D(GuidData.player.lastForceNum,GuidData.player.getForce());this._msgZhanliPanel||(this._msgZhanliPanel=new a.MsgZhanliPanel),this._msgZhanliPanel.load(function(){b._msgZhanliPanel.setData(c),UIManager.getInstance().addUIContainer(b._msgZhanliPanel)},!1)},d.prototype.showSystemOpenPanel=function(b){var c=this;if(GuidData.map&&SceneManager.getInstance().render){var d=this.nextCanShowOpenSysTM-TimeUtil.getTimer();ModuleEventManager.dispatchEvent(new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.HIDE_BIEGUIDE_EVENT)),TimeUtil.addTimeOut(d,function(){SceneManager.getInstance().render?(ModuleEventManager.dispatchEvent(new dialog.DialogueEvent(dialog.DialogueEvent.HIDE_DIALOGUE_PANEL)),ModuleEventManager.dispatchEvent(new Chat.ChatEvent(Chat.ChatEvent.HIDE_CHAT_EVENT))):(UIManager.getInstance().removeAll(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))),c._systemOpenPanel||(c._systemOpenPanel=new a.SystemOpenPanel),c._systemOpenPanel.load(function(){c._systemOpenPanel.setData(b),UIManager.getInstance().addUIContainer(c._systemOpenPanel)},!1)})}else GuidData.player.resetSystemItem()},d.prototype.showSmsgItemNotice=function(b){console.log("---$vo---",b);for(var c=0;c<b.list.length;c++){var d=b.list[c];if(107!=d.item_id){var e=tb.TB_item_template.get_TB_item_template(d.item_id);if(e.money_type>0)for(var c=0;c<Math.min(d.num,20);c++)this.showEffectsMovetoBg(b.showType,e.money_type-1);else a.MsgEquMoveToBag.show(e.id)}else{var f=new stateup.StateUpEvent(stateup.StateUpEvent.SHOW_EFFECT_PANEL);f.data=d,ModuleEventManager.dispatchEvent(f)}}},d.prototype.showEquMoveTip=function(b){a.MsgEquMoveToBag.show(b)},d.prototype.showSkillTip=function(b){a.MsgSkillTipPanel.show(b)},d.prototype.showEffectsMovetoBg=function(b,c){var d=new a.MsgEffectsMoveData,e=new Vector2D(UIData.designWidth/2,UIData.designHeight/2);switch(b){case 1:e=UiTweenVo.getPosByPanel(new Vector2D(50,150),{width:UIData.designWidth,height:UIData.designHeight,left:0,middle:0})}d.startTM=TimeUtil.getTimer()+random(200),d.endTM=d.startTM+500,d.pos=e,d.bezierPos=new Vector2D(e.x+400*Math.random()-200,e.y+400*Math.random()-200);var f=UiTweenVo.getPosByPanel(new Vector2D(277,476),{width:UIData.designWidth,height:UIData.designHeight,center:0,bottom:0});switch(c){case 2:f=UiTweenVo.getPosByPanel(new Vector2D(617,478),{width:UIData.designWidth,height:UIData.designHeight,center:0,bottom:0})}d.toPos=f,d.MONEY_TYPE=c;var g=new a.MsgTipEvent(a.MsgTipEvent.SHOW_EFFECTS_DATA);g.data=d,ModuleEventManager.dispatchEvent(g)},d.prototype.showMsgTopCenterPic=function(b){a.MsgTopCenterPic.show(b)},d.prototype.showEffectsMove=function(b){a.MsgEffectsManager.getInstance().setPopMsgVo(b)},d.prototype.smsgAtiribute=function(a){for(var b=a.readUint16(),c=new Array,d=0;b>d;d++){var e=a.readUint16(),f=a.readDouble();c.push(new Vector2D(e,f))}c.length&&this.showMsgZhanliInfoPanel(c)},d.prototype.showMsgZhanliInfoPanel=function(b){for(var c=(28*UIData.Scale,0);c<b.length;c++){var d=new Vector2D(Scene_data.stageWidth/3,Scene_data.stageHeight/2),e=Math.floor(b[c].y/100),f=ColorType.Green20a200+getKeyProById(b[c].x);f+=e>0?"+"+e:e;var g=b[c].y>0?ColorType.Green56da35:ColorType.Redd92200;this.showZhanliTip(g+f,a.PopMsgVo.type7,d)}},d.prototype.showZhanliTip=function(b,c,d){var e=0;this.zhanliNearTime>=TimeUtil.getTimer()&&(e=this.zhanliNearTime-TimeUtil.getTimer()+500,e=Math.max(e,500)),this.zhanliNearTime=TimeUtil.getTimer()+e,TimeUtil.addTimeOut(e,function(){a.MsgTipManager.outStr(b,c,d)})},d.prototype.smsgModuleActiv=function(a){var b=a.readUint32(),c=tb.TB_system_base.getTempVo(b);if(c.show){var d=Math.floor(c.id/10),e=tb.TB_system_icon.getTempVo(d);if(e.move)switch(e.id){default:this.showSystemOpenPanel(e)}else GuidData.player&&(GuidData.player.resetSystemItem(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.REFRESH_MAINUI_PANEL)))}},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_MSG_PIC_DATA),new b(b.SHOW_EFFECTS_DATA),new b(b.SHOW_SKILL_TIP_DATA),new b(b.SHOW_EQU_MOVE_DATA),new b(b.SHOW_SMSG_ITEM_NOTICE),new b(b.OPEN_SKILL_SLOT),new b(b.SHOW_GUIDE_POP_VIEW),new b(b.SHOW_PAGE_POP_VIEW),new EngineEvent(EngineEvent.PLAYER_FIELD_FORCE),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL)]},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_ATTRIBUTE_CHANGED]=function(b){a.smsgAtiribute(b)},b[Protocols.SMSG_MODULE_ACTIVE]=function(b){a.smsgModuleActiv(b)},b},d}(BaseProcessor);a.MsgTipProcessor=d}(msgtip||(msgtip={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),quest;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._topRender.uiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,this.dailyQuestList&&(this.dailyQuestList.dispose(),this.dailyQuestList=null),this._frameRender&&(this._frameRender.dispose(),this._frameRender=null),b.prototype.dispose.call(this)},d.prototype.applyLoad=function(){var a=this;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this._topRender.uiAtlas.setInfo("ui/uidata/quest/daily.xml","ui/uidata/quest/daily.png",function(){a.loadConfigCom()},"ui/uidata/quest/dailypc.png")},d.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas;var a=this._topRender;this.a_6=this.addChild(a.getComponent("a_6")),this.a_3=this.addChild(this._midRender.getComponent("a_3"));var b=this.addChild(this._midRender.getComponent("a_4"));LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,b.skinName,ColorType.colorb96d49+"完成全部任务奖励",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.listindex=this.addChild(a.getComponent("listindex")),this.addUIList(["a_2_1","a_10","a_9","a_8","a_11_1","a_11_2","a_5","a_huawen","a_btntxt"],this._midRender),this._aryrewardall=new Array,this._aryreward=new Array;for(var c=0;3>c;c++){var d=this.addChild(a.getComponent("rewardAll_"+(c+1)));d.addEventListener(InteractiveEvent.Up,this.propClik,this),this._aryrewardall.push(d);var e=this.addChild(a.getComponent("reward_"+(c+1)));e.addEventListener(InteractiveEvent.Up,this.propClik,this),this._aryreward.push(e)}var f=this.addChild(this._publicbgRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(f,"b_right_bg_top",a);var g=this.addChild(this._publicbgRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(g,"b_right_bg_bottom",a),this.btn=this.addEvntButUp("cnew_btn1",this._publicbgRender),this.setSizeForPanelUiCopy(this.btn,"btn",a),this._publicbgRender.applyObjData(),this.buildFram()},d.prototype.buildFram=function(){var a=this;this._frameRender?this.applyLoadComplete():(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ef_fl"),4,4,function(b){a.effui=b,a.effui.x=a.btn.x-68,a.effui.y=a.btn.y-18,a.effui.width=2.2*a.effui.baseRec.width,a.effui.height=.7*a.effui.baseRec.height,a.effui.speed=3,a.applyLoadComplete()},1))},d.prototype.playEff=function(a){this.effui&&(a?(this.addChild(this.effui),this.effui.play()):this.removeChild(this.effui))},d.prototype.setUiSizeByName=function(a,b){var c=this._topRender.getComponent(b);a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height},d.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),this.dailyQuestList&&this.dailyQuestList.hide()},d.prototype.butClik=function(b){var c=this;switch(b.target){case this.w_close:this.close();break;case this.btn:UiTweenScale.getInstance().changeButSize(b.target);var d=tb.TB_quest_daily2.getTempVo(1),e=GuidData.quest.getDailyQuestCompleteNum()>=a.QuestModel.getInstance().getQuestDailyVo().length;console.log("===",GuidData.quest.getDailyQuestCompleteNum(),d.finishQuestsNum[0],GuidData.quest.getDailyQuestSubmitState()),GuidData.quest.getDailyQuestCompleteNum()>=d.finishQuestsNum[0]&&!GuidData.quest.getDailyQuestSubmitState()?e?this.submitfuc():AlertUtil.show("您的任务还未全部完成，是否交付任务？","提示",function(a){c.backFun(a)},2,["是","否"]):GuidData.quest.getDailyQuestSubmitState()?msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"您已提交过任务",99):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"请至少完成"+d.finishQuestsNum[0]+"个任务",99)}},d.prototype.backFun=function(a){1==a&&this.submitfuc()},d.prototype.submitfuc=function(){NetManager.getInstance().protocolos.submit_quest_daily2()},d.prototype.propClik=function(a){if(a.target.data){var b=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);b.id=a.target.data,ModuleEventManager.dispatchEvent(b)}},d.prototype.resize=function(){b.prototype.resize.call(this),this.dailyQuestList&&(this.dailyQuestList.left=this.listindex.parent.x/UIData.Scale+this.listindex.x,this.dailyQuestList.top=this.listindex.parent.y/UIData.Scale+this.listindex.y)},d.prototype.refrish=function(){var b=tb.TB_quest_daily2.getTempVo(1),d=GuidData.quest.getDailyQuestSubmitState(),e=this.getMinrewardNum();console.log("--$completenum--",e);var f=tb.TB_quest_daily2_finish_reward.getTempVo(b.rewardsSelect[e-1]);LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_3.skinName,ColorType.colorb96d49+"交付"+ColorType.color2daa35+e+ColorType.colorb96d49+"个任务基础奖励",16,TextAlign.CENTER,ColorType.Brown7a2f21);for(var g=GuidData.quest.getDailyQuestCompleteNum()>=a.QuestModel.getInstance().getQuestDailyVo().length,h=0;h<b.allFinishrewards.length;h++)this.drawProp(this._aryrewardall[h],d,g,b.allFinishrewards[h]),1==b.allFinishrewards.length&&LabelTextFont.clearLabel(this._topRender.uiAtlas,this._aryrewardall[1].skinName);for(var h=0;h<f.rewards.length;h++)this.drawProp(this._aryreward[h],d,!0,f.rewards[h]),1==f.rewards.length&&LabelTextFont.clearLabel(this._topRender.uiAtlas,this._aryreward[1].skinName);LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_6.skinName,ColorType.colorb96d49+"任务完成情况："+ColorType.Green2ca937+this.getCompleteNum()+"/"+a.QuestModel.getInstance().getQuestDailyVo().length,16,TextAlign.CENTER,ColorType.Brown7a2f21),this.drawBtn(d),this.dailyQuestList||(this.dailyQuestList=new c,this.dailyQuestList.init(this._topRender.uiAtlas)),this.dailyQuestList.show(),console.log("--------------------------------------------",a.QuestModel.getInstance().getQuestDailyVo(),GuidData.quest.getDailyQuestCompleteNum(),GuidData.quest.getDailyQuestSubmitState()),this.playEff(g&&!GuidData.quest.getDailyQuestSubmitState()),this.resize()},d.prototype.getCompleteNum=function(){for(var b=a.QuestModel.getInstance().getQuestDailyVo(),c=0,d=0;d<b.length;d++)b[d].questDataVo.taskState==SharedDef.QUEST_STATUS_END&&c++;return console.log("-completenum--",c),c},d.prototype.getMinrewardNum=function(){for(var a=GuidData.quest.getDailyQuestCompleteNum(),b=GuidData.quest.getDailyQuestSubmitState(),c=tb.TB_quest_daily2.getTempVo(1),d=0;d<c.finishQuestsNum.length;d++){if(a<c.finishQuestsNum[d])return b&&d>0?c.finishQuestsNum[d-1]:c.finishQuestsNum[d];if(a==c.finishQuestsNum[c.finishQuestsNum.length-1])return a}},d.prototype.drawBtn=function(a){var b,c=tb.TB_quest_daily2.getTempVo(1),d=this._topRender.uiAtlas.getRec(this.btn.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);if(a)b=this._topRender.uiAtlas.getRec("Btn2");else{b=this._topRender.uiAtlas.getRec("Btn1");var f=GuidData.quest.getDailyQuestCompleteNum()}e.drawImage(this._topRender.uiAtlas.useImg,b.pixelX,b.pixelY,b.pixelWitdh,b.pixelHeight,0,0,b.pixelWitdh,b.pixelHeight),!a&&f<c.finishQuestsNum[0]&&UIManager.getInstance().makeCtxToGray(e,new Rectangle(0,0,130,49)),this._topRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)},d.prototype.drawProp=function(a,b,c,d){var e=this;a.data=d[0],IconManager.getInstance().getIcon(GameData.getIconCopyUrl(d[0]),function(f){var g=e._topRender.uiAtlas.getRec(a.skinName),h=UIManager.getInstance().getContext2D(g.pixelWitdh,g.pixelHeight,!1);if(UiDraw.cxtDrawImg(h,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),h.drawImage(f,0,0,60,60,4,4,60,60),LabelTextFont.writeSingleLabelToCtxSetAnchor(h,ColorType.Whitefffce6+Snum(d[1]),16,64,48,TextAlign.RIGHT),b&&(UIManager.getInstance().makeCtxToGray(h,new Rectangle(0,0,68,68)),c)){var i=e._topRender.uiAtlas.getRec("Receive");h.drawImage(e._topRender.uiAtlas.useImg,i.pixelX,i.pixelY,i.pixelWitdh,i.pixelHeight,0,0,i.pixelWitdh,i.pixelHeight)}e._topRender.uiAtlas.updateCtx(h,g.pixelX,g.pixelY)})},d}(WindowUi);a.QuestDailyPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=315,a.top=134,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,596,345,0,91,3,512,1024,1,6)},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.resetData=function(){var b=a.QuestModel.getInstance().getQuestDailyVo(),c=this.getData(b);this.refreshData(c);for(var d=0;d<b.length;d++){var e=b[d],f=e.questDataVo.taskState==SharedDef.QUEST_STATUS_END;if(f)this.hideEffect(d);else{var g;g=6==e.tb_quest.targetsPosition[0][0]?GuidData.bag.getItemCount(e.tb_quest.targetsPosition[0][e.tb_quest.targetsPosition[0].length-1])>=e.questDataVo.items[0].num:e.questDataVo.items[0].process>=e.questDataVo.items[0].num,g?this.showEffect(d,this.getIdxX(d)+402,this.getIdxY(d)-2,1.5,.7):this.hideEffect(d)}}},c.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.setEffectUrl("ef_fl",4,4,6)},c.prototype.effectComplte=function(){console.log("加载好了，回调"),this.resetData()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),ModulePageManager.hideResTittle(),this.hideEffect()},c}(EffectSlist);a.DailyQuestList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Bg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"Bg",0,0,596,88,10,10),a.addChild(this.Bg),this.Icon=this.creatSUI(d,this.parentTarget.baseAtlas,"Icon",11,10,68,68),a.addChild(this.Icon),this.Info=this.creatSUI(d,this.parentTarget.baseAtlas,"Info",87,21,162,45),a.addChild(this.Info),this.Reward0=this.creatSUI(d,this.parentTarget.baseAtlas,"Reward0",257,8,120,35),a.addChild(this.Reward0),this.Reward1=this.creatSUI(d,this.parentTarget.baseAtlas,"Reward1",257,35,120,35),a.addChild(this.Reward1),this.Btn1=this.creatSUI(d,this.parentTarget.baseAtlas,"Btn1",448,21,103,43),a.addChild(this.Btn1),this.Btn1.addEventListener(InteractiveEvent.Up,this.clickEvt,this)},c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Bg.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG),this.drawIcon();var a=this.itdata.data;LabelTextFont.writeTextAutoVerticalCenter(this._baseRender.uiAtlas,this.Info.skinName,a.tb_quest.text[0][0],14,ColorType.Brown7a2f21,150,"",!0);for(var a=this.itdata.data,b=0;b<a.tb_quest.rewards[0].length;b++){var c=this["Reward"+b];UiDraw.drawRewardIconAndtxt(c,a.tb_quest.rewards[0][b],!1,TextAlign.LEFT,5)}this.getbtn()}},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.drawIcon=function(){var a=this,b=this.itdata.data,c=b.questDataVo.taskState==SharedDef.QUEST_STATUS_END;IconManager.getInstance().getIcon("ui/load/quest/dailyquest.png",function(d){var e=a._baseRender.uiAtlas.getRec(a.Icon.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(b.tb_quest_daily2_set.quality),new Rectangle(0,0,68,68),UIData.publicUi),f.drawImage(d,0,0,60,60,4,4,60,60);var g;g=6==b.tb_quest.targetsPosition[0][0]?c?b.questDataVo.items[0].num:GuidData.bag.getItemCount(b.tb_quest.targetsPosition[0][b.tb_quest.targetsPosition[0].length-1]):b.questDataVo.items[0].process,LabelTextFont.writeSingleLabelToCtx(f,g+"/"+b.questDataVo.items[0].num,16,0,45,TextAlign.CENTER,ColorType.Whiteffffff,ColorType.colord27262e),a._baseRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},c.prototype.getbtn=function(){var a=this.itdata.data,b=a.questDataVo.taskState==SharedDef.QUEST_STATUS_END;if(b)this.drawbtn(this.Btn1,"Btn2");else{var c;c=6==a.tb_quest.targetsPosition[0][0]?GuidData.bag.getItemCount(a.tb_quest.targetsPosition[0][a.tb_quest.targetsPosition[0].length-1])>=a.questDataVo.items[0].num:a.questDataVo.items[0].process>=a.questDataVo.items[0].num;var d,e="Btn4";d=c?"Txt4":1==a.tb_quest.targetsPosition[0][0]?"Txt1":6==a.tb_quest.targetsPosition[0][0]?"Txt2":"Txt3",this.drawbtn(this.Btn1,e,d)}},c.prototype.drawbtn=function(a,b,c){void 0===c&&(c="");var d=this._baseRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1),f=this.parentTarget.baseAtlas.getRec(b);if(e.drawImage(this.parentTarget.baseAtlas.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,0,0,f.pixelWitdh,f.pixelHeight),c.length>0){var g=this.parentTarget.baseAtlas.getRec(c);e.drawImage(this.parentTarget.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,d.pixelWitdh/2-g.pixelWitdh/2,d.pixelHeight/2-g.pixelHeight/2,g.pixelWitdh,g.pixelHeight)}this._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)},c.prototype.clickEvt=function(b){if(UIManager.getInstance().disMoveNnum(new Vector2D(b.x,b.y),10)&&(console.log("---clickEvt---"),this.itdata&&this.itdata.data)){var c=this.itdata.data,d=c.questDataVo.taskState==SharedDef.QUEST_STATUS_END;if(d)return;if(GuidData.quest.getDailyQuestSubmitState())msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"您已提交过任务",99);else{var e;e=6==c.tb_quest.targetsPosition[0][0]?GuidData.bag.getItemCount(c.tb_quest.targetsPosition[0][c.tb_quest.targetsPosition[0].length-1])>=c.questDataVo.items[0].num:c.questDataVo.items[0].process>=c.questDataVo.items[0].num;
if(e)console.log("交付"),NetManager.getInstance().protocolos.pick_daily2_quest_reward(c.questDataVo.indx);else{var f=new a.QuestTaskVo;f.questDataVo=c.questDataVo;var g=c.tb_quest.targetsPosition[0];a.QuestModel.getInstance().meshQuestTargets(f,g),ModuleEventManager.dispatchEvent(new a.QuestEvent(a.QuestEvent.HIDE_DAILY_QUEST_EVENT))}}}},c.prototype.setnull=function(){UiDraw.clearUI(this.Bg),UiDraw.clearUI(this.Icon),UiDraw.clearUI(this.Info),UiDraw.clearUI(this.Reward0),UiDraw.clearUI(this.Reward1),UiDraw.clearUI(this.Btn1)},c}(SListItem);a.DailyQuestListRender=d}(quest||(quest={}));var quest;!function(a){var b=function(){function a(){}return a.MAIN=0,a.XUANSHANG=1,a.ZHIXIAN=2,a.RING=4,a.DAILY=5,a}();a.QuestType=b;var c=function(){function a(){}return a}();a.DailyQuestVo=c;var d=function(){function a(){this.huanNum=0,this.finishNum=0,this.finish=!1}return Object.defineProperty(a.prototype,"id",{get:function(){return this.tb_quest?this.tb_quest.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"questName",{get:function(){if(4==this.tb_quest.type&&0==this.tb_quest.start){var a=tb.TB_quest_daily_base.getTempByID(1).dailyLimit;return this.tb_quest.questName+"("+(this.huanNum+1)+"/"+a+")"}return this.tb_quest.type==b.DAILY&&0==this.tb_quest.start?this.tb_quest.questName+"("+this.finishNum+"/"+this.huanNum+")":this.tb_quest.questName},enumerable:!0,configurable:!0}),a.prototype.refresh=function(){var a=new Array;if(!this.tb_quest.rewards)return void console.log("无数据");1==this.tb_quest.rewards.length&&(a=this.tb_quest.rewards[0]),this.resItemReward=new Array,this.equItemReward=new Array;for(var b=0;b<a.length;b++){var c=a[b],d=tb.TB_item_template.get_TB_item_template(Number(c[0]));d.money_type>0?this.resItemReward.push(c):this.equItemReward.push(c)}this.finish=Boolean(this.questDataVo.taskState==SharedDef.QUEST_STATUS_COMPLETE)},a}();a.QuestTaskVo=d;var e=function(){function c(){this._questDic=new Object,c.TrackDic=new Dictionary([])}return c.getIconNameById=function(a){var b=PuiData.A_quest_ion1;return 2==a&&(b=PuiData.A_quest_ion3),b},c.getInstance=function(){return this._instance||(this._instance=new c),this._instance},c.prototype.refresh=function(){this._taskItem=new Array;for(var a=GuidData.quest.getTaskList(),e=0;e<a.length;e++){var f;this._questDic[a[e].id]?f=this._questDic[a[e].id]:(f=new d,this._questDic[a[e].id]=f,f.tb_quest=tb.TB_quest.getTbById(a[e].id)),f.tb_quest.type!=b.RING?(f.questDataVo=a[e],f.refresh(),f.tb_quest.type==b.DAILY&&1!=f.tb_quest.start||this._taskItem.unshift(f),c.TrackDic.containsKey(String(f.id))||(c.TrackDic[f.id]=!0)):f.huanNum=GuidData.player.getPlayerIntFieldDailyQuestFinished()}},c.prototype.getQuestDailyVo=function(){for(var a=new Array,b=GuidData.quest.getDaliyQuestList(),c=0;c<b.length;c++){var e=new d;e.index=c,e.questDataVo=b[c],e.tb_quest=tb.TB_quest.getTbById(b[c].id),e.tb_quest_daily2_set=tb.TB_quest_daily2_set.getTempVo(e.tb_quest.belongSet),a.push(e)}return a.sort(function(a,b){return a.questDataVo.taskState==b.questDataVo.taskState?a.tb_quest_daily2_set.quality-b.tb_quest_daily2_set.quality:a.questDataVo.taskState-b.questDataVo.taskState}),a},c.prototype.getQuestDialogueVo=function(a){this.refresh();var b=new Array,c=this.getQuestDailyVo();c=c.concat(this._taskItem);for(var d=0;d<c.length;d++)for(var e=0;e<c[d].tb_quest.targetsPosition.length;e++){var f=c[d].tb_quest.targetsPosition[e];3==f[0]&&f[4]==a&&(c[d].finish||b.push(c[d]))}return b},c.prototype.getMainTaskVo=function(){this.refresh();for(var a=0;a<this._taskItem.length;a++)if(this._taskItem[a].tb_quest.type==b.MAIN)return this._taskItem[a];return null},c.prototype.getOtherTaskVo=function(){this.refresh();for(var a=new Array,c=0;c<this._taskItem.length;c++)this._taskItem[c].tb_quest.type!=b.MAIN&&a.push(this._taskItem[c]);return a},c.prototype.getDailyQuestVoTemp=function(){for(var a,b=this.getQuestDailyVo(),c=b.length,d=0,e=0;c>e;e++)b[e].questDataVo.taskState==SharedDef.QUEST_STATUS_END&&d++,a=b[e];return GuidData.quest.getDailyQuestSubmitState()?null:(console.log("日常",d,"/",c),a&&(a.huanNum=c,a.finishNum=d),a)},c.prototype.pick_quest_reward=function(a){GuidData.map.isBaseMap()&&(0==a.tb_quest.popup?(console.log("$taskVo.questDataVo.indx",a.questDataVo.indx),NetManager.getInstance().protocolos.pick_quest_reward(a.questDataVo.indx)):1==a.tb_quest.popup&&a.tb_quest.type==b.MAIN&&(console.log("pick_quest_reward_popup",a.tb_quest.popup),ModulePageManager.openPanel(SharedDef.MODULE_QUEST,-1)))},c.prototype.changeTab=function(){for(var a=training.TrainingModel.getInstance().getTaskvo(),b=0;b<a.length;b++)a[b].questData&&a[b].tab_adventure.map_id==GuidData.map.tbMapVo.id&&(leftui.TaskListUi.showType=1)},c.prototype.getTaskStrItemByTaskVo=function(c,d){var e=a.QuestModel.lineWidth225,f=leftui.TaskListUi.taskUiScale15,g=new Array;g.push("[59d9fe]"+d.tb_quest.chapterName+d.questName);d.questDataVo.items.length;if(d.textrectH=new Array,d.textrectH.push(1),d.textRectHeight=1,d.questDataVo.taskState==SharedDef.QUEST_STATUS_UNAVAILABLE&&d.tb_quest.level>GuidData.player.getLevel()){g.push("[ff0000]需要达到等级"+d.tb_quest.level+"[]"),d.textrectH.push(1),d.textRectHeight++;for(var h=0;h<d.tb_quest.text.length;h++);}if(d.tb_quest.type==b.DAILY&&1!=d.tb_quest.start)return g.push("[d8d49c]"+tb.TB_quest_daily2_base.getTempVo(1).questshow),d.textrectH.push(1),d.textRectHeight++,g;for(var i=0;i<d.questDataVo.items.length;i++){var j=d.questDataVo.items[i],k="";k+="("+j.process,k+="/"+j.num+")",d.tb_quest.targetsPosition&&d.tb_quest.targetsPosition[0]&&3==d.tb_quest.targetsPosition[0][0]&&2!=d.tb_quest.ctype&&(k="");var l=d.tb_quest.text[i][0];k=j.num==j.process?"[77e313]"+TextRegExp.getTextOnlyTxt(c,l)+k:"[d8d49c]"+l+k,c.font="bolder  "+14*f+"px "+UIData.font;var m=TextRegExp.getTextMetrics(c,k),n=Math.ceil(m.width/e);d.textrectH.push(Math.ceil(m.width/e)),d.textRectHeight+=n,g.push(k)}if(d.tb_quest.type==b.MAIN&&d.tb_quest.hint.length)for(var o=0;o<d.tb_quest.hint.length;o++){var p=d.tb_quest.hint[o][0];console.log("$strHint===========>",d.tb_quest.hint),c.font="bolder  "+14*f+"px "+UIData.font;var m=TextRegExp.getTextMetrics(c,p),n=Math.ceil(m.width/e);m.width%e<4&&n>1&&n--,d.textrectH.push(Math.ceil(m.width/e)),d.textRectHeight+=n,g.push(p)}return d.itemStrList=g,g},c.prototype.toplay=function(a){var b=this,c=AstarUtil.findPath2D(GameInstance.mainChar.getAstarPos(),a);c&&c.length>1?(GameInstance.mainChar.isMount||GuidData.player.isOpenSystemById(210)&&(console.log("得上坐骑看看"),NetManager.getInstance().protocolos.ride_mount()),AotuSkillManager.getInstance().aotuWalk=!0,MainCharControlModel.getInstance().setWalkPathFun(c,function(){b.walkPathComplete()})):this.walkPathComplete()},c.prototype.walkPathComplete=function(){if(AotuSkillManager.getInstance().aotuWalk=!1,GameInstance.questMoveVo&&GameInstance.questMoveVo.data instanceof a.QuestTaskVo){var b=GameInstance.questMoveVo.data,c=b.clikInfo;if(c){var d=c[0],e=0;switch(d){case 7:case 1:AotuSkillManager.getInstance().aotuBattle=!0,e=0;break;case 3:console.log("npc对话");var f=new dialog.DialogueEvent(dialog.DialogueEvent.SHOW_DIALOGUE_PANEL);f.entryId=c[4],ModuleEventManager.dispatchEvent(f),e=1;break;case 4:console.log("采集宝箱"),e=2;var g=tb.TB_gameobject_template.get_TB_gameobject_template(c[4]);e=g.style,this.findNearCollectionTaget(c[4]);break;case 5:console.log("使用物品",c[4],c[5]);var h=new newbieguide.UseItemVo;h.itemId=c[5],h.time=5e3,h.guid="",h.equPos=0,h.num=1;var i=new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.SHOW_USEITEM_EVENT);i.data=h,ModuleEventManager.dispatchEvent(i),e=3}}}},c.prototype.getClikTaskItemByIndx=function(a,b){for(var c,d,e=0,f=0,g=0;g<a.textrectH.length;g++){if(f=a.textrectH[g]+e,b>=e&&f>b&&g>=1&&(d=a.questDataVo.items[g-1],d&&d.num!=d.process)){c=a.tb_quest.targetsPosition[g-1];break}e=f}if(!c)for(var h=0;h<a.questDataVo.items.length;h++)if(d=a.questDataVo.items[h],d.num!=d.process){c=a.tb_quest.targetsPosition[h];break}return c},c.prototype.clikTaskVoCell=function(a,c){if(a.finish)NetManager.getInstance().protocolos.pick_quest_reward(a.questDataVo.indx);else if(a.tb_quest.type==b.DAILY&&1!=a.tb_quest.start)console.log("---111-日常任务"),ModulePageManager.openPanel(SharedDef.MODULE_DAILY_TASKS,SharedDef.MODULE_DAILY_TASKS);else if(a.tb_quest.targetsPosition){var d=this.getClikTaskItemByIndx(a,c);this.meshQuestTargets(a,d)}},c.prototype.meshQuestTargets=function(b,c){if(c){var d=c[0];switch(d){case 1:case 3:case 4:case 5:case 7:GameInstance.questMoveVo=new QuestMoveVo,GameInstance.questMoveVo.pos=new Vector2D(c[2],c[3]),b.clikInfo=c,GameInstance.questMoveVo.data=b,0!=c[1]?GuidData.map.getMapID()==c[1]?(a.QuestModel.getInstance().toplay(new Vector2D(c[2],c[3])),GuidData.grow.getMountLevel()>0&&(console.log("上坐骑"),GameInstance.mainChar.isMount||NetManager.getInstance().protocolos.ride_mount())):bottomui.Progress_line.getInstance().show(1e3,function(){console.log("传送",c[1],GuidData.map.getLineID()),NetManager.getInstance().protocolos.teleport_map(c[1],GuidData.map.getLineID())}):this.walkPathComplete();break;case 2:this.openPanel(c[1],c[2]);break;case 8:console.log("任务下标",b.questDataVo.indx),NetManager.getInstance().protocolos.execute_quest_cmd_after_accepted(b.questDataVo.indx);break;case 6:var e=[c[2],c[3]];this.openPanel(c[1],e);break;case 10:AotuSkillManager.getInstance().aotuBattle=!0,GuidData.map.isAdventureBaseScene()||NetManager.getInstance().protocolos.enter_trial_instance();break;case 11:AotuSkillManager.getInstance().aotuBattle=!0,GuidData.map.isAdventureBossScene()||NetManager.getInstance().protocolos.challange_boss()}}},c.prototype.openPanel=function(a,b){var c;c=a==SharedDef.MODULE_MALL?b[0]:b;var d=tb.TB_system_base.getTempVo(Number(10*a+c));return d.level>GuidData.player.getLevel()?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+d.level+"级后开启系统",99):void ModulePageManager.openPanel(a,b)},c.prototype.use_gameobject=function(a){var b=this,c=a.unit.getUintGuid(),d=tb.TB_gameobject_template.get_TB_gameobject_template(a.unit.getEntry()),e=0;3==d.style&&(e=1),4==d.style&&(e=2),bottomui.Progress_line.getInstance().show(3e3,function(){NetManager.getInstance().protocolos.use_gameobject(c),TimeUtil.addTimeOut(500,function(){b.collectionNextQuest()})},e)},c.prototype.collectionNextQuest=function(){if(GameInstance.questMoveVo){var a=GameInstance.questMoveVo.data,b=c.getInstance().getMainTaskVo();a.id!=b.id?this.walkToNewMainQuest():c.getInstance().clikTaskVoCell(a,0)}},c.prototype.getNextRingQuest=function(){for(var a=0;a<this._taskItem.length;a++)if(this._taskItem[a].tb_quest.type==b.RING)return this._taskItem[a];return null},c.prototype.walkToNewMainQuest=function(){if(GameInstance.questMoveVo){var a,c=GameInstance.questMoveVo.data;if(c&&c.tb_quest)switch(c.tb_quest.type){case b.MAIN:a=this.getMainTaskVo();break;case b.XUANSHANG:a=this.getNextXuanshangQuest()}a&&a.tb_quest.targetsPosition.length&&2!=a.tb_quest.targetsPosition[0][0]&&c.id!=a.id&&this.clikTaskVoCell(a,0)}},c.prototype.getNextXuanshangQuest=function(){for(var a=0;a<this._taskItem.length;a++)if(this._taskItem[a].tb_quest.ctype==b.XUANSHANG)return this._taskItem[a];return null},c.prototype.isNeedMoveNextQuestPos=function(){if(!GameInstance.attackTarget&&GameInstance.questMoveVo){var a=GameInstance.questMoveVo.data;if(7==a.clikInfo[0])for(var b=0;b<a.questDataVo.items.length;b++){var d=a.questDataVo.items[b];d.num==d.process&&a.clikInfo==a.tb_quest.targetsPosition[b]&&(AotuSkillManager.getInstance().aotuBattle=!1,c.getInstance().clikTaskVoCell(a,0))}}},c.prototype.findNearCollectionTaget=function(a){for(var b=GameInstance.roleList,c=0;b&&c<b.length;c++){var d=b[c];d.unit.getTypeID()!=SharedDef.TYPEID_GAMEOBJECT||d.isDeath||d.unit.getEntry()!=a||this.use_gameobject(d)}},c.prototype.frameUpData=function(){if(GameInstance.questMoveVo&&GameInstance.questMoveVo.data instanceof d){var a=GameInstance.questMoveVo.data;if(a.finish){if(GameInstance.questMoveVo=null,AotuSkillManager.getInstance().aotuBattle){var b=this.getMainTaskVo();b&&(console.log(b),this.clikTaskVoCell(b,0)),AotuSkillManager.getInstance().aotuBattle=!1}}else this.isNeedMoveNextQuestPos()}},c.lineWidth225=225,c}();a.QuestModel=e}(quest||(quest={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),quest;!function(a){var b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.tabType=0,b}return __extends(b,a),b.SHOW_DAILY_QUEST_EVENT="SHOW_DAILY_QUEST_EVENT",b.HIDE_DAILY_QUEST_EVENT="HIDE_DAILY_QUEST_EVENT",b.REFRESH_DAILY_QUEST_EVENT="REFRESH_DAILY_QUEST_EVENT",b}(BaseEvent);a.QuestEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"QuestModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.QuestModule=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"QuestProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;c.type==b.SHOW_DAILY_QUEST_EVENT?this.showDailyQuestPanel():c.type==b.HIDE_DAILY_QUEST_EVENT?this._dailyquestpanel&&this._dailyquestpanel.close():c.type==b.REFRESH_DAILY_QUEST_EVENT&&this._dailyquestpanel&&this._dailyquestpanel.hasStage&&this._dailyquestpanel.refrish()}if(a instanceof UIPanelEvent){var d=a;d.panel==this._dailyquestpanel&&(this._dailyquestpanel.dispose(),this._dailyquestpanel=null,console.log("释放面板 _questPanel"))}},d.prototype.showDailyQuestPanel=function(){var b=this;this._dailyquestpanel||(this._dailyquestpanel=new a.QuestDailyPanel),this._dailyquestpanel.load(function(){b._dailyquestpanel.hasStage||(UIManager.getInstance().addUIContainer(b._dailyquestpanel),b._dailyquestpanel.refrish())})},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_DAILY_QUEST_EVENT),new b(b.HIDE_DAILY_QUEST_EVENT),new b(b.REFRESH_DAILY_QUEST_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.QuestProcessor=d}(quest||(quest={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fightui;!function(a){var b=function(){function a(){}return a}();a.SkillUIVo=b;var c=function(){function a(){}return a.prototype.update=function(){var a=Math.ceil((GuidData.player.nextCanJumpTM-TimeUtil.getTimer())/1e3);if(a>0){var b=(GuidData.player.nextCanJumpTM-TimeUtil.getTimer())/1e4;this.jumpcd.setCdNum(1-b)}else this.jumpcd.setCdNum(.999999);this.resetEatCd()},a.prototype.resetEatCd=function(){var a=0,b=tb.SkillData.getCdMeshBySkillId(SharedDef.PLAYER_INT_FIELD_RESTORE_POTION_CD);if(a=isNaN(b)?0:b-TimeUtil.getTimer(),a>0){var c=tb.TB_restore_potion_base.get_TB_restore_potion_base(GuidData.player.getLevel()).cd;a/=1e3*c,a=Math.max(0,Math.min(a,.999999)),this.eatcd.setCdNum(1-a)}else this.eatcd.setCdNum(.999999)},a.prototype.clikJump=function(){GuidData.player.jumpButcanClik()?AotuSkillManager.getInstance().jumpTo():console.log("clikJumpCd中 ")},a}();a.JumpAndEatCompenent=c;var d=function(a){function d(){var b=a.call(this)||this;return b.skilImgKey=new Object,b.skillList=new Array,b.nextThreeButTime=0,b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.right=0,b.bottom=0,b}return __extends(d,a),d.prototype.setRender=function(a,b,c,d){this._bottomRender=a,this._midRender=b,this._topRender=c,this._cdRender=d,this.loadConfigCom()},d.prototype.loadConfigCom=function(){this.a_skill_1=this.addEvntBut("a_skill_1",this._bottomRender),this.a_skill_2=this.addEvntBut("a_skill_2",this._bottomRender),this.a_skill_3=this.addEvntBut("a_skill_3",this._bottomRender),this.a_skill_4=this.addEvntBut("a_skill_4",this._bottomRender),this.a_skill_5=this.addEvntBut("a_skill_5",this._bottomRender),this.a_skill_6=this.addEvntBut("a_skill_6",this._bottomRender),this.addSkillUiToList(this.a_skill_2),this.addSkillUiToList(this.a_skill_3),this.addSkillUiToList(this.a_skill_4),this.addSkillUiToList(this.a_skill_5),this.a_jump_but=this.addChild(this._bottomRender.getComponent("a_jump_but")),this.a_jump_but.addEventListener(InteractiveEvent.Up,this.butClikSample,this),this.a_eat_icon=this.addChild(this._bottomRender.getComponent("a_eat_icon")),this.a_eat_icon.addEventListener(InteractiveEvent.Up,this.butClikSample,this),this._jumpAndEatCompenent=new c,this._jumpAndEatCompenent.jumpUi=this.a_jump_but,this._jumpAndEatCompenent.jumpcd=this._cdRender.getComponent("a_jump_cd"),this._jumpAndEatCompenent.eatUi=this.a_eat_icon,this._jumpAndEatCompenent.eatcd=this._cdRender.getComponent("a_eat_cd"),this._jumpAndEatCompenent.jumpcd.x=this._jumpAndEatCompenent.jumpUi.x,this._jumpAndEatCompenent.jumpcd.y=this._jumpAndEatCompenent.jumpUi.y,this._jumpAndEatCompenent.jumpcd.clockwise=!1,this._jumpAndEatCompenent.eatcd.x=this._jumpAndEatCompenent.eatUi.x,this._jumpAndEatCompenent.eatcd.y=this._jumpAndEatCompenent.eatUi.y,this._jumpAndEatCompenent.eatcd.clockwise=!1,this.addChild(this._jumpAndEatCompenent.jumpcd),this.addChild(this._jumpAndEatCompenent.eatcd),this.refresh()},d.prototype.butClikSample=function(a){if(GameInstance.canclikFightui)switch(a.target){case this.a_jump_but:this._jumpAndEatCompenent.clikJump();break;case this.a_eat_icon:MainCharControlModel.getInstance().clikEat()}},d.prototype.addEvntBut=function(a,b){var c=this.addChild(b.getComponent(a));return c.addEventListener(InteractiveEvent.Down,this.butClik,this),c.addEventListener(InteractiveEvent.Up,this.butUpClik,this),c},d.prototype.butUpClik=function(a){},d.prototype.addSkillUiToList=function(a){var c=(this._cdRender,new b),d=this._cdRender.getComponent("a_cd_mask");d.setCdNum(1),d.x=a.x+1,d.y=a.y+1,c.baseRect=new Rectangle(a.x,a.y,a.width,a.height),this.addChild(d),c.cd=d,c.iconUi=a,c.blackMask=this.addChild(this._midRender.getComponent("a_bleak_ui")),c.blackMask.x=c.iconUi.x,c.blackMask.y=c.iconUi.y,c.blackMask.width=c.iconUi.width,c.blackMask.height=c.iconUi.height,c.cdnumA=this.addChild(this._topRender.getComponent("a_cd_num")),c.cdnumB=this.addChild(this._topRender.getComponent("a_cd_num")),c.cdnumA.Invisible(),c.cdnumB.Invisible();var e=new Vector2D(25,22);c.cdnumB.y=e.y+c.iconUi.y,c.cdnumA.y=e.y+c.iconUi.y,this.skillList.push(c)},d.prototype.update=function(a){for(var b=0;b<this.skillList.length;b++){var c=this.skillList[b];if(c.cd&&c.cdnumA){var d=TimeUtil.getTimer()-c.cd.lastTime;if(d<c.cd.cdTotalnum){var e=new Vector2D(25,22),f=Math.ceil((c.cd.cdTotalnum-d)/1e3),g=f%10;c.cdnumA.goToAndStop(g);var h=Math.floor(f/10);c.cdnumB.goToAndStop(h),0>=h?(c.cdnumB.Invisible(),c.cdnumA.x=e.x+c.baseRect.x):(c.cdnumB.x=e.x+c.baseRect.x-8,c.cdnumA.x=e.x+c.baseRect.x+8),c.blackMask.x=c.iconUi.x}else c.cdnumB.Invisible(),c.cdnumA.Invisible(),c.blackMask.x=2e3}}this._jumpAndEatCompenent.update()},d.prototype.loadBaseSkillIconById=function(a){var b=this.getPicToSkillById(a);this.drawPicToSkill(b),this.lastNeedShowUrl=b},d.prototype.getPicToSkillById=function(a){return"ui/load/skill/"+a+".png"},d.prototype.drawPicToSkill=function(a){var b=this;if(a==this.lastNeedShowUrl)if(this.skilImgKey[a]){var c=this._bottomRender.uiAtlas.getRec(this.a_skill_1.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(this.skilImgKey[a],0,0,c.pixelWitdh,c.pixelHeight),TextureManager.getInstance().updateTexture(this._bottomRender.uiAtlas.texture,c.pixelX,c.pixelY,d)}else{var e=new Image;e.onload=function(){b.skilImgKey[a]=e,b.drawPicToSkill(a)},e.src=Scene_data.fileRoot+a}},d.prototype.refresh=function(){tb.SkillData.resetSkillData();for(var a=tb.SkillData.skillList,b=0;b<a.length;b++){var c=a[b];c.slot>=2&&c.slot<=5?this.drawSkillIcon(c):b>0&&isNaN(c.slot)&&this.drawFristIconPic(c,b+1,this.getunlocklev(c.tb_skill_base.id))}},d.prototype.getunlocklev=function(a){for(var b=tb.TB_char_skill.get_TB_char_skillById(GuidData.player.getCharType()),c=0;c<b.unlocks.length;c++){var d=b.unlocks[c][1];if(d==a)return b.unlocks[c][0]}return-1},d.prototype.drawFristIconPic=function(a,b,c){var d=this;console.log("---");var e=this["a_skill_"+b];IconManager.getInstance().getIcon(getSkillIconUrl(String(a.tb_skill_base.icon)),function(a){var b=d._topRender.uiAtlas.getRec(e.skinName),f=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.SKILL_BG68,new Rectangle(0,0,71,71),UIData.publicUi),f.drawImage(a,4,4,62,62),UIManager.getInstance().makeCtxToGray(f,new Rectangle(0,0,71,71));var g=c>9?"":" ";g+=c+" 级\n开 启",LabelTextFont.writeSingleLabelToCtx(f,g,16,16,15,TextAlign.LEFT,ColorType.colorffe9b4,ColorType.colord27262e),d._topRender.uiAtlas.updateCtx(f,b.pixelX,b.pixelY)})},d.prototype.drawPicToFristDiveneIcon=function(){var a=this,b=TableData.getInstance().getTableByName(TableData.tb_divine_base);for(var c in b.data){var d=b.data[c];break}var e=tb.TB_divine_baseVO.get_TB_divine_base(d.id);LoadManager.getInstance().load(Scene_data.fileRoot+getSkillIconUrl(String(e.skillvo.tb_skill_base.icon)),LoadManager.IMG_TYPE,function(b){var c=a._topRender.uiAtlas.getRec(a.a_skill_5.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(b,2,2,65,65),UIManager.getInstance().makeCtxToGray(d,new Rectangle(0,0,69,69)),a._topRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},d.prototype.drawSkillIcon=function(a){var b=this["a_skill_"+a.slot];this.drawPicToSkillBut(a,b)},d.prototype.drawPicToSkillBut=function(a,b){var c=this;b.data=a,LoadManager.getInstance().load(Scene_data.fileRoot+getSkillIconUrl(String(a.tb_skill_base.icon)),LoadManager.IMG_TYPE,function(a){var d=c._topRender.uiAtlas.getRec(b.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.SKILL_BG68,new Rectangle(0,0,71,71),UIData.publicUi),e.drawImage(a,4,4,62,62),c._topRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)}),this.setSkillCdTime(b)},d.prototype.refreshCdBySkillId=function(a){if(1==a)GuidData.player.nextCanJumpTM=TimeUtil.getTimer()+tb.SkillData.jumpSkillVo.singleCD;else for(var b=0;b<this.skillList.length;b++){var c=this.skillList[b],d=c.iconUi.data;d&&d.id==a&&(tb.SkillData.setCdMeshData(d.id,d.singleCD),c.cd.lastTime=TimeUtil.getTimer())}},d.prototype.setSkillCdTime=function(a){for(var b=0;b<this.skillList.length;b++){var c=this.skillList[b];if(c.iconUi==a){var d=a.data,e=tb.SkillData.getCdMeshBySkillId(d.id);c.cd.cdTotalnum=d.singleCD,c.cd.lastTime=e-d.singleCD}}},d.prototype.butClik=function(a){if(GameInstance.canclikFightui){if(GuidData.map.is1V1())return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"斗剑台不能操作",99);switch(a.target){case this.a_skill_2:case this.a_skill_3:case this.a_skill_4:case this.a_skill_5:this.selectSkillButUi(a.target);break;case this.a_skill_1:this.selectThreeBut(),UiTweenScale.getInstance().changeButSize(a.target);break;case this.a_jump_but:AotuSkillManager.getInstance().jumpTo(),UiTweenScale.getInstance().changeButSize(a.target)}}},d.prototype.selectThreeBut=function(){if(this.nextThreeButTime<TimeUtil.getTimer()){var a=tb.SkillData.threeSkillList[GameInstance.threeBattarId++%3];this.playSkillToAttack(a),this.nextThreeButTime=TimeUtil.getTimer()+700}},d.prototype.testCdFinishBySkillId=function(a){for(var b=0;b<this.skillList.length;b++){var c=this.skillList[b];if(c.iconUi==a)return c.cd.isFinish}return!1},d.prototype.selectSkillButUi=function(a){GameInstance.mainChar.isDeath||this.testCdFinishBySkillId(a)&&a.data&&this.playSkillToAttack(a.data)},d.prototype.playSkillToAttack=function(a){var b=this;GameInstance.attackTarget=RelationManager.getInstance().findNearAttackBySkill();var c=FightSkillModel.getInstance().canPlaySkillToAttackTarger(10*a.tb_skill_uplevel.distance);c?(MainCharControlModel.getInstance().sendStop(),MainCharControlModel.getInstance().downMount(),AotuSkillManager.getInstance().aotuBattle=!1,FightSkillModel.getInstance().playSkillToAttack(a,!0)):GameInstance.mainChar._speedDirect?GameInstance.attackTarget=null:GameInstance.attackTarget?FightSkillModel.getInstance().moveToAttackTarger(GameInstance.attackTarget,a,function(){b.playSkillToAttack(a)}):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"附近没有目标",99)},d}(UIVirtualContainer);a.FightSkillPanel=d}(fightui||(fightui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fightui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.interfaceUI=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.right=0,a.bottom=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._cdUIRenderComponent=new CdRenderComponent,a.addRender(a._cdUIRenderComponent),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,TimeUtil.addFrameTick(function(b){a.update(b)}),a}return __extends(c,b),c.prototype.update=function(a){this.uiAtlasComplet&&this.fightSkillPanel.update(a)},c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/mainui/fight/fight.xml","ui/uidata/mainui/fight/fight.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this._cdUIRenderComponent.uiAtlas=this._midRender.uiAtlas,this.fightSkillPanel=new a.FightSkillPanel,this.fightSkillPanel.setRender(this._bottomRender,this._midRender,this._topRender,this._cdUIRenderComponent),this.addVirtualContainer(this.fightSkillPanel),this.uiAtlasComplet=!0,this.applyLoadComplete()},c}(UIPanel);a.FightUiPanel=b}(fightui||(fightui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fightui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"FightUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.FightUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_FIGHT_UI_PANEL="SHOW_FIGHT_UI_PANEL",b.HIDE_FIGHT_UI_PANEL="HIDE_FIGHT_UI_PANEL",b.REFRESH_SKILL_AOTUBATTLE="REFRESH_SKILL_AOTUBATTLE",b}(BaseEvent);a.FightUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"FightUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_FIGHT_UI_PANEL&&GuidData.map.showAreaById(AreaType.fightSKill_7)&&this.showPanel(),this._fightUiPanel&&b.type==c.HIDE_FIGHT_UI_PANEL&&this.hidePanel()}if(a instanceof mainUi.MainUiEvent&&this._fightUiPanel&&this._fightUiPanel.fightSkillPanel){var d=a;d.type==mainUi.MainUiEvent.PLAYER_SKILL_CD_REFRESH&&this._fightUiPanel.fightSkillPanel.refreshCdBySkillId(Number(d.data)),d.type==mainUi.MainUiEvent.RESET_SKILL_ICON&&this._fightUiPanel.fightSkillPanel.refresh()}},d.prototype.hidePanel=function(){this._fightUiPanel&&UIManager.getInstance().removeUIContainer(this._fightUiPanel)},d.prototype.showPanel=function(){var b=this;this._fightUiPanel||(this._fightUiPanel=new a.FightUiPanel),this._fightUiPanel.load(function(){UIManager.getInstance().addUIContainer(b._fightUiPanel)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_FIGHT_UI_PANEL),new c(c.HIDE_FIGHT_UI_PANEL),new mainUi.MainUiEvent(mainUi.MainUiEvent.RESET_SKILL_ICON),new mainUi.MainUiEvent(mainUi.MainUiEvent.PLAYER_SKILL_CD_REFRESH)]},d}(BaseProcessor);a.FightUiProcessor=d}(fightui||(fightui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),homeui;!function(a){var b=function(){function a(){}return a.prototype.clik=function(){var a=1;(this.tb.id==SharedDef.MODULE_MALL||this.tb.id==SharedDef.MODULE_MOUNT)&&(a=[1]),ModulePageManager.openPanel(this.tb.id,a)},a.prototype.drawIcon=function(a){this.frame.getSkinCtxRect;var b=this.frame,c="ui/load/systemicon/"+this.tb.id+".png";IconManager.getInstance().getIcon(c,function(c){var d=b.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);e.drawImage(c,0,0,100,100),b.drawToCtx(a.uiAtlas,e)})},a}();a.SystemUi=b;var c=function(a){function c(){var b=a.call(this)||this;return b.nodeDic={201:6,202:14,203:17,204:20,205:27,206:37,207:50,301:55,302:60,208:80,209:127},b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.right=0,b.bottom=0,b}return __extends(c,a),c.prototype.setRender=function(a,b){this._baseRender=a,this._redPointRender=b,this.loadConfigCom()},c.prototype.loadConfigCom=function(){this.addBaseSysFram(),this.refresh()},c.prototype.addBaseSysFram=function(){this.frameSysItem=new Array;for(var a=tb.TB_system_icon.getItem(),c=0;c<a.length;c++){var d=a[c];if(d.position>=4&&d.position<=7){var e=new b;e.tb=d,e.frame=this.addEvntButUp("a_sys_fram",this._baseRender),e.frame.addEventListener(InteractiveEvent.Down,function(a){},this),e.frame.goToAndStop(this.frameSysItem.length),this.nodeDic[d.id]&&(e.redPoint=this._redPointRender.getRedPointUI(this,this.nodeDic[d.id],new Vector2D(0,0))),this.frameSysItem.push(e)}}},c.prototype.refresh=function(){for(var a=0;a<this.frameSysItem.length;a++){var b=this.frameSysItem[a],c=this.getSysIconVisible(b.tb);if(c){this.addChild(b.frame);var d=mainUi.MainUiModel.getPandaPostionBySysId(b.tb.id);b.frame.x=d.x,b.frame.y=d.y,b.drawIcon(this._baseRender),b.redPoint&&b.redPoint.setPos(d.x+b.frame.width-17,d.y),console.log(d)}else this.removeChild(b.frame)}},c.prototype.getSysIconVisible=function(a){var b=GuidData.player.isOpenSystemNeedShow(a.id);return b},c.prototype.butClik=function(a){switch(a.target){default:for(var b=0;b<this.frameSysItem.length;b++)if(this.frameSysItem[b].frame==a.target){UIManager.popClikNameFun("sys"+this.frameSysItem[b].tb.id),UiTweenScale.getInstance().changeButSize(a.target),this.frameSysItem[b].clik();break}}},c}(UIVirtualContainer);a.HomeSysPanel=c}(homeui||(homeui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),homeui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.interfaceUI=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._baseRender.uiAtlas.setInfo("ui/uidata/mainui/home/home.xml","ui/uidata/mainui/home/home.png",function(){
a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this.homeSysPanel=new a.HomeSysPanel,this.homeSysPanel.setRender(this._baseRender,this._redPointRender),this.addVirtualContainer(this.homeSysPanel),this.uiAtlasComplet=!0,this.applyLoadComplete()},c}(UIPanel);a.HomeUiPanel=b}(homeui||(homeui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),homeui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"HomeUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.HomeUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_HOME_UI_PANEL="SHOW_HOME_UI_PANEL",b.HIDE_HOME_UI_PANEL="HIDE_HOME_UI_PANEL",b.REFRESH_HOME_UI_PANEL="REFRESH_HOME_UI_PANEL",b}(BaseEvent);a.HomeUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"HomeUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_HOME_UI_PANEL&&GuidData.map.showAreaById(AreaType.rightChange_6)&&this.showPanel(),b.type==c.HIDE_HOME_UI_PANEL&&this.hidePanel(),b.type==c.REFRESH_HOME_UI_PANEL&&this._homeUiPanel&&this._homeUiPanel.homeSysPanel.refresh()}},d.prototype.hidePanel=function(){this._homeUiPanel&&UIManager.getInstance().removeUIContainer(this._homeUiPanel)},d.prototype.showPanel=function(){var b=this;this._homeUiPanel||(this._homeUiPanel=new a.HomeUiPanel),this._homeUiPanel.load(function(){UIManager.getInstance().addUIContainer(b._homeUiPanel)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_HOME_UI_PANEL),new c(c.HIDE_HOME_UI_PANEL),new c(c.REFRESH_HOME_UI_PANEL)]},d}(BaseProcessor);a.HomeUiProcessor=d}(homeui||(homeui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),topui;!function(a){var b=function(){function a(){this.endTM=0,this.len=20}return a.prototype.update=function(a){var b=this.endTM-TimeUtil.getTimer();if(b>0){var c=1-b/1e3/this.len;this.cd.setCdNum(Math.min(c,1))}},a}();a.BuffCdUi=b;var c=function(){function a(a,b,c){var d=this;this._showListArr=[148,151,152],this.perent=a,this.render=b,this.cdRender=c,TimeUtil.addFrameTick(function(a){d.update(a)})}return a.prototype.update=function(a){for(var b=0;this.buffuiItem&&b<this.buffuiItem.length;b++)this.buffuiItem[b].update(a)},a.prototype.refresh=function(){this.clear();var c=GameInstance.mainChar.unit.buffUnit;for(var d in c.item){console.log(d,c.item[d]);var e=Number(d);if(this.needShowById(e)){var f=c.item[e]-TimeUtil.getTimer();a.cdKeyLen[e]?a.cdKeyLen[e]<f&&(a.cdKeyLen[e]=f):a.cdKeyLen[e]=f;var g=new b;g.len=a.cdKeyLen[e]/1e3,g.ui=this.perent.addChild(this.render.getComponent("a_buff_cd")),g.ui.goToAndStop(this.buffuiItem.length),g.cd=this.perent.addChild(this.cdRender.getComponent("a_buff_mask")),g.ui.x=g.ui.x+28*this.buffuiItem.length,g.cd.x=g.ui.x,g.cd.y=g.ui.y,g.cd.width=g.ui.width,g.cd.height=g.ui.height,this.ctxIconPic(g.ui,e),g.endTM=c.item[e],this.buffuiItem.push(g)}}},a.prototype.ctxIconPic=function(a,b){var c=this;LoadManager.getInstance().load(Scene_data.fileRoot+"ui/load/buff/"+b+".png",LoadManager.IMG_TYPE,function(b){var d=a.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);e.drawImage(b,0,0,b.width,b.height),a.drawToCtx(c.render.uiAtlas,e)})},a.prototype.needShowById=function(a){for(var b=0;b<this._showListArr.length;b++)if(this._showListArr[b]==a)return!0;return!1},a.prototype.clear=function(){if(this.buffuiItem)for(;this.buffuiItem.length;){var a=this.buffuiItem.pop();this.perent.removeChild(a.ui),this.perent.removeChild(a.cd)}else this.buffuiItem=new Array},a.cdKeyLen=new Object,a}();a.TopBuffUiList=c;var d=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.left=0,b}return __extends(b,a),b.prototype.setRender=function(a,b){this._topRender=a,this._cdRender=b,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.topBuffUiList=new c(this,this._topRender,this._cdRender)},b.prototype.refresh=function(){this.topBuffUiList.refresh()},b}(UIVirtualContainer);a.TopUiBuffPanel=d}(topui||(topui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),topui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.lastVisble=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.left=0,b}return __extends(b,a),b.prototype.setRender=function(a,b,c,d){this._bottomRender=a,this._midRender=b,this._centerRender=d,this._topRender=c,this.loadConfigCom()},b.prototype.loadConfigCom=function(){var a=this;this.addUIList(["t_tar_bg"],this._bottomRender),this.bloodUI=this.addChild(this._midRender.getComponent("t_tar_blood")),this.iconUI=this.addChild(this._midRender.getComponent("t_tar_icon")),this.addUIList(["t_tar_mask"],this._centerRender),this.nameUI=this.addChild(this._topRender.getComponent("t_name")),this.bloodTxt=this.addChild(this._topRender.getComponent("t_blood_txt")),this.levUI=this.addChild(this._topRender.getComponent("t_level")),TimeUtil.addFrameTick(function(b){a.upDataFun(b)})},b.prototype.upDataFun=function(a){var b=!0;GameInstance.attackTarget&&GuidData.map?(GameInstance.attackTarget.isBoss&&(b=!1),(GuidData.map.is1V1()||GuidData.map.is3V3()||3018==GuidData.map.getMapID())&&(b=!1)):b=!1,b?(this.setVisible(!0),this.drawAttackName(),this.drawBloodNum(),this.drawIcon()):this.setVisible(!1)},b.prototype.drawBloodNum=function(){var a=GameInstance.attackTarget.unit.getHp()/GameInstance.attackTarget.unit.getMaxHp();if(this.lastBloodnum!==a){this.lastBloodnum=a,this.bloodUI.uvScale=-1*a;var b=Math.ceil(Math.abs(100*a))+"/100";LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.bloodTxt.skinName,b,21,TextAlign.CENTER,ColorType.Whitefff7db)}},b.prototype.setVisible=function(a){this.lastVisble!=a&&(a?this.left=0:this.left=-1e3,this.lastVisble=a)},b.prototype.drawIcon=function(){var a=this,b=GameInstance.attackTarget.unit.getEntry();b=0==b?GameInstance.attackTarget.unit.getCharType()%2:tb.TB_creature_template.get_TB_creature_template(b).avatar,this.lastIconId!=b&&(this.lastIconId=b,IconManager.getInstance().getIcon(getRoleIconUrl(String(this.lastIconId)),function(b){var c=a._midRender.uiAtlas.getRec(a.iconUI.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(b,0,0,c.pixelWitdh,c.pixelHeight),TextureManager.getInstance().updateTexture(a._midRender.uiAtlas.texture,c.pixelX,c.pixelY,d)}))},b.prototype.drawAttackName=function(){var a=getBaseName(GameInstance.attackTarget.unit.getName());if(this.lastName!=a){LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.nameUI.skinName,ColorType.Whitefff7db+a+" ",24,TextAlign.RIGHT,ColorType.Whitefff7db),this.lastName=a;var b=String(GameInstance.attackTarget.unit.getLevel());LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.levUI.skinName,ColorType.Whitefff7db+b,24,TextAlign.CENTER,ColorType.Whitefff7db)}},b}(UIVirtualContainer);a.TopTargetHeadPanel=b;var c=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.left=0,b}return __extends(b,a),b.prototype.setRender=function(a,b,c,d,e){this._bottomRender=a,this._midRender=b,this._topRender=c,this._effRender=d,this._redRender=e,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.a_head_bg=this.addChild(this._bottomRender.getComponent("a_head_bg"));var a=this.addChild(this._bottomRender.getComponent("a_vip_bg"));a.addEventListener(InteractiveEvent.Down,this.vipclick,this),this.a_blood_bar=this.addChild(this._midRender.getComponent("a_blood_bar")),this.a_head_pic=this.addEvntBut("a_head_pic",this._midRender),this.a_head_pic.addEventListener(InteractiveEvent.Up,this.butClik,this),this.a_pk_model=this.addEvntButUp("a_pk_model",this._midRender),this.addChild(this._topRender.getComponent("a_head_mask")),this.addChild(this._topRender.getComponent("a_levbg")),this.a_vip_num=this.addChild(this._topRender.getComponent("a_vip_num")),this.a_name=this.addChild(this._topRender.getComponent("a_name")),this.a_level=this.addChild(this._topRender.getComponent("a_level")),this.a_blood_txt=this.addChild(this._topRender.getComponent("a_blood_txt")),this.a_froce=this.addChild(this._topRender.getComponent("a_froce")),this.mailUI=this.addChild(this._topRender.getComponent("t_mail")),this.mailUI.addEventListener(InteractiveEvent.Down,this.mailClick,this);this._redRender.getRedPointUI(this,3,new Vector2D(this.mailUI.x+this.mailUI.width,this.mailUI.y));this.buildeff(),this.loadRolePic()},b.prototype.buildeff=function(){var a=this;this._effRender.setImg(getEffectUIUrl("ef_zhanli_01"),8,4,function(b){a._effUI=b,a._effUI.x=a.a_head_bg.x+83,a._effUI.y=a.a_head_bg.y+23,a._effUI.speed=1,a._effUI.play(),a.addChild(a._effUI)})},b.prototype.vipclick=function(a){ModulePageManager.openPanel(SharedDef.MODULE_VIP)},b.prototype.mailClick=function(a){ModulePageManager.openPanel(SharedDef.MODULE_MAIL)},b.prototype.loadRolePic=function(){var a=GuidData.player.getCharType(),b=getTouPic(a);this._bottomRender.uiAtlas.upDataPicToTexture(b,this.a_head_pic.skinName)},b.prototype.refreshBloodBar=function(){var a=GameInstance.mainChar.unit;this.a_blood_bar.uvScale=a.getCurHpView()/a.getMaxHpView();var b=String(a.getCurHpView())+"/"+String(a.getMaxHpView());LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_blood_txt.skinName,b,21,TextAlign.CENTER,ColorType.Whitefff7db)},b.prototype.refresh=function(){GuidData.map.showAreaById(AreaType.topleft_1)?this.left=0:this.left=-1e3;var a=String(GuidData.player.getLevel());LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_level.skinName,ColorType.Whitefff7db+a,24,TextAlign.CENTER,ColorType.Whitefff7db);var b=getBaseName(GuidData.player.getName());LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_name.skinName,ColorType.Whitefff7db+b+" ",24,TextAlign.CENTER,ColorType.Whitefff7db),ArtFont.getInstance().writeFontToSkinName(this._bottomRender.uiAtlas,this.a_vip_num.skinName,String(GuidData.player.getVipLevel()),ArtFont.numVip,TextAlign.LEFT),ArtFont.getInstance().writeFontToSkinName(this._bottomRender.uiAtlas,this.a_froce.skinName,String(Math.floor(GuidData.player.getForce())),ArtFont.numVip,TextAlign.LEFT);var c=GuidData.player.getUnitFieldNotoriety();0==c&&this.a_pk_model.goToAndStop(0),1==c&&this.a_pk_model.goToAndStop(1),this.refreshBloodBar()},b.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.a_head_pic:GameStart.GM&&a.type==InteractiveEvent.Up&&ModuleEventManager.dispatchEvent(new Camand.ComandEvent(Camand.ComandEvent.SHOW_COMMAND_EVENT));break;case this.a_pk_model:1==GuidData.map.tbMapVo.allowChangeMode?0==this.a_pk_model.current?AlertUtil.show("切换为pk模式将攻击家族以外的所有玩家，是否确认？","提示",function(a){1==a&&NetManager.getInstance().protocolos.change_battle_mode(SharedDef.FAMILY_MODE)}):NetManager.getInstance().protocolos.change_battle_mode(SharedDef.PEACE_MODE):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"此场景无法切换模式",99)}},b}(UIVirtualContainer);a.TopHeadPanel=c}(topui||(topui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),topui;!function(a){var b=function(){function a(){}return a}();a.TopIconVo=b;var c=function(){function a(){this.nodeDic={504:74,601:112,111:116,501:120,113:123},this.visible=!0}return a.prototype.initUI=function(a,b,c,d,e){this._container=a,this._bottomRender=b,this._midRender=c,this._topRender=d,this._redPointRender=e,this._itemUi=new Array,this.aryUI=new Array,this.b_bg=this._midRender.getComponent("b_bg"),this.b_text=this._topRender.getComponent("b_text"),this.b_arrow=this._topRender.getComponent("b_arrow"),this.aryUI.push(this.b_bg),this.aryUI.push(this.b_text),this.aryUI.push(this.b_arrow)},a.prototype.refresh=function(){if(this.clear(),this.visible){this.showData=mainUi.MainUiModel.getSysList();for(var a=0;a<this.showData.length;a++){var c=this.showData[a];if(1==c.position||2==c.position){var d=new b;d.ui=this._container.addChild(this._bottomRender.getComponent("t_panda_frame")),d.ui.data=c,d.ui.goToAndStop(this._itemUi.length),d.ui.addEventListener(InteractiveEvent.Up,this.butClik,this),d.ui.addEventListener(InteractiveEvent.Down,function(a){},this);var e=mainUi.MainUiModel.getPandaPostionBySysId(c.id);d.ui.x=e.x,d.ui.y=e.y,this.nodeDic[c.id]&&(d.red=this._redPointRender.getRedPointUI(this._container,this.nodeDic[c.id],new Vector2D(0,0)),d.red.setPos(e.x+d.ui.width-17,e.y)),this.ctxIconPic(d.ui,c),this._itemUi.push(d)}}}},a.prototype.showTips=function(a){if(this._container.setUiListVisibleByItem(this.aryUI,!1),this.visible&&a){var b=this.getUiById(SharedDef.MODULE_BOSS);if(b){this._container.setUiListVisibleByItem(this.aryUI,!0);var c=LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.b_text.skinName,a,16,TextAlign.LEFT);this.b_arrow.x=b.ui.x+20,this.b_arrow.y=b.ui.y+b.ui.height-5,this.b_bg.x=this.b_arrow.x-(c-69),this.b_bg.y=this.b_arrow.y+12,this.b_bg.width=c+20,this.b_text.x=this.b_bg.x+12,this.b_text.y=this.b_bg.y+11}}},a.prototype.getIconByID=function(a){return"ui/load/systemicon/"+a+".png"},a.prototype.ctxIconPic=function(a,b){var c=this;a.name="panda"+b.id,LoadManager.getInstance().load(Scene_data.fileRoot+this.getIconByID(b.id),LoadManager.IMG_TYPE,function(b){var d=a.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);e.drawImage(b,0,0,b.width,b.height,0,0,d.width,d.height),a.drawToCtx(c._bottomRender.uiAtlas,e)})},a.prototype.butClik=function(a){if(a.target.data instanceof tb.TB_system_icon){var b=a.target.data;if(UiTweenScale.getInstance().changeButSize(a.target),console.log(b),b.id==SharedDef.MODULE_FISH){var c=this.getUiById(SharedDef.MODULE_FISH);if(c){var d=new chgfish.ChgfishEvent(chgfish.ChgfishEvent.SHOW_Chgfish_EVENT);d.data=c.ui,ModuleEventManager.dispatchEvent(d)}}else ModulePageManager.openPanel(b.id)}},a.prototype.getUiById=function(a){for(var b=0;b<this._itemUi.length;b++){var c=this._itemUi[b].ui.data;if(c.id==a)return this._itemUi[b]}return null},a.prototype.clear=function(){for(;this._itemUi.length;){var a=this._itemUi.pop();this._container.removeChild(a.ui),a.red&&(a.red.node&&a.red.node.unBind(),this._container.removeChild(a.red))}},a}();a.ActivityManager=c;var d=function(a){function b(){var b=a.call(this)||this;return b.canAotuOpen=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.right=0,b}return __extends(b,a),b.prototype.setRender=function(a,b,d,e){this._bottomRender=a,this._midRender=b,this._topRender=d,this._redPointRender=e,this._activityManager=new c,this._activityManager.initUI(this,this._bottomRender,this._midRender,this._topRender,this._redPointRender),this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.t_show_but=this.addEvntButUp("t_show_but",this._topRender),this.t_show_but.addEventListener(InteractiveEvent.Down,function(a){},this),GameInstance.pandaVisibel=!0},b.prototype.changePandaVisible=function(a){0==a?(this.canAotuOpen=!0,GameInstance.pandaVisibel=!1):(this.canAotuOpen&&(GameInstance.pandaVisibel=!0),this.canAotuOpen=!1),this.refresh()},b.prototype.refresh=function(){this._activityManager.visible=GameInstance.pandaVisibel,this.t_show_but.isV=GameInstance.pandaVisibel,this._activityManager.refresh(),this._activityManager.showTips(this._tipsVo),this._topRender.applyObjData(),GuidData.map.showAreaById(AreaType.toprightPanda_3)?this.right=0:this.right=1e3},b.prototype.setTipsData=function(a){this._tipsVo=a,this.refresh()},b.prototype.butClik=function(a){switch(a.target){case this.t_show_but:GameInstance.pandaVisibel=!GameInstance.pandaVisibel,this.refresh()}},b}(UIVirtualContainer);a.TopPandaPanel=d}(topui||(topui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),topui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.interfaceUI=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._centerRender=new UIRenderComponent,a.addRender(a._centerRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._cdRender=new CdRenderComponent,a.addRender(a._cdRender),a._effRender=new FrameUIRender,a.addRender(a._effRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/mainui/top/top.xml","ui/uidata/mainui/top/top.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this._cdRender.uiAtlas=this._midRender.uiAtlas,this._centerRender.uiAtlas=this._midRender.uiAtlas,this.topPandaPanel=new a.TopPandaPanel,this.topPandaPanel.setRender(this._bottomRender,this._midRender,this._topRender,this._redPointRender),this.addVirtualContainer(this.topPandaPanel),this.topHeadPanel=new a.TopHeadPanel,this.topHeadPanel.setRender(this._bottomRender,this._midRender,this._topRender,this._effRender,this._redPointRender),this.addVirtualContainer(this.topHeadPanel),this.topTargetHeadPanel=new a.TopTargetHeadPanel,this.topTargetHeadPanel.setRender(this._bottomRender,this._midRender,this._topRender,this._centerRender),this.addVirtualContainer(this.topTargetHeadPanel),this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.refresh=function(){this.uiAtlasComplet&&(this.topPandaPanel.refresh(),this.topHeadPanel.refresh())},c}(UIPanel);a.TopUiPanel=b}(topui||(topui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),topui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"TopUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.TopUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_TOP_UI_PANEL="SHOW_TOP_UI_PANEL",b.HIDE_TOP_UI_PANEL="HIDE_TOP_UI_PANEL",b.REFRESH_TOP_LEFT_BUFF="REFRESH_TOP_LEFT_BUFF",b.REFRESH_TOP_LEFT_BLOOD="REFRESH_TOP_LEFT_BLOOD",b.REFRESH_TOP_PANDA="REFRESH_TOP_PANDA",b.REFRESH_TOP_PANDA_TIP="REFRESH_TOP_PANDA_TIP",b.UNIT_FIELD_NOTORIETY="UNIT_FIELD_NOTORIETY",b.SHOW_TOP_PANDA_LIST="SHOW_TOP_PANDA_LIST",b}(BaseEvent);a.TopUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"TopUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_TOP_UI_PANEL&&this.showPanel(),b.type==c.UNIT_FIELD_NOTORIETY&&(console.log("战斗模式换了"),RelationManager.getInstance().refresh(),this.topUiPanel&&GuidData.map&&this.topUiPanel.topHeadPanel.refresh()),this.topUiPanel&&(b.type==c.REFRESH_TOP_PANDA&&this.topUiPanel.topPandaPanel&&this.topUiPanel.topPandaPanel.refresh(),b.type==c.HIDE_TOP_UI_PANEL&&this.hidePanel(),b.type==c.SHOW_TOP_PANDA_LIST&&this.topUiPanel.topPandaPanel&&this.topUiPanel.topPandaPanel.changePandaVisible(b.data),b.type==c.REFRESH_TOP_LEFT_BLOOD&&this.topUiPanel.topHeadPanel&&this.topUiPanel.topHeadPanel.refreshBloodBar(),b.type==c.REFRESH_TOP_PANDA_TIP&&this.toppandarefesh(b.data))}if(a instanceof EngineEvent){var d=a;(d.type==EngineEvent.PLAYER_FIELD_LEVEL||d.type==EngineEvent.PLAYER_FIELD_VIP_LEVEL||d.type==EngineEvent.PLAYER_FIELD_FORCE)&&this.topUiPanel&&this.topUiPanel.topHeadPanel&&this.topUiPanel.topHeadPanel.refresh()}},d.prototype.toppandarefesh=function(a){this.topUiPanel.topPandaPanel&&this.topUiPanel.topPandaPanel.setTipsData(a)},d.prototype.hidePanel=function(){this.topUiPanel&&UIManager.getInstance().removeUIContainer(this.topUiPanel)},d.prototype.showPanel=function(){var b=this;this.topUiPanel||(this.topUiPanel=new a.TopUiPanel),this.topUiPanel.load(function(){UIManager.getInstance().addUIContainer(b.topUiPanel),b.topUiPanel.refresh()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_TOP_UI_PANEL),new c(c.HIDE_TOP_UI_PANEL),new c(c.REFRESH_TOP_LEFT_BUFF),new c(c.REFRESH_TOP_LEFT_BLOOD),new c(c.REFRESH_TOP_PANDA),new c(c.SHOW_TOP_PANDA_LIST),new c(c.REFRESH_TOP_PANDA_TIP),new c(c.UNIT_FIELD_NOTORIETY),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new EngineEvent(EngineEvent.PLAYER_FIELD_VIP_LEVEL),new EngineEvent(EngineEvent.PLAYER_FIELD_FORCE)]},d}(BaseProcessor);a.TopUiProcessor=d}(topui||(topui={}));var bottomui;!function(a){var b=function(){function a(b,c,d){var e=this;this.perent=b,this.uiAtlas=c.uiAtlas,this.c_progress_bg=c.getComponent("c_progress_bg"),this.c_progress_bar=d.getComponent("c_progress_bar"),this.c_progress_bar.uvScale=0,this.c_progress_label=c.getComponent("c_progress_label"),this.c_progress_num=c.getComponent("c_progress_num"),this.c_progress_fen=c.getComponent("c_progress_fen"),this.uilistArr=new Array,this.uilistArr.push(this.c_progress_bg),this.uilistArr.push(this.c_progress_bar),this.uilistArr.push(this.c_progress_label),this.uilistArr.push(this.c_progress_num),this.uilistArr.push(this.c_progress_fen),a._instance=this,this.updataFun=function(a){e.updata(a)}}return a.prototype.show=function(a,b,c){void 0===c&&(c=3),this.c_progress_bar.parent||(this.c_progress_bar.uvScale=0,this.showType=c,this.c_progress_label.goToAndStop(this.showType),this.perent.setUiListVisibleByItem(this.uilistArr,!0),this.statTime=TimeUtil.getTimer(),this.cdEndTime=this.statTime+a,this.backFun=b,TimeUtil.addFrameTick(this.updataFun))},a.prototype.updata=function(a){var b=this.cdEndTime-TimeUtil.getTimer();0>b?(this.backFun&&this.backFun(),this.hide()):(b/=this.cdEndTime-this.statTime,b=1-b,this.c_progress_bar.uvScale=b,0==this.showType?this.uiAtlas.clearCtxTextureBySkilname(this.c_progress_num.skinName):ArtFont.getInstance().writeFontToSkinName(this.uiAtlas,this.c_progress_num.skinName,String(Math.floor(100*b)),ArtFont.num64,TextAlign.RIGHT))},a.prototype.hide=function(){this.c_progress_bar.parent&&(this.perent.setUiListVisibleByItem(this.uilistArr,!1),TimeUtil.removeFrameTick(this.updataFun))},a.getInstance=function(){return this._instance},a}();a.Progress_line=b}(bottomui||(bottomui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bottomui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.left=0,b.bottom=0,b}return __extends(b,a),b.prototype.setRender=function(a,b,c){this._bottomRender=a,this._midRender=b,this._topRender=c,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.b_yaogan_bg=this.addChild(this._bottomRender.getComponent("b_yaogan_bg")),this.b_yaogan_bar=this.addChild(this._midRender.getComponent("b_yaogan_bar")),this.b_qichen=this.addEvntBut("b_qichen",this._bottomRender),GameMouseManager.getInstance().setBtn(this.b_yaogan_bar,this.b_yaogan_bg)},b.prototype.butClik=function(a){switch(a.target){case this.b_qichen:if(0==GuidData.grow.getMountLevel())return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"坐骑未激活",99);AotuSkillManager.getInstance().aotuBattle=!1,NetManager.getInstance().protocolos.ride_mount(),UiTweenScale.getInstance().changeButSize(a.target),UIManager.popClikNameFun("f_qichen")}},b.prototype.refresh=function(){this.setUiListVisibleByItem([this.b_qichen],GuidData.grow.getMountLevel()>0)},b}(UIVirtualContainer);a.BottomUiLeftPanel=b}(bottomui||(bottomui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bottomui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.bottom=0,b.center=0,b}return __extends(b,a),b.prototype.setRender=function(a,b,c){this._bottomRender=a,this._midRender=b,this._topRender=c,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.a_chat_bg=this.addEvntButUp("a_chat_bg",this._bottomRender),this.a_chat_bg.addEventListener(InteractiveEvent.Down,function(a){},this),this.a_chat_msg=this.addChild(this._bottomRender.getComponent("a_chat_msg"))},b.prototype.setShowChatGrid=function(a){this.setUiListVisibleByItem([this.a_chat_bg,this.a_chat_msg],a)},b.prototype.restChatList=function(){var a=22,b=this._midRender.uiAtlas.getRec(this.a_chat_msg.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);c.font="bolder  "+a+"px "+UIData.font;for(var d=Chat.ChatModel.getInstance().getLastThreeChatVo(),e=0,f=420,g=0;g<d.length;g++){var h="[世界]"+getBaseName(d[g].s2c_send_chat.name)+":"+d[g].contentTxt,i=FaceFontLabel.getTextHeight(c,h,a,f);console.log("宽度",TextRegExp.getTextMetrics(c,h)),console.log("高度",i),e+=i,console.log("$totalH",i)}for(var j=Math.min(3-e,0),g=0;g<d.length;g++){var k="",l="#ff0000";switch(d[g].s2c_send_chat.channel){case SharedDef.CHAT_TYPE_WORLD:l="#ffc13a",k="[世界]";break;case SharedDef.CHAT_TYPE_FACTION:l="#00b1f1",k="[家族]";break;case SharedDef.CHAT_TYPE_CURRENT:l="#58e3ff",k="[附近]"}var h=k+getBaseName(d[g].s2c_send_chat.name)+":"+d[g].contentTxt;j+=FaceFontLabel.writeMultiFaceLineToCtx(c,h,22,0,32*j,f,10,l)}this._midRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.butClik=function(a){switch(a.target){case this.a_chat_bg:ModulePageManager.openPanel(SharedDef.MODULE_CHAT)}},b}(UIVirtualContainer);a.BottomUiChatPanel=b}(bottomui||(bottomui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bottomui;!function(a){var b=function(){function a(){}return a}();a.HornTxtVo=b;var c=function(){function a(a,b,c){this.lastTimePositon=0,this.totalTime=1e4,this.moveSpeed=0,this.ui=a,this.bg=b,this.uiAtlas=c,this.hornWaitItem=new Array,this.lastTimePositon=TimeUtil.getTimer()-this.totalTime}return a.prototype.pushWaithornToItem=function(a){var c=TimeUtil.getTimer()+this.totalTime;if(this.hornWaitItem.length){var d=this.hornWaitItem[this.hornWaitItem.length-1];c=Math.max(c,d.time+d.timeLen)}var e=new b;e.time=c,e.data=a;var f=FaceFontLabel.getFaceTxtStrLen(e.data.content);e.timeLen=350*f+1e3,this.hornWaitItem.push(e),this.drawHornSkin()},a.prototype.updata=function(a){if(this.hornWaitItem.length){var b=TimeUtil.getTimer()-this.lastTimePositon;b/=this.totalTime,b>1&&(this.lastTimePositon=TimeUtil.getTimer(),this.drawHornSkin(),b=0),this.moveSpeed=.5*b,this.ui.renderData2[0]=.5,this.ui.renderData2[2]=this.moveSpeed,this.ui.uiRender.makeRenderDataVc(this.ui.vcId),this.bg.x=214}else this.bg.x=1e4},a.prototype.drawHornSkin=function(){var a=16,b=this.uiAtlas.getRec(this.ui.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);c.font="bolder  "+a+"px "+UIData.font;for(var d=0,e=this.hornWaitItem.length-1;e>=0;e--){var f=this.hornWaitItem[e],g=f.time+f.timeLen>this.lastTimePositon,h=f.time<this.lastTimePositon+2*this.totalTime;if(g&&h){var i=(f.time-this.lastTimePositon)*(512/this.totalTime);TextRegExp.wrapText(c,f.data.content,ColorType.Whitefff4d6,Math.floor(i),0,1e4,a,a,"#27262e",4,1.2),d++}else g||this.hornWaitItem.splice(e,1)}this.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},a}();a.SysInfoPanel=c;var d=function(){function a(){}return a}();a.InfoTipIconVo=d;var e=function(){function a(a,b,c){this.showData=[1,2,3,4,5,6],this.visible=!0,this._container=a,this._bottomRender=b,this._midRender=c,this._itemUi=new Array,this.refresh()}return a.prototype.refresh=function(){if(this.clear(),this.showData=mainUi.MainUiModel.getMsgTipData(),this.visible)for(var a=55,b=0;b<this.showData.length;b++){var c=this.showData[b],e=new d;e.ui=this._container.addChild(this._midRender.getComponent("a_info_icon")),e.ui.data=c,e.ui.goToAndStop(b),e.ui.addEventListener(InteractiveEvent.Up,this.butClik,this),e.ui.addEventListener(InteractiveEvent.Down,function(a){},this);var f=new Vector2D;f.x=480+b*a-this.showData.length/2*a,f.y=417,e.ui.x=f.x,e.ui.y=f.y,this.ctxIconPic(e.ui,c),this._itemUi.push(e)}},a.prototype.ctxIconPic=function(a,b){var c=this;LoadManager.getInstance().load(Scene_data.fileRoot+"ui/load/msgicon/"+b+".png",LoadManager.IMG_TYPE,function(b){var d=a.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);e.drawImage(b,0,0,b.width,b.height,0,0,d.width,d.height),a.drawToCtx(c._midRender.uiAtlas,e)})},a.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target.data){case 0:break;case 1:ModuleEventManager.dispatchEvent(new social.SocialUiEvent(social.SocialUiEvent.SHOW_APPLYPANEL_EVENT));break;case 2:GuidData.faction?ModulePageManager.openPanel(SharedDef.MODULE_FACTION):ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.SHOW_INVITATION_EVENT));break;case 3:this.refresh();break;case 4:for(var b=Chat.ChatModel.getInstance().getChatItemByType(SharedDef.CHAT_TYPE_WHISPER),c=b.length-1;c>=0;c--)if(b[c].s2c_send_chat.guid!=GuidData.player.getGuid()){ModulePageManager.openPanel(SharedDef.MODULE_CHATPERSON,b[c].s2c_send_chat.guid);break}break;case 5:ModulePageManager.openPanel(SharedDef.MODULE_MAIL),this.refresh()}},a.prototype.clear=function(){for(;this._itemUi.length;){var a=this._itemUi.pop();this._container.removeChild(a.ui)}},a}();a.InfoTipManager=e;var f=function(b){function d(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.expNum5=5,a.expNum=.7,a.interfaceUI=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.bottom=0,a.center=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),
a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/mainui/bootom/bootom.xml","ui/uidata/mainui/bootom/bootom.png",function(){a.loadConfigCom()})},d.prototype.loadConfigCom=function(){var b=this;this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.progress_line=new a.Progress_line(this,this._bottomRender,this._midRender),this.infoTipManager=new e(this,this._bottomRender,this._topRender),this.bottomChatPanel=new a.BottomUiChatPanel,this.bottomChatPanel.setRender(this._bottomRender,this._midRender,this._topRender),this.addVirtualContainer(this.bottomChatPanel),this.bottomUiLeftPanel=new a.BottomUiLeftPanel,this.bottomUiLeftPanel.setRender(this._bottomRender,this._midRender,this._topRender),this.addVirtualContainer(this.bottomUiLeftPanel),this.bottomAotuScaleText=new a.BottomAotuScaleText,this.bottomAotuScaleText.setRender(this._bottomRender,this._midRender,this._topRender),this.addVirtualContainer(this.bottomAotuScaleText),this.a_sys_info_bg=this.addChild(this._bottomRender.getComponent("a_sys_info_bg")),this.a_sys_info_bg.top=120,this.a_sys_info=this.addChild(this._midRender.getComponent("a_sys_info")),this.a_sys_info.top=125,this.sysTipPanel=new c(this.a_sys_info,this.a_sys_info_bg,this._bottomRender.uiAtlas),this.addexperience_lines(),this.uiAtlasComplet=!0,this.applyLoadComplete(),TimeUtil.addFrameTick(function(a){b.update(a)})},d.prototype.setShowChatGrid=function(a){this.uiAtlasComplet&&this.bottomChatPanel.setShowChatGrid(a)},d.prototype.addexperience_lines=function(){this.d_experience_bg=this.addChild(this._bottomRender.getComponent("d_experience_bg")),this.d_experience_bg.left=0,this.d_experience_bg.bottom=0,this.expUiItem=new Array;for(var a=0;a<this.expNum5;a++)this.expUiItem.push(this.addChild(this._midRender.getComponent("d_experience_line"))),this.expUiItem[a].bottom=0},d.prototype.update=function(a){if(this.uiAtlasComplet){this.sysTipPanel.updata(a),this.bottomAotuScaleText.updata(a);var b=Scene_data.stageWidth/UIData.Scale;this.d_experience_bg.width=b,this.expNum=GuidData.player.getExp()/GuidData.player.getMaxExp();for(var c=0;c<this.expNum5;c++){this.expUiItem[c].width=0,this.expUiItem[c].x=(b/this.expNum5+3)*c-this.x/UIData.Scale;var d=this.expNum-c*(1/this.expNum5),e=(b-3*(this.expNum5-1))/this.expNum5;d>1/this.expNum5?this.expUiItem[c].width=e:this.expUiItem[c].width=Math.max(e*d*this.expNum5,0)}}},d.prototype.pushSysInfoTop=function(a){this.sysTipPanel&&this.sysTipPanel.pushWaithornToItem(a)},d.prototype.refreshInfoTipManager=function(){this.infoTipManager.refresh()},d.prototype.refresh=function(){this.uiAtlasComplet&&(this.infoTipManager.refresh(),this.bottomUiLeftPanel.refresh())},d}(UIPanel);a.BottomUiPanel=f}(bottomui||(bottomui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bottomui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.lastAotuTextVisible=!1,b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.bottom=0,b.center=0,b}return __extends(b,a),b.prototype.setRender=function(a,b,c){this._bottomRender=a,this._midRender=b,this._topRender=c,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.aotuTxtItem=new Array;for(var a=0;5>a;a++)this.aotuTxtItem.push(this._topRender.getComponent("e_aotu_txt_"+a))},b.prototype.updata=function(a){AotuSkillManager.getInstance().aotuBattle?(this.lastAotuTextVisible||(this.lastAotuTextVisible=!0,this.setUiListVisibleByItem(this.aotuTxtItem,this.lastAotuTextVisible)),this.changeUiSize(this.aotuTxtItem)):this.lastAotuTextVisible&&(this.lastAotuTextVisible=!1,this.setUiListVisibleByItem(this.aotuTxtItem,this.lastAotuTextVisible))},b.prototype.changeUiSize=function(a){for(var b=0;b<a.length;b++){var c=(TimeUtil.getTimer()%1e3/1e3,(TimeUtil.getTimer()+100)/200-b),d=a[b],e=.5+(Math.sin(c)+1)/5;d.width=48*e,d.height=48*e;var f=new Vector2D(354+50*b,323);d.x=f.x+(48-d.width)/2,d.y=f.y+(48-d.height)/2}},b}(UIVirtualContainer);a.BottomAotuScaleText=b}(bottomui||(bottomui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bottomui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"BottomUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.BottomUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_BOTTOM_UI_PANEL="SHOW_BOTTOM_UI_PANEL",b.HIDE_BOTTOM_UI_PANEL="HIDE_BOTTOM_UI_PANEL",b.BOTTOM_SYSTIME_HORM_INFO="BOTTOM_SYSTIME_HORM_INFO",b.BOTTOM_REFRESH_INFO_ICON="BOTTOM_REFRESH_INFO_ICON",b}(BaseEvent);a.BottomUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"BottomUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_BOTTOM_UI_PANEL&&(GuidData.map.is1V1()||this.showPanel()),this.bootomUiPanel&&(b.type==c.HIDE_BOTTOM_UI_PANEL&&this.hidePanel(),b.type==c.BOTTOM_SYSTIME_HORM_INFO&&this.bootomUiPanel.pushSysInfoTop(b.data),b.type==c.BOTTOM_REFRESH_INFO_ICON&&this.bootomUiPanel.refreshInfoTipManager())}this.bootomUiPanel&&(a instanceof fightui.FightUiEvent&&this.bootomUiPanel.setShowChatGrid(!0),a instanceof homeui.HomeUiEvent&&this.bootomUiPanel.setShowChatGrid(!1))},d.prototype.hidePanel=function(){this.bootomUiPanel&&UIManager.getInstance().removeUIContainer(this.bootomUiPanel)},d.prototype.showPanel=function(){var b=this;this.bootomUiPanel||(this.bootomUiPanel=new a.BottomUiPanel),this.bootomUiPanel.load(function(){UIManager.getInstance().addUIContainer(b.bootomUiPanel),b.bootomUiPanel.refresh()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_BOTTOM_UI_PANEL),new c(c.HIDE_BOTTOM_UI_PANEL),new c(c.BOTTOM_SYSTIME_HORM_INFO),new c(c.BOTTOM_REFRESH_INFO_ICON),new fightui.FightUiEvent(fightui.FightUiEvent.SHOW_FIGHT_UI_PANEL),new homeui.HomeUiEvent(homeui.HomeUiEvent.SHOW_HOME_UI_PANEL)]},d.prototype.smsgSendChat=function(b){var c=new s2c_send_chat;s2c_send_chat.read(c,b),Chat.ChatModel.getInstance().pushNewMes(c),console.log("==聊天==",c),c.channel==SharedDef.CHAT_TYPE_HORM;var d=new Chat.ChatEvent(Chat.ChatEvent.CHAT_INFO_TO_PANEL);if(ModuleEventManager.dispatchEvent(d),this.bootomUiPanel.bottomChatPanel.restChatList(),c.channel==SharedDef.CHAT_TYPE_WHISPER){ModuleEventManager.dispatchEvent(new a.BottomUiEvent(a.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON));var e=new whisper.WhisperUiEvent(whisper.WhisperUiEvent.RECIVE_NEWS_MSG_EVENT);e.data=[c.guid,c.to_guid],ModuleEventManager.dispatchEvent(e)}},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_SEND_CHAT]=function(b){a.smsgSendChat(b)},b},d}(BaseProcessor);a.BottomUiProcessor=d}(bottomui||(bottomui={}));var leftui;!function(a){var b=function(){function a(a,b,c,d){this.startTM=0,this.moneyTm=0,this.perent=a,this._midRender=b,this._topRender=c,this._topRender1=d,this.initUi()}return a.prototype.initUi=function(){this.uiList=new Array,this.a_bg=this.perent.addChild(this._midRender.getComponent("a_bg")),this.a_bg_top=this.perent.addChild(this._midRender.getComponent("a_bg_top")),this.a_bg_mid=this.perent.addChild(this._midRender.getComponent("a_bg_mid")),this.a_bg_bottom=this.perent.addChild(this._midRender.getComponent("a_bg_bottom")),this.uiList.push(this.a_bg_top),this.uiList.push(this.a_bg_mid),this.uiList.push(this.a_bg_bottom),this.a_map_name=this.perent.addChild(this._topRender.getComponent("a_map_name")),this.a_exp_num=this.perent.addChild(this._topRender.getComponent("a_exp_num")),this.a_money_txt=this.perent.addChild(this._topRender.getComponent("a_money_txt"));var a=this.perent.addChild(this._topRender.getComponent("a_iocn_0")),b=this.perent.addChild(this._topRender.getComponent("a_iocn_1")),c=this.perent.addChild(this._topRender.getComponent("a_iocn_2"));this.uiList.push(a),this.uiList.push(b),this.uiList.push(c),this.a_equ_txt=this.perent.addChild(this._topRender.getComponent("a_equ_txt")),this.a_hasquest=this._topRender1.getComponent("a_hasquest"),this.uiList.push(this.a_bg),this.uiList.push(this.a_map_name),this.uiList.push(this.a_exp_num),this.uiList.push(this.a_money_txt),this.uiList.push(this.a_equ_txt),this.resize()},a.prototype.resize=function(){this.a_bg_top.x=this.a_bg.x,this.a_bg_mid.x=this.a_bg.x,this.a_bg_bottom.x=this.a_bg.x,this.a_bg_top.y=this.a_bg.y,this.a_bg_mid.y=this.a_bg_top.y+this.a_bg_top.height,this.a_bg_mid.height=this.a_bg.height-this.a_bg_top.height-this.a_bg_bottom.height,this.a_bg_bottom.y=this.a_bg.y+this.a_bg.height-this.a_bg_bottom.height},a.prototype.refresh=function(){var a=adventure.AdventureModel.getInstance().getCurTb();LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_map_name.skinName,ColorType.Yellowffd500+a.name,24,TextAlign.LEFT,ColorType.Yellowffd500,ColorType.colord27262e);var b=360*a.expReward[1];LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_exp_num.skinName,"经验  "+b+"/小时 ",24,TextAlign.LEFT,ColorType.Green56da35,ColorType.colord27262e);var c=360*a.goldReward[1];LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_money_txt.skinName,"银币  "+c+"/小时",24,TextAlign.LEFT,ColorType.Green56da35,ColorType.colord27262e);var d=Math.ceil(360*a.suitScore/a.suitScoreChange);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_equ_txt.skinName,"装备  "+d+"件/小时",24,TextAlign.LEFT,ColorType.Green56da35,ColorType.colord27262e);for(var e=0;e<random(10);e++);console.log("--刷新----");var f=quest.QuestModel.getInstance().getMainTaskVo();f&&2==f.tb_quest.flag&&f.finish?this.perent.setUiListVisibleByItem([this.a_hasquest],!0):this.perent.setUiListVisibleByItem([this.a_hasquest],!1)},a.prototype.upTimeFrame=function(){this.refresh()},a.prototype.show=function(){this.perent.setUiListVisibleByItem(this.uiList,!0);var a=quest.QuestModel.getInstance().getMainTaskVo();a&&2==a.tb_quest.flag?this.perent.setUiListVisibleByItem([this.a_hasquest],!0):this.perent.setUiListVisibleByItem([this.a_hasquest],!1)},a.prototype.hide=function(){this.perent.setUiListVisibleByItem(this.uiList,!1),this.perent.setUiListVisibleByItem([this.a_hasquest],!1)},a}();a.LeftHangUpBaseVo=b}(leftui||(leftui={}));var leftui;!function(a){var b=function(){function a(a,b,c){this.perent=a,this._midRender=b,this._topRender=c,this.initUi()}return a.prototype.initUi=function(){this.uiList=new Array,this.b_bg=this.perent.addChild(this._midRender.getComponent("b_bg")),this.uiList.push(this.b_bg),this.a_bg_top=this.perent.addChild(this._midRender.getComponent("a_bg_top")),this.a_bg_mid=this.perent.addChild(this._midRender.getComponent("a_bg_mid")),this.a_bg_bottom=this.perent.addChild(this._midRender.getComponent("a_bg_bottom")),this.uiList.push(this.a_bg_top),this.uiList.push(this.a_bg_mid),this.uiList.push(this.a_bg_bottom),this.b_map_name=this.perent.addChild(this._topRender.getComponent("b_map_name")),this.uiList.push(this.b_map_name),this.b_force_txt=this.perent.addChild(this._topRender.getComponent("b_force_txt")),this.uiList.push(this.b_force_txt),this.b_tip_info=this.perent.addChild(this._topRender.getComponent("b_tip_info")),this.uiList.push(this.b_tip_info),this.resize()},a.prototype.resize=function(){this.a_bg_top.x=this.b_bg.x,this.a_bg_mid.x=this.b_bg.x,this.a_bg_bottom.x=this.b_bg.x,this.a_bg_top.y=this.b_bg.y,this.a_bg_mid.y=this.a_bg_top.y+this.a_bg_top.height,this.a_bg_mid.height=this.b_bg.height-this.a_bg_top.height-this.a_bg_bottom.height,this.a_bg_bottom.y=this.b_bg.y+this.b_bg.height-this.a_bg_bottom.height},a.prototype.refresh=function(){var a=tb.TB_risk_data.get_TB_risk_data(GuidData.map.getTrialInstanceFieldSectionId());console.log("----------------------",a),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.b_map_name.skinName,a.name,14,TextAlign.LEFT,ColorType.Yellowffd500);var b=ColorType.Whiteffffff+"Boss战力:"+ColorType.Green56da35+a.advisepoint;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.b_force_txt.skinName,b,14,TextAlign.LEFT,ColorType.Whiteffffff),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.b_tip_info.skinName,"Boss奖励:",14,TextAlign.LEFT,ColorType.Whiteffffff),this.clearIcon();for(var c=0;3>c;c++){if(c>a.showitems.length-1)return;var d=this.perent.addChild(this._topRender.getComponent("b_reward_frame"));d.goToAndStop(c),d.x+=50*c,this.drawIconReward(d,a.showitems[c]),d.addEventListener(InteractiveEvent.Up,this.itemClick,this),this.iconFrameItem.push(d)}},a.prototype.drawIconReward=function(a,b){var c=this,d=tb.TB_item_template.get_TB_item_template(b);a.data=d,IconManager.getInstance().getIcon(geteqiconIconUrl(d.icon),function(b){var e=a.getSkinCtxRect(),f=UIManager.getInstance().getContext2D(e.width,e.height,!1);UiDraw.cxtDrawImg(f,PuiData.PropBg40,new Rectangle(0,0,48,48),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(d.quality),new Rectangle(0,0,48,48),UIData.publicUi),f.drawImage(b,0,0,60,60,4,4,40,40),a.drawToCtx(c._topRender.uiAtlas,f)})},a.prototype.itemClick=function(a){var b=a.target.data,c=new BagItemData;c.entryData=b;var d=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);d.data=c,d.buttonType=-1,ModuleEventManager.dispatchEvent(d)},a.prototype.clearIcon=function(){if(this.iconFrameItem)for(;this.iconFrameItem.length;)this.perent.removeChild(this.iconFrameItem.pop());else this.iconFrameItem=new Array},a.prototype.show=function(){this.perent.setUiListVisibleByItem(this.uiList,!0),this.refresh()},a.prototype.hide=function(){this.clearIcon(),this.perent.setUiListVisibleByItem(this.uiList,!1)},a}();a.LeftHangUpBossVo=b}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.isBossPanel=!1,a.interfaceUI=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.left=40,a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._topRender1=new UIRenderComponent,a.addRender(a._topRender1),a._topRender.uiAtlas=new UIAtlas,a._tickFun=function(){a.upTimeFrame()},a}return __extends(c,b),c.prototype.upTimeFrame=function(){this.hasStage?this.leftHangUpBaseVo.upTimeFrame():(console.log("移处挂机监听---------------"),TimeUtil.removeTimeTick(this._tickFun))},c.prototype.loadAtlas=function(a){var b=this;this.bFun=a,this._topRender.uiAtlas.setInfo("ui/uidata/mainui/left/lefthangup/lefthangup.xml","ui/uidata/mainui/left/lefthangup/lefthangup.png",function(){b.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._midRender.uiAtlas=this._topRender.uiAtlas,this._topRender1.uiAtlas=this._topRender.uiAtlas,this.leftHangUpBaseVo=new a.LeftHangUpBaseVo(this,this._midRender,this._topRender,this._topRender1),this.leftHangUpBossVo=new a.LeftHangUpBossVo(this,this._midRender,this._topRender),this.bFun&&this.bFun()},c.prototype.butClik=function(a){},c.prototype.refresh=function(){this.leftHangUpBaseVo.refresh(),this.leftHangUpBossVo.refresh()},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),TimeUtil.removeTimeTick(this._tickFun),TimeUtil.addTimeTick(1e3,this._tickFun),this.isBossPanel=GuidData.map.isAdventureBossScene(),this.isBossPanel?(this.leftHangUpBaseVo.hide(),this.leftHangUpBossVo.show()):(this.leftHangUpBaseVo.show(),this.leftHangUpBossVo.hide())},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(UIPanel);a.LeftHangUpPanel=b}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(){function a(a,b,c,d){this.id=0,this._y=0,this.perent=a,this._midRender=b,this._topRender=c,this.id=d,this.rect=new Rectangle(0,0,256,100),this.uiList=new Array,this.makeUi(),this.initBasePos()}return a.prototype.refresh=function(){},a.prototype.makeUi=function(){this.addCellBig()},a.prototype.addCellBig=function(){var a=this._midRender.getComponent("w_bg_top"),b=this._midRender.getComponent("w_bg_mid"),c=this._midRender.getComponent("w_bg_bottom");this.uiList.push(a),this.uiList.push(b),this.uiList.push(c),a.x=2,b.x=2,c.x=2,a.y=0,b.y=a.height,b.height=this.rect.height-a.height-c.height,c.y=this.rect.height-c.height},a.prototype.initBasePos=function(){this.uiBasePos=new Object;for(var a=0;a<this.uiList.length;a++){var b=this.uiList[a];this.uiBasePos[b.name]=new Vector2D(b.x,b.y)}},a.prototype.get_Tb_faction_base=function(){return tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev())},a.prototype.getShenyuLinPai=function(){var a=this.get_Tb_faction_base();return a.token_daily-GuidData.faction.getBossTokenPointscount()},a.prototype.isFullLinPai=function(){var a=this.get_Tb_faction_base();return GuidData.faction.getBossTokenNum()>=a.token_max_keep},Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;for(var b=0;b<this.uiList.length;b++){var c=this.uiList[b];c.y=this.uiBasePos[c.name].y+this._y}},enumerable:!0,configurable:!0}),a.prototype.clik=function(a){for(var b=0;b<this.uiList.length;b++)if(this.uiList[b].testPoint(a.x,a.y))return console.log(this),this.mouseClik(),!0;return!1},a.prototype.mouseClik=function(){},a.prototype.show=function(){this.perent.setUiListVisibleByItem(this.uiList,!0),this.refresh()},a.prototype.hide=function(){this.perent.setUiListVisibleByItem(this.uiList,!1)},a}();a.FamilyLeftUiVo=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.makeUi=function(){this.rect=new Rectangle(0,0,256,90),this.uiList.push(this._midRender.getComponent("c_bg"))},b}(b);a.BoosChallenge=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.makeUi=function(){this.rect=new Rectangle(0,0,256,30),this.uiList.push(this._topRender.getComponent("d_bg")),this.d_attack_name=this._topRender.getComponent("d_attack_name"),this.uiList.push(this.d_attack_name),a.prototype.makeUi.call(this)},b.prototype.refresh=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.d_attack_name.skinName,ColorType.Coffeeff9200+"荥蒙受或",21,TextAlign.LEFT,ColorType.Coffeeff9200,"#27262e",4)},b}(b);a.FamilyPk=d}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.makeUi=function(){this.rect=new Rectangle(0,0,256,70),this.a_bg=this._topRender.getComponent("a_bg"),this.uiList.push(this.a_bg),this.a_xiaoguai_label=this._topRender.getComponent("a_xiaoguai_label"),this.uiList.push(this.a_xiaoguai_label),this.a_jifen_num=this._topRender.getComponent("a_jifen_num"),this.uiList.push(this.a_jifen_num),this.baseNum=1e3,a.prototype.makeUi.call(this)},b.prototype.refresh=function(){if(GuidData.faction){var a=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev()).token_points,b=GuidData.faction.getBosschallengeidCur(),c="当前积分:"+String(GuidData.faction.getBossTokenPoints())+"/"+a,d="";switch(this.modelType=0,0==b?this.isFullLinPai()?this.modelType=1:0==this.getShenyuLinPai()?GuidData.faction.getBossTokenNum()>0?this.modelType=2:this.modelType=3:this.modelType=4:this.modelType=5,this.modelType){case 1:d="当前令牌已满！",c=ColorType.Green56da35+"前往[00ff00]召唤BOSS";break;case 2:d="前往召唤 BOSS[]",c="请明日再来获取令牌";break;case 3:d="今日可获得令牌都于用完",c="请明日再来获取令牌";break;case 4:d="击杀"+ColorType.colorce0a00+"家族小怪[],获得BOSS令牌";break;case 5:d="家族正在挑战BOSS，请前往"}LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_xiaoguai_label.skinName,ColorType.Yellowffe9b4+d,21,TextAlign.LEFT,ColorType.Yellowffe9b4,"#27262e",4),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_jifen_num.skinName,ColorType.Yellowffe9b4+c,21,TextAlign.LEFT,ColorType.Yellowffe9b4,"#27262e",4)}},b.prototype.mouseClik=function(){var a=this;switch(this.modelType){case 4:case 5:var b=AstarUtil.findPath2D(GameInstance.mainChar.getAstarPos(),new Vector2D(132,93));AotuSkillManager.getInstance().aotuWalk=!0,MainCharControlModel.getInstance().setWalkPathFun(b,function(){a.walkPathComplete()});break;case 3:case 2:case 1:ModuleEventManager.dispatchEvent(new faction.FactionBossEvent(faction.FactionBossEvent.SHOW_BOSS_EVENT))}console.log(this.modelType)},b.prototype.walkPathComplete=function(){AotuSkillManager.getInstance().aotuWalk=!1,AotuSkillManager.getInstance().aotuBattle=!0},b}(a.FamilyLeftUiVo);a.FamilyLinPai=b}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.type=0,b.skipNum=0,b}return __extends(b,a),b.prototype.makeUi=function(){this.rect=new Rectangle(0,0,256,70),this.uiList.push(this._topRender.getComponent("b_bg")),this.b_boss_label=this._topRender.getComponent("b_boss_label"),this.uiList.push(this.b_boss_label),this.b_boss_time=this._topRender.getComponent("b_boss_time"),this.uiList.push(this.b_boss_time),a.prototype.makeUi.call(this)},b.prototype.refresh=function(){if(GuidData.faction){var a=GuidData.faction.getBosschallengeidCur(),b="",c="";if(this.type=0,0!=a){b="击杀"+ColorType.colorce0a00+"家族BOSS[]获得奖励";var d=tb.TB_faction_boss.get_TB_faction_bossById(a),e=-GameInstance.getGameSecond(GuidData.faction.getBosschallengeStartTime());e<d.wait_time?(this.type=1,c="BOSS出现倒计时:"+ColorType.colorce0a00+TimeUtil.getLocalTime3(d.wait_time-e)):(this.type=2,c="挑战剩余时间:"+ColorType.colorce0a00+TimeUtil.getLocalTime3(d.time+d.wait_time-e))}else b="剩余家族BOSS令牌： "+GuidData.faction.getBossTokenNum(),GuidData.faction.getBossTokenNum()>0?(this.type=3,c=ColorType.Green56da35+"前往召唤BOSS[]"):(this.type=4,c="击杀"+ColorType.Green56da35+"家族小怪[]收获令牌");(3==this.type||4==this.type)&&0==this.getShenyuLinPai()&&0==GuidData.faction.getBossTokenNum()&&(c="[ff0000]今日令牌已用完"),this.skipNum++%1e3==0&&(console.log("身上现在令牌",GuidData.faction.getBossTokenNum()),console.log("还可以获得令牌",this.getShenyuLinPai()),console.log("可以获得的总数",GuidData.faction.getBossTokenPointscount()),console.log("----------------------")),this.b_boss_label.data!=b&&(this.b_boss_label.data=b,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.b_boss_label.skinName,ColorType.Yellowffe9b4+b,21,TextAlign.LEFT,ColorType.Yellowffe9b4,"#27262e",4)),this.b_boss_time.data!=c&&(this.b_boss_time.data=c,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.b_boss_time.skinName,ColorType.Yellowffe9b4+c,21,TextAlign.LEFT,ColorType.Yellowffe9b4,"#27262e",4))}},b.prototype.mouseClik=function(){var a=this;switch(console.log(this.type),this.type){case 4:var b=AstarUtil.findPath2D(GameInstance.mainChar.getAstarPos(),new Vector2D(132,93));AotuSkillManager.getInstance().aotuWalk=!0,MainCharControlModel.getInstance().setWalkPathFun(b,function(){a.walkPathComplete()});break;case 3:ModuleEventManager.dispatchEvent(new faction.FactionBossEvent(faction.FactionBossEvent.SHOW_BOSS_EVENT));break;case 2:case 1:var b=AstarUtil.findPath2D(GameInstance.mainChar.getAstarPos(),new Vector2D(132,93));MainCharControlModel.getInstance().setWalkPathFun(b)}},b.prototype.walkPathComplete=function(){AotuSkillManager.getInstance().aotuWalk=!1,AotuSkillManager.getInstance().aotuBattle=!0},b}(a.FamilyLeftUiVo);a.FamilyBoss=b}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._lastMouseY=0,a._lastFriendTy=0,a._isMoveBar=!1,a.mouseTy=0,a.interfaceUI=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.left=40,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._topRender.uiAtlas=new UIAtlas,a._tickFun=function(){a.upTimeFrame()},a}return __extends(c,b),c.prototype.upTimeFrame=function(){if(this.hasStage){if(this.left>=0&&GuidData.faction)for(var a=0;a<this.showItemVo.length;a++)this.showItemVo[a].refresh()}else TimeUtil.removeTimeTick(this._tickFun)},c.prototype.loadAtlas=function(a){var b=this;this.bFun=a,this._topRender.uiAtlas.setInfo("ui/uidata/mainui/left/familyleft/familyleft.xml","ui/uidata/mainui/left/familyleft/familyleft.png",function(){b.loadConfigCom()})},c.prototype.loadConfigCom=function(){this.uiVoItem=new Array,this._bottomRender.uiAtlas=this._topRender.uiAtlas,this.mask_mc=this.addEvntBut("mask_mc",this._bottomRender),this.familyLinPai=new a.FamilyLinPai(this,this._bottomRender,this._topRender,0),this.familyBoss=new a.FamilyBoss(this,this._bottomRender,this._topRender,1),this.boosChallenge=new a.BoosChallenge(this,this._bottomRender,this._topRender,2),this.familyPk=new a.FamilyPk(this,this._bottomRender,this._topRender,3),this.uiVoItem.push(this.familyLinPai),this.uiVoItem.push(this.familyBoss),this.uiVoItem.push(this.boosChallenge),this.uiVoItem.push(this.familyPk),this._listMask=new UIMask,this._listMask.x=this.mask_mc.x,this._listMask.y=this.mask_mc.y,this._listMask.width=this.mask_mc.width,this._listMask.height=this.mask_mc.height,this.addMask(this._listMask),this._bottomRender.mask=this._listMask,this._topRender.mask=this._listMask,this.bFun&&this.bFun()},c.prototype.butClik=function(a){switch(a.target){case this.mask_mc:this.taskListMouseDown(a)}},c.prototype.taskListMouseDown=function(a){this._isMoveBar=!1,this._lastMouseY=a.y,this._lastFriendTy=this.mouseTy,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.onStageMouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.onStageMouseUp,this)},c.prototype.onStageMouseMove=function(a){this._isMoveBar=!0,this.mouseTy=this._lastFriendTy+(a.y-this._lastMouseY),this.tureTy()},c.prototype.onStageMouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.onStageMouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.onStageMouseUp,this),this._isMoveBar=!1,this._lastMouseY==a.y&&this.clikUi(a)},c.prototype.clikUi=function(a){for(var b=0;b<this.showItemVo.length;b++)this.showItemVo[b].clik(a)},c.prototype.refresh=function(){this.showItemVo=this.getShowItemVo(),this.maxShowRect=new Rectangle;for(var a=0;a<this.showItemVo.length;a++)this.showItemVo[a].rect.y=this.maxShowRect.height,this.maxShowRect.height+=this.showItemVo[a].rect.height;this.tureTy()},c.prototype.getShowItemVo=function(){for(var a=new Array,b=[0,1],c=0;c<this.uiVoItem.length;c++){for(var d=!1,e=0;e<b.length;e++)b[e]==this.uiVoItem[c].id&&(a.push(this.uiVoItem[c]),d=!0);d?this.uiVoItem[c].show():this.uiVoItem[c].hide()}return a},c.prototype.tureTy=function(){this.mouseTy=Math.min(this.mouseTy,0),this.maxShowRect.height>this._listMask.height?this.mouseTy=Math.max(this.mouseTy,this._listMask.height-this.maxShowRect.height):this.mouseTy=0;for(var a=0;a<this.showItemVo.length;a++)this.showItemVo[a].y=this.showItemVo[a].rect.y+this._listMask.y+this.mouseTy},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),TimeUtil.addTimeTick(1e3,this._tickFun)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(UIPanel);a.LeftFamilyUiPanel=b}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(){function a(a,b){this.totalH=0,this.lastTotalH=0,this.uiheight220=215,this._taskTy=0,this.perent=a,this.uiAtlas=b,this.taskItem=new Array}return a.prototype.refresh=function(){var b=a.taskUiScale15;0==a.showType?this.getItemShow():this.getlilianItem();for(var c=this.uiAtlas.getRec(this.bg.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh*b,840*b,!1),e=0,f=0;f<this.taskItem.length;f++){var g=this.drawTempTask(d,this.taskItem[f],e);e+=(g+12)*b}TextureManager.getInstance().updateTexture(this.uiAtlas.texture,c.pixelX,c.pixelY,d),this.totalH=e+10;var h=this.uiheight220-(this.bg.y-120);this.bg.height=Math.min(h,this.totalH/b),this.lastTotalH!=this.totalH&&(this.lastTotalH>this.totalH&&(this.taskTy=0),this.lastTotalH=this.totalH),this.resize(),this.testFinish(),console.log("===============> this.taskTy this.taskTy",this.taskTy)},a.prototype.getlilianItem=function(){this.taskItem=new Array;for(var a=training.TrainingModel.getInstance().getTaskvo(),b=0;b<a.length;b++)if(a[b].questData){var c=new quest.QuestTaskVo;if(6!=a[b].questData.taskState){c.tb_quest=a[b].tab_quest,c.questDataVo=a[b].questData;var d=a[b].tab_adventure.upres[0],e=a[b].tab_adventure.upres[1];GuidData.player.getResType(d)>=e?ColorType.Green2ca937:ColorType.Redd92200;c.questDataVo.items[0].process=GuidData.player.getResType(d);for(var f=quest.QuestModel.getInstance().getOtherTaskVo(),g=0;g<f.length;g++)quest.QuestModel.TrackDic[f[g].id]&&f[g].tb_quest.ctype==a[b].tab_adventure.type&&2==f[g].tb_quest.ctype&&(this.taskItem.length?this._taskTy=-150:this._taskTy=0,this.taskItem.push(f[g]));this.taskItem.push(c)}}},a.prototype.getItemShow=function(){this.taskItem=new Array;var a=quest.QuestModel.getInstance().getDailyQuestVoTemp();a&&(console.log("---$dailyQuestTaskVo---",a),this.taskItem.push(a));for(var b=quest.QuestModel.getInstance().getOtherTaskVo(),c=0;c<b.length;c++)quest.QuestModel.TrackDic[b[c].id]&&2!=b[c].tb_quest.ctype&&this.taskItem.push(b[c]);this.taskItem.sort(function(a,b){return b.tb_quest.ctype-a.tb_quest.ctype})},a.prototype.testFinish=function(){for(var a=0;a<this.taskItem.length;a++){var b=this.taskItem[a];b.finish&&quest.QuestModel.getInstance().pick_quest_reward(b)}},a.prototype.drawTempTask=function(b,c,d){var e=a.taskUiScale15,f=quest.QuestModel.getInstance().getTaskStrItemByTaskVo(b,c),g=new Rectangle(0,d,200,52);
g.width=200*e,g.height=(20*c.textRectHeight+18)*e,c.clikRect=g,a.drawTaskBgRect(b,g);var h=quest.QuestModel.getIconNameById(c.tb_quest.showpage);UiDraw.cxtDrawImg(b,h,new Rectangle(4*e,d+5*e,24*e,24*e),UIData.publicUi);for(var i=0,j=0;j<f.length;j++){var k=8;0==j&&(k+=21);var l=d+(20*i+10)*e;0==j&&(l-=2*e),i+=c.textrectH[j],TextRegExp.defaultColor="#d8d49c";var m=quest.QuestModel.lineWidth225;if(b.font="bolder  "+14*e+"px "+UIData.font,TextRegExp.wrapText(b,f[j],"#d8d49c",k*e,l,m,20*e,14*e,"#27262e"),0==j&&c.finish){var n=TextRegExp.getTextMetrics(b,f[j]);UiDraw.cxtDrawImg(b,PuiData.A_quest_finish,new Rectangle((k+n.width/e+10)*e,l-5,36*e,21*e),UIData.publicUi)}}return 20*c.textRectHeight},a.drawTaskBgRect=function(b,c){var d=a.taskUiScale15;UiDraw.cxtDrawImg(b,PuiData.A_quest_top,new Rectangle(0,c.y+0,c.width,10*d),UIData.publicUi),UiDraw.cxtDrawImg(b,PuiData.A_quest_mid,new Rectangle(0,c.y+10*d,c.width,c.height-20*d-2*d),UIData.publicUi),UiDraw.cxtDrawImg(b,PuiData.A_quest_bottom,new Rectangle(0,c.y+c.height-10*d-2*d,c.width,10*d),UIData.publicUi)},Object.defineProperty(a.prototype,"taskTy",{get:function(){return this._taskTy},set:function(b){this._taskTy=b;var c=this.bg.height*a.taskUiScale15-this.totalH;this._taskTy=Math.max(c,this._taskTy),this._taskTy=Math.min(this._taskTy,0),this.resize()},enumerable:!0,configurable:!0}),a.prototype.resize=function(){isNaN(this.baseBgrenderY)&&(this.baseBgrenderY=this.bg.renderData2[3]),this.bg.renderData2[3]=this.baseBgrenderY-this._taskTy/2048,this.bg.renderData2[0]=this.bg.width/512*a.taskUiScale15,this.bg.renderData2[1]=this.bg.height/2048*a.taskUiScale15,this.bg.uiRender.makeRenderDataVc(this.bg.vcId)},a.prototype.clikUp=function(b){if(UIManager.getInstance().disMoveNnum(new Vector2D(b.x,b.y),5)){var c=b.y/UIData.Scale-(this.bg.y+this.perent.y/UIData.Scale)-this._taskTy/a.taskUiScale15;c*=a.taskUiScale15;for(var d=0;d<this.taskItem.length;d++)if(c>this.taskItem[d].clikRect.y&&c<this.taskItem[d].clikRect.y+this.taskItem[d].clikRect.height){console.log(this.taskItem[d].tb_quest.questName);var e=(c-this.taskItem[d].clikRect.y)/a.taskUiScale15;quest.QuestModel.getInstance().clikTaskVoCell(this.taskItem[d],Math.floor((e-10)/20));break}}},a.showType=0,a.taskUiScale15=1.5,a}();a.TaskListUi=b;var c=function(){function a(a,b){this.nextTy=0,this.ui=a,this.uiAtlas=b}return a.prototype.refresh=function(){var a=quest.QuestModel.getInstance().getMainTaskVo();if(a){this.ui.data=a;var b=(this.uiAtlas.getRec(this.ui.skinName),UIManager.getInstance().getContext2D(100,100));quest.QuestModel.getInstance().getTaskStrItemByTaskVo(b,a),this.drawTaskBgToCtx(a),a.finish&&quest.QuestModel.getInstance().pick_quest_reward(a),this.nextTy=this.ui.y+20*a.textRectHeight+13,this.drawRewards(a)}},a.prototype.drawRewards=function(a){var b=this;a.tb_quest.icon.length?LoadManager.getInstance().load(Scene_data.fileRoot+GameData.getIconCopyUrl(a.tb_quest.icon[0]),LoadManager.IMG_TYPE,function(a){var c=b.uiAtlas.getRec(b.rewardUi.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.REWARD_BG1,new Rectangle(0,0,c.pixelWitdh,c.pixelHeight),UIData.publicUi),d.drawImage(a,3,3,c.pixelWitdh-6,c.pixelHeight-6),b.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)}):this.uiAtlas.clearCtxTextureBySkilname(this.rewardUi.skinName)},a.prototype.drawTaskBgToCtx=function(a){var c=b.taskUiScale15,d=a.itemStrList,e=new Rectangle(0,0,200,52);e.width=200*c,e.height=(20*a.textRectHeight+18)*c;var f=this.uiAtlas.getRec(this.ui.skinName),g=UIManager.getInstance().getContext2D(e.width,e.height,!1);b.drawTaskBgRect(g,e),UiDraw.cxtDrawImg(g,PuiData.A_quest_ion0,new Rectangle(4*c,3*c,24*c,24*c),UIData.publicUi);for(var h=0,i=0;i<d.length;i++){var j=8;0==i&&(j+=21),g.font="bolder  "+14*c+"px "+UIData.font;var k=(20*h+8)*c;0==i&&(k-=2*c),h+=a.textrectH[i],TextRegExp.defaultColor="#d8d49c";var l=quest.QuestModel.lineWidth225;if(TextRegExp.wrapText(g,d[i],"#d8d49c",j*c,k,l,20*c,14*c,"#27262e"),0==i&&a.finish){var m=TextRegExp.getTextMetrics(g,d[i]);UiDraw.cxtDrawImg(g,PuiData.A_quest_finish,new Rectangle((j+m.width/c+10)*c,8*c,36*c,21*c),UIData.publicUi)}}TextureManager.getInstance().updateTexture(this.uiAtlas.texture,f.pixelX,f.pixelY,g),this.ui.width=e.width/c,this.ui.height=e.height/c},a}();a.QuestMainCell=c;var d=function(a){function d(){var b=a.call(this)||this;return b._lastMouseY=0,b._lastFriendTy=0,b._isMoveBar=!1,b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.left=0,b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topRender.uiAtlas=new UIAtlas,b._effRender=new FrameUIRender,b.addRender(b._effRender),b}return __extends(d,a),d.prototype.loadAtlas=function(a){var b=this;this.bFun=a,this._topRender.uiAtlas.setInfo("ui/uidata/mainui/left/leftquest/leftquest.xml","ui/uidata/mainui/left/leftquest/leftquest.png",function(){b.loadConfigCom()})},d.prototype.loadConfigCom=function(){var a=this;this.lc_main_cell=this.addEvntButUp("a_main_cell",this._topRender),this.lc_main_cell.addEventListener(InteractiveEvent.Down,this.butClikUCellUp,this),this.questMainCell=new c(this.lc_main_cell,this._topRender.uiAtlas),this.questMainCell.rewardUi=this.addEvntBut("a_reward",this._topRender),this.taskListUi=new b(this,this._topRender.uiAtlas),this.taskListUi.bg=this.addChild(this._topRender.getComponent("a_list_cell")),this.taskListUi.bg.addEventListener(InteractiveEvent.Down,this.a_list_cellMouseEvet,this),this.taskListUi.bg.addEventListener(InteractiveEvent.Up,this.a_list_cellMouseEvet,this),this.bFun&&this.bFun(),this.refresh(),this._effRender.setImg(getEffectUIUrl("ui_rw_01"),4,4,function(b){a._effUI=b,a._effUI.x=a.lc_main_cell.x-18,a._effUI.y=a.lc_main_cell.y-27,a._effUI.speed=5,a._effUI.play(),a.refreshEff()})},d.prototype.refreshEff=function(){if(this._effUI){var a=quest.QuestModel.getInstance().getMainTaskVo();a&&a.tb_quest&&2==a.tb_quest.flag&&a.finish?this.addChild(this._effUI):this.removeChild(this._effUI)}},d.prototype.a_list_cellMouseEvet=function(a){switch(UIManager.popClikNameFun("a_list_cell"),a.target){case this.taskListUi.bg:a.type==InteractiveEvent.Down?this.taskListMouseDown(a):this.taskListUi.clikUp(a)}},d.prototype.butClikUCellUp=function(a){},d.prototype.refresh=function(){this.questMainCell.refresh(),0==b.showType?(this.lc_main_cell.x=42,this.taskListUi.bg.y=this.questMainCell.nextTy):(this.lc_main_cell.x=-999,this.taskListUi.bg.y=140),this.taskListUi.refresh(),this._topRender.applyObjData(),this.refreshEff(),this.resize()},d.prototype.refreshType=function(a){this.refresh()},d.prototype.resize=function(){a.prototype.resize.call(this),this.lc_main_cell.renderData2[0]=this.lc_main_cell.width/512*b.taskUiScale15,this.lc_main_cell.renderData2[1]=this.lc_main_cell.height/2048*b.taskUiScale15,this.lc_main_cell.uiRender.makeRenderDataVc(this.lc_main_cell.vcId),this.taskListUi.resize()},d.prototype.butClik=function(a){switch(UIManager.popClikNameFun("a_list_cell"),a.target){case this.lc_main_cell:if(a.type==InteractiveEvent.Up&&0==this.left){UIManager.popClikNameFun("lc_main_cell");var b=this.lc_main_cell.data;if(b.tb_quest,UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),5)){var c=a.y-(this.lc_main_cell.y*UIData.Scale+this.y);c/=UIData.Scale,quest.QuestModel.getInstance().clikTaskVoCell(this.lc_main_cell.data,Math.floor((c-10)/20))}}}},d.prototype.taskListMouseDown=function(a){this._isMoveBar=!1,this._lastMouseY=a.y,this._lastFriendTy=this.taskListUi.taskTy,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.onStageMouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.onStageMouseUp,this)},d.prototype.onStageMouseMove=function(a){this._isMoveBar=!0,this.taskListUi.taskTy=this._lastFriendTy+(a.y-this._lastMouseY)},d.prototype.onStageMouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.onStageMouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.onStageMouseUp,this),this._isMoveBar=!1},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d}(UIPanel);a.LeftUiQuestPanel=d}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(b){function c(){var c=b.call(this)||this;return c.uiAtlasComplet=!1,c.openOrClose=!0,c.tempLeft=0,c.interfaceUI=!0,c.width=UIData.designWidth,c.height=UIData.designHeight,c.left=0,c.middle=0,c._bottomRender=new UIRenderComponent,c.addRender(c._bottomRender),c._midRender=new UIRenderComponent,c.addRender(c._midRender),c._midRender.uiAtlas=new UIAtlas,c.leftUiQuestPanel=new a.LeftUiQuestPanel,c}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this.leftUiQuestPanel.loadAtlas(function(){a._midRender.uiAtlas.setInfo("ui/uidata/mainui/left/left.xml","ui/uidata/mainui/left/left.png",function(){a.loadConfigCom()})})},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_bg")),this.a_state2_tab1=this.addEvntBut("a_state2_tab1",this._midRender),this.a_state2_tab0=this.addEvntBut("a_state2_tab0",this._midRender),this.a_hide_but=this.addEvntBut("a_hide_but",this._midRender),this.a_hide_but.left=6,this.uiAtlasComplet=!0,this.applyLoadComplete(),mainUi.MainUiModel.mainUiLoadFinish()},c.prototype.refresh=function(){return GuidData.map.showAreaById(AreaType.topleftpalce_2)?(this.left=0,this.setUiListVisibleByItem([this.a_hide_but],!0),this.setUiListVisibleByItem([this.a_state2_tab1],GuidData.player.isOpenSystemById(SharedDef.MODULE_EXP)),this.a_hide_but.isU=!this.openOrClose,this.openOrClose?this.pxleft=0:this.pxleft=-300,this.selectTab(a.TaskListUi.showType),void this.leftUiQuestPanel.show()):(this.left=-1e3,void this.setUiListVisibleByItem([this.a_hide_but],!1))},c.prototype.selectTab=function(b){a.TaskListUi.showType=b,0==b?(this.a_state2_tab0.selected=!0,this.a_state2_tab1.selected=!1,this.leftUiQuestPanel.refreshType(a.TaskListUi.showType)):(this.a_state2_tab1.selected=!0,this.a_state2_tab0.selected=!1,this.leftUiQuestPanel.refreshType(a.TaskListUi.showType))},c.prototype.butClik=function(a){switch(a.target){case this.a_state2_tab0:this.selectTab(0);break;case this.a_state2_tab1:this.selectTab(1);break;case this.a_hide_but:this.openOrClose=!this.openOrClose,this.openOrClose?TweenMoveTo(this,.2,{pxleft:0}):TweenMoveTo(this,.2,{pxleft:-300}),this.a_hide_but.isU=!this.openOrClose,this._midRender.applyObjData()}},Object.defineProperty(c.prototype,"pxleft",{get:function(){return this.tempLeft},set:function(a){this.tempLeft=a,this.left=this.tempLeft,this.leftUiQuestPanel.left=a,this.leftUiQuestPanel.resize(),this.resize()},enumerable:!0,configurable:!0}),c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.refresh()},c.prototype.hide=function(){this.leftUiQuestPanel.hide(),UIManager.getInstance().removeUIContainer(this)},c}(UIPanel);a.LeftUiPanel=b}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),leftui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"LeftUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.LeftUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_LEFT_UI_PANEL="SHOW_LEFT_UI_PANEL",b.HIDE_LEFT_UI_PANEL="HIDE_LEFT_UI_PANEL",b.REFRESH_QUEST_EVENT="REFRESH_QUEST_EVENT",b.LEFT_HANGUP_BASE_REFRESH="LEFT_HANGUP_BASE_REFRESH",b}(BaseEvent);a.LeftUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"LeftUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_LEFT_UI_PANEL&&this.showPanel(),b.type==c.LEFT_HANGUP_BASE_REFRESH,b.type==c.HIDE_LEFT_UI_PANEL&&this.hidePanel(),b.type==c.REFRESH_QUEST_EVENT&&this.leftUiPanel&&(this.leftUiPanel.leftUiQuestPanel.refresh(),GuidData.map.isBaseMap()&&this.questFinishWalkToNextNpc())}if(a instanceof EngineEvent){var d=a;d.type==EngineEvent.MONEY_CHANGE&&this.leftUiPanel&&(this.leftUiPanel.leftUiQuestPanel.refresh(),console.log("刷新任务"))}},d.prototype.showEffect=function(){var a=new msgtip.MsgEffectsMoveData,b=new Vector2D(UIData.designWidth/2,UIData.designHeight/2);a.startTM=TimeUtil.getTimer()+random(200),a.endTM=a.startTM+500,a.pos=b,a.MONEY_TYPE=1,a.bezierPos=new Vector2D(b.x+400*Math.random()-200,b.y+400*Math.random()-200),a.toPos=new Vector2D(150,178);var c=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_EFFECTS_DATA);c.data=a,ModuleEventManager.dispatchEvent(c)},d.prototype.questFinishWalkToNextNpc=function(){GameInstance.questMoveVo&&quest.QuestModel.getInstance().walkToNewMainQuest()},d.prototype.hidePanel=function(){this.leftUiPanel&&this.leftUiPanel.hide()},d.prototype.showPanel=function(){var b=this;this.leftUiPanel||(this.leftUiPanel=new a.LeftUiPanel),this.leftUiPanel.load(function(){GuidData.map.isFamilyScene(),GuidData.map.isAdventureBossScene()&&(AotuSkillManager.getInstance().aotuBattle=!0),b.leftUiPanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_LEFT_UI_PANEL),new c(c.HIDE_LEFT_UI_PANEL),new c(c.LEFT_HANGUP_BASE_REFRESH),new c(c.REFRESH_QUEST_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE)]},d}(BaseProcessor);a.LeftUiProcessor=d}(leftui||(leftui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),rightui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.right=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._aotuRender=new UIRenderComponent,b.addRender(b._aotuRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._exitRender=new UIRenderComponent,b.addRender(b._exitRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b._effRender=new FrameUIRender,b.addRender(b._effRender),b._frameRender=new FrameUIRender,b.addRender(b._frameRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/mainui/right/right.xml","ui/uidata/mainui/right/right.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._exitRender.uiAtlas=this._midRender.uiAtlas,this._aotuRender.uiAtlas=this._midRender.uiAtlas,this.a_bag=this.addEvntButUp("a_bag",this._bottomRender),this.a_bag.addEventListener(InteractiveEvent.Down,function(a){},this),this.a_hunjing=this.addEvntButUp("a_hunjing",this._bottomRender),this.a_hunjing.addEventListener(InteractiveEvent.Down,function(a){},this),this.removeChild(this.a_hunjing),this.a_skill_aotu=this.addEvntBut("a_skill_aotu",this._aotuRender),this.a_sys_tip_pic=this.addEvntButUp("a_sys_tip_pic",this._bottomRender),this.a_sys_tip_pic.addEventListener(InteractiveEvent.Down,function(a){},this),this.a_sys_tip_pic.addEventListener(InteractiveEvent.Up,this.a_sys_tip_picClik,this),this.a_sys_tip_txt=this.addChild(this._midRender.getComponent("a_sys_tip_txt")),this.a_sys_tip_icon=this.addChild(this._midRender.getComponent("a_sys_tip_icon")),this.a_change=this.addEvntButUp("a_change",this._bottomRender),this.a_change.addEventListener(InteractiveEvent.Down,function(a){},this),this._redPointRender.getRedPointUI(this,124,new Vector2D(this.a_hunjing.x+this.a_hunjing.width,this.a_hunjing.y)),this.bag_red=this._redPointRender.getRedPointUI(this,1,new Vector2D(this.a_bag.x+this.a_bag.width,this.a_bag.y)),this.change_red=this._redPointRender.getRedPointUI(this,5,new Vector2D(this.a_change.x+this.a_change.width,this.a_change.y)),this.a_exit=this.addChild(this._exitRender.getComponent("a_exit")),this.a_exit.addEventListener(InteractiveEvent.Up,this.exitMap,this),this.a_exit.addEventListener(InteractiveEvent.Down,function(a){},this),this.uiAtlasComplet=!0,this.refreshNotice(),this.buildFram(),BagData.uipos.x=this.a_bag.absoluteX+this.a_bag.width/2,BagData.uipos.y=this.a_bag.absoluteY+this.a_bag.height/2},b.prototype.resize=function(){a.prototype.resize.call(this),BagData.uipos.x=this.a_bag.absoluteX+this.a_bag.width/2,BagData.uipos.y=this.a_bag.absoluteY+this.a_bag.height/2},b.prototype.buildFram=function(){var a=this;this._frameRender.setImg(getEffectUIUrl("ef_zd"),4,4,function(b){a.effui=b,a.effui.x=a.a_skill_aotu.x-46,a.effui.y=a.a_skill_aotu.y-42,a.effui.width=1.1*a.effui.baseRec.width,a.effui.height=1.1*a.effui.baseRec.height,a.effui.speed=3,a.applyLoadComplete()},1)},b.prototype.playEff=function(a){this.effui&&(a?(console.log("----对象------",this.effui),this.addChild(this.effui),this.effui.play()):this.removeChild(this.effui))},b.prototype.a_sys_tip_picClik=function(a){if(this.a_sys_tip_pic.data instanceof tb.TB_system_preview){var b=this.a_sys_tip_pic.data;console.log(b);var c=new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.SHOW_SYSTRAILER_EVENT);c.data=b.id,ModuleEventManager.dispatchEvent(c)}else{var d=this.a_sys_tip_pic.data;ModulePageManager.openPanel(d.data["goto"],d.data.goto_sub)}},b.prototype.isaddHuanjingBut=function(){var a=this;this._huanjingEff||(this.addChild(this.a_hunjing),this._effRender.setImg(getEffectUIUrl("ui_mx"),4,4,function(b){a._huanjingEff=b,a._huanjingEff.x=a.a_hunjing.x-10,a._huanjingEff.y=a.a_hunjing.y-10,a._huanjingEff.width=.7*a._huanjingEff.baseRec.width,a._huanjingEff.height=.7*a._huanjingEff.baseRec.height,a.addChild(a._huanjingEff),a._huanjingEff.speed=3,a._huanjingEff.play()}))},b.prototype.refreshNotice=function(){var a=!1;this.uiAtlasComplet&&GuidData.faction&&GuidData.faction.getApplyList().length&&(a=!0)},b.prototype.butClik=function(a){if(GameInstance.canclikFightui)switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.a_bag:ModulePageManager.openPanel(SharedDef.MODULE_BAG,2);break;case this.a_change:UIManager.popClikNameFun(this.a_change.skinName),mainUi.MainUiModel.skillTabIndex=(mainUi.MainUiModel.skillTabIndex+1)%2,0==mainUi.MainUiModel.skillTabIndex?(ModuleEventManager.dispatchEvent(new fightui.FightUiEvent(fightui.FightUiEvent.SHOW_FIGHT_UI_PANEL)),ModuleEventManager.dispatchEvent(new homeui.HomeUiEvent(homeui.HomeUiEvent.HIDE_HOME_UI_PANEL))):(ModuleEventManager.dispatchEvent(new homeui.HomeUiEvent(homeui.HomeUiEvent.SHOW_HOME_UI_PANEL)),ModuleEventManager.dispatchEvent(new fightui.FightUiEvent(fightui.FightUiEvent.HIDE_FIGHT_UI_PANEL))),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT));break;case this.a_hunjing:console.log("---a_hunjing---"),ModulePageManager.openPanel(SharedDef.MODULE_REALM),UIManager.popClikNameFun(this.a_hunjing.name);break;case this.a_skill_aotu:AotuSkillManager.getInstance().aotuBattle=!AotuSkillManager.getInstance().aotuBattle,UiTweenScale.getInstance().changeButSize(a.target)}},b.prototype.changeSkillAotu=function(){this.a_skill_aotu&&(this.a_skill_aotu.selected=AotuSkillManager.getInstance().aotuBattle,(GuidData.map.showAreaById(AreaType.rightChange_6)||GuidData.map.showAreaById(AreaType.fightSKill_7))&&(this.playEff(this.a_skill_aotu.selected),console.log("====自动战斗按钮======",this.a_skill_aotu.selected)))},b.prototype.exitMap=function(a){UiTweenScale.getInstance().changeButSize(a.target),this._exitFun||(this._exitFun=function(a){1==a&&NetManager.getInstance().protocolos.instance_exit(0)}),13==GuidData.map.tbMapVo.inst_sub_type?AlertUtil.show("放弃挑战不会获得任何奖励并扣除挑战次数！是否放弃？","",this._exitFun,2,["是","否"]):this._exitFun(1)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.renderSetVisibel([this._bottomRender,this._midRender,this._redPointRender,this._effRender],GuidData.map.showAreaById(AreaType.rightChange_6)),this.renderSetVisibel([this._exitRender],GuidData.map.showAreaById(AreaType.sceneExit_30)),GuidData.player.isOpenSystemNeedShow(SharedDef.MODULE_REALM)&&this.isaddHuanjingBut(),GuidData.map.showAreaById(AreaType.rightChange_6)||GuidData.map.showAreaById(AreaType.fightSKill_7)?this.renderSetVisibel([this._aotuRender],!0):this.renderSetVisibel([this._aotuRender],!1),this.drawSysTemTip(),this.changeSkillAotu()},b.prototype.drawSysTemTip=function(){for(var a,b=tb.TB_system_preview.getItem(),c=0;c<b.length;c++)if(b[c].level_start<=GuidData.player.getLevel()&&b[c].level>GuidData.player.getLevel()){a=b[c];break}if(a){var d=tb.TB_system_base.getTempVo(10*a.system_id[0]+a.system_id[1]);this._bottomRender.uiAtlas.upDataPicToTexture(this.getIconByID(a.system_id[0]),this.a_sys_tip_icon.skinName),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_sys_tip_txt.skinName,d.level+"级解锁",24,TextAlign.CENTER,ColorType.Whitefff4d6),this.a_sys_tip_pic.data=a}this.setUiListVisibleByItem([this.a_sys_tip_pic,this.a_sys_tip_icon,this.a_sys_tip_txt],Boolean(a))},b.prototype.getIconByID=function(a){return"ui/load/systemicon/"+a+".png"},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(UIPanel);a.RightUiPanel=b}(rightui||(rightui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),rightui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"RightUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.RightUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_RIGHT_UI_PANEL="SHOW_RIGHT_UI_PANEL",b.HIDE_RIGHT_UI_PANEL="HIDE_RIGHT_UI_PANEL",b}(BaseEvent);a.RightUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"RightUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_RIGHT_UI_PANEL&&this.showPanel(),b.type==c.HIDE_RIGHT_UI_PANEL&&this.hidePanel()}if(a instanceof faction.FactionEvent&&this.rightUiPanel&&a.type==faction.FactionEvent.REFRESHFACTIONITEMAPPLY_EVENT&&this.rightUiPanel.refreshNotice(),a instanceof fightui.FightUiEvent&&this.rightUiPanel&&a.type==fightui.FightUiEvent.REFRESH_SKILL_AOTUBATTLE&&this.rightUiPanel.changeSkillAotu(),a instanceof EngineEvent){var d=a;d.type==EngineEvent.PLAYER_FIELD_LEVEL&&this.rightUiPanel&&this.rightUiPanel.drawSysTemTip()}},d.prototype.hidePanel=function(){this.rightUiPanel&&this.rightUiPanel.hide()},d.prototype.showPanel=function(){var b=this;this.rightUiPanel||(this.rightUiPanel=new a.RightUiPanel),this.rightUiPanel.load(function(){b.rightUiPanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_RIGHT_UI_PANEL),new c(c.HIDE_RIGHT_UI_PANEL),new c(EngineEvent.PLAYER_FIELD_LEVEL),new fightui.FightUiEvent(fightui.FightUiEvent.REFRESH_SKILL_AOTUBATTLE),new faction.FactionEvent(faction.FactionEvent.REFRESHFACTIONITEMAPPLY_EVENT)]},d}(BaseProcessor);a.RightUiProcessor=d}(rightui||(rightui={}));var FightSkillModel=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.playSkillToAttack=function(a,b){if(!GameInstance.mainChar.isSinging){b&&0!=a.tb_skill_base.is_play_forbid||this.playSkillEffect(a.tb_skill_base.id);var c=new Vector2D,d=0;GameInstance.attackTarget?(c=GameInstance.attackTarget.getAstarPos(),GameInstance.mainChar.watch(GameInstance.attackTarget),1==a.tb_skill_base.lock_type&&(d=GameInstance.attackTarget.unit.uintGuid)):c=this.getMainCharFrontPos(a);var e=(-GameInstance.mainChar.rotationY-270)%360;NetManager.getInstance().protocolos.set_orient(e),NetManager.getInstance().protocolos.spell_start(a.slot,c.x,c.y,0,d)}},a.prototype.getMainCharFrontPos=function(a){var b=AstarUtil.getGrapIndexByPos(GameInstance.mainChar.getCurrentPos()),c=new Matrix3D,d=(-GameInstance.mainChar.rotationY-270)%360;c.appendRotation(d,Vector3D.Y_AXIS);var e=new Vector3D(1,0,0);return e=c.transformVector(e),e.normalize(),e.scaleBy(a.tb_skill_uplevel.distance),b.x+=e.x,b.y+=e.z,b.x=Math.floor(b.x),b.y=Math.floor(b.y),b},a.prototype.canPlaySkillToAttackTarger=function(a){return GameInstance.attackTarget&&GameInstance.mainChar.math_distance(GameInstance.attackTarget)<a?!0:!1},a.prototype.moveToAttackTarger=function(a,b,c){void 0===c&&(c=null);var d=b.tb_skill_uplevel.distance-2,e=a.getAstarPos(),f=GameInstance.mainChar.getAstarPos();if(f){var g=new Vector2D(f.x-e.x,f.y-e.y);g.normalize(),g.scaleBy(d),g.x=Math.floor(g.x),g.y=Math.floor(g.y),e.x+=g.x,e.y+=g.y;var h=AstarUtil.findPath2D(f,e);h&&h.length&&MainCharControlModel.getInstance().setWalkPathFun(h,c)}},a.prototype.playSkillEffect=function(a){var b=Play_Skill_Vo.get_Play_Skill_Vo(a);if(b.tb_skill_base.effect_file&&b.tb_skill_base.effect){var c=SkillManager.getInstance().getSkill(getSkillUrl(b.tb_skill_base.effect_file),b.tb_skill_base.effect);if(c){c.reset(),c.needSound=!0;var d=new Array;if(0==b.tb_skill_base.is_remain){if(1==b.tb_skill_base.isOrbit){if(!GameInstance.attackTarget)return;c.configTrajectory(GameInstance.mainChar,GameInstance.attackTarget)}else GameInstance.attackTarget&&4==b.tb_skill_base.target_type&&d.push(GameInstance.attackTarget.getCurrentPos()),c.configFixEffect(GameInstance.mainChar,null,d);GameInstance.mainChar.playSkill(c),FightManager.getInstance().setSelfSkillCd(a)}}}},a}(),JumpModel=function(){function a(){}return a.jumpTestIn=function(){if(!this.isTestJumpNow())for(var b=0;b<RelationManager.getInstance().jumpItem.length;b++){var c=RelationManager.getInstance().jumpItem[b];if(c.onStage){var d=tb.TB_gameobject_template.get_TB_gameobject_template(c.unit.getEntry()),e=GameInstance.mainChar.getAstarPos(),f=c.getAstarPos();if(e&&f&&Math.abs(e.x-f.x)<d.trigger_width&&Math.abs(e.y-f.y)<d.trigger_height){var g=c.unit.GetUInt32(SharedDef.GO_FIELD_DATA+1);this.walkPathPos=GameInstance.mainChar.getEndWalkPathPos(),GameInstance.mainChar.jumpEndFun=function(){a.selfJumpEnd()},MainCharControlModel.getInstance().sendStop(),console.log("向服务器发送跳跃信息====>"),NetManager.getInstance().protocolos.use_jump_point(g),this.nextCheckTime=TimeUtil.getTimer()+1e3;break}}}},a.selfJumpEnd=function(){this.jumpNow=!1,GameInstance.questMoveVo?quest.QuestModel.getInstance().toplay(GameInstance.questMoveVo.pos):this.walkPathPos&&(quest.QuestModel.getInstance().toplay(AstarUtil.getGrapIndexByPos(this.walkPathPos)),this.walkPathPos=null)},a.isTestJumpNow=function(){return this.nextCheckTime>TimeUtil.getTimer()},a.frameUpData=function(){return a.jumpNow?!0:(a.jumpTestIn(),!1)},a.jumpNow=!1,a.nextCheckTime=0,a}(),AotuFunModelVo=function(){function a(a,b,c){void 0===b&&(b=!1),void 0===c&&(c=null),this.fun=a,this.endSkillPlay=b,this.name=c}return a}(),AotuSkillManager=function(){function a(){var a=this;this._aotuBattle=!1,this.lastUpTime=0,this.nextPlaySkillTm=0,this.initAotuFunItem(),TimeUtil.addFrameTick(function(b){a.update(b)})}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},Object.defineProperty(a.prototype,"aotuWalk",{get:function(){return this._aotuWalk},set:function(a){this.aotuWalk!=a&&(this._aotuWalk=a,a&&(this.aotuBattle=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"aotuBattle",{get:function(){return this._aotuBattle},set:function(a){a&&(this.aotuWalk=!1),this._aotuBattle!=a&&(GameInstance.attackTarget=null,this._aotuBattle=a,this._aotuBattle&&GameInstance.mainChar.unit.hasMount()&&NetManager.getInstance().protocolos.ride_mount(),ModuleEventManager.dispatchEvent(new fightui.FightUiEvent(fightui.FightUiEvent.REFRESH_SKILL_AOTUBATTLE)))},enumerable:!0,configurable:!0}),a.prototype.timeoutAuto=function(){var a=this;TimeUtil.addTimeOut(5e3,function(){GuidData.map.tbMapVo.aotubattle&&(a.aotuBattle=!0)})},a.prototype.isTestAotuFun=function(){for(var a=!1,b=0;b<this.aotuFunItem.length;b++)if(this.aotuFunItem[b].endSkillPlay){var c=this.aotuFunItem[b].fun();c&&(a=!0)}else this.aotuFunItem[b].fun();return a},a.prototype.initAotuFunItem=function(){this.aotuFunItem=new Array,this.aotuFunItem.push(new AotuFunModelVo(function(){return AttackEffectsManager.frameUpData()})),this.aotuFunItem.push(new AotuFunModelVo(function(){return kuafu.KuaFu3v3Model.frameUpData()})),this.aotuFunItem.push(new AotuFunModelVo(function(){return boss.BossModel.frameUpData()})),this.aotuFunItem.push(new AotuFunModelVo(function(){return JumpModel.frameUpData()},!0)),this.aotuFunItem.push(new AotuFunModelVo(function(){return MainCharControlModel.getInstance().frameUpData()},!0))},a.prototype.update=function(a){if(SceneManager.getInstance().ready&&GuidData.map){if(GuidData.player.needGuididPop,!tb.SkillData.skillList)return void tb.SkillData.resetSkillData();if(MainCharControlModel.getInstance().update(a),!this.isTestAotuFun()&&!GameInstance.mainChar.isSinging){var b=GameInstance.mainChar.curentAction;this._aotuBattle&&this.nextPlaySkillTm<TimeUtil.getTimer()&&(MainCharControlModel.getInstance().clikEat(),GameInstance.attackTarget||(GameInstance.attackTarget=RelationManager.getInstance().findNearCanAttackScene()),GameInstance.attackTarget&&b==CharAction.WALK&&GameInstance.mainChar.math_distance(GameInstance.attackTarget)<50&&MainCharControlModel.getInstance().sendStop(),this.needAttackToSelect())}}},a.prototype.needAttackToSelect=function(){var a=this,b=GameInstance.mainChar.curentAction;if(b==CharAction.STANAD||b==CharAction.ATTACK_010||b==CharAction.ATTACK_020){this.nextPlaySkillTm=TimeUtil.getTimer()+550;var c;if(!c)for(var d=0;d<tb.SkillData.skillList.length;d++){var e=tb.SkillData.skillList[d];e.slot;if(e.level){var f=tb.SkillData.getCdMeshBySkillId(e.id);isNaN(f)&&(f=-1),f<TimeUtil.getTimer()&&(c=e)}}c&&this._aotuBattle||(c=tb.SkillData.threeSkillList[GameInstance.threeBattarId++%3]),c&&c.tb_skill_uplevel?c.tb_skill_base.is_remain&&0==c.tb_skill_base.can_move:console.log("有问题"),10024!=c.id;var g=FightSkillModel.getInstance().canPlaySkillToAttackTarger(10*c.tb_skill_uplevel.distance);g?FightSkillModel.getInstance().playSkillToAttack(c,!1):(1==c.slot&&GameInstance.threeBattarId--,GameInstance.attackTarget&&GameInstance.attackTarget.onStage&&FightSkillModel.getInstance().moveToAttackTarger(GameInstance.attackTarget,c,function(){a.walkPathComplete()}))}},a.prototype.walkPathComplete=function(){this.nextPlaySkillTm=0},a.prototype.jumpTo=function(){GameInstance.mainChar.jumpEndFun=function(){JumpModel.selfJumpEnd()},MainCharControlModel.getInstance().sendStop();var a=GameInstance.mainChar.getCurrentPos(),b=new Matrix3D;b.appendRotation(GameInstance.mainChar.pRotationY-90,Vector3D.Y_AXIS);var c=b.transformVector(new Vector3D(150,0,0));c=c.add(a);var d=AstarUtil.findNearLinePoint(a,c),e=AstarUtil.getGrapIndexByPos(d);NetManager.getInstance().protocolos.jump_start(e.x,e.y)},a}(),mainUi;!function(a){var b=function(){function a(){}
return a.mainUiLoadFinish=function(){},a.getMsgTipData=function(){var a=new Array;return GuidData.social&&GuidData.social.getApplyList().length&&a.push(1),GuidData.faction?GuidData.faction.getApplyList().length&&GuidData.faction.playerIdentity<4&&a.push(2):faction.FactionModel.getInstance().getInvitationList().length&&a.push(2),Chat.ChatModel.getInstance().getHaveNewChatInfo()&&a.push(4),email.EmailModel.getInstance().getHaveNewEmailInfo()&&a.push(5),a},a.collectionMouseDown=function(){console.log("collectionMouseDown"),1==GameData.collectionType?this.talkNearNpc():this.getNextCollention()},a.getNextCollention=function(){for(var a,b,c=0;c<GameInstance.roleList.length;c++){var d=GameInstance.roleList[c];d.unit.getTypeID()!=SharedDef.TYPEID_GAMEOBJECT||d.isDeath||(!a||b>GameInstance.mainChar.math_distance(d))&&(a=d,b=GameInstance.mainChar.math_distance(d))}a&&(console.log(a.unit.getName(),a.isDeath),TimeUtil.addTimeOut(50,function(){quest.QuestModel.getInstance().use_gameobject(a)}))},a.talkNearNpc=function(){for(var a,b,c=0;c<GameInstance.roleList.length;c++){var d=GameInstance.roleList[c];d.unit.isNpc()&&(!a||b>d.math_distance(GameInstance.mainChar))&&(a=d,b=GameInstance.mainChar.math_distance(d))}if(a){var e=new dialog.DialogueEvent(dialog.DialogueEvent.SHOW_DIALOGUE_PANEL);e.entryId=a.unit.getEntry(),ModuleEventManager.dispatchEvent(e)}},a.getIllusionSkillItem=function(){for(var a=new Array,b=GameInstance.mainChar.unit.getIllusionId(),c=tb.TB_item_illusion.get_TB_item_illusion(b),d=0;d<c.skills.length;d++){var e=tb.SkillDataVo.getSkillBaseDataById(c.skills[d][0]);e.slot=d+1,e.level=1}return a},a.getSysList=function(){for(var a=GuidData.player.systemOpenItem,b=new Array,c=0;c<a.length;c++){var d=tb.TB_system_icon.getTempVo(a[c].systemId);a[c].needShowIcon&&(d.bindactive.length>0?this.getActiveIsOpen(d.bindactive)&&b.push(d):b.push(d))}return b.sort(function(a,b){return a.index-b.index}),b},a.getActiveIsOpen=function(a){for(var b=GuidData.globelValue.getActiveList(),c=0;c<a.length;c++)if(-1!=b.indexOf(a[c]))return!0;return!1},a.getPandaPostionBySysId=function(a){for(var b=this.getSysList(),c=0,d=0,e=0,f=0,g=new Vector2D,h=0;h<b.length;h++){var i=b[h];1==i.position&&c++,2==i.position&&d++,4==i.position&&e++,5==i.position&&f++,i.id==a&&(1==i.position&&(g=new Vector2D(730-65*c,10)),2==i.position&&(g=new Vector2D(730-65*d,75)),4==i.position&&(g=new Vector2D(890,464-65*e)),5==i.position&&(g=new Vector2D(950-65*f,464))),9==i.position&&(g=new Vector2D(731,160))}return g},a.pandaState=!0,a.pandaCanAotu=!0,a.skillTabIndex=0,a.systemTab=1,a}();a.MainUiModel=b}(mainUi||(mainUi={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mainUi;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MainUiModule"},b.prototype.listProcessors=function(){return[new e]},b}(Module);a.MainUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MAINUI_EVENT="SHOW_MAINUI_EVENT",b.SHOW_PANDA_EVENT="SHOW_PANDA_EVENT",b.HIDE_MAINUI_EVENT="HIDE_MAINUI_EVENT",b.RESET_SKILL_ICON="RESET_SKILL_ICON",b.ANGER_SKILL_CHANGE="ANGER_SKILL_CHANGE",b.REFRESH_MAINUI_PANEL="REFRESH_MAINUI_PANEL",b.PLAYER_SKILL_CD_REFRESH="PLAYER_SKILL_CD_REFRESH",b}(BaseEvent);a.MainUiEvent=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MAIN_OPERAT_EVENT="show_main_operat_event",b.HIDE_MAIN_OPERAT_EVENT="hide_main_operat_event",b}(BaseEvent);a.MainOperatEvent=d;var e=function(b){function e(){return null!==b&&b.apply(this,arguments)||this}return __extends(e,b),e.prototype.getName=function(){return"MainUiProcessor"},e.prototype.receivedModuleEvent=function(b){if(b instanceof c){var d=b;d.type==c.SHOW_MAINUI_EVENT&&(SceneManager.getInstance().render=!0,(GuidData.map.isAdventureBaseScene()||GuidData.map.isAdventureBossScene())&&0==a.MainUiModel.skillTabIndex,ModuleEventManager.dispatchEvent(new rightui.RightUiEvent(rightui.RightUiEvent.SHOW_RIGHT_UI_PANEL)),ModuleEventManager.dispatchEvent(new leftui.LeftUiEvent(leftui.LeftUiEvent.SHOW_LEFT_UI_PANEL)),ModuleEventManager.dispatchEvent(new topui.TopUiEvent(topui.TopUiEvent.SHOW_TOP_UI_PANEL)),ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.SHOW_BOTTOM_UI_PANEL)),ModuleEventManager.dispatchEvent(new adventureinfo.AdventurInfoEvent(adventureinfo.AdventurInfoEvent.SHOW_ADVENTURE_INFO_UI_PANEL)),0==a.MainUiModel.skillTabIndex?ModuleEventManager.dispatchEvent(new fightui.FightUiEvent(fightui.FightUiEvent.SHOW_FIGHT_UI_PANEL)):ModuleEventManager.dispatchEvent(new homeui.HomeUiEvent(homeui.HomeUiEvent.SHOW_HOME_UI_PANEL)),AreaType.restAreaPanel(),ModuleEventManager.dispatchEvent(new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_GUIDE_POP_VIEW)),Engine.needVertical=!0,Engine.resetSize()),d.type==c.HIDE_MAINUI_EVENT&&(ModuleEventManager.dispatchEvent(new leftui.LeftUiEvent(leftui.LeftUiEvent.HIDE_LEFT_UI_PANEL)),ModuleEventManager.dispatchEvent(new topui.TopUiEvent(topui.TopUiEvent.HIDE_TOP_UI_PANEL)),ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.HIDE_BOTTOM_UI_PANEL)),ModuleEventManager.dispatchEvent(new homeui.HomeUiEvent(homeui.HomeUiEvent.HIDE_HOME_UI_PANEL)),ModuleEventManager.dispatchEvent(new fightui.FightUiEvent(fightui.FightUiEvent.HIDE_FIGHT_UI_PANEL))),d.type==c.REFRESH_MAINUI_PANEL&&ModuleEventManager.dispatchEvent(new topui.TopUiEvent(topui.TopUiEvent.REFRESH_TOP_PANDA))}},e.prototype.resetPanel=function(){},e.prototype.angerSkillChange=function(){console.log("怒气技能")},e.prototype.resetSkillIcon=function(){console.log("技能刷新")},e.prototype.hideUi=function(){},e.prototype.showUi=function(){},e.prototype.listenModuleEvents=function(){return[new c(c.HIDE_MAINUI_EVENT),new c(c.SHOW_MAINUI_EVENT),new c(c.RESET_SKILL_ICON),new c(c.ANGER_SKILL_CHANGE),new c(c.PLAYER_SKILL_CD_REFRESH),new c(c.REFRESH_MAINUI_PANEL),new c(c.SHOW_PANDA_EVENT),new EngineEvent(EngineEvent.MONEY_TYPE_GOLD_INGOT),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new EngineEvent(EngineEvent.PLAYER_FIELD_FORCE),new EngineEvent(EngineEvent.MONEY_TYPE_SILVER),new EngineEvent(EngineEvent.PLAYER_EXPAND_INT_XP),new EngineEvent(EngineEvent.PLAYER_FIELD_VIP_LEVEL),new EngineEvent(EngineEvent.ENTER_SCENE_EVENT),new d(d.SHOW_MAIN_OPERAT_EVENT),new d(d.HIDE_MAIN_OPERAT_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},e.prototype.smsgCombatStateUpData=function(a){a.readByte()},e.prototype.smsgPeaceModeCd=function(a){},e.prototype.smsgBagItemCooldwn=function(a){for(var b=a.readUint16(),c=0;b>c;c++){var d=new item_cooldown_info;d.read(a),GameInstance.bagCdItem[d.item]=TimeUtil.getTimer()+d.cooldown}},e.prototype.smsgfieldDeathCooldown=function(a){var b=this,c=a.readUint16();console.log(c),TimeUtil.addTimeOut(3e3,function(){b.resurrection()})},e.prototype.resurrection=function(){var a=AotuSkillManager.getInstance().aotuBattle,b=1==GuidData.player.getHangUpResurrection(),c=GuidData.player.getHangupdata(),d=1==c[8],e=1==c[9],f=tb.TB_hook_hp_item_Vo.get_TB_hook_hp_item_Vo(2).items[0],g=GameInstance.mainChar.unit;g.getHp()/g.getMaxHp();if(!b&&(d=!1,e=!1,a))return console.log("退出场景回城"),void NetManager.getInstance().protocolos.teleport_main_city();console.log(GuidData.player.getHangupdata());GuidData.bag.getItemByEntry(f);if(a){var h=this.useItem(f);if(h)console.log("从背包中得到复活丹");else{var i=tb.TB_shop.get_TB_shopById(f);if(d||e){var j=i.costResource[0][1];i&&GuidData.player.getBindGold()>=j?(console.log("使用绑定元宝",GuidData.player.getBindGold()),NetManager.getInstance().protocolos.gold_respawn(SharedDef.MONEY_TYPE_BIND_GOLD)):e?i&&GuidData.player.getGoldIngot()>=j?(NetManager.getInstance().protocolos.gold_respawn(SharedDef.MONEY_TYPE_GOLD_INGOT),console.log("使用元宝","protocolos.gold_respawn",GuidData.player.getGoldIngot())):console.log("无钱购买"):console.log("绑定元宝不足够")}}}},e.prototype.useItem=function(a){if(GuidData.bag.hasItem(a,1)){var b=GuidData.bag.getItemByEntry(a);return NetManager.getInstance().protocolos.bag_item_user(b.guid,1),console.log("吃药复活了"),!0}return!1},e.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_COMBAT_STATE_UPDATE]=function(b){a.smsgCombatStateUpData(b)},b[Protocols.SMSG_PEACE_MODE_CD]=function(b){a.smsgPeaceModeCd(b)},b[Protocols.SMSG_BAG_ITEM_COOLDOWN]=function(b){a.smsgBagItemCooldwn(b)},b[Protocols.SMSG_FIELD_DEATH_COOLDOWN]=function(b){a.smsgfieldDeathCooldown(b)},b},e}(BaseProcessor);a.MainUiProcessor=e}(mainUi||(mainUi={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Chat;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.top=0,a.left=0,a}return __extends(c,b),c.prototype.setRender=function(a,b,c){this._bottomRender=a,this._midRender=b,this._topRender=c,this.loadConfigCom()},c.prototype.loadConfigCom=function(){this.w_black=this.addEvntButUp("w_black",this._bottomRender),this.menuTypeButs=new Array,this.a_an0=this.addEvntBut("a_an0",this._midRender),this.a_an0.data=SharedDef.CHAT_TYPE_SYSTEM,this.a_an1=this.addEvntBut("a_an1",this._midRender),this.a_an1.data=SharedDef.CHAT_TYPE_WORLD,this.a_an2=this.addEvntBut("a_an2",this._midRender),this.a_an2.data=SharedDef.CHAT_TYPE_CURRENT,this.a_an3=this.addEvntBut("a_an3",this._midRender),this.a_an3.data=SharedDef.CHAT_TYPE_FACTION,this.menuTypeButs.push(this.a_an0),this.menuTypeButs.push(this.a_an1),this.menuTypeButs.push(this.a_an2),this.menuTypeButs.push(this.a_an3),this.a_an_txt_0=this.addChild(this._topRender.getComponent("a_an_txt_0")),this.a_an_txt_1=this.addChild(this._topRender.getComponent("a_an_txt_1")),this.a_an_txt_2=this.addChild(this._topRender.getComponent("a_an_txt_2")),this.a_an_txt_3=this.addChild(this._topRender.getComponent("a_an_txt_3")),this.redItem=new Array;for(var a=0;5>=a;a++)this.redItem.push(this.addChild(this._topRender.getComponent("a_mes_red_icon")));this.redItem[0].data=SharedDef.CHAT_TYPE_SYSTEM,this.redItem[1].data=SharedDef.CHAT_TYPE_WORLD,this.redItem[2].data=SharedDef.CHAT_TYPE_CURRENT,this.redItem[3].data=SharedDef.CHAT_TYPE_FACTION},c.prototype.resize=function(){b.prototype.resize.call(this),this.w_black.height=Scene_data.stageHeight/UIData.Scale-65,this.w_black.width=480},c.prototype.setMenuByType=function(b){for(var c=0;c<this.menuTypeButs.length;c++)this.menuTypeButs[c].selected=Boolean(this.menuTypeButs[c].data==b);a.ChatModel.showType=b},c.prototype.refresh=function(){this.setMenuByType(a.ChatModel.showType);for(var b=0;b<this.redItem.length;b++){var c=this.redItem[b];c.x=-600,c.y=46*b;for(var d=!1,e=0;e<a.ChatModel.getInstance().chatItem.length;e++){var f=a.ChatModel.getInstance().chatItem[e];f.showLast||Number(c.data)!=f.s2c_send_chat.channel||(d=!0,c.x=60)}}},c.prototype.butClik=function(a){isNaN(a.target.data)||(this.setMenuByType(a.target.data),this.parent.refresh())},c.testNum=0,c}(UIVirtualContainer);a.ChatBaseLeftMenu=b}(Chat||(Chat={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Chat;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.gmId=0,a.chatHtmlText="",a.width=UIData.designWidth,a.height=UIData.designHeight,a.bottom=0,a.left=0,a}return __extends(c,b),c.prototype.setRender=function(a,b,c){this._bottomRender=a,this._midRender=b,this._topRender=c,this.loadConfigCom()},c.prototype.loadConfigCom=function(){var a=this;this.addEvntBut("w_bottom_bg",this._bottomRender),this.uiList=new Array,this.w_input_bg=this.addEvntBut("w_input_bg",this._midRender),this.w_horn_but=this.addEvntBut("w_horn_but",this._midRender),this.w_face_but=this.addEvntBut("w_face_but",this._midRender),this.w_send=this.addEvntBut("w_send",this._midRender),this.w_input_ctx=this._topRender.getComponent("w_input_ctx"),this.uiList.push(this.w_input_bg),this.uiList.push(this.w_horn_but),this.uiList.push(this.w_face_but),this.uiList.push(this.w_send),this.uiList.push(this.w_input_ctx),this.w_sys_tips=this._midRender.getComponent("w_sys_tips"),this.w_sys_tips.y=490,document.addEventListener(MouseType.KeyDown,function(b){a.onKeyDown(b)})},c.prototype.onKeyDown=function(a){if(GameStart.GM&&this.parent&&this.parent.hasStage&&(a.keyCode==KeyboardType.Up||a.keyCode==KeyboardType.Down)){var b=localStorage.getItem("GMITEM");if(b){var c=JSON.parse(b);a.keyCode==KeyboardType.Up&&this.gmId++,a.keyCode==KeyboardType.Down&&this.gmId--,this.gmId=Math.max(0,this.gmId),this.gmId=Math.min(this.gmId,c.length-1);var d=c[c.length-this.gmId-1];this.setInputLabelStr(d)}}},c.prototype.resize=function(){b.prototype.resize.call(this);var a=new Rectangle;a.x=this.w_input_bg.x*UIData.Scale,a.y=this.y+this.w_input_bg.y*UIData.Scale,a.width=this.w_input_bg.width*UIData.Scale,a.height=this.w_input_bg.height*UIData.Scale},c.prototype.butClik=function(b){var c=this;switch(console.log(b.target),b.target){case this.w_send:this.sendCharInfo();break;case this.w_horn_but:ModuleEventManager.dispatchEvent(new a.ChatEvent(a.ChatEvent.HIDE_CHAT_EVENT)),ModuleEventManager.dispatchEvent(new hornui.HornUiEvent(hornui.HornUiEvent.SHOW_HORN_UI_PANEL));break;case this.w_face_but:var d=new faceui.FaceUiEvent(faceui.FaceUiEvent.SHOW_FACE_UI_PANEL);d.data={bfun:function(a){c.faceFunBack(a)}},ModuleEventManager.dispatchEvent(d);break;case this.w_input_bg:1==Scene_data.verticalScene&&console.log("横版本输入"),InputPanel.show(function(a){c.inputBfun(a)},this.chatHtmlText,0,12)}},c.prototype.inputBfun=function(a){this.setInputLabelStr(a)},c.prototype.setInputLabelStr=function(a){this.chatHtmlText=a,console.log(a),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.w_input_ctx.skinName,ColorType.color9a683f+a,16,TextAlign.LEFT)},c.prototype.faceFunBack=function(b){var c=this.chatHtmlText;a.ChatModel.getInstance().sendCharInfo(c+b)},c.prototype.refresh=function(){this.setUiListVisibleByItem(this.uiList,a.ChatModel.showType>0),this.setUiListVisibleByItem([this.w_sys_tips],0==a.ChatModel.showType),Scene_data.verticalScene?this.w_input_ctx.x=17:this.w_input_ctx.x=17,this.resize()},c.prototype.sendCharInfo=function(){var b=this.chatHtmlText;return this.setInputLabelStr(""),b.length?(console.log("频道",a.ChatModel.showType),void a.ChatModel.getInstance().sendCharInfo(b)):void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"无法发送空字符",99)},c.testNum=0,c}(UIVirtualContainer);a.ChatBaseMenu=b}(Chat||(Chat={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Chat;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a._lastMouseY=0,a._lastChatListY=0,a._chatListMove=!1,a.listRect=new Rectangle(0,0,100,100),a.width=UIData.designWidth,a.height=UIData.designHeight,a.top=0,a.left=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/chat/chat.xml","ui/uidata/chat/chat.png",function(){a.loadConfigCom()},"ui/uidata/chat/chatuse.png")},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.w_list_page_bg=this.addEvntBut("w_list_page_bg",this._midRender),this.w_list_page_bg.addEventListener(InteractiveEvent.Up,this.butClik,this),this.w_win_close=this.addEvntButUp("w_win_close",this._bottomRender),this.w_win_close.top=10,this.w_right_gold_line=this.addChild(this._topRender.getComponent("w_right_gold_line")),this.w_right_gold_line.top=0,this.chatBaseMenu=new a.ChatBaseMenu,this.chatBaseMenu.setRender(this._bottomRender,this._midRender,this._topRender),this.addVirtualContainer(this.chatBaseMenu),this.chatBaseLeftMenu=new a.ChatBaseLeftMenu,this.chatBaseLeftMenu.setRender(this._bottomRender,this._midRender,this._topRender),this.addVirtualContainer(this.chatBaseLeftMenu),this.listPanel=new a.ChatListContextComponent,this.listPanel.panelUiAtlas=this._midRender.uiAtlas,this.listPanel.pageBasePos=new Vector2D(90,0),this.listPanel.textScale=1.35,this.listPanel.configUIAtlas(this),this.addRender(this.listPanel),this._listMask=new UIMask,this._listMask.x=0,this._listMask.y=0,this._listMask.width=512,this._listMask.height=100,this.addMask(this._listMask),this.listPanel.mask=this._listMask,this.uiAtlasComplet=!0,this.applyLoadComplete(),this.refresh()},c.prototype.listBgMouseDown=function(a){this._chatListMove=!1,this._lastMouseY=a.y,this._lastChatListY=this.listPanel.pagey,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.onStageMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.onStageUp,this)},c.prototype.onStageMove=function(a){this._chatListMove=!0,this.listPanel.pagey=this._lastChatListY-(a.y-this._lastMouseY)},c.prototype.onStageUp=function(a){this._chatListMove=!1,Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.onStageMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.onStageUp,this),this.listPanel.uptoCtx()},c.prototype.butClik=function(a){switch(a.target){case this.w_win_close:this.close();break;case this.w_list_page_bg:a.type==InteractiveEvent.Up?this._chatListMove||this.listPanel.clikEvent(a):this.listBgMouseDown(a)}},c.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),Engine.needInputTxt=!1},c.prototype.resize=function(){b.prototype.resize.call(this),this.uiAtlasComplet&&(this.listRect.x=80,this.listRect.y=0,this.listRect.width=400,this.listRect.height=Scene_data.stageHeight/UIData.Scale-65,this.w_list_page_bg.x=this.listRect.x,this.w_list_page_bg.y=this.listRect.y,this.w_list_page_bg.width=this.listRect.width,this.w_list_page_bg.height=this.listRect.height,this._listMask.x=this.listRect.x,this._listMask.y=this.listRect.y,this._listMask.width=this.listRect.width,this._listMask.height=this.listRect.height,this._listMask.applyObjData(),this.listPanel.textHeight=this.listRect.height,this._bottomRender.applyObjData(),this._midRender.applyObjData(),this._topRender.applyObjData())},c.prototype.refresh=function(){this.uiAtlasComplet&&this.hasStage&&(this.resize(),this.listPanel.refresh(),this.chatBaseLeftMenu.refresh(),this.chatBaseMenu.refresh())},c}(UIConatiner);a.ChatBasePanel=b}(Chat||(Chat={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Chat;!function(a){var b=function(){function a(){}return a.prototype.testPoint=function(a,b,c){return a>c.x&&a<c.x+c.width&&b>c.y&&b<c.y+c.height?!0:!1},a.prototype.clik=function(a,b){return this.testPoint(a,b,this.headRect)?1:this.testPoint(a,b,this.chatRect)?2:0},a}();a.CellClikBox=b;var c=function(c){function d(){var a=c.call(this)||this;return a.pageBasePos=new Vector2D(0,0),a._textureRect=new Rectangle(0,0,512,1024),a._textScale=1.4,a.textHeight=220,a.baseFontsize=12,a.textFontStr="bolder 22px Georgia",a.lastMcY=0,a.tempH=0,a.totalH=0,a.textTotalHeight1024=0,a}return __extends(d,c),d.prototype.makeChatData=function(a){this.refresh()},d.prototype.configUIAtlas=function(a){this.chatPanel=a,this.uiAtlas=new UIAtlas,this.uiAtlas.configData=new Array,this.uiAtlas.configData.push(this.uiAtlas.getObject("ccav",0,0,512,1024,this._textureRect.width,this._textureRect.height)),this.uiAtlas.ctx=UIManager.getInstance().getContext2D(this._textureRect.width,this._textureRect.height,!1),this.uiAtlas.textureRes=TextureManager.getInstance().getCanvasTexture(this.uiAtlas.ctx),this.uiAtlas.ctx.fillStyle="#ff0000",this.uiAtlas.ctx.fillRect(0,0,512,256),this.uiAtlas.updateCtx(this.uiAtlas.ctx,0,0),this.pageMc=this.creatBaseComponent("ccav"),a.addChild(this.pageMc),this.pageMc.x=0,this.pageMc.y=0,this.pageMc.width=512/this._textScale,this.pageMc.height=1024/this._textScale},d.prototype.resize=function(){c.prototype.resize.call(this),this.pageMc.x=this.pageBasePos.x},Object.defineProperty(d.prototype,"pagey",{get:function(){return this.disRect.y},set:function(a){var b=Math.max(a,0);b=this.totalH>this.disRect.height?Math.min(b,this.totalH-this.disRect.height):0,this.disRect.y=b,this.resetNewPageMcY()},enumerable:!0,configurable:!0}),d.prototype.uptoCtx=function(){this.drawList()},Object.defineProperty(d.prototype,"textScale",{get:function(){return this._textScale},set:function(a){this._textScale=a},enumerable:!0,configurable:!0}),d.prototype.getCharCellRect=function(b){this.uiAtlas.ctx.font=this.textFontStr;var c=new Rectangle,d=TextRegExp.getTextMetrics(this.uiAtlas.ctx,b.contentTxt),e=Math.ceil(d.width/a.ChatModel._textWidth+.01);return 1==e?c.width=d.width+50:c.width=a.ChatModel._textWidth+50,c.height=30*e+20,c},d.prototype.refresh=function(){a.ChatModel.showType==SharedDef.CHAT_TYPE_WHISPER?this._countitem=a.ChatModel.getInstance().getWhisperByGuid():this._countitem=a.ChatModel.getInstance().getChatItemByType(a.ChatModel.showType),this.makeItemRect(this._countitem),this.disRect=new Rectangle(0,0,a.ChatModel._textWidth,this.textHeight*this.textScale),this.mathTempH(),this.totalH>this.disRect.height?this.disRect.y=this.totalH-this.disRect.height:this.disRect.y=0,this.drawList(),this.pagey=1e4,this.resize(),a.ChatModel.showType==SharedDef.CHAT_TYPE_WHISPER&&ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON))},d.prototype.getTestItem=function(b){if(b.length){for(var c=new Array,d=0;50>d;d++){var e=new a.ChatVo;e.s2c_send_chat=b[0].s2c_send_chat,e.isSelf=Math.random()>.5,e.contentTxt="就这样吧，"+d,c.push(e)}return c}return b},d.prototype.mathTempH=function(){this.tempH=(1024-this.disRect.height)/2,this.tempH=this.tempH},d.prototype.drawList=function(){this.clikBoxItem=new Array,this.mathTempH(),this.uiAtlas.ctx.font=this.textFontStr,this.uiAtlas.ctx=UIManager.getInstance().getContext2D(this._textureRect.width,this._textureRect.height,!1),this.uiAtlas.textureRes=TextureManager.getInstance().getCanvasTexture(this.uiAtlas.ctx);for(var b=this.disRect.y,c=0;c<this._countitem.length;c++){var d=this._countitem[c];d.showLast=!0,a.ChatModel.showType==SharedDef.CHAT_TYPE_SYSTEM||(d.isSelf?this.drawChatRightToCtx(d,new Vector2D(40,d.startY-b+this.tempH),d.rect):this.drawChatLeftToCtx(d,new Vector2D(40,d.startY-b+this.tempH),d.rect))}this.lastMcY=this.disRect.y,this.resetNewPageMcY(),this.uiAtlas.updateCtx(this.uiAtlas.ctx,0,0)},d.prototype.resetNewPageMcY=function(){this.pageMc.y=(-(this.disRect.y-this.lastMcY)-this.tempH)/this.textScale,this.pageMc.y+=this.pageBasePos.y},d.prototype.makeItemRect=function(a){for(var b=0,c=0;c<a.length;c++){var d=a[c];this.uiAtlas.ctx.font=this.textFontStr,d.rect||(d.rect=this.getCharCellRect(d),d.startY=b),b=d.startY+d.rect.height+40}this.totalH=b+20},d.prototype.drawStytem=function(b,c,d){var e=new Rectangle(c.x-25,c.y+10,50*this._textScale,22*this._textScale);Math.random()>.5?this.drawImageToCtx("L_system_icon",e):this.drawImageToCtx("L_tip_icon",e);var f=a.ChatModel.writeMultiFaceLineToCtx(this.uiAtlas.ctx,b.contentTxt,23,c.x+70,c.y+10);return 25*f},d.prototype.drawCharBg=function(a,b){void 0===b&&(b=!0);var c=new Rectangle(0,0,10,10),d=this.panelUiAtlas.getRec("Chat_txt_bg"),e=1*this._textScale,f=this.uiAtlas.ctx;f.drawImage(this.panelUiAtlas.useImg,d.pixelX,d.pixelY,c.width,c.height,a.x,a.y,c.width*e,c.height*e),f.drawImage(this.panelUiAtlas.useImg,d.pixelX,d.pixelY+c.height,c.width,d.pixelHeight-2*c.height,a.x,a.y+c.height*e,c.width*e,a.height-c.height*e*2),f.drawImage(this.panelUiAtlas.useImg,d.pixelX,d.pixelY+d.pixelHeight-c.height,c.width,c.height,a.x,a.y+a.height-c.height*e,c.width*e,c.height*e),f.drawImage(this.panelUiAtlas.useImg,d.pixelX+c.width,d.pixelY,d.pixelWitdh-2*c.width,c.height,a.x+c.height*e,a.y,a.width-c.width*e*2,c.height*e),f.drawImage(this.panelUiAtlas.useImg,d.pixelX+c.width,d.pixelY+d.pixelHeight-c.height,d.pixelWitdh-2*c.width,c.height,a.x+c.height*e,a.y+a.height-c.height*e,a.width-c.width*e*2,c.height*e),f.drawImage(this.panelUiAtlas.useImg,d.pixelX+d.pixelWitdh-c.width,d.pixelY,c.width,c.height,a.x+a.width-c.width*e,a.y,c.width*e,c.height*e),f.drawImage(this.panelUiAtlas.useImg,d.pixelX+d.pixelWitdh-c.width,d.pixelY+c.width,c.width,d.pixelHeight-2*c.height,a.x+a.width-c.width*e,a.y+c.height*e,c.width*e,a.height-c.height*e*2),f.drawImage(this.panelUiAtlas.useImg,d.pixelX+d.pixelWitdh-c.width,d.pixelY+d.pixelHeight-c.height,c.width,c.height,a.x+a.width-c.width*e,a.y+a.height-c.height*e,c.width*e,c.height*e),f.drawImage(this.panelUiAtlas.useImg,d.pixelX+c.width,d.pixelY+c.height,d.pixelWitdh-2*c.width,d.pixelHeight-2*c.height,a.x+c.width*e,a.y+c.height*e,a.width-c.width*e*2,a.height-c.height*e*2);var g=this.panelUiAtlas.getRec(b?"Chat_left":"Chat_right");b?this.uiAtlas.ctx.drawImage(this.panelUiAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,a.x-6*e,a.y+10*e,g.pixelWitdh*e,g.pixelHeight*e):this.uiAtlas.ctx.drawImage(this.panelUiAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,a.x+a.width-5*e,a.y+10*e,g.pixelWitdh*e,g.pixelHeight*e)},d.prototype.outCtx=function(a,b){return a>=1024-b-40?!0:0>a?!0:!1},d.prototype.getHeadBgSize=function(){return 68},d.prototype.drawChatLeftToCtx=function(b,c,d){if(!this.outCtx(c.y,d.height)){var e=a.ChatModel.getTextHeight(this.uiAtlas.ctx,b.contentTxt,23,c.x+70,c.y+40);d.height=30*e+20;var f=new Rectangle(c.x-38,c.y+30,this.getHeadBgSize(),this.getHeadBgSize()),g=new Rectangle(c.x+50,c.y+30,d.width,d.height);this.drawCharBg(g,!0),this.drawImageToCtx("Chat_head_round",f),UiDraw.cxtDrawImg(this.uiAtlas.ctx,PuiData.SKILL_LEV_BG,new Rectangle(20,c.y+84,53,18),UIData.publicUi),LabelTextFont.writeSingleLabelToCtxSetAnchor(this.uiAtlas.ctx,ColorType.Whitefff4d6+String(b.s2c_send_chat.lvl),18,48,c.y+80,TextAlign.CENTER,ColorType.Whitefff4d6,ColorType.colord27262e),a.ChatModel.writeMultiFaceLineToCtx(this.uiAtlas.ctx,ColorType.Brown7a2f21+b.contentTxt,23,c.x+70,c.y+40);var h=getBaseName(b.s2c_send_chat.name);LabelTextFont.writeSingleLabelToCtx(this.uiAtlas.ctx,"[2a3553]"+h,22,c.x+65,c.y+5,TextAlign.LEFT),this.addClikBox(b,f,g);var i=this.uiAtlas.ctx.measureText(h),j=new Rectangle(c.x+70+i.width+10,c.y+2,71*.8,28);b.s2c_send_chat.vip>0&&this.drawImageToCtx("Vip_"+String(b.s2c_send_chat.vip),j)}},d.prototype.drawChatRightToCtx=function(b,c,d){if(!this.outCtx(c.y,d.height)){var e=420,f=a.ChatModel.getTextHeight(this.uiAtlas.ctx,b.contentTxt,23,e-d.width+10,c.y+35);d.height=30*f+20;var g=new Rectangle(e+15,c.y+30,this.getHeadBgSize(),this.getHeadBgSize()),h=new Rectangle(e-d.width,c.y+25,d.width,d.height);this.drawCharBg(h,!1),this.drawImageToCtx("Chat_head_round",g),UiDraw.cxtDrawImg(this.uiAtlas.ctx,PuiData.SKILL_LEV_BG,new Rectangle(455,c.y+86,53,18),UIData.publicUi),LabelTextFont.writeSingleLabelToCtxSetAnchor(this.uiAtlas.ctx,ColorType.Whitefff4d6+String(GuidData.player.getLevel()),18,482,c.y+83,TextAlign.CENTER,ColorType.Whitefff4d6,ColorType.colord27262e),a.ChatModel.writeMultiFaceLineToCtx(this.uiAtlas.ctx,ColorType.Brown7a2f21+b.contentTxt,23,e-d.width+10,c.y+35),this.addClikBox(b,new Rectangle,h)}},d.prototype.addClikBox=function(a,c,d){var e=new b;e.headRect=c,e.chatRect=d,e.chatVo=a,this.clikBoxItem.push(e)},d.prototype.drawImageToCtx=function(a,b){var c=this.panelUiAtlas.getRec(a);this.uiAtlas.ctx.drawImage(this.panelUiAtlas.useImg,c.pixelX,c.pixelY,c.pixelWitdh,c.pixelHeight,b.x,b.y,b.width,b.height)},d.prototype.clikEvent=function(b){var c=this,d=new Vector2D(b.x/UIData.Scale-this.pageMc.x,b.y/UIData.Scale-this.pageMc.y);d.scaleBy(this._textScale);for(var e=0;e<this.clikBoxItem.length;e++){var f=this.clikBoxItem[e].clik(d.x,d.y);if(f)if(this.clikChatVo=this.clikBoxItem[e].chatVo,this.clikChatVo.jasonlink){var g=this.clikChatVo.jasonlink;GuidData.map.getMapID()==g.M?quest.QuestModel.getInstance().toplay(new Vector2D(g.X,g.Y)):(GameInstance.questMoveVo=new QuestMoveVo,GameInstance.questMoveVo.pos=new Vector2D(g.X,g.Y),bottomui.Progress_line.getInstance().show(1e3,function(){NetManager.getInstance().protocolos.teleport_map(g.M,GuidData.map.getLineID())})),ModuleEventManager.dispatchEvent(new a.ChatEvent(a.ChatEvent.HIDE_CHAT_EVENT))}else{var h=new SListItemData;h.data=new Object,2==f&&(h.data.items=[11]),1==f&&(h.data.items=a.ChatModel.getInstance().getPopMenuItemByGuid(this.clikChatVo.s2c_send_chat)),PopMenuUtil.show(h,function(a){c.popBackFun(a)},b.x,b.y)}}},d.prototype.popBackFun=function(a){switch(a){case 11:console.log(this.clikChatVo.contentTxt);break;case 1:NetManager.getInstance().protocolos.send_faction_invite(this.clikChatVo.s2c_send_chat.guid),console.log("邀请，",this.clikChatVo.s2c_send_chat.guid,"加入家族");break;case 6:NetManager.getInstance().protocolos.block_chat(this.clikChatVo.s2c_send_chat.guid),msgtip.MsgTipManager.outStrById(22,38);break;case 7:NetManager.getInstance().protocolos.social_add_friend(this.clikChatVo.s2c_send_chat.guid);break;case 8:console.log("---milao"),ModulePageManager.openPanel(SharedDef.MODULE_CHATPERSON,this.clikChatVo.s2c_send_chat.guid)}},d.prototype.addFriend=function(){},d.prototype.testPoint=function(a,b,c){return a>c.x&&a<c.x+c.width&&b>c.y&&b<c.y+c.height?!0:!1},d}(UIRenderComponent);a.ChatListContextComponent=c}(Chat||(Chat={}));var FaceFontLabel=function(){function a(){}return a.writeMultiFaceLineToCtx=function(a,b,c,d,e,f,g,h){void 0===c&&(c=12),void 0===d&&(d=0),void 0===e&&(e=0),void 0===g&&(g=0),void 0===h&&(h="[]");TextRegExp.getTextMetrics(a,b);return this.wrapFaceText(a,b,c,h,d,e,f,c+g)},a.getTextHeight=function(a,b,c,d){void 0===c&&(c=12);TextRegExp.getTextMetrics(a,b);return this.wrapFaceText(a,b,c,"[]",0,0,d,c+Math.ceil(c/10),!1)},a.getNextWords=function(a,b){var c=-1;if("/"==a[b]&&a.length>b+2)for(var d=a[b+0]+a[b+1]+a[b+2],e=0;e<UIData.faceItem.length;e++)if(UIData.faceItem[e]==d)return e+1;return c},a.getFaceTxtStrLen=function(a){var b=0;TextRegExp.pushStr(a);for(var c=0;c<a.length;c++)if(!TextRegExp.isColor(c,null)){var d=this.getNextWords(a,c);b+=-1==d?1:2}return b},a.wrapFaceText=function(a,b,c,d,e,f,g,h,i){void 0===c&&(c=12),void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=500),void 0===h&&(h=10),void 0===i&&(i=!0),d&&(TextRegExp.defaultColor=d,a.fillStyle=TextRegExp.defaultColor),a.strokeStyle="#222222",a.lineWidth=4,TextRegExp.pushStr(b);for(var j=b,k="",l=0,m=1,n=0;n<j.length;n++)if(!TextRegExp.isColor(n,a)){var o=a.measureText(k.replace("\n","")),p=this.getNextWords(j,n);if(-1==p)o.width>g||"\n"==j[n]?(l+=h,k="","\n"!=j[n]&&i&&(a.strokeText(j[n],e,f+l),a.fillText(j[n],e,f+l)),m++):i&&(a.strokeText(j[n],e+1*o.width,f+l),a.fillText(j[n],e+1*o.width,f+l)),k+=j[n];else{var q=1.4*c,r=new Rectangle(e+1*o.width+0,f+l-q/10,q,q);o.width>g&&(l+=h,k="",m++,r=new Rectangle(e+0,f+l-q/10,q,q)),
this.drawFaceIcon(a,r,p),n+=2,k+="脸1"}}return m},a.drawFaceIcon=function(a,b,c){UiDraw.cxtDrawImg(a,"F_FACE_"+c,b,UIData.publicUi)},a}(),Chat;!function(a){var b=function(){function a(){}return a}();a.WhisperToVo=b;var c=function(){function a(){}return a}();a.CharUiVo=c;var d=function(){function a(){}return a.talkToNpc=function(a,b){console.log("talk",a,b);for(var c=0;c<GameInstance.roleList.length;c++)if(GameInstance.roleList[c].unit.getEntry()==a)return console.log("发送",GameInstance.roleList[c].unit.getUintGuid(),b),void NetManager.getInstance().protocolos.talk_with_npc(GameInstance.roleList[c].unit.getUintGuid(),b)},a.sendStr=function(b){var c=b.split(" ");if(c.length){var d=0;switch(c.length>1&&(d=Number(c[1])),c[0]){case"#raise":NetManager.getInstance().protocolos.raise_base_spell(SharedDef.RAISE_BASE_SKILL,d),console.log("send raise=>"+d);break;case"#upgrade":NetManager.getInstance().protocolos.upgrade_anger_spell(d),console.log("send upgrade=>"+d);break;case"#RMount":NetManager.getInstance().protocolos.raise_mount(),console.log("send raise_mount=>");break;case"#UMount":NetManager.getInstance().protocolos.upgrade_mount(0),console.log("send upgrade_mount=>");break;case"#Talk":case"#talk":a.talkToNpc(Number(c[1]),Number(c[2]));break;case"#UMounts":NetManager.getInstance().protocolos.upgrade_mount_one_step(0),console.log("send upgrade_mount_one_step=>");break;case"#IlluActive":NetManager.getInstance().protocolos.illusion_mount_active(d),console.log("send illusion_mount_active=>"+d);break;case"#Illu":NetManager.getInstance().protocolos.illusion_mount(d),console.log("send Illu=>"+d);break;case"#Ride":NetManager.getInstance().protocolos.upgrade_anger_spell(d),console.log("send upgrade_anger_spell=>"+d);break;case"#a":NetManager.getInstance().protocolos.upgrade_anger_spell(d),console.log("send upgrade=>"+d);break;case"#submitDaily":NetManager.getInstance().protocolos.submit_quest_daily2(),console.log("send upgrade=>#submitDaily");break;case"#evi":NetManager.getInstance().protocolos.enter_vip_instance(d,1),console.log("send enter_vip_instance=>"+d);break;case"#CL":NetManager.getInstance().protocolos.change_line(d),console.log("#CL lineNo>"+d);break;case"#doujiantai":NetManager.getInstance().protocolos.doujiantai_fight(d),console.log("#doujiantai>"+d);break;case"#r":Scene_data.gameAngle=Number(d);break;case"#200":NetManager.getInstance().protocolos.use_broadcast_gameobject(d),console.log("#200",d);break;case"#move":var c=b.split(" "),e=new Vector2D(Number(c[1]),Number(c[2]));GameInstance.mainChar.moveToPos2D=e;break;case"#add":var c=b.split(" ");console.log("12#add",Number(c[1]),Number(c[2]));break;case"#全民boss":var c=b.split(" ");NetManager.getInstance().protocolos.try_mass_boss(Number(c[1])),console.log("#全民boss",Number(c[1]));break;case"#组队副本":var c=b.split(" ");NetManager.getInstance().protocolos.group_instance_match(Number(c[1])),console.log("#组队副本",Number(c[1]));break;case"#经脉":console.log("#经脉",Number(c[1])),NetManager.getInstance().protocolos.meridian_practise();break;case"#经脉经验":console.log("#经脉经验",Number(c[1])),NetManager.getInstance().protocolos.add_meridian_exp(Number(c[1]));break;case"#排位赛":console.log("#排位赛",Number(c[1])),NetManager.getInstance().protocolos.match_single_pvp();break;case"#改名":console.log("#改名",String(c[1])),NetManager.getInstance().protocolos.rename(String(c[1]));break;default:console.log("没有对应消息")}}},a}();a.SendSeverCmd=d;var e=function(){function a(){}return a}();a.ChatLinkJasonVo=e;var f=function(){function a(){}return a.prototype.makeJasonStr=function(){this.contentTxt=this.toJasonStr(this.s2c_send_chat.content);var a="[]";switch(this.s2c_send_chat.channel){case SharedDef.CHAT_TYPE_SYSTEM:a="[]";break;case SharedDef.CHAT_TYPE_WORLD:break;case SharedDef.CHAT_TYPE_FACTION:break;case SharedDef.CHAT_TYPE_CURRENT:break;case SharedDef.CHAT_TYPE_HORM:break;case SharedDef.CHAT_TYPE_GROUP:break;case SharedDef.CHAT_TYPE_WHISPER:}},a.prototype.toJasonStr=function(a){var b=new Array;console.log("解析toJasonStr",a);for(var c=new Array,d=0;d<a.length;d++)if("{"==a.charAt(d))c.push(d);else if("}"==a.charAt(d)&&c.length>0){var f=c.pop(),g=d-f+1,h=a.substr(f,g);try{var i=JSON.parse(h);if(this.needChangeStr(i)){var j=Number(i.T);if(j==SharedDef.TEXT_TYPE_POSITION){var k="<{NAME}({X},{Y})>",l=tb.TB_map.getTB_map(Number(i.M));k=k.replace("{NAME}",l.name),k=k.replace("{X}",i.X),k=k.replace("{Y}",i.Y),k="[00ff00]"+k+"[]",b.push({obj:i,replace:k,st:f,ed:d+1}),this.jasonlink=new e,this.jasonlink.T=i.T,this.jasonlink.M=i.M,this.jasonlink.L=i.L,this.jasonlink.X=i.X,this.jasonlink.Y=i.Y}}}catch(m){return console.log(m),a}}for(var n="",o=0,p=0;p<b.length;++p){var q=b[p].st,r=q-o;q>o&&(n+=a.substr(o,r)),n+=b[p].replace,o=b[p].ed}return o<a.length&&(n+=a.substr(o,a.length-o)),""==n&&(n=a),n},a.prototype.needChangeStr=function(a){if(!a.T)return!1;var b=Number(a.T);return b!=SharedDef.TEXT_TYPE_POSITION?!1:isNaN(a.M)||isNaN(a.L)||isNaN(a.X)||isNaN(a.Y)?!1:!0},a}();a.ChatVo=f;var g=function(){function a(){this.chatItem=new Array,this.chatTypeDic=new Object,this.nameItem=["潘佳治","欧阳拿来","得宜","色","dse52","乖巧","不得了"]}return a.toWhisper=function(c,d){a.showType=SharedDef.CHAT_TYPE_WHISPER,a.whisperGuid=new b,a.whisperGuid.name=c,a.whisperGuid.guid=d,ModulePageManager.openPanel(SharedDef.MODULE_CHATPERSON,d)},Object.defineProperty(a,"showType",{get:function(){return this._showType},set:function(a){this._showType=a},enumerable:!0,configurable:!0}),a.prototype.makeBaseChatHositry=function(){for(var a=0;20>a;a++)this.addBaseHositryByType(SharedDef.CHAT_TYPE_SYSTEM),this.addBaseHositryByType(SharedDef.CHAT_TYPE_WORLD),this.addBaseHositryByType(SharedDef.CHAT_TYPE_FACTION),this.addBaseHositryByType(SharedDef.CHAT_TYPE_CURRENT),this.addBaseHositryByType(SharedDef.CHAT_TYPE_HORM),this.addBaseHositryByType(SharedDef.CHAT_TYPE_GROUP);for(var a=0;5>a;a++)this.addBaseHositryByType(SharedDef.CHAT_TYPE_WHISPER)},a.prototype.addBaseHositryByType=function(a){var b=this.getTempVo();b.s2c_send_chat.channel=a,b.s2c_send_chat.guid=b.s2c_send_chat.name,b.s2c_send_chat.lvl=random(99),b.s2c_send_chat.vip=random(15),this.chatItem.push(b),SharedDef.CHAT_TYPE_SYSTEM==a&&Math.random()>.5?b.s2c_send_chat.content="[000000]恭喜[ff0000]玩家名字[000000]获得神器[00ff00]霸王枪":b.s2c_send_chat.content="[000000]"+b.s2c_send_chat.content,b.makeJasonStr()},a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getLastThreeChatVo=function(){for(var a=new Array,b=this.chatItem.length-1;b>=0&&a.length<3;b--){var c=this.chatItem[b].s2c_send_chat;(c.channel==SharedDef.CHAT_TYPE_WORLD||c.channel==SharedDef.CHAT_TYPE_FACTION||c.channel==SharedDef.CHAT_TYPE_CURRENT)&&a.push(this.chatItem[b])}console.log(a);for(var d=new Array,b=0;b<a.length;b++)d.push(a[a.length-b-1]);return d},a.prototype.pushNewMes=function(b){for(var c=a.getInstance().getChatBlockItem(!1),d=0;d<c.length;d++)if(c[d].guid==b.guid)return void console.log("已被屏蔽");var e=new f;e.s2c_send_chat=b,e.s2c_send_chat.guid==GuidData.player.getGuid()?e.isSelf=!0:e.isSelf=!1,e.makeJasonStr();var g=GameInstance.getServerNow();e.time=TimeUtil.getLocalTime2(g),this.chatItem.push(e)},a.prototype.getHaveNewChatInfo=function(){for(var a=0;a<this.chatItem.length;a++){var b=this.chatItem[a];if(!b.showLast&&b.s2c_send_chat.channel==SharedDef.CHAT_TYPE_WHISPER)return!0}return!1},a.prototype.getChatItemByType=function(a){for(var b=new Array,c=0;c<this.chatItem.length;c++)this.chatItem[c].s2c_send_chat.channel==a&&b.push(this.chatItem[c]);return b},a.prototype.getChatItemByToGuid=function(a){for(var b=new Array,c=this.getChatItemByType(SharedDef.CHAT_TYPE_WHISPER),d=GuidData.player.getGuid(),e=0;e<c.length;e++)c[e].s2c_send_chat.guid==a&&c[e].s2c_send_chat.to_guid==d&&(c[e].showLast=!0,b.push(c[e])),c[e].s2c_send_chat.guid==d&&c[e].s2c_send_chat.to_guid==a&&(c[e].showLast=!0,b.push(c[e]));return b},a.prototype.getChatNameByGuid=function(a){for(var b=0;b<this.chatItem.length;b++)if(this.chatItem[b].s2c_send_chat.guid==a)return this.chatItem[b].s2c_send_chat.name;return"没找到"},a.prototype.getWhisperByGuid=function(){for(var b=new Array,c=this.getChatItemByType(SharedDef.CHAT_TYPE_WHISPER),d=0;d<c.length;d++)a.whisperGuid&&(c[d].s2c_send_chat.guid==a.whisperGuid.guid||c[d].s2c_send_chat.to_guid==a.whisperGuid.guid)&&b.push(c[d]);return b},a.prototype.getTempVo=function(){var a=new f;a.s2c_send_chat=new s2c_send_chat,a.s2c_send_chat.name=randomByItem(this.nameItem),a.s2c_send_chat.name="A,B,"+a.s2c_send_chat.name,a.s2c_send_chat.content="";for(var b=random(50)+5,c="中共第中央委员会第六次全会公报",d=0;b>d;d++)a.s2c_send_chat.content+=c.substr(random(c.length-1),1),Math.random()>.9&&(a.s2c_send_chat.content+="/脸i");return Math.random()>.5?(a.s2c_send_chat.guid=GuidData.player.getGuid(),a.isSelf=!0):a.isSelf=!1,a},a.prototype.sendCharInfo=function(b){if(b.length){var c=b.search("#");if(-1==c){var e=a.showType;b=b.replace("[位置]","{T=1}"),a.showType==SharedDef.CHAT_TYPE_WHISPER?NetManager.getInstance().protocolos.chat_whisper(a.whisperGuid.guid,b):NetManager.getInstance().protocolos.chat_by_channel(e,b),console.log("发送编码",b)}else d.sendStr(b);GameStart.GM&&this.saveChatStr(b)}},a.prototype.saveChatStr=function(a){var b=localStorage.getItem("GMITEM"),c=new Array;b&&(c=JSON.parse(b),c.length>5&&c.shift());for(var d=0;d<c.length;d++)if(c[d]==a){c.splice(d,1);break}c.push(a),localStorage.setItem("GMITEM",JSON.stringify(c))},a.prototype.sendToChar=function(a){for(var b,c=GameInstance.roleList,d=1e5,e=0;c&&e<c.length;e++){var f=c[e];if(f.unit.isPlayer()&&!f.unit.isMain){var g=GameInstance.mainChar.math_distance(f);d>g&&(d=g,b=f)}}b&&(console.log(b.unit.getName(),b.unit.getPlayerGUID(),a),NetManager.getInstance().protocolos.chat_whisper(b.unit.getPlayerGUID(),a))},a.prototype.ismyfriends=function(a){for(var b=GuidData.social.getFriendList(),c=0;c<b.length;c++)if(b[c].guid==a)return!0;return!1},a.prototype.getPopMenuItemByGuid=function(a){var b=new Array;return this.ismyfriends(a.guid)?b.push(8):b.push(7),b.push(0),GuidData.player.getFactionID()&&!Boolean(a.faction_guid)&&b.push(1),!this.getBlockByGuid(a.guid),b},a.prototype.getBlockByGuid=function(b){for(var c=a.getInstance().getChatBlockItem(),d=0;d<c.length;d++)if(c[d].guid==b)return console.log("已被屏蔽"),!0;return!1},a.prototype.getChatBlockItem=function(a){if(void 0===a&&(a=!0),!a&&this.blockItem)return this.blockItem;this.blockItem||(this.blockItem=new Array),this.blockItem.length=0;for(var b=GuidData.player.getPlayChatBlock(),c=0;c<b.length;c++)if(b[c]){var d=b[c].split("|"),e=new h;e.gender=Number(d[0]),e.level=Number(d[1]),e.name=String(d[2]),e.vip=Number(d[3]),e.factionName=String(d[4]),e.guid=String(d[5]),e.indx=c,console.log(e.indx),this.blockItem.push(e)}return this.blockItem},a.writeMultiFaceLineToCtx=function(b,c,d,e,f){void 0===d&&(d=12),void 0===e&&(e=0),void 0===f&&(f=0),b.font="bolder  "+d+"px "+UIData.font;TextRegExp.getTextMetrics(b,c);return this.wrapFaceText(b,c,"[]",e,f,a._textWidth,d+5)},a.getTextHeight=function(b,c,d,e,f){void 0===d&&(d=12),void 0===e&&(e=0),void 0===f&&(f=0),b.font="bolder  "+d+"px "+UIData.font;TextRegExp.getTextMetrics(b,c);return this.wrapFaceText(b,c,"[]",e,f,a._textWidth,d+5,!1)},a.getNextWords=function(a,b){var c=-1;if("/"==a[b]&&a.length>b+2)for(var d=a[b+0]+a[b+1]+a[b+2],e=0;e<UIData.faceItem.length;e++)if(UIData.faceItem[e]==d)return e+1;return c},a.wrapFaceText=function(a,b,c,d,e,f,g,h){void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=500),void 0===g&&(g=10),void 0===h&&(h=!0),TextRegExp.pushStr(b);for(var i=b,j="",k=0,l=1,m=0;m<i.length;m++)if(!TextRegExp.isColor(m,a)){var n=a.measureText(j.replace("\n","")),o=this.getNextWords(i,m);if(-1==o)n.width>f||"\n"==i[m]?(k+=g,j="","\n"!=i[m]&&h&&a.fillText(i[m],d,e+k),l++):h&&a.fillText(i[m],d+1*n.width,e+k),j+=i[m];else{var p=new Rectangle(d+1*n.width+0,e+k-5,35,35);n.width>f&&(k+=g,j="",l++,p=new Rectangle(d+0,e+k-5,35,35)),h&&this.drawFaceIcon(a,p,o),m+=2,j+="大1"}}return l},a.drawFaceIcon=function(a,b,c){UiDraw.cxtDrawImg(a,"F_FACE_"+c,b,UIData.publicUi)},a.uiHeight=60,a._showType=1,a._textWidth=360,a}();a.ChatModel=g;var h=function(){function a(){}return a}();a.BlockVo=h}(Chat||(Chat={}));var email;!function(a){var b=function(){function a(){}return a}();a.EmailVo=b;var c=function(){function a(){this._emailItem=new Array,this.lastGetEmailTipTime=0}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getEmailArr=function(){this._emailItem.length=0;for(var a=GuidData.giftPacks.getGiftDataItem(),c=0;c<a.length;c++){var d=new b;d.giftBaseVo=a[c],this._emailItem.push(d)}return this._emailItem},a.prototype.getHaveNewEmailInfo=function(){this.getEmailArr();var a=GameInstance.getServerNow();this.lastGetEmailTipTime||(this.lastGetEmailTipTime=GameInstance.getServerNow());for(var b=(new Date(1e3*a),0);b<this._emailItem.length;b++){var c=this._emailItem[b];if(0==c.giftBaseVo.isRead){new Date(1e3*c.giftBaseVo.startTime);if(c.giftBaseVo.startTime>this.lastGetEmailTipTime)return!0}}return!1},a.prototype.getEmailVoByIdex=function(a){for(var b=0;b<this._emailItem.length;b++)if(this._emailItem[b].giftBaseVo.indx==a)return this._emailItem[b];return null},a.prototype.i_dele_read_clik=function(){for(var a=!1,b=0;b<this._emailItem.length;b++)this._emailItem[b].giftBaseVo.isRead&&!this._emailItem[b].giftBaseVo.item&&(a=!0);a&&NetManager.getInstance().protocolos.remove_mail_one_step()},a.prototype.i_get_item_clik=function(){NetManager.getInstance().protocolos.pick_mail_one_step()},a}();a.EmailModel=c}(email||(email={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Chat;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_CHAT_EVENT="SHOW_CHAT_EVENT",b.HIDE_CHAT_EVENT="HIDE_CHAT_EVENT",b.CHAT_INFO_TO_PANEL="CHAT_INFO_TO_PANEL",b.REFRESH_EMAIL_LIST="REFRESH_EMAIL_LIST",b}(BaseEvent);a.ChatEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"ChatModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.ChatModule=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"ChatProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof mainUi.MainUiEvent&&this._chatBasePanel&&this._chatBasePanel.close(),a instanceof b){var c=a;c.type==b.SHOW_CHAT_EVENT&&this.showBasePanel(),c.type==b.HIDE_CHAT_EVENT&&this._chatBasePanel&&this._chatBasePanel.close(),c.type==b.CHAT_INFO_TO_PANEL&&this._chatBasePanel&&this._chatBasePanel.refresh()}},d.prototype.showBasePanel=function(){var b=this;this._chatBasePanel||(this._chatBasePanel=new a.ChatBasePanel),this._chatBasePanel.load(function(){UIManager.getInstance().addUIContainer(b._chatBasePanel),b._chatBasePanel.refresh()})},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_CHAT_EVENT),new b(b.HIDE_CHAT_EVENT),new b(b.CHAT_INFO_TO_PANEL),new b(b.REFRESH_EMAIL_LIST),new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)]},d}(BaseProcessor);a.ChatProcessor=d}(Chat||(Chat={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),hornui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._msgTxt="请输入文字..",b.uiAtlasComplet=!1,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._topRender.uiAtlas.setInfo("ui/uidata/chat/horn/horn.xml","ui/uidata/chat/horn/horn.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas,this._bottomRender.applyObjData(),this._midRender.applyObjData(),this.a_input_bg=this.addEvntBut("a_input_bg",this._bottomRender),this.addEvntBut("a_tittle",this._topRender),this.addEvntBut("a_label",this._topRender),this.a_addhorn=this.addEvntBut("a_addhorn",this._topRender),this.a_face=this.addEvntBut("a_face",this._topRender),this.a_send=this.addEvntBut("a_send",this._topRender),this.a_input_txt=this.addEvntBut("a_input_txt",this._topRender),this.a_horn_num=this.addChild(this._topRender.getComponent("a_horn_num")),this.uiAtlasComplet=!0,this.applyLoadComplete(),this.refresh()},b.prototype.butClik=function(a){var b=this;switch(a.target){case this.c_close:this.close();break;case this.a_input_bg:case this.a_input_txt:-1!=this._msgTxt.search("请输入文字")&&(this._msgTxt=""),InputPanel.show(function(a){b.inputBfun(a)},this._msgTxt);break;case this.a_face:var c=new faceui.FaceUiEvent(faceui.FaceUiEvent.SHOW_FACE_UI_PANEL);c.data={bfun:function(a){b.addFaceText(a)},bottom:(Scene_data.stageHeight-a.y-30)/UIData.Scale,left:(Scene_data.stageWidth/UIData.Scale-450)/2},ModuleEventManager.dispatchEvent(c);break;case this.a_send:console.log("发送喇叭=》",this._msgTxt),NetManager.getInstance().protocolos.chat_by_channel(SharedDef.CHAT_TYPE_HORM,this._msgTxt),this._msgTxt="",this.refresh()}},b.prototype.addFaceText=function(a){this._msgTxt=this._msgTxt+a,this.refresh()},b.prototype.refresh=function(){this.uiAtlasComplet&&(this.drawDescTxt(this._msgTxt),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_horn_num.skinName,ColorType.Green2ca937+"99",16))},b.prototype.inputBfun=function(a){this._msgTxt=a,this.refresh()},b.prototype.drawDescTxt=function(a){var c=this._topRender.uiAtlas.getRec(this.a_input_txt.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);b.writeMultiFaceLineToCtx(d,ColorType.Brown7a2f21+a,16,0,0),this._topRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},b.writeMultiFaceLineToCtx=function(a,b,c,d,e){void 0===c&&(c=12),void 0===d&&(d=0),void 0===e&&(e=0),a.font="bolder  "+c+"px "+UIData.font;TextRegExp.getTextMetrics(a,b);return this.wrapFaceText(a,b,"[]",d,e,270,c+5)},b.getNextWords=function(a,b){var c=-1;if("/"==a[b]&&a.length>b+2)for(var d=a[b+0]+a[b+1]+a[b+2],e=0;e<UIData.faceItem.length;e++)if(UIData.faceItem[e]==d)return e+1;return c},b.wrapFaceText=function(a,b,c,d,e,f,g){void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=500),void 0===g&&(g=10),TextRegExp.pushStr(b);for(var h=b,i="",j=0,k=1,l=0;l<h.length;l++)if(!TextRegExp.isColor(l,a)){var m=a.measureText(i.replace("\n","")),n=this.getNextWords(h,l);if(-1==n)m.width>f||"\n"==h[l]?(j+=g,i="","\n"!=h[l]&&a.fillText(h[l],d,e+j),k++):a.fillText(h[l],d+1*m.width,e+j),i+=h[l];else{var o=new Rectangle(d+1*m.width+0,e+j-3,24,24);m.width>f&&(j+=g,i="",k++,o.x=d,o.y=e+j-3),this.drawFaceIcon(a,o,n),l+=2,i+="大1"}}return k},b.drawFaceIcon=function(a,b,c){UiDraw.cxtDrawImg(a,"F_FACE_"+c,b,UIData.publicUi)},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this)},b}(WindowCentenMin);a.HornUiPanel=b}(hornui||(hornui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),hornui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"HornUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.HornUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_HORN_UI_PANEL="SHOW_HORN_UI_PANEL",b.HIDE_HORN_UI_PANEL="HIDE_HORN_UI_PANEL",b}(BaseEvent);a.HornUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"HornUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_HORN_UI_PANEL&&this.showPanel(),b.type==c.HIDE_HORN_UI_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.hornUiPanel&&UIManager.getInstance().removeUIContainer(this.hornUiPanel)},d.prototype.showPanel=function(){var b=this;this.hornUiPanel||(this.hornUiPanel=new a.HornUiPanel),this.hornUiPanel.load(function(){UIManager.getInstance().addUIContainer(b.hornUiPanel)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_HORN_UI_PANEL),new c(c.HIDE_HORN_UI_PANEL)]},d}(BaseProcessor);a.HornUiProcessor=d}(hornui||(hornui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faceui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=450,a.height=280,a.bottom=0,a.left=0,a._bootomRender=new UIRenderComponent,a.addRender(a._bootomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._faceRender=new UIRenderComponent,a.addRender(a._faceRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/chat/face/face.xml","ui/uidata/chat/face/face.png",function(){a.loadConfigCom()})},c.prototype.setSizeForPanelUi=function(a,b){var c=this._midRender.getComponent(b);a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height},c.prototype.loadConfigCom=function(){this._bootomRender.uiAtlas=GameData.publicbgUiAtlas,this._faceRender.uiAtlas=this._midRender.uiAtlas,this.a_bg=this.addEvntBut("a_bg",this._midRender);for(var a=new Vector2D(30,20),b=0;16>b;b++){var c=this.addEvntBut("a_face_icon",this._faceRender);c.x=b%6*68+a.x,c.y=58*Math.floor(b/6)+a.y,c.width=50,c.height=50,c.goToAndStop(b),c.data=b,this.drawFaceIconToCtx(c,b)}this.applyLoadComplete()},c.prototype.butClik=function(a){switch(a.target){default:a.target.data&&(this.close(),this.selectFaceType(a.target.data))}},c.prototype.selectFaceType=function(a){this.close();var b=UIData.faceItem[a];this.bfun&&this.bfun(b)},c.prototype.close=function(){ModuleEventManager.dispatchEvent(new a.FaceUiEvent(a.FaceUiEvent.HIDE_FACE_UI_PANEL))},c.prototype.drawFaceIconToCtx=function(a,b){var c=a.getSkinCtxRect(),d=UIManager.getInstance().getContext2D(c.width,c.height,!1);UiDraw.cxtDrawImg(d,"F_FACE_"+(b+1),new Rectangle(0,0,c.width,c.height),UIData.publicUi),a.drawToCtx(this._midRender.uiAtlas,d)},c}(UIConatiner);a.FaceUiPanel=b}(faceui||(faceui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faceui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"FaceUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.FaceUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_FACE_UI_PANEL="SHOW_FACE_UI_PANEL",b.HIDE_FACE_UI_PANEL="HIDE_FACE_UI_PANEL",b}(BaseEvent);a.FaceUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"FaceUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_FACE_UI_PANEL&&(this.showPanel(),this.faceUiPanel.bfun=b.data.bfun,b.data.left&&(this.faceUiPanel.left=b.data.left),b.data.bottom&&(this.faceUiPanel.bottom=b.data.bottom)),b.type==c.HIDE_FACE_UI_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.faceUiPanel&&UIManager.getInstance().removeUIContainer(this.faceUiPanel)},d.prototype.showPanel=function(){var b=this;this.faceUiPanel||(this.faceUiPanel=new a.FaceUiPanel),this.faceUiPanel.load(function(){UIManager.getInstance().addUIContainer(b.faceUiPanel)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_FACE_UI_PANEL),new c(c.HIDE_FACE_UI_PANEL)]},d}(BaseProcessor);a.FaceUiProcessor=d}(faceui||(faceui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),setingui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.width=500,a.height=350,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a.makePanelUi(b)})},c.prototype.makePanelUi=function(a){var b=this;this._topRender.uiAtlas.setInfo("ui/uidata/chat/seting/seting.xml","ui/uidata/chat/seting/seting.png",function(){b.loadConfigCom()})},c.prototype.setSizeForPanelUi=function(a,b){var c=this._topRender.getComponent(b);a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=GameData.publicbgUiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas;var a=this.addChild(this._bottomRender.getComponent("guiBg0"));this.setSizeForPanelUi(a,"a_bg"),this.b_close=this.addEvntBut("b_close",this._bottomRender),this.setSizeForPanelUi(this.b_close,"a_close");var b=this.addChild(this._bottomRender.getComponent("titleBg"));this.setSizeForPanelUi(b,"a_tittle_bg"),this._bottomRender.applyObjData(),this.addChild(this._midRender.getComponent("a_tittle_txt")),this.addChild(this._midRender.getComponent("a_label2")),this.addChild(this._midRender.getComponent("a_label1")),this.addChild(this._midRender.getComponent("a_label4")),this.addChild(this._midRender.getComponent("a_label3")),this.addChild(this._midRender.getComponent("a_label0")),this.a_select_0=this.addEvntBut("a_select_0",this._midRender),this.a_select_1=this.addEvntBut("a_select_1",this._midRender),this.a_select_2=this.addEvntBut("a_select_2",this._midRender),this.a_select_3=this.addEvntBut("a_select_3",this._midRender),this.a_select_4=this.addEvntBut("a_select_4",this._midRender),this.a_pinbi_but=this.addEvntBut("a_pinbi_but",this._midRender),this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.getData=function(){var a=new ByteArray;return a.endian=Endian.LITTLE_ENDIAN,a.writeUint8(this.a_select_0.selected?0:1),a.writeUint8(this.a_select_1.selected?0:1),a.writeUint8(this.a_select_2.selected?0:1),a.writeUint8(this.a_select_3.selected?0:1),a.writeUint8(this.a_select_4.selected?0:1),a.writeUint8(0),a.writeUint8(0),a.writeUint8(0),a},c.prototype.butClik=function(a){switch(a.target){case this.b_close:this.close();break;case this.a_select_0:case this.a_select_1:case this.a_select_2:case this.a_select_3:case this.a_select_4:var b=this.getData();b.position=0;var c=b.readUint32(),d=b.readUint32();console.log(c,d),NetManager.getInstance().protocolos.msg_decline(c,d);break;case this.a_pinbi_but:this.close(),ModuleEventManager.dispatchEvent(new shieldui.ShieldUiEvent(shieldui.ShieldUiEvent.SHOW_SHIELD_UI_PANEL))}},c.prototype.close=function(){ModuleEventManager.dispatchEvent(new a.SetingUiEvent(a.SetingUiEvent.HIDE_SETING_UI_PANEL))},c.prototype.refresh=function(){if(this.uiAtlasComplet){var a=GuidData.player.getPlayerFieldDeclineChanel();console.log(a),this.a_select_0.selected=0==a[0],this.a_select_1.selected=0==a[1],this.a_select_2.selected=0==a[2],this.a_select_3.selected=0==a[3],this.a_select_4.selected=0==a[4]}},c}(UIConatiner);a.SetingUiPanel=b}(setingui||(setingui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),setingui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"SetingUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.SetingUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_SETING_UI_PANEL="SHOW_SETING_UI_PANEL",b.HIDE_SETING_UI_PANEL="HIDE_SETING_UI_PANEL",b}(BaseEvent);a.SetingUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"SetingUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_SETING_UI_PANEL&&this.showPanel(),b.type==c.HIDE_SETING_UI_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.setingUiPanel&&UIManager.getInstance().removeUIContainer(this.setingUiPanel)},d.prototype.showPanel=function(){var b=this;this.setingUiPanel||(this.setingUiPanel=new a.SetingUiPanel),this.setingUiPanel.load(function(){UIManager.getInstance().addUIContainer(b.setingUiPanel),b.setingUiPanel.refresh()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_SETING_UI_PANEL),new c(c.HIDE_SETING_UI_PANEL)]},d}(BaseProcessor);a.SetingUiProcessor=d}(setingui||(setingui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),shieldui;!function(a){var b=function(){function a(){}return a}();a.BlockVo=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,e,f,g){void 0===g&&(g=null),a.prototype.create.call(this,c,e,f,g);var h=50;this.l_base_color=this.creatSUI(f,b.baseAtlas,"l_base_color",0,0,400,60),this.l_bg=this.creatSUI(f,b.baseAtlas,"l_bg",0,0,d.listWidth600,60),c.addChild(this.l_bg),this.icon=this.creatSUI(f,b.baseAtlas,"Icon",0+h,0,60,60),c.addChild(this.icon),this.l_name=this.creatSUI(f,b.baseAtlas,"l_name",100+h,20,100,16),c.addChild(this.l_name),this.l_factionname=this.creatSUI(f,b.baseAtlas,"l_factionname",270+h,20,100,16),c.addChild(this.l_factionname),this.l_but=this.creatSUI(f,b.baseAtlas,"l_but",425+h,10,67,39),c.addChild(this.l_but),this.l_but.addEventListener(InteractiveEvent.Down,this.butClik,this)},b.prototype.butClik=function(a){if(this.itdata){var b=this.itdata.resdata;console.log("取消",b.indx),NetManager.getInstance().protocolos.cancel_block_chat(b.indx)}},b.prototype.render=function(a){if(this.itdata=a,a){var b=a.resdata;this.drawBg(a.id%2==0),this.setIcon(b),LabelTextFont.writeSingleLabel(this.uiAtlas,this.l_name.skinName,getBaseName(b.name),16,TextAlign.LEFT),b.factionName.length?LabelTextFont.writeSingleLabel(this.uiAtlas,this.l_factionname.skinName,getBaseName(b.factionName),16,TextAlign.LEFT):LabelTextFont.writeSingleLabel(this.uiAtlas,this.l_factionname.skinName,"",16,TextAlign.LEFT),
this.drawBut()}else ArtFont.getInstance().writeFontToSkinName(this.uiAtlas,this.icon.skinName,"",ArtFont.num1),ArtFont.getInstance().writeFontToSkinName(this.uiAtlas,this.l_name.skinName,"",ArtFont.num1),ArtFont.getInstance().writeFontToSkinName(this.uiAtlas,this.l_factionname.skinName,"",ArtFont.num1),ArtFont.getInstance().writeFontToSkinName(this.uiAtlas,this.l_base_color.skinName,"",ArtFont.num1),ArtFont.getInstance().writeFontToSkinName(this.uiAtlas,this.l_but.skinName,"",ArtFont.num1)},b.prototype.drawBg=function(a){var c=this._baseRender.uiAtlas.getRec(this.l_base_color.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),e=b.baseAtlas.getRec(a?"L_bgA":"L_bgB");d.drawImage(b.baseAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,0,c.pixelWitdh,c.pixelHeight),this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},b.prototype.drawBut=function(){var a=this._baseRender.uiAtlas.getRec(this.l_but.skinName),c=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),d=b.baseAtlas.getRec("L_dele_but");c.drawImage(b.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight),this._baseRender.uiAtlas.updateCtx(c,a.pixelX,a.pixelY)},b.prototype.setIcon=function(a){var c=this;IconManager.getInstance().getIcon(getTouPic(a.gender),function(a){var d=c._baseRender.uiAtlas.getRec(c.icon.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.A_BLACK_BASE_66,new Rectangle(0,0,60,60),UIData.publicUi),e.drawImage(a,0,0,82,82,2,2,56,56);b.baseAtlas.getRec("L_dele_but");c._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},b}(SListItem);a.ShieldItemRender=c;var d=function(a){function b(){var b=a.call(this)||this;return b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.init=function(a){c.baseAtlas=a,this.initData()},b.prototype.initData=function(){this._ary=new Array,this.setData(this._ary,c,b.listWidth600,Math.floor(330),0,60,5,512,512,1,7)},b.prototype.refreshNewData=function(a){this._ary.length=0;for(var b=0;b<a.length;b++){var c=new SListItemData;c.resdata=a[b],c.id=b,this._ary.push(c)}this.refreshData(this._ary)},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.listWidth600=600,b}(SList);a.ShieldSList=d;var e=function(a){function c(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=640,b.height=540,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender.uiAtlas=new UIAtlas,b}return __extends(c,a),c.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a.makePanelUi(b)})},c.prototype.makePanelUi=function(a){var b=this;this._topRender.uiAtlas.setInfo("ui/uidata/chat/seting/seting.xml","ui/uidata/chat/seting/seting.png",function(){b.loadConfigCom()},"ui/uidata/chat/seting/setinguse.png")},c.prototype.setSizeForPanelUi=function(a,b){var c=this._topRender.getComponent(b);a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=GameData.publicbgUiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas;var a=this.addChild(this._bottomRender.getComponent("guiBg0"));this.setSizeForPanelUi(a,"b_bg"),this.b_close=this.addEvntBut("b_close",this._bottomRender),this.setSizeForPanelUi(this.b_close,"b_close");var b=this.addChild(this._bottomRender.getComponent("titleBg"));this.setSizeForPanelUi(b,"b_tittle_bg");var c=this.addChild(this._bottomRender.getComponent("guiBg1"));this.setSizeForPanelUi(c,"b_in_bg"),this._bottomRender.applyObjData(),this.addChild(this._topRender.getComponent("b_tittle_txt")),this.addChild(this._topRender.getComponent("b_label2")),this.addChild(this._topRender.getComponent("b_label1")),this.addChild(this._topRender.getComponent("b_label0")),this.addChild(this._topRender.getComponent("b_line")),this.addList(),this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.addList=function(){this._shieldSList||(this._shieldSList=new d),this._shieldSList.init(this._topRender.uiAtlas)},c.prototype.refresh=function(){if(this.uiAtlasComplet){var a=this.getChatBlockItem();this._shieldSList.refreshNewData(a),this._shieldSList.show(),console.log("show")}},c.prototype.getChatBlockItem=function(a){if(void 0===a&&(a=!0),!a&&this.blockItem)return this.blockItem;this.blockItem||(this.blockItem=new Array),this.blockItem.length=0;for(var c=GuidData.player.getPlayChatBlock(),d=0;d<c.length;d++)if(c[d]){var e=c[d].split("|"),f=new b;f.gender=Number(e[0]),f.level=Number(e[1]),f.name=String(e[2]),f.vip=Number(e[3]),f.factionName=String(e[4]),f.guid=String(e[5]),f.indx=d,console.log(f.indx),this.blockItem.push(f)}return this.blockItem},c.prototype.butClik=function(a){switch(a.target){case this.b_close:this.close()}},c.prototype.close=function(){this._shieldSList&&this._shieldSList.hide(),UIManager.getInstance().removeUIContainer(this)},c}(UIConatiner);a.ShieldUiPanel=e}(shieldui||(shieldui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),shieldui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"ShieldUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.ShieldUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_SHIELD_UI_PANEL="SHOW_SHIELD_UI_PANEL",b.HIDE_SHIELD_UI_PANEL="HIDE_SHIELD_UI_PANEL",b.PLAYER_STRING_FIELD_BLOCK="PLAYER_STRING_FIELD_BLOCK",b}(BaseEvent);a.ShieldUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"ShieldUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_SHIELD_UI_PANEL&&this.showPanel(),b.type==c.HIDE_SHIELD_UI_PANEL&&this.hidePanel(),b.type==c.PLAYER_STRING_FIELD_BLOCK&&(console.log("PLAYER_STRING_FIELD_BLOCK"),this.shieldUiPanel&&this.shieldUiPanel.refresh())}},d.prototype.hidePanel=function(){this.shieldUiPanel&&this.shieldUiPanel.close()},d.prototype.showPanel=function(){var b=this;this.shieldUiPanel||(this.shieldUiPanel=new a.ShieldUiPanel),this.shieldUiPanel.load(function(){UIManager.getInstance().addUIContainer(b.shieldUiPanel),b.shieldUiPanel.refresh()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_SHIELD_UI_PANEL),new c(c.HIDE_SHIELD_UI_PANEL),new c(c.PLAYER_STRING_FIELD_BLOCK)]},d}(BaseProcessor);a.ShieldUiProcessor=d}(shieldui||(shieldui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),whisper;!function(a){var b=function(){function a(){}return a}();a.WhisperChatVo=b;var c=function(a){function c(){var b=a.call(this)||this;return b.guid="",b.left=428,b.top=100,b.setShowLevel(6),b}return __extends(c,a),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,332,322,0,87,3,512,256,1,6)},c.prototype.refreshDataByNewData=function(a){this.guid=a;var b=Chat.ChatModel.getInstance().getChatItemByToGuid(a),c=this.getData(b);this.refreshData(c),this.scrollIdx(c.length-1),ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON))},c.prototype.getData=function(a){for(var c=new Array,d=0;d<a.length;d++){var e=new b;e.basevo=a[d],e.items=[11],e.id=d;var f=new SListItemData;f.data=e,c.push(f)}return c},c.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData(a)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(SList);a.whisperChatListPanel=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.BSbg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"BSbg",0,21,332,60,18,18),a.addChild(this.BSbg),this.BSbg.addEventListener(InteractiveEvent.Up,this.equClick,this),this.BSname=this.creatSUI(d,this.parentTarget.baseAtlas,"BSname",8,0,100,20),a.addChild(this.BSname),this.BStime=this.creatSUI(d,this.parentTarget.baseAtlas,"BStime",108,0,100,20),a.addChild(this.BStime),this.BStext=this.creatSUI(d,this.parentTarget.baseAtlas,"BStext",9,32,317,39),a.addChild(this.BStext)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.itdata&&this.applyrender()},enumerable:!0,configurable:!0}),c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data.basevo;LabelTextFont.writeSingleLabel(this.uiAtlas,this.BSname.skinName,getBaseName(a.s2c_send_chat.name),16,TextAlign.LEFT,a.isSelf?ColorType.Green2ca937:ColorType.color4392ff),LabelTextFont.writeSingleLabel(this.uiAtlas,this.BStime.skinName,a.time,16,TextAlign.LEFT,a.isSelf?ColorType.Green2ca937:ColorType.color4392ff),LabelTextFont.writeTextAutoVerticalCenter(this.uiAtlas,this.BStext.skinName,a.contentTxt,16,ColorType.Brown7a2f21,300),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.BSbg.skinName,UIData.publicUi,PuiData.CHATBG)}},c.prototype.setnull=function(){UiDraw.clearUI(this.BSname),UiDraw.clearUI(this.BStime),UiDraw.clearUI(this.BSbg),UiDraw.clearUI(this.BStext)},c.prototype.equClick=function(a){var b=this;if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;this.setSelect(),PopMenuUtil.show(this.itdata,function(a){b.popBackFun(a)},a.x,a.y)}},c.prototype.popBackFun=function(b){if(11==b){var c=new a.WhisperUiEvent(a.WhisperUiEvent.COPY_ONE_MSG_EVENT);c.data=this.itdata.data.basevo.contentTxt,ModuleEventManager.dispatchEvent(c)}},c}(SListItem);a.WhisperChatRender=d}(whisper||(whisper={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),whisper;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a.setBlackBg(),a._bootomRender=new UIRenderComponent,a.addRender(a._bootomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._faceRender=new UIRenderComponent,a.addRender(a._faceRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.dispose=function(){this._faceRender.dispose(),this._faceRender=null,this._midRender.dispose(),this._midRender=null,this.whisperFriendList&&(this.whisperFriendList.dispose(),this.whisperFriendList=null),this.whisperChatListPanel&&(this.whisperChatListPanel.dispose(),this.whisperChatListPanel=null),b.prototype.dispose.call(this)},d.prototype.applyLoad=function(){var a=this;this._bootomRender.uiAtlas=WindowUi.winUIAtlas,this._midRender.uiAtlas.setInfo("ui/uidata/chat/whisper/whisper.xml","ui/uidata/chat/whisper/whisper.png",function(){a.loadConfigCom()})},d.prototype.loadConfigCom=function(){this._faceRender.uiAtlas=this._midRender.uiAtlas,this.a_sendbtn=this.addEvntBut("a_sendbtn",this._faceRender),this.a_face=this.addEvntBut("a_face",this._faceRender),this.addUIList(["a_chatbg","a_title"],this._midRender),this.a_txtbg=this.addEvntBut("a_txtbg",this._midRender),this.a_txt=this.addChild(this._faceRender.getComponent("a_txt")),this.indexSlist=this.addChild(this._midRender.getComponent("indexSlist")),this.indexSlist1=this.addChild(this._midRender.getComponent("indexSlist1"));var a=this.addChild(this._bootomRender.getComponent("cnew_bg_yellow"));this.setSizeForPanelUiCopy(a,"a_leftbg_yellow",this._midRender),this._bootomRender.applyObjData(),this._msg="玩家输入聊天",this._type=!1,this.refreshInputBfun(this._msg),this.applyLoadComplete()},d.prototype.refreshData=function(b){this._itdata=b,this.whisperChatListPanel||(this.whisperChatListPanel=new a.whisperChatListPanel,this.whisperChatListPanel.init(this._midRender.uiAtlas)),this.whisperChatListPanel.show(b.guid)},d.prototype.copyTxt=function(a){this._type?this._msg+=a:this._msg=a,this._type=!0,this.refreshInputBfun(this._msg)},d.prototype.butClik=function(a){var b=this;switch(a.target){case this.a_face:var c=new faceui.FaceUiEvent(faceui.FaceUiEvent.SHOW_FACE_UI_PANEL);c.data={bfun:function(a){b.faceFunBack(a)}},ModuleEventManager.dispatchEvent(c);break;case this.a_sendbtn:if(this.checkStr(this._msg)&&this._type&&this._itdata&&this._cansend&&this._itdata.inOnline)this._cansend=!1,NetManager.getInstance().protocolos.chat_whisper(this._itdata.guid,this._msg),this._msg="玩家输入聊天",this._type=!1,this.refreshInputBfun(this._msg),TimeUtil.addTimeOut(3e3,function(){b._cansend=!0});else{if(!this._itdata)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"请选择聊天对象",99);if(!this._type)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"不能发送空字符",99);if(!this.checkStr(this._msg))return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"含敏感词汇,请更正",99);if(!this._cansend)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"您说话太快了",99);if(!this._itdata.inOnline)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"对方不在线",99)}break;case this.e_close:this.hide();break;case this.a_txtbg:InputPanel.show(function(a){b.inputBfun(a)},this._type?this._msg:"",0,12)}},d.prototype.faceFunBack=function(a){this._type?this._msg+=a:(this._type=!0,this._msg=a),this.refreshInputBfun(this._msg)},d.prototype.checkStr=function(a){return!0},d.prototype.inputBfun=function(a){a.length>0?(this._type=!0,this._msg=a):(this._type=!1,this._msg="玩家输入聊天"),this.refreshInputBfun(this._msg)},d.prototype.refreshInputBfun=function(a){LabelTextFont.writeSingleLabel(this._faceRender.uiAtlas,this.a_txt.skinName,a,16,TextAlign.LEFT,ColorType.colorb96d49)},d.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),this.whisperFriendList||(this.whisperFriendList=new c,this.whisperFriendList.init(this._midRender.uiAtlas)),this.whisperFriendList.show(a),this._cansend=!0,this.resize()},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.whisperFriendList&&this.whisperFriendList.hide(),this.whisperChatListPanel&&this.whisperChatListPanel.hide()},d.prototype.resize=function(){b.prototype.resize.call(this),this.whisperFriendList&&(this.whisperFriendList.left=this.indexSlist.parent.x/UIData.Scale+this.indexSlist.x,this.whisperFriendList.top=this.indexSlist.parent.y/UIData.Scale+this.indexSlist.y),this.whisperChatListPanel&&(this.whisperChatListPanel.left=this.indexSlist1.parent.x/UIData.Scale+this.indexSlist1.x,this.whisperChatListPanel.top=this.indexSlist1.parent.y/UIData.Scale+this.indexSlist1.y)},d}(WindowMinUi);a.whisperUiPanel=b;var c=function(a){function b(){var b=a.call(this)||this;return b.left=182,b.top=97,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,d,224,397,0,90,4,256,512,1,6)},b.prototype.refreshDataByNewData=function(a){console.log("---创建_slistdata");var b=GuidData.social.getFriendList();this._slistdata=this.getData(b),this.refreshData(this._slistdata),this.selectItem(a,this._slistdata)},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},b.prototype.selectItem=function(a,b){for(var c=0,d=0;d<b.length;d++){var e=b[d].data;if(e.guid==a){c=d;break}}this.setSelectIndex(c)},b.prototype.resetData=function(){if(this._slistdata){var a=GuidData.social.getFriendList(),b=Chat.ChatModel.getInstance().getChatItemByType(SharedDef.CHAT_TYPE_WHISPER),c=b[b.length-1];if(c&&!c.showLast&&c.s2c_send_chat.guid!=GuidData.player.getGuid())for(var d=0;d<a.length;d++)if(a[d].guid==c.s2c_send_chat.guid){var e=a.splice(d,1);a.unshift(e[0]);break}for(var f=0;f<this._slistdata.length;f++)this._slistdata[f].data=a[f];this.refreshDraw(),this.setSelectIndex(this.getCurrentSelectIndex())}},b.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData(a)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.WhisperFriendList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.ASbg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"ASbg",0,0,224,87,10,10),a.addChild(this.ASbg),this.ASbg.addEventListener(InteractiveEvent.Up,this.equClick,this),this.ASicon=this.creatSUI(d,this.parentTarget.baseAtlas,"ASicon",8,11,68,68),a.addChild(this.ASicon),this.ASname=this.creatSUI(d,this.parentTarget.baseAtlas,"ASname",84,12,100,20),a.addChild(this.ASname),this.ASvip=this.creatSUI(d,this.parentTarget.baseAtlas,"ASvip",186,16,29,14),a.addChild(this.ASvip),this.ASfac=this.creatSUI(d,this.parentTarget.baseAtlas,"ASfac",84,33,100,20),a.addChild(this.ASfac),this.ASforce=this.creatSUI(d,this.parentTarget.baseAtlas,"ASforce",84,56,135,20),a.addChild(this.ASforce)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.applyrender(),b){var c=new a.WhisperUiEvent(a.WhisperUiEvent.SELECT_ITEM_EVENT);c.data=this.itdata,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.refreshDraw=function(){console.log("--this.itdata-",this.itdata),this.render(this.itdata)},c.prototype.applyrender=function(){this.itdata&&this.itdata.data&&(this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.ASbg.skinName,UIData.publicUi,PuiData.Slist_select):UiDraw.uiAtlasDrawImg(this.uiAtlas,this.ASbg.skinName,UIData.publicUi,PuiData.Slist_nselect),this.setIcon(this.itdata),LabelTextFont.writeSingleLabel(this.uiAtlas,this.ASname.skinName,getBaseName(this.itdata.data.name),16,TextAlign.LEFT,ColorType.Brown7a2f21),this.uiAtlas.upDataPicToTexture(getVipIconUrl(this.itdata.data.vip),this.ASvip.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.ASfac.skinName,""==this.itdata.data.faction?"暂无家族":getBaseName(this.itdata.data.faction),16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.ASforce.skinName,"战力 "+Snum(this.itdata.data.force),16,TextAlign.LEFT,ColorType.Green2ca937))},c.prototype.setnull=function(){UiDraw.clearUI(this.ASicon),UiDraw.clearUI(this.ASname),UiDraw.clearUI(this.ASvip),UiDraw.clearUI(this.ASfac),UiDraw.clearUI(this.ASforce),UiDraw.clearUI(this.ASbg)},c.prototype.setIcon=function(a){var b=this;IconManager.getInstance().getIcon(getTouPic(a.data.gender),function(c){var d=b._baseRender.uiAtlas.getRec(b.ASicon.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(c,0,0,82,82,3,3,62,62),a.selected&&UiDraw.cxtDrawImg(e,PuiData.A_HIGHR_C_66,new Rectangle(1,1,66,66),UIData.publicUi),a.data.inOnline||UIManager.getInstance().makeCtxToGray(e,new Rectangle(0,0,d.pixelWitdh,d.pixelHeight)),UiDraw.cxtDrawImg(e,PuiData.SKILL_LEV_BG,new Rectangle(15,50,53,18),UIData.publicUi),LabelTextFont.writeSingleLabelToCtxSetAnchor(e,ColorType.Whitefffce6+String(a.data.level),14,42,50,TextAlign.CENTER),b._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},c.prototype.equClick=function(a){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;this.setSelect()}},c}(SListItem);a.WhisperFriendRender=d}(whisper||(whisper={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),whisper;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"WhisperUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.WhisperUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_WHISPER_PANEL="SHOW_WHISPER_PANEL",b.SELECT_ITEM_EVENT="SELECT_ITEM_EVENT",b.RECIVE_NEWS_MSG_EVENT="RECIVE_NEWS_MSG_EVENT",b.REFRESHFRIENDlIST_EVENT="REFRESHFRIENDlIST_EVENT",b.COPY_ONE_MSG_EVENT="COPY_ONE_MSG_EVENT",b}(BaseEvent);a.WhisperUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"whisperUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_WHISPER_PANEL?this.showPanel(b.data):b.type==c.SELECT_ITEM_EVENT?this.selectItem(b.data):b.type==c.RECIVE_NEWS_MSG_EVENT?this.recivenewsmsg(b.data):b.type==c.REFRESHFRIENDlIST_EVENT?this.refreshFriendList():b.type==c.COPY_ONE_MSG_EVENT&&this.copyonemsg(b.data)}if(a instanceof UIPanelEvent){var d=a;d.panel==this._whisperUiPanel&&(this._whisperUiPanel.dispose(),this._whisperUiPanel=null,console.log("释放面板 _whisperUiPanel"))}},d.prototype.copyonemsg=function(a){this._whisperUiPanel&&this._whisperUiPanel.hasStage&&this._whisperUiPanel.copyTxt(a)},d.prototype.refreshFriendList=function(){this._whisperUiPanel&&this._whisperUiPanel.whisperFriendList&&this._whisperUiPanel.whisperFriendList.hasStage&&this._whisperUiPanel.whisperFriendList.resetData()},d.prototype.recivenewsmsg=function(a){if(this._whisperUiPanel&&this._whisperUiPanel.hasStage){this.refreshFriendList();var b=this._whisperUiPanel.whisperChatListPanel.guid;(b&&b==a[0]||b==a[1])&&this._whisperUiPanel.whisperChatListPanel.refreshDataByNewData(b)}},d.prototype.selectItem=function(a){this._whisperUiPanel&&this._whisperUiPanel.hasStage&&this._whisperUiPanel.refreshData(a.data)},d.prototype.showPanel=function(b){var c=this;this._whisperUiPanel||(this._whisperUiPanel=new a.whisperUiPanel),this._whisperUiPanel.load(function(){c._whisperUiPanel.show(b)})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_WHISPER_PANEL),new c(c.SELECT_ITEM_EVENT),new c(c.RECIVE_NEWS_MSG_EVENT),new c(c.REFRESHFRIENDlIST_EVENT),new c(c.COPY_ONE_MSG_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.whisperUiProcessor=d}(whisper||(whisper={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Camand;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.draw=function(){var a=UIManager.getInstance().getContext2D(this.uvData.ow,this.uvData.oh,!1);UiDraw.cxtDrawImg(a,PuiData.Slist_select,new Rectangle(0,0,98,50),UIData.publicUi),this.drawLable(a,50,15,this._listItemData.data.txt,16,"#000000",!1),this.atlas.updateCtx(a,this.uvData.ox,this.uvData.oy)},b.prototype.drawLable=function(a,b,c,d,e,f,g){void 0===g&&(g=!1),a.textBaseline=TextAlign.TOP,a.textAlign=TextAlign.CENTER,a.fillStyle=f,a.font=(g?"bolder ":"")+e+"px"+UIData.font,a.fillText(d,b,c)},b}(ListItemRender);a.CammandRender=b;var c=function(a){function c(){var b=a.call(this)||this;return b.chatItem=new Array,b.mapItem=["高山竹林","darkmap"],b.mapId=1,b.charArr=["wd","em"],b.charId=0,b.width=600,b.height=400,b.center=0,b.middle=0,b._listRender=new UIListRenderComponent,b.addRender(b._listRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b.addList(),b}return __extends(c,a),c.prototype.addList=function(){var a=new Vector2D(30,20);this._bgList=this._listRender.createGridList(),this._bgList.x=a.x,this._bgList.y=a.y,this.addChild(this._bgList),this._bgMask=new UIMask,this._bgMask.x=a.x,this._bgMask.y=a.y,this._bgMask.width=512,this._bgMask.height=300,this.addMask(this._bgMask),this._listRender.mask=this._bgMask,this.refreshData()},c.prototype.refreshData=function(){for(var a=this,c=new Array,d=["显示A星","升满级","新帐号","换服务器","自杀","VIP+1","重置0","资源清空","资源+10000","加道具","升级+10","升级+1","升级+5","完成主线","系统开启","修改发送","世界冒险","重置世界BOSS","回到主城","去1006","家族活动"],e=0;e<d.length;e++){var f=new ListItemData;f.data={txt:d[e],id:e},f.clickFun=function(b){a.itemDataClick(b)},c.push(f)}this._bgList.contentY=0,this._bgList.setGridData(c,b,5,100,50,512,512,512,300)},c.prototype.itemDataClick=function(a){var b=a.data.txt;switch(b){case"世界冒险":break;case"家族模式":NetManager.getInstance().protocolos.change_battle_mode(SharedDef.FAMILY_MODE);break;case"和平模式":NetManager.getInstance().protocolos.change_battle_mode(SharedDef.PEACE_MODE);break;case"坐骑打开":ModulePageManager.openPanel(SharedDef.MODULE_MOUNT);break;case"全民boss":ModuleEventManager.dispatchEvent(new sboss.SbossEvent(sboss.SbossEvent.SHOW_SBOSS_PANEL));break;case"翅膀":ModuleEventManager.dispatchEvent(new wing.WingEvent(wing.WingEvent.SHOW_WING_PANEL_EVENT));break;case"法宝":ModuleEventManager.dispatchEvent(new treasure.TreasureUiEvent(treasure.TreasureUiEvent.SHOW_TREASURE_EVENT));break;case"组队副本":break;case"回到主城":NetManager.getInstance().protocolos.teleport_map(1,1);break;case"去1006":NetManager.getInstance().protocolos.teleport_map(1008,1);break;case"招募成员":var c=window.location.toString(),d=c.indexOf("?");-1!=d&&(c=c.substring(0,d));var e=c+"?inviteGuid="+GuidData.faction.getGuid();e=e.replace("index.html","login.html"),console.log("outUrl",e),copy2clipboard(e),alert(e);break;case"家族场景":NetManager.getInstance().protocolos.back_to_famity();break;case"显示FPS":var f=document.getElementById("FpsTipsCanvas");0==f.style["z-index"]?f.style["z-index"]=2:f.style["z-index"]=0;break;case"新帐号":window.location.href="random.html";break;case"换服务器":window.location.href="login.html";break;case"升级+1":var g="@Rank "+String(GameInstance.mainChar.unit.getLevel()+1);GameControlManager.sendGmCom(g);break;case"升级+5":var g="@Rank "+String(GameInstance.mainChar.unit.getLevel()+5);GameControlManager.sendGmCom(g);break;case"升级+10":var g="@Rank "+String(GameInstance.mainChar.unit.getLevel()+10);GameControlManager.sendGmCom(g);break;case"升满级":var g="@Rank "+String(199);GameControlManager.sendGmCom(g);break;case"系统开启":this.openSystemAll();break;case"VIP+1":var g="@VIP "+String(GuidData.player.getVipLevel()+1);GameControlManager.sendGmCom(g),console.log(g);break;case"修改发送":console.log("修改发送",GameInstance.mainChar.unit.uintGuid),NetManager.getInstance().protocolos.clientSubscription(GameInstance.mainChar.unit.uintGuid);break;case"进入试练塔":console.log(b),NetManager.getInstance().protocolos.enter_trial_instance();break;case"重置0":b="@重置 0",console.log(b),GameControlManager.sendGmCom(b);break;case"重置世界BOSS":var h=new Date;console.log(h.getHours(),h.getMinutes());var i=1;h.getSeconds()>50&&(i=2),i=2,b="@世界BOSS "+h.getHours()+" "+(h.getMinutes()+i)+" 1 15",console.log(b),GameControlManager.sendGmCom(b);break;case"自杀":console.log(b),GameControlManager.sendGmCom("@自杀");break;case"资源清空":console.log(b),GameControlManager.sendGmCom("@Resource -1 0");break;case"资源+10000":this.changeMoney(SharedDef.MONEY_TYPE_GOLD_INGOT,1e7),this.changeMoney(SharedDef.MONEY_TYPE_BIND_GOLD,1e7),this.changeMoney(SharedDef.MONEY_TYPE_SILVER,1e9);break;case"加道具":for(var j=[237,1402,1403,1401,202,203,201,227,224,226,211,212,233,234],k=0;k<j.length;k++)GameControlManager.sendGmCom("@制造 "+j[k]+" 990");break;case"显示A星":scene2d.SceneAstarModel.getInstance().showAstarLine();break;case"完成主线":GameControlManager.sendGmCom("@完成当前主线");break;case"完成神兵":GameControlManager.sendGmCom("@制造 201 100 1"),GameControlManager.sendGmCom("@选择主线 10123"),GameControlManager.sendGmCom("@完成当前主线");break;case"完成技能":GameControlManager.sendGmCom("@选择主线 10220"),GameControlManager.sendGmCom("@完成当前主线");break;case"完成骑乘":GameControlManager.sendGmCom("@选择主线 10203"),GameControlManager.sendGmCom("@完成当前主线");break;case"完成坐骑":GameControlManager.sendGmCom("@选择主线 10203"),GameControlManager.sendGmCom("@完成当前主线"),GameControlManager.sendGmCom("@选择主线 10229"),GameControlManager.sendGmCom("@完成当前主线");break;case"完成副本":GameControlManager.sendGmCom("@选择主线 10209"),GameControlManager.sendGmCom("@完成当前主线");break;case"完成强化":GameControlManager.sendGmCom("@选择主线 10217"),GameControlManager.sendGmCom("@完成当前主线");break;case"完成家族":GameControlManager.sendGmCom("@选择主线 10224"),GameControlManager.sendGmCom("@完成当前主线");break;case"完成斗剑台":GameControlManager.sendGmCom("@选择主线 10214"),GameControlManager.sendGmCom("@完成当前主线");break;case"家族活动":ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONACTIVE_PANEL_EVENT));break;case"坐骑":break;case"排位赛":ModuleEventManager.dispatchEvent(new kuafu.KuaFuEvent(kuafu.KuaFuEvent.KUAFU_SHOW_ARENA_PANEL_EVENT));break;case"家族技能":ModuleEventManager.dispatchEvent(new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONSKILL_PANEL_EVENT));break;case"强化系统":break;case"角色":ModuleEventManager.dispatchEvent(new role.RoleUiEvent(role.RoleUiEvent.SHOW_ROLE_EVENT));break;case"测试粒子":copy2clipboard("dddddddddddddddds****");break;case"外观":ModuleEventManager.dispatchEvent(new exterior.ExteriorEvent(exterior.ExteriorEvent.SHOW_EXTERIOR_EVENT));break;case"技能":ModuleEventManager.dispatchEvent(new skillUi.SkillUiEvent(skillUi.SkillUiEvent.SHOW_SKILLUI_EVENT));break;case"我要变强":ModulePageManager.openPanel(SharedDef.MODULE_STRENGTH);break;case"日常任务":ModulePageManager.openPanel(SharedDef.MODULE_DAILY_TASKS);break;default:return}this.sendNextMsg(),this.hide()},c.prototype.openSystemAll=function(){var a=new Array;a.push(10220),a.push(10123),a.push(10229),a.push(10217),a.push(10203),a.push(10209),a.push(10225),a.push(10214),a.push(10130),a.push(10224);for(var b=0;b<a.length;b++)GameControlManager.sendGmCom("@选择主线 "+a[b]),GameControlManager.sendGmCom("@完成当前主线")},c.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),Scene_data.uiBlankStage.addEventListener(InteractiveEvent.Up,this.onStageMouseUp,this))},c.prototype.onStageMouseUp=function(a){this.hide()},c.prototype.changeMoney=function(a,b){this.chatItem.push({id:a,num:b})},c.prototype.sendNextMsg=function(){var a=this;if(this.chatItem.length){var b=this.chatItem.pop(),c="@Resource "+b.id+" "+b.num;console.log(c),GameControlManager.sendGmCom(c),this.chatItem.length&&setTimeout(function(){a.sendNextMsg()},200)}},c.prototype.showAstarLine=function(){this._astarLineSprite?(SceneManager.getInstance().removeDisplay(this._astarLineSprite),this._astarLineSprite=null):(ProgrmaManager.getInstance().registe(LineDisplayShader.LineShader,new LineDisplayShader),this._astarLineSprite=new LineDisplaySprite,SceneManager.getInstance().addDisplay(this._astarLineSprite),this.makeAstarLine(AstarUtil.navmeshData))},c.prototype.makeAstarLine=function(a){for(var b=a.heightItem[0].length,c=a.heightItem.length,d=a.midu,e=a.aPos,f=new Array,g=0,h=0;c>h;h++)for(var i=0;b>i;i++){
g=a.heightItem[h][i];var j=new Vector3D(i*d,g,h*d);j.x=j.x+e.x,j.z=e.z+c*d-j.z,j.y=g,f.push(j)}for(this._astarLineSprite.clear(),this._astarLineSprite.baseColor=new Vector3D(1,0,1,1),h=0;c-1>h;h++)for(i=0;b-1>i;i++){var k=h*b+i,l=k+1,m=k+1+b,n=k+b;1==a.astarItem[h][i]&&(this._astarLineSprite.makeLineMode(f[k],f[l]),this._astarLineSprite.makeLineMode(f[k],f[n]),0==a.astarItem[h+1][i]&&this._astarLineSprite.makeLineMode(f[m],f[n]),0==a.astarItem[h][i+1]&&this._astarLineSprite.makeLineMode(f[l],f[m]))}this._astarLineSprite.upToGpu()},c.prototype.randomJumpTxt=function(){},c.prototype.butClik=function(a){this.hide()},c.prototype.changeChat=function(){},c.prototype.hide=function(){Scene_data.uiBlankStage.removeEventListener(InteractiveEvent.Down,this.onStageMouseUp,this),UIManager.getInstance().removeUIContainer(this)},c}(UIConatiner);a.CammandPanel=c;var d=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.loadGroup=function(a){var b=this,c=new GroupRes;c.load(Scene_data.fileRoot+"model/"+a+".txt",function(){b.loadPartRes(c)})},b.prototype.loadPartRes=function(a){for(var b=0;b<a.dataAry.length;b++){var c=a.dataAry[b];c.types==BaseRes.SCENE_PARTICLE_TYPE||c.types==BaseRes.PREFAB_TYPE&&(this.setObjUrl(c.objUrl),console.log(c.materialUrl),this.setMaterialUrl(c.materialUrl,c.materialInfoArr))}},b}(Display3DSprite);a.SceneModelTwoTexture=d;var e=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.destory=function(){for(a.prototype.destory.call(this);this.skillitem.length;){var b=this.skillitem.pop();b.isDeath=!0,b.useNum=0}},b.prototype.walkComplete=function(){},b.prototype.setWalkPath=function(a){this.walkPath=a},b}(SceneChar);a.MonsterChar=e;var f=function(){function a(){var a=this;this.monsterItem=new Array,TimeUtil.addFrameTick(function(b){a.update(b)})}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.update=function(a){},a.prototype.clearSceneMonster=function(){for(;this.monsterItem.length;)this.removeMonsterChar(this.monsterItem[0])},a.prototype.removeMonsterChar=function(a){var b=this.monsterItem.indexOf(a);-1!=b&&this.monsterItem.splice(b,1),GameInstance.removeSceneChar(a),a.destory()},a.prototype.roundHit=function(a){for(var b=0;this.monsterItem&&b<this.monsterItem.length;b++){var c=this.monsterItem[b],d=c.getCurrentPos();Vector3D.distance(d,a)<55&&(c.life-=15)}},a.prototype.addSceneMonsterList=function(){},a.prototype.selectMonsterMove=function(){if(this.monsterItem&&this.monsterItem.length){var a=randomByItem(this.monsterItem),b=AstarUtil.findPath(a.getCurrentPos(),GameInstance.mainChar.getCurrentPos());a.setWalkPath(b)}},a.prototype.allPlaySkill=function(){for(var a=0;this.monsterItem&&a<this.monsterItem.length;a++){this.monsterItem[a]}},a.prototype.getSceneChar=function(a,b,c,d,f){void 0===b&&(b=10),void 0===c&&(c=!1),void 0===d&&(d=null),void 0===f&&(f=null);var g=new e;return g.setRoleUrl(getRoleUrl(a)),g.x=0,g.y=5,g.z=0,g.setShadowSize(b),g},a}();a.SceneMonster=f}(Camand||(Camand={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Camand;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_COMMAND_EVENT="show_command_event",b.SHOW_ASTAR_LINE="SHOW_ASTAR_LINE",b}(BaseEvent);a.ComandEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"CommandModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.CommandModule=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"CommandProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;c.type==b.SHOW_COMMAND_EVENT&&this.showCommandEvent(),c.type==b.SHOW_ASTAR_LINE&&this.showAstarLine()}},d.prototype.showAstarLine=function(){this._cammandPanel||(this._cammandPanel=new a.CammandPanel),this._cammandPanel.showAstarLine()},d.prototype.showCommandEvent=function(){this._cammandPanel||(this._cammandPanel=new a.CammandPanel),this._cammandPanel.show()},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_COMMAND_EVENT),new b(b.SHOW_ASTAR_LINE)]},d}(BaseProcessor);a.CommandProcessor=d}(Camand||(Camand={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SceneEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SCENE_NEW_ACHIEVEMENT_EVENT="SCENE_NEW_ACHIEVEMENT_EVENT",b.SCENE_NEW_DESIGNATION_EVENT="SCENE_NEW_DESIGNATION_EVENT",b.SCENE_NEW_WEAPONS_EVENT="SCENE_NEW_WEAPONS_EVENT",b}(BaseEvent),SceneModule=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"SceneModule"},b.prototype.listProcessors=function(){return[new SceneProcessor]},b}(Module),SceneProcessor=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getName=function(){return"SceneProcessor"},b.prototype.receivedModuleEvent=function(a){var b=a;b.type==SceneEvent.SCENE_NEW_ACHIEVEMENT_EVENT?this.popnewachieventpanel(b.data):b.type==SceneEvent.SCENE_NEW_DESIGNATION_EVENT&&this.popnewdesignationpanel(b.data)},b.prototype.popnewachieventpanel=function(a){PopNewPromptUtil.show(PopNewPromptUtil.NEW_ACHIEVEMENT,a)},b.prototype.popnewdesignationpanel=function(a){PopNewPromptUtil.show(PopNewPromptUtil.NEW_DESIGNATION,a)},b.prototype.listenModuleEvents=function(){return[new SceneEvent(SceneEvent.SCENE_NEW_ACHIEVEMENT_EVENT),new SceneEvent(SceneEvent.SCENE_NEW_DESIGNATION_EVENT),new SceneEvent(SceneEvent.SCENE_NEW_WEAPONS_EVENT),new EngineEvent(EngineEvent.CREAT_SCENE_EVENT)]},b.prototype.smsgMapUpdataObject=function(a){GuidObjManager.getInstance().ApplyBlock(a)},b.prototype.smsgNoticeWatcherMapInfo=function(a){var b=new s2c_notice_watcher_map_info;s2c_notice_watcher_map_info.read(b,a),console.log("观察者信息",b)},b.prototype.newWeapons=function(a){var b=new s2c_bag_find_equip_better;s2c_bag_find_equip_better.read(b,a);var c=new newbieguide.UseItemVo;c.itemId=b.item_id,c.time=5e3,c.guid="",c.equPos=b.pos,c.num=1,c.force=b.force;var d=new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.SHOW_USEITEM_EVENT);d.data=c,ModuleEventManager.dispatchEvent(d)},b.prototype.msgDeath=function(a){var b=new s2c_field_death_cooldown;s2c_field_death_cooldown.read(b,a),console.log("---死亡面板-=="),DeathPanel.show(b.type,b.value,b.cooldown)},b.prototype.smsgShowUnitAttribute=function(a){var b=a.readUint16();console.log(b);for(var c=0;b>c;c++){var d=a.readUint32(),e=a.readUint32();console.log(getKeyProById(d-1),":",e)}console.log("----------------------------------")},b.prototype.smsgShowLoot=function(a){var b=new s2c_show_loot_animate;s2c_show_loot_animate.read(b,a),console.log(b.info);for(var c=b.info.split(","),d=c.length/2,e=this.getPosList(new Vector2D(Number(c[0]),Number(c[1])),d-1),f=new Array,g=1;d>g;g++){var h=tb.TB_item_template.get_TB_item_template(Number(c[2*g]));1==h.type_c;var i=new SceneLoot;i.setShadowSize(10),i.setAvatar(6500),i.showName(getColorQua(h.quality)+h.name),i.forceRotationY=180-Scene_data.gameAngle;var j=e[g-1];i.gridX=j.x,i.gridY=j.y,i.moveToPos2D=j,GameInstance.addSceneChar(i),i.data={item:h,num:c[2*g+1],idx:g},f.push(i);var k=1e3*Math.random();this.showLoot(2e3+k,i),this.hideLoot(3e3+k,i)}},b.prototype.showLoot=function(a,b){var c=this;TimeUtil.addTimeOut(a,function(){var a=MathUtil.mathDisplay2Dto3DWorldPos(new Vector2D(BagData.uipos.x,BagData.uipos.y));TweenLite.to(b,1,{px:a.x,py:a.y,pz:a.z,scale:.5});var d=b.data,e="[FFE57E]获得 "+getColorQua(d.item.quality)+d.item.name+"[FFE57E]×"+d.num;c.showTempTime(150*d.idx,e,3)})},b.prototype.hideLoot=function(a,b){TimeUtil.addTimeOut(a,function(){GameInstance.removeSceneChar(b),b.destory()})},b.prototype.showTempTime=function(a,b,c){TimeUtil.addTimeOut(a,function(){msgtip.MsgTipManager.outStr(b,msgtip.MsgTipManager.getPopTypeByTB(c))})},b.prototype.createOffset=function(a,b){for(var c=-a;a>=c;c++)for(var d=-a;a>=d;d++){var e=c+","+d;b[e]||(this.offsetAry.push(new Vector2D(2*c,2*d)),b[e]=!0)}6>a&&this.createOffset(a+1,b)},b.prototype.getOffsetAry=function(){if(this.offsetAry)return this.offsetAry;this.offsetAry=new Array;var a=new Object;return this.offsetAry.push(new Vector2D(0,0)),a["0,0"]=!0,this.createOffset(1,a),this.offsetAry},b.prototype.getPosList=function(a,b){for(var c=this.getOffsetAry(),d=0,e=new Array,f=0;b>f;){var g=c[d];d++,g=g.add(a),AstarUtil.isGridCanWalk(g)&&(f++,e.push(g))}return e},b.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_MAP_UPDATE_OBJECT]=function(b){a.smsgMapUpdataObject(b)},b[Protocols.SMSG_NOTICE_WATCHER_MAP_INFO]=function(b){a.smsgNoticeWatcherMapInfo(b)},b[Protocols.SMSG_FIELD_DEATH_COOLDOWN]=function(b){a.msgDeath(b)},b[Protocols.SMSG_BAG_FIND_EQUIP_BETTER]=function(b){a.newWeapons(b)},b[Protocols.SMSG_SHOW_UNIT_ATTRIBUTE]=function(b){a.smsgShowUnitAttribute(b)},b[Protocols.SMSG_SHOW_LOOT_ANIMATE]=function(b){a.smsgShowLoot(b)},b},b}(BaseProcessor),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),MapInfo=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this.initMap(),b.hasInit||Engine.resReady(),this._after_update=function(b,c,d){a.dataUpdate(c,d)},this.AddListen(SharedDef.MAP_INT_FIELD_END_TM,function(b){a.mapIntFieldEndTmChange()}),this.AddListenString(SharedDef.MAP_STR_REWARD,function(b){a.mapRewardChange()})},b.prototype.getMapWaveCount=function(){return this.GetUInt16(SharedDef.MAP_INT_FIELD_INSTANCE_WAVE,0)},b.prototype.getMapWaveAllCount=function(){return this.GetUInt16(SharedDef.MAP_INT_FIELD_INSTANCE_WAVE,1)},b.prototype.getKuafuGropuInstanceFieldsHard=function(){return this.GetUInt32(SharedDef.KUAFU_GROUP_INSTANCE_FIELDS_HARD)},b.prototype.getVipInstanceFieldReward=function(){return this.GetStr(SharedDef.MAP_STR_REWARD)},b.prototype.mapRewardChange=function(){for(var a=new fb.FubenEvent(fb.FubenEvent.FUBEN_SHOW_REWARD_EVENT),b=new Array,c=GuidData.map.getVipInstanceFieldReward(),d=c.split(","),e=0;e<d.length;e++){var f=new Array,g=d[e].split(":");f.push(Number(g[0])),f.push(Number(g[1])),b.push(f)}console.log("副本奖励",b),a.data=b,ModuleEventManager.dispatchEvent(a)},b.prototype.getResMapID=function(){return this.GetUInt32(SharedDef.RES_INSTANCE_FIELD_ID)},b.prototype.getPersonBossMapID=function(){return this.GetUInt32(SharedDef.MAP_PRIVATE_BOSS_INT_FIELD_ID)},b.prototype.mapIntFieldEndTmChange=function(){if(this.is3V3(),this.is1V1(),this.isXianfu(),this.isFuBen()){var a=GuidData.map.GetUInt8(SharedDef.MAP_INT_FIELD_STATE,1);a==b.STATE_250?ModuleEventManager.dispatchEvent(new fb.FubenEvent(fb.FubenEvent.FUBEN_SHOW_REWARD_EVENT)):ModuleEventManager.dispatchEvent(new fb.FubenEvent(fb.FubenEvent.FUBEN_SHOW_FAIL_EVENT))}},b.prototype.dataUpdate=function(a,b){if(this.isFuBen()){var c=!1;for(var d in a){var e=Number(d);if(e>=SharedDef.MAP_INT_FIELD_QUESTS_PROCESS_START&&e<SharedDef.MAP_INT_FIELD_QUESTS_PROCESS_END){c=!0;break}if(e>=SharedDef.MAP_INT_FIELD_QUESTS_START&&e<SharedDef.MAP_INT_FIELD_QUESTS_END){c=!0;break}}c&&ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.MAP_INT_FIELD_QUESTS_PROCESS))}else if(this.is3V3()){var f=new Object;for(var d in a){var e=Number(d);if(!(e<SharedDef.KUAFU_3V3_FIELDS_INT_INFO_START)){var g=Math.floor((e-SharedDef.KUAFU_3V3_FIELDS_INT_INFO_START)/SharedDef.MAX_KUAFU_3V3_INT_COUNT);f[g]||(f[g]=1)}}for(var d in b){var e=Number(d);if(!(e<SharedDef.KUAFU_3V3_FIELDS_STR_INFO_START)){var g=Math.floor((e-SharedDef.KUAFU_3V3_FIELDS_STR_INFO_START)/SharedDef.MAX_KUAFU_3V3_STR_COUNT);f[g]||(f[g]=1)}}for(var h in f)this.changeKuafu3V3Fields(Number(h))}},b.prototype.changeKuafu3V3Fields=function(a){SharedDef.KUAFU_3V3_FIELDS_INT_INFO_START+a*SharedDef.MAX_KUAFU_3V3_INT_COUNT,SharedDef.KUAFU_3V3_FIELDS_STR_INFO_START+a*SharedDef.MAX_KUAFU_3V3_STR_COUNT;this._kuafu3V3DataItem=null},b.prototype.getKuafu3V3DataItem=function(){if(!this._kuafu3V3DataItem){for(var a=new Array,b=0;b<SharedDef.MAX_KUAFU_3V3_COUNT;b++){var c=SharedDef.KUAFU_3V3_FIELDS_INT_INFO_START+b*SharedDef.MAX_KUAFU_3V3_INT_COUNT,d=SharedDef.KUAFU_3V3_FIELDS_STR_INFO_START+b*SharedDef.MAX_KUAFU_3V3_STR_COUNT,e=new Kuafu3V3dataVo;e.makeData(this,c,d,b),e.name&&a.push(e)}this._kuafu3V3DataItem=a}return this._kuafu3V3DataItem},b.prototype.initMap=function(){FpsMc.tipStr="-v4";var a=this.getMapID();"地图信息- 地图id:"+this.getMapID()+" 实例ID："+this.getInstanceID()+" 线程ID："+this.getLineID()+" 名字："+this.getMapStrGeneralId();this.tbMapVo=tb.TB_map.getTB_map(a),GameInstance.intLoadScene(this.tbMapVo.mapres)},b.prototype.is3V3=function(){return this.tbMapVo&&this.tbMapVo.inst_sub_type==SharedDef.INSTANCE_SUB_TYPE_KUAFU_3V3?!0:!1},b.prototype.isWBoss=function(){return this.tbMapVo&&this.tbMapVo.inst_sub_type==SharedDef.INSTANCE_SUB_TYPE_WORLD_BOSS?!0:!1},b.prototype.is1V1=function(){return this.tbMapVo&&1==this.tbMapVo.inst_type&&this.tbMapVo.inst_sub_type==SharedDef.INSTANCE_SUB_TYPE_DOUJIANTAI?!0:!1},b.prototype.isAdventureScene=function(){var a=GuidData.map.getTrialInstanceFieldSectionId();return a>0?!0:!1},b.prototype.isAdventureBossScene=function(){var a=Math.floor(GuidData.map.getTrialInstanceFieldSectionId()/1e6);return 2==a?!0:!1},b.prototype.isAdventureBaseScene=function(){var a=Math.floor(GuidData.map.getTrialInstanceFieldSectionId()/1e6);return 1==a?!0:!1},b.prototype.isFamilyScene=function(){return 11==GuidData.map.tbMapVo.inst_sub_type},b.prototype.isXiuLian=function(){return this.tbMapVo&&1==this.tbMapVo.inst_type&&9==this.tbMapVo.inst_sub_type?!0:!1},b.prototype.isXianfu=function(){if(this.tbMapVo&&1==this.tbMapVo.inst_type){if(6==this.tbMapVo.inst_sub_type)return!0;if(8==this.tbMapVo.inst_sub_type)return!0}return!1},b.prototype.isWorldBoss=function(){return this.tbMapVo&&1==this.tbMapVo.inst_type&&this.tbMapVo.inst_sub_type==SharedDef.INSTANCE_SUB_TYPE_WORLD_BOSS?!0:!1},b.prototype.isBaseMap=function(){return this.tbMapVo&&0==this.tbMapVo.inst_type?!0:!1},b.prototype.showAreaById=function(a){return this.tbMapVo?this.tbMapVo.showAreaById(a):!1},b.prototype.getTrialInstanceFieldSectionId=function(){return this.GetUInt32(SharedDef.TRIAL_INSTANCE_FIELD_SECTION_ID)},b.prototype.getTialID=function(){return this.GetUInt32(SharedDef.TRIAL_INSTANCE_FIELD_ID)},b.prototype.isFuBen=function(){return this.tbMapVo&&this.tbMapVo.is_instance?!0:!1},b.prototype.isKuafuZhuDuiFuben=function(){return this.tbMapVo&&12==this.tbMapVo.inst_sub_type?!0:!1},b.prototype.dispose=function(){a.prototype.dispose.call(this),GameInstance.clearRoleList(),AstarUtil.clear(),SceneManager.getInstance().clearScene()},b.prototype.getMapID=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_MAP_ID)},b.prototype.getInstanceID=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_INSTANCE_ID)},b.prototype.getLineID=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_LINE_NO)},b.prototype.getFloorNum=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_RESERVE3)},b.prototype.getReserve2=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_RESERVE2)},b.prototype.getXianFuPlayerList=function(){for(var a=new Array,b=SharedDef.KUAFU_XIANFU_FIELDS_STR_INFO_START;b<SharedDef.KUAFU_XIANFU_FIELDS_STR_INFO_END;b+=SharedDef.MAX_KUAFU_XIANFU_STR_COUNT){var c=this.GetStr(b+SharedDef.KUAFU_XIANFU_PLAYER_NAME);c&&""!=c&&a.push(c)}return a},b.prototype.getXianFuPlayerGuidList=function(){for(var a=new Array,b=SharedDef.KUAFU_XIANFU_FIELDS_STR_INFO_START;b<SharedDef.KUAFU_XIANFU_FIELDS_STR_INFO_END;b+=SharedDef.MAX_KUAFU_XIANFU_STR_COUNT){var c=this.GetStr(b+SharedDef.KUAFU_XIANFU_PLAYER_GUID);c&&""!=c&&a.push(c)}return a},b.prototype.getXianFuPlayerScore=function(a){var b=SharedDef.KUAFU_XIANFU_FIELDS_INT_INFO_START+a*SharedDef.MAX_KUAFU_XIANFU_INT_COUNT+SharedDef.KUAFU_XIANFU_PLAYER_SHOW_INFO;return this.GetByte(b,0)},b.prototype.getXianFuBangData=function(){for(var a=new Array,b=this.getXianFuPlayerList(),c=0;c<b.length;c++){var d=new EndVo;d.name=b[c];var e=SharedDef.KUAFU_XIANFU_FIELDS_INT_INFO_START+c*SharedDef.MAX_KUAFU_XIANFU_INT_COUNT+SharedDef.KUAFU_XIANFU_PLAYER_SHOW_INFO,f=SharedDef.KUAFU_XIANFU_FIELDS_INT_INFO_START+c*SharedDef.MAX_KUAFU_XIANFU_INT_COUNT+SharedDef.KUAFU_XIANFU_PLAYER_SETTLEMENT;d.power=this.GetDouble(f),d.boxNum=this.GetByte(e,0),d.killperson=this.GetByte(e,1),d.killboss=this.GetByte(e,2),a.push(d)}return a.sort(function(a,b){return a.boxNum==b.boxNum?a.killperson==b.killperson?a.killboss==b.killboss?b.power-a.power:b.killboss-a.killboss:b.killperson-a.killperson:b.boxNum-a.boxNum}),console.log("endvo----",a),a},b.prototype.getXianFuBoss=function(){for(var a=new Array,b=SharedDef.KUAFU_XIANFU_FIELDS_INT_BOSS_INFO_START;b<SharedDef.KUAFU_XIANFU_FIELDS_INT_BOSS_INFO_END;b+=SharedDef.MAX_KUAFU_XIANFU_BOSS_INT_COUNT){var c=b+SharedDef.KUAFU_XIANFU_BOSS_SHOW_INFO,d=this.GetUInt16(c,0);if(d>0){var e=new Object;e.entry=d,e.idx=c,e.time=this.GetUInt32(b+SharedDef.KUAFU_XIANFU_BOSS_BORN_TIME),a.push(e)}}return a},b.prototype.getXianFuBossState=function(a){return this.GetUInt16(a,1)},b.prototype.getXianFuLevel=function(){return this.GetUInt32(SharedDef.KUAFU_XIANFU_FIELDS_HARD)},b.prototype.getMapStrGeneralId=function(){return this.GetStr(SharedDef.MAP_STR_GENERAL_ID)},b.prototype.getMapIntFieldEndTM=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_END_TM)},b.prototype.getMapIntFieldCreateTm=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_CREATE_TM)},b.prototype.getDouJianTaiFieldsIntRank=function(){var a=this.GetUInt16(SharedDef.DOUJIANTAI_FIELDS_INT_RANK,0),b=this.GetUInt16(SharedDef.DOUJIANTAI_FIELDS_INT_RANK,1);return[a,b]},b.prototype.getDouJianTaiFieldsIntCombatWinInfo=function(){var a=this.GetUInt16(SharedDef.DOUJIANTAI_FIELDS_INT_COMBAT_WIN_INFO,0),b=this.GetUInt16(SharedDef.DOUJIANTAI_FIELDS_INT_COMBAT_WIN_INFO,1);return[a,b]},b.prototype.getMapIntFieldQuestEndTm=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_QUEST_END_TM)},b.prototype.getMapIntFieldStartTm=function(){return this.GetUInt32(SharedDef.MAP_INT_FIELD_START_TM)},b.prototype.getVipInstanceFieldId=function(){return this.GetUInt32(SharedDef.VIP_INSTANCE_FIELD_ID)},b.prototype.getMapIntFieldQuests=function(){for(var a=new Array,b=SharedDef.MAP_INT_FIELD_QUESTS_START;b<SharedDef.MAP_INT_FIELD_QUESTS_END;b+=2){var c=this.GetByte(b,0);if(c>0)switch(c){case SharedDef.INSTANCE_QUEST_TYPE_KILL_MONSTER:var d=this.GetByte(b,1),e=this.GetUInt16(b,1);a.push({creatureId:e,num:d,questType:c});break;case SharedDef.INSTANCE_QUEST_TYPE_PROTECT_NPC:var f=this.GetByte(b,1),e=this.GetUInt16(b,1);a.push({creatureId:e,num:f,questType:c})}}return a},b.prototype.getMapIntFieldQuestProcess=function(){for(var a=new Array,b=SharedDef.MAP_INT_FIELD_QUESTS_PROCESS_START;b<SharedDef.MAP_INT_FIELD_QUESTS_PROCESS_END;b++)for(var c=0;4>c;c++){var d=this.GetByte(b,c);a.push(d)}return a},b.hasInit=!1,b.STATE_249=249,b.STATE_250=250,b.STATE_251=251,b}(GuidObject),Kuafu3V3dataVo=function(){function a(){this.name="1,2,没有极杰",this.group=1,this.gender=1,this.dieState=0,this.level=45,this.hprate=random(100)}return a.prototype.makeData=function(a,b,c,d){a.GetInt32(b+SharedDef.KUAFU_3V3_PLAYER_DAMAGE);this.gender=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_SHOW_INFO,0),this.hprate=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_SHOW_INFO,1),this.level=a.GetUInt16(b+SharedDef.KUAFU_3V3_PLAYER_SHOW_INFO,1),this.killnum=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_SETTLEMENT,0),this.dieState=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_SETTLEMENT,1),this.group=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_SETTLEMENT,2),this.jifen=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_SETTLEMENT,3),this.rongyu=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_HONOR,0),this.zuijia=a.GetByte(b+SharedDef.KUAFU_3V3_PLAYER_HONOR,1),this.shanghai=a.GetDouble(b+SharedDef.KUAFU_3V3_PLAYER_DAMAGE),this.name=a.GetStr(c+SharedDef.KUAFU_3V3_PLAYER_NAME)},a}(),EndVo=function(){function a(){}return a}(),FirstvictoryVo=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),StrengGuidObject=function(a){function b(b){void 0===b&&(b="");var c=a.call(this)||this;return c.AddListen(200,function(a){c.dataChg(a)}),c}return __extends(b,a),b.prototype.after_update=function(a,b,c,d){if(b==SyncEvent.OBJ_OPT_BINLOG)for(var e=0;8>e;e++){var f=SharedDef.APPD_LOGICAL_INFO_INT_FIELD_STRENGTH_START+SharedDef.EQUIP_PART_OPT_TYPE_ONE_PART_INFO_LENGTH*e;c.GetBit(f)}},b.prototype.dataChg=function(a){203==a.index},b.prototype.dataChgStr=function(a){},b}(GuidObject),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),skillUi;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._canclick=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._skillRender=new UIRenderComponent,b.addRender(b._skillRender),b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b._baseUiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bgRender.dispose(),this._bgRender=null,this._skillRender.dispose(),this._skillRender=null;for(var b=RedPointManager.getInstance().getNodeByID(15).children,c=0;c<b.length;c++)b[c].unBind();for(var d=RedPointManager.getInstance().getNodeByID(16).children,c=0;c<d.length;c++)d[c].unBind();this._redPointRender.dispose(),this._redPointRender=null,this._frameRender&&(this._frameRender.dispose(),this._frameRender=null),a.prototype.dispose.call(this)},b.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.w_close:this.hide();break;case this.zhudongbtn:UIManager.popClikNameFun("t_Allbtn0");var b=this.hasZhuDongUp();if(0==b)NetManager.getInstance().protocolos.raise_base_spell_all(SharedDef.RAISE_BASE_SKILL,this.getZhuDongUpStr());else if(1==b)msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"技能等级已达上限，请提升人物等级再来升级技能！",99);else{var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);c.data=3,ModuleEventManager.dispatchEvent(c)}break;case this.beidongbtn:var b=this.hasBeiDongUp();if(0==b)NetManager.getInstance().protocolos.raise_base_spell_all(SharedDef.RAISE_BASE_SKILL,this.getBeiDongUpStr());else if(1==b)msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"技能等级已达上限，请提升人物等级再来升级技能！",99);else if(3==b)msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"技能未解锁",99);else{var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);c.data=3,ModuleEventManager.dispatchEvent(c)}}},b.prototype.showSkillUpEff=function(){var a=this;console.log("up skill lev"),this._frameRender||(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ui_jn"),4,4,function(b){a.upLevEff=b,a.upLevEff.x=595,a.upLevEff.y=58,a.upLevEff.speed=1,a.upLevEff.playOne(a)})),this.upLevEff&&this.upLevEff.playOne(this)},b.prototype.getData=function(){var a=TableData.getInstance().getData(TableData.tb_char_skill,GuidData.player.getCharType());this.lockDic=new Object;for(var b=0;b<a.unlocks.length;b++)this.lockDic[a.unlocks[b][1]]=a.unlocks[b][0];for(var c=TableData.getInstance().getData(TableData.tb_skill_show,GuidData.player.getCharType()),e=c.zhudong_list,f=c.passive_list,g=new Array,b=0;b<e.length;b++){var h=new d;h.id=e[b],h.lev=GuidData.grow.getSkillLev(h.id),h.baseData=TableData.getInstance().getData(TableData.tb_skill_base,e[b]),h.levData=TableData.getInstance().getData(TableData.tb_skill_uplevel,h.baseData.uplevel_id[0]+h.lev-1),g.push(h),this.zhudongSkilUIList[b]&&this.zhudongSkilUIList[b].setData(h)}for(var i=new Array,b=0;b<f.length;b++){var h=new d;h.id=f[b],h.lev=GuidData.grow.getSkillLev(h.id),h.baseData=TableData.getInstance().getData(TableData.tb_skill_base,f[b]),h.levData=TableData.getInstance().getData(TableData.tb_skill_uplevel,h.baseData.uplevel_id[0]+h.lev-1),i.push(h),this.beidongSkilUIList[b]&&this.beidongSkilUIList[b].setData(h)}},b.prototype.hasZhuDongUp=function(){if(!this.zhudongSkilUIList)return 1;for(var a=GuidData.player.getLevel(),b=0,c=0,d=0;d<this.zhudongSkilUIList.length;d++){if(this.zhudongSkilUIList[d].redShow)return 0;this.zhudongSkilUIList[d].data&&(c++,this.zhudongSkilUIList[d].data.lev>=a&&b++)}return b==c?1:2},b.prototype.getZhuDongUpStr=function(){for(var a="",b=0;b<this.zhudongSkilUIList.length;b++)this.zhudongSkilUIList[b].redShow&&(a=a+this.zhudongSkilUIList[b].data.id+"|");return a},b.prototype.getBeiDongUpStr=function(){for(var a="",b=0;b<this.beidongSkilUIList.length;b++)this.beidongSkilUIList[b].redShow&&(a=a+this.beidongSkilUIList[b].data.id+"|");return a},b.prototype.hasBeiDongUp=function(){if(!this.beidongSkilUIList)return 1;for(var a=GuidData.player.getLevel(),b=0,c=0,d=0,e=0,f=0;f<this.beidongSkilUIList.length;f++){if(this.beidongSkilUIList[f].redShow)return 0;this.beidongSkilUIList[f].data&&(d++,this.beidongSkilUIList[f].data.lev>=a&&b++,0==this.beidongSkilUIList[f].data.lev?e++:c++)}return e==d?3:b==c?1:2},b.prototype.refreshLev=function(){for(var a=0;a<this.zhudongSkilUIList.length;a++)this.zhudongSkilUIList[a].refresh();for(var a=0;a<this.beidongSkilUIList.length;a++)this.beidongSkilUIList[a].refresh()},b.prototype.drawItemSkill=function(){},b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/skillui/skill.xml","ui/uidata/skillui/skill.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._skillRender.uiAtlas=this._baseUiAtlas,this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this.initUI(),this.resize(),this.applyLoadComplete()},b.prototype.initUI=function(){this.addUIList(["a_line","a_line1"],this._baseRender),this.addUIList(["t_bg","t_skill_bg","t_skill_bg1","t_skill_bg2","a_minbottom","a_maxcenter","a_maxbottom"],this.winmidRender),this.addIsUComponent("t_skill_bg_u",this.winmidRender),this.addIsUComponent("t_skill_bg1_u",this.winmidRender),this.addIsUComponent("t_skill_bg2_u",this.winmidRender),this.addIsUComponent("a_minbottom1",this.winmidRender),this.addIsUComponent("a_maxcenter1",this.winmidRender),this.addIsUComponent("a_maxbottom1",this.winmidRender),this.zhudongSkilUIList=new Array;for(var a=0;5>a;a++){var b=new c;b.panel=this,b.init(a,!0,this._skillRender,this._bgRender,this,this._redPointRender),this.zhudongSkilUIList.push(b)}this.beidongSkilUIList=new Array;for(var a=0;9>a;a++){var b=new c;b.panel=this,b.init(a,!1,this._skillRender,this._bgRender,this,this._redPointRender),this.beidongSkilUIList.push(b)}this.addUIList(["t_lab_bg","t_lab_bg1","t_win_title"],this._bgRender);var d;d=this.addChild(this._bgRender.getComponent("t_lab1")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,d.skinName,"主动技能",16,TextAlign.CENTER,ColorType.color9a683f),d=this.addChild(this._bgRender.getComponent("t_lab2")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,d.skinName,"被动技能",16,TextAlign.CENTER,ColorType.color9a683f),d=this.addChild(this._baseRender.getComponent("t_lab3")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,d.skinName,"技能效果",16,TextAlign.CENTER,ColorType.color9a683f),d=this.addChild(this._baseRender.getComponent("t_lab4")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,d.skinName,"学习条件",16,TextAlign.CENTER,ColorType.color9a683f),this.initSelSkilPanel(),this.getData(),this.setSel(this.zhudongSkilUIList[0])},b.prototype.initSelSkilPanel=function(){this.selSkillIcon=this.addChild(this._baseRender.getComponent("t_s_icon")),this.selSkillName=this.addChild(this._baseRender.getComponent("t_s_name")),this.selSkillForce=this.addChild(this._baseRender.getComponent("t_s_force")),this.selSkillLev=this.addChild(this._baseRender.getComponent("t_s_lev")),this.selSkillType=this.addChild(this._baseRender.getComponent("t_s_type")),this.selSkillDesc=this.addChild(this._baseRender.getComponent("t_s_cur")),this.selSkillCD=this.addChild(this._baseRender.getComponent("t_s_cur_cd")),this.nextSkillDesc=this.addChild(this._baseRender.getComponent("t_s_next")),this.nextSkillCD=this.addChild(this._baseRender.getComponent("t_s_next_cd")),this.selSkillLevLimt=this.addChild(this._baseRender.getComponent("t_s_up_lev")),this.selSkillCostLimt=this._baseRender.getComponent("t_s_up_cost"),this.selSkillCostIcon=this._baseRender.getComponent("t_s_up_icon"),this.zhudongbtn=this.addEvntButUp("t_Allbtn0",this._baseRender),this.beidongbtn=this.addEvntButUp("t_Allbtn1",this._baseRender),this.zhudongRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.zhudongbtn.x+this.zhudongbtn.width,this.zhudongbtn.y)),this.beidongRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.beidongbtn.x+this.beidongbtn.width,this.beidongbtn.y)),this.selSkillBtn=this._baseRender.getComponent("t_btn"),this.selSkillBtn.addEventListener(InteractiveEvent.Up,this.upClick,this),this.selRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.selSkillBtn.x+this.selSkillBtn.width,this.selSkillBtn.y))},b.prototype.upClick=function(a){var b=this;if(UiTweenScale.getInstance().changeButSize(a.target),this._canclick){if(this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0}),this._selectedData.lev>=GuidData.player.getLevel())return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"技能等级已达上限，请提升人物等级再来升级技能！",99);if(!hasEnoughRes(this._selectedData.levData.uplevel_cost[0])){var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return c.data=3,void ModuleEventManager.dispatchEvent(c)}NetManager.getInstance().protocolos.raise_base_spell(SharedDef.RAISE_BASE_SKILL,this._selectedData.id)}},b.prototype.drawSelSkill=function(a,b){this._selectedData=a,IconManager.getInstance().drawCircleIcon(this.selSkillIcon,2,a.baseData.id),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillName.skinName,a.baseData.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillLev.skinName,ColorType.Brown7a2f21+"等级："+ColorType.colorff7200+a.lev,14,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillType.skinName,ColorType.Brown7a2f21+"类型："+ColorType.color4392ff+(1==a.baseData.is_initiative?"主动":"被动"),14,TextAlign.LEFT),0==a.lev?(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillForce.skinName,"战力0",14,TextAlign.LEFT,ColorType.color9a683f),
LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillDesc.skinName,ColorType.Brown7a2f21+"当前效果："+ColorType.Green2ca937+"无",16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillCD.skinName,ColorType.Brown7a2f21+"冷却时间："+ColorType.color4392ff+"0秒",14,TextAlign.LEFT)):(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillForce.skinName,"战力"+a.levData.fight_value,14,TextAlign.LEFT,ColorType.color9a683f),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillDesc.skinName,ColorType.Brown7a2f21+"当前效果："+ColorType.Green2ca937+tb.SkillDataVo.getSkillDesc(a.id,a.lev),16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillCD.skinName,ColorType.Brown7a2f21+"冷却时间："+ColorType.color4392ff+(a.baseData.singleCD-a.levData.mcd)/1e3+"秒",14,TextAlign.LEFT));var c=TableData.getInstance().getData(TableData.tb_skill_uplevel,a.baseData.uplevel_id[0]+a.lev);a.lev>a.baseData.uplevel_id[1]-a.baseData.uplevel_id[0]&&(c=null),c?(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.nextSkillDesc.skinName,ColorType.Brown7a2f21+"下级效果："+ColorType.Green2ca937+tb.SkillDataVo.getSkillDesc(a.id,a.lev+1),16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.nextSkillCD.skinName,ColorType.Brown7a2f21+"冷却时间："+ColorType.color4392ff+(a.baseData.singleCD-c.mcd)/1e3+"秒",14,TextAlign.LEFT)):(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.nextSkillDesc.skinName,ColorType.Brown7a2f21+"下级效果："+ColorType.Green2ca937+"已满级",16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.nextSkillCD.skinName,ColorType.Brown7a2f21+"冷却时间："+ColorType.color4392ff+"0秒",14,TextAlign.LEFT)),0==a.lev?(this.selSkillLevLimt.x=this.selSkillLevLimt.baseRec.x+40,this.selSkillLevLimt.y=this.selSkillLevLimt.baseRec.y+32,this.selSkillCostLimt.parent&&this.removeChild(this.selSkillCostLimt),this.selSkillCostIcon.parent&&this.removeChild(this.selSkillCostIcon),this.selSkillBtn.parent&&this.removeChild(this.selSkillBtn),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillLevLimt.skinName,ColorType.Brown7a2f21+"解锁等级："+ColorType.colorff7200+this.lockDic[a.id],16,TextAlign.CENTER)):null==c?(this.selSkillLevLimt.x=this.selSkillLevLimt.baseRec.x+40,this.selSkillLevLimt.y=this.selSkillLevLimt.baseRec.y+32,this.selSkillCostLimt.parent&&this.removeChild(this.selSkillCostLimt),this.selSkillCostIcon.parent&&this.removeChild(this.selSkillCostIcon),this.selSkillBtn.parent&&this.removeChild(this.selSkillBtn),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillLevLimt.skinName,ColorType.Brown7a2f21+"已满级",16,TextAlign.CENTER)):(this.selSkillLevLimt.x=this.selSkillLevLimt.baseRec.x,this.selSkillLevLimt.y=this.selSkillLevLimt.baseRec.y,this.selSkillCostLimt.parent||this.addChild(this.selSkillCostLimt),this.selSkillCostIcon.parent||this.addChild(this.selSkillCostIcon),this.selSkillBtn.parent||this.addChild(this.selSkillBtn),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillLevLimt.skinName,ColorType.Brown7a2f21+"需求等级："+ColorType.colorff7200+a.levData.need_level,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.selSkillCostLimt.skinName,ColorType.Brown7a2f21+"需求"+getResName(a.levData.uplevel_cost[0][0])+"："+ColorType.color4392ff+Snum(a.levData.uplevel_cost[0][1]),16,TextAlign.LEFT)),b?this.selRedPoint.preShow():this.selRedPoint.preHide()},b.prototype.setSel=function(a){for(var b=0;b<this.zhudongSkilUIList.length;b++)this.zhudongSkilUIList[b]==a?a.selected=!0:this.zhudongSkilUIList[b].selected=!1;for(var b=0;b<this.beidongSkilUIList.length;b++)this.beidongSkilUIList[b]==a?a.selected=!0:this.beidongSkilUIList[b].selected=!1;this.drawSelSkill(a.data,a.redShow)},b.prototype.addIsUComponent=function(a,b){var c=b.getComponent(a);c.isU=!0,this.addChild(c)},b.prototype.showRedPoint=function(){this.zhudongRedPoint&&this.beidongRedPoint&&(0==this.hasZhuDongUp()?this.zhudongRedPoint.preShow():this.zhudongRedPoint.preHide(),0==this.hasBeiDongUp()?this.beidongRedPoint.preShow():this.beidongRedPoint.preHide())},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),SceneManager.getInstance().render=!1,this._baseRender.uiAtlas&&this.refreshLev(),this.showRedPoint()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),SceneManager.getInstance().render=!0,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),a.prototype.hide.call(this)},b}(WindowUi);a.SkillPanel=b;var c=function(){function a(){this._selected=!1}return a.prototype.init=function(a,b,c,d,e,f){var g=b?"a":"b",h="t_"+g+"s"+a;this.icon=c.getComponent(h),e.addChild(this.icon),h="t_"+g+"n"+a,this.name=c.getComponent(h),e.addChild(this.name),h="t_"+g+"l"+a,this.lev=c.getComponent(h),e.addChild(this.lev);var i;if(i=b?RedPointManager.getInstance().getNodeByID(15):RedPointManager.getInstance().getNodeByID(16),i.children[a]){var j=f.getRedPointUI(e,0,new Vector2D(this.icon.x+this.icon.width,this.icon.y),"style1");i.children[a].bindUI(j),this.redPoint=i.children[a]}this.icon.addEventListener(InteractiveEvent.Down,this.onClick,this)},Object.defineProperty(a.prototype,"redShow",{get:function(){return this.redPoint?this.redPoint.show:!1},enumerable:!0,configurable:!0}),a.prototype.onClick=function(a){this.data&&this.panel.setSel(this)},Object.defineProperty(a.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected!=a&&(this._selected=a,this.drawIcon())},enumerable:!0,configurable:!0}),a.prototype.setData=function(a){a&&(this.data=a,this.draw())},a.prototype.draw=function(){this.drawIcon(),LabelTextFont.writeSingleLabel(this.name.uiRender.uiAtlas,this.name.skinName,this.data.baseData.name,16,TextAlign.CENTER,ColorType.Orange7a2f21),this.drawLev()},a.prototype.drawIcon=function(){IconManager.getInstance().drawCircleIcon(this.icon,2,this.data.baseData.id,0==this.data.lev,null,this._selected)},a.prototype.drawLev=function(){this.data.lev>0?(this.lev.x=this.lev.baseRec.x,this.lev.y=this.lev.baseRec.y,this.drawApplyLev()):(this.lev.x=this.lev.baseRec.x-17,this.lev.y=this.lev.baseRec.y-22,LabelTextFont.writeSingleLabel(this.lev.uiRender.uiAtlas,this.lev.skinName,this.panel.lockDic[this.data.id]+"级解锁",16,TextAlign.CENTER,ColorType.Whitefff4d6))},a.prototype.drawApplyLev=function(){var a=this.lev.uiRender.uiAtlas.getRec(this.lev.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1);UiDraw.cxtDrawImg(b,PuiData.SKILL_LEV_BG,new Rectangle(8,1,53,18),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(b,String(this.data.lev),16,0,0,TextAlign.CENTER,ColorType.Whitefff4d6),this.lev.uiRender.uiAtlas.updateCtx(b,a.pixelX,a.pixelY)},a.prototype.refresh=function(){if(this.data){var a=GuidData.grow.getSkillLev(this.data.id);(a!=this.data.lev||this._selected)&&(0==this.data.lev&&(this.data.lev=a,this.drawIcon()),this.data.lev=a,this.data.levData=TableData.getInstance().getData(TableData.tb_skill_uplevel,this.data.baseData.uplevel_id[0]+a-1),this.drawLev(),this._selected&&this.panel.setSel(this))}},a}();a.SkillItemIcon=c;var d=function(){function a(){}return a}();a.SkillItemData=d}(skillUi||(skillUi={}));var skillUi;!function(a){var b=function(){function a(){}return a.ZHUDONG=0,a.NUQI=1,a.BEIDONG=2,a}();a.SkillBaseType=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getSeverSkillData=function(){this.makeZhuDonHasItem(),this.makePassiveData()},a.prototype.makeZhuDonHasItem=function(){this.zhudongHasItem=new Array;for(var a=GuidData.grow.getSpellInitFieldBaseSpeell(),b=0;b<a.length;b++){var c=new tb.SkillLevelVo;c.id=a[b].id,c.lev=a[b].lev,this.zhudongHasItem.push(c)}},a.prototype.makePassiveData=function(){this.passiveHasItem=new Array;for(var a=GuidData.player.getPlayerIntFieldPassiveSpell(),b=0;b<a.length;b++){var c=new tb.SkillLevelVo;c.id=a[b].id;for(var d=0;d<this.zhudongHasItem.length;d++)this.zhudongHasItem[d].id==c.id&&(c.lev=this.zhudongHasItem[d].lev);this.passiveHasItem.push(c)}},a.prototype.resetDataToSkillBaseDataVo=function(a){a.typtId=this.getSkillType(a.id),a.activation=this.isActivation(a.id),a.level=this.getSkillLevelById(a.id),this.setChooseInfoToVo(a),a.refresh()},a.prototype.setChooseInfoToVo=function(a){a.activation?a.level<a.maxLev?a.skillLearnVo=tb.SkillDataVo.getLevelUpInof(a.id,a.levelUpStat+a.level-1):a.typtId==b.NUQI?a.skillLearnVo=this.getupGradeUPInof(a.id):(a.skillLearnVo=null,a.showGreenUp=!1):a.tb_skill_base.study_requirement&&null!=a.tb_skill_base.study_requirement?a.skillLearnVo=null:a.skillLearnVo=this.getLearnInof(a.id),a.skillLearnVo?a.showGreenUp=tb.SkillDataVo.isCanUpLevel(a):a.showGreenUp=!1},a.prototype.getStrByTypeAndNum=function(b,c){var d="";switch(b){case 0:d=" 金币:";break;case 1:break;case 2:d=" 银俩:";break;case 3:break;case 4:break;case 5:break;case 6:d=" 真气:"}var e="";return e=a.haveMoneyType(b,c)?"[00ff00]"+d+c+"[]":"[ff0000]"+d+c+"[]"},a.haveMoneyType=function(a,b){var c=0;return c>=b},a.prototype.getupGradeUPInof=function(a){var b=TableData.getInstance().getData(TableData.tb_assistangerspell_upgrade,a);if(b){var c=new tb.SkillLearnVo;return c.resource=b.cost,c}return null},a.prototype.getLearnInof=function(a){var b=TableData.getInstance().getData(TableData.tb_learn_spell,a),c=new tb.SkillLearnVo;return c.parse(b),c},a.prototype.getSkillLevelById=function(a){for(var b=0;b<this.zhudongHasItem.length;b++)if(this.zhudongHasItem[b].id==a)return this.zhudongHasItem[b].lev;return 1},a.prototype.isActivation=function(a){for(var b=0;b<this.zhudongHasItem.length;b++)if(this.zhudongHasItem[b].id==a)return!0;for(var c=0;c<this.passiveHasItem.length;c++)if(this.passiveHasItem[c].id==a)return!0;return!1},a.prototype.getSkillType=function(a){for(var c=0;c<tb.SkillData.getInstance().zhudong_list.length;c++)if(tb.SkillData.getInstance().zhudong_list[c]==a)return b.ZHUDONG;for(var d=0;d<tb.SkillData.getInstance().anger_list.length;d++)if(tb.SkillData.getInstance().anger_list[d]==a)return b.NUQI;for(var e=0;e<tb.SkillData.getInstance().passive_list.length;e++)if(tb.SkillData.getInstance().passive_list[e]==a)return b.BEIDONG;return null},a.prototype.getSkillNameById=function(a){var b=TableData.getInstance().getData(TableData.tb_skill_base,a);return b.name},a.prototype.getAngerItem=function(){for(var a=new Array,b=0;b<tb.SkillData.getInstance().anger_list.length;b++)for(var c=tb.SkillData.getInstance().anger_list[b],d=0;d<tb.SkillData.getInstance().anger_list.length;d++)for(var d=0;d<this.zhudongHasItem.length;d++)this.zhudongHasItem[d].id==c&&a.push(c);return a},a.prototype.getMoneyType=function(a){var b="";return b},a}();a.SkillUiModel=c}(skillUi||(skillUi={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),skillUi;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"SkillUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.SkillUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_SKILLUI_EVENT="SHOW_SKILLUI_EVENT",b.HIDE_SKILLUI_EVENT="HIDE_SKILLUI_EVENT",b.SELECT_SKILLUI_TYPE_EVENT="SELECT_SKILLUI_TYPE_EVENT",b.SELECT_SKILLCONTENT_TYPE_EVENT="SELECT_SKILLCONTENT_TYPE_EVENT",b.SHOW_MAXVPPANEL_EVENT="SHOW_MAXVPPANEL_EVENT",b.HIDE_MAXVPPANEL_EVENT="HIDE_MAXVPPANEL_EVENT",b.RESET_SKILL_UI_DATA="RESET_SKILL_UI_DATA",b.SKILL_UP_EVENT="SKILL_UP_EVENT",b}(BaseEvent);a.SkillUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"SkillUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_SKILLUI_EVENT?this.showNewUI():b.type==c.HIDE_SKILLUI_EVENT||(b.type==c.SKILL_UP_EVENT?this.showSkillUpEff():b.type==c.RESET_SKILL_UI_DATA&&(this.refreshNode(),this.resetSkillUiData()))}else if(a instanceof EngineEvent){var d=a;d.type==EngineEvent.MONEY_CHANGE||d.type==EngineEvent.SYSTEM_OPEN_EVENT||d.type==EngineEvent.PLAYER_FIELD_LEVEL?this.refreshNode():d.type==EngineEvent.CORE_DATA_COMPLETE_EVENT&&this.initNode()}else if(a instanceof UIPanelEvent){var e=a;e.panel==this._skillPanel&&(this._skillPanel.dispose(),this._skillPanel=null,console.log("释放面板 _skillUiPanel"))}},d.prototype.resetSkillUiData=function(){this._skillPanel&&this._skillPanel.hasStage&&this._skillPanel.refreshLev()},d.prototype.showNewUI=function(){var b=this;this._skillPanel||(this._skillPanel=new a.SkillPanel),this._skillPanel.load(function(){var a=new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT);ModuleEventManager.dispatchEvent(a),b._skillPanel.show();var c=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);c.data=SharedDef.MODULE_SPELL,ModuleEventManager.dispatchEvent(c)})},d.prototype.showSkillUpEff=function(){this._skillPanel&&this._skillPanel.showSkillUpEff()},d.prototype.initNode=function(){for(var a=TableData.getInstance().getData(TableData.tb_skill_show,GuidData.player.getCharType()),b=a.zhudong_list,c=a.passive_list,d=RedPointManager.getInstance().getNodeByID(15),e=0;e<b.length;e++){var f=new RedPointNode;f.data=b[e],d.addChild(f)}d=RedPointManager.getInstance().getNodeByID(16);for(var e=0;e<c.length;e++){var f=new RedPointNode;f.data=c[e],d.addChild(f)}this.refreshNode()},d.prototype.refreshNode=function(){GuidData.player.getsyspageopen(SharedDef.MODULE_SPELL,SharedDef.MODULE_SPELL_ALL)&&(GuidData.player.isOpenSystemNeedShow(SharedDef.MODULE_SPELL)&&(this.refreshNodeByID(15),this.refreshNodeByID(16)),this._skillPanel&&this._skillPanel.showRedPoint())},d.prototype.refreshNodeByID=function(a){for(var b=!1,c=RedPointManager.getInstance().getNodeByID(a).children,d=GuidData.player.getLevel(),e=0;e<c.length;e++){var f=c[e].data,g=GuidData.grow.getSkillLev(f),h=TableData.getInstance().getData(TableData.tb_skill_base,f);if(h.uplevel_id[1]-h.uplevel_id[0]<g)c[e].show=!1;else{var i=TableData.getInstance().getData(TableData.tb_skill_uplevel,h.uplevel_id[0]+g-1);g>0&&hasEnoughRes(i.uplevel_cost[0])&&i.need_level<=d?(c[e].show=!0,b=!0):c[e].show=!1}}return b},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_SKILLUI_EVENT),new c(c.HIDE_SKILLUI_EVENT),new c(c.SELECT_SKILLUI_TYPE_EVENT),new c(c.SELECT_SKILLCONTENT_TYPE_EVENT),new c(c.SHOW_MAXVPPANEL_EVENT),new c(c.HIDE_MAXVPPANEL_EVENT),new c(c.RESET_SKILL_UI_DATA),new c(c.SKILL_UP_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.SkillUiProcessor=d}(skillUi||(skillUi={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),charbg;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.partNameAry=["武器","衣服","护手","腰带","鞋子","头饰","项链","手镯","戒指","腰坠"],a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a.setBlackBg(),a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/charbg/charinfo.xml","ui/uidata/charbg/charinfo.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.addChild(this.winmidRender.getComponent("t_bg")),this.addUIList(["t_win_title","t_title_bg"],this._bgRender);var a;a=this.addChild(this._baseRender.getComponent("t_btn1")),a.addEventListener(InteractiveEvent.Down,this.delread,this),a=this.addChild(this._baseRender.getComponent("t_btn2")),a.addEventListener(InteractiveEvent.Down,this.getAll,this),this.charName=this.addChild(this._baseRender.getComponent("t_name")),this.charVip=this.addChild(this._baseRender.getComponent("t_vip")),this.charTitle=this.addChild(this._baseRender.getComponent("t_title")),this.equIconAry=new Array;for(var b=0;10>b;b++)this.equIconAry.push(this.addChild(this._baseRender.getComponent("t_i"+b))),this.equIconAry[b].addEventListener(InteractiveEvent.Up,this.equclick,this);this.uiAtlasComplet=!0,this.addPersonChar(),this.applyLoadComplete()},c.prototype.equclick=function(b){var c=b.target.data;if(c){var d=new a.ItemTipEvent(a.ItemTipEvent.SHOW_TIP_ITEM_EVENT);d.data=c,d.buttonType=6,ModuleEventManager.dispatchEvent(d)}},c.prototype.draw=function(a){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.charName.skinName,getBaseName(a.spo.name),16,TextAlign.CENTER,ColorType.Brown7a2f21);for(var b=new Object,c=0;c<a.equAry.length;c++){var d=a.equAry[c].equip,e=BagData.paserItemData(d);e.qhGemData=a.equAry[c],b[e.entryData.pos]=e}for(var c=0;c<this.equIconAry.length;c++){var e=b[c+1];e?IconManager.getInstance().drawItemIcon60(this.equIconAry[c],e.entry,1,!1,!1):this.setNoEquIcon(this.equIconAry[c].skinName,c),this.equIconAry[c].data=e}this.showDisPlay.setBaseRoleAvatar(a.spo.coat,a.spo.gender),this.showDisPlay.setBaseRoleWeapon(a.spo.weapon,a.spo.gender),IconManager.getInstance().drawVip(this.charVip,a.spo.vip),a.spo.title>0?this._baseUiAtlas.upDataPicToTexture(getUItittleUrl(String(a.spo.title)),this.charTitle.skinName):UiDraw.clearUI(this.charTitle)},c.prototype.setNoEquIcon=function(a,b){var c=this._baseUiAtlas.getRec(a),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(d,this.partNameAry[b],16,0,25,TextAlign.CENTER,ColorType.Brownac8965),this._baseUiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.delread=function(a){NetManager.getInstance().protocolos.social_add_friend(this._data.spo.guid)},c.prototype.getAll=function(a){return""==GuidData.player.getFactionID()?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"您还没有加入家族",99):void NetManager.getInstance().protocolos.send_faction_invite(this._data.spo.guid)},c.prototype.addPersonChar=function(){var a=new Person2DChar;this.wintopRender.addModel(a),this.showDisPlay=a,this.resize()},c.prototype.resize=function(){b.prototype.resize.call(this),this.showDisPlay&&(this.showDisPlay.resize(),this.showDisPlay.scale=5*UIData.Scale,this.showDisPlay.x=-20*UIData.Scale,this.showDisPlay.y=-130*UIData.Scale)},c.prototype.butClik=function(a){a.target==this.e_close&&this.hide()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.show=function(a){this._data=a,this.draw(a),UIManager.getInstance().addUIContainer(this)},c}(WindowMinUi);a.CharInfoPanel=b}(charbg||(charbg={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),charbg;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b._currentShowVip=0,b._currentVip=0,b._maxVip=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b.setBlackBg(),b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/charbg/vip.xml","ui/uidata/charbg/vip.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this._midRender.uiAtlas=this._baseUiAtlas,this._topRender.uiAtlas=this._baseUiAtlas,this.addUIList(["t_title_bg","t_main_bg"],this.winmidRender),this.addUIList(["t_bg1","t_bg","t_pro_bg","t_vip_big","t_win_title"],this._bgRender),this.addUIList(["t_yun1","t_yun","t_vip_min","t_chongzhi_lab1"],this._midRender),this.addUIList(["t_lab_bg1","t_lab_bg"],this._baseRender);this.leftBtn=this.addChild(this._bgRender.getComponent("t_arr1")),this.leftBtn.isU=!0,this.leftBtn.addEventListener(InteractiveEvent.Up,this.leftclick,this),this.rightBtn=this.addChild(this._bgRender.getComponent("t_arr2")),this.rightBtn.addEventListener(InteractiveEvent.Up,this.rightclick,this),this.vipNum=this.addChild(this._baseRender.getComponent("t_vip_big_num")),this.buyBtn=this._baseRender.getComponent("t_btn_bg"),this.buyBtn.addEventListener(InteractiveEvent.Up,this.buyGift,this),this.chongzhiLab1=this.addChild(this._midRender.getComponent("t_chongzhi_lab2")),this.chongzhiLab2=this.addChild(this._midRender.getComponent("t_chongzhi_lab3")),this.chongzhiLab3=this.addChild(this._midRender.getComponent("t_chongzhi_lab4")),this.chongzhiProgre=this.addChild(this._midRender.getComponent("t_pro")),this.chongzhiExp=this.addChild(this._baseRender.getComponent("t_chongzhi_pro")),this.giftTitle=this.addChild(this._midRender.getComponent("t_gift_title")),this.giftIconAry=new Array;for(var a=0;6>a;a++)this.giftIconAry.push(this.addChild(this._baseRender.getComponent("t_icon"+a)));this.giftLab1=this.addChild(this._topRender.getComponent("t_gift_lab1")),this.giftLab2=this.addChild(this._topRender.getComponent("t_gift_lab2")),this.giftBtnLab=this.addChild(this._topRender.getComponent("t_btn_lab")),this.infoLab1=this.addChild(this._baseRender.getComponent("t_vip_min_num")),this.infoLab2=this.addChild(this._baseRender.getComponent("t_vip_min_lab")),this.infoTitle=this.addChild(this._baseRender.getComponent("t_tq_title")),this.infoContent=this.addChild(this._baseRender.getComponent("t_tq_content")),this.uiAtlasComplet=!0,this.draw(),this.applyLoadComplete()},b.prototype.buyGift=function(a){UiTweenScale.getInstance().changeButSize(a.target),NetManager.getInstance().protocolos.buy_vipgift(this._currentShowVip)},b.prototype.draw=function(){var a=GuidData.player.getVipLevel();this._currentShowVip=a,this.drawBaseVip(),this.drawVipInfo(a),this.setBtnVisible()},b.prototype.redrawVipInfo=function(){this.drawVipInfo(this._currentShowVip)},b.prototype.drawBaseVip=function(){var a=GuidData.player.getVipLevel();this._currentVip=a;var b=(TableData.getInstance().getData(TableData.tb_vip_base,a),TableData.getInstance().getData(TableData.tb_vip_base,a+1)),c=GuidData.player.getChongZhiSum();this._maxVip=TableData.getInstance().getTabSize(TableData.tb_vip_base)-1,this._maxVip=Math.min(a+8,this._maxVip),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.chongzhiExp.skinName,c+"/"+b.chongzhi,16,TextAlign.CENTER,ColorType.Whiteffffff),this.chongzhiProgre.uvScale=c/b.chongzhi,ArtFont.getInstance().writeFontToSkinName(this._baseUiAtlas,this.vipNum.skinName,String(a),ArtFont.num60);var d=b.chongzhi-c,e=ArtFont.getInstance().writeFontToSkinName(this._baseUiAtlas,this.chongzhiLab1.skinName,String(d),ArtFont.num59);this.chongzhiLab2.x=this.chongzhiLab2.baseRec.x+e,this.chongzhiLab3.x=this.chongzhiLab3.baseRec.x+e,ArtFont.getInstance().writeFontToSkinName(this._baseUiAtlas,this.chongzhiLab3.skinName,String(a+1),ArtFont.num59)},b.prototype.drawVipInfo=function(a){var b=TableData.getInstance().getData(TableData.tb_vip_base,a);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.giftTitle.skinName,"VIP"+a+"特权礼包",16,TextAlign.CENTER,ColorType.colorb96d49);for(var c=0;c<this.giftIconAry.length;c++)b.gift[c]?IconManager.getInstance().drawItemIcon60(this.giftIconAry[c],b.gift[c][0],b.gift[c][1]):IconManager.getInstance().drawItemIcon60(this.giftIconAry[c],0,1);this.drawPrice(this.giftLab1,"原价：",b.fake_cost,!0),this.drawPrice(this.giftLab2,"现价：",b.cost,!1),GuidData.player.getVIPBuyGift(a)?(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.giftBtnLab.skinName,"已购买",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.removeChild(this.buyBtn)):this._currentVip<a?(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.giftBtnLab.skinName,"VIP"+a+"可购买",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.removeChild(this.buyBtn)):(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.giftBtnLab.skinName,"购买",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.addChild(this.buyBtn));var d=ArtFont.getInstance().writeFontToSkinName(this._baseUiAtlas,this.infoLab1.skinName,String(a),ArtFont.num58);this.infoLab2.x=this.infoLab2.baseRec.x+d,LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.infoTitle.skinName,"【充"+b.chongzhi+"元可升级到该级VIP】",16,TextAlign.CENTER,ColorType.colorb96d49);var e=String(b.desc).replace(/\\n/g,"\n");LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.infoContent.skinName,e,16,TextAlign.LEFT,ColorType.Brown7a2f21)},b.prototype.drawPrice=function(a,b,c,d){var e=this._baseUiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1),g=20;g+=LabelTextFont.writeSingleLabelToCtx(f,b,16,g,10,TextAlign.LEFT,ColorType.Brown7a2f21),UiDraw.drawCost(f,g,0,getresIdByreward(c[0][0])),g+=35,g+=LabelTextFont.writeSingleLabelToCtx(f,String(c[0][1]),16,g,10,TextAlign.LEFT,ColorType.Brown7a2f21),d&&(f.strokeStyle="#cd2000",f.lineWidth=3,f.beginPath(),f.moveTo(5,17),f.lineTo(g+5,17),f.stroke(),f.closePath()),this._baseUiAtlas.updateCtx(f,e.pixelX,e.pixelY)},b.prototype.rightclick=function(a){this._currentShowVip!=this._maxVip&&(UiTweenScale.getInstance().changeButSize(a.target),this._currentShowVip++,this.drawVipInfo(this._currentShowVip),this.setBtnVisible())},b.prototype.leftclick=function(a){0!=this._currentShowVip&&(UiTweenScale.getInstance().changeButSize(a.target),this._currentShowVip--,this.drawVipInfo(this._currentShowVip),this.setBtnVisible())},b.prototype.setBtnVisible=function(){this._currentShowVip<=0?this.removeChild(this.leftBtn):this.addChild(this.leftBtn),this._currentShowVip>=this._maxVip?this.removeChild(this.rightBtn):this.addChild(this.rightBtn)},b.prototype.butClik=function(a){a.target==this.e_close&&this.hide()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.show=function(){this.draw(),UIManager.getInstance().addUIContainer(this)},b}(WindowMinUi);a.VipPanel=b}(charbg||(charbg={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),charbg;!function(a){var b=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a.equUpDown=!1,a.disableEqu=!1,a}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.baseui=this.creatSUI(d,this.parentTarget.baseAtlas,"s_item",0,0,68,68),a.addChild(this.baseui),this.baseui.addEventListener(InteractiveEvent.Up,this.equClick,this)},c.prototype.render=function(a){this.itdata=a,this.draw()},c.prototype.drawUpDown=function(){if(this.itdata){var a=this.itdata.data;if(a){var b=!1;if(1==a.entryData.type){var c=GuidData.bag.getEquByPart(a.entryData.pos);c?a.data.propData.force>c.data.propData.force&&(b=!0):b=!0}b!=this.equUpDown&&this.draw()}}},c.prototype.draw=function(){this.itdata&&this.itdata.data?this.applyrender():this.setnull()},c.prototype.testGender=function(a){if(a.availableGender){var b=a.availableGender.indexOf(GuidData.player.getCharType());return-1!=b}return!1},c.prototype.setnull=function(){var a=this._baseRender.uiAtlas.getRec(this.baseui.skinName),b=UIManager.getInstance().getContext2D(68,68,!1);UiDraw.cxtDrawImg(b,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),this._baseRender.uiAtlas.updateCtx(b,a.pixelX,a.pixelY)},c.prototype.applyrender=function(){var a=this,b=this.itdata.data;if(!b){var c=this._baseRender.uiAtlas.getRec(this.baseui.skinName),d=UIManager.getInstance().getContext2D(68,68,!1);return UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),void this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)}if(1==b.entryData.type){var e=GuidData.bag.getEquByPart(b.entryData.pos);this.equUpDown=!1,e?b.data.propData.force>e.data.propData.force&&(this.equUpDown=!0):this.equUpDown=!0,this.disableEqu=!this.testGender(b.entryData)}IconManager.getInstance().getIcon(geteqiconIconUrl(b.entryData.icon),function(c){var d=a._baseRender.uiAtlas.getRec(a.baseui.skinName),e=UIManager.getInstance().getContext2D(68,68,!1);if(UiDraw.cxtDrawImg(e,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(e,ItemGoodQuality.getQuaStr(b.entryData.quality),new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(c,0,0,60,60,4,4,60,60),1==b.entryData.type)UiDraw.cxtDrawImg(e,PuiData.A_EQULEVBG,new Rectangle(4,4,41,17),UIData.publicUi),ArtFont.getInstance().writeFontToCtxCenten(e,String(b.entryData.level),ArtFont.num63,18,4,4),a.disableEqu?UiDraw.cxtDrawImg(e,PuiData.EQUBG,new Rectangle(4,4,60,60),UIData.publicUi):b.entryData.level>GuidData.player.getLevel()?UiDraw.cxtDrawImg(e,PuiData.DISABLE,new Rectangle(42,40,23,23),UIData.publicUi):UiDraw.cxtDrawImg(e,a.equUpDown?PuiData.ARROWUP:PuiData.ARROWDOWN,new Rectangle(45,40,17,21),UIData.publicUi);else if(b.count>1){var f=String(b.count);LabelTextFont.writeSingleLabelToCtx(e,f,16,55-e.measureText(f).width,43,TextAlign.LEFT,ColorType.Whitefff4d6,"#27262e")}a.selected&&UiDraw.cxtDrawImg(e,PuiData.A_HIGHT_F,new Rectangle(2,2,64,64),UIData.publicUi),a._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},c.prototype.equClick=function(b){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(b.x,b.y),10))return;this.setSelect();var c=new a.ItemTipEvent(a.ItemTipEvent.SHOW_TIP_ITEM_EVENT);c.data=this.itdata.data,c.buttonType=2,ModuleEventManager.dispatchEvent(c)}},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.itdata&&this.applyrender()},enumerable:!0,configurable:!0}),c.prototype.refreshDraw=function(){this.draw()},c}(SListItem);a.BagItemRender=b;var c=function(a){function c(){var b=a.call(this)||this;return b.center=205,b.middle=0,b}return __extends(c,a),c.prototype.initData=function(){var a=new Array;this.setData(a,b,350,350,70,70,5,512,1024,5,10)},c.prototype.refreshDrawUpDow=function(){for(var a=0;a<this._itemList.length;a++){var b=this._itemList[a];b.drawUpDown()}},c}(SList);a.BagList=c;var d=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.selcetTabId=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b._baseRender=new UIRenderComponent,b.addRender(b._bgRender),b.addRender(b._baseRender),b._bgList=new c,b}return __extends(b,a),b.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),UIManager.getInstance().addUIContainer(this._bgList);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_BAG,ModuleEventManager.dispatchEvent(a);
},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),UIManager.getInstance().removeUIContainer(this._bgList)},b.prototype.setUIAtlas=function(a){this._baseRender.uiAtlas=a,this._bgRender.uiAtlas=a,this._bgList.baseAtlas=a,this._bgList.initData(),this.loadConfigCom()},b.prototype.loadConfigCom=function(){var a=this._bgRender;this.b_tab0=a.getComponent("b_tab0"),this.addChild(this.b_tab0),this.b_tab0.data=BagData.TYPE_EQU_BG,this.b_tab0.addEventListener(InteractiveEvent.Down,this.butClik,this),this.b_tab1=a.getComponent("b_tab1"),this.addChild(this.b_tab1),this.b_tab1.data=BagData.TYPE_BAG,this.b_tab1.addEventListener(InteractiveEvent.Down,this.butClik,this),this.b_tab2=a.getComponent("b_tab2"),this.addChild(this.b_tab2),this.b_tab2.data=BagData.TYPE_GEM,this.b_tab2.addEventListener(InteractiveEvent.Down,this.butClik,this);var b=this._baseRender.getComponent("b_zhengli");this.addChild(b),b.addEventListener(InteractiveEvent.Down,this.onZhengli,this),this.addChild(this._baseRender.getComponent("a_win_line2")),this._bagNum=this._baseRender.getComponent("b_bag_num"),this.addChild(this._bagNum),this.uiAtlasComplet=!0,this.selectTab(this.b_tab0)},b.prototype.onZhengli=function(a){var b;this.selcetTabId==BagData.TYPE_BAG?b=0:this.selcetTabId==BagData.TYPE_EQU_BG?b=2:this.selcetTabId==BagData.TYPE_GEM&&(b=3),NetManager.getInstance().protocolos.bag_item_sort(b)},b.prototype.refreshNum=function(a,b){var c=a+"/"+b;UiDraw.drawTxtLab(this._bagNum,ColorType.Brown7a2f21+c,14,TextAlign.CENTER)},b.prototype.drawUpDown=function(){this._bgList.refreshDrawUpDow()},b.prototype.drawEquDis=function(){this._bgList.refreshDraw()},b.prototype.bgDataChg=function(a,b){if(b==this.selcetTabId){for(var c=0;c<a.length;c++){var d=GuidData.bag.getBgItemData(a[c],b);d?this._bgList.setItemData(d,d.pos):this._bgList.clearItemByPos(a[c])}this.refreshNum(GuidData.bag.getBagNum(this.selcetTabId),GuidData.bag.getBagSize(this.selcetTabId))}},b.prototype.refreshListData=function(a){var b,c=new Array,d=GuidData.bag.getBagSize(a);if(a==BagData.TYPE_BAG)b=GuidData.bag.getAllBgData();else if(a==BagData.TYPE_EQU_BG)b=GuidData.bag.getEquBgData();else{if(a!=BagData.TYPE_GEM)return;b=GuidData.bag.getGemBgData()}for(var e=0;d>e;e++){var f=new SListItemData;f.data=b[e],c.push(f)}this._bgList.refreshData(c),this.refreshNum(GuidData.bag.getBagNum(a),d)},b.prototype.refreshItem=function(){},b.prototype.itemDataClick=function(a){},b.prototype.butClik=function(a){this.selectTab(a.target)},b.prototype.selectTab=function(a){a==this.b_tab0?(this.b_tab0.selected=!0,this.b_tab1.selected=!1,this.b_tab2.selected=!1):a==this.b_tab1?(this.b_tab0.selected=!1,this.b_tab1.selected=!0,this.b_tab2.selected=!1):a==this.b_tab2&&(this.b_tab0.selected=!1,this.b_tab1.selected=!1,this.b_tab2.selected=!0),this.refreshData(a.data)},b.prototype.refreshData=function(a){this.selcetTabId=a,this.uiAtlasComplet&&this.refreshListData(a)},b}(UIConatiner);a.BagPanel=d}(charbg||(charbg={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BagData=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.onBaseCreated=function(){var a=this;this.readData(),this._after_update=function(b,c,d){a.updateData(c,d)},this.initData()},b.prototype.readData=function(){for(var a="",b=9;23>=b;b++)a+=b+":"+this.GetUInt16(b,0)+",",a+=this.GetUInt16(b,1)+"\n";for(b=128;180>b;b++)a+=b+":"+this.GetUInt32(b)+"\n"},b.prototype.getBagSize=function(a){void 0===a&&(a=0),a==b.TYPE_BAG?a=0:a==b.TYPE_EQU_BG?a=2:a==b.TYPE_GEM&&(a=3);var c=9+float2int(a/2),d=a%2;return this.GetUInt16(c,d)},b.prototype.getBagNum=function(a){return void 0===a&&(a=0),a==b.TYPE_BAG?this.getListSize(this._bgList):a==b.TYPE_EQU_BG?this.getListSize(this._equBgList):a==b.TYPE_GEM?this.getListSize(this._gemBgList):0},b.prototype.getListSize=function(a){for(var b=0,c=0;c<a.length;c++)a[c]&&b++;return b},b.prototype.initData=function(){this.getAllBgData(),this.getEquData(),this.getEquBgData(),this.getGemBgData(),this.processRedPoint(),ModuleEventManager.dispatchEvent(new EngineEvent(EngineEvent.CORE_DATA_CREATED_EVENT))},b.prototype.getAllBgData=function(){if(this._bgList)return this._bgList;var a=new Array;for(var b in this._str_values){var c=Number(b);if(c>=128){var d=this.getItmeData(c);d&&d.pos<1e3&&(a[d.pos]=d)}}return this._bgList=a,a},b.prototype.getEquBgData=function(){if(this._equBgList)return this._equBgList;var a=new Array;for(var b in this._str_values){var c=Number(b);if(c>=128){var d=this.getItmeData(c);d&&d.pos>=2e3&&d.pos<3e3&&(d.pos-=2e3,a[d.pos]=d)}}return this._equBgList=a,a},b.prototype.getGemBgData=function(){if(this._gemBgList)return this._gemBgList;var a=new Array;for(var b in this._str_values){var c=Number(b);if(c>=128){var d=this.getItmeData(c);d&&d.pos>=3e3&&d.pos<4e3&&(d.pos-=2e3,a[d.pos]=d)}}return this._gemBgList=a,a},b.prototype.getBgItemData=function(a,c){var d;return c==b.TYPE_BAG?d=this.getAllBgData():c==b.TYPE_EQU_BG?d=this.getEquBgData():c==b.TYPE_GEM&&(d=this.getGemBgData()),d[a]},b.prototype.getBagAllItemCount=function(){var a=0;for(var b in this._str_values){var c=Number(b);if(c>=128){var d=this.getItmeData(c);d&&d.pos<1e3&&a++}}return a},b.prototype.hasItem=function(a,b){void 0===b&&(b=1);for(var c=this.getAllBgData(),d=0,e=0;e<c.length;e++)if(c[e]&&c[e].entry==a&&(d+=c[e].count,d>=b))return!0;return!1},b.prototype.getItemCount=function(a){for(var b=this.getAllBgData(),c=0,d=0;d<b.length;d++)b[d]&&b[d].entry==a&&(c+=b[d].count);return c},b.prototype.getItemByEntry=function(a){for(var b=this.getAllBgData(),c=0;c<b.length;c++)if(b[c]&&b[c].entry==a)return b[c];return null},b.prototype.getItemByEntryCopy=function(a){for(var b=this.getGemBgData(),c=0;c<b.length;c++)if(b[c]&&b[c].entry==a)return b[c];return null},b.prototype.getEmptyPos=function(){for(var a=this.getAllBgData(),b=new Array,c=0;c<a.length;c++)a[c]&&b.push(a[c].pos);for(var d=this.getBagSize(),c=0;d>c;c++)if(-1==b.indexOf(c))return c;return-1},b.prototype.getEmptyEquBagPos=function(){for(var a=this.getEquBgData(),b=new Array,c=0;c<a.length;c++)a[c]&&b.push(a[c].pos);for(var d=this.getBagSize(2),c=0;d>c;c++)if(-1==b.indexOf(c))return c;return-1},b.prototype.getEquData=function(){return this._equList?this._equList:(this.refreshEquData(),this._equList)},b.prototype.getEquPart=function(a){return this.getEquData()[a]},b.prototype.refreshEquData=function(){var a=new Array;for(var b in this._str_values){var c=Number(b);if(c>=128){var d=this.getItmeData(c);d&&d.pos>=1e3&&d.pos<2e3&&(d.pos-=1e3,a[d.pos]=d)}}this._equList=a},b.prototype.refreshBagDataChange=function(a,b){if(this._equList&&this._bgList){var c=new Array,d=new Array,e=new Array,f=new Array;for(var g in this._str_values){var h=Number(g);if(h>=128){var i=this.getItemPos(h);i>=0&&1e3>i?d[i]=h:2e3>i?(i-=1e3,c[i]=h):3e3>i?(i-=2e3,e[i]=h):4e3>i&&(i-=3e3,f[i]=h)}}this.processEquChg(c,b),this.processBagChg(d,b),this.processEquBagChg(e,b),this.processGemBagChg(f,b)}},b.prototype.processEquChg=function(a,c){for(var d=Math.max(this._equList.length,a.length),e=new Array,f=0;d>f;f++){var g=!1;a[f]?this._equList[f]?c[this._equList[f].dataIndex]?g=!0:this._equList[f].dataIndex!=a[f]&&(g=!0):g=!0:this._equList[f]&&(g=!0),g&&(this._equList[f]=this.getItmeData(a[f]),this._equList[f]&&(this._equList[f].pos-=1e3),e.push(f))}if(e.length){var h=new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT);h.showType=b.TYPE_EQU,h.data=e,ModuleEventManager.dispatchEvent(h)}},b.prototype.processBagChg=function(a,c){for(var d=Math.max(this._bgList.length,a.length),e=new Array,f=new Array,g=0;d>g;g++){var h=!1;a[g]?this._bgList[g]?c[this._bgList[g].dataIndex]?h=!0:this._bgList[g].dataIndex!=a[g]&&(h=!0):h=!0:this._bgList[g]&&(h=!0),h&&(this._bgList[g]=this.getItmeData(a[g]),e.push(g),this._bgList[g]&&f.push(this._bgList[g].entry))}if(e.length){var i=new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT);i.showType=b.TYPE_BAG,i.data=e,i.change=f,ModuleEventManager.dispatchEvent(i)}},b.prototype.bindItemFun=function(a,b){},b.prototype.unBindItemFun=function(a){},b.prototype.processEquBagChg=function(a,c){for(var d=Math.max(this._equBgList.length,a.length),e=new Array,f=0;d>f;f++){var g=!1;a[f]?this._equBgList[f]?c[this._equBgList[f].dataIndex]?g=!0:this._equBgList[f].dataIndex!=a[f]&&(g=!0):g=!0:this._equBgList[f]&&(g=!0),g&&(this._equBgList[f]=this.getItmeData(a[f]),this._equBgList[f]&&(this._equBgList[f].pos-=2e3),e.push(f))}if(e.length){var h=new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT);h.showType=b.TYPE_EQU_BG,h.data=e,ModuleEventManager.dispatchEvent(h),this.processRedPoint()}},b.prototype.processRedPoint=function(){var a=this.getBagNum(b.TYPE_EQU_BG),c=this.getBagSize(b.TYPE_EQU_BG);a=c-a,5>=a&&c>0?RedPointManager.getInstance().getNodeByID(2).show=!0:RedPointManager.getInstance().getNodeByID(2).show=!1,this.setBagAlert()},b.prototype.setBagAlert=function(){var a=this.getBagNum(b.TYPE_EQU_BG),c=this.getBagSize(b.TYPE_EQU_BG);a=c-a,GameInstance.first&&1>a&&c>0&&AlertUtil.show("背包已满，是否前往熔炼？","",function(a){1==a&&ModulePageManager.openPanel(SharedDef.MODULE_RONGLIAN)},2,["前往熔炼","取消"])},b.prototype.processGemBagChg=function(a,c){for(var d=Math.max(this._gemBgList.length,a.length),e=new Array,f=0;d>f;f++){var g=!1;a[f]?this._gemBgList[f]?c[this._gemBgList[f].dataIndex]?g=!0:this._gemBgList[f].dataIndex!=a[f]&&(g=!0):g=!0:this._gemBgList[f]&&(g=!0),g&&(this._gemBgList[f]=this.getItmeData(a[f]),this._gemBgList[f]&&(this._gemBgList[f].pos-=3e3),e.push(f))}if(e.length){var h=new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT);h.showType=b.TYPE_GEM,h.data=e,ModuleEventManager.dispatchEvent(h)}},b.prototype.getEquByPart=function(a){var b=this.getEquData();return b[a]},b.prototype.getItemPos=function(a){var b=this._str_values[a];return b&&""!=b?this.GetUInt32(a):-1},b.prototype.getItmeData=function(a){var c=this._str_values[a];if(!c||""==c)return null;var d=b.paserItemData(c);return d.pos=this.GetUInt32(a),d.dataIndex=a,d},b.paserItemData=function(a){var c=a.split(";"),d=new BagItemData;d.id=Number(c[0]),d.entry=Number(c[1]),d.count=Number(c[2]),d.flags=Number(c[3]);var e=new ItemData;return e.propData=JSON.parse(c[4]),e.AttrData=b.getNumFromStr(c[5]),d.data=e,d.entryData=TableData.getInstance().getData(TableData.tb_item_template,d.entry),d},b.getNumFromStr=function(a){if(!a)return new Array;for(var b=a.split(","),c=new Array,d=0;d<b.length;d++)c.push(Number(b[d]));return c},b.prototype.getPos=function(a){return this.GetUInt32(a)},b.prototype.updateData=function(a,b){this.refreshBagDataChange(a,b)},b.prototype.getPlayerGuid=function(){return this._str_values[0]},b.prototype.useItem=function(){var a=this.getPlayerGuid()+";1";NetManager.getInstance().protocolos.bag_item_user(a,1)},b.TYPE_EQU=0,b.TYPE_BAG=1,b.TYPE_EQU_BG=2,b.TYPE_GEM=3,b.uipos=new Vector2D,b}(GuidObject),BagItemData=function(){function a(){}return Object.defineProperty(a.prototype,"guid",{get:function(){return GuidData.bag.getPlayerGuid()+";"+this.id},enumerable:!0,configurable:!0}),a}(),ItemData=function(){function a(){}return a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BaseTip=function(a){function b(){var b=a.call(this)||this;return b._needBtn=!0,b.quaNameAry=["凡品","良品","上品","精品","极品","圣品"],b.colorNameAry=["白色","绿色","蓝色","紫色","橙色","红色"],b.quaColorAry=["#ffffff","#56da35","#4392ff","#b759ff","#ff7200","#ce0a00"],b.dynamicPosList=new Array,b._baseRender=new UIRenderComponent,b._bgRender=new UIRenderComponent,b._nextRender=new UIRenderComponent,b.addRender(b._bgRender),b.addRender(b._baseRender),b.addRender(b._nextRender),b}return __extends(b,a),b.prototype.setUIAtlas=function(a){this._uiAtlas=a,this._baseRender.uiAtlas=a,this._bgRender.uiAtlas=a,this._nextRender.uiAtlas=a,this.initBase()},b.prototype.show=function(a,b){this._data=a,this._entryData=this._data.entryData,this._btnType=b,-1==b||3==b||6==b?this._needBtn=!1:this._needBtn=!0,this.hasStage||(UIManager.getInstance().addUIContainer(this),Scene_data.uiStage.addEventListener(InteractiveEvent.Down,this.clickEvt,this)),this.refresh()},b.prototype.showBtn=function(){},b.prototype.hide=function(){this.hasStage&&(UIManager.getInstance().removeUIContainer(this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Down,this.clickEvt,this))},b.prototype.clickEvt=function(a){this.hide()},b.prototype.refresh=function(){this.refreshIconName(),this.showBtn()},b.prototype.refreshIconName=function(){var a=this;IconManager.getInstance().getIcon(geteqiconIconUrl(this._entryData.icon),function(b){var c=a._uiAtlas.getRec(a._t_icon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(d,ItemGoodQuality.getQuaStr(a._entryData.quality),new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(b,0,0,60,60,4,4,60,60),1==a._entryData.type&&(UiDraw.cxtDrawImg(d,PuiData.A_EQULEVBG,new Rectangle(4,4,41,17),UIData.publicUi),ArtFont.getInstance().writeFontToCtxCenten(d,String(a._entryData.level),ArtFont.num63,18,4,4)),a._uiAtlas.updateCtx(d,c.pixelX,c.pixelY)}),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_name.skinName,this._entryData.name,18,TextAlign.LEFT,this.getColorQua(this._entryData.quality))},b.prototype.getQuaName=function(a){return this.quaNameAry[a]},b.prototype.getColorName=function(a){return this.colorNameAry[a]},b.prototype.getColorQua=function(a){return this.quaColorAry[a]},b.prototype.getNumColor=function(a){switch(a){case 0:return ArtFont.num16;case 1:return ArtFont.num7;case 2:return ArtFont.num17;case 3:return ArtFont.num18;case 4:return ArtFont.num19;case 5:return ArtFont.num6;default:return ArtFont.num16}},Object.defineProperty(b.prototype,"isEqu",{get:function(){return Number(this._entryData.type)==SharedDef.ITEM_TYPE_EQUIP},enumerable:!0,configurable:!0}),b.prototype.initBase=function(){var a;this._bg=this._bgRender.getComponent("t_tip_bg"),this.addChild(this._bg),this._t_icon=this._baseRender.getComponent("t_icon"),this.addChild(this._t_icon),this._t_name=this._baseRender.getComponent("t_name"),this.addChild(this._t_name),a=this._baseRender.getComponent("t_type"),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,a.skinName,"类型:",14,TextAlign.LEFT,ColorType.coloraa874a),this.addChild(a),this._t_type_value=this._baseRender.getComponent("t_type_val"),this.addChild(this._t_type_value),a=this._baseRender.getComponent("t_lev"),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,a.skinName,"等级:",14,TextAlign.LEFT,ColorType.coloraa874a),this.addChild(a),this._t_lev_value=this._baseRender.getComponent("t_lev_val"),this.addChild(this._t_lev_value),this._t_zl_value=this._baseRender.getComponent("t_zl_val"),this.addChild(this._t_zl_value),this._t_btn_bg=this._bgRender.getComponent("t_btn_bg"),this._t_btn_bg.addEventListener(InteractiveEvent.Down,this.bgUp,this),this.initBtn()},b.prototype.bgUp=function(){},b.prototype.refreshBottomInfo=function(){},b.prototype.initBtn=function(){},b.prototype.getGuid=function(){return GuidData.bag.getPlayerGuid()+";"+this._data.id},b.prototype.selItem=function(){var a=this.getGuid();NetManager.getInstance().protocolos.bag_item_sell(a,this._data.count),console.log("出售商品：",a,"数量",this._data.count),this.hide()},b}(UIConatiner),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),EquTip=function(a){function b(){var b=a.call(this)||this;return b.partNameAry=["武器","衣服","护手","腰带","鞋子","头饰","项链","手镯","戒指","腰坠"],b.gemTypeAry=["绿翡翠","红宝石","蓝宝石","黑曜石","白珊瑚","紫水晶","黄玛瑙","宝石8","宝石9","宝石10"],b._hasInitBtn=!1,b.width=354,b.height=456,b.center=-150,b.middle=0,b}return __extends(b,a),b.prototype.refresh=function(){a.prototype.refresh.call(this),this.refreshLevTypeZL(),this.refreshBaseAtt(),this.refreshSuit(),this.refreshAddAtt(),this.refreshTxt(),this.refreshBottomInfo()},b.prototype.showBtn=function(){if(this._needBtn){this.addChild(this._unloadBtn),this.addChild(this._strengBtn),this.addChild(this._gemBtn),this._t_btn_bg.height=160,this.addChild(this._t_btn_bg);var a=50,b=30;this._entryData.suitId?(this._t_btn_bg.y=270,b=30):(this._t_btn_bg.y=150,b=150),this._strengBtn.y=this.height-3*a-b,this._gemBtn.y=this.height-2*a-b,this._unloadBtn.y=this.height-a-b}else this.removeChild(this._unloadBtn),this.removeChild(this._strengBtn),this.removeChild(this._gemBtn),this.removeChild(this._t_btn_bg)},b.prototype.refreshIconName=function(){a.prototype.refreshIconName.call(this),this.addChild(this._t_seal)},b.prototype.refreshLevTypeZL=function(){var a=this._uiAtlas.getRec(this._t_type_value.skinName);UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1);LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_type_value.skinName,this.partNameAry[this._entryData.pos-1],16,TextAlign.LEFT,ColorType.colorffecc6),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_lev_value.skinName,String(this._entryData.level),16,TextAlign.LEFT,ColorType.colorffecc6),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_zl_value.skinName,String(this.getZhanLi()),16,TextAlign.LEFT,ColorType.colorfde87e);var b;b=this._data.qhGemData?this._data.qhGemData.strength_lv:GuidData.grow.getPartStrengLev(this._entryData.pos),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_qh_lev_value.skinName,"+"+String(b),16,TextAlign.LEFT,ColorType.colorffecc6);var c,d;if(this._data.qhGemData)c=this._data.qhGemData.refine_rank,d=this._data.qhGemData.refine_star;else{var e=GuidData.grow.getPartRefineVo(this._entryData.pos);c=e[0],d=e[1]}LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_jl.skinName,ColorType.coloraa874a+"精炼:"+ColorType.colorffecc6+c+"阶",16,TextAlign.LEFT);for(var f=d,g=0;g<this.starAry.length;g++)f>g?this.starAry[g].goToAndStop(0):this.starAry[g].goToAndStop(1)},b.prototype.getZhanLi=function(){return this._data.data.propData.force?Number(this._data.data.propData.force):0},b.prototype.refreshBaseAtt=function(){var a=this._entryData.basic_properties;a&&a.length?LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_base_att.skinName,this.getAttName(a[0][0])+"：+"+float2int(a[0][1]/100),16,TextAlign.LEFT,this.getColorQua(0)):UiDraw.clearUI(this._t_base_att);var b;b=this._data.qhGemData?GuidData.grow.getStrengValueByLev(this._entryData.pos,this._data.qhGemData.strength_lv):GuidData.grow.getStrengValue(this._entryData.pos),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_qh_att.skinName,"+"+float2int(b/100),16,TextAlign.LEFT,this.getColorQua(1))},b.prototype.drawLineTxt=function(a,b,c,d,e){void 0===d&&(d=0),void 0===e&&(e=0);var f=this._uiAtlas.getRec(a),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);LabelTextFont.writeSingleLabelToCtx(g,b,16,0,0,TextAlign.LEFT,this.getColorQua(e)),ArtFont.getInstance().writeFontToCtxLeft(g,c,this.getNumColor(d),100,2),this._uiAtlas.updateCtx(g,f.pixelX,f.pixelY)},b.prototype.drawGemLineTxt=function(a,b,c,d,e){void 0===d&&(d=0),void 0===e&&(e=0);var f=this._uiAtlas.getRec(a),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);LabelTextFont.writeSingleLabelToCtx(g,b,16,0,0,TextAlign.LEFT,this.getGemColor(e)),ArtFont.getInstance().writeFontToCtxLeft(g,c,this.getGemNumColor(d),50,2),this._uiAtlas.updateCtx(g,f.pixelX,f.pixelY)},b.prototype.drawLine=function(a,b,c){void 0===c&&(c=0);var d=this._uiAtlas.getRec(a),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);LabelTextFont.writeSingleLabelToCtx(e,b,16,0,0,TextAlign.LEFT,this.getColorQua(c)),this._uiAtlas.updateCtx(e,d.pixelX,d.pixelY)},b.prototype.drawIconLine=function(a,b,c,d){var e=this;void 0===d&&(d=0),IconManager.getInstance().getIconName(a,function(a){var f=e._uiAtlas.getRec(b),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);UiDraw.cxtDrawImg(g,PuiData.REWARD_BG1,new Rectangle(0,0,22,22),UIData.publicUi),g.drawImage(a,0,0,60,60,1,1,20,20),LabelTextFont.writeSingleLabelToCtx(g,c,16,25,0,TextAlign.LEFT,e.getGemColor(d)),e._uiAtlas.updateCtx(g,f.pixelX,f.pixelY)})},b.prototype.clearLable=function(a){var b=this._uiAtlas.getRec(a),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);this._uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.refreshGem=function(){var a;a=this._data.qhGemData?strengthgem.NewStrengModel.getInstance().getGemvo(this._entryData.pos,[this._data.qhGemData.gem1_lv,this._data.qhGemData.gem2_lv,this._data.qhGemData.gem3_lv]):strengthgem.NewStrengModel.getInstance().getGemvo(this._entryData.pos);for(var b=0;3>b;b++){var c=a[b],d=this._t_gem_lableList[b],e=this._t_gem_valList[b],f=tb.TB_item_template.get_TB_item_template(c.curtab.cost[0][0]);0==c.gemlev?(this.drawIconLine(f.icon,d.skinName,f.name+"(未激活)",c.gemlev),this.clearLable(e.skinName)):(this.drawIconLine(f.icon,d.skinName,f.name+"("+c.gemlev+"级)",c.gemlev),LabelTextFont.writeSingleLabel(this._uiAtlas,e.skinName,this.getAttName(c.curtab.props[0][0])+"：+"+float2int(c.curtab.props[0][1]/100),16,TextAlign.LEFT,this.getColorQua(c.gemlev)))}},b.prototype.refreshSuit=function(){if(this._entryData.suitId){var a=TableData.getInstance().getData(TableData.tb_equip_suit_base,this._entryData.suitId),b=a.itemId;this.addChild(this._t_suit_line);for(var c=0,d=0;d<this._t_suit_lableList.length;d++){if(b[d]){var e=TableData.getInstance().getData(TableData.tb_item_template,b[d]),f=GuidData.bag.getEquPart(e.pos),g=f&&f.entryData&&f.entryData.id==e.id;LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_suit_lableList[d].skinName,e.name,16,TextAlign.LEFT,g?this.quaColorAry[1]:ColorType.color9c9b9b),g&&c++}else this.clearLable(this._t_suit_lableList[d].skinName);this.addChild(this._t_suit_lableList[d])}for(var h=a.effectId,d=0;d<this._t_suit_valList.length;d++){if(h[d]){var i=TableData.getInstance().getData(TableData.tb_equip_suit_effect,h[d][1]),j=h[d][0]+"件套效果:"+getKeyProById(i.props[0][0])+" +"+i.props[0][1],g=h[d][0]<=c;LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_suit_valList[d].skinName,j,16,TextAlign.LEFT,g?this.quaColorAry[1]:ColorType.color9c9b9b)}else this.clearLable(this._t_suit_valList[d].skinName);this.addChild(this._t_suit_valList[d])}}else{this.removeChild(this._t_suit_line);for(var d=0;d<this._t_suit_lableList.length;d++)this.removeChild(this._t_suit_lableList[d]);for(var d=0;d<this._t_suit_valList.length;d++)this.removeChild(this._t_suit_valList[d])}},b.prototype.getSuitState=function(a){},b.prototype.refreshBottomInfo=function(){this._entryData.suitId?(this._t_endline.y=this._t_endline.baseRec.y+120,this._t_info.y=this._t_info.baseRec.y+120,this._bg.height=this._bg.baseRec.height):(this._t_endline.y=this._t_endline.baseRec.y,this._t_info.y=this._t_info.baseRec.y,this._bg.height=this._bg.baseRec.height-120)},b.prototype.refreshAddAtt=function(){if(this._data.data)for(var a=this._data.data.AttrData,b=a.length/3,c=0;c<this._t_add_attList.length;c++)if(b>c){var d=a[3*c+2];LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_add_attList[c].skinName,getKeyProById(a[3*c])+"：+"+float2int(a[3*c+1]/100),16,TextAlign.LEFT,this.getColorQua(d))}else{var e=this.getColorQua(c);e="["+e.slice(1)+"]",LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_add_attList[c].skinName,ColorType.color9c9b9b+"随机属性:装备"+e+this.getColorName(c)+ColorType.color9c9b9b+"品质激活",16,TextAlign.LEFT)}else for(var c=0;c<this._t_add_attList.length;c++)this.clearLable(this._t_add_attList[c].skinName)},b.prototype.refreshTxt=function(){LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_info.skinName,this._entryData.info,14,TextAlign.LEFT,ColorType.colord6e7ff)},b.prototype.getAttName=function(a){return getKeyProById(a)},b.prototype.getGemInfo=function(a){var b=new Object,c=TableData.getInstance().getData(TableData.tb_gem_pos,a),d=c.gemtype;return b.name=this.gemTypeAry[d-1],b.gemType=d,c=TableData.getInstance().getData(TableData.tb_gem_icon,d),b.icon=c.miniicon,b},b.prototype.getGemColor=function(a){return 0==a?"#9c9b9b":this.quaColorAry[float2int((a-1)/2)]},b.prototype.getGemNumColor=function(a){return 0==a?ArtFont.num20:2>=a?ArtFont.num16:4>=a?ArtFont.num7:6>=a?ArtFont.num17:8>=a?ArtFont.num18:ArtFont.num19},b.prototype.initBase=function(){a.prototype.initBase.call(this);var b;b=this._baseRender.getComponent("t_zl"),this.addChild(b),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,b.skinName,"战力:",14,TextAlign.LEFT,ColorType.coloraa874a),this._t_qh_lev_value=this._baseRender.getComponent("t_qh_lev"),this.addChild(this._t_qh_lev_value),this._t_qh_name=this._baseRender.getComponent("t_qh_name"),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this._t_qh_name.skinName,"强化:",14,TextAlign.LEFT,ColorType.coloraa874a),this.addChild(this._t_qh_name),this._t_jl=this._baseRender.getComponent("t_jl"),this.addChild(this._t_jl),this._t_seal=this._nextRender.getComponent("a_seal"),this.starAry=new Array;for(var c=0;10>c;c++){var d=this._nextRender.getComponent("t_star"+c);d.goToAndPlay(1),this.addChild(d),this.starAry.push(d)}this.addChild(this._baseRender.getComponent("t_base_line")),this._t_qh_att=this._baseRender.getComponent("t_qh_val"),this.addChild(this._t_qh_att),this._t_base_att=this._baseRender.getComponent("t_base_val"),this.addChild(this._t_base_att),this.addChild(this._baseRender.getComponent("t_add_line")),this._t_add_attList=new Array;for(var c=0;5>c;c++){var e=this._baseRender.getComponent("t_add_val"+c);this._t_add_attList.push(e),this.addChild(e)}this.initSuit(),this._t_info=this._nextRender.getComponent("t_info"),this.addChild(this._t_info),this._t_endline=this.addChild(this._nextRender.getComponent("t_end_line"))},b.prototype.initGem=function(){this.addChild(this._nextRender.getComponent("t_gem_line")),this._t_gem_lableList=new Array;for(var a=0;3>a;a++){var b=this._nextRender.getComponent("t_gem"+a);this.addChild(b),this._t_gem_lableList.push(b)}this._t_gem_valList=new Array;for(var a=0;3>a;a++){var b=this._nextRender.getComponent("t_gem_val"+a);this.addChild(b),this._t_gem_valList.push(b)}},b.prototype.initSuit=function(){this._t_suit_line=this._nextRender.getComponent("a_suit_line"),this._t_suit_lableList=new Array;for(var a=0;6>a;a++){var b=this._nextRender.getComponent("c_suit"+a);this._t_suit_lableList.push(b)}this._t_suit_valList=new Array;for(var a=0;3>a;a++){var b=this._nextRender.getComponent("c_suit_val"+a);this._t_suit_valList.push(b)}},b.prototype.initBtn=function(){this._strengBtn=this._nextRender.getComponent("t_qh_btn"),this.addChild(this._strengBtn),this._strengBtn.addEventListener(InteractiveEvent.Down,this.strengClick,this),this._gemBtn=this._nextRender.getComponent("t_bs_btn"),this.addChild(this._gemBtn),this._gemBtn.addEventListener(InteractiveEvent.Down,this.gemClick,this),this._unloadBtn=this._nextRender.getComponent("t_xh_btn"),this.addChild(this._unloadBtn),this._unloadBtn.addEventListener(InteractiveEvent.Down,this.unLoadItem,this),this._hasInitBtn=!0},b.prototype.unLoadItem=function(){this.getGuid();return GuidData.bag.getBagNum(BagData.TYPE_EQU_BG)==GuidData.bag.getBagSize(BagData.TYPE_EQU_BG)?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"装备背包已满，请整理后再试！",99):void NetManager.getInstance().protocolos.bag_exchange_pos(SharedDef.BAG_TYPE_EQUIP,this._data.pos,SharedDef.BAG_TYPE_EQUIP_BAG,GuidData.bag.getEmptyEquBagPos())},b.prototype.strengClick=function(){var a=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_MIX+SharedDef.MODULE_MIX_STRENGTH));a.level<=GuidData.player.getLevel()?ModulePageManager.openPanel(SharedDef.MODULE_MIX,SharedDef.MODULE_MIX_STRENGTH):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"系统未开启",99)},b.prototype.gemClick=function(){var a=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_MIX+SharedDef.MODULE_MIX_GEM));a.level<=GuidData.player.getLevel()?ModulePageManager.openPanel(SharedDef.MODULE_MIX,SharedDef.MODULE_MIX_GEM):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"系统未开启",99)},b}(BaseTip),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),EquItemTip=function(a){function b(){var b=a.call(this)||this;return b.center=-115,b}return __extends(b,a),b.prototype.refreshIconName=function(){var a=this;IconManager.getInstance().getIcon(geteqiconIconUrl(this._entryData.icon),function(b){var c=a._uiAtlas.getRec(a._t_icon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(d,ItemGoodQuality.getQuaStr(a._entryData.quality),new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(b,0,0,60,60,4,4,60,60),1==a._entryData.type&&(UiDraw.cxtDrawImg(d,PuiData.A_EQULEVBG,new Rectangle(4,4,41,17),UIData.publicUi),ArtFont.getInstance().writeFontToCtxCenten(d,String(a._entryData.level),ArtFont.num63,18,4,4)),a._uiAtlas.updateCtx(d,c.pixelX,c.pixelY)}),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_name.skinName,this._entryData.name,18,TextAlign.LEFT,this.getColorQua(this._entryData.quality))},b.prototype.initBtn=function(){this._useBtn=this._nextRender.getComponent("t_cxh_n"),this.addChild(this._useBtn),this._useBtn.addEventListener(InteractiveEvent.Down,this.useItem,this),this._xiaohuiBtn=this._nextRender.getComponent("t_gh_btn"),this._xiaohuiBtn.addEventListener(InteractiveEvent.Down,this.xiaohuiItem,this),this._quchuBtn=this._nextRender.getComponent("t_qc_btn"),this._quchuBtn.addEventListener(InteractiveEvent.Down,this.quchuItem,this),this._shangjiaoBtn=this._nextRender.getComponent("t_sj_btn"),this._shangjiaoBtn.addEventListener(InteractiveEvent.Down,this.shangjiaoItem,this),this._hasInitBtn=!0;var a=50,b=30;this._useBtn.y=this.height-50-b,this._xiaohuiBtn.y=this.height-2*a-b,this._quchuBtn.y=this.height-a-b,this._shangjiaoBtn.y=this.height-a-b,this.initBottom()},b.prototype.initBottom=function(){this._facLab1=this._nextRender.getComponent("t_fac_lab1"),this._facVal1=this._nextRender.getComponent("t_fac_val1"),this._facIcon1=this._nextRender.getComponent("t_fac_icon1"),this._facLab2=this._nextRender.getComponent("t_fac_lab2"),this._facVal2=this._nextRender.getComponent("t_fac_val2"),this._facIcon2=this._nextRender.getComponent("t_fac_icon2"),UiDraw.uiAtlasDrawImg(this._uiAtlas,this._facIcon1.skinName,UIData.publicUi,UIuitl.getInstance().costtype(6)),UiDraw.uiAtlasDrawImg(this._uiAtlas,this._facIcon2.skinName,UIData.publicUi,UIuitl.getInstance().costtype(6)),this._facUIAry=[this._facLab1,this._facVal1,this._facIcon1,this._facLab2,this._facVal2,this._facIcon2]},b.prototype.addFac=function(){for(var a=0;a<this._facUIAry.length;a++)this.addChild(this._facUIAry[a]);this.removeChild(this._t_info)},b.prototype.removeFac=function(){for(var a=0;a<this._facUIAry.length;a++)this.removeChild(this._facUIAry[a]);this.addChild(this._t_info)},b.prototype.showUpFac=function(){LabelTextFont.writeSingleLabel(this._uiAtlas,this._facLab1.skinName,"上交获得:",14,TextAlign.LEFT,ColorType.coloraa874a),LabelTextFont.writeSingleLabel(this._uiAtlas,this._facLab2.skinName,"购买消耗:",14,TextAlign.LEFT,ColorType.coloraa874a),this._facVal2.x=this._facVal2.baseRec.x,LabelTextFont.writeSingleLabel(this._uiAtlas,this._facVal1.skinName,Snum(this._entryData.handInReward[0][1]),16,TextAlign.LEFT,ColorType.colorfde87e),
LabelTextFont.writeSingleLabel(this._uiAtlas,this._facVal2.skinName,Snum(this._entryData.exchangeCost[0][1]),16,TextAlign.LEFT,ColorType.colorfde87e)},b.prototype.showDownFac=function(){LabelTextFont.writeSingleLabel(this._uiAtlas,this._facLab1.skinName,"购买消耗:",14,TextAlign.LEFT,ColorType.coloraa874a),LabelTextFont.writeSingleLabel(this._uiAtlas,this._facLab2.skinName,"销毁获得:",14,TextAlign.LEFT,ColorType.coloraa874a),this.removeChild(this._facIcon2),this._facVal2.x=this._facIcon2.x,LabelTextFont.writeSingleLabel(this._uiAtlas,this._facVal1.skinName,Snum(this._entryData.exchangeCost[0][1]),16,TextAlign.LEFT,ColorType.colorfde87e),LabelTextFont.writeSingleLabel(this._uiAtlas,this._facVal2.skinName,"家族资金 "+Snum(this._entryData.destroyReward),16,TextAlign.LEFT,ColorType.colorfde87e)},b.prototype.testGender=function(){if(this._entryData.availableGender){var a=this._entryData.availableGender.indexOf(GuidData.player.getCharType());return-1!=a}return!1},b.prototype.showBtn=function(){if(this.removeAllBtn(),this._needBtn){var a=50,b=30;b=this._entryData.suitId?30:150,this._xiaohuiBtn.y=this.height-2*a-b,this._quchuBtn.y=this.height-a-b,this._shangjiaoBtn.y=this.height-a-b,2==this._btnType?this.testGender()?(this.addChild(this._useBtn),this._t_btn_bg.height=55,this._entryData.suitId?this._t_btn_bg.y=373:this._t_btn_bg.y=253,this._useBtn.y=this.height-50-b):this._t_btn_bg.y=1e5:4==this._btnType?(this.addChild(this._xiaohuiBtn),this.addChild(this._quchuBtn),this._t_btn_bg.height=105,this._t_btn_bg.y=323):5==this._btnType&&(this.addChild(this._shangjiaoBtn),this._t_btn_bg.height=55,this._t_btn_bg.y=373),this.addChild(this._t_btn_bg)}else this.removeChild(this._t_btn_bg);4==this._btnType?(this.addFac(),this.showDownFac()):5==this._btnType?(this.addFac(),this.showUpFac()):this.removeFac()},b.prototype.removeAllBtn=function(){this.removeChild(this._getBtn),this.removeChild(this._selBtn),this.removeChild(this._useBtn),this.removeChild(this._xiaohuiBtn),this.removeChild(this._quchuBtn),this.removeChild(this._shangjiaoBtn)},b.prototype.useItem=function(){return this._entryData.level>GuidData.player.getLevel()?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"等级不足，无法装备",99):(UIManager.popClikNameFun("t_sy_btn"),NetManager.getInstance().protocolos.bag_exchange_pos(SharedDef.BAG_TYPE_EQUIP_BAG,this._data.pos,SharedDef.BAG_TYPE_EQUIP,Number(this._entryData.pos)),void this.hide())},b.prototype.xiaohuiItem=function(){var a=TableData.getInstance().getData(TableData.tb_faction_privilege,1);GuidData.faction.playerIdentity<=a.destroyItem?NetManager.getInstance().protocolos.storehouse_destroy(this._data.pos):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"权限不足",99)},b.prototype.quchuItem=function(){if(!hasEnoughRes(this._entryData.exchangeCost[0])){var a=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return a.data=6,void ModuleEventManager.dispatchEvent(a)}NetManager.getInstance().protocolos.storehouse_exchange(this._data.pos)},b.prototype.shangjiaoItem=function(){NetManager.getInstance().protocolos.storehouse_hand_in(String(this._data.pos))},b}(EquTip),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ItemTip=function(a){function b(){var b=a.call(this)||this;return b.width=370,b.height=266,b.center=-115,b.middle=0,b}return __extends(b,a),b.prototype.refresh=function(){a.prototype.refresh.call(this),this.refreshLevTypeZL(),this.refreshTxt(),this.refreshBottomInfo()},b.prototype.showBtn=function(){this._t_btn_bg.height=55,this._t_btn_bg.y=220,this.addChild(this._t_btn_bg),-1==this._btnType?(this.addChild(this._getBtn),this.removeChild(this._useBtn)):3==this._entryData.type_c?(this.addChild(this._getBtn),this.removeChild(this._useBtn)):2==this._entryData.type_c&&(this.addChild(this._useBtn),this.removeChild(this._getBtn))},b.prototype.refreshLevTypeZL=function(){LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_zl_value.skinName,this.getQuaName(this._entryData.quality),16,TextAlign.LEFT,this.getColorQua(this._entryData.quality)),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_lev_value.skinName,String(this._entryData.rank),16,TextAlign.LEFT,ColorType.colorffecc6),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_type_value.skinName,this.getTypeName(this._entryData.type),16,TextAlign.LEFT,ColorType.colorffecc6)},b.prototype.refreshTxt=function(){LabelTextFont.writeSingleLabel(this._uiAtlas,this._txt.skinName,"  "+this._entryData.info+" \nid:"+this._entryData.id,14,TextAlign.LEFT,ColorType.colord6e7ff),LabelTextFont.writeSingleLabel(this._uiAtlas,this._info.skinName,"  "+this._entryData.zhuangbility,14,TextAlign.LEFT,ColorType.colord6e7ff)},b.prototype.initBase=function(){a.prototype.initBase.call(this);var b=this._baseRender.getComponent("i_qua");LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,b.skinName,"品质:",14,TextAlign.LEFT,ColorType.coloraa874a),this.addChild(b),this.addChild(this._baseRender.getComponent("i_line")),this.addChild(this._baseRender.getComponent("i_line2")),this._txt=this._baseRender.getComponent("i_txt"),this.addChild(this._txt),this._info=this._baseRender.getComponent("i_info"),this.addChild(this._info),this._bg.height=300;for(var c=0;c<this.dynamicPosList.length;c++)this.dynamicPosList[c].y-=232},b.prototype.initBtn=function(){this._getBtn=this._nextRender.getComponent("t_hq_btn"),this._getBtn.y=222,this._getBtn.addEventListener(InteractiveEvent.Down,this.getItem,this),this._selBtn=this._nextRender.getComponent("t_cs_btn"),this._selBtn.y=222,this._selBtn.addEventListener(InteractiveEvent.Down,this.selItem,this),this._useBtn=this._nextRender.getComponent("t_sy_btn"),this._useBtn.y=222,this._useBtn.addEventListener(InteractiveEvent.Down,this.useItem,this)},b.prototype.useItem=function(){NetManager.getInstance().protocolos.bag_item_user(this.getGuid(),1)},b.prototype.getItem=function(){this._entryData.output&&this._entryData.output.length&&ModulePageManager.openPanel(Number(this._entryData.output[0]),Number(this._entryData.output[1]))},b.prototype.getTypeName=function(a){switch(a){case 10:return"道具";case 11:return"任务道具";case 12:return"药品";case 13:return"丹药";case 14:return"礼包";case 15:return"宝箱";case 16:return"宝物";case 30:return"材料";case 31:return"货币";case 32:return"资源"}return"其他"},b}(BaseTip),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),SkillTip=function(a){function b(){var b=a.call(this)||this;return b.width=370,b.height=266,b.center=-115,b.middle=0,b._baseRender=new UIRenderComponent,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.setUIAtlas=function(a){this._uiAtlas=a,this._baseRender.uiAtlas=a,this._bgRender.uiAtlas=a,this.initBase()},b.prototype.show=function(a){this.refresh(a),this.hasStage||(UIManager.getInstance().addUIContainer(this),Scene_data.uiStage.addEventListener(InteractiveEvent.Down,this.clickEvt,this))},b.prototype.hide=function(){this.hasStage&&(UIManager.getInstance().removeUIContainer(this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Down,this.clickEvt,this))},b.prototype.clickEvt=function(a){this.hide()},b.prototype.refresh=function(a){this.refreshIcon(a.baseData),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_name.skinName,a.baseData.name,18,TextAlign.LEFT,ColorType.colorffecc6),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_val1.skinName,String(a.lev),16,TextAlign.LEFT,ColorType.colorffecc6),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_val2.skinName,1==a.baseData.is_initiative?"主动":"被动",16,TextAlign.LEFT,ColorType.colorfde87e),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_val3.skinName,String(a.levData.fight_value),16,TextAlign.LEFT,ColorType.colorfde87e),LabelTextFont.writeSingleLabel(this._uiAtlas,this._t_txt.skinName,tb.SkillDataVo.getSkillDesc(a.baseData.id,a.lev),16,TextAlign.LEFT,ColorType.colorfde87e)},b.prototype.refreshIcon=function(a){var b=this,c=getSkillIconUrl(String(a.icon));IconManager.getInstance().getIcon(c,function(a){var c=b._baseRender.uiAtlas.getRec(b._t_icon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.SKILL_BG58,new Rectangle(0,0,58,58),UIData.publicUi),d.drawImage(a,0,0,a.width,a.height,4,4,50,50),b._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},b.prototype.initBase=function(){var a;this._bg=this._bgRender.getComponent("s_tip_bg"),this.addChild(this._bg),this.addUIList(["s_end_line1","s_end_line2"],this._baseRender),this._t_icon=this._baseRender.getComponent("s_icon"),this.addChild(this._t_icon),this._t_name=this._baseRender.getComponent("s_title"),this.addChild(this._t_name),a=this._baseRender.getComponent("s_lab1"),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,a.skinName,"等级:",14,TextAlign.LEFT,ColorType.coloraa874a),this.addChild(a),a=this._baseRender.getComponent("s_lab2"),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,a.skinName,"类型:",14,TextAlign.LEFT,ColorType.coloraa874a),this.addChild(a),a=this._baseRender.getComponent("s_lab3"),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,a.skinName,"战力:",14,TextAlign.LEFT,ColorType.coloraa874a),this.addChild(a),this._t_val1=this.addChild(this._baseRender.getComponent("s_val1")),this._t_val2=this.addChild(this._baseRender.getComponent("s_val2")),this._t_val3=this.addChild(this._baseRender.getComponent("s_val3")),this._t_txt=this.addChild(this._baseRender.getComponent("s_txt"))},b}(UIConatiner),GoodsTip=function(){function a(){var a=this;this._hasInit=!1,this._btnType=-1,this.atlasAry=new Array,this.atlasAry.push(new UIAtlas,new UIAtlas);var b=new TipAtlasUtil;b.setInfo("ui/uidata/charbg/tip.xml","ui/uidata/charbg/tip.png",function(){a.loadConfigCom()},null,this.atlasAry)}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.init=function(){},a.prototype.loadConfigCom=function(){this._equTip=new EquTip,this._equTip.setUIAtlas(this.atlasAry[1]),this._itemTip=new ItemTip,this._itemTip.setUIAtlas(this.atlasAry[0]),this._equItemTip=new EquItemTip,this._equItemTip.setUIAtlas(this.atlasAry[0]),this._skillTip=new SkillTip,this._skillTip.setUIAtlas(this.atlasAry[0]),this._hasInit=!0,this._data&&this.show(this._data,this._btnType)},a.prototype.show=function(a,b){if(void 0===b&&(b=0),console.log("当前物品GUID:",a.guid),!this._hasInit)return this._data=a,void(this._btnType=b);if(1==b||6==b){this._equTip.show(a,b),this._equTip.center=-150;var c=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);return c.data=SharedDef.MODULE_BAG,void ModuleEventManager.dispatchEvent(c)}if(2==b||4==b)if(this.isEqu(a)){this._equItemTip.show(a,b);var d=this.getEquPosData(a.entryData.pos);d?(this._equTip.show(d,3),this._equTip.center=-195,this._equItemTip.center=175):this._equItemTip.center=-115}else this._itemTip.show(a,b);else 5==b?(this._equItemTip.show(a,b),this._equItemTip.center=-115):-1==b?this._itemTip.show(a,b):7==b&&this._skillTip.show(a)},a.prototype.isEqu=function(a){return Number(a.entryData.type_c)==SharedDef.ITEM_TYPE_EQUIP},a.prototype.getEquPosData=function(a){return GuidData.bag.getEquByPart(a)},a}(),TipAtlasUtil=function(){function a(){}return a.prototype.setInfo=function(a,b,c,d,e){var f=this;void 0===d&&(d=null),this._ary=e,this._useImgUrl=d,this._completeFun=c,LoadManager.getInstance().load(Scene_data.fileRoot+a,LoadManager.XML_TYPE,function(a){var c=JSON.parse(a);f.configData=c.uiArr,f.layoutData=c.panelArr,f.loadImgUrl(b)})},a.prototype.loadImgUrl=function(a){var b=this;this._baseImg=new Image,this._baseImg.onload=function(){b._useImgUrl?b.loadUseImg():b.applyEnd()},this._baseImg.src=Scene_data.fileRoot+a},a.prototype.loadUseImg=function(){var a=this;this.useImg=new Image,this.useImg.onload=function(){a.applyEnd()},this.useImg.src=Scene_data.fileRoot+this._useImgUrl},a.prototype.applyEnd=function(){for(var a=0;a<this._ary.length;a++){var b=this._ary[a];b.textureRes=TextureManager.getInstance().getTextureRes(this._baseImg),b.configData=this.configData,b.layoutData=this.layoutData,b.useImg=this.useImg}this._completeFun()},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),charbg;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.lock=!1,a.setBlackBg(),a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a}return __extends(d,b),d.prototype.applyLoad=function(){this.applyLoadComplete()},d.prototype.setUIAtlas=function(a){if(!this._slist){this._slist=new c,this._slist.init(a,this),this._baseRender.uiAtlas=a,this.addChild(this._baseRender.getComponent("b_title"));var b=this._baseRender.getComponent("t_smelt_lab1");LabelTextFont.writeSingleLabel(a,b.skinName,"默认保留玩家可使用的最高分装备",16,TextAlign.LEFT,ColorType.Brown7a2f21),this.addChild(b),b=this._baseRender.getComponent("t_smelt_btn"),this.addChild(b),b.addEventListener(InteractiveEvent.Down,this.onSmelt,this),this._selLab=this.addChild(this._baseRender.getComponent("t_smelt_lab2"))}},d.prototype.onSmelt=function(a){var b=this;if(!this.lock){UIManager.popClikNameFun("t_smelt_btn");for(var c="",d=0;d<this.srcAry.length;d++)this.srcAry[d].data&&(c+=this.srcAry[d].data.pos+"|");c=c.slice(0,c.length-1),console.log(c),this._slist.playEff(),this.lock=!0,TimeUtil.addTimeOut(300,function(){b.lock=!1,NetManager.getInstance().protocolos.smelting_equip(c)})}},d.prototype.bagDataChg=function(){this._slist.refreshData(this.getDataAry())},d.prototype.onRemove=function(){this._slist&&this._slist.hide()},d.prototype.dataShow=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}for(var c=a.length;9>c;c++){var d=new SListItemData;d.id=c,b.push(d)}this._slist.refreshData(b),this.srcAry=b,UIManager.getInstance().addUIContainer(this),this._slist.show()},d.prototype.show=function(a){void 0===a&&(a=null),this.setUIAtlas(a),UIManager.getInstance().addUIContainer(this),this._slist.show(),this._slist.refreshData(this.getDataAry())},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d.prototype.butClik=function(a){a.target==this.c_close&&(UIManager.popClikNameFun("c_close"),this.hide())},d.prototype.testGender=function(a){if(a.availableGender){var b=a.availableGender.indexOf(GuidData.player.getCharType());return-1!=b}return!1},d.prototype.getDataAry=function(){for(var a=new Array,b=GuidData.bag.getEquBgData(),c=b.length-1;c>=0;c--){if(b[c]){if(this.testGender(b[c].entryData)){var d=GuidData.bag.getEquByPart(b[c].entryData.pos);if(!d)continue;if(d.data.propData.force<b[c].data.propData.force)continue}var e=new SListItemData;e.data=b[c],e.id=c,a.push(e)}if(a.length>=9)break}for(var c=a.length;9>c;c++){var e=new SListItemData;e.id=c,a.push(e)}return this.srcAry=a,a},d.prototype.showEquSel=function(){var b=this;this._eqlSelPanel||(this._eqlSelPanel=new a.SmeltEquSelPanel),this.hide(),this._eqlSelPanel.load(function(){for(var a=new Array,c=0;c<b.srcAry.length;c++)b.srcAry[c].data&&a.push(b.srcAry[c].data);b._eqlSelPanel.show(b._baseRender.uiAtlas,a,b)})},d}(WindowCentenMin);a.SmeltEquPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a,b){this.baseAtlas=a,this.smeltPanel=b,this.initData()},b.prototype.initData=function(){var a=this,b=new Array,c=283,e=256;this.setData(b,d,c,e,100,90,3,256,256,3,3),this.center=5,this.middle=-10,this.setShowLevel(4),this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ui_rl"),4,4,function(b){a.effAry=b;for(var c=0;c<a.effAry.length;c++){var d=c%3,e=float2int(c/3);a.effAry[c].x=-30+100*d,a.effAry[c].y=-30+90*e,a.effAry[c].speed=3}},9)},b.prototype.playEff=function(){if(this.effAry)for(var a=0;a<this._dataAry.length;a++)this._dataAry[a].data&&this.effAry[a].playOne(this)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.SmeltEquList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this._ibg=this.creatSUI(c,this.parentTarget.baseAtlas,"s_item",0,0,68,68),b.addChild(this._ibg),this._ibg.addEventListener(InteractiveEvent.Down,this.onclick,this)},b.prototype.onclick=function(a){this.itdata.data?(this.itdata.data=null,this.applyRender()):this.parentTarget.smeltPanel.showEquSel()},b.prototype.render=function(a){this.itdata=a,a&&this.applyRender()},b.prototype.applyRender=function(){this.itdata.data?IconManager.getInstance().drawItemIcon60(this._ibg,this.itdata.data.entry,1,!1,!1):this.drawNull(this._ibg)},b.prototype.drawNull=function(a){var b=a.uiRender.uiAtlas.getRec(a.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);UiDraw.cxtDrawImg(c,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(c,PuiData.ADDITEM,new Rectangle(16,16,35,35),UIData.publicUi),a.uiRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b}(SListItem);a.SmeltEquListItemRender=d}(charbg||(charbg={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),charbg;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.applyLoad=function(){this.applyLoadComplete()},b.prototype.setUIAtlas=function(a){if(!this._slist){this._slist=new c,this._slist.init(a,this),this._baseRender.uiAtlas=a,this.addChild(this._baseRender.getComponent("c_title"));var b=this._baseRender.getComponent("t_smelt_sel_lab1");LabelTextFont.writeSingleLabel(a,b.skinName,"点击选择想要熔炼的装备",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.addChild(b),b=this._baseRender.getComponent("t_sure_btn"),this.addChild(b),b.addEventListener(InteractiveEvent.Down,this.onSmelt,this),this._selLab=this.addChild(this._baseRender.getComponent("t_smelt_sel_lab2"))}},b.prototype.onSmelt=function(a){this.hide(),this.rootPanel.dataShow(this.baseAry)},b.prototype.bagDataChg=function(){this._slist.refreshData(this.getDataAry())},b.prototype.onRemove=function(){this._slist&&this._slist.hide()},b.prototype.show=function(a,b,c){this.rootPanel=c,this.setUIAtlas(a),UIManager.getInstance().addUIContainer(this),this._slist.show(),this.baseAry=b,this._slist.refreshData(this.getDataAry()),this.drawNum()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){a.target==this.e_close&&this.hide()},b.prototype.getDataAry=function(){for(var a=new Array,b=GuidData.bag.getEquBgData(),c=0;c<b.length;c++)if(b[c]){var d=new SListItemData;d.data=b[c],d.id=this.hasData(b[c]),a.push(d)}return this.srcAry=a,a},b.prototype.hasData=function(a){for(var b=0;b<this.baseAry.length;b++)if(this.baseAry[b].id==a.id)return 1;return 0},b.prototype.setSelItem=function(a){return this.baseAry.length>=9?(msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"熔炉已满",99),!1):(this.baseAry.push(a.data),this.drawNum(),!0)},b.prototype.unSetSelItem=function(a){for(var b=0;b<this.baseAry.length;b++)if(this.baseAry[b].id==a.data.id){this.baseAry.splice(b,1);break}return this.drawNum(),!0},b.prototype.drawNum=function(){LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this._selLab.skinName,"已选中:"+this.baseAry.length+"/9",16,TextAlign.CENTER,ColorType.Brown7a2f21)},b}(WindowMinUi);a.SmeltEquSelPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a,b){d.baseAtlas=a,this.selPanel=b,this.initData(),this.bgMask.level=10},b.prototype.initData=function(){var a=new Array,b=480,c=256;this.setData(a,d,b,c,100,90,3,512,512,5,6),this.center=5,this.middle=-10,this.setShowLevel(4)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.SmeltEquSelList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this._ibg=this.creatSUI(d,b.baseAtlas,"s_item",0,0,68,68),c.addChild(this._ibg),this._ibg.addEventListener(InteractiveEvent.Down,this.onclick,this)},b.prototype.onclick=function(a){if(this.itdata&&this.itdata.data)if(0==this.itdata.id){var b=this.parentTarget.selPanel.setSelItem(this.itdata);b&&(this.itdata.id=1,this.applyRender())}else this.parentTarget.selPanel.unSetSelItem(this.itdata),this.itdata.id=0,this.applyRender()},b.prototype.render=function(a){this.itdata=a,a?this.applyRender():this.drawNull(this._ibg)},b.prototype.applyRender=function(){this.itdata.data?this.drawSel(this._ibg,this.itdata.data.entry,1==this.itdata.id):this.drawNull(this._ibg)},b.prototype.drawSel=function(a,b,c){var d=tb.TB_item_template.get_TB_item_template(b);IconManager.getInstance().getIconName(d.icon,function(b){var e=a.uiRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(d.quality),new Rectangle(0,0,68,68),UIData.publicUi),f.drawImage(b,0,0,60,60,4,4,60,60),c&&(UiDraw.cxtDrawImg(f,PuiData.HASSEL,new Rectangle(0,20,68,27),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(f,"已选择",14,0,22,TextAlign.CENTER,ColorType.Whiteffffff)),a.uiRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},b.prototype.drawNull=function(a){var b=a.uiRender.uiAtlas.getRec(a.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);UiDraw.cxtDrawImg(c,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),a.uiRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b}(SListItem);a.SmeltEquSelListItemRender=d}(charbg||(charbg={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),charbg;!function(a){var b=function(b){function c(){var c=b.call(this)||this;return c._lastMouseX=0,c._lastRoleRotatioinY=0,c.uiAtlasComplet=!1,c.partNameAry=["武器","衣服","护手","腰带","鞋子","头饰","项链","手镯","戒指","腰坠"],c._defaultIdx=1,c.width=UIData.designWidth,c.height=UIData.designHeight,c.center=0,c.middle=0,c._bgRender=new UIRenderComponent,c.addRender(c._bgRender),c._baseRender=new UIRenderComponent,c.addRender(c._baseRender),c._redPointRender=new RedPointRender,c.addRender(c._redPointRender),c._baseUiAtlas=new UIAtlas,c._bagPanel=new a.BagPanel,c._smeltPanel=new a.SmeltEquPanel,c.addPersonChar(),c}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bgRender.dispose(),this._bgRender=null,this._bagPanel.dispose(),this._bagPanel=null},c.prototype.butClik=function(a){a.target==this.w_close&&(UIManager.popClikNameFun("w_close"),this.close())},c.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/charbg/charbags.xml","ui/uidata/charbg/bag.png",function(){a.loadConfigCom()},"ui/uidata/charbg/charbaguse.png")},c.prototype.bgDataChg=function(a,b){b==BagData.TYPE_EQU?this.chgEqu(a):(this._bagPanel.bgDataChg(a,b),this._smeltPanel.hasStage&&b==BagData.TYPE_EQU_BG&&this._smeltPanel.bagDataChg())},c.prototype.chgEqu=function(a){for(var b=0;b<a.length;b++){var c=GuidData.bag.getEquByPart(a[b]);if(c){var d,e=TableData.getInstance().getData(TableData.tb_item_template,c.entry);d=this.equViewList[c.pos-1],IconManager.getInstance().drawItemIcon60(d,e.id,1,!1,!1),d.data=c,d.addEventListener(InteractiveEvent.Up,this.equClick,this)}else this.removeEquView(a[b]-1)}this._bagPanel.drawUpDown()},c.prototype.addPersonChar=function(){var a=this,b=new Person2DChar;this.wintopRender.addModel(b),this.showDisPlay=b,this._rotationFun=function(b){a.rotationRole()},this.refreshRole(),this.setWing(),this.resize()},c.prototype.setWing=function(){this.wingDisplay||GuidData.grow.getWingID()&&(this.wingDisplay=new Person2DChar,this.wingDisplay.needUIUrl=!1,this.wintopRender.addModel(this.wingDisplay),this.wingDisplay.setBind(this.showDisPlay,SceneChar.WING_SLOT)),GuidData.grow.getWingID()&&this.wingDisplay.setAvatar(GuidData.grow.getWingModel())},c.prototype.refreshRole=function(){this.resetAvata(),this.resetWeapon()},c.prototype.resetAvata=function(){this.showDisPlay.setBaseRoleAvatar(GuidData.player.getAvatar(),GuidData.player.getCharType())},c.prototype.resetWeapon=function(){this.showDisPlay.setBaseRoleWeapon(GuidData.player.getWeapon(),GuidData.player.getCharType())},c.prototype.refreshWing=function(){this.setWing()},c.prototype.refreshRoleType=function(a){0==a?this.resetAvata():1==a&&this.resetWeapon()},c.prototype.A_left_bg_MouseDown=function(a){this._lastMouseX=a.x,this._lastRoleRotatioinY=this.showDisPlay.rotationY,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.A_left_bg_MouseMove=function(a){this.showDisPlay.rotationY=this._lastRoleRotatioinY-(a.x-this._lastMouseX)},c.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.rotationRole=function(){this.showDisPlay.rotationY-=.5},c.prototype.resize=function(){b.prototype.resize.call(this),this.showDisPlay.resize(),this.showDisPlay.scale=5.5*UIData.Scale,this.showDisPlay.x=80*UIData.Scale,this.showDisPlay.y=-130*UIData.Scale,this.wingDisplay&&(this.wingDisplay.resize(),this.wingDisplay.scale=5.5*UIData.Scale)},c.prototype.loadConfigCom=function(){this.applyLoadComplete(),this.uiAtlasComplet=!0,this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this._bagPanel.setUIAtlas(this._baseUiAtlas);this._baseRender;this.equViewList=new Array;for(var a=0;10>a;a++){var b=this._bgRender.getComponent("a_eq_"+a);this.addChild(b),this.equViewList.push(b)}this._zlUI=this._baseRender.getComponent("a_zhanli"),this.addChild(this._zlUI),this.addBaseBg();var c=this.addChild(this._baseRender.getComponent("b_ronglian"));c.addEventListener(InteractiveEvent.Down,this.showRL,this),this._rlRed=this._redPointRender.getRedPointUI(this,2,new Vector2D(c.x+c.width,c.y)),this.refreshEquData(),this.refreshForce(),this.hasStage&&(this._bagPanel.show(),0==this._defaultIdx&&this.showRL()),this.resize(),GoodsTip.getInstance().init()},c.prototype.showRL=function(a){var b=this;void 0===a&&(a=null),UIManager.popClikNameFun("b_ronglian"),this._smeltPanel.load(function(){b._smeltPanel.show(b._baseUiAtlas);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_BAG,ModuleEventManager.dispatchEvent(a)})},c.prototype.refreshForce=function(){ArtFont.getInstance().writeFontToSkinName(this._baseUiAtlas,this._zlUI.skinName,Snum(GuidData.player.getForce()),ArtFont.num56,TextAlign.LEFT)},c.prototype.refreshLevel=function(){this._bagPanel&&this._bagPanel.drawEquDis()},c.prototype.addBaseBg=function(){this.addUIList(["a_bag_bg0","a_win_line1"],this.winmidRender),this.addChild(this._bgRender.getComponent("a_zl_bg")),this.addChild(this._baseRender.getComponent("a_title")),this.roleBg=this.winmidRender.getComponent("a_ming_bg"),this.addChild(this.roleBg);var a=this._baseRender.getComponent("a_rotation_bg");this.addChild(a),a.addEventListener(InteractiveEvent.Down,this.A_left_bg_MouseDown,this)},c.prototype.refreshEquData=function(){for(var a=GuidData.bag.getEquData(),b=0;10>b;b++){var c=b+1,d=this.equViewList[b];if(a[c]){var e=a[c].entryData;IconManager.getInstance().drawItemIcon60(d,e.id,1,!1,!1),d.data=a[c],d.addEventListener(InteractiveEvent.Up,this.equClick,this)}else this.setNoEquIcon(d.skinName,b)}},c.prototype.setNoEquIcon=function(a,b){var c=this._baseUiAtlas.getRec(a),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(d,this.partNameAry[b],16,0,25,TextAlign.CENTER,ColorType.Brownac8965),this._baseUiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.removeEquView=function(a){this.equViewList[a]&&(this.setNoEquIcon(this.equViewList[a].skinName,a),this.equViewList[a].removeEventListener(InteractiveEvent.Up,this.equClick,this))},c.prototype.equClick=function(b){UIManager.popClikNameFun("a_eq_0");var c=new a.ItemTipEvent(a.ItemTipEvent.SHOW_TIP_ITEM_EVENT);c.data=b.target.data,c.buttonType=1,ModuleEventManager.dispatchEvent(c)},c.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),this._bagPanel.hide(),this._smeltPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),b.prototype.hide.call(this)},c.prototype.add=function(a){void 0===a&&(a=1),this._defaultIdx=a,this.uiAtlasComplet&&(this._bagPanel.show(),0==a&&this.showRL(),this.refreshRole(),this.setWing()),ModulePageManager.showResTittle([1,2,3])},c}(WindowUi);a.CharBgPanel=b}(charbg||(charbg={}));var ItemGoodQuality=function(){function a(){}return a.getQuaStr=function(a){switch(a){case 0:return PuiData.A_GOODS_WHITE;case 1:return PuiData.A_GOODS_GREEN;case 2:return PuiData.A_GOODS_BLUE;case 3:return PuiData.A_GOODS_PURPLE;case 4:return PuiData.A_GOODS_ORANGE;case 5:return PuiData.A_GOODS_RED;default:return PuiData.A_GOODS_WHITE}},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),charbg;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_CHAR_BG_PANEL="SHOW_CHAR_BG_PANEL",b.SHOW_CHAR_INFO_PANEL="SHOW_CHAR_INFO_PANEL",b.BGDATA_CHANGE_EVENT="bgdata_change_event",b.EQUVIEW_CHANGE_EVENT="equview_change_event",b.EQUDATA_CHANG_EVENT="equdata_chang_event",b.SHOW_VIP_EVENT="SHOW_VIP_EVENT",b.VIP_GIFT_EVENT="SHOW_VIP_GIFT_EVENT",b.VIP_CHG_EVENT="VIP_CHG_EVENT",b.BAG_DATA_INIT_EVENT="BAG_DATA_INIT_EVENT",b}(BaseEvent);a.CharBgEvent=b;var c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.buttonType=-1,b}return __extends(b,a),b.SHOW_TIP_ITEM_EVENT="show_tip_item_event",b.SHOW_TIP_ITEM_ID_EVENT="show_tip_item_id_event",b}(BaseEvent);
a.ItemTipEvent=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"CharBgModule"},b.prototype.listProcessors=function(){return[new e]},b}(Module);a.CharBgModule=d;var e=function(d){function e(){var a=null!==d&&d.apply(this,arguments)||this;return a.baseTipItemData=new BagItemData,a}return __extends(e,d),e.prototype.getName=function(){return"CharBgProcessor"},e.prototype.receivedModuleEvent=function(a){if(a instanceof EngineEvent)a.type==EngineEvent.PLAYER_FIELD_FORCE?this._charBgPanel&&this._charBgPanel.refreshForce():a.type==EngineEvent.PLAYER_FIELD_LEVEL&&this._charBgPanel&&this._charBgPanel.refreshLevel();else if(a instanceof b){var d=a;d.type==b.SHOW_CHAR_BG_PANEL?this.showChatEvent(d.showType):d.type==b.BGDATA_CHANGE_EVENT?this.setBgChgData(d.data,d.showType):d.type==b.EQUVIEW_CHANGE_EVENT?this.setPanelRole(d.showType):d.type==b.SHOW_VIP_EVENT?this.showVip():d.type==b.VIP_CHG_EVENT?this.vipChg():d.type==b.VIP_GIFT_EVENT&&this.vipGift()}else if(a instanceof c){var e=a;e.type==c.SHOW_TIP_ITEM_EVENT?this.showTip(e.data,e.buttonType):e.type==c.SHOW_TIP_ITEM_ID_EVENT&&this.showBaseTip(e.id)}else if(a instanceof UIPanelEvent){var f=a;f.panel==this._charBgPanel&&(this._charBgPanel.dispose(),this._charBgPanel=null,console.log("释放面板 _charBgPanel"))}},e.prototype.showChatEvent=function(b){var c=this;this._charBgPanel||(this._charBgPanel=new a.CharBgPanel),this._charBgPanel.load(function(){UIManager.getInstance().addUIContainer(c._charBgPanel),c._charBgPanel.add(b),SceneManager.getInstance().render=!1;var a=new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT);ModuleEventManager.dispatchEvent(a);var d=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);d.data=SharedDef.MODULE_BAG,ModuleEventManager.dispatchEvent(d)})},e.prototype.showVip=function(){var b=this;this._vipPanel||(this._vipPanel=new a.VipPanel),this._vipPanel.load(function(){b._vipPanel.show()})},e.prototype.vipGift=function(){this._vipPanel&&this._vipPanel.hasStage&&this._vipPanel.redrawVipInfo()},e.prototype.vipChg=function(){this._vipPanel&&this._vipPanel.hasStage&&this._vipPanel.drawBaseVip()},e.prototype.setPanelRole=function(a){this._charBgPanel&&this._charBgPanel.refreshRoleType(a)},e.prototype.showTip=function(a,b){GoodsTip.getInstance().show(a,b)},e.prototype.showBaseTip=function(a){this.baseTipItemData.entryData=TableData.getInstance().getData(TableData.tb_item_template,a),GoodsTip.getInstance().show(this.baseTipItemData,-1)},e.prototype.setBgChgData=function(a,b){this._charBgPanel&&this._charBgPanel.bgDataChg(a,b)},e.prototype.showCharInfo=function(b){var c=this;this._charInfo||(this._charInfo=new a.CharInfoPanel),this._charInfo.load(function(){c._charInfo.show(b)})},e.prototype.receiveInfo=function(a){var b=new f,c=new s2c_show_player_overview;s2c_show_player_overview.read(c,a),b.spo=c;for(var d=a.readUint16(),e=0;d>e;e++){var g=new equip_info;g.equip=a.readUTF(),g.strength_lv=a.readUint32(),g.refine_rank=a.readUint32(),g.refine_star=a.readUint32(),g.gem1_lv=a.readUint32(),g.gem2_lv=a.readUint32(),g.gem3_lv=a.readUint32(),b.equAry.push(g)}this.showCharInfo(b)},e.prototype.listenModuleEvents=function(){return[new b(b.SHOW_CHAR_BG_PANEL),new b(b.SHOW_CHAR_INFO_PANEL),new c(c.SHOW_TIP_ITEM_EVENT),new c(c.SHOW_TIP_ITEM_ID_EVENT),new b(b.BGDATA_CHANGE_EVENT),new b(b.EQUVIEW_CHANGE_EVENT),new b(b.SHOW_VIP_EVENT),new b(b.VIP_CHG_EVENT),new b(b.VIP_GIFT_EVENT),new EngineEvent(EngineEvent.PLAYER_FIELD_FORCE),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},e.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_SHOW_PLAYER_OVERVIEW]=function(b){a.receiveInfo(b)},b},e}(BaseProcessor);a.CharBgProcessor=e;var f=function(){function a(){this.equAry=new Array}return a}();a.PlayerOverview=f}(charbg||(charbg={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fb;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.hideOrShow=!0,a.refresnum=0,a.hasMoreReward=!1,a.useFrameItem=new Array,a.lastTxtNum=0,a.interfaceUI=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.left=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a._midRender.uiAtlas.setInfo("ui/uidata/fuben/left/fubenleft.xml","ui/uidata/fuben/left/fubenleft.png",function(){a.loadConfigCom()}),a.upDataFun=function(b){a.update(b)},a}return __extends(c,b),c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.a_top_bg=this.addChild(this._bottomRender.getComponent("a_top_bg")),this.a_mid_bg=this.addChild(this._bottomRender.getComponent("a_mid_bg")),this.a_bottom_bg=this.addChild(this._bottomRender.getComponent("a_bottom_bg")),this.a_tittle_name=this.addChild(this._topRender.getComponent("a_tittle_name")),this.a_reward_name=this.addChild(this._topRender.getComponent("a_reward_name")),this.a_reward_icon_0=this.addChild(this._topRender.getComponent("a_reward_icon_0")),this.a_reward_icon_1=this.addChild(this._topRender.getComponent("a_reward_icon_1")),this.a_reward_icon_2=this.addChild(this._topRender.getComponent("a_reward_icon_2")),this.a_reward_more=this._topRender.getComponent("a_reward_more"),this.a_reward_more.addEventListener(InteractiveEvent.Down,this.moreClick,this),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_reward_more.skinName,ColorType.Yellowffe9b4+"奖励详情",21,TextAlign.CENTER),this.a_mid_bg.addEventListener(InteractiveEvent.Down,this.midClick,this),this.uiAtlasComplet=!0,this.refresh()},c.prototype.moreClick=function(a){ModuleEventManager.dispatchEvent(new sboss.SbossEvent(sboss.SbossEvent.WBOSS_MORE_REWARD))},c.prototype.midClick=function(a){},c.prototype.refresh=function(){if(this.uiAtlasComplet){switch(console.log(GuidData.map.tbMapVo.inst_sub_type),GuidData.map.tbMapVo.inst_sub_type){case SharedDef.INSTANCE_SUB_TYPE_WORLD_BOSS:this.rewardData=a.FuBenModel.getInstance().getWorldBossReward(),this.enterVipFuben(this.rewardData);break;case SharedDef.INSTANCE_SUB_TYPE_VIP:break;case SharedDef.INSTANCE_SUB_TYPE_PRIVATE_BOSS:this.rewardData=a.FuBenModel.getInstance().getPersonBossRewad(),this.enterVipFuben(this.rewardData);break;case SharedDef.INSTANCE_SUB_TYPE_TRIAL:this.rewardData=a.FuBenModel.getInstance().getTowerReawrd(),this.enterVipFuben(this.rewardData);break;case SharedDef.INSTANCE_SUB_TYPE_RES:this.rewardData=a.FuBenModel.getInstance().getResFubenRewad(),this.enterVipFuben(this.rewardData);break;case SharedDef.INSTANCE_SUB_TYPE_KUAFU_GROUP:this.rewardData=a.FuBenModel.getInstance().getTbGroupReward(),this.enterVipFuben(this.rewardData);break;case SharedDef.INSTANCE_SUB_TYPE_FACTION_BOSSDEFENSE:this.rewardData=a.FuBenModel.getInstance().getFactionLeadRewad(),this.enterVipFuben(this.rewardData);break;case SharedDef.INSTANCE_SUB_TYPE_FACTION_TOWER:this.rewardData=a.FuBenModel.getInstance().getFactionTripReward(),this.enterVipFuben(this.rewardData);break;default:this.rewardData={name:"",reward:[]},this.enterVipFuben(this.rewardData)}TimeUtil.addFrameTick(this.upDataFun)}},c.prototype.enterVipFuben=function(a){this.hasMoreReward=a.morereward;var b=a.reward,c=GuidData.map.getMapIntFieldQuestEndTm();this.endTime=GameInstance.getGameEndMillisecond(c)/1e3;for(var d=0;3>d;d++){var e=this["a_reward_icon_"+d];e.y=255,b[d]?(IconManager.getInstance().drawItemIcon40(e,b[d][0],b[d][1]),e.x=12+60*d):e.x=-200}LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_reward_name.skinName,ColorType.Yellowffe9b4+a.name,21,TextAlign.LEFT),this.refreshQuestList();var f=tb.TB_map.getTB_map(GuidData.map.getMapID()).name;a.lev&&(f+="[第"+a.lev+"关]"),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_tittle_name.skinName,ColorType.Yellowffd500+f,21,TextAlign.LEFT)},c.prototype.refreshQuestList=function(){if(this.uiAtlasComplet){this.clearFrameItem();var a=GuidData.map.getMapIntFieldQuests(),b=GuidData.map.getMapIntFieldQuestProcess();if(this.refresnum=GuidData.map.getMapWaveAllCount(),this.refresnum>0){var c;0==this.refresnum?c=ColorType.Yellowffe9b4+"通关条件":(c=ColorType.Yellowffe9b4+"通关条件(",c+=GuidData.map.getMapWaveCount()<this.refresnum?GuidData.map.getMapWaveCount()+"/"+this.refresnum:"已达成",c+=")");var d=this.getEmptyFrameUi();this.drawFrontToFrame(d,c)}for(var e=0;e<a.length;e++)if(a[e]){var f;0!=a[e].creatureId&&(f=tb.TB_creature_template.get_TB_creature_template(a[e].creatureId));var g=tb.TB_quest_vip_instance.get_TB_quest_vip_instance(a[e].questType),h=g.texst;h=f?h.replace("{name}",f.name):h.replace("{name}","小怪"),h=h.replace("{process}",b[e]),h=h.replace("{targets}",String(a[e].num));var i=b[e]>=a[e].num?ColorType.Green56da35:ColorType.Brownd8d49c,d=this.getEmptyFrameUi();d.x=20,this.drawFrontToFrame(d,i+h)}this.timeUiFrame=this.getEmptyFrameUi();var j=22*this.useFrameItem.length;if(j+=5,this.a_reward_name.y=this.getBasyTy()+j,j+=25,this.rewardData&&this.rewardData.reward.length){for(var e=0;3>e;e++){var k=this["a_reward_icon_"+e];k.y=this.getBasyTy()+j}j+=60}this.hasMoreReward?(this.addChild(this.a_reward_more),this.a_reward_more.y=this.getBasyTy()+j,j+=30):this.removeChild(this.a_reward_more),this.a_bottom_bg.y=this.getBasyTy()+j,this.a_mid_bg.height=this.a_bottom_bg.y-this.a_top_bg.y-this.a_top_bg.height,this.lastTxtNum=0}},c.prototype.getBasyTy=function(){return this.a_top_bg.y+25},c.prototype.drawFrontToFrame=function(a,b){var c=a.getSkinCtxRect(),d=UIManager.getInstance().getContext2D(c.width,c.height,!1);LabelTextFont.writeSingleLabelToCtx(d,b,21,0,0,TextAlign.LEFT),a.drawToCtx(this._topRender.uiAtlas,d)},c.prototype.getEmptyFrameUi=function(){var a=this.addChild(this._topRender.getComponent("a_task_frame"));return a.goToAndStop(this.useFrameItem.length),a.y=this.getBasyTy()+22*this.useFrameItem.length,this.useFrameItem.push(a),a},c.prototype.clearFrameItem=function(){for(;this.useFrameItem.length;)this.removeChild(this.useFrameItem.pop())},c.prototype.update=function(a){if(this.hasStage){if(this.uiAtlasComplet){var b=Math.floor(this.endTime-TimeUtil.getTimer()/1e3);if(b>=0&&this.lastTxtNum!=b){this.lastTxtNum=b;var c=b>10?ColorType.Green56da35:ColorType.Reddb4051;this.drawFrontToFrame(this.timeUiFrame,ColorType.Yellowffe9b4+"剩余时间:"+c+getScencdStr(b))}}GuidData.map&&!GuidData.map.showAreaById(AreaType.fubenLeftPane_20)&&this.hide()}else TimeUtil.removeFrameTick(this.upDataFun)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(UIConatiner);a.FubenLeftPanel=b}(fb||(fb={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fb;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.lastTxtNum=0,b.endTime=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b.interfaceUI=!0,b.upDataFun=function(a){b.update(a)},b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/fuben/reward/reward.xml","ui/uidata/fuben/reward/reward.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this.moveAry=new Array,this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.a_win_bg=this.addChild(this._bottomRender.getComponent("a_win_bg")),this.addChild(this._topRender.getComponent("a_win_tittle")),this.a_win_bg.addEventListener(InteractiveEvent.Up,function(){},this),this.a_win_bg.addEventListener(InteractiveEvent.Down,function(){},this),this.t_lab1=this._topRender.getComponent("t_lab1"),this.t_lab2=this._topRender.getComponent("t_lab2"),this.moveAry.push(this.addChild(this._topRender.getComponent("a_fenge_line_0"))),this.moveAry.push(this.addChild(this._topRender.getComponent("a_fenge_line_1"))),this.moveAry.push(this.addChild(this._midRender.getComponent("a_content_title_bg"))),this.moveAry.push(this.addChild(this._topRender.getComponent("a_content_label"))),this.a_tittle_name=this.addChild(this._topRender.getComponent("a_tittle_name")),this.a_exit_time=this.addChild(this._topRender.getComponent("a_exit_time")),this.a_exit_but=this.addEvntBut("a_exit_but",this._topRender),this.a_next_but=this._topRender.getComponent("a_next_but"),this.a_next_but.addEventListener(InteractiveEvent.Up,this.butClik,this),this.moveAry.push(this.a_exit_time,this.a_exit_but),this.rewardItem=new Array,this.rewardnameItem=new Array;for(var a=0;6>a;a++)this.rewardItem.push(this.addChild(this._topRender.getComponent("a_reward_icon"+a))),this.rewardnameItem.push(this.addChild(this._topRender.getComponent("a_reward_name"+a)));this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.setLabMove=function(a,b){var c=0;if(a){if(c=60,this.a_win_bg.height=this.a_win_bg.baseRec.height+c,this.t_lab1.parent||(this.addChild(this.t_lab1),this.addChild(this.t_lab2)),15==b.type){var d,e=b.data.split("|");d=250==b.state?ColorType.Green2ca937+"+"+e[0]:ColorType.colorcd2000+e[0],LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.t_lab1.skinName,ColorType.Brown7a2f21+"排位赛胜利,排位积分"+d,16,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.t_lab2.skinName,ColorType.Brown7a2f21+"当前积分:"+ColorType.Orange9a683f+ +e[1],16,TextAlign.CENTER)}}else this.a_win_bg.height=this.a_win_bg.baseRec.height,this.t_lab1.parent&&(this.removeChild(this.t_lab1),this.removeChild(this.t_lab2));for(var f=0;f<this.moveAry.length;f++)this.moveAry[f].y=this.moveAry[f].baseRec.y+c;for(var f=0;f<this.rewardItem.length;f++)this.rewardItem[f].y=this.rewardItem[f].baseRec.y+c,this.rewardnameItem[f].y=this.rewardnameItem[f].baseRec.y+c},b.prototype.showRewardIconItem=function(a){for(var b=Math.min(a.length,6),c=0;6>c;c++){var d=this.rewardItem[c],e=this.rewardnameItem[c];if(a[c]){d.x=446+100*c,d.x-=50*(b-1),e.x=d.x-4;var f=a[c].item_id,g=tb.TB_item_template.get_TB_item_template(f);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,e.skinName,getColorQua(g.quality)+g.name,14,TextAlign.CENTER),IconManager.getInstance().drawItemIcon60(d,f,a[c].num)}else d.x=2e3,e.x=2e3}},b.prototype.getBaseData=function(){for(var a=new Array,b=0;3>b;b++){var c=new Array;c.push(104),c.push(99),a.push(c)}return a},b.prototype.update=function(a){if(this.uiAtlasComplet)if(this.hasStage){var b=Math.floor((this.endTime-TimeUtil.getTimer())/1e3);if(-1>=b)this.hide(),this._dataVo.type==SharedDef.INSTANCE_SUB_TYPE_RISK&&GuidData.map.isAdventureBossScene()&&this.gotoRisk();else if(b>=0&&this.lastTxtNum!=b){this.lastTxtNum=b,console.log(b);var c;c=0==this._currentBtnType?"自动退出":"自动下一关",LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_exit_time.skinName,ColorType.colorce0a00+getScencdStr(b)+"秒后"+c,14,TextAlign.CENTER)}}else TimeUtil.removeFrameTick(this.upDataFun)},b.prototype.butClik=function(a){a.target==this.a_exit_but?(this.hide(),NetManager.getInstance().protocolos.instance_exit(0)):a.target==this.a_next_but&&(this.hide(),this._dataVo.type==SharedDef.INSTANCE_SUB_TYPE_RISK&&GuidData.map.isAdventureBossScene()?this.gotoRisk():this._dataVo.type==SharedDef.INSTANCE_SUB_TYPE_FACTION_TOWER?NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_TOWER_CHALLENGE,0,0,"",""):this._dataVo.type==SharedDef.INSTANCE_SUB_TYPE_TRIAL&&NetManager.getInstance().protocolos.enter_trial_instance())},b.prototype.gotoRisk=function(){ModuleEventManager.dispatchEvent(new SceneLoadEvent(SceneLoadEvent.SCENE_TRANSITION_EVENT)),TimeUtil.addTimeOut(500,function(){NetManager.getInstance().protocolos.enter_risk_instance()})},b.prototype.setNextBtn=function(a){a?(this.addChild(this.a_next_but),this.a_exit_but.x=this.a_exit_but.baseRec.x+80,this.a_next_but.x=this.a_next_but.baseRec.x+80):(this.removeChild(this.a_next_but),this.a_exit_but.x=this.a_exit_but.baseRec.x)},b.prototype.showBtnType=function(a){this._currentBtnType=a,0==a?(this.addChild(this.a_exit_but),this.removeChild(this.a_next_but),this.a_exit_but.x=this.a_exit_but.baseRec.x):1==a?(this.removeChild(this.a_exit_but),this.addChild(this.a_next_but),this.a_next_but.x=this.a_exit_but.baseRec.x):2==a&&(this.addChild(this.a_exit_but),this.addChild(this.a_next_but),this.a_exit_but.x=this.a_exit_but.baseRec.x+80,this.a_next_but.x=this.a_next_but.baseRec.x+80)},b.prototype.show=function(a){console.log(a),this._dataVo=a,a.type==SharedDef.INSTANCE_SUB_TYPE_QUALIFY?this.setLabMove(!0,a):this.setLabMove(!1,a);var b=0;a.type==SharedDef.INSTANCE_SUB_TYPE_TRIAL||a.type==SharedDef.INSTANCE_SUB_TYPE_FACTION_TOWER?b=2:this._dataVo.type==SharedDef.INSTANCE_SUB_TYPE_RISK&&GuidData.map.isAdventureBossScene()&&(b=1),this.showBtnType(b);var c=a.cd;5>c&&(c=10),this.endTime=TimeUtil.getTimer()+1e3*c,TimeUtil.addFrameTick(this.upDataFun),UIManager.getInstance().addUIContainer(this),250==a.state?this.a_tittle_name.goToAndStop(0):this.a_tittle_name.goToAndStop(1),this.showRewardIconItem(a.list)},b.prototype.hide=function(){TimeUtil.removeFrameTick(this.upDataFun),UIManager.getInstance().removeUIContainer(this)},b}(UIConatiner);a.FubenRewardPanel=b}(fb||(fb={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fb;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.lastTxtNum=0,b.endTime=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b.upDataFun=function(a){b.update(a)},b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/fuben/reward/reward.xml","ui/uidata/fuben/reward/reward.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._bottomRender.getComponent("b_win_bg")),this.addChild(this._midRender.getComponent("b_win_tittle")),this.addChild(this._midRender.getComponent("b_fenge_line_0")),this.addChild(this._midRender.getComponent("b_fenge_line_1")),this.b_exit_time=this.addChild(this._topRender.getComponent("b_exit_time"));var a=this.addChild(this._topRender.getComponent("b_tittle_name"));a.goToAndStop(1),this.addChild(this._bottomRender.getComponent("b_content_title_bg")),this.b_icon0=this.addEvntButUp("b_icon0",this._topRender),this.b_icon1=this.addEvntButUp("b_icon1",this._topRender),this.b_icon2=this.addEvntButUp("b_icon2",this._topRender),this.b_exit_but=this.addEvntButUp("b_exit_but",this._topRender),this.addChild(this._topRender.getComponent("b_content_label")),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.update=function(a){if(this.uiAtlasComplet)if(this.hasStage){var b=Math.floor((this.endTime-TimeUtil.getTimer())/1e3);-1>=b?this.hide():b>=0&&this.lastTxtNum!=b&&(this.lastTxtNum=b,console.log(b),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.b_exit_time.skinName,ColorType.colorce0a00+getScencdStr(b)+"秒后自动进行按钮操作",14,TextAlign.CENTER))}else TimeUtil.removeFrameTick(this.upDataFun)},b.prototype.butClik=function(a){switch(this.hide(),a.target){case this.b_icon0:GameData.enterSceneNextOpenEvent=new mountui.MountUiEvent(mountui.MountUiEvent.SHOW_MOUNT_EVENT),NetManager.getInstance().protocolos.instance_exit(0);break;case this.b_icon1:GameData.enterSceneNextOpenEvent=new skillUi.SkillUiEvent(skillUi.SkillUiEvent.SHOW_SKILLUI_EVENT),NetManager.getInstance().protocolos.instance_exit(0);break;case this.b_icon2:GameData.enterSceneNextOpenEvent=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.SHOW_STRENGTHGEM_PANEL),NetManager.getInstance().protocolos.instance_exit(0);break;case this.b_exit_but:NetManager.getInstance().protocolos.instance_exit(0)}},b.prototype.show=function(){var a=GameInstance.getGameSecond(GuidData.map.getMapIntFieldEndTM());1>a&&(a=10),this.endTime=TimeUtil.getTimer()+1e3*a,TimeUtil.addFrameTick(this.upDataFun),UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(UIConatiner);a.FubenFailPanel=b}(fb||(fb={}));var fb;!function(a){var b=function(){function a(){}return a}();a.FuBenResVo=b;var c=function(){function a(){this.initData()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getWorldBossReward=function(){var a=TableData.getInstance().getData(TableData.tb_worldboss_base,1),b=new Object;b.name="可能获得",b.notarget=!0,b.morereward=!0;for(var c=new Array,d=0;d<a.items.length;d++)c.push([a.items[d],1]);return b.reward=c,b},a.prototype.getTowerReawrd=function(){var a=GuidData.map.getTialID(),b=TableData.getInstance().getData(TableData.tb_instance_trial,a),c=new Object;return c.name="首通奖励",c.reward=b.firstReward,c.lev=a,c},a.prototype.getResFubenRewad=function(){var a=GuidData.map.getResMapID(),b=TableData.getInstance().getData(TableData.tb_instance_res,a),c=new Object;return c.name="基础奖励",c.reward=b.basereward,c},a.prototype.getPersonBossRewad=function(){var a=GuidData.map.getPersonBossMapID(),b=tb.Tb_private_boss_info.get_Tb_private_boss_infoById(a),c=new Object;c.name="参与可能获得以下奖励";for(var d=new Array,e=0;e<b.show.length;e++)d.push([b.show[e],0]);return c.reward=d,c},a.prototype.getFactionLeadRewad=function(){var a=GuidData.map.getReserve2(),b=TableData.getInstance().getData(TableData.tb_faction_bossdefense_pool,a),c=new Object;return c.name="首通奖励",c.reward=b.reward_preview,c.lev=a,c},a.prototype.getFactionTripReward=function(){var a=GuidData.map.getFloorNum(),b=TableData.getInstance().getData(TableData.tb_faction_tower_floor,a),c=new Object;return c.name="参与可能获得以下奖励",c.reward=b.firstpass_reward,c.lev=a,c},a.prototype.getTbGroupReward=function(){var a,b,c,d=GuidData.map.getKuafuGropuInstanceFieldsHard(),e=tb.TB_group_instance_base.getTempVo(d);GuidData.player.isPlayerIntFieldGroupClearFlag(d)?(c="通关奖励",a=e.passRewardId,b=e.passRewardCnt):(c="首通奖励",a=e.fpRewardId,b=e.fpRewardCnt);for(var f=new Array,g=0;g<a.length;g++){var h=new Array;h.push(a[g]),h.push(b[g]),f.push(h)}var i=new Object;return i.name=c,i.reward=f,i},a.prototype.initData=function(){this.sweepLastTime=0,this.vipItem=tb.TB_map_vip.getTabelItem(),this.trialItem=tb.TB_map_trial.getTabelItem()},a.prototype.refresh=function(){this.getVipData(),this.getTrialData()},a.prototype.getTrialData=function(){var a=GuidData.instanceData.getInstanceIntFieldTrialPassed();this.sweepCurrent=a[0],this.trialCurrent=a[1];var b=GuidData.instanceData.getInstanceIntFieldTrialSweep();this.sweepNum=b[0],this.canBuyNum=b[1]},a.prototype.getVipData=function(){for(var a=GuidData.instanceData.getInstanceIntFieldVipSatrt(),b=GuidData.player.getForce(),c=0;c<this.vipItem.length;c++){var d=this.vipItem[c];d.canPlayModel=0;for(var e=0;e<d.forces.length;e++)b>=d.forces[e]&&(d.canPlayModel=e);d.num=a[c].num,d.buynum=a[c].buys,d.passed=a[c].passed}},a.prototype.getFubenResItem=function(){if(!this.fubenResItem){this.fubenResItem=new Array;for(var a=tb.TB_instance_res.getTabelItem(),c=0;c<a.length;c++){var d=new b;d.data=a[c],this.fubenResItem.push(d)}}return this.getResData(),this.fubenResItem.sort(function(a,b){return a.data.type-b.data.type}),this.fubenResItem},a.prototype.getResData=function(){var a;GuidData.player.getVipLevel()>0&&(a=tb.TB_vip_base.get_TB_vip_baseById(GuidData.player.getVipLevel()));for(var b=GuidData.instanceData.getInstanceIntFieldResSatrt(),c=0;c<this.fubenResItem.length;c++){var d=this.fubenResItem[c];b[c]&&(this.fubenResItem[c].num=b[this.fubenResItem[c].data.id-1].num,this.fubenResItem[c].passed=b[this.fubenResItem[c].data.id-1].passed),a?this.fubenResItem[c].vipAddTime=1:this.fubenResItem[c].vipAddTime=0,d.maxtime=d.data.times}},a}();a.FuBenModel=c}(fb||(fb={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fb;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_FUBEN_EVENT="SHOW_FUBEN_EVENT",b.FUBEN_RANKING_DATA_EVENT="FUBEN_RANKING_DATA_EVENT",b.FUBEN_SHOW_FINISH_PANEL_EVENT="FUBEN_SHOW_FINISH_PANEL_EVENT",b.FUBEN_SHOW_REWARD_EVENT="FUBEN_SHOW_REWARD_EVENT",b.FUBEN_SHOW_FAIL_EVENT="FUBEN_SHOW_FAIL_EVENT",b.FUBEN_SHOW_LEFT_PANEL_EVENT="FUBEN_SHOW_LEFT_PANEL_EVENT",b.REFRESH_FUBEN_SCENE_LEFT_QUEST="REFRESH_FUBEN_SCENE_LEFT_QUEST",b.FUBEN_TRIAL_RANK_LIST_QUERY_RESULT="FUBEN_TRIAL_RANK_LIST_QUERY_RESULT",b}(BaseEvent);a.FubenEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"FubenModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.FubenModule=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"FubenProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;c.type==b.FUBEN_SHOW_LEFT_PANEL_EVENT&&this.showFubenLeftPanel(),c.type==b.REFRESH_FUBEN_SCENE_LEFT_QUEST&&this.fubenLeftPanel&&this.fubenLeftPanel.refreshQuestList()}},d.prototype.showFubenLeftPanel=function(){this.fubenLeftPanel||(this.fubenLeftPanel=new a.FubenLeftPanel),UIManager.getInstance().addUIContainer(this.fubenLeftPanel),this.fubenLeftPanel.refresh()},d.prototype.showFubenRewardPanel=function(b){var c=this;this.fubenRewardPanel||(this.fubenRewardPanel=new a.FubenRewardPanel),this.fubenRewardPanel.load(function(){c.fubenRewardPanel.show(b)})},d.prototype.showFubenFailPanel=function(){var b=this;this.fubenFailPanel=new a.FubenFailPanel,this.fubenFailPanel.load(function(){b.fubenFailPanel.show()})},d.prototype.listenModuleEvents=function(){return[new b(b.FUBEN_SHOW_LEFT_PANEL_EVENT),new b(b.REFRESH_FUBEN_SCENE_LEFT_QUEST),new b(b.FUBEN_SHOW_REWARD_EVENT),new b(b.FUBEN_SHOW_FAIL_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d.prototype.smsgSendInstanceResult=function(a){var b=new s2c_send_instance_result;s2c_send_instance_result.read(b,a),console.log(b),b.state==MapInfo.STATE_249&&15!=b.type&&7!=b.type?this.showFubenFailPanel():this.showFubenRewardPanel(b)},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_SEND_INSTANCE_RESULT]=function(b){a.smsgSendInstanceResult(b)},b},d}(BaseProcessor);a.FubenProcessor=d}(fb||(fb={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),reward;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._baseRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.applyLoad=function(){var a=this;this._baseRender.uiAtlas.setInfo("ui/uidata/reward/reward.xml","ui/uidata/reward/reward.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._topRender.uiAtlas=this._baseRender.uiAtlas,this._bottomRender.uiAtlas=this._baseRender.uiAtlas,this.a_bg=this.addEvntBut("a_bg",this._bottomRender),this.b_close=this.addEvntBut("b_close",this._topRender),this.addChild(this._baseRender.getComponent("a_win_bg")),this.addChild(this._topRender.getComponent("a_line")),this.addChild(this._topRender.getComponent("a_tittle_txt")),this.iconList=new Array;for(var a=0;8>a;a++)this.iconList.push(this.addChild(this._topRender.getComponent("b_icon"+a)));this.uiAtlasComplet=!0,this.applyLoadComplete(),this.refresh(),this.resize()},b.prototype.resize=function(){this.a_bg&&(this.a_bg.top=0,this.a_bg.left=0,this.a_bg.width=Scene_data.stageWidth/UIData.Scale,this.a_bg.height=Scene_data.stageHeight/UIData.Scale),a.prototype.resize.call(this)},b.prototype.butClik=function(a){switch(a.target.name){case"a_bg":break;case"b_close":this.close()}},b.prototype.refresh=function(){if(this.uiAtlasComplet)for(var a=0;a<this.iconList.length;a++){var b=this.iconList[a];this.rewardVo.list[a]?IconManager.getInstance().drawItemIcon60(b,this.rewardVo.list[a].item_id,this.rewardVo.list[a].num):IconManager.getInstance().drawItemIcon60(b,0,0)}},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this)},b}(UIPanel);a.RewardPanel=b}(reward||(reward={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),reward;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_FUBEN_EVENT="SHOW_FUBEN_EVENT",b}(BaseEvent);a.RewardEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"RewardModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.RewardModule=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.getName=function(){return"RewardProcessor"},c.prototype.receivedModuleEvent=function(a){if(a instanceof UIPanelEvent){var b=a;b.panel==this._rewardPanel&&(this._rewardPanel.dispose(),this._rewardPanel=null,console.log("释放面板 _rewardPanel"))}},c.prototype.showPanel=function(b){var c=this;this._rewardPanel?(this._rewardPanel.rewardVo=b,this._rewardPanel.refresh()):(this._rewardPanel=new a.RewardPanel,this._rewardPanel.rewardVo=b),this._rewardPanel.load(function(){UIManager.getInstance().addUIContainer(c._rewardPanel),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT))})},c.prototype.smsgSweepInstanceReward=function(a){var b=new s2c_sweep_instance_reward;console.log(b),s2c_sweep_instance_reward.read(b,a),this.showPanel(b)},c.prototype.getHanderMap=function(){var a=this,b=new Object;
return b[Protocols.SMSG_SWEEP_INSTANCE_REWARD]=function(b){a.smsgSweepInstanceReward(b)},b},c.prototype.listenModuleEvents=function(){return[new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},c}(BaseProcessor);a.RewardProcessor=d}(reward||(reward={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mountui;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MountUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.MountUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MOUNT_EVENT="SHOW_MOUNT_EVENT",b.HIDE_MOUNT_EVENT="HIDE_MOUNT_EVENT",b.MOUNT_LEVET_STAR_CHANGE_EVENT="MOUNT_LEVET_STAR_CHANGE_EVENT",b.CHANGE_jingjie_SKILL_PANEL="CHANGE_jingjie_SKILL_PANEL",b.EFF_EVENT="EFF_EVENT",b.SKILL_CHANGE_EVENT="SKILL_CHANGE_EVENT",b.MOUNT_LEV_CHANGE_EVENT="MOUNT_LEV_CHANGE_EVENT",b.HUANHUA_SELECT_ITEM_EVENT="HUANHUA_SELECT_ITEM_EVENT",b.POP_THE_UNREAL_PANEL="POP_THE_UNREAL_PANEL",b.CHG_MOUNT_FORCE="CHG_MOUNT_FORCE",b}(BaseEvent);a.MountUiEvent=c;var d=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a._nodeInit=!1,a}return __extends(d,b),d.prototype.getName=function(){return"MountUiProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_MOUNT_EVENT?this.showUi(b.data):b.type==c.HIDE_MOUNT_EVENT?this.hideUi():b.type==c.CHANGE_jingjie_SKILL_PANEL?this.changeSkillPanel():b.type==c.POP_THE_UNREAL_PANEL?this.actionHuanhua(b.data):b.type==c.MOUNT_LEVET_STAR_CHANGE_EVENT?this.lev_starchangeevent():b.type==c.SKILL_CHANGE_EVENT?this.skillchangeevent():b.type==c.MOUNT_LEV_CHANGE_EVENT?this.mountlevchange():b.type==c.HUANHUA_SELECT_ITEM_EVENT?this.huanhuaselectitem(b.data):b.type==c.EFF_EVENT?this.showflyword(b.data):b.type==c.CHG_MOUNT_FORCE&&this._newmountUiPanel&&this._newmountUiPanel.hasStage&&this._newmountUiPanel.setForce(),this.processRedPoint()}else a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT?this.initRedNode():(a.type==EngineEvent.MONEY_CHANGE||a.type==EngineEvent.SYSTEM_OPEN_EVENT)&&(this.processRedPoint(),this.refreshCost());if(a instanceof charbg.CharBgEvent&&a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT&&(this.processRedPoint(),this.refreshCost()),a instanceof UIPanelEvent){var d=a;if(d.panel==this._newmountUiPanel){for(var e=RedPointManager.getInstance().getNodeByID(33).children,f=0;f<e.length;f++)e[f].unBind();for(var g=RedPointManager.getInstance().getNodeByID(35).children,f=0;f<g.length;f++)g[f].unBind();this._newmountUiPanel.dispose(),this._newmountUiPanel=null,console.log("释放面板 _newmountUiPanel")}}},d.prototype.initRedNode=function(){if(!this._nodeInit){for(var b=RedPointManager.getInstance().getNodeByID(33),c=a.NewMountModel.getInstance().getSkillList(),d=0;d<c.length;d++){var e=new RedPointNode;e.data=c[d],b.addChild(e)}for(var f=RedPointManager.getInstance().getNodeByID(35),g=a.NewMountModel.getInstance().getHuanhuaVO(),d=0;d<g.length;d++){var e=new RedPointNode;e.data=g[d],f.addChild(e)}this._nodeInit=!0,this.processRedPoint()}},d.prototype.processRedPoint=function(){if(GuidData.grow&&0!=GuidData.grow.getMountLevel()){if(GuidData.player.getsyspageopen(SharedDef.MODULE_MOUNT,SharedDef.MODULE_MOUNT_UPGRADE)){var a=RedPointManager.getInstance().getNodeByID(29),b=tb.TB_mount_train_vo.getTabelItem();if(GuidData.grow.getMountLevel()==b[b.length-1].level&&GuidData.grow.getMountStart()==b[b.length-1].star)a.show=!1;else{var c;if(10==GuidData.grow.getMountStart()){var d=tb.TB_mount_upgrade.get_TB_mount_upgrade(GuidData.grow.getMountLevel());c=d.upgradecost}else{var e=tb.TB_mount_train_vo.getTB_mount_train_vo(GuidData.grow.getMountLevel(),GuidData.grow.getMountStart());c=e.traincost}for(var f=new Array,g=0;g<c.length;g++)f.push(hasEnoughResItem(c[g]));a.show=!0;for(var h=0;h<f.length;h++)a.show=a.show&&f[h]}}if(GuidData.player.getsyspageopen(SharedDef.MODULE_MOUNT,SharedDef.MODULE_MOUNT_LEVEL)){var i=RedPointManager.getInstance().getNodeByID(31),j=GuidData.grow.getMountlev()+1,k=tb.TB_mount_raise_level.get_TB_mount_raise_level();if(j>=k.length||GuidData.player.getLevel()<=j)i.show=!1;else{for(var l=new Array,g=0;g<k[j-1].cost.length;g++)l.push(hasEnoughResItem(k[j-1].cost[g]));i.show=!0;for(var h=0;h<l.length;h++)i.show=i.show&&l[h]}}if(GuidData.player.getsyspageopen(SharedDef.MODULE_MOUNT,SharedDef.MODULE_MOUNT_SKILL))for(var m=RedPointManager.getInstance().getNodeByID(33).children,g=0;g<m.length;g++){var n=m[g].data;if(0==n.state)if(GuidData.player.getLevel()<=n.lev)m[g].show=!1;else{for(var o=new Array,p=0;p<n.tabskill_uplev.uplevel_cost.length;p++)o.push(hasEnoughResItem(n.tabskill_uplev.uplevel_cost[p]));m[g].show=!0;for(var h=0;h<o.length;h++)m[g].show=m[g].show&&o[h]}else m[g].show=!1}if(GuidData.player.getsyspageopen(SharedDef.MODULE_MOUNT,SharedDef.MODULE_MOUNT_ILLUSION))for(var q=RedPointManager.getInstance().getNodeByID(35).children,g=0;g<q.length;g++){var r=q[g].data;if(1==r.state){for(var s=new Array,p=0;p<r.tab.costItem.length;p++)s.push(hasEnoughResItem(r.tab.costItem[p]));q[g].show=!0;for(var h=0;h<s.length;h++)q[g].show=q[g].show&&s[h]}else q[g].show=!1}}},d.prototype.showflyword=function(a){this._newmountUiPanel&&this._newmountUiPanel.hasStage&&this._newmountUiPanel.showflyword(a)},d.prototype.refreshCost=function(){this._newmountUiPanel&&this._newmountUiPanel.mountUpOrder&&this._newmountUiPanel.mountUpOrder.hasStage&&this._newmountUiPanel.mountUpOrder.resetData(),this._newmountUiPanel&&this._newmountUiPanel.mountUpLev&&this._newmountUiPanel.mountUpLev.hasStage&&this._newmountUiPanel.mountUpLev.drawResItem()},d.prototype.lev_starchangeevent=function(){return this._newmountUiPanel&&this._newmountUiPanel.hasStage&&1==GuidData.grow.getMountLevel()&&0==GuidData.grow.getMountStart()&&0==GuidData.grow.getMountExp()?void this._newmountUiPanel.show(SharedDef.MODULE_MOUNT_UPGRADE):(this._newmountUiPanel&&this._newmountUiPanel.hasStage&&GuidData.grow.getMountLevel()>0&&(this._newmountUiPanel.refreshLevStar(),this._newmountUiPanel.showExpEff(),this._newmountUiPanel.setAvatar(),this._newmountUiPanel.refreshSkill()),void(this._newmountUiPanel&&this._newmountUiPanel.mountUpOrder&&this._newmountUiPanel.mountUpOrder.hasStage&&this._newmountUiPanel.mountUpOrder.resetData()))},d.prototype.changeSkillPanel=function(){this._newmountUiPanel&&this._newmountUiPanel.mountSkill&&this._newmountUiPanel.mountSkill.mountSkillList&&this._newmountUiPanel.mountSkill.mountSkillList.hasStage&&this._newmountUiPanel.mountSkill.mountSkillList.refreshDataByNewData(),this._newmountUiPanel&&this._newmountUiPanel.hasStage},d.prototype.actionHuanhua=function(a){this._newmountUiPanel&&this._newmountUiPanel.mountHuanhua&&this._newmountUiPanel.mountHuanhua.huanhuaList&&this._newmountUiPanel.mountHuanhua.huanhuaList.hasStage&&(this._newmountUiPanel.mountHuanhua.huanhuaList.refreshDataByNewData(),this._newmountUiPanel.mountHuanhua.huanhuaList.setSelectIndex(this._newmountUiPanel.mountHuanhua.huanhuaList.getCurrentSelectIndex()))},d.prototype.huanhuaselectitem=function(a){this._newmountUiPanel&&this._newmountUiPanel.mountHuanhua&&this._newmountUiPanel.mountHuanhua.hasStage&&this._newmountUiPanel.mountHuanhua.resetData(a.data)},d.prototype.mountlevchange=function(){this._newmountUiPanel&&this._newmountUiPanel.mountUpLev&&this._newmountUiPanel.mountUpLev.hasStage&&this._newmountUiPanel.mountUpLev.resetData()},d.prototype.skillchangeevent=function(){this._newmountUiPanel&&this._newmountUiPanel.hasStage&&this._newmountUiPanel.refreshSkill()},d.prototype.hideUi=function(){ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),this._newmountUiPanel&&this._newmountUiPanel.hide()},d.prototype.showUi=function(b){var c=this;console.log("----------类型---------",b),this._newmountUiPanel||(this._newmountUiPanel=new a.NewMountUiPanel),this._newmountUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT));var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_MOUNT,ModuleEventManager.dispatchEvent(a),b instanceof Array?c._newmountUiPanel.show(b[0]):c._newmountUiPanel.show(b);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_MOUNT,ModuleEventManager.dispatchEvent(a)})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_MOUNT_EVENT),new c(c.HIDE_MOUNT_EVENT),new c(c.MOUNT_LEVET_STAR_CHANGE_EVENT),new c(c.CHANGE_jingjie_SKILL_PANEL),new c(c.POP_THE_UNREAL_PANEL),new c(c.EFF_EVENT),new c(c.CHG_MOUNT_FORCE),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new c(c.SKILL_CHANGE_EVENT),new c(c.MOUNT_LEV_CHANGE_EVENT),new c(c.HUANHUA_SELECT_ITEM_EVENT)]},d}(BaseProcessor);a.MountUiProcessor=d}(mountui||(mountui={}));var mountui;!function(a){var b=function(){function a(){}return a}();a.MountSkillData=b;var c=function(){function a(){}return a}();a.MountLevAttribute=c;var d=function(){function a(){}return a}();a.HuanhuaVo=d;var e=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getSkillList=function(){for(var a=new Array,c=GuidData.grow.getzuoqiJinengList(),d=tb.TB_mount_base_vo.getItem(),e=0;e<d.length;e++)if(0!=d[e].skills.length&&0!=d[e].skills[0]){var f=new b;f.id=e,f.tab=tb.TB_skill_base.get_TB_skill_base(d[e].skills[0]);var g=f.tab.uplevel_id[1]-f.tab.uplevel_id[0]+1;f.state=2,f.lev=d[e].id,f.tabskill_uplev=null;for(var h=0;h<c.length;h++)d[e].skills[0]==c[h].id&&(f.lev=c[h].lev,h==c.length,c[h].lev==g?f.state=1:(f.state=0,f.tabskill_uplev=tb.TB_skill_uplevel.get_TB_skill_uplevel(f.tab.uplevel_id[0]+f.lev-1)));a.push(f)}return a},a.prototype.getLevAttribute=function(){var a=new c,b=GuidData.grow.getMountlev(),d=tb.TB_mount_raise_level.get_TB_mount_raise_level();return a.nexttab=null,a.curtab=d[b-1],b<d.length?(a.nexttab=d[b],a.state=0,GuidData.player.getLevel()<=b&&(a.state=1)):a.state=2,console.log("==-levattr=",a,b),a},a.prototype.getOrderAttribute=function(){var a=new c,b=tb.TB_mount_train_vo.getTabelItem(),d=0==GuidData.grow.getMountLevel()?1:GuidData.grow.getMountLevel(),e=GuidData.grow.getMountStart(),f=11*(d-1)+e+1;a.nexttab=null,a.curtab=b[f-1];var g=b[b.length-1];return d==g.level&&e==g.star?a.state=2:(a.nexttab=this.differenceNum(b[f],b[f-1]),a.state=0),a},a.prototype.differenceNum=function(a,b){for(var c=new Array,d=0;d<a.prosKeys.length;d++)c.push(a.prosValues[d]-b.prosValues[d]);return c},a.prototype.getHuanhuaAttribute=function(a){var b=new c,d=tb.TB_mount_illusion_vo.get_TB_mount_illusion_vo(a);return b.nexttab=null,b.curtab=d,b.state=2,b},a.prototype.getHuanhuaVO=function(){for(var a=new Array,b=tb.TB_mount_illusion_vo.getTabelItem(),c=0;c<b.length;c++){var e=new d;e.tab=b[c],e.id=b[c].id,console.log("id -- ",e.id),e.state=this.isactivation(b[c].id),a.push(e)}return a.sort(function(a,b){return a.state!=b.state&&(1==a.state||1==b.state)?1==a.state?1:-1:a.tab.id-b.tab.id}),a},a.prototype.getHuanhuaIndex=function(){var a=this.getHuanhuaVO();console.log("---aary--",a);for(var b=0;b<a.length;b++)if(2==a[b].state)return a[b].id;return a[0].id},a.prototype.isactivation=function(a){for(var b=GuidData.grow.getHuanhuaID(),c=0;c<b.length;c++)if(b[c]==a)return GuidData.player.getMountHuanhua()==a?2:0;return 1},a}();a.NewMountModel=e;var f=function(){function a(){}return a}();a.MountUtil=f}(mountui||(mountui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mountui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._lastMouseX=0,a._lastRoleRotatioinY=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._roleRender=new UIRenderComponent,a.addRender(a._roleRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._publicbguiRender=new UIRenderComponent,a.addRender(a._publicbguiRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._roleRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._roleRender.dispose(),this._roleRender=null,this._topRender.dispose(),this._topRender=null,this._baseRender.dispose(),this._baseRender=null,this._redPointRender.dispose(),this._redPointRender=null,this.mountRoleSprite.destory(),this.mountRoleSprite=null,this._effRender&&(this._effRender.dispose(),this._effRender=null),this.mountUpOrder&&(this.mountUpOrder.dispose(),this.mountUpOrder=null),this.mountUpLev&&(this.mountUpLev.dispose(),this.mountUpLev=null),this.mountSkill&&(this.mountSkill.dispose(),this.mountSkill=null),this.mountHuanhua&&(this.mountHuanhua.dispose(),this.mountHuanhua=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicbguiRender.uiAtlas=WindowUi.winUIAtlas,this._roleRender.uiAtlas.setInfo("ui/uidata/mountui/newmountui.xml","ui/uidata/mountui/newmountui.png",function(){a.loadConfigCom()},"ui/uidata/mountui/mountpc.png")},c.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._roleRender.uiAtlas,this._baseRender.uiAtlas=this._roleRender.uiAtlas,this._topRender.uiAtlas=this._roleRender.uiAtlas,this.winmidRender.uiAtlas=this._publicbguiRender.uiAtlas,this.initData(),this.resize(),this.applyLoadComplete()},c.prototype.initData=function(){this.mountRoleSprite=new Person2DChar,this._roleRender.addModel(this.mountRoleSprite),this.a_ro_bg=this.addEvntBut("a_ro_bg",this._roleRender),this.SkillAry=new Array,this.SkillUnlockAry=new Array;for(var a=0;4>a;a++)this.SkillAry.push(this._roleRender.getComponent("a_skill"+a)),this.SkillUnlockAry.push(this.addChild(this._topRender.getComponent("a_skillunlock"+a)));this.TabAry=new Array;for(var a=0;4>a;a++){var b=this.addChild(this._bgRender.getComponent("tab"+a));b.data=a+SharedDef.MODULE_MOUNT_UPGRADE,b.addEventListener(InteractiveEvent.Down,this.click,this),this.TabAry.push(b),this._redPointRender.getRedPointUI(this,28+2*a,new Vector2D(b.x+b.width-5,b.y))}this.wingStarAry=new Array;for(var a=0;10>a;a++){var c=this.addChild(this._baseRender.getComponent("t_star"+a));c.goToAndStop(1),this.wingStarAry.push(c)}this.wingExPer=this._baseRender.getComponent("t_pre"),this.wingExPer.uvScale=.01,this.t_cursor=this._baseRender.getComponent("t_cursor"),this.wingExp=this._topRender.getComponent("t_exp"),this.a_name=this.addChild(this._topRender.getComponent("a_name")),this.a_force=this.addChild(this._topRender.getComponent("a_force")),this.AdvanceUIAry=new Array,this.AdvanceUIAry.push(this.wingExPer),this.AdvanceUIAry.push(this.t_cursor),this.AdvanceUIAry.push(this.wingExp),this.AdvanceUIAry.push(this._roleRender.getComponent("t_bg4")),this.AdvanceUIAry.push(this._roleRender.getComponent("a_forcebg"));var d=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(d,"rightLinebg",this._roleRender),this.SkillRightBgAry=new Array,this.OtherRightBgAry=new Array;var e=this.winmidRender.getComponent("cnew_bg_yellow");this.setSizeForPanelUiCopy(e,"a_leftbg_yellow",this._roleRender),this.SkillRightBgAry.push(e);var f=this.winmidRender.getComponent("cnew_right_bg_top");this.setSizeForPanelUiCopy(f,"b_right_bg_top",this._roleRender),this.OtherRightBgAry.push(f);var g=this.winmidRender.getComponent("cnew_right_bg_bottom");this.setSizeForPanelUiCopy(g,"b_right_bg_bottom",this._roleRender),this.OtherRightBgAry.push(g),this.winmidRender.applyObjData(),this.addUIList(["a_titlt","a_line1","t_mountshadow","a_namebg"],this._roleRender),this.addUIList(["t_bg"],this._bgRender),this.a_huanhuaok=this._roleRender.getComponent("a_huanhuaok"),this.UnlockUIAry=new Array,this.t_unlock0=this.addEvntBut("t_unlock0",this._bgRender),this.t_unlock0.data="请先激活坐骑",this.UnlockUIAry.push(this.t_unlock0),this.t_unlock1=this.addEvntBut("t_unlock1",this._bgRender),this.t_unlock1.data="请先激活坐骑",this.UnlockUIAry.push(this.t_unlock1),this.t_unlock2=this.addEvntBut("t_unlock2",this._bgRender),this.t_unlock2.data="请先激活坐骑",this.UnlockUIAry.push(this.t_unlock2),this.t_unlock3=this.addEvntBut("t_unlock3",this._bgRender),this.t_unlock3.data="请先激活坐骑",this.UnlockUIAry.push(this.t_unlock3)},c.prototype.A_left_bg_MouseDown=function(a){this._lastMouseX=a.x,this._lastRoleRotatioinY=this.mountRoleSprite.rotationY,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.A_left_bg_MouseMove=function(a){this.mountRoleSprite.rotationY=this._lastRoleRotatioinY-(a.x-this._lastMouseX)},c.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.rotationRole=function(){this.mountRoleSprite.rotationY-=.5},c.prototype.setAvatar=function(){var a,b=GuidData.grow.getMountLevel();0==b&&(b=1),0!=GuidData.player.getMountHuanhua()?(a=tb.TB_mount_illusion_vo.get_TB_mount_illusion_vo(GuidData.player.getMountHuanhua()),this.a_huanhuaok):a=tb.TB_mount_base_vo.get_TB_mount_base_vo(b),this.mountRoleSprite.setAvatar(a.mountID),this.mountRoleSprite.rotationY=45,LabelTextFont.writeSingleLabel(this._roleRender.uiAtlas,this.a_name.skinName,a.name+"     "+getChiNum(b)+"阶",16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.setHuanHuaAvatar=function(a,b){this.mountRoleSprite.setAvatar(a),this.mountRoleSprite.rotationY=45,LabelTextFont.writeSingleLabel(this._roleRender.uiAtlas,this.a_name.skinName,b,16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.resizeRole=function(){this.mountRoleSprite&&(this.mountRoleSprite.resize(),this.mountRoleSprite.scale=3*UIData.Scale,this.mountRoleSprite.rotationY=45,this.mountRoleSprite.x=100*UIData.Scale,this.mountRoleSprite.y=-75*UIData.Scale)},c.prototype.resize=function(){this.resizeRole(),b.prototype.resize.call(this)},c.prototype.refreshOpenLev=function(){if(this.activation)this.setUiListVisibleByItem(this.TabAry,!1),this.setUiListVisibleByItem(this.UnlockUIAry,!0);else{for(var a=new Array,b=0;b<SharedDef.MODULE_MOUNT_ILLUSION;b++){var c=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_MOUNT+b+1));a.push(c)}for(var d=0;d<a.length;d++)a[d].level<=GuidData.player.getLevel()?(this.setUiListVisibleByItem([this.TabAry[d]],!0),this.setUiListVisibleByItem([this.UnlockUIAry[d]],!1)):(this.setUiListVisibleByItem([this.TabAry[d]],!1),this.setUiListVisibleByItem([this.UnlockUIAry[d]],!0),this.UnlockUIAry[d].data="人物等级达到"+a[d].level+"级后解锁")}},c.prototype.show=function(b){this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.activation=0==GuidData.grow.getMountLevel(),this.refreshOpenLev(),this.setUiListVisibleByItem(this.AdvanceUIAry,!this.activation),this.setUiListVisibleByItem(this.wingStarAry,!this.activation),this.setUiListVisibleByItem(this.SkillAry,!0),this.activation?(this.unActivationUiPanel||(this.unActivationUiPanel=new a.UnActivationUiPanel,this.unActivationUiPanel.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas)),this.unActivationUiPanel.show(),this.setUiListVisibleByItem(this.OtherRightBgAry,!0),this.setUiListVisibleByItem(this.SkillRightBgAry,!1)):(this.unActivationUiPanel&&this.unActivationUiPanel.hide(),this.selectedTab(b),this.refreshLevStar(),this.setForce()),this.setAvatar(),this.refreshSkill()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.unActivationUiPanel&&this.unActivationUiPanel.hide(),this.hideTabPage(),ModulePageManager.hideResTittle()},c.prototype.refreshLevStar=function(){if(this.drawExp(),console.log("--阶数和星数--",this._lastlev,this._laststar,GuidData.grow.getMountLevel(),GuidData.grow.getMountStart()),this._lastlev==GuidData.grow.getMountLevel()&&this._laststar==GuidData.grow.getMountStart());else{this._lastlev=GuidData.grow.getMountLevel(),this._laststar=GuidData.grow.getMountStart();for(var a=0;a<this.wingStarAry.length;a++)this._laststar>a?this.wingStarAry[a].goToAndStop(0):this.wingStarAry[a].goToAndStop(1)}},c.prototype.showExpEff=function(){var a=this;console.log("up skill lev"),this._effRender||(this._effRender=new FrameUIRender,this.addRender(this._effRender),this._effRender.setImg(getEffectUIUrl("ui_cb"),3,4,function(b){a.expEff=b,a.expEff.x=a.wingExPer.x-70,a.expEff.y=a.wingExPer.y-55,a.expEff.width=1.1*a.expEff.baseRec.width,a.expEff.speed=5,a.expEff.playOne(a)})),this.expEff&&this.expEff.playOne(this)},c.prototype.drawExp=function(){var a,b,c=tb.TB_mount_train_vo.getTabelItem(),d=GuidData.grow.getMountLevel(),e=GuidData.grow.getMountStart();if(d==c[c.length-1].level&&e==c[c.length-1].star)a=1,b="已满级";else{var f,g=11*(d-1)+e+1;if(10==e){if(f=c[g-2],!f)return;a=1,b=f.exp+"/"+f.exp}else{if(f=c[g-1],!f)return;a=GuidData.grow.getMountExp()/f.exp,b=GuidData.grow.getMountExp()+"/"+f.exp}}a>this.wingExPer.uvScale?(TweenMoveTo(this.wingExPer,.1,{uvScale:a}),TweenMoveTo(this.t_cursor,.1,{x:240*a+197})):(TweenMoveTo(this.wingExPer,.1,{uvScale:1}),this.wingExPer.uvScale=0,TweenMoveTo(this.wingExPer,.1,{uvScale:a}),TweenMoveTo(this.t_cursor,.1,{x:437}),this.t_cursor.x=197,TweenMoveTo(this.t_cursor,.1,{x:240*a+197}),console.log("-$toScale--",a)),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.wingExp.skinName,b,14,TextAlign.CENTER,ColorType.Whiteffffff,"",0,0,!0)},c.prototype.refreshSkill=function(){var b=a.NewMountModel.getInstance().getSkillList(),c=b.length;c>4&&(c=4);for(var d=0;c>d;d++){var e=1;2==b[d].state?LabelTextFont.writeSingleLabel(this._roleRender.uiAtlas,this.SkillUnlockAry[d].skinName," "+b[d].lev+"阶\n开启",14,TextAlign.LEFT,ColorType.Whiteffffff):(e=b[d].lev,LabelTextFont.clearLabel(this._roleRender.uiAtlas,this.SkillUnlockAry[d].skinName)),IconManager.getInstance().drawMinSkillIcon(this.SkillAry[d],b[d].tab.id,2==b[d].state,e)}},c.prototype.setForce=function(){var a=GuidData.player.getMountForce();this._lastforce!=a&&(this._lastforce=a,ArtFont.getInstance().writeFontToSkinNameCenter(this._roleRender.uiAtlas,this.a_force.skinName,Snum(this._lastforce),ArtFont.num56))},c.prototype.selectedTab=function(a){for(var b=0;b<this.TabAry.length;b++)this.TabAry[b].data==a?this.TabAry[b].selected=!0:this.TabAry[b].selected=!1;this.setUiListVisibleByItem(this.OtherRightBgAry,a!=SharedDef.MODULE_MOUNT_SKILL),this.setUiListVisibleByItem(this.SkillRightBgAry,a==SharedDef.MODULE_MOUNT_SKILL),this.showTabPage(a),this.hideTabPage(a)},c.prototype.showTabPage=function(b){switch(b){case SharedDef.MODULE_MOUNT_UPGRADE:this.mountUpOrder||(this.mountUpOrder=new a.MountUpOrder,this.mountUpOrder.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.mountUpOrder.parent=this),this.mountUpOrder.show();break;case SharedDef.MODULE_MOUNT_LEVEL:this.mountUpLev||(this.mountUpLev=new a.MountUpLev,this.mountUpLev.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.mountUpLev.parent=this),this.mountUpLev.show();break;case SharedDef.MODULE_MOUNT_SKILL:this.mountSkill||(this.mountSkill=new a.MountSkill,this.mountSkill.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.mountSkill.parent=this),this.mountSkill.show();break;case SharedDef.MODULE_MOUNT_ILLUSION:this.mountHuanhua||(this.mountHuanhua=new a.MountHuanhua,this.mountHuanhua.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.mountHuanhua.parent=this),this.mountHuanhua.show()}var c=!1;b==SharedDef.MODULE_MOUNT_UPGRADE&&(c=!0),b==SharedDef.MODULE_MOUNT_ILLUSION?this.setUiListVisibleByItem([this.a_huanhuaok],!1):this.setUiListVisibleByItem([this.a_huanhuaok],0!=GuidData.player.getMountHuanhua()),this.setUiListVisibleByItem(this.AdvanceUIAry,c),this.setUiListVisibleByItem([this.AdvanceUIAry[this.AdvanceUIAry.length-1]],!0),this.setUiListVisibleByItem(this.wingStarAry,c),this.setUiListVisibleByItem(this.SkillUnlockAry,3>b),this.setUiListVisibleByItem(this.SkillAry,3>b)},c.prototype.hideTabPage=function(a){switch(void 0===a&&(a=-1),a){case SharedDef.MODULE_MOUNT_UPGRADE:this.mountUpLev&&this.mountUpLev.hide(),this.mountSkill&&this.mountSkill.hide(),this.mountHuanhua&&this.mountHuanhua.hide();break;case SharedDef.MODULE_MOUNT_LEVEL:this.mountUpOrder&&this.mountUpOrder.hide(),this.mountSkill&&this.mountSkill.hide(),this.mountHuanhua&&this.mountHuanhua.hide();break;case SharedDef.MODULE_MOUNT_SKILL:this.mountUpOrder&&this.mountUpOrder.hide(),this.mountUpLev&&this.mountUpLev.hide(),this.mountHuanhua&&this.mountHuanhua.hide();break;case SharedDef.MODULE_MOUNT_ILLUSION:this.mountUpOrder&&this.mountUpOrder.hide(),this.mountUpLev&&this.mountUpLev.hide(),this.mountSkill&&this.mountSkill.hide();break;default:this.mountUpOrder&&this.mountUpOrder.hide(),this.mountUpLev&&this.mountUpLev.hide(),this.mountSkill&&this.mountSkill.hide(),this.mountHuanhua&&this.mountHuanhua.hide()}},c.prototype.showflyword=function(a){var b=new Vector2D(this.wingExPer.parent.x+this.wingExPer.width,this.wingExPer.y),c=UiTweenVo.getPosByPanel(b,{width:UIData.designWidth,height:UIData.designHeight});c.x=c.x*UIData.Scale,c.y=c.y*UIData.Scale,msgtip.MsgTipManager.outStr(ColorType.Yellowedce7e+"坐骑经验+"+a,msgtip.PopMsgVo.type8,c)},c.prototype.butClik=function(b){switch(b.target){case this.a_ro_bg:this.A_left_bg_MouseDown(b);break;case this.w_close:UIManager.popClikNameFun("w_close"),ModuleEventManager.dispatchEvent(new a.MountUiEvent(a.MountUiEvent.HIDE_MOUNT_EVENT));break;case this.t_unlock0:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+this.t_unlock0.data,99);break;case this.t_unlock1:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+this.t_unlock1.data,99);break;case this.t_unlock2:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+this.t_unlock2.data,99);break;case this.t_unlock3:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+this.t_unlock3.data,99)}},c.prototype.click=function(a){this.selectedTab(a.target.data)},c}(WindowUi);a.NewMountUiPanel=b}(mountui||(mountui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mountui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.addUIList(["t_titlebg"],a),this.addUIList(["a_btntxt","a_info","a_attrtitle","t_line2","t_line2"],this._topRender),this.attrary=new Array;for(var b=0;8>b;b++)this.attrary.push(this.addChild(a.getComponent("a_attr"+b)));this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg",a),this._publicRender.applyObjData()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.showAttr(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.showAttr=function(){this._vo=a.NewMountModel.getInstance().getOrderAttribute();for(var b=0;b<this.attrary.length;b++)this._vo.curtab.prosKeys.length-1<b?this.setUiListVisibleByItem([this.attrary[b]],!1):UiDraw.drawAttValAdd(this.attrary[b],this._vo.curtab.prosKeys[b],this._vo.curtab.prosValues[b])},c.prototype.butClik=function(a){switch(a.target){case this.cnew_btn1:UIManager.popClikNameFun("cnew_btn1"),NetManager.getInstance().protocolos.active_mount()}},c}(UIVirtualContainer);a.UnActivationUiPanel=b}(mountui||(mountui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mountui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._canclick=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redRender=new RedPointRender,a.addRender(a._redRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redRender.dispose(),this._redRender=null},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.attrary=new Array,this.nextattrary=new Array;for(var b=0;8>b;b++)this.attrary.push(this.addChild(a.getComponent("c_attr"+b))),this.nextattrary.push(a.getComponent("c_nextattr"+b));this.addUIList(["c_titlebg","c_line2"],this._baseRender),this.addUIList(["c_attrtitle"],this._topRender),this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg",a),this._publicRender.applyObjData(),this.UplevAry=new Array,this.OverlevAry=new Array,this.UplevAry.push(a.getComponent("c_item0")),this.UplevAry.push(a.getComponent("c_item1")),this.UplevAry.push(a.getComponent("c_itemnum0")),this.UplevAry.push(a.getComponent("c_itemnum1")),this.UplevAry.push(this._topRender.getComponent("c_btntxt")),this.UplevAry.push(this.cnew_btn1),this.OverlevAry.push(this._topRender.getComponent("c_over")),this.btnRedPoint=this._redRender.getRedPointUI(this,29,new Vector2D(this.cnew_btn1.x+this.cnew_btn1.width,this.cnew_btn1.y))},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.resetData=function(){this._vo=a.NewMountModel.getInstance().getOrderAttribute(),this.parent.setAvatar(),this.setcostary(),this.showAttr(),this.drawBtnAndProp()},c.prototype.showAttr=function(){this.setUiListVisibleByItem(this.nextattrary,2!=this._vo.state);for(var a=0;a<this.nextattrary.length&&null!=this._vo.nexttab;a++)this._vo.nexttab.length-1<a?this.setUiListVisibleByItem([this.nextattrary[a]],!1):UiDraw.drawAddValTop(this.nextattrary[a],this._vo.nexttab[a]);for(var b=0;b<this.attrary.length;b++)this._vo.curtab.prosKeys.length-1<b?this.setUiListVisibleByItem([this.attrary[b]],!1):(UiDraw.drawAttVal(this.attrary[b],this._vo.curtab.prosKeys[b],this._vo.curtab.prosValues[b]),
this.attrary[b].x=2==this._vo.state?669:630)},c.prototype.setcostary=function(){var a;if(10==GuidData.grow.getMountStart()){var b=tb.TB_mount_upgrade.get_TB_mount_upgrade(GuidData.grow.getMountLevel());a=b.upgradecost}else{var c=tb.TB_mount_train_vo.getTB_mount_train_vo(GuidData.grow.getMountLevel(),GuidData.grow.getMountStart());a=c.traincost}this._costary=a},c.prototype.drawBtnAndProp=function(){if(this.setUiListVisibleByItem(this.OverlevAry,2==this._vo.state),this.setUiListVisibleByItem(this.UplevAry,2!=this._vo.state),2!=this._vo.state){var a=new Array;10==GuidData.grow.getMountStart()?this.UplevAry[4].goToAndStop(1):this.UplevAry[4].goToAndStop(0);for(var b=0;2>b;b++)b<this._costary.length?(IconManager.getInstance().drawItemIcon60(this.UplevAry[b],this._costary[b][0]),a.push(UiDraw.drawResHasNumAndAllNum(this.UplevAry[b+2],this._costary[b])),this.UplevAry[2].x=1==this._costary.length?687:633,this.UplevAry[0].x=1==this._costary.length?699:645):(LabelTextFont.clearLabel(this._topRender.uiAtlas,this.UplevAry[b+2].skinName),LabelTextFont.clearLabel(this._topRender.uiAtlas,this.UplevAry[b].skinName));this._canbuy=a}},c.prototype.butClik=function(a){var b=this;if(this._canclick)switch(UIManager.popClikNameFun(a.target.name),UiTweenScale.getInstance().changeButSize(a.target),this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0}),a.target){case this.cnew_btn1:var c,d;if(2==this._canbuy.length?(c=this._canbuy[0]&&this._canbuy[1],c||(d=this._canbuy[0]?this._costary[1][0]:this._costary[0][0])):(c=this._canbuy[0],c||(d=this._costary[0][0])),c)10==GuidData.grow.getMountStart()?NetManager.getInstance().protocolos.upgrade_mount(0):NetManager.getInstance().protocolos.raise_mount();else{var e=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);e.data=d,ModuleEventManager.dispatchEvent(e)}}},c}(UIVirtualContainer);a.MountUpOrder=b}(mountui||(mountui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mountui;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._canclick=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redRender=new RedPointRender,a.addRender(a._redRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redRender.dispose(),this._redRender=null},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.attrary=new Array,this.nextattrary=new Array;for(var b=0;7>b;b++)this.attrary.push(this.addChild(a.getComponent("e_attr"+b))),this.nextattrary.push(a.getComponent("e_nextattr"+b));this.curlevary=new Array,this.nextlevary=new Array,this.curlevary.push(this.addChild(a.getComponent("e_levtxt0"))),this.curlevary.push(this.addChild(a.getComponent("e_curlev"))),this.nextlevary.push(a.getComponent("e_levtxt1")),this.nextlevary.push(a.getComponent("e_nextlev")),this.nextlevary.push(a.getComponent("a_arrow")),this.addUIList(["e_titlebg","e_line2"],this._baseRender),this.addUIList(["e_attrtitle"],this._topRender),this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg",a),this._publicRender.applyObjData(),this.actionary=new Array,this.actionary.push(a.getComponent("e_itemname")),this.actionary.push(a.getComponent("e_item")),this.actionary.push(this._topRender.getComponent("e_btntxt")),this.actionary.push(this.cnew_btn1),this.noactionary=new Array,this.noactionary.push(this._topRender.getComponent("e_over")),this.btnRedPoint=this._redRender.getRedPointUI(this,31,new Vector2D(this.cnew_btn1.x+this.cnew_btn1.width,this.cnew_btn1.y))},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.parent.setAvatar(),this.resetData(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.resetData=function(){this._vo=a.NewMountModel.getInstance().getLevAttribute(),this.showAttr(),this.drawLev(),this.drawResItem()},c.prototype.drawLev=function(){this.setUiListVisibleByItem(this.nextlevary,2!=this._vo.state),this.curlevary[0].x=2==this._vo.state?679:637,this.curlevary[1].x=2==this._vo.state?725:672,2!=this._vo.state&&LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.nextlevary[1].skinName,String(this._vo.nexttab.id),16,TextAlign.RIGHT,ColorType.color9a683f),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.curlevary[1].skinName,String(this._vo.curtab.id),16,TextAlign.LEFT,ColorType.color9a683f)},c.prototype.showAttr=function(){this.setUiListVisibleByItem(this.nextattrary,2!=this._vo.state);for(var a=0;a<this.attrary.length;a++)this._vo.curtab.prosKeys.length-1<a?this.setUiListVisibleByItem([this.attrary[a]],!1):(UiDraw.drawAttVal(this.attrary[a],this._vo.curtab.prosKeys[a],this._vo.curtab.prosValues[a]),this.attrary[a].x=2==this._vo.state?679:637);console.log("下一阶数据-----",this._vo);for(var b=0;b<this.nextattrary.length&&null!=this._vo.nexttab;b++)this._vo.nexttab.prosKeys.length-1<b?this.setUiListVisibleByItem([this.nextattrary[b]],!1):UiDraw.drawAddValRight(this.nextattrary[b],this._vo.nexttab.prosValues[b])},c.prototype.drawResItem=function(){this.setUiListVisibleByItem(this.noactionary,2==this._vo.state),this.setUiListVisibleByItem(this.actionary,2!=this._vo.state),2!=this._vo.state&&(IconManager.getInstance().drawItemIcon60(this.actionary[1],this._vo.curtab.cost[0][0]),this._canbuy=UiDraw.drawResHasNumAndAllNum(this.actionary[0],this._vo.curtab.cost[0]))},c.prototype.butClik=function(a){var b=this;if(this._canclick)switch(UiTweenScale.getInstance().changeButSize(a.target),this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0}),a.target){case this.cnew_btn1:if(1==this._vo.state)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"不可超过人物等级",99);if(this._canbuy)NetManager.getInstance().protocolos.raise_mount_level_base();else{var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);c.data=this._vo.curtab.cost[0][0],ModuleEventManager.dispatchEvent(c)}}},c}(UIVirtualContainer);a.MountUpLev=b}(mountui||(mountui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mountui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.t_listadjust=this.addChild(a.getComponent("t_listadjust"))},b.prototype.resize=function(){a.prototype.resize.call(this),this.mountSkillList&&(this.mountSkillList.left=this.t_listadjust.parent.x/UIData.Scale+this.t_listadjust.x,this.mountSkillList.top=this.t_listadjust.parent.y/UIData.Scale+this.t_listadjust.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.parent.setAvatar(),this.mountSkillList||(this.mountSkillList=new c,this.mountSkillList.init(this._baseRender.uiAtlas)),this.mountSkillList.show(),this.resize()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.mountSkillList&&this.mountSkillList.hide()},b.prototype.resetData=function(){},b.prototype.butClik=function(a){switch(a.target){}},b}(UIVirtualContainer);a.MountSkill=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=608,a.top=83,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,254,432,0,90,4,512,512,1,7,2)},c.prototype.refreshDataByNewData=function(){for(var b=RedPointManager.getInstance().getNodeByID(33).children,c=a.NewMountModel.getInstance().getSkillList(),d=0;d<this._itemDataList.length;d++)b[d].data=c[d],c[d].node=b[d],this._itemDataList[d].data=c[d];this.refreshDraw(),this.setSelectIndex(this.getCurrentSelectIndex())},c.prototype.getData=function(a){for(var b=new Array,c=RedPointManager.getInstance().getNodeByID(33).children,d=0;d<a.length;d++){c[d].data=a[d],a[d].node=c[d];var e=new SListItemData;e.data=a[d],e.id=d,b.push(e)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this._itemDataList=this.getData(a.NewMountModel.getInstance().getSkillList()),this.refreshData(this._itemDataList),this.setSelectIndex(this.getCurrentSelectIndex())},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.MountSkillList=c;var d=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._canclick=!0,b}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e);var f=this._customRenderAry[0],g=this._customRenderAry[1];this.UnlockBg=this.creatGrid9SUI(f,this.parentTarget.baseAtlas,"UnlockBg",0,0,254,86,15,15),b.addChild(this.UnlockBg),this.Sname=this.creatSUI(g,this.parentTarget.baseAtlas,"Sname",94,18,120,20),b.addChild(this.Sname),this.Scost=this.creatSUI(d,this.parentTarget.baseAtlas,"Scost",94,41,110,35),b.addChild(this.Scost),this.Sselect1=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"Sselect1",0,0,254,86,15,15),b.addChild(this.Sselect1),this.Sselect1.addEventListener(InteractiveEvent.Up,this.equClick,this),this.Sbtn=this.creatSUI(d,this.parentTarget.baseAtlas,"Sbtn",217,28,30,30),b.addChild(this.Sbtn),this.Sbtn.addEventListener(InteractiveEvent.Up,this.equClick,this),this.Sicon=this.creatSUI(d,this.parentTarget.baseAtlas,"Sicon",13,9,68,68),b.addChild(this.Sicon),this.Redpoint=this.creatSUI(g,this.parentTarget.baseAtlas,"Redpoint",237,0,17,16),this.Redpoint.preParent=b,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Redpoint.skinName,UIData.publicUi,PuiData.A_RED_POINT)},Object.defineProperty(b.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.itdata&&this.applyrender()},enumerable:!0,configurable:!0}),b.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;a.node&&a.node.bindUI(this.Redpoint),this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sselect1.skinName,UIData.publicUi,PuiData.Slist_select):UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sselect1.skinName,UIData.publicUi,PuiData.Slist_nselect);var b=1;2==a.state?(LabelTextFont.writeSingleLabel(this.uiAtlas,this.Sname.skinName,"坐骑"+a.lev+"阶解锁",16,TextAlign.RIGHT,ColorType.Yellowffecc6),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.UnlockBg.skinName,UIData.publicUi,PuiData.MASK),LabelTextFont.clearLabel(this.uiAtlas,this.Sbtn.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Scost.skinName)):(b=a.lev,LabelTextFont.writeSingleLabel(this.uiAtlas,this.Sname.skinName,a.tab.name+"  Lv"+a.lev,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.clearLabel(this.uiAtlas,this.UnlockBg.skinName),1==a.state?(LabelTextFont.clearLabel(this.uiAtlas,this.Sbtn.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Scost.skinName,"技能等级已满",14,TextAlign.LEFT,ColorType.Green2ca937)):(this._canbuy=UiDraw.drawRewardIconAndtxt(this.Scost,a.tabskill_uplev.uplevel_cost[0],!0,TextAlign.LEFT,10),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sbtn.skinName,UIData.publicUi,PuiData.BTNADD))),IconManager.getInstance().drawCircleIcon(this.Sicon,2,a.tab.id,!1,b)}},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},b.prototype.refreshDraw=function(){this.render(this.itdata)},b.prototype.equClick=function(a){var b=this;if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;switch(a.target){case this.Sselect1:this.setSelect();break;case this.Sbtn:if(UiTweenScale.getInstance().changeButSize(a.target),0==this.itdata.data.state&&this._canclick)if(this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0}),this._canbuy){if(GuidData.player.getLevel()<=this.itdata.data.lev)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"不能大于人物等级",99);NetManager.getInstance().protocolos.raise_base_spell(SharedDef.RAISE_MOUNT_SKILL,this.itdata.data.tab.id)}else{var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);c.data=this.itdata.data.tabskill_uplev.uplevel_cost[0][0],ModuleEventManager.dispatchEvent(c)}}}},b.prototype.setnull=function(){UiDraw.clearUI(this.UnlockBg),UiDraw.clearUI(this.Sname),UiDraw.clearUI(this.Scost),UiDraw.clearUI(this.Sbtn),UiDraw.clearUI(this.Sselect1),UiDraw.clearUI(this.Sicon),this.Redpoint.preHide()},b}(SListItem);a.MountSkillListRender=d}(mountui||(mountui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mountui;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null},b.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.attrary=new Array;for(var b=0;7>b;b++)this.attrary.push(this.addChild(this._topRender.getComponent("h_attr"+b)));this.h_btntxt=this.addChild(this._topRender.getComponent("h_btntxt")),this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg",a),this._publicRender.applyObjData(),this.actionary=new Array,this.actionary.push(a.getComponent("h_item")),this.actionary.push(a.getComponent("h_itemname")),this.actionary.push(a.getComponent("h_itemnum1")),this.addUIList(["h_line2","h_titlebg"],a),this.addUIList(["h_forcetxt","h_title"],this._topRender),this.h_force=this.addChild(this._topRender.getComponent("h_force")),this.h_listadjust=this.addChild(a.getComponent("h_listadjust")),this._btnRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.cnew_btn1.x+this.cnew_btn1.width,this.cnew_btn1.y))},b.prototype.resize=function(){a.prototype.resize.call(this),this.huanhuaList&&(this.huanhuaList.left=this.h_listadjust.parent.x/UIData.Scale+this.h_listadjust.x,this.huanhuaList.top=this.h_listadjust.parent.y/UIData.Scale+this.h_listadjust.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.huanhuaList||(this.huanhuaList=new c,this.huanhuaList.init(this._baseRender.uiAtlas)),this.huanhuaList.show(),this.resize()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.huanhuaList&&this.huanhuaList.hide()},b.prototype.resetData=function(a){this._data=a,this.drawResItem(),this.showAttr();var b=getForceByAtt(a.tab.prosKeys,a.tab.prosValues);ArtFont.getInstance().writeFontToSkinNameCenter(this._baseRender.uiAtlas,this.h_force.skinName,Snum(b),ArtFont.num56);var c;c=1==this._data.state?0:0==this._data.state?1:2,console.log("---srt---",c),this.h_btntxt.goToAndStop(c),this.parent.setHuanHuaAvatar(a.tab.mountID,a.tab.name),a.node.show?this._btnRedPoint.preShow():this._btnRedPoint.preHide()},b.prototype.drawResItem=function(){if(this.setUiListVisibleByItem(this.actionary,1==this._data.state),1==this._data.state){var a;this._data.tab.costItem&&this._data.tab.costItem.length>0&&(a=this._data.tab.costItem),this._data.tab.costResource&&this._data.tab.costResource.length>0&&(a=this._data.tab.costResource),IconManager.getInstance().drawItemIcon60(this.actionary[0],a[0][0]),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.actionary[1].skinName,GameData.getPropName(a[0][0]),16,TextAlign.CENTER,ColorType.Brown7a2f21),this._canbuy=UiDraw.drawResHasNumAndAllNum(this.actionary[2],a[0])}},b.prototype.showAttr=function(){for(var a=0;a<this.attrary.length;a++)this._data.tab.prosKeys.length-1<a?this.setUiListVisibleByItem([this.attrary[a]],!1):UiDraw.drawAttVal(this.attrary[a],this._data.tab.prosKeys[a],this._data.tab.prosValues[a])},b.prototype.butClik=function(a){var b=this;switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.cnew_btn1:if(1==this._data.state){var c,d;if(this._data.tab.costItem&&this._data.tab.costItem.length>0&&(d=this._data.tab.costItem,c=!1),this._data.tab.costResource&&this._data.tab.costResource.length>0&&(d=this._data.tab.costResource,c=!0),c)costRes(d[0],function(){NetManager.getInstance().protocolos.illusion_mount_active(b._data.tab.id)},function(){});else if(this._canbuy)NetManager.getInstance().protocolos.illusion_mount_active(this._data.tab.id);else{var d;this._data.tab.costItem&&this._data.tab.costItem.length>0&&(d=this._data.tab.costItem),this._data.tab.costResource&&this._data.tab.costResource.length>0&&(d=this._data.tab.costResource);var e=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);e.data=d[0][0],ModuleEventManager.dispatchEvent(e)}}else NetManager.getInstance().protocolos.illusion_mount(this._data.tab.id)}},b}(UIVirtualContainer);a.MountHuanhua=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=147,a.top=425,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,365,95,81,0,4,1024,128,8,1)},c.prototype.refreshDataByNewData=function(){for(var b=RedPointManager.getInstance().getNodeByID(35).children,c=a.NewMountModel.getInstance().getHuanhuaVO(),d=0;d<this._ItemDataList.length;d++)b[d].data=c[d],c[d].node=b[d],this._ItemDataList[d].data=c[d];this.refreshDraw(),this.scrollAndselect()},c.prototype.getData=function(a){for(var b=RedPointManager.getInstance().getNodeByID(35).children,c=new Array,d=0;d<a.length;d++){b[d].data=a[d],a[d].node=b[d];var e=new SListItemData;e.data=a[d],e.id=d,c.push(e)}return c},c.prototype.setSelect=function(a){b.prototype.setSelect.call(this,a),this._lastTid=a.itdata.data.id},c.prototype.getSelectIdByTid=function(a){console.log("---表id---",a);for(var b=0;b<this._ItemDataList.length;b++)if(this._ItemDataList[b].data.id==a)return this._ItemDataList[b].id;return console.log("--没有符合的项",a),0},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this._ItemDataList=this.getData(a.NewMountModel.getInstance().getHuanhuaVO()),this.refreshData(this._ItemDataList),this._lastTid=a.NewMountModel.getInstance().getHuanhuaIndex(),this.scrollAndselect()},c.prototype.scrollAndselect=function(){var a=this.getSelectIdByTid(this._lastTid);this.scrollIdx(a),this.setSelectIndex(a)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(TransverseSList);a.HuanhuaList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Spic=this.creatSUI(d,this.parentTarget.baseAtlas,"Spic",0,0,74,74),a.addChild(this.Spic),this.Spic.addEventListener(InteractiveEvent.Up,this.equClick,this),this.ScurHuanhua=this.creatSUI(d,this.parentTarget.baseAtlas,"ScurHuanhua",2,70,70,24),a.addChild(this.ScurHuanhua),this.Sredpoint=this.creatSUI(d,this.parentTarget.baseAtlas,"Sredpoint",57,3,17,16),this.Sredpoint.preParent=a,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sredpoint.skinName,UIData.publicUi,PuiData.A_RED_POINT)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.applyrender(),b){var c=new a.MountUiEvent(a.MountUiEvent.HUANHUA_SELECT_ITEM_EVENT);c.data=this.itdata,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;IconManager.getInstance().drawMountIcon(this.Spic,a.tab.mountID,1==a.state,this.selected),2==a.state?this.drawCurHuanhua():UiDraw.clearUI(this.ScurHuanhua),a.node&&a.node.bindUI(this.Sredpoint)}},c.prototype.drawCurHuanhua=function(){var a=this.uiAtlas.getRec(this.ScurHuanhua.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),c=this.parentTarget.baseAtlas.getRec("CurHuanhua");b.drawImage(this.parentTarget.baseAtlas.useImg,c.pixelX,c.pixelY,c.pixelWitdh,c.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this.uiAtlas.updateCtx(b,a.pixelX,a.pixelY)},c.prototype.drawIcon=function(){var a=this;IconManager.getInstance().getIcon("ui/skillicon/zuoqi.png",function(b){var c=a.uiAtlas.getRec(a.Spic.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.A_BLACK_BASE,new Rectangle(1,1,48,48),UIData.publicUi),d.drawImage(b,0,0,65,65,3,3,44,44),a.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.refreshDraw=function(){this.render(this.itdata)},c.prototype.equClick=function(a){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;this.setSelect()}},c.prototype.setnull=function(){UiDraw.clearUI(this.Spic),UiDraw.clearUI(this.ScurHuanhua),this.Sredpoint.preHide()},c}(SListItem);a.HuanhuaListRender=d}(mountui||(mountui={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),copytask;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._publicbgRender=new UIRenderComponent,b.addRender(b._publicbgRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._bgRender.uiAtlas=new UIAtlas,b._frameFun=function(a){b.upTime(a)},b}return __extends(b,a),b.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._bgRender.dispose(),this._bgRender=null},b.prototype.applyLoad=function(){var a=this;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender.uiAtlas.setInfo("ui/uidata/copytask/matejoin.xml","ui/uidata/copytask/matejoin.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._bgRender.uiAtlas,this._midRender.uiAtlas=this._bgRender.uiAtlas,this.bg=this.addEvntBut("bg",this._bgRender),this.bg.addEventListener(InteractiveEvent.Up,this.butClik,this),this.addUIList(["a_timetxt","a_jointxt"],this._midRender),this.addChild(this._midRender.getComponent("a_btntxt")),this.addChild(this._bottomRender.getComponent("a_bg")),this.a_name=this.addChild(this._midRender.getComponent("a_name")),this.a_time=this.addChild(this._midRender.getComponent("a_time")),this.a_num=this.addChild(this._midRender.getComponent("a_num")),this.cnew_btn1=this.addEvntBut("cnew_btn1",this._publicbgRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg",this._midRender),this._publicbgRender.applyObjData(),this.resize(),this.applyLoadComplete()},b.prototype.butClik=function(a){switch(a.target){case this.cnew_btn1:NetManager.getInstance().protocolos.kuafu_3v3_cancel_match(this._itdata.type),this.close(),NetManager.getInstance().protocolos.instance_exit(0);break;case this.bg:}},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.show=function(a){if(this._itdata=a,!this.hasStage)if(this._curtime=-1,this.lasttime=TimeUtil.getTimer(),TimeUtil.addFrameTick(this._frameFun),UIManager.getInstance().addUIContainer(this),a.type==SharedDef.KUAFU_TYPE_GROUP_INSTANCE){var b=tb.TB_group_instance_base.getTempVo(a.data);LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_name.skinName,b.name,16,TextAlign.CENTER,ColorType.Yellowf7d253)}else a.type==SharedDef.MATCH_TYPE_LOCAL_SINGLE_PVP&&LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_name.skinName,"匹配赛",16,TextAlign.CENTER,ColorType.Yellowf7d253);var c=a.type==SharedDef.KUAFU_TYPE_GROUP_INSTANCE?"("+a.count+"/"+a.target+")":"...";LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_num.skinName,c,14,TextAlign.LEFT,ColorType.Yellowffecc6)},b.prototype.resize=function(){this.bg.top=0,this.bg.left=0,this.bg.y=0,this.bg.x=0,this.bg.height=Scene_data.stageHeight/UIData.Scale,this.bg.width=Scene_data.stageWidth/UIData.Scale,a.prototype.resize.call(this)},b.prototype.upTime=function(a){var b=Math.floor((TimeUtil.getTimer()-this.lasttime)/1e3);this._curtime!=b&&(this._curtime=b,LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_time.skinName,getScencdStr(this._curtime),16,TextAlign.LEFT,ColorType.Yellowffecc6)),this.hasStage||TimeUtil.removeFrameTick(this._frameFun)},b}(UIPanel);a.waitjoinPanel=b}(copytask||(copytask={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),copytask;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bigPic=new UIRenderOnlyPicComponent,b.addRender(b._bigPic),b._winmidRender=new UIRenderComponent,b.addRender(b._winmidRender),b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._topRender.dispose(),this._topRender=null,this._baseRender.dispose(),this._baseRender=null,this.treasureList&&(this.treasureList.dispose(),this.treasureList=null)},b.prototype.initUiAtlas=function(a,b,c){this._bigPic.uiAtlas=a,this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this._winmidRender=c,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.addChild(this._bigPic.getComponent("b_pic"));var b=this._winmidRender.getComponent("cnew_bg_yellow");this.setSizeForPanelUiCopy(b,"a_leftbg_yellow",this._baseRender);var c=this._winmidRender.getComponent("cnew_right_bg_top");this.setSizeForPanelUiCopy(c,"b_right_bg_top",this._baseRender);var d=this._winmidRender.getComponent("cnew_right_bg_bottom");this.setSizeForPanelUiCopy(d,"b_right_bg_bottom",this._baseRender),this._winmidRender.applyObjData(),this.bguiary=new Array,this.bguiary.push(b),this.bguiary.push(c),this.bguiary.push(d),this.a_listindex=this.addChild(a.getComponent("a_listindex")),this.b_info=this.addChild(a.getComponent("b_info")),this.b_neednum=this.addChild(a.getComponent("b_neednum")),this.b_recomforce=this.addChild(a.getComponent("b_recomforce")),this.b_taskname=this.addChild(a.getComponent("b_taskname")),this.b_vip_add=this.addChild(a.getComponent("b_vip_add")),this.b_buynum=this.addEvntBut("b_buynum",a),this.b_desc=this.addChild(a.getComponent("b_desc")),this.addUIList(["b_title","b_recomforcetxt","b_neednumtxt","b_bgleft","b_bg1","b_bg_center","b_bg2","b_bgright","b_btntxt"],a),this.addChild(this._topRender.getComponent("b_titletxt")),this.b_rewardtitle=this.addChild(this._topRender.getComponent("b_rewardtitle")),this.rewarduiary=new Array,this.rewardtxtuiary=new Array;for(var e=0;6>e;e++)this.rewarduiary.push(this._topRender.getComponent("b_reward"+e)),this.rewardtxtuiary.push(this._topRender.getComponent("b_rewardtxt"+e));this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg",a),this._publicRender.applyObjData()},b.prototype.resize=function(){a.prototype.resize.call(this),this.treasureList&&(this.treasureList.left=this.a_listindex.parent.x/UIData.Scale+this.a_listindex.x,this.treasureList.top=this.a_listindex.parent.y/UIData.Scale+this.a_listindex.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.treasureList||(this.treasureList=new c,this.treasureList.init(this._baseRender.uiAtlas)),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_vip_add.skinName,getvipadd("groupReward"),14,TextAlign.CENTER,ColorType.color9a683f),this.setUiListVisibleByItem(this.bguiary,!0),this.treasureList.show(),this.drawBuynum(),this.resize()},b.prototype.hide=function(){this.setUiListVisibleByItem(this.bguiary,!1),UIManager.getInstance().removeUIContainer(this),this.treasureList&&this.treasureList.hide()},b.prototype.resetData=function(a){this._itdata=a,this._bigPic.setImgUrl(getTeamcopyIconUrl(a.tabvo.map_pic)),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_taskname.skinName,a.tabvo.name,16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_neednum.skinName,a.tabvo.need_Num+"人",14,TextAlign.LEFT,ColorType.Green2ca937),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_recomforce.skinName,String(a.tabvo.recom_force),14,TextAlign.LEFT,GuidData.player.getForce()>=a.tabvo.recom_force?ColorType.Green2ca937:ColorType.colorcd2000);new Array;2==a.state?(this.b_desc.goToAndStop(0),this.b_rewardtitle.goToAndStop(1)):(this.b_desc.goToAndStop(1),this.b_rewardtitle.goToAndStop(0)),LabelTextFont.writeText(this._baseRender.uiAtlas,this.b_info.skinName,0,0,a.tabvo.info,14,ColorType.color9a683f,155,!0);for(var b=this.getrewardAry(a.state,a.tabvo),c=0;6>c;c++)c>=b.length?this.setUiListVisibleByItem([this.rewarduiary[c],this.rewardtxtuiary[c]],!1):(this.setUiListVisibleByItem([this.rewarduiary[c],this.rewardtxtuiary[c]],!0),IconManager.getInstance().drawItemIcon60(this.rewarduiary[c],b[c][0],b[c][1]),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.rewardtxtuiary[c].skinName,GameData.getPropName(b[c][0]),16,TextAlign.CENTER,ColorType.Brown7a2f21))},b.prototype.drawBuynum=function(){var a=tb.TB_group_instance_buy.getTempVo(1),b=this._baseRender.uiAtlas.getRec(this.b_buynum.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);
UiDraw.cxtDrawImg(c,PuiData.TXTBG,new Rectangle(0,0,b.pixelWitdh,b.pixelHeight),UIData.publicUi),UiDraw.cxtDrawImg(c,PuiData.BTNADD,new Rectangle(112,2,30,30),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(c,"挑战次数:"+GuidData.instanceData.getTeamCopyNum()+"/"+a.daily_reset,14,8,7,TextAlign.LEFT,ColorType.Brown7a2f21),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.getrewardAry=function(a,b){var c,d,e=new Array;2==a?(c=b.passRewardId,d=b.passRewardCnt):(c=b.fpRewardId,d=b.fpRewardCnt);for(var f=0;f<c.length;f++)e.push([c[f],d[f]]);return e},b.prototype.butClik=function(a){var b=this;switch(a.target){case this.cnew_btn1:this._itdata.state<3?GuidData.instanceData.getTeamCopyNum()>0||1==this._itdata.state?NetManager.getInstance().protocolos.group_instance_match(this._itdata.tabvo.id):AlertUtil.show("挑战次数不足，是否前往购买？","提示",function(a){1==a&&b.showbuypanel()},2,["前往购买","取消"]):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"未解锁",99);break;case this.b_buynum:this.showbuypanel()}},b.prototype.showbuypanel=function(){for(var a=tb.TB_group_instance_buy.getTempVo(1),b=new Array,c=GuidData.instanceData.getBuyTeamCopyNum();c<a.buy_type.length;c++)b.push([a.buy_type[c],a.buy_price[c]]);var d=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL);d.resoureItem=b,d.Info1="组队副本剩余可购买",d.cutNum=a.buy_price.length-GuidData.instanceData.getBuyTeamCopyNum(),d.cutNum>0?(d.SubmitFun=function(a){NetManager.getInstance().protocolos.buy_group_instance_times(a)},ModuleEventManager.dispatchEvent(d)):msgtip.MsgTipManager.outStrById(22,58)},b}(UIVirtualContainer);a.TeamcopyUiPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=47,a.top=83,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,223,435,0,81,5,256,1024,1,8,2)},c.prototype.refreshDataByNewData=function(){var b=this.getData(a.CopytaskModel.getInstance().getList());this.refreshData(b),this.setSelectIndex(0)},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.TeamCopyList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);var f=this._customRenderAry[0],g=this._customRenderAry[1];this.UnlockBg=this.creatGrid9SUI(f,this.parentTarget.baseAtlas,"UnlockBg",0,0,223,76,15,15),a.addChild(this.UnlockBg),this.Sname=this.creatSUI(g,this.parentTarget.baseAtlas,"Sname",71,15,100,20),a.addChild(this.Sname),this.Slev=this.creatSUI(d,this.parentTarget.baseAtlas,"Slev",176,17,40,18),a.addChild(this.Slev),this.Sselect=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"Sselect",0,0,223,76,15,15),a.addChild(this.Sselect),this.Sselect.addEventListener(InteractiveEvent.Up,this.equClick,this),this.Spass=this.creatSUI(d,this.parentTarget.baseAtlas,"Spass",163,44,45,18),a.addChild(this.Spass),this.Spic=this.creatSUI(d,this.parentTarget.baseAtlas,"Spic",0,2,220,72),a.addChild(this.Spic)},c.prototype.drawIcon=function(){var a=this,b=this.itdata.data;IconManager.getInstance().getIcon(getTeamcopyIconUrl(b.tabvo.map_pic+"_b"),function(b){var c=a._baseRender.uiAtlas.getRec(a.Spic.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(b,0,0,b.width,b.height,3,1,c.pixelWitdh,c.pixelHeight),a._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.applyrender(),b){var c=new a.CopytaskUiEvent(a.CopytaskUiEvent.SELECT_ITEM_EVENT);c.data=this.itdata,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;if(this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sselect.skinName,UIData.publicUi,PuiData.Slist_select):UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sselect.skinName,UIData.publicUi,PuiData.Slist_nselect),this.drawIcon(),3==a.state)LabelTextFont.writeSingleLabel(this.uiAtlas,this.Sname.skinName,a.tabvo.limLev+"级解锁",16,TextAlign.RIGHT,ColorType.Yellowffecc6),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.UnlockBg.skinName,UIData.publicUi,PuiData.MASK),LabelTextFont.clearLabel(this.uiAtlas,this.Slev.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Spass.skinName);else{LabelTextFont.writeSingleLabel(this.uiAtlas,this.Sname.skinName,a.tabvo.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.clearLabel(this.uiAtlas,this.UnlockBg.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Slev.skinName,a.tabvo.limLev+"级",14,TextAlign.LEFT,ColorType.Brown7a2f21);var b="已通关",c=ColorType.Green2ca937;1==a.state&&(b="未通关",c=ColorType.colorcd2000),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Spass.skinName,b,14,TextAlign.RIGHT,c)}}},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.equClick=function(a){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;this.setSelect()}},c.prototype.setnull=function(){UiDraw.clearUI(this.UnlockBg),UiDraw.clearUI(this.Sname),UiDraw.clearUI(this.Slev),UiDraw.clearUI(this.Spass),UiDraw.clearUI(this.Sselect),UiDraw.clearUI(this.Spic)},c}(SListItem);a.TeamCopyListRender=d}(copytask||(copytask={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),copytask;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._curDataID=-1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._winMidRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._btnRender=new UIRenderComponent,this._btnRender.uiAtlas=WindowUi.winUIAtlas,this.addRender(this._btnRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this.initUI(),this.addSelfRole()},b.prototype.initUI=function(){this.initBg(),this.addUIList(["t_bg1","t_bg2","t_title1","t_title2"],this._bgRender),this.t_vip_add=this.addChild(this._baseRender.getComponent("t_vip_add"));var a;a=this.addChild(this._baseRender.getComponent("t_lab1")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"通关奖励",14,TextAlign.CENTER,ColorType.colorb96d49),a=this.addChild(this._baseRender.getComponent("t_lab2")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"几率获得",14,TextAlign.CENTER,ColorType.colorb96d49),a=this.addChild(this._baseRender.getComponent("t_vip_lab")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"VIP特权可扫荡",14,TextAlign.CENTER,ColorType.color9a683f),this.btnname_sweep=this._baseRender.getComponent("t_lab3"),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.btnname_sweep.skinName,"扫荡",16,TextAlign.CENTER,ColorType.Brown7a2f21),a=this.addChild(this._baseRender.getComponent("t_lab4")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"开始挑战",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.btn_sweep=this._btnRender.getComponent("cnew_btn1"),this.setSizeForPanelUiCopy(this.btn_sweep,"t_btn1",this._bgRender),this.btn_sweep.addEventListener(InteractiveEvent.Up,this.sweep,this),a=this.addChild(this._btnRender.getComponent("cnew_btn1")),this.setSizeForPanelUiCopy(a,"t_btn2",this._bgRender),a.addEventListener(InteractiveEvent.Up,this.enter,this),this.bossName=this.addChild(this._baseRender.getComponent("t_name_lab")),this.rewardIcon=this.addChild(this._baseRender.getComponent("t_reward")),this.iconAry=new Array;for(var b=0;2>b;b++)this.iconAry.push(this.addChild(this._baseRender.getComponent("t_icon"+b)))},b.prototype.visiableBtn=function(){this.setUiListVisibleByItem([this.btn_sweep,this.btnname_sweep],GuidData.player.getIsVIP())},b.prototype.initBg=function(){this._bgAry=new Array,this._bgAry.push(this.addByCopy("cnew_bg_yellow","t_list_bg")),this._bgAry.push(this.addByCopy("cnew_right_bg_top","t_win_bg1")),this._bgAry.push(this.addByCopy("cnew_right_bg_bottom","t_win_bg2"))},b.prototype.addByCopy=function(a,b){var c=this._winMidRender.getComponent(a);return this.setSizeForPanelUiCopy(c,b,this._bgRender),c},b.prototype.draw=function(a){if(this._curDataID!=a.data.id){this._curDataID=a.data.id,this._curData=a,IconManager.getInstance().drawItemIcon60(this.rewardIcon,a.data.basereward[0][0],1);for(var b=0;b<this.iconAry.length;b++)IconManager.getInstance().drawItemIcon60(this.iconAry[b],a.data.randomreward[b][0],1);var c=TableData.getInstance().getData(TableData.tb_creature_template,a.data.boss);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.bossName.skinName,c.name,16,TextAlign.CENTER,ColorType.Brown7a2f21),this.selfRole.setAvatar(c.avatar)}},b.prototype.sweep=function(a){UiTweenScale.getInstance().changeButSize(a.target),this._curData.passed>0&&this._curData.num<this._curData.maxtime&&GuidData.player.getVipLevel()>0?NetManager.getInstance().protocolos.res_instance_sweep(this._curData.data.id):GuidData.player.getVipLevel()<=0?msgtip.MsgTipManager.outStr("vip才可扫荡",99):this._curData.num>=this._curData.maxtime?msgtip.MsgTipManager.outStr("副本次数已用完",99):msgtip.MsgTipManager.outStr("请先挑战通关",99)},b.prototype.enter=function(a){if(UIManager.popClikNameFun(a.target.name),UiTweenScale.getInstance().changeButSize(a.target),this._curData.data.limLev<=GuidData.player.getLevel()){if(this._curData.num>=this._curData.maxtime)return void msgtip.MsgTipManager.outStr("副本次数已用完",99);NetManager.getInstance().protocolos.res_instance_enter(this._curData.data.id)}else msgtip.MsgTipManager.outStr("副本需"+this._curData.data.limLev+"级解锁",99)},b.prototype.addSelfRole=function(){this.selfRole=new MonsterUIChar,this._bgRender.addModel(this.selfRole),this.resize()},b.prototype.refreshRes=function(){this._slist&&this._slist.reget()},b.prototype.showList=function(){this._slist||(this._slist=new c,this._slist.init(this._baseUiAtlas,this)),this._slist.show()},b.prototype.resize=function(){a.prototype.resize.call(this),this.selfRole&&(this.selfRole.resize(),this.selfRole.scale=3*UIData.Scale,this.selfRole.x=-20*UIData.Scale,this.selfRole.y=-100*UIData.Scale)},b.prototype.addWinmid=function(){for(var a=0;a<this._bgAry.length;a++)this.addChild(this._bgAry[a])},b.prototype.removeWinmid=function(){for(var a=0;a<this._bgAry.length;a++)this.removeChild(this._bgAry[a])},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.visiableBtn(),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.t_vip_add.skinName,getvipadd("resReward"),14,TextAlign.CENTER,ColorType.color9a683f),this._baseUiAtlas&&(this.addWinmid(),this.showList())},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.removeWinmid(),this._slist.hide()},b}(UIConatiner);a.ResCopyTaskPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a,b){this._panel=b,this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=this.getDataAry(),b=312,c=434;this.setData(a,d,b,c,310,80,5,512,512,1,6,2),this.center=-280,this.middle=40,this.setShowLevel(4),this.setSelectIndex(0),this._panel.draw(a[0].data),this.resize()},b.prototype.setSelect=function(b){b.itdata&&b.itdata.data&&(a.prototype.setSelect.call(this,b),this._panel.draw(b.itdata.data))},b.prototype.reget=function(){this.refreshData(this.getDataAry())},b.prototype.getDataAry=function(){for(var a=fb.FuBenModel.getInstance().getFubenResItem(),b=new Array,c=RedPointManager.getInstance().getNodeByID(122).children,d=0;d<a.length;d++){c[d].data=a[d],a[d].node=c[d];var e=new SListItemData;e.data=a[d],e.id=d,b.push(e)}return b},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.reget()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.ResCopyList=c;var d=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._curDataID=-1,b._vipTime=-1,b}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e);var f=e[0],g=e[1];this._ibg=this.creatGrid9SUI(d,this.parentTarget.baseAtlas,"sa_bg",2,2,303,78,10,10),b.addChild(this._ibg),this._ibg.addEventListener(InteractiveEvent.Down,this.onclick,this),this._name=this.creatSUI(f,this.parentTarget.baseAtlas,"sa_lab1",72,15,120,20),b.addChild(this._name),this._lev=this.creatSUI(f,this.parentTarget.baseAtlas,"sa_lab2",192,15,120,20),b.addChild(this._lev),this._numlab=this.creatSUI(f,this.parentTarget.baseAtlas,"sa_lab3",131,43,120,22),b.addChild(this._numlab),this._img=this.creatSUI(f,this.parentTarget.baseAtlas,"sa_img",3,3,107,74),b.addChild(this._img),this._topImg=this.creatSUI(f,this.parentTarget.baseAtlas,"sa_top",0,0,61,60),b.addChild(this._topImg),this.Redpoint=this.creatSUI(g,this.parentTarget.baseAtlas,"sa_redpoint",286,1,17,16),this.Redpoint.preParent=b,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Redpoint.skinName,UIData.publicUi,PuiData.A_RED_POINT)},b.prototype.onclick=function(a){UIManager.popClikNameFun("sa_bg"),this.parentTarget.setSelect(this)},Object.defineProperty(b.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected!=a&&(this._selected=a,this.drawSel())},enumerable:!0,configurable:!0}),b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():this.setnull()},b.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this._name.skinName),this.uiAtlas.clearCtxTextureBySkilname(this._lev.skinName),this.uiAtlas.clearCtxTextureBySkilname(this._numlab.skinName),this.uiAtlas.clearCtxTextureBySkilname(this._ibg.skinName),this.uiAtlas.clearCtxTextureBySkilname(this._img.skinName),this.uiAtlas.clearCtxTextureBySkilname(this._topImg.skinName),this.Redpoint.preHide()},b.prototype.drawSel=function(){this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.Slist_select):UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.Slist_nselect)},b.prototype.applyRender=function(){var a=this.itdata.data;a.node&&a.node.bindUI(this.Redpoint),this.drawSel(),this._curDataID!=a.data.id&&LabelTextFont.writeSingleLabel(this.uiAtlas,this._name.skinName,a.data.name,16,TextAlign.LEFT,ColorType.Brown7a2f21);var b=ColorType.color9a683f+"需要等级："+(GuidData.player.getLevel()<a.data.limLev?ColorType.colorcd2000:ColorType.Green2ca937)+a.data.limLev;LabelTextFont.writeSingleLabel(this.uiAtlas,this._lev.skinName,b,14,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this._numlab.skinName,ColorType.color9a683f+"今日次数："+ColorType.Green2ca937+(a.maxtime-a.num)+"/"+a.maxtime,18,TextAlign.CENTER,ColorType.Brown7a2f21),this._vipTime!=a.vipAddTime&&(this._vipTime=a.vipAddTime),this._curDataID!=a.data.id&&(this.uiAtlas.upDataPicToTexture("ui/load/rescopy/"+a.data.id+".png",this._img.skinName),this.uiAtlas.upDataPicToTexture("ui/load/rescopy/t"+a.data.id+".png",this._topImg.skinName)),this._curDataID=a.data.id},b}(SListItem);a.ResCopyListItemRender=d}(copytask||(copytask={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),copytask;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._uvScaleAry=[.1,.3,.5,.7,.9,1],b._drawPage=-1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._winMidRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._btnRender=new UIRenderComponent,this._btnRender.uiAtlas=WindowUi.winUIAtlas,this.addRender(this._btnRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this._middleRender=new UIRenderComponent,this._middleRender.uiAtlas=a,this.addRender(this._middleRender),this._topRender=new UIRenderComponent,this._topRender.uiAtlas=a,this.addRender(this._topRender),this.initUI(),this.addSelfRole()},b.prototype.initUI=function(){this._bgAry=new Array,this._titleAry=new Array,this._rewardAry=new Array,this._iconAry=new Array,this.stateAry=new Array,this._mapAry=new Array;for(var a=0;5>a;a++){this._bgAry.push(this.addByCopy("cnew_right_bg_top","e_bga"+a)),this._bgAry.push(this.addByCopy("cnew_right_bg_bottom","e_bgb"+a));var b;this.addChild(this._bgRender.getComponent("e_t_bg"+a)),this.addChild(this._bgRender.getComponent("e_boss_bg"+a)),b=this.addChild(this._baseRender.getComponent("e_title"+a)),this._titleAry.push(b),b=this.addChild(this._baseRender.getComponent("e_r"+a)),this._rewardAry.push(b),b=this.addChild(this._baseRender.getComponent("e_line"+a));var c=this.addChild(this._baseRender.getComponent("e_a"+a)),d=this.addChild(this._baseRender.getComponent("e_b"+a));this._iconAry.push([c,d]);var e=this._topRender.getComponent("e_s"+a);this.addChild(e),e.goToAndStop(2),this.stateAry.push(e),this._mapAry.push(this.addChild(this._topRender.getComponent("e_t"+a)))}this._leftBtn=this._topRender.getComponent("e_left"),this._leftBtn.addEventListener(InteractiveEvent.Down,this.perPage,this),this._rightBtn=this._topRender.getComponent("e_right"),this._rightBtn.addEventListener(InteractiveEvent.Down,this.nextPage,this),this.addUIList(["e_bg_line","e_info_bg1"],this._bgRender),this._sweepLabBg=this._bgRender.getComponent("e_info_bg2");var b;b=this.addChild(this._bgRender.getComponent("e_rank")),b.addEventListener(InteractiveEvent.Down,this.getRank,this),b=this.addChild(this._baseRender.getComponent("e_line_bg")),this.progresUI=this.addChild(this._middleRender.getComponent("e_line_base")),this.progresUI.uvScale=.5,this._sweepBtn=this._btnRender.getComponent("cnew_btn1"),this.setSizeForPanelUiCopy(this._sweepBtn,"e_btnbg1",this._bgRender),this._sweepBtn.addEventListener(InteractiveEvent.Up,this.sweep,this),b=this.addChild(this._btnRender.getComponent("cnew_btn1")),this.setSizeForPanelUiCopy(b,"e_btnbg2",this._bgRender),b.addEventListener(InteractiveEvent.Down,this.btnclick,this),this._sweepBtnLab=this._topRender.getComponent("e_btn0"),this._maxLab=this.addChild(this._topRender.getComponent("e_info0")),this._sweepLab=this._topRender.getComponent("e_info1"),this.d_vip_add=this.addChild(this._topRender.getComponent("d_vip_add")),b=this.addChild(this._topRender.getComponent("e_btn1")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,"开始挑战",16,TextAlign.CENTER,ColorType.Brown7a2f21)},b.prototype.visiableBtn=function(){this.setUiListVisibleByItem([this._sweepBtn,this._sweepBtnLab,this._sweepLab,this._sweepLabBg],this.sweepCurrent>0)},b.prototype.getRank=function(a){NetManager.getInstance().protocolos.rank_list_query(SharedDef.RANK_TYPE_TRIAL,SharedDef.RANK_TYPE_TRIAL,1,10)},b.prototype.sweep=function(a){if(1==this.sweepNum)NetManager.getInstance().protocolos.sweep_trial_instance();else if(1==this.canBuyNum){var b=TableData.getInstance().getData(TableData.tb_instance_trial,this.trialCurrent);AlertUtil.show(ColorType.Brown7a2f21+"您是否花费"+ColorType.Green2ca937+b.resetCosts[0][1]+"元宝"+ColorType.Brown7a2f21+"重置扫荡","",function(a){1==a&&NetManager.getInstance().protocolos.reset_trial_instance()})}},b.prototype.btnclick=function(a){NetManager.getInstance().protocolos.enter_trial_instance()},b.prototype.setTowerPage=function(){this.setBaseData(),this.draw(),this.drawBase()},b.prototype.setBaseData=function(){var a=GuidData.instanceData.getInstanceIntFieldTrialPassed();this.sweepCurrent=a[0],this.trialCurrent=a[1];var a=GuidData.instanceData.getInstanceIntFieldTrialSweep();this.sweepNum=a[0],this.canBuyNum=a[1],this._maxPage=Math.floor(this.trialCurrent/5),this._curPage=this._maxPage},b.prototype.refreshSweep=function(){this.setBaseData(),this.drawBase()},b.prototype.perPage=function(a){0!=this._curPage&&(this._curPage--,this.draw())},b.prototype.nextPage=function(a){this._curPage!=this._maxPage&&(this._curPage++,this.draw())},b.prototype.drawBase=function(){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._maxLab.skinName,ColorType.Brown7a2f21+"已通关"+ColorType.Green2ca937+this.trialCurrent+ColorType.Brown7a2f21+"层",16,TextAlign.CENTER),this.sweepCurrent>0?LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._sweepLab.skinName,ColorType.Brown7a2f21+"可扫荡："+ColorType.Green2ca937+"1-"+this.sweepCurrent+ColorType.Brown7a2f21+"层",16,TextAlign.CENTER):LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._sweepLab.skinName,"不可扫荡",16,TextAlign.CENTER,ColorType.Brown7a2f21),1==this.sweepNum?LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._sweepBtnLab.skinName,"一键扫荡",16,TextAlign.CENTER,ColorType.Brown7a2f21):LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._sweepBtnLab.skinName,"重置扫荡",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.visiableBtn()},b.prototype.removeSweep=function(){this.removeChild(this._sweepBtn),this.removeChild(this._sweepBtnLab),this.removeChild(this._sweepLab),this.removeChild(this._sweepLabBg)},b.prototype.addSweep=function(){this._sweepBtn.parent||(this.addChild(this._sweepBtn),this.addChild(this._sweepBtnLab),this.addChild(this._sweepLab),this.addChild(this._sweepLabBg))},b.prototype.draw=function(){for(var a=-1,b=0;5>b;b++){var c=5*this._curPage+b,d=TableData.getInstance().getData(TableData.tb_instance_trial,c+1);this.applyCellView(b,d,c<this.trialCurrent,c<this.sweepCurrent,0==this.sweepNum),c<this.trialCurrent?this.stateAry[b].goToAndStop(2):c==this.trialCurrent?(this.stateAry[b].goToAndStop(0),a=b):this.stateAry[b].goToAndStop(1)}-1==a&&(a=5),this.progresUI.uvScale=this._uvScaleAry[a],0==this._curPage?this.removeChild(this._leftBtn):this.addChild(this._leftBtn),this._curPage==this._maxPage?this.removeChild(this._rightBtn):this.addChild(this._rightBtn)},b.prototype.applyCellView=function(a,b,c,d,e){var f;f=c?d?e?ColorType.colorcd2000+"已扫荡":ColorType.Green2ca937+"可扫荡":ColorType.colorcd2000+"明日可扫荡":ColorType.Brown7a2f21+"推荐战力："+(b.force>GuidData.player.getForce()?ColorType.colorcd2000:ColorType.colorff7200)+Snum(b.force),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._titleAry[a].skinName,f,14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._mapAry[a].skinName,"第"+b.id+"关",14,TextAlign.CENTER,ColorType.Brown7a2f21);var g;c?(f="每日奖励",g=b.showreward):(f="首通奖励",g=b.firstReward),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._rewardAry[a].skinName,f,14,TextAlign.CENTER,ColorType.color9a683f);for(var h=0;2>h;h++)g[h]?IconManager.getInstance().drawItemIcon40(this._iconAry[a][h],g[h][0],g[h][1]):IconManager.getInstance().drawItemIcon40(this._iconAry[a][h],0,1);this._roleList[a].setAvatar(getAvataByID(b.model))},b.prototype.addByCopy=function(a,b){var c=this._winMidRender.getComponent(a);return this.setSizeForPanelUiCopy(c,b,this._bgRender),c},b.prototype.addSelfRole=function(){this._roleList=new Array;for(var a=0;5>a;a++){var b=new MonsterUIChar;this._bgRender.addModel(b),this._roleList.push(b)}this.resize()},b.prototype.resize=function(){if(a.prototype.resize.call(this),this._roleList)for(var b=0;b<this._roleList.length;b++){var c=this._roleList[b];c.scale=1.5*UIData.Scale,c.x=(230-105*b)*UIData.Scale,c.y=-20*UIData.Scale,c.resize()}},b.prototype.addWinmid=function(){for(var a=0;a<this._bgAry.length;a++)this.addChild(this._bgAry[a])},b.prototype.removeWinmid=function(){for(var a=0;a<this._bgAry.length;a++)this.removeChild(this._bgAry[a])},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.d_vip_add.skinName,getvipadd("trialReward"),14,TextAlign.CENTER,ColorType.color9a683f),this._baseUiAtlas&&(this.setTowerPage(),this.addWinmid())},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.removeWinmid()},b}(UIConatiner);a.TowerCopyTaskPanel=b}(copytask||(copytask={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),copytask;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._publicbguiRender=new UIRenderComponent,a.addRender(a._publicbguiRender),a._roleRender=new UIRenderComponent,a.addRender(a._roleRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._roleRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._roleRender.dispose(),this._roleRender=null,this.teamcopyUiPanel&&(this.teamcopyUiPanel.dispose(),this.teamcopyUiPanel=null),this.resCopyTaskPanel&&(this.resCopyTaskPanel.dispose(),this.resCopyTaskPanel=null),this.towerCopyTaskPanel&&(this.towerCopyTaskPanel.dispose(),this.towerCopyTaskPanel=null),this._redPointRender.dispose(),this._redPointRender=null,b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicbguiRender.uiAtlas=WindowUi.winUIAtlas,this._roleRender.uiAtlas.setInfo("ui/uidata/copytask/copytask.xml","ui/uidata/copytask/copytask.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._roleRender.uiAtlas,this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this.initData(),this.resize(),this.applyLoadComplete()},c.prototype.initData=function(){this.addChild(this._bgRender.getComponent("a_title"));var a=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(a,"rightLinebg",this._roleRender),this.TabAry=new Array;for(var b=0;3>b;b++){var c=this.addEvntBut("a_tab"+b,this._roleRender);c.data=SharedDef.MODULE_INSTANCE_RES+b,c.addEventListener(InteractiveEvent.Up,this.click,this),this.TabAry.push(c)}this.UnlockUIAry=new Array,this.t_unlock0=this.addEvntBut("t_unlock0",this._bgRender),this.UnlockUIAry.push(this.t_unlock0),this.t_unlock1=this.addEvntBut("t_unlock1",this._bgRender),this.UnlockUIAry.push(this.t_unlock1),this.t_unlock2=this.addEvntBut("t_unlock2",this._bgRender),this.UnlockUIAry.push(this.t_unlock2),this.addChild(this._roleRender.getComponent("a_line")),this.redui=this._redPointRender.getRedPointUI(this,121,new Vector2D(this.TabAry[0].x+this.TabAry[0].width-5,this.TabAry[0].y))},c.prototype.selecttype=function(a){for(var b=0;b<this.TabAry.length;b++)this.TabAry[b].data==a?this.TabAry[b].selected=!0:this.TabAry[b].selected=!1;a==SharedDef.MODULE_INSTANCE_RES?this.showTab0pnael():a==SharedDef.MODULE_INSTANCE_TEAM?this.showTab1pnael():this.showTab2pnael()},c.prototype.click=function(a){UIManager.popClikNameFun(a.target.name),this.selecttype(a.target.data)},c.prototype.showTab0pnael=function(){this.teamcopyUiPanel&&this.teamcopyUiPanel.hide(),this.towerCopyTaskPanel&&this.towerCopyTaskPanel.hide(),this.resCopyTaskPanel||(this.resCopyTaskPanel=new a.ResCopyTaskPanel,this.resCopyTaskPanel.setUIAtlas(this._roleRender.uiAtlas,this.winmidRender)),this.resCopyTaskPanel.show()},c.prototype.showTab1pnael=function(){this.resCopyTaskPanel&&this.resCopyTaskPanel.hide(),this.towerCopyTaskPanel&&this.towerCopyTaskPanel.hide(),this.teamcopyUiPanel||(this.teamcopyUiPanel=new a.TeamcopyUiPanel,this.teamcopyUiPanel.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas,this.winmidRender)),this.teamcopyUiPanel.show()},c.prototype.showTab2pnael=function(){this.teamcopyUiPanel&&this.teamcopyUiPanel.hide(),this.resCopyTaskPanel&&this.resCopyTaskPanel.hide(),this.towerCopyTaskPanel||(this.towerCopyTaskPanel=new a.TowerCopyTaskPanel,this.towerCopyTaskPanel.setUIAtlas(this._roleRender.uiAtlas,this.winmidRender)),this.towerCopyTaskPanel.show()},c.prototype.hidealltab=function(){this.teamcopyUiPanel&&this.teamcopyUiPanel.hide(),this.resCopyTaskPanel&&this.resCopyTaskPanel.hide(),this.towerCopyTaskPanel&&this.towerCopyTaskPanel.hide()},c.prototype.refreshRes=function(){this.resCopyTaskPanel&&this.resCopyTaskPanel.hasStage&&this.resCopyTaskPanel.refreshRes()},c.prototype.refreshTower=function(){this.towerCopyTaskPanel&&this.towerCopyTaskPanel.hasStage&&this.towerCopyTaskPanel.refreshSweep()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.sysopen=function(){for(var a=0;a<this.TabAry.length;a++)(this.TabAry[a].parent||this.UnlockUIAry[a].parent)&&this.refreshOpenLev(this.TabAry[a],this.UnlockUIAry[a]),0==a&&(this.TabAry[a].parent?(this.redui.y=this.TabAry[a].y,this.redui.node.bindUI(this.redui)):this.redui.node.unBind())},c.prototype.refreshOpenLev=function(a,b){var c=a.data;if(GuidData.player.getsyspageopen(SharedDef.MODULE_INSTANCE,c))this.setUiListVisibleByItem([a],!0),this.setUiListVisibleByItem([b],!1);else{var d=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_INSTANCE+c));this.setUiListVisibleByItem([a],!1),this.setUiListVisibleByItem([b],!0),b.data=d}},c.prototype.getTabidx=function(a,b){return a.indexOf(b)},c.prototype.show=function(a,b){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]);for(var c=0;c<this.TabAry.length;c++){var d=this.getTabidx(a,Number(this.TabAry[c].data));-1!=d?(this.refreshOpenLev(this.TabAry[c],this.UnlockUIAry[c]),this.UnlockUIAry[c].y=this.TabAry[c].y=94*d+97):(this.setUiListVisibleByItem([this.TabAry[c]],!1),this.setUiListVisibleByItem([this.UnlockUIAry[c]],!1)),0==c&&(this.TabAry[c].parent?(this.redui.y=this.TabAry[c].y,this.redui.node.bindUI(this.redui)):this.redui.node.unBind())}this.selecttype(b),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.hidealltab(),ModulePageManager.hideResTittle()},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.CopytaskUiEvent(a.CopytaskUiEvent.HIDE_COPYTASK_EVENT));break;case this.t_unlock0:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock0.data.level+"级后解锁",99);break;case this.t_unlock1:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock1.data.level+"级后解锁",99);break;case this.t_unlock2:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock2.data.level+"级后解锁",99)}},c}(WindowUi);a.CopytaskUiPanel=b}(copytask||(copytask={}));var copytask;!function(a){var b=function(){function a(){}return a}();a.TeamCopyItemVo=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getList=function(){for(var a=GuidData.player.getteamflag(),c=new Array,d=tb.TB_group_instance_base.getItem(),e=0;e<d.length;e++){var f=new b;d[e].limLev>GuidData.player.getLevel()?f.state=3:a[d[e].id]?f.state=2:f.state=1,f.tabvo=d[e],c.push(f)}return console.log("--$finalary--",c),c},a}();a.CopytaskModel=c}(copytask||(copytask={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){
for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),copytask;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"CopytaskUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.CopytaskUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_COPYTASK_EVENT="SHOW_COPYTASK_EVENT",b.HIDE_COPYTASK_EVENT="HIDE_COPYTASK_EVENT",b.SELECT_ITEM_EVENT="SELECT_ITEM_EVENT",b.UNLOCK_WEAPON_EVENT="UNLOCK_WEAPON_EVENT",b.CHANGE_WEAPON_EVENT="CHANGE_WEAPON_EVENT",b.CHANGE_FIRST_EVENT="CHANGE_FIRST_EVENT",b.SHOW_WAITJOIN_PANEL="SHOW_WAITJOIN_PANEL",b.RES_FUBEN_REFRESH="RES_FUBEN_REFRESH",b.TOWER_FUBEN_SWEEP="TOWER_FUBEN_SWEEP",b.SHOW_TOWER_RANK="SHOW_TOWER_RANK",b.CHG_TEAM_NUM="CHG_TEAM_NUM",b}(BaseEvent);a.CopytaskUiEvent=c;var d=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a._nodeInit=!1,a}return __extends(d,b),d.prototype.getName=function(){return"TreasureProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_COPYTASK_EVENT?this.showUi(b.data,b.seltab):b.type==c.HIDE_COPYTASK_EVENT?this.hideUi():b.type==c.SELECT_ITEM_EVENT?this.selectitem(b.data):b.type==c.UNLOCK_WEAPON_EVENT||b.type==c.CHANGE_WEAPON_EVENT||(b.type==c.CHANGE_FIRST_EVENT?this.changezhanli():b.type==c.SHOW_WAITJOIN_PANEL?this.showwaitjoinPanel(b.data):b.type==c.RES_FUBEN_REFRESH?(this.refreshRes(),this.processRedPoint()):b.type==c.TOWER_FUBEN_SWEEP?this.refreshTower():b.type==c.SHOW_TOWER_RANK?this.showRank(b.data):b.type==c.CHG_TEAM_NUM&&this.refreshTeamNum())}if(a instanceof UIPanelEvent){var d=a;if(d.panel==this._copytaskUiPanel){for(var e=RedPointManager.getInstance().getNodeByID(122).children,f=0;f<e.length;f++)e[f].unBind();this._copytaskUiPanel.dispose(),this._copytaskUiPanel=null,console.log("释放面板 _copytaskUiPanel")}d.panel==this._waitjoinPanel&&(this._waitjoinPanel.dispose(),this._waitjoinPanel=null,console.log("释放面板 _waitjoinPanel"))}a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT?this.initRedNode():a.type==EngineEvent.SYSTEM_OPEN_EVENT?(this._copytaskUiPanel&&this._copytaskUiPanel.hasStage&&this._copytaskUiPanel.sysopen(),this.processRedPoint()):a.type==EngineEvent.PLAYER_FIELD_LEVEL?this.processRedPoint():a.type==EngineEvent.PLAYER_FIELD_VIP_LEVEL&&this._copytaskUiPanel&&this._copytaskUiPanel.resCopyTaskPanel&&this._copytaskUiPanel.resCopyTaskPanel.hasStage&&this._copytaskUiPanel.resCopyTaskPanel.visiableBtn()},d.prototype.initRedNode=function(){if(!this._nodeInit){for(var a=RedPointManager.getInstance().getNodeByID(122),b=fb.FuBenModel.getInstance().getFubenResItem(),c=0;c<b.length;c++){var d=new RedPointNode;d.data=b[c],a.addChild(d)}this._nodeInit=!0,this.processRedPoint()}},d.prototype.processRedPoint=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_INSTANCE,SharedDef.MODULE_INSTANCE_RES))for(var a=fb.FuBenModel.getInstance().getFubenResItem(),b=RedPointManager.getInstance().getNodeByID(122).children,c=0;c<b.length;c++){b[c].data=a[c];var d=a[c];b[c].show=d.num<d.maxtime&&d.data.limLev<=GuidData.player.getLevel()}},d.prototype.refreshTeamNum=function(){this._copytaskUiPanel&&this._copytaskUiPanel.teamcopyUiPanel&&this._copytaskUiPanel.teamcopyUiPanel.hasStage&&this._copytaskUiPanel.teamcopyUiPanel.drawBuynum()},d.prototype.changezhanli=function(){this._copytaskUiPanel&&this._copytaskUiPanel.hasStage},d.prototype.refreshRes=function(){this._copytaskUiPanel&&this._copytaskUiPanel.hasStage&&this._copytaskUiPanel.refreshRes()},d.prototype.refreshTower=function(){this._copytaskUiPanel&&this._copytaskUiPanel.hasStage&&this._copytaskUiPanel.refreshTower()},d.prototype.showRank=function(a){var b=this;this._rankPanle||(this._rankPanle=new WindowRankPanel);for(var c=new Array,d=0;d<a.list.length;d++){var e=a.list[d],f=new WindowRankVo,g=e.GetStr(SharedDef.RANK_LIST_CURRENT_OBJ_STR_FIELD_PLAYER_NAME);g&&(f.rank=String(e.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_RANKING)),f.val=String(e.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_TRIAL)),f.name=getBaseName(g),c.push(f))}var h;h=a.self>0?"我的排名："+a.self:"我的排名：未上榜",this._rankPanle.load(function(){b._rankPanle.show(["排名","玩家名字","关卡"],c,h)})},d.prototype.selectitem=function(a){this._copytaskUiPanel&&this._copytaskUiPanel.teamcopyUiPanel&&this._copytaskUiPanel.teamcopyUiPanel.resetData(a.data)},d.prototype.hideUi=function(){this._copytaskUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(b,c){var d=this;this._copytaskUiPanel||(this._copytaskUiPanel=new a.CopytaskUiPanel),this._copytaskUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b?b instanceof Array||(b=[b]):b=[2,3,4],c?c instanceof Array&&(c=c[0]):c=b[0],d._copytaskUiPanel.show(b,c);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_INSTANCE,ModuleEventManager.dispatchEvent(a)})},d.prototype.showwaitjoinPanel=function(b){var c=this;this._waitjoinPanel||(this._waitjoinPanel=new a.waitjoinPanel),this._waitjoinPanel.load(function(){c._waitjoinPanel.show(b)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_COPYTASK_EVENT),new c(c.HIDE_COPYTASK_EVENT),new c(c.SELECT_ITEM_EVENT),new c(c.UNLOCK_WEAPON_EVENT),new c(c.CHANGE_WEAPON_EVENT),new c(c.CHANGE_FIRST_EVENT),new c(c.RES_FUBEN_REFRESH),new c(c.TOWER_FUBEN_SWEEP),new c(c.SHOW_TOWER_RANK),new c(c.CHG_TEAM_NUM),new c(c.SHOW_WAITJOIN_PANEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new EngineEvent(EngineEvent.PLAYER_FIELD_VIP_LEVEL),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL)]},d}(BaseProcessor);a.CopytaskProcessor=d}(copytask||(copytask={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),treasure;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._canclick=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this.treasureList&&(this.treasureList.dispose(),this.treasureList=null)},b.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.a_listindex=this.addChild(this._baseRender.getComponent("a_listindex")),this.b_zhanli=this.addChild(this._topRender.getComponent("b_zhanli")),this.addChild(this._topRender.getComponent("a_zhanli_txt")),this.addChild(a.getComponent("b_numberBg")),this.b_currentname=this.addChild(a.getComponent("b_currentname")),this.addUIList(["b_line1_1","b_line1_2","b_titleBg"],a),this.b_skillicon=this.addChild(a.getComponent("b_skillicon")),this.b_skillname=this.addChild(a.getComponent("b_skillname")),this.b_skillinfo=this.addChild(a.getComponent("b_skillinfo")),this.btnuiary=new Array;var b=a.getComponent("b_btntxt");this.btnuiary.push(b);var c=this._publicRender.getComponent("cnew_btn1");this.setSizeForPanelUiCopy(c,"btnBg",a),c.addEventListener(InteractiveEvent.Up,this.butClik,this),this.btnuiary.push(c),this.btnuiary.push(a.getComponent("c_item0")),this.btnuiary.push(a.getComponent("c_item1")),this.btnuiary.push(a.getComponent("c_itemnum0")),this.btnuiary.push(a.getComponent("c_itemnum1")),this._btnRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(c.x+c.width,c.y)),this.Okuiary=new Array,this.Okuiary.push(a.getComponent("b_infotxt")),this.attribute_cur_ary=new Array,this.attribute_next_ary=new Array,this.attribute_lev_ary=new Array;for(var d=0;7>d;d++)this.attribute_cur_ary.push(this._topRender.getComponent("c_attribute_c"+d)),this.attribute_next_ary.push(this._topRender.getComponent("c_attribute_n"+d));this.attribute_lev_ary.push(this._topRender.getComponent("c_lev")),this.attribute_lev_ary.push(this._topRender.getComponent("c_curlevtxt"))},b.prototype.resize=function(){a.prototype.resize.call(this),this.treasureList&&(this.treasureList.left=this.a_listindex.parent.x/UIData.Scale+this.a_listindex.x,this.treasureList.top=this.a_listindex.parent.y/UIData.Scale+this.a_listindex.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.treasureList||(this.treasureList=new c,this.treasureList.init(this._baseRender.uiAtlas)),this.treasureList.show(),this.resize()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.treasureList&&this.treasureList.hide()},b.prototype.resetData=function(a){console.log("-$data--",a),this._itdata=a;var b=this.parent;b.setAvatar(Number(a.tabvo.model),a.tabvo.name,6),this.drawIcon(this.b_currentname,"ui/load/treasure/"+a.tabvo.icon+".png");var c,d,e=this.btnuiary[0],f=null,g=tb.TB_talisman_spirit.get_TB_talisman_spiritByIdArray(a.tabvo.id);if(2==a.state)this._curstate=2,d=a.tabvo.avtivedata[0],e.goToAndStop(0),c=String(getForceByAtt(g[0].attr_id,g[0].attr_value));else if(1==a.state){e.goToAndStop(1),c=String(a.activityvo.power);var h=a.activityvo.lev+1;h>g[g.length-1].level?d=null:(this._nextlevtab=g[h-1],d=this._nextlevtab.item_cost[0],f=this._nextlevtab.money_cost[0]),null==d?this._curstate=3:this._curstate=1}LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_zhanli.skinName,c,14,TextAlign.RIGHT,ColorType.Yellowffe9b4),null==d?(this.setUiListVisibleByItem(this.btnuiary,!1),this.setUiListVisibleByItem(this.Okuiary,!0)):(this.setUiListVisibleByItem(this.btnuiary,!0),this.setUiListVisibleByItem(this.Okuiary,!1),null==f?(IconManager.getInstance().drawItemIcon40(this.btnuiary[2],d[0]),UiDraw.drawResHasNumAndAllNum(this.btnuiary[4],d),UiDraw.clearUI(this.btnuiary[3]),UiDraw.clearUI(this.btnuiary[5]),this.btnuiary[2].x=783,this.btnuiary[4].x=762):(IconManager.getInstance().drawItemIcon40(this.btnuiary[2],d[0]),UiDraw.drawResHasNumAndAllNum(this.btnuiary[4],d),IconManager.getInstance().drawItemIcon40(this.btnuiary[3],f[0]),UiDraw.drawResHasNumAndAllNum(this.btnuiary[5],f),this.btnuiary[2].x=726,this.btnuiary[4].x=708));var i=tb.TB_skill_base.get_TB_skill_base(a.tabvo.passiveskill[0][0]);IconManager.getInstance().drawCircleIcon(this.b_skillicon,2,a.tabvo.passiveskill[0][0],!1,1),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_skillname.skinName,i.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeText(this._baseRender.uiAtlas,this.b_skillinfo.skinName,0,0,tb.SkillDataVo.getSkillDesc(a.tabvo.passiveskill[0][0]),14,ColorType.color9a683f,125),this.drawAttribute(),this.drawLev(),a.node.show?this._btnRedPoint.preShow():this._btnRedPoint.preHide()},b.prototype.drawAttribute=function(){var a;a=this._itdata.activityvo?this._itdata.activityvo.lev:1;for(var b=tb.TB_talisman_spirit.get_TB_talisman_spiritById(this._itdata.tabvo.id,a),c=0;7>c;c++)this.setUiListVisibleByItem([this.attribute_cur_ary[c],this.attribute_next_ary[c]],!1),c<=b.attr_id.length-1&&(1==this._curstate?(this.setUiListVisibleByItem([this.attribute_cur_ary[c],this.attribute_next_ary[c]],!0),this.drawCurAttr(c,b.attr_id[c],b.attr_value[c])):(this.setUiListVisibleByItem([this.attribute_cur_ary[c]],!0),this.drawAttr(c,b.attr_id[c],b.attr_value[c])))},b.prototype.drawLev=function(){1==this._curstate?(this.setUiListVisibleByItem(this.attribute_lev_ary,!0),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.attribute_lev_ary[0].skinName,String(this._itdata.activityvo.lev),16,TextAlign.LEFT,ColorType.colorff7200)):this.setUiListVisibleByItem(this.attribute_lev_ary,!1)},b.prototype.drawCurAttr=function(a,b,c){UiDraw.drawAttVal(this.attribute_cur_ary[a],b,c),UiDraw.drawAddValRight(this.attribute_next_ary[a],this._nextlevtab.attr_value[a],!1,TextAlign.LEFT),this.attribute_cur_ary[a].y=this.attribute_next_ary[a].y=142+20*a,this.attribute_cur_ary[a].x=717},b.prototype.drawAttr=function(a,b,c){UiDraw.drawAttVal(this.attribute_cur_ary[a],b,c),this.attribute_cur_ary[a].y=142+20*a-26,this.attribute_cur_ary[a].x=759},b.prototype.getcostStr=function(a,b){void 0===b&&(b=ColorType.colorb96d49);var c;return c=GuidData.player.getResType(a[0])>=a[1]?ColorType.Green98ec2c+a[1]:ColorType.colorce0a00+a[1]},b.prototype.drawIcon=function(a,b,c){var d=this;void 0===c&&(c=null),IconManager.getInstance().getIcon(b,function(b){var e=d._baseRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);null!=c&&UiDraw.cxtDrawImg(f,c,new Rectangle(0,0,e.pixelWitdh,e.pixelHeight),UIData.publicUi),f.drawImage(b,0,0,b.width,b.height,1,1,e.pixelWitdh-2,e.pixelHeight-2),d._baseRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},b.prototype.butClik=function(a){var b=this;if(this._itdata){if(this._canclick)if(UiTweenScale.getInstance().changeButSize(a.target),this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0}),2==this._curstate){var c=this._itdata.tabvo.avtivedata[0];if(hasEnoughResItem(c))console.log("--id-",this._itdata.tabvo.id),NetManager.getInstance().protocolos.talisman_active(this._itdata.tabvo.id);else{var d=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);d.data=c[0],ModuleEventManager.dispatchEvent(d)}}else if(1==this._curstate){var e=this._nextlevtab.item_cost[0],f=this._nextlevtab.money_cost[0];if(hasEnoughResItem(e)&&hasEnoughResItem(f))console.log("--id-",this._itdata.tabvo.id),NetManager.getInstance().protocolos.talisman_lvup(this._itdata.tabvo.id);else{var g=hasEnoughResItem(e)?f[0]:e[0],d=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);d.data=g,ModuleEventManager.dispatchEvent(d)}}}else console.log("--未选中--")},b}(UIVirtualContainer);a.TreasureRightPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=46,a.top=173,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,234,343,0,85,4,256,512,1,6,2)},c.prototype.setSelect=function(a){b.prototype.setSelect.call(this,a),this._lastTid=a.itdata.data.id},c.prototype.getSelectIdByTid=function(a){console.log("---表id---",a);for(var b=0;b<this._itemDataList.length;b++)if(this._itemDataList[b].data.id==a)return this._itemDataList[b].id;return console.log("--没有符合的项",a),0},c.prototype.refreshDataByNewData=function(){for(var b=a.TreasureModel.getInstance().getList(),c=RedPointManager.getInstance().getNodeByID(18).children,d=0;d<this._itemDataList.length;d++)c[d].data=b[d],b[d].node=c[d],this._itemDataList[d].data=b[d];this.refreshDraw();var e=this.getSelectIdByTid(this._lastTid);this.scrollIdx(e),this.setSelectIndex(e),this.setEffectUrl("ui_qh",4,4)},c.prototype.effectComplte=function(){console.log("加载好了，回调"),this.playEffect(0,-52,this.getIdxY(this.getSelectIdByTid(this._lastTid))-50,1.5,1.5)},c.prototype.getData=function(a){for(var b=new Array,c=RedPointManager.getInstance().getNodeByID(18).children,d=0;d<a.length;d++){c[d].data=a[d],a[d].node=c[d];var e=new SListItemData;e.data=a[d],e.id=d,b.push(e)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this._itemDataList=this.getData(a.TreasureModel.getInstance().getList()),this.refreshData(this._itemDataList);var b=this.getSelectIdByTid(this._lastTid);this.scrollIdx(b),this.setSelectIndex(b)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(EffectSlist);a.TreasureList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);var f=this._customRenderAry[0],g=this._customRenderAry[1];this.UnlockBg=this.creatGrid9SUI(f,this.parentTarget.baseAtlas,"UnlockBg",0,0,234,80,15,15),a.addChild(this.UnlockBg),this.Sicon=this.creatSUI(d,this.parentTarget.baseAtlas,"Sicon",9,6,68,68),a.addChild(this.Sicon),this.Sname=this.creatSUI(d,this.parentTarget.baseAtlas,"Sname",87,19,98,22),a.addChild(this.Sname),this.Sinfo=this.creatSUI(d,this.parentTarget.baseAtlas,"Sinfo",87,45,140,18),a.addChild(this.Sinfo),this.Redpoint=this.creatSUI(g,this.parentTarget.baseAtlas,"Redpoint",214,3,17,16),this.Redpoint.preParent=a,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Redpoint.skinName,UIData.publicUi,PuiData.A_RED_POINT),this.Sselect=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"Sselect",0,0,234,80,15,15),a.addChild(this.Sselect),this.Sselect.addEventListener(InteractiveEvent.Up,this.equClick,this)},c.prototype.drawIcon=function(){var a=this,b=this.itdata.data,c="ui/load/treasure/"+b.tabvo.icon;IconManager.getInstance().getIcon(c+"_c.png",function(b){var c=a._baseRender.uiAtlas.getRec(a.Sicon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(b,0,0,60,60,4,4,60,60),a._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.applyrender(),b){var c=new a.TreasureUiEvent(a.TreasureUiEvent.SELECT_ITEM_EVENT);c.data=this.itdata,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;a.node&&a.node.bindUI(this.Redpoint),this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sselect.skinName,UIData.publicUi,PuiData.Slist_select):UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Sselect.skinName,UIData.publicUi,PuiData.Slist_nselect),this.drawIcon(),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Sname.skinName,a.tabvo.name,16,TextAlign.LEFT,getColorQua(a.tabvo.quality)),1==a.state?(UiDraw.clearUI(this.UnlockBg),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Sinfo.skinName,"+"+a.activityvo.lev,14,TextAlign.LEFT,getColorQua(a.tabvo.quality))):(LabelTextFont.writeSingleLabel(this.uiAtlas,this.Sinfo.skinName,"收集"+a.tabvo.avtivedata[0][1]+"个碎片激活",14,TextAlign.LEFT,ColorType.Brown6a4936),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.UnlockBg.skinName,UIData.publicUi,PuiData.MASK))}},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.refreshDraw=function(){this.render(this.itdata)},c.prototype.equClick=function(a){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;this.setSelect()}},c.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.Sicon.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Sname.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Sinfo.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Sselect.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.UnlockBg.skinName),this.Redpoint.preHide()},c}(SListItem);a.TreasureListRender=d}(treasure||(treasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),treasure;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._publicbguiRender=new UIRenderComponent,a.addRender(a._publicbguiRender),a._roleRender=new UIRenderComponent,a.addRender(a._roleRender),a._roleRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._roleRender.dispose(),this._roleRender=null,this.mountRoleSprite.destory(),this.mountRoleSprite=null,this.treasureRightPanel&&(this.treasureRightPanel.dispose(),this.treasureRightPanel=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicbguiRender.uiAtlas=WindowUi.winUIAtlas,this._roleRender.uiAtlas.setInfo("ui/uidata/treasure/TreasureUi.xml","ui/uidata/treasure/TreasureUi.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._roleRender.uiAtlas,this.initData(),this.resize(),this.applyLoadComplete()},c.prototype.initData=function(){this.winmidRender.uiAtlas=this._publicbguiRender.uiAtlas,this.addChild(this._bgRender.getComponent("t_bg")),this.a_ro_bg=this.addEvntBut("a_ro_bg",this._roleRender),this.addChild(this._bgRender.getComponent("a_zhanlinum")),this.addChild(this._bgRender.getComponent("a_title"));var a=this.addChild(this.winmidRender.getComponent("cnew_bg_yellow"));this.setSizeForPanelUiCopy(a,"a_leftbg_yellow",this._roleRender),this.a_zhanli_all=this.addChild(this._roleRender.getComponent("a_zhanli_all"));var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(b,"b_right_bg_top",this._roleRender);var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(c,"b_right_bg_bottom",this._roleRender),this.winmidRender.applyObjData(),this.mountRoleSprite=new Person2DChar,this.mountRoleSprite.needUIUrl=!1,this._roleRender.addModel(this.mountRoleSprite)},c.prototype.setAvatar=function(a,b,c){this.mountRoleSprite.setAvatar(a)},c.prototype.resizeRole=function(){this.mountRoleSprite&&(this.mountRoleSprite.resize(),this.mountRoleSprite.scale=4*UIData.Scale,this.mountRoleSprite.x=-10*UIData.Scale,this.mountRoleSprite.y=-90*UIData.Scale)},c.prototype.resize=function(){this.resizeRole(),b.prototype.resize.call(this)},c.prototype.setZhanli=function(){ArtFont.getInstance().writeFontToSkinNameCenter(this._roleRender.uiAtlas,this.a_zhanli_all.skinName,String(GuidData.player.gettalismantotalzhanli()),ArtFont.num56)},c.prototype.show=function(b){void 0===b&&(b=0),b||(b=0),UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.treasureRightPanel||(this.treasureRightPanel=new a.TreasureRightPanel,this.treasureRightPanel.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.treasureRightPanel.parent=this),this.treasureRightPanel.show(),this.setZhanli(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.treasureRightPanel&&this.treasureRightPanel.hide(),ModulePageManager.hideResTittle()},c.prototype.butClik=function(b){switch(b.target){case this.a_ro_bg:break;case this.w_close:ModuleEventManager.dispatchEvent(new a.TreasureUiEvent(a.TreasureUiEvent.HIDE_TREASURE_EVENT))}},c}(WindowUi);a.TreasureUiPanel=b}(treasure||(treasure={}));var treasure;!function(a){var b=function(){function a(){}return a}();a.TreasureItemVo=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getList=function(){for(var a=new Array,c=tb.TB_talisman_base.get_TB_talisman_base(),d=0;d<c.length;d++){var e=new b;e.id=d;var f=this.compareAB(c[d].id);null==f?e.state=2:e.state=1,e.tabvo=c[d],e.activityvo=f,a.push(e)}return a.sort(function(a,b){return a.state==b.state?a.tabvo.id-b.tabvo.id:a.state-b.state}),a},a.prototype.compareAB=function(a){for(var b=GuidData.grow.getTreasureList(),c=0;c<b.length;c++)if(b[c].id==a)return b[c];return null},a}();a.TreasureModel=c}(treasure||(treasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),treasure;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"TreasureUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.TreasureUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_TREASURE_EVENT="SHOW_TREASURE_EVENT",b.HIDE_TREASURE_EVENT="HIDE_TREASURE_EVENT",b.SELECT_ITEM_EVENT="SELECT_ITEM_EVENT",b.UNLOCK_WEAPON_EVENT="UNLOCK_WEAPON_EVENT",b.CHANGE_WEAPON_EVENT="CHANGE_WEAPON_EVENT",b.CHANGE_ZHANLI_EVENT="CHANGE_ZHANLI_EVENT",b}(BaseEvent);a.TreasureUiEvent=c;var d=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a._nodeInit=!1,a}return __extends(d,b),d.prototype.getName=function(){return"TreasureProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){this.processRedPoint();var b=a;b.type==c.SHOW_TREASURE_EVENT?this.showUi():b.type==c.HIDE_TREASURE_EVENT?this.hideUi():b.type==c.SELECT_ITEM_EVENT?this.selectitem(b.data):b.type==c.UNLOCK_WEAPON_EVENT?this.unlockweapon():b.type==c.CHANGE_WEAPON_EVENT?this.unlockweapon():b.type==c.CHANGE_ZHANLI_EVENT&&this.changezhanli()}else a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT?this.initRedNode():(a.type==EngineEvent.MONEY_CHANGE||a.type==EngineEvent.SYSTEM_OPEN_EVENT)&&this.processRedPoint();if(a instanceof charbg.CharBgEvent&&a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT&&(this.processRedPoint(),this.refreshCost()),a instanceof UIPanelEvent){var d=a;if(d.panel==this._treasureUiPanel){for(var e=RedPointManager.getInstance().getNodeByID(18).children,f=0;f<e.length;f++)e[f].unBind();this._treasureUiPanel.dispose(),this._treasureUiPanel=null,console.log("释放面板 _treasureUiPanel")}}},d.prototype.initRedNode=function(){if(!this._nodeInit){for(var b=RedPointManager.getInstance().getNodeByID(18),c=a.TreasureModel.getInstance().getList(),d=0;d<c.length;d++){var e=new RedPointNode;e.data=c[d],b.addChild(e)}this._nodeInit=!0,this.processRedPoint()}},d.prototype.processRedPoint=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_DIVINE,SharedDef.MODULE_DIVINE_ALL))for(var a=RedPointManager.getInstance().getNodeByID(18).children,b=0;b<a.length;b++){var c=a[b].data;if(2==c.state){var d=c.tabvo.avtivedata[0];hasEnoughResItem(d)?a[b].show=!0:a[b].show=!1}else{var e=tb.TB_talisman_spirit.get_TB_talisman_spiritByIdArray(c.tabvo.id),f=c.activityvo.lev+1;if(f>e[e.length-1].level)a[b].show=!1;else{var g=e[f-1],h=g.item_cost[0],i=g.money_cost[0];hasEnoughResItem(h)&&hasEnoughResItem(i)?a[b].show=!0:a[b].show=!1}}}},d.prototype.refreshCost=function(){this._treasureUiPanel&&this._treasureUiPanel.treasureRightPanel&&this._treasureUiPanel.treasureRightPanel.hasStage&&this._treasureUiPanel.treasureRightPanel.treasureList.refreshDataByNewData()},d.prototype.changezhanli=function(){this._treasureUiPanel&&this._treasureUiPanel.hasStage&&this._treasureUiPanel.setZhanli()},d.prototype.unlockweapon=function(){this._treasureUiPanel&&this._treasureUiPanel.treasureRightPanel&&this._treasureUiPanel.treasureRightPanel.treasureList&&this._treasureUiPanel.treasureRightPanel.treasureList.hasStage&&this._treasureUiPanel.treasureRightPanel.treasureList.refreshDataByNewData()},d.prototype.selectitem=function(a){this._treasureUiPanel&&this._treasureUiPanel.treasureRightPanel&&this._treasureUiPanel.treasureRightPanel.resetData(a.data)},d.prototype.hideUi=function(){this._treasureUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(){var b=this;this._treasureUiPanel||(this._treasureUiPanel=new a.TreasureUiPanel),this._treasureUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b._treasureUiPanel.show()})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_TREASURE_EVENT),new c(c.HIDE_TREASURE_EVENT),new c(c.SELECT_ITEM_EVENT),new c(c.UNLOCK_WEAPON_EVENT),new c(c.CHANGE_WEAPON_EVENT),new c(c.CHANGE_ZHANLI_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT)]},d}(BaseProcessor);a.TreasureProcessor=d}(treasure||(treasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"StrengthGemModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.StrengthGemModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_STRENGTHGEM_PANEL="show_strengthgem_panel",b.HIDE_STRENGTHGEM_PANEL="hide_strengthgem_panel",b.STRENGTHGEM_DATA_CHG="strengthgem_data_chg",b.STRENGTHGEM_MUL_CHG="strengthgem_mul_chg",b.GEM_UPLEV_CHG="gem_uplev_chg",b.GEM_BLESS_CHG="gem_bless_chg",b.GEM_MUL_CHG="gem_mul_chg",b.SHOW_EFFECTS_MOVE="SHOW_EFFECTS_MOVE",b.STRENG_LEV_EVENT="STRENG_LEV_EVENT",b.REFINING_LEV_EVENT="REFINING_LEV_EVENT",b.GEM_LEV_EVENT="GEM_LEV_EVENT",b.WASH_CHG_EVENT="WASH_CHG_EVENT",b.SHOW_REFINING_TIPS_EVENT="SHOW_REFINING_TIPS_EVENT",b.SHOW_MASTER_TIPS_EVENT="SHOW_MASTER_TIPS_EVENT",b.EFF_EVENT="EFF_EVENT",b.POP_TIPS_EVENT="POP_TIPS_EVENT",b}(BaseEvent);a.StrengthGemEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"StrengthGemProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){this.processRedPoint();var b=a;b.type==c.SHOW_STRENGTHGEM_PANEL?this.showPanel(b.data):b.type==c.HIDE_STRENGTHGEM_PANEL?this.hidePanel():b.type==c.SHOW_EFFECTS_MOVE?this.showEffectsMove(b.data):b.type==c.STRENG_LEV_EVENT?this.strenglevevent(b.data):b.type==c.REFINING_LEV_EVENT?this.refininglevevent(b.data):b.type==c.GEM_LEV_EVENT?this.gemlevevent(b.data):b.type==c.WASH_CHG_EVENT?this.washvochg():b.type==c.SHOW_REFINING_TIPS_EVENT?this.showrefiningtipsPanel(b.data):b.type==c.SHOW_MASTER_TIPS_EVENT?this.showmastertipsPanel(b.data):b.type==c.EFF_EVENT?this.effshow():b.type==c.POP_TIPS_EVENT&&this.showpoptios(b.data)}else if(a instanceof UIPanelEvent){var d=a;d.panel==this._newStrengUiPanel&&(this._newStrengUiPanel.dispose(),this._newStrengUiPanel=null,console.log("释放面板 _newStrengUiPanel")),d.panel==this._refiningtipsPanel&&(this._refiningtipsPanel.dispose(),this._refiningtipsPanel=null,console.log("释放面板 _refiningtipsPanel")),d.panel==this._masterLevtipsPanel&&(this._masterLevtipsPanel.dispose(),this._masterLevtipsPanel=null,console.log("释放面板 _masterLevtipsPanel")),d.panel==this._poplevtipspanel&&(this._poplevtipspanel.dispose(),this._poplevtipspanel=null,console.log("释放面板 _poplevtipspanel"))}else a.type==EngineEvent.MONEY_CHANGE?(this.refreshCost(),this.processRedPoint()):a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT||a.type==EngineEvent.SYSTEM_OPEN_EVENT?this.processRedPoint():a instanceof charbg.CharBgEvent&&a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT&&(this.processRedPoint(),
a.showType==BagData.TYPE_EQU&&this.bagChg(a.data),this._newStrengUiPanel&&this._newStrengUiPanel.strengTab0&&this._newStrengUiPanel.strengTab0.hasStage&&this._newStrengUiPanel.strengTab0.refreshPartChg(this._newStrengUiPanel.strengTab0.lastselect+1),this._newStrengUiPanel&&this._newStrengUiPanel.strengTab1&&this._newStrengUiPanel.strengTab1.hasStage&&this._newStrengUiPanel.strengTab1.refreshPartChg(this._newStrengUiPanel.strengTab1.lastselect+1),this._newStrengUiPanel&&this._newStrengUiPanel.strengTab2&&this._newStrengUiPanel.strengTab2.hasStage&&this._newStrengUiPanel.strengTab2.refreshPartChg(this._newStrengUiPanel.strengTab2.lastselect+1),this._newStrengUiPanel&&this._newStrengUiPanel.strengTab3&&this._newStrengUiPanel.strengTab3.hasStage&&this._newStrengUiPanel.strengTab3.drawResItem())},d.prototype.processRedPoint=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_MIX,SharedDef.MODULE_MIX_STRENGTH))for(var b=RedPointManager.getInstance().getNodeByID(38).children,c=0;c<b.length;c++){var d=a.NewStrengModel.getInstance().getstrengvo(c+1);if(0==d.state||d.partlev>=GuidData.player.getLevel())b[c].show=!1;else{for(var e=d.nexttab?d.nexttab:d.curtab,f=new Array,g=0;g<e.cost.length;g++)f.push(hasEnoughResItem(e.cost[g]));b[c].show=!0;for(var h=0;h<f.length;h++)b[c].show=b[c].show&&f[h]}}if(GuidData.player.getsyspageopen(SharedDef.MODULE_MIX,SharedDef.MODULE_MIX_POLISHED))for(var i=RedPointManager.getInstance().getNodeByID(41).children,c=0;c<i.length;c++){var j=a.NewStrengModel.getInstance().getrefiningvo(c+1);if(0==j.state)i[c].show=!1;else{for(var k=j.nexttab?j.nexttab:j.curtab,l=new Array,g=0;g<k.cost.length;g++)l.push(hasEnoughResItem(k.cost[g]));i[c].show=!0;for(var h=0;h<l.length;h++)i[c].show=i[c].show&&l[h]}}if(GuidData.player.getsyspageopen(SharedDef.MODULE_MIX,SharedDef.MODULE_MIX_GEM))for(var m=RedPointManager.getInstance().getNodeByID(44).children,c=0;c<m.length;c++)for(var n=a.NewStrengModel.getInstance().getGemvo(c+1),o=0;o<n.length;o++)if(m[c].show=!1,1==n[o].state||3==n[o].state){for(var p=n[o].nexttab?n[o].nexttab:n[o].curtab,q=new Array,g=0;g<p.cost.length;g++)q.push(hasEnoughResItem(p.cost[g]));for(var r=!0,h=0;h<q.length;h++)if(!q[h]){r=!1;break}if(r){m[c].show=!0;break}}},d.prototype.showmastertipsPanel=function(b){var c=this;this._masterLevtipsPanel||(this._masterLevtipsPanel=new a.masterLevtipsPanel),this._masterLevtipsPanel.load(function(){c._masterLevtipsPanel.show(b)},!1)},d.prototype.showrefiningtipsPanel=function(b){var c=this;this._refiningtipsPanel||(this._refiningtipsPanel=new a.refiningtipsPanel),this._refiningtipsPanel.load(function(){c._refiningtipsPanel.show(b)},!1)},d.prototype.effshow=function(){this._newStrengUiPanel&&(this._newStrengUiPanel.strengTab0&&this._newStrengUiPanel.strengTab0.hasStage&&this._newStrengUiPanel.strengTab0.showExpEff(),this._newStrengUiPanel.strengTab1&&this._newStrengUiPanel.strengTab1.hasStage&&this._newStrengUiPanel.strengTab1.showExpEff())},d.prototype.bagChg=function(a){this._newStrengUiPanel&&(this._newStrengUiPanel.strengTab0&&this._newStrengUiPanel.strengTab0.hasStage&&this._newStrengUiPanel.strengTab0.refreshEqu(),this._newStrengUiPanel.strengTab1&&this._newStrengUiPanel.strengTab1.hasStage&&this._newStrengUiPanel.strengTab1.refreshEqu(),this._newStrengUiPanel.strengTab2&&this._newStrengUiPanel.strengTab2.hasStage&&this._newStrengUiPanel.strengTab2.refreshEqu(),this._newStrengUiPanel.strengTab3&&this._newStrengUiPanel.strengTab3.hasStage&&(this._newStrengUiPanel.strengTab3.refreshEqu(),this._newStrengUiPanel.strengTab3.drawAttr()))},d.prototype.washvochg=function(){this._newStrengUiPanel&&this._newStrengUiPanel.strengTab3&&this._newStrengUiPanel.strengTab3.hasStage&&(this._newStrengUiPanel.strengTab3.drawNewAttr(),this._newStrengUiPanel.strengTab3.drawBtn()),this._newStrengUiPanel&&this._newStrengUiPanel.hasStage&&this._newStrengUiPanel.refreshCurMasterLev()},d.prototype.refreshCost=function(){this._newStrengUiPanel&&this._newStrengUiPanel.strengTab0&&this._newStrengUiPanel.strengTab0.hasStage&&this._newStrengUiPanel.strengTab0.drawResItem(),this._newStrengUiPanel&&this._newStrengUiPanel.strengTab1&&this._newStrengUiPanel.strengTab1.hasStage&&this._newStrengUiPanel.strengTab1.drawResItem(),this._newStrengUiPanel&&this._newStrengUiPanel.strengTab3&&this._newStrengUiPanel.strengTab3.hasStage&&this._newStrengUiPanel.strengTab3.drawResItem()},d.prototype.gemlevevent=function(a){this._newStrengUiPanel&&this._newStrengUiPanel.strengTab2&&this._newStrengUiPanel.strengTab2.hasStage&&this._newStrengUiPanel.strengTab2.refreshPartChg(a)},d.prototype.refininglevevent=function(a){this._newStrengUiPanel&&this._newStrengUiPanel.strengTab1&&this._newStrengUiPanel.strengTab1.hasStage&&this._newStrengUiPanel.strengTab1.refreshPartChg(a)},d.prototype.strenglevevent=function(a){this._newStrengUiPanel&&this._newStrengUiPanel.strengTab0&&this._newStrengUiPanel.strengTab0.hasStage&&this._newStrengUiPanel.strengTab0.refreshPartChg(a)},d.prototype.showEffectsMove=function(a){},d.prototype.showpoptios=function(b){var c=this;this._poplevtipspanel||(this._poplevtipspanel=new a.PopLevTipsPanel),this._poplevtipspanel.load(function(){c._poplevtipspanel.show(b)})},d.prototype.showPanel=function(b){var c=this;this._newStrengUiPanel||(this._newStrengUiPanel=new a.NewStrengUiPanel),this._newStrengUiPanel.load(function(){SceneManager.getInstance().render=!1;var a=new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT);ModuleEventManager.dispatchEvent(a),b instanceof Array?c._newStrengUiPanel.show(b[0]):c._newStrengUiPanel.show(b);var d=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);d.data=SharedDef.MODULE_MIX,ModuleEventManager.dispatchEvent(d)})},d.prototype.hidePanel=function(){this._newStrengUiPanel&&this._newStrengUiPanel.hide(),UIManager.popClikNameFun("w_close"),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_STRENGTHGEM_PANEL),new c(c.HIDE_STRENGTHGEM_PANEL),new c(c.STRENGTHGEM_DATA_CHG),new c(c.STRENGTHGEM_MUL_CHG),new c(c.GEM_UPLEV_CHG),new c(c.GEM_BLESS_CHG),new c(c.GEM_MUL_CHG),new c(c.SHOW_EFFECTS_MOVE),new EngineEvent(EngineEvent.MONEY_TYPE_SILVER),new EngineEvent(EngineEvent.MONEY_TYPE_GOLD_INGOT),new EngineEvent(EngineEvent.MONEY_TYPE_GEM),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new c(c.STRENG_LEV_EVENT),new c(c.REFINING_LEV_EVENT),new c(c.GEM_LEV_EVENT),new c(c.WASH_CHG_EVENT),new c(c.SHOW_REFINING_TIPS_EVENT),new c(c.SHOW_MASTER_TIPS_EVENT),new c(c.EFF_EVENT),new c(c.POP_TIPS_EVENT)]},d}(BaseProcessor);a.StrengthGemProcessor=d}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._bgRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas.setInfo("ui/uidata/streng/tips.xml","ui/uidata/streng/tips.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._bgRender.uiAtlas,this.addUIList(["c_title","c_line"],this._bgRender),this.c_info=this.addChild(this._bgRender.getComponent("c_info")),this.c_lev=this.addChild(this._baseRender.getComponent("c_lev")),this.AttrCurAry=new Array;for(var a=0;9>a;a++)this.AttrCurAry.push(this.addChild(this._baseRender.getComponent("c_attr"+a)));this.applyLoadComplete(),this.resize()},b.prototype.resetData=function(a){console.log("----奖励tips----");var b;b=25==a[0]?SharedDef.MODULE_MIX_STRENGTH:26==a[0]?SharedDef.MODULE_MIX_POLISHED:SharedDef.MODULE_MIX_GEM;var c=0==a[1]?1:a[1],d=b-1;LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.c_lev.skinName,String(c),16,TextAlign.CENTER,ColorType.Brown7a2f21),this.c_info.goToAndStop(d);for(var e=this.getTabAry(b),f=e[c-1],g=0;g<this.AttrCurAry.length;g++)g<f.props.length?UiDraw.drawAttValAdd(this.AttrCurAry[g],f.props[g][0],f.props[g][1]):UiDraw.clearUI(this.AttrCurAry[g])},b.prototype.getTabAry=function(a){for(var b=new Array,c=tb.TB_equipdevelop_bonus.get_TB_equipdevelop_bonus(),d=0;d<c.length;d++)c[d].type==a&&b.push(c[d]);return console.log("--comebackary--",b),b},b.prototype.butClik=function(a){switch(a.target){case this.c_close:this.hide()}},b.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),this.resetData(a)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(WindowCentenMin);a.PopLevTipsPanel=b}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.KeyByType=["全身强化:  ","全身精炼:  ","全身镶嵌总和:  "],a.KeyLevNameByType=["级","段","级"],a.setBlackBg(),a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._bgRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._bgRender.dispose(),this._bgRender=null,b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas.setInfo("ui/uidata/streng/tips.xml","ui/uidata/streng/tips.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._midRender.uiAtlas=this._bgRender.uiAtlas,this.addUIList(["b_title","b_bg0","b_bg1"],this._bgRender),this.addUIList(["b_line","b_arrow"],this._midRender),this.AttrCurAry=new Array,this.AttrNextAry=new Array;for(var a=0;11>a;a++)this.AttrCurAry.push(this.addChild(this._midRender.getComponent("b_attr"+a))),this.AttrNextAry.push(this.addChild(this._midRender.getComponent("b_nattr"+a)));this.b_tab0=this.addEvntBut("b_tab0",this._bgRender),this.b_tab1=this.addEvntBut("b_tab1",this._bgRender),this.b_tab2=this.addEvntBut("b_tab2",this._bgRender),this.TabAry=new Array,this.TabAry.push(this.b_tab0),this.TabAry.push(this.b_tab1),this.TabAry.push(this.b_tab2),this.resize(),this.applyLoadComplete()},c.prototype.butClik=function(a){switch(a.target){case this.e_close:UIManager.getInstance().removeUIContainer(this);break;case this.b_tab0:this.setSelectTab(SharedDef.MODULE_MIX_STRENGTH);break;case this.b_tab1:this.setSelectTab(SharedDef.MODULE_MIX_POLISHED);break;case this.b_tab2:this.setSelectTab(SharedDef.MODULE_MIX_GEM)}},c.prototype.setSelectTab=function(a){for(var b=0;b<this.TabAry.length;b++)b+1==a?this.TabAry[b].selected=!0:this.TabAry[b].selected=!1;this.drawPage(a)},c.prototype.drawPage=function(b){var c=b-1,d=0==this._masterlevvo[c]?1:this._masterlevvo[c],e=this.getTabAry(b),f=e[d-1];if(d==e.length)LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.AttrNextAry[3].skinName,"已满级",14,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.clearUI(this.AttrNextAry[0]),UiDraw.clearUI(this.AttrNextAry[1]),UiDraw.clearUI(this.AttrNextAry[2]),UiDraw.clearUI(this.AttrNextAry[4]),UiDraw.clearUI(this.AttrNextAry[5]),UiDraw.clearUI(this.AttrNextAry[6]);else{if(!(d<e.length))return;var g;g=0==this._masterlevvo[c]?f:e[d],LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.AttrNextAry[0].skinName,ColorType.color802626+a.StrengUtil.KeyNameByType[c]+":  "+ColorType.Green2ca937+g.level+"级",14,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.AttrNextAry[1].skinName,ColorType.color802626+this.KeyByType[c]+ColorType.Green2ca937+g.need_lv[0]+this.KeyLevNameByType[c],14,TextAlign.LEFT);for(var h=0;h<this.AttrNextAry.length-2;h++)h<g.props.length?UiDraw.drawAttValAdd(this.AttrNextAry[h+2],g.props[h][0],g.props[h][1]):UiDraw.clearUI(this.AttrNextAry[h+2])}if(this._masterlevvo[c]>0){LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.AttrCurAry[0].skinName,ColorType.color802626+a.StrengUtil.KeyNameByType[c]+":  "+ColorType.color9a683f+f.level+"级",14,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.AttrCurAry[1].skinName,ColorType.color802626+this.KeyByType[c]+ColorType.color9a683f+f.need_lv[0]+this.KeyLevNameByType[c],14,TextAlign.LEFT);for(var h=0;h<this.AttrCurAry.length-2;h++)h<f.props.length?this.drawAttrVal(this.AttrCurAry[h+2],f.props[h][0],f.props[h][1]):UiDraw.clearUI(this.AttrCurAry[h+2])}else LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.AttrCurAry[3].skinName,this.KeyByType[c]+f.need_lv[0]+this.KeyLevNameByType[c],14,TextAlign.CENTER,ColorType.color802626),LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.AttrCurAry[4].skinName,"即可获得属性提升",14,TextAlign.CENTER,ColorType.color802626),UiDraw.clearUI(this.AttrCurAry[0]),UiDraw.clearUI(this.AttrCurAry[1]),UiDraw.clearUI(this.AttrCurAry[2]),UiDraw.clearUI(this.AttrCurAry[5]),UiDraw.clearUI(this.AttrCurAry[6])},c.prototype.getTabAry=function(a){for(var b=new Array,c=tb.TB_equipdevelop_bonus.get_TB_equipdevelop_bonus(),d=0;d<c.length;d++)c[d].type==a&&b.push(c[d]);return b},c.prototype.show=function(a){this.hasStage||UIManager.getInstance().addUIContainer(this),this._masterlevvo=GuidData.grow.getMasterLevVo(),this.setSelectTab(a)},c.prototype.drawAttrVal=function(a,b,c){var d=Math.floor(c/100);LabelTextFont.writeSingleLabel(a.uiRender.uiAtlas,a.skinName,ColorType.color802626+getKeyProById(b)+":    "+ColorType.color9a683f+"+"+Snum(d),14,TextAlign.LEFT)},c}(WindowMinUi);a.masterLevtipsPanel=b}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._bgRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._bgRender.dispose(),this._bgRender=null},b.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas.setInfo("ui/uidata/streng/tips.xml","ui/uidata/streng/tips.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._midRender.uiAtlas=this._bgRender.uiAtlas,this.a_closebtn=this.addEvntBut("a_closebtn",this._midRender),this.a_closebtn.addEventListener(InteractiveEvent.Up,this.butClik,this),this.addUIList(["a_bg"],this._bgRender),this.addUIList(["a_txt"],this._midRender),this.AttrCurAry=new Array,this.AttrNextAry=new Array;for(var a=0;7>a;a++)this.AttrCurAry.push(this.addChild(this._midRender.getComponent("a_attr"+a))),this.AttrNextAry.push(this.addChild(this._midRender.getComponent("a_nattr"+a)));this.resize(),this.applyLoadComplete()},b.prototype.butClik=function(a){UIManager.getInstance().removeUIContainer(this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Down,this.butClik,this)},b.prototype.show=function(a){Scene_data.uiStage.addEventListener(InteractiveEvent.Down,this.butClik,this),this.hasStage||UIManager.getInstance().addUIContainer(this);var b=GuidData.bag.getEquByPart(a[0]),c=b.entryData.basic_properties;console.log("==基础属性绘制==",c),c&&c.length?(this.drawAttrVal(this.AttrCurAry[0],c[0][0],c[0][1]),UiDraw.drawAddValRight(this.AttrNextAry[0],(a[1]+1)*c[0][1],!1,TextAlign.LEFT)):(UiDraw.clearUI(this.AttrCurAry[0]),UiDraw.clearUI(this.AttrNextAry[0]));var d=b.data.AttrData,e=d.length/3;console.log("==附加属性绘制==",d,e);for(var f=0;f<this.AttrCurAry.length-1;f++)e>f?(this.drawAttrVal(this.AttrCurAry[f+1],d[3*f],d[3*f+1]),UiDraw.drawAddValRight(this.AttrNextAry[f+1],(a[1]+1)*d[3*f+1],!1,TextAlign.LEFT)):(UiDraw.clearUI(this.AttrCurAry[f+1]),UiDraw.clearUI(this.AttrNextAry[f+1]))},b.prototype.drawAttrVal=function(a,b,c){LabelTextFont.writeSingleLabel(a.uiRender.uiAtlas,a.skinName,ColorType.colorefe4c4+getKeyProById(b)+":  "+Snum(c),14,TextAlign.RIGHT)},b}(UIPanel);a.refiningtipsPanel=b}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.keyPropaa=["生       命","攻       击","防       御","命       中","闪       避","暴       击","抗       暴","攻       速","移       速","破       防","忽视闪避","生命值回复","伤害加深","伤害减免","反弹伤害","吸       血","回复效率","暴暴击击","抗       暴","暴击伤害","暴伤减免","命中率","闪避率","眩       晕","定       身","沉       默","混       乱","魅       惑","控制增强","控制减免","防       御"],a._canclick=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._effRender&&(this._effRender.dispose(),this._effRender=null)},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._bgRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.EuqUIAry=new Array;for(var b=0;10>b;b++){var c=this.addChild(this._topRender.getComponent("t_equ"+b));c.addEventListener(InteractiveEvent.Up,this.equClick,this),this.EuqUIAry.push(c)}this.t_curequ=this.addChild(a.getComponent("t_curequ")),this.t_curname=this.addChild(a.getComponent("t_curname")),this.d_bg3_1=this.addChild(this._bgRender.getComponent("d_bg3_1")),this.addUIList(["t_costinfo","d_bg3_0","d_arrow"],this._bgRender),this.BtnUI0Ary=new Array,this.btn0=this.addEvntButUp("cnew_btn2",this._publicRender),this.setSizeForPanelUiCopy(this.btn0,"d_btn0",a),this.BtnUI0Ary.push(this.btn0),this.BtnUI0Ary.push(a.getComponent("d_btntxt0")),this.BtnUI1Ary=new Array,this.btn1=this.addEvntButUp("cnew_btn2",this._publicRender),this.setSizeForPanelUiCopy(this.btn1,"d_btn1",a),this.BtnUI1Ary.push(this.btn1),this.btn2=this.addEvntButUp("cnew_btn2",this._publicRender),this.setSizeForPanelUiCopy(this.btn2,"d_btn2",a),this.BtnUI1Ary.push(this.btn2),this.BtnUI1Ary.push(a.getComponent("d_btntxt1")),this.BtnUI1Ary.push(a.getComponent("d_btntxt2")),this.d_force0=this.addChild(a.getComponent("d_force0")),this.d_force1=this.addChild(a.getComponent("d_force1")),this.d_forceArrow=this._topRender.getComponent("d_forceArrow"),this.Attr0Ary=new Array,this.Attr1Ary=new Array,this.ProbgAry=new Array,this.Probg1Ary=new Array,this.ProAry=new Array,this.Pro1Ary=new Array,this.AttrnameAry=new Array,this.AttrnameAry_n=new Array;for(var d=0;6>d;d++)this.Attr0Ary.push(this.addChild(this._topRender.getComponent("d_attr"+d))),this.Attr1Ary.push(this.addChild(this._topRender.getComponent("d_nattr"+d))),this.ProbgAry.push(this.addChild(this._bgRender.getComponent("d_probg"+d))),this.ProAry.push(this.addChild(this._baseRender.getComponent("d_pro"+d))),this.Probg1Ary.push(this.addChild(this._bgRender.getComponent("d_nprobg"+d))),this.Pro1Ary.push(this.addChild(this._baseRender.getComponent("d_npro"+d))),this.AttrnameAry.push(this.addChild(this._baseRender.getComponent("d_attrname"+d))),this.AttrnameAry_n.push(this.addChild(this._baseRender.getComponent("d_nattrname"+d)));this.CostItemUIAry=new Array,this.CostItemUIAry.push(this.addChild(a.getComponent("t_costitem0"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costitem1"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costnum0"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costnum1"))),this._publicRender.applyObjData()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.InitEqu(),this.resize()},c.prototype.hide=function(){this.canshowAlert()&&UIManager.getInstance().removeUIContainer(this)},c.prototype.refreshEqu=function(){for(var b=0;10>b;b++)this.drawEqu(this.EuqUIAry[b],this._lastselect==b,a.StrengUtil.GENERAL)},c.prototype.InitEqu=function(){for(var a=0;10>a;a++)this.EuqUIAry[a].data=a+1;var b=this.getCurWashVo(),c=b?b.partid-1:0,d=new InteractiveEvent(InteractiveEvent.Up);d.target=this.EuqUIAry[c],this.equClick(d)},c.prototype.getCurWashVo=function(){var b=GuidData.grow.getWashVo();if(b.length>0){var c=a.StrengUtil.parseStr(b),d=GuidData.bag.getEquByPart(c.partid);if(d&&d.guid==c.guid)return c}return null},c.prototype.drawEqu=function(b,c,d){var e=b.data,f=GuidData.bag.getEquByPart(e),g=[];c&&(f?this._equid=f.entryData.id:this._equid=null),f?a.StrengUtil.setEquIcon(b,geteqiconIconUrl(f.entryData.icon),g,c,d,f.entryData.quality,f.entryData.level):a.StrengUtil.setEquNoIcon(b,e,g,c,d)},c.prototype.equClick=function(b){if(this.canshowAlert()){for(var c=0;c<this.EuqUIAry.length;c++)this.EuqUIAry[c]==b.target?(this._lastselect=c,this.drawEqu(this.EuqUIAry[c],!0,a.StrengUtil.GENERAL)):this.drawEqu(this.EuqUIAry[c],!1,a.StrengUtil.GENERAL);this.resetData(b.target.data)}},c.prototype.resetData=function(b){this.t_curequ.data=b,this._vo=b,this.drawEqu(this.t_curequ,!1,a.StrengUtil.GENERAL),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.t_curname.skinName,a.StrengUtil.equProp[b-1]+"部位",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.drawResItem(),this.drawBtn(),this.drawAttr(),this.drawNewAttr()},c.prototype.canshowAlert=function(){var a=this,b=this.getCurWashVo();return console.log(this._vo,b),this._vo&&b&&b.partid==this._vo?(AlertUtil.show("你有未保存的新属性，是否保存？","提示",function(b){1==b?a.sendwash(SharedDef.EQUIPDEVELOP_TYPE_WASHATTRS_SAVE):(console.log("--取消"),NetManager.getInstance().protocolos.equipdevelop_operate(SharedDef.EQUIPDEVELOP_TYPE_WASHATTRS_DEL,0,0,"",""))},2,["是","否"]),!1):!0},c.prototype.drawBtn=function(){var a=this.getCurWashVo(),b=a&&a.partid==this._lastselect+1;this.setUiListVisibleByItem(this.BtnUI1Ary,b),this.setUiListVisibleByItem(this.BtnUI0Ary,!b)},c.prototype.drawNewAttr=function(){this.setUiListVisibleByItem(this.Pro1Ary,!1),this.setUiListVisibleByItem(this.Probg1Ary,!1),this.setUiListVisibleByItem(this.AttrnameAry_n,!1),this.setUiListVisibleByItem([this.d_forceArrow],!1);var b=this.getCurWashVo();if(b&&b.partid==this._lastselect+1){this.Attr1Ary[1].x=629;for(var c=new Array,d=new Array,e=0;e<this.Attr1Ary.length;e++)if(e<b.attrary.length){this.setUiListVisibleByItem([this.Pro1Ary[e],this.Probg1Ary[e],this.AttrnameAry_n[e]],!0);var f=b.attrary[e][0],g=Math.floor(b.attrary[e][1]/100),h=a.StrengUtil.getMinMax(this._equid,f),i=Math.floor(h[1]/100),j=Math.floor(h[2]/100),k=(g-i)/(j-i);console.log("------raio-------",k),c.push(f),d.push(b.attrary[e][1]),this.Pro1Ary[e].uvScale=k,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.AttrnameAry_n[e].skinName,ColorType.Orange7a2f21+this.getKeyProByIdaaa(f),14,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.Attr1Ary[e].skinName,Snum(g)+"/"+Snum(j),14,TextAlign.CENTER,ColorType.Brown7a2f21)}else UiDraw.clearUI(this.Attr1Ary[e]);var l=getForceByAtt(c,d),m=ColorType.Brown7a2f21+"战力： ";this._lastforce>l?(this.setUiListVisibleByItem([this.d_forceArrow],!0),this.d_forceArrow.goToAndStop(1),m+=ColorType.colorce0a00+l):this._lastforce<l?(this.setUiListVisibleByItem([this.d_forceArrow],!0),this.d_forceArrow.goToAndStop(0),m+=ColorType.color2daa35+l):m+=ColorType.Brown7a2f21+l,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.d_force1.skinName,m,14,TextAlign.CENTER,ColorType.Brown7a2f21)}else this.Attr1Ary[1].x=598,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.Attr1Ary[1].skinName,"点击按钮开始洗炼",14,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.clearUI(this.d_force1),UiDraw.clearUI(this.Attr1Ary[0]),UiDraw.clearUI(this.Attr1Ary[2]),UiDraw.clearUI(this.Attr1Ary[3]),UiDraw.clearUI(this.Attr1Ary[4]),UiDraw.clearUI(this.Attr1Ary[5])},c.prototype.drawAttr=function(){this.setUiListVisibleByItem(this.ProAry,!1),this.setUiListVisibleByItem(this.ProbgAry,!1),this.setUiListVisibleByItem(this.AttrnameAry,!1);var b=GuidData.bag.getEquByPart(this._vo);if(b){this.Attr0Ary[1].x=416;for(var c=b.data.AttrData,d=c.length/3,e=new Array,f=new Array,g=0;g<this.Attr0Ary.length;g++)if(d>g){this.setUiListVisibleByItem([this.ProAry[g],this.ProbgAry[g],this.AttrnameAry[g]],!0);var h=c[3*g],i=Math.floor(c[3*g+1]/100),j=a.StrengUtil.getMinMax(this._equid,h),k=Math.floor(j[1]/100),l=Math.floor(j[2]/100),m=(i-k)/(l-k);e.push(h),f.push(c[3*g+1]),this.ProAry[g].uvScale=m,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.AttrnameAry[g].skinName,ColorType.Orange7a2f21+this.getKeyProByIdaaa(h),14,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.Attr0Ary[g].skinName,Snum(i)+"/"+Snum(l),14,TextAlign.CENTER,ColorType.Brown7a2f21)}else UiDraw.clearUI(this.Attr0Ary[g]);var n=getForceByAtt(e,f);this._lastforce=n,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.d_force0.skinName,"战力： "+n,14,TextAlign.CENTER,ColorType.Brown7a2f21)}else this.Attr0Ary[1].x=381,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.Attr0Ary[1].skinName,"请穿戴相应装备",14,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.clearUI(this.d_force0),UiDraw.clearUI(this.Attr0Ary[0]),UiDraw.clearUI(this.Attr0Ary[2]),UiDraw.clearUI(this.Attr0Ary[3]),UiDraw.clearUI(this.Attr0Ary[4]),UiDraw.clearUI(this.Attr0Ary[5])},c.prototype.getKeyProByIdaaa=function(a){return this.keyPropaa[a-1]},c.prototype.drawNewAttrVal=function(a,b,c,d){var e="";if("undefined"==typeof b)return void UiDraw.clearUI(a);var f=Math.floor(c/100);e=ColorType.Orange7a2f21+this.getKeyProByIdaaa(b)+":  "+d+Snum(f),LabelTextFont.writeSingleLabel(a.uiRender.uiAtlas,a.skinName,e,14,TextAlign.LEFT)},c.prototype.setcostary=function(a){var b=tb.TB_equipdevelop_washattrs.get_TB_equipdevelop_washattrsById(this._vo,a);this._costary=b.cost},c.prototype.drawResItem=function(){var a=new Array,b=GuidData.bag.getEquByPart(this._vo),c=b?b.entryData.quality:0;this.setcostary(c);for(var d=0;2>d;d++)d<this._costary.length?(IconManager.getInstance().drawItemIcon40(this.CostItemUIAry[d],this._costary[d][0]),a.push(UiDraw.drawResHasNumAndAllNum(this.CostItemUIAry[d+2],this._costary[d])),this.CostItemUIAry[0].x=1==this._costary.length?528:494,this.CostItemUIAry[2].x=1==this._costary.length?516:482):(UiDraw.clearUI(this.CostItemUIAry[d+2]),UiDraw.clearUI(this.CostItemUIAry[d]));this._canbuy=a},c.prototype.showExpEff=function(){var a=this;this._effRender||(this._effRender=new FrameUIRender,this.addRender(this._effRender),this._effRender.setImg(getEffectUIUrl("ui_xl"),4,4,function(b){a.expEff=b,a.expEff.x=a.d_bg3_1.x-58,a.expEff.y=a.d_bg3_1.y-70,a.expEff.width=1.2*a.expEff.baseRec.width,a.expEff.speed=3,a.expEff.playOne(a)})),this.expEff&&this.expEff.playOne(this)},c.prototype.butClik=function(a){var b=this;if(this._canclick)switch(UiTweenScale.getInstance().changeButSize(a.target),this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0}),a.target){case this.btn0:case this.btn1:this.sendwash(SharedDef.EQUIPDEVELOP_TYPE_WASHATTRS_WASH);break;case this.btn2:this.sendwash(SharedDef.EQUIPDEVELOP_TYPE_WASHATTRS_SAVE)}},c.prototype.sendwash=function(a){var b=GuidData.bag.getEquByPart(this._vo);if(b){var c,d=!0;if(a==SharedDef.EQUIPDEVELOP_TYPE_WASHATTRS_WASH&&(2==this._canbuy.length?(d=this._canbuy[0]&&this._canbuy[1],d||(c=this._canbuy[0]?this._costary[1][0]:this._costary[0][0])):(d=this._canbuy[0],d||(c=this._costary[0][0]))),d)a==SharedDef.EQUIPDEVELOP_TYPE_WASHATTRS_WASH&&this.showExpEff(),NetManager.getInstance().protocolos.equipdevelop_operate(a,0,0,b.guid,"");else{var e=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);e.data=c,ModuleEventManager.dispatchEvent(e)}}else msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"请穿戴上装备再洗炼",99)},c}(UIVirtualContainer);a.StrengTab3=b}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._canclick=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this._effRender&&(this._effRender.dispose(),this._effRender=null)},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.EuqUIAry=new Array;for(var b=0;10>b;b++){var c=this.addChild(this._topRender.getComponent("t_equ"+b));c.addEventListener(InteractiveEvent.Down,this.equClick,this),this.EuqUIAry.push(c),this._redPointRender.getRedPointUI(this,102+b,new Vector2D(c.x+c.width,c.y))}this.t_curequ=this.addChild(a.getComponent("t_curequ")),this.t_curname=this.addChild(a.getComponent("t_curname")),this.BtnUIAry=new Array,this.btn0=this.addEvntButUp("cnew_btn2",this._publicRender),this.setSizeForPanelUiCopy(this.btn0,"c_btn0",a),this.btn1=this.addEvntButUp("cnew_btn2",this._publicRender),this.setSizeForPanelUiCopy(this.btn1,"c_btn1",a),this.btn2=this.addEvntButUp("cnew_btn2",this._publicRender),this.setSizeForPanelUiCopy(this.btn2,"c_btn2",a),this.BtnUIAry.push(this.btn0),this.BtnUIAry.push(this.btn1),this.BtnUIAry.push(this.btn2),this.GemUIIconAry=new Array,this.GemUIattrAry=new Array,this.GemUICostAry=new Array,this.GemUIHasAry=new Array,this.GemUILevAry=new Array,this.UnlockUIAry=new Array,this.GemUIattrAry_n=new Array,this.GemUILevAry_n=new Array,this.GemUIArrowAry=new Array;for(var d=0;3>d;d++){this.UnlockUIAry.push(a.getComponent("c_unlockinfo"+d)),this.BtnUIAry.push(this.addChild(a.getComponent("c_btntxt"+d))),this.GemUIIconAry.push(this.addChild(this._topRender.getComponent("c_grm"+d))),
this.GemUILevAry.push(this.addChild(this._topRender.getComponent("c_gemlev"+d))),this.GemUIattrAry.push(this.addChild(this._topRender.getComponent("c_attr"+d))),this.GemUICostAry.push(this.addChild(this._topRender.getComponent("c_cost"+d))),this.GemUIHasAry.push(this.addChild(this._topRender.getComponent("c_has"+d))),this.GemUILevAry_n.push(this.addChild(this._topRender.getComponent("c_nlev"+d))),this.GemUIattrAry_n.push(this.addChild(this._topRender.getComponent("c_nattr"+d))),this.GemUIArrowAry.push(this._topRender.getComponent("c_arrow"+d));var e=this.addChild(this._publicRender.getComponent("cnew_bg_yellow"));this.setSizeForPanelUiCopy(e,"c_yellowbg"+d,this._topRender)}this._publicRender.applyObjData(),this._redbtnary=new Array,this._redbtnary.push(this._redPointRender.getRedPointUI(this,0,new Vector2D(this.btn0.x+this.btn0.width,this.btn0.y))),this._redbtnary.push(this._redPointRender.getRedPointUI(this,0,new Vector2D(this.btn1.x+this.btn1.width,this.btn1.y))),this._redbtnary.push(this._redPointRender.getRedPointUI(this,0,new Vector2D(this.btn2.x+this.btn2.width,this.btn2.y)))},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.InitEqu(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.InitEqu=function(){for(var b=0;10>b;b++)this.EuqUIAry[b].data=a.NewStrengModel.getInstance().getGemvo(b+1);var c=new InteractiveEvent(InteractiveEvent.Down);c.target=this.EuqUIAry[0],this.equClick(c)},c.prototype.refreshPartChg=function(b){this.EuqUIAry[b-1].data=a.NewStrengModel.getInstance().getGemvo(b),this.drawEqu(this.EuqUIAry[b-1],this.lastselect==b-1,a.StrengUtil.GEM),this.lastselect==b-1&&this.resetData(this.EuqUIAry[b-1].data),this.showExpEff()},c.prototype.refreshEqu=function(){for(var b=0;10>b;b++)this.drawEqu(this.EuqUIAry[b],this.lastselect==b,a.StrengUtil.GEM)},c.prototype.showExpEff=function(){var a=this;this._effRender||(this._effRender=new FrameUIRender,this.addRender(this._effRender),this._effRender.setImg(getEffectUIUrl("ui_qh"),4,4,function(b){a.expEff=b,a.seteffsize(),a.expEff.speed=3,a.expEff.playOne(a)})),this.expEff&&(this.seteffsize(),this.expEff.playOne(this))},c.prototype.seteffsize=function(){console.log("this._clickId==============",this._clickId);var a=this._clickId-1;a>=0&&a<this.GemUIIconAry.length&&(this.expEff.x=this.GemUIIconAry[a].x-58,this.expEff.y=this.GemUIIconAry[a].y-58,this.expEff.width=1.5*this.expEff.baseRec.width,this.expEff.height=1.5*this.expEff.baseRec.height)},c.prototype.drawEqu=function(b,c,d){var e=b.data,f=GuidData.bag.getEquByPart(e[0].partid),g=[e[0].state,e[1].state,e[2].state];f?a.StrengUtil.setEquIcon(b,geteqiconIconUrl(f.entryData.icon),g,c,d,f.entryData.quality,f.entryData.level):a.StrengUtil.setEquNoIcon(b,e[0].partid,g,c,d)},c.prototype.equClick=function(b){for(var c=0;c<this.EuqUIAry.length;c++)this.EuqUIAry[c]==b.target?(this.lastselect=c,this.drawEqu(this.EuqUIAry[c],!0,a.StrengUtil.GEM)):this.drawEqu(this.EuqUIAry[c],!1,a.StrengUtil.GEM);this.resetData(b.target.data)},c.prototype.resetData=function(b){this.t_curequ.data=b,this._vo=b,this.drawEqu(this.t_curequ,!1,a.StrengUtil.GENERAL),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.t_curname.skinName,a.StrengUtil.equProp[b[0].partid-1]+"部位",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.setUiListVisibleByItem(this.GemUIArrowAry,!1);for(var c=new Array,d=0;3>d;d++)if(d<this._vo.length){if(IconManager.getInstance().drawItemIcon60(this.GemUIIconAry[d],this._vo[d].curtab.cost[0][0]),2!=this._vo[d].state){var e=0==this._vo[d].gemlev?1:this._vo[d].gemlev;LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.GemUILevAry[d].skinName,ColorType.Orange7a2f21+"等级:  "+ColorType.color9a683f+e,14,TextAlign.LEFT,ColorType.Brown7a2f21),UiDraw.drawAttVal(this.GemUIattrAry[d],this._vo[d].curtab.props[0][0],this._vo[d].curtab.props[0][1],TextAlign.LEFT,!0);var f=this._vo[d].nexttab?this._vo[d].nexttab:this._vo[d].curtab;LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.GemUICostAry[d].skinName,ColorType.Orange7a2f21+"消耗:  "+ColorType.color9a683f+f.cost[0][1]+"个"+GameData.getPropName(f.cost[0][0]),14,TextAlign.LEFT,ColorType.Brown7a2f21),c.push(UiDraw.drawResHasNumAndAllNum(this.GemUIHasAry[d],f.cost[0],"拥有:")),3==this._vo[d].state?(LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.GemUILevAry_n[d].skinName,ColorType.Orange7a2f21+"等级:  "+ColorType.color9a683f+(e+1),14,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.GemUIattrAry_n[d].skinName,ColorType.Green2ca937+"+"+Snum(Math.floor(f.props[0][1]/100)),14,TextAlign.LEFT),this.setUiListVisibleByItem([this.GemUIArrowAry[d]],!0)):(UiDraw.clearUI(this.GemUILevAry_n[d]),UiDraw.clearUI(this.GemUIattrAry_n[d]))}else LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.GemUILevAry[d].skinName,ColorType.Orange7a2f21+"等级:  "+ColorType.color9a683f+1,14,TextAlign.LEFT,ColorType.Brown7a2f21),UiDraw.drawAttVal(this.GemUIattrAry[d],this._vo[d].curtab.props[0][0],this._vo[d].curtab.props[0][1],TextAlign.LEFT,!0),UiDraw.clearUI(this.GemUICostAry[d]),UiDraw.clearUI(this.GemUIHasAry[d]),UiDraw.clearUI(this.GemUILevAry_n[d]),UiDraw.clearUI(this.GemUIattrAry_n[d]);this.drawBtn(this._vo[d],d)}else UiDraw.clearUI(this.GemUIIconAry[d]),UiDraw.clearUI(this.GemUIattrAry[d]),UiDraw.clearUI(this.GemUICostAry[d]),UiDraw.clearUI(this.GemUIHasAry[d]),UiDraw.clearUI(this.GemUILevAry[d]),UiDraw.clearUI(this.UnlockUIAry[d]),UiDraw.clearUI(this.BtnUIAry[d]),UiDraw.clearUI(this.BtnUIAry[d+3]),UiDraw.clearUI(this.GemUILevAry_n[d]),UiDraw.clearUI(this.GemUIattrAry_n[d]);this._canbuyary=c;var g=RedPointManager.getInstance().getNodeByID(44).children;if(g[b[0].partid-1].show){for(var h=0;h<b.length;h++)if(this._redbtnary[h].preHide(),1==b[h].state||3==b[h].state){for(var i=b[h].nexttab?b[h].nexttab:b[h].curtab,j=new Array,k=0;k<i.cost.length;k++)j.push(hasEnoughResItem(i.cost[k]));for(var l=!0,m=0;m<j.length;m++)j[m]||(l=!1,m=j.length);l&&(this._redbtnary[h].preShow(),console.log("---红点zhanshi--",this._redbtnary[h]))}}else this._redbtnary[0].preHide(),this._redbtnary[1].preHide(),this._redbtnary[2].preHide()},c.prototype.drawPic=function(a,b){var c=this;IconManager.getInstance().getIcon(getgemIconUrl(b.gemid),function(b){var d=c._baseRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(b,0,0,60,60,4,4,60,60),c._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},c.prototype.drawBtn=function(b,c){if(this.setUiListVisibleByItem([this.UnlockUIAry[c]],2==b.state||4==b.state),this.setUiListVisibleByItem([this.BtnUIAry[c],this.BtnUIAry[c+3]],1==b.state||3==b.state),1==b.state)this.BtnUIAry[c+3].goToAndStop(1);else if(2==b.state)for(var d=tb.TB_equipdevelop_gem_part.get_TB_equipdevelop_gem_partById(b.partid),e=0;e<d.gem_array.length;e++){if(d.unlock_refine_lv[e]>a.NewStrengModel.getInstance().getrefiningvo(b.partid).partlevstar[0]){LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.UnlockUIAry[c].skinName,a.StrengUtil.equProp[b.partid-1]+"部位精炼达到"+(d.unlock_refine_lv[e]+1)+"段解锁",14,TextAlign.RIGHT,ColorType.Brown7a2f21);break}if(d.unlock_strength_lv[e]>a.NewStrengModel.getInstance().getstrengvo(b.partid).partlev){LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.UnlockUIAry[c].skinName,a.StrengUtil.equProp[b.partid-1]+"部位强化+"+d.unlock_strength_lv[e]+"解锁",14,TextAlign.RIGHT,ColorType.Brown7a2f21);break}}else 3==b.state?this.BtnUIAry[c+3].goToAndStop(0):(UiDraw.clearUI(this.GemUICostAry[c]),UiDraw.clearUI(this.GemUIHasAry[c]),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.UnlockUIAry[c].skinName,"已满级",14,TextAlign.RIGHT,ColorType.Brown7a2f21))},c.prototype.drawAddValRight=function(a,b){var c=a.uiRender.uiAtlas.getRec(a.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.ARROW_RIGHT,new Rectangle(0,3,16,12),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(d,b,14,22,0,TextAlign.LEFT,ColorType.Green2ca937),a.uiRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.butClik=function(a){var b=this;if(this._canclick)switch(UiTweenScale.getInstance().changeButSize(a.target),this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._clickId=-1,b._canclick=!0}),a.target){case this.btn0:this.senduplevgem(this._vo[0],this._canbuyary[0],0);break;case this.btn1:this.senduplevgem(this._vo[1],this._canbuyary[1],1);break;case this.btn2:this.senduplevgem(this._vo[2],this._canbuyary[2],2)}},c.prototype.senduplevgem=function(a,b,c){if(b){var d;1==a.state?d=SharedDef.EQUIPDEVELOP_TYPE_GEM_ACTIVE:3==a.state&&(d=SharedDef.EQUIPDEVELOP_TYPE_GEM_LVUP),this._clickId=a.index,NetManager.getInstance().protocolos.equipdevelop_operate(d,a.partid,a.index,"","")}else{var e=this._vo[c].nexttab?this._vo[c].nexttab:this._vo[c].curtab,f=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);f.data=e.cost[0][0],ModuleEventManager.dispatchEvent(f)}},c}(UIVirtualContainer);a.StrengTab2=b}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._canclick=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this._effRender&&(this._effRender.dispose(),this._effRender=null)},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.EuqUIAry=new Array,this.StarUIAry=new Array;for(var b=0;10>b;b++){var c=this.addChild(this._topRender.getComponent("t_equ"+b));c.addEventListener(InteractiveEvent.Down,this.equClick,this),this.EuqUIAry.push(c),this._redPointRender.getRedPointUI(this,92+b,new Vector2D(c.x+c.width,c.y)),this.StarUIAry.push(this.addChild(this._topRender.getComponent("b_star"+b)))}this.t_curequ=this.addChild(a.getComponent("t_curequ")),this.t_curname=this.addChild(a.getComponent("t_curname")),this.CostItemUIAry=new Array,this.CostItemUIAry.push(this.addChild(a.getComponent("t_costitem0"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costitem1"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costnum0"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costnum1"))),this.addUIList(["t_costinfo","b_bg3_2","b_bg3_1","b_bg3_0"],this._baseRender),this.b_attr0=this.addChild(a.getComponent("b_attr0")),this.b_attr1=this.addChild(a.getComponent("b_attr1")),this.b_attr2=this.addChild(a.getComponent("b_attr2")),this.b_nextattr1=this.addChild(a.getComponent("b_nextattr1")),this.b_nextattr0=this.addChild(a.getComponent("b_nextattr0")),this.b_nextattr2=this.addChild(a.getComponent("b_nextattr2")),this.a_curlev=this.addChild(a.getComponent("a_curlev")),this.a_maxlevinfo=this.addChild(a.getComponent("a_maxlevinfo")),this.b_okrare=this.addChild(a.getComponent("b_okrare")),this.BtnUIAry=new Array,this.BtnUIAry.push(this.addChild(a.getComponent("b_btntxt"))),this.BtnUIAry.push(this.addChild(a.getComponent("b_info1"))),this.BtnUIAry.push(this.addChild(a.getComponent("b_txtbg"))),this.BtnUIAry.push(this.addChild(this._topRender.getComponent("b_okrare_txt"))),this.BtnUIAry.push(this.b_okrare),this.cnew_btn=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn,"btnBg",a),this.BtnUIAry.push(this.cnew_btn),this._publicRender.applyObjData(),this._btnRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.cnew_btn.x+this.cnew_btn.width,this.cnew_btn.y))},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.InitEqu(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.InitEqu=function(){for(var b=0;10>b;b++)this.EuqUIAry[b].data=a.NewStrengModel.getInstance().getrefiningvo(b+1);var c=new InteractiveEvent(InteractiveEvent.Down);c.target=this.EuqUIAry[0],this.equClick(c)},c.prototype.refreshPartChg=function(b){this.EuqUIAry[b-1].data=a.NewStrengModel.getInstance().getrefiningvo(b),this.drawEqu(this.EuqUIAry[b-1],this.lastselect==b-1,a.StrengUtil.REFINING),this.lastselect==b-1&&this.resetData(this.EuqUIAry[b-1].data)},c.prototype.showExpEff=function(){var a=this;this._effRender||(this._effRender=new FrameUIRender,this.addRender(this._effRender),this._effRender.setImg(getEffectUIUrl("ui_qh"),4,4,function(b){a.expEff=b,a.expEff.x=a.t_curequ.x-58,a.expEff.y=a.t_curequ.y-58,a.expEff.width=1.5*a.expEff.baseRec.width,a.expEff.height=1.5*a.expEff.baseRec.height,a.expEff.speed=3,a.expEff.playOne(a)})),this.expEff&&this.expEff.playOne(this)},c.prototype.refreshEqu=function(){for(var b=0;10>b;b++)this.drawEqu(this.EuqUIAry[b],this.lastselect==b,a.StrengUtil.REFINING)},c.prototype.drawEqu=function(b,c,d){var e=b.data,f=GuidData.bag.getEquByPart(e.partid);f?a.StrengUtil.setEquIcon(b,geteqiconIconUrl(f.entryData.icon),e.partlevstar,c,d,f.entryData.quality,f.entryData.level):a.StrengUtil.setEquNoIcon(b,e.partid,e.partlevstar,c,d)},c.prototype.equClick=function(b){for(var c=0;c<this.EuqUIAry.length;c++)this.EuqUIAry[c]==b.target?(this.lastselect=c,this.drawEqu(this.EuqUIAry[c],!0,a.StrengUtil.REFINING)):this.drawEqu(this.EuqUIAry[c],!1,a.StrengUtil.REFINING);this.resetData(b.target.data)},c.prototype.resetData=function(b){this.t_curequ.data=b,this._vo=b,this.drawEqu(this.t_curequ,!1,a.StrengUtil.GENERAL),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.t_curname.skinName,a.StrengUtil.equProp[b.partid-1]+"部位",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.drawResItem();for(var c=0;10>c;c++)b.partlevstar[1]>c?this.StarUIAry[c].goToAndStop(0):this.StarUIAry[c].goToAndStop(1);LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_curlev.skinName,"精炼等级：  "+b.partlevstar[0]+"段"+b.partlevstar[1]+"星",16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_attr0.skinName,"精炼等级   "+ColorType.color9a683f+b.partlevstar[0]+"段"+b.partlevstar[1]+"星",14,TextAlign.RIGHT,ColorType.Brown7a2f21),UiDraw.drawAttVal(this.b_attr1,b.curtab.props[0][0],b.curtab.props[0][1],TextAlign.RIGHT),UiDraw.drawAttVal(this.b_attr2,b.curtab.props[1][0],b.curtab.props[1][1],TextAlign.RIGHT),b.nexttab?(LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_okrare.skinName,b.nexttab.chance+"%",16,TextAlign.CENTER,ColorType.colorce0a00),this.drawAddValRight(this.b_nextattr0,ColorType.color9a683f+b.nexttab.rank+"段"+b.nexttab.star+"星"),UiDraw.drawAddValRight(this.b_nextattr1,b.nexttab.props[0][1],!1,TextAlign.LEFT),UiDraw.drawAddValRight(this.b_nextattr2,b.nexttab.props[1][1],!1,TextAlign.LEFT)):(UiDraw.clearUI(this.b_nextattr0),UiDraw.clearUI(this.b_nextattr1),UiDraw.clearUI(this.b_nextattr2)),this.b_attr0.x=b.nexttab?379:433,this.b_attr1.x=this.b_attr0.x,this.b_attr2.x=this.b_attr0.x,this.setUiListVisibleByItem([this.a_maxlevinfo],0==b.state),this.setUiListVisibleByItem(this.BtnUIAry,0!=b.state);var d=RedPointManager.getInstance().getNodeByID(41).children;d[b.partid-1].show?this._btnRedPoint.preShow():this._btnRedPoint.preHide()},c.prototype.drawResItem=function(){for(var a=new Array,b=this._vo.nexttab?this._vo.nexttab:this._vo.curtab,c=0;2>c;c++)c<b.cost.length?(IconManager.getInstance().drawItemIcon40(this.CostItemUIAry[c],b.cost[c][0]),a.push(UiDraw.drawResHasNumAndAllNum(this.CostItemUIAry[c+2],b.cost[c])),this.CostItemUIAry[0].x=1==b.cost.length?528:484,this.CostItemUIAry[2].x=1==b.cost.length?516:463):(UiDraw.clearUI(this.CostItemUIAry[c+2]),UiDraw.clearUI(this.CostItemUIAry[c]));this._canbuy=a},c.prototype.drawAddValRight=function(a,b){var c=a.uiRender.uiAtlas.getRec(a.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.ARROW_RIGHT,new Rectangle(0,3,16,12),UIData.publicUi),LabelTextFont.writeSingleLabelToCtx(d,b,14,22,0,TextAlign.LEFT,ColorType.Green2ca937),a.uiRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.cnew_btn:this.sendStreng(1)}},c.prototype.sendStreng=function(a){var b=this;if(this._canclick){this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0});var c,d,e=this._vo.nexttab?this._vo.nexttab:this._vo.curtab;if(2==this._canbuy.length?(c=this._canbuy[0]&&this._canbuy[1],c||(d=this._canbuy[0]?e.cost[1][0]:e.cost[0][0])):(c=this._canbuy[0],c||(d=e.cost[0][0])),c){var f;1==this._vo.curtab.lvup_type?f=SharedDef.EQUIPDEVELOP_TYPE_REFINE_STAR_LVUP:2==this._vo.curtab.lvup_type&&(f=SharedDef.EQUIPDEVELOP_TYPE_REFINE_RANK_LVUP),NetManager.getInstance().protocolos.equipdevelop_operate(f,this._vo.partid,1,"","")}else{var g=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);g.data=d,ModuleEventManager.dispatchEvent(g)}}},c}(UIVirtualContainer);a.StrengTab1=b}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._canclick=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this._effRender&&(this._effRender.dispose(),this._effRender=null)},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.EuqUIAry=new Array;for(var b=0;10>b;b++){var c=this.addChild(this._topRender.getComponent("t_equ"+b));c.addEventListener(InteractiveEvent.Down,this.equClick,this),this.EuqUIAry.push(c),this._redPointRender.getRedPointUI(this,82+b,new Vector2D(c.x+c.width,c.y))}this.t_curequ=this.addChild(a.getComponent("t_curequ")),this.t_curname=this.addChild(a.getComponent("t_curname")),this.CostItemUIAry=new Array,this.CostItemUIAry.push(this.addChild(a.getComponent("t_costitem0"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costitem1"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costnum0"))),this.CostItemUIAry.push(this.addChild(a.getComponent("t_costnum1"))),this.addUIList(["t_costinfo","a_info","t_bg3_1","t_bg3_0"],this._baseRender),this.a_attr0=this.addChild(a.getComponent("a_attr0")),this.a_attr1=this.addChild(a.getComponent("a_attr1")),this.a_nextattr1=this.addChild(a.getComponent("a_nextattr1")),this.a_nextattr0=this.addChild(a.getComponent("a_nextattr0")),this.a_curlev=this.addChild(a.getComponent("a_curlev")),this.a_maxlevinfo=this.addChild(a.getComponent("a_maxlevinfo")),this.BtnUIAry=new Array,this.BtnUIAry.push(this.addChild(a.getComponent("a_btntxt1"))),this.BtnUIAry.push(this.addChild(a.getComponent("a_btntxt2"))),this.cnew_btn0=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn0,"btnBg0",a),this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg1",a),this.BtnUIAry.push(this.cnew_btn0),this.BtnUIAry.push(this.cnew_btn1),this._publicRender.applyObjData(),this._btn1RedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.cnew_btn0.x+this.cnew_btn0.width,this.cnew_btn0.y)),this._btn0RedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.cnew_btn1.x+this.cnew_btn1.width,this.cnew_btn1.y))},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.showExpEff=function(){var a=this;this._effRender||(this._effRender=new FrameUIRender,this.addRender(this._effRender),this._effRender.setImg(getEffectUIUrl("ui_qh"),4,4,function(b){a.expEff=b,a.expEff.x=a.t_curequ.x-58,a.expEff.y=a.t_curequ.y-58,a.expEff.width=1.5*a.expEff.baseRec.width,a.expEff.height=1.5*a.expEff.baseRec.height,a.expEff.speed=3,a.expEff.playOne(a)})),this.expEff&&this.expEff.playOne(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.InitEqu(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.InitEqu=function(){for(var b=0;10>b;b++)this.EuqUIAry[b].data=a.NewStrengModel.getInstance().getstrengvo(b+1);var c=new InteractiveEvent(InteractiveEvent.Down);c.target=this.EuqUIAry[0],this.equClick(c)},c.prototype.refreshPartChg=function(b){this.EuqUIAry[b-1].data=a.NewStrengModel.getInstance().getstrengvo(b),this.drawEqu(this.EuqUIAry[b-1],this.lastselect==b-1,a.StrengUtil.STRENG),this.lastselect==b-1&&this.resetData(this.EuqUIAry[b-1].data)},c.prototype.refreshEqu=function(){for(var b=0;10>b;b++)this.drawEqu(this.EuqUIAry[b],this.lastselect==b,a.StrengUtil.STRENG)},c.prototype.drawEqu=function(b,c,d){var e=b.data,f=GuidData.bag.getEquByPart(e.partid);f?a.StrengUtil.setEquIcon(b,geteqiconIconUrl(f.entryData.icon),[e.partlev],c,d,f.entryData.quality,f.entryData.level):a.StrengUtil.setEquNoIcon(b,e.partid,[e.partlev],c,d)},c.prototype.equClick=function(b){for(var c=0;c<this.EuqUIAry.length;c++)this.EuqUIAry[c]==b.target?(this.lastselect=c,this.drawEqu(this.EuqUIAry[c],!0,a.StrengUtil.STRENG)):this.drawEqu(this.EuqUIAry[c],!1,a.StrengUtil.STRENG);this.resetData(b.target.data)},c.prototype.resetData=function(b){this.t_curequ.data=b,this._vo=b,this.drawEqu(this.t_curequ,!1,a.StrengUtil.GENERAL),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.t_curname.skinName,a.StrengUtil.equProp[b.partid-1]+"部位",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.drawResItem(),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_curlev.skinName,"强化等级  +"+b.partlev,16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_attr0.skinName,"强化等级  +"+b.partlev,14,TextAlign.RIGHT,ColorType.Brown7a2f21),UiDraw.drawAttVal(this.a_attr1,b.curtab.props[0][0],b.curtab.props[0][1],TextAlign.RIGHT),b.nexttab?(this.drawAddValRight(this.a_nextattr0,b.partlev+1,TextAlign.LEFT),UiDraw.drawAddValRight(this.a_nextattr1,b.nexttab.props[0][1],!1,TextAlign.LEFT)):(UiDraw.clearUI(this.a_nextattr0),UiDraw.clearUI(this.a_nextattr1)),this.a_attr0.x=b.nexttab?393:430,this.a_attr1.x=this.a_attr0.x,this.setUiListVisibleByItem([this.a_maxlevinfo],0==b.state),this.setUiListVisibleByItem(this.BtnUIAry,0!=b.state);var c=RedPointManager.getInstance().getNodeByID(38).children;c[b.partid-1].show?(this._btn0RedPoint.preShow(),this._btn1RedPoint.preShow()):(this._btn0RedPoint.preHide(),this._btn1RedPoint.preHide())},c.prototype.drawAddValRight=function(a,b,c){if(void 0===c&&(c=TextAlign.RIGHT),b>=0){var d=a.uiRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.ARROW_RIGHT,new Rectangle(0,3,16,12),UIData.publicUi);var f="+"+b,g=0;c==TextAlign.LEFT&&(g=22),LabelTextFont.writeSingleLabelToCtx(e,f,14,g,0,c,ColorType.Green2ca937),a.uiRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)}else UiDraw.clearUI(a)},c.prototype.drawResItem=function(){for(var a=new Array,b=this._vo.nexttab?this._vo.nexttab:this._vo.curtab,c=0;2>c;c++)c<b.cost.length?(IconManager.getInstance().drawItemIcon40(this.CostItemUIAry[c],b.cost[c][0]),a.push(UiDraw.drawResHasNumAndAllNum(this.CostItemUIAry[c+2],b.cost[c])),this.CostItemUIAry[0].x=1==b.cost.length?528:484,this.CostItemUIAry[2].x=1==b.cost.length?516:463):(UiDraw.clearUI(this.CostItemUIAry[c+2]),UiDraw.clearUI(this.CostItemUIAry[c]));this._canbuy=a},c.prototype.butClik=function(b){var c=this;if(this._canclick)switch(UiTweenScale.getInstance().changeButSize(b.target),this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){c._canclick=!0}),b.target){case this.cnew_btn0:for(var d,e=!1,f=1e3,g=0;10>g;g++){var h=a.NewStrengModel.getInstance().getstrengvo(g+1);if(1==h.state&&h.partlev<GuidData.player.getLevel()){for(var i=h.nexttab?h.nexttab:h.curtab,j=new Array,k=0;k<i.cost.length;k++)j.push(hasEnoughResItem(i.cost[k]));for(var l=!0,m=0;m<j.length;m++)if(!j[m]){l=!1;break}if(e=l)break;f>h.partlev&&(f=h.partlev,d=g)}}if(e)NetManager.getInstance().protocolos.equipdevelop_operate(SharedDef.EQUIPDEVELOP_TYPE_STRENGTH_ALL,0,0,"","");else{if(1e3==f)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"不可超过人物等级",99);var n=a.NewStrengModel.getInstance().getstrengvo(d+1),o=n.nexttab?n.nexttab:n.curtab,p=hasEnoughResItem(o.cost[0])?o.cost[1][0]:o.cost[0][0],q=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);q.data=p,ModuleEventManager.dispatchEvent(q)}UIManager.popClikNameFun("cnew_btn1");break;case this.cnew_btn1:if(this._vo.partlev>=GuidData.player.getLevel())return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"不可超过人物等级",99);this.sendStreng(1),UIManager.popClikNameFun("cnew_btn1")}},c.prototype.sendStreng=function(a){var b,c,d=this._vo.nexttab?this._vo.nexttab:this._vo.curtab;if(2==this._canbuy.length?(b=this._canbuy[0]&&this._canbuy[1],b||(c=this._canbuy[0]?d.cost[1][0]:d.cost[0][0])):(b=this._canbuy[0],b||(c=d.cost[0][0])),b)NetManager.getInstance().protocolos.equipdevelop_operate(SharedDef.EQUIPDEVELOP_TYPE_STRENGTH_LVUP,this._vo.partid,a,"","");else{var e=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);e.data=c,ModuleEventManager.dispatchEvent(e)}},c}(UIVirtualContainer);a.StrengTab0=b}(strengthgem||(strengthgem={}));var strengthgem;!function(a){var b=function(){function a(){}return a}();a.WashVo=b;var c=function(){function a(){}return a}();a.StrengVo=c;var d=function(){function a(){}return a}();a.RefiningVo=d;var e=function(){function a(){}return a}();a.GemVo=e;var f=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getstrengvo=function(a){var b=new c;b.partid=a,b.partlev=GuidData.grow.getPartStrengLev(a),b.curtab=tb.TB_equipdevelop_strength.get_TB_equipdevelop_strengthById(a,b.partlev);var d=TableData.getInstance().getData(TableData.tb_equipdevelop_strength,1e3*a+b.partlev+1);return d?(b.state=1,b.nexttab=tb.TB_equipdevelop_strength.get_TB_equipdevelop_strengthById(a,b.partlev+1)):b.state=0,b},a.prototype.getrefiningvo=function(a){var b=new d;return b.partid=a,b.partlevstar=GuidData.grow.getPartRefineVo(a),b.curtab=tb.TB_equipdevelop_refine.get_TB_equipdevelop_refineById(a,b.partlevstar[0],b.partlevstar[1]),0==b.curtab.lvup_type?b.state=0:(b.state=1,2==b.curtab.lvup_type?b.nexttab=tb.TB_equipdevelop_refine.get_TB_equipdevelop_refineById(a,b.partlevstar[0]+1,1):b.nexttab=tb.TB_equipdevelop_refine.get_TB_equipdevelop_refineById(a,b.partlevstar[0],b.partlevstar[1]+1)),b},a.prototype.getGemvo=function(a,b){void 0===b&&(b=null);var c=tb.TB_equipdevelop_gem_part.get_TB_equipdevelop_gem_partById(a);b||(b=GuidData.grow.getPartGemVo(a));for(var d=new Array,f=0;f<b.length;f++){var g=new e;g.index=f+1,g.partid=a,g.gemid=c.gem_array[f],g.gemlev=b[f];var h=TableData.getInstance().getData(TableData.tb_equipdevelop_gem,1e3*g.gemid+g.gemlev+1),i=g.gemlev;if(0==g.gemlev){var j=GuidData.grow.getPartRefineVo(a);c.unlock_strength_lv[f]<=GuidData.grow.getPartStrengLev(a)&&j[0]>=c.unlock_refine_lv[f]?(g.state=1,i=1,g.nexttab=tb.TB_equipdevelop_gem.get_TB_equipdevelop_gemById(g.gemid,1)):(i=1,g.state=2)}else null==h?g.state=4:(g.state=3,g.nexttab=tb.TB_equipdevelop_gem.get_TB_equipdevelop_gemById(g.gemid,g.gemlev+1));g.curtab=tb.TB_equipdevelop_gem.get_TB_equipdevelop_gemById(g.gemid,i),d.push(g)}return d},a}();a.NewStrengModel=f;var g=function(){function a(){}return a.setEquIcon=function(b,c,d,e,f,g,h){c&&IconManager.getInstance().getIcon(c,function(c){var i=b.uiRender.uiAtlas.getRec(b.skinName),j=UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1);if(UiDraw.cxtDrawImg(j,PuiData.PropBg60,new Rectangle(4,0,68,68),UIData.publicUi),console.log("---$que--",g),UiDraw.cxtDrawImg(j,ItemGoodQuality.getQuaStr(g),new Rectangle(4,0,68,68),UIData.publicUi),j.drawImage(c,0,0,60,60,8,4,60,60),UiDraw.cxtDrawImg(j,PuiData.A_EQULEVBG,new Rectangle(8,4,41,17),UIData.publicUi),ArtFont.getInstance().writeFontToCtxCenten(j,String(h),ArtFont.num63,20,4,4),e&&UiDraw.cxtDrawImg(j,PuiData.Select,new Rectangle(4,0,68,68),UIData.publicUi),f==a.STRENG){var k=b.uiRender.uiAtlas.getRec("LevBg");j.drawImage(b.uiRender.uiAtlas.useImg,k.pixelX,k.pixelY,k.pixelWitdh,k.pixelHeight,42,53,k.pixelWitdh,k.pixelHeight),LabelTextFont.writeSingleLabelToCtx(j,ColorType.Whiteffffff+"+"+d[0],14,-8,53,TextAlign.RIGHT)}else if(f==a.REFINING){var l=b.uiRender.uiAtlas.getRec("DanBg");j.drawImage(b.uiRender.uiAtlas.useImg,l.pixelX,l.pixelY,l.pixelWitdh,l.pixelHeight,0,72-l.pixelHeight,l.pixelWitdh,l.pixelHeight);var m=b.uiRender.uiAtlas.getRec("StarBg");j.drawImage(b.uiRender.uiAtlas.useImg,m.pixelX,m.pixelY,m.pixelWitdh,m.pixelHeight,49,72-m.pixelHeight,m.pixelWitdh,m.pixelHeight),LabelTextFont.writeSingleLabelToCtxSetAnchor(j,ColorType.color4c1c07+d[0],14,14,49,TextAlign.CENTER),LabelTextFont.writeSingleLabelToCtxSetAnchor(j,ColorType.color4c1c07+d[1],14,64,49,TextAlign.CENTER)}else if(f==a.GEM)for(var n=0;n<d.length;n++){var o=d[n]<3?"Lightdown":"Lightup",p=b.uiRender.uiAtlas.getRec(o);j.drawImage(b.uiRender.uiAtlas.useImg,p.pixelX,p.pixelY,p.pixelWitdh,p.pixelHeight,17+15*n,52,p.pixelWitdh,p.pixelHeight)}b.uiRender.uiAtlas.updateCtx(j,i.pixelX,i.pixelY)})},a.setEquNoIcon=function(b,c,d,e,f){var g=b.uiRender.uiAtlas.getRec(b.skinName),h=UIManager.getInstance().getContext2D(g.pixelWitdh,g.pixelHeight,!1);UiDraw.cxtDrawImg(h,PuiData.PropBg60,new Rectangle(4,0,68,68),UIData.publicUi),e&&UiDraw.cxtDrawImg(h,PuiData.Select,new Rectangle(4,0,68,68),UIData.publicUi);var i=-4;if(f==a.STRENG){var j=b.uiRender.uiAtlas.getRec("LevBg");h.drawImage(b.uiRender.uiAtlas.useImg,j.pixelX,j.pixelY,j.pixelWitdh,j.pixelHeight,42,53,j.pixelWitdh,j.pixelHeight),LabelTextFont.writeSingleLabelToCtx(h,ColorType.Whiteffffff+"+"+d[0],14,-8,53,TextAlign.RIGHT)}else if(f==a.REFINING){var k=b.uiRender.uiAtlas.getRec("DanBg");h.drawImage(b.uiRender.uiAtlas.useImg,k.pixelX,k.pixelY,k.pixelWitdh,k.pixelHeight,0,72-k.pixelHeight,k.pixelWitdh,k.pixelHeight);var l=b.uiRender.uiAtlas.getRec("StarBg");h.drawImage(b.uiRender.uiAtlas.useImg,l.pixelX,l.pixelY,l.pixelWitdh,l.pixelHeight,49,72-l.pixelHeight,l.pixelWitdh,l.pixelHeight),LabelTextFont.writeSingleLabelToCtxSetAnchor(h,ColorType.color4c1c07+d[0],14,14,49,TextAlign.CENTER),LabelTextFont.writeSingleLabelToCtxSetAnchor(h,ColorType.color4c1c07+d[1],14,64,49,TextAlign.CENTER);
}else if(f==a.GEM)for(var m=0;m<d.length;m++){var n=d[m]<3?"Lightdown":"Lightup",o=b.uiRender.uiAtlas.getRec(n);h.drawImage(b.uiRender.uiAtlas.useImg,o.pixelX,o.pixelY,o.pixelWitdh,o.pixelHeight,17+15*m,52,o.pixelWitdh,o.pixelHeight)}LabelTextFont.writeSingleLabelToCtx(h,ColorType.Browndb39264+a.equProp[c-1],14,i+4,26,TextAlign.CENTER),b.uiRender.uiAtlas.updateCtx(h,g.pixelX,g.pixelY)},a.parseStr=function(a){for(var c=new b,d=a.split("|"),e=Number(d[1]),f=new Array,g=0;e>g;g++){var h=new Array,i=Number(d[3+3*g]),j=Number(d[4+3*g]),k=Number(d[5+3*g]);h.push(i),h.push(j),h.push(k),f.push(h)}return c.attrary=f,c.guid=d[0],c.partid=Number(d[2]),c},a.getMinMax=function(a,b){var c=tb.TB_item_template.get_TB_item_template(a);console.log("-----------$itemid-------",a,b,c.forge_pro);for(var d=0;d<c.forge_pro.length;d++)if(c.forge_pro[d][0]==b)return c.forge_pro[d];return null},a.GENERAL="GENERAL",a.STRENG="STRENG",a.REFINING="REFINING",a.GEM="GEM",a.KeyNameByType=["强化大师","精炼大师","镶嵌大师"],a.equProp=["武器","衣服","护手","腰带","鞋子","头饰","项链","手镯","戒指","腰坠"],a}();a.StrengUtil=g}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),strengthgem;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._roleRender=new UIRenderComponent,a.addRender(a._roleRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._publicbguiRender=new UIRenderComponent,a.addRender(a._publicbguiRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._roleRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._roleRender.dispose(),this._roleRender=null,this._topRender.dispose(),this._topRender=null,this._baseRender.dispose(),this._baseRender=null,this.strengTab0&&(this.strengTab0.dispose(),this.strengTab0=null),this.strengTab1&&(this.strengTab1.dispose(),this.strengTab1=null),this.strengTab2&&(this.strengTab2.dispose(),this.strengTab2=null),this.strengTab3&&(this.strengTab3.dispose(),this.strengTab3=null),this._redPointRender&&(this._redPointRender.dispose(),this._redPointRender=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicbguiRender.uiAtlas=WindowUi.winUIAtlas,this._roleRender.uiAtlas.setInfo("ui/uidata/streng/newstreng.xml","ui/uidata/streng/newstreng.png",function(){a.loadConfigCom()},"ui/uidata/streng/strengthuse.png")},c.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._roleRender.uiAtlas,this._baseRender.uiAtlas=this._roleRender.uiAtlas,this._topRender.uiAtlas=this._roleRender.uiAtlas,this.winmidRender.uiAtlas=this._publicbguiRender.uiAtlas,this.initData(),this.resize(),this.applyLoadComplete()},c.prototype.initData=function(){this.TabAry=new Array;for(var a=0;4>a;a++){var b=this.addChild(this._bgRender.getComponent("tab"+a));b.data=SharedDef.MODULE_MIX_STRENGTH+a,b.addEventListener(InteractiveEvent.Up,this.click,this),this.TabAry.push(b),this._redPointRender.getRedPointUI(this,38+3*a,new Vector2D(b.x+b.width-5,b.y))}this.MasterUIAry=new Array,this.MasterUIAry.push(this._bgRender.getComponent("b_txtbg")),this.t_rewardBtn=this.addEvntButUp("t_rewardBtn",this._roleRender),this.MasterUIAry.push(this.t_rewardBtn),this.MasterUIAry.push(this._roleRender.getComponent("t_curlev")),this.UnlockUIAry=new Array,this.t_unlock0=this.addEvntBut("t_unlock0",this._bgRender),this.UnlockUIAry.push(this.t_unlock0),this.t_unlock1=this.addEvntBut("t_unlock1",this._bgRender),this.UnlockUIAry.push(this.t_unlock1),this.t_unlock2=this.addEvntBut("t_unlock2",this._bgRender),this.UnlockUIAry.push(this.t_unlock2),this.t_unlock3=this.addEvntBut("t_unlock3",this._bgRender),this.UnlockUIAry.push(this.t_unlock3),this.OtherBgUIAry=new Array,this.OtherBgUIAry.push(this._bgRender.getComponent("t_bgleft")),this.OtherBgUIAry.push(this._bgRender.getComponent("t_bgcenter")),this.OtherBgUIAry.push(this._bgRender.getComponent("t_bgright")),this.OtherBgUIAry.push(this._roleRender.getComponent("t_huawenright"));var c=this._roleRender.getComponent("t_huawenleft");c.isU=!0,this.OtherBgUIAry.push(c),this.OtherBgUIAry.push(this._roleRender.getComponent("t_huawen1right"));var d=this._roleRender.getComponent("t_huawen1left");d.isU=!0,this.OtherBgUIAry.push(d),this._roleRender.applyObjData(),this.OtherBgUIAry.push(this._baseRender.getComponent("t_uparrow"));var e=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(e,"rightLinebg",this._roleRender);var f=this.addChild(this.winmidRender.getComponent("cnew_bg_yellow"));this.setSizeForPanelUiCopy(f,"a_leftbg_yellow",this._roleRender),this.winmidRender.applyObjData(),this.addUIList(["t_title","t_equBg"],this._bgRender),this.addUIList(["t_line"],this._baseRender)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.refreshOpenLev=function(){for(var a=new Array,b=0;b<SharedDef.MODULE_MIX_WASH;b++){var c=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_MIX+b+1));a.push(c)}for(var d=0;d<a.length;d++)a[d].level<=GuidData.player.getLevel()?(this.setUiListVisibleByItem([this.TabAry[d]],!0),this.setUiListVisibleByItem([this.UnlockUIAry[d]],!1)):(this.setUiListVisibleByItem([this.TabAry[d]],!1),this.setUiListVisibleByItem([this.UnlockUIAry[d]],!0),this.UnlockUIAry[d].data=a[d])},c.prototype.show=function(a){this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.refreshOpenLev(),this.selectedTab(a)},c.prototype.hide=function(){(!this.strengTab3||this.strengTab3.canshowAlert())&&(this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.hideTabPage(),ModulePageManager.hideResTittle())},c.prototype.selectedTab=function(a){this._lastvalue=a;for(var b=0;b<this.TabAry.length;b++)this.TabAry[b].data==a?this.TabAry[b].selected=!0:this.TabAry[b].selected=!1;this.setUiListVisibleByItem(this.OtherBgUIAry,a!=SharedDef.MODULE_MIX_GEM),this.setUiListVisibleByItem(this.MasterUIAry,a!=SharedDef.MODULE_MIX_WASH),this.hideTabPage(a),this.showTabPage(a)},c.prototype.showTabPage=function(b){this._type=b-1;var c=GuidData.grow.getMasterLevVo();switch(b){case SharedDef.MODULE_MIX_STRENGTH:this.strengTab0||(this.strengTab0=new a.StrengTab0,this.strengTab0.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.strengTab0.parent=this),this.strengTab0.show(),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.MasterUIAry[2].skinName,ColorType.color802626+a.StrengUtil.KeyNameByType[0]+":"+c[0]+"级",14,TextAlign.CENTER);break;case SharedDef.MODULE_MIX_POLISHED:this.strengTab1||(this.strengTab1=new a.StrengTab1,this.strengTab1.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.strengTab1.parent=this),this.strengTab1.show(),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.MasterUIAry[2].skinName,ColorType.color802626+a.StrengUtil.KeyNameByType[1]+":"+c[1]+"级",14,TextAlign.CENTER);break;case SharedDef.MODULE_MIX_GEM:this.strengTab2||(this.strengTab2=new a.StrengTab2,this.strengTab2.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.strengTab2.parent=this),this.strengTab2.show(),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.MasterUIAry[2].skinName,ColorType.color802626+a.StrengUtil.KeyNameByType[2]+":"+c[2]+"级",14,TextAlign.CENTER);break;case SharedDef.MODULE_MIX_WASH:this.strengTab3||(this.strengTab3=new a.StrengTab3,this.strengTab3.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas),this.strengTab3.parent=this),this.strengTab3.show()}},c.prototype.hideTabPage=function(a){switch(void 0===a&&(a=-1),a){case SharedDef.MODULE_MIX_STRENGTH:this.strengTab1&&this.strengTab1.hide(),this.strengTab2&&this.strengTab2.hide(),this.strengTab3&&this.strengTab3.hide();break;case SharedDef.MODULE_MIX_POLISHED:this.strengTab0&&this.strengTab0.hide(),this.strengTab2&&this.strengTab2.hide(),this.strengTab3&&this.strengTab3.hide();break;case SharedDef.MODULE_MIX_GEM:this.strengTab0&&this.strengTab0.hide(),this.strengTab1&&this.strengTab1.hide(),this.strengTab3&&this.strengTab3.hide();break;case SharedDef.MODULE_MIX_WASH:this.strengTab0&&this.strengTab0.hide(),this.strengTab1&&this.strengTab1.hide(),this.strengTab2&&this.strengTab2.hide();break;default:this.strengTab1&&this.strengTab1.hide(),this.strengTab0&&this.strengTab0.hide(),this.strengTab2&&this.strengTab2.hide(),this.strengTab3&&this.strengTab3.hide()}},c.prototype.refreshCurMasterLev=function(){var b=GuidData.grow.getMasterLevVo();LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.MasterUIAry[2].skinName,ColorType.color802626+a.StrengUtil.KeyNameByType[this._type]+":"+b[this._type]+"级",14,TextAlign.CENTER)},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.StrengthGemEvent(a.StrengthGemEvent.HIDE_STRENGTHGEM_PANEL));break;case this.t_rewardBtn:UiTweenScale.getInstance().changeButSize(b.target);var c=new a.StrengthGemEvent(a.StrengthGemEvent.SHOW_MASTER_TIPS_EVENT);c.data=this._lastvalue,ModuleEventManager.dispatchEvent(c);break;case this.t_unlock0:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock0.data.level+"级后解锁",99);break;case this.t_unlock1:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock1.data.level+"级后解锁",99);break;case this.t_unlock2:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock2.data.level+"级后解锁",99);break;case this.t_unlock3:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock3.data.level+"级后解锁",99)}},c.prototype.click=function(a){if(!this.strengTab3||this.strengTab3.canshowAlert())this.selectedTab(a.target.data),UIManager.popClikNameFun(a.target.name);else for(var b=0;b<this.TabAry.length;b++)3==b?this.TabAry[b].selected=!0:this.TabAry[b].selected=!1},c}(WindowUi);a.NewStrengUiPanel=b}(strengthgem||(strengthgem={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Hangup;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._lastMouseX=0,a._lastMcX=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.right=0,a.middle=0,a.setBlackBg(),a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._baseRender.uiAtlas.setInfo("ui/uidata/hangup/hangupsetting.xml","ui/uidata/hangup/hangupsetting.png",function(){a.loadConfigCom()},"ui/uidata/hangup/hanguppc.png")},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._baseRender.uiAtlas,this._topRender.uiAtlas=this._baseRender.uiAtlas,this.addUIList(["a_bg0","a_info4","a_info6_1","a_info6","a_info5","a_info2","a_info0","a_info1","a_bar_bg","a_bar_bg_1"],this._bottomRender),this.addUIList(["a_bg1","a_bg2","a_title"],this._baseRender),this.addChild(this._topRender.getComponent("a_info3")),this.a_selectbtn0=this.addEvntButUp("a_selectbtn0",this._baseRender),this.a_selectbtn1=this.addEvntButUp("a_selectbtn1",this._baseRender),this.a_selectbtn2=this.addEvntButUp("a_selectbtn2",this._baseRender),this.a_selectbtn3=this.addEvntButUp("a_selectbtn3",this._baseRender),this.a_selectbtn4=this.addEvntButUp("a_selectbtn4",this._baseRender),this.a_servername=this.addChild(this._topRender.getComponent("a_servername")),this.a_usename=this.addChild(this._topRender.getComponent("a_usename")),this.a_useid=this.addChild(this._topRender.getComponent("a_useid")),this.a_bar_red=this.addChild(this._baseRender.getComponent("a_bar_red")),this.a_bar_red_1=this.addChild(this._baseRender.getComponent("a_bar_red_1")),this.a_bar_bg_line=this.addChild(this._bottomRender.getComponent("a_bar_bg_line")),this.a_bar=this.addEvntBut("a_bar",this._topRender),this.a_bar_1=this.addEvntBut("a_bar_1",this._topRender),this.applyLoadComplete()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_servername.skinName,"服务器名： "+GameInstance.sid,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_usename.skinName,"角色名： "+getBaseName(GuidData.player.getName()),16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_useid.skinName,"角色ID： "+this.getuseridstr(),16,TextAlign.LEFT,ColorType.Brown7a2f21),this.setTargetState(this.a_selectbtn0,GameData.configData.block_other_plr),this.setTargetState(this.a_selectbtn1,GameData.configData.block_effect_ski),this.setTargetState(this.a_selectbtn2,GameData.configData.block_plr_flyword),this.refreshDrawUseIcon(GameData.configData.block_volume_set),this.refreshDrawUseIconCopy(GameData.configData.block_sound_set)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.getuseridstr=function(){var a=GuidData.player.getGuid();a=a.split("p")[1];var b=a.split("."),c=b[1].split("_"),d="";if(c[0].length<3)for(var e=0;e<3-c[0].length;e++)d+="0";if(d+=c[0],c[1].length<6)for(var e=0;e<6-c[1].length;e++)d+="0";return d+c[1]+b[0]},c.prototype.barMouseDown=function(a){this._lastMouseX=a.x,this._lastMcX=a.target==this.a_bar?this.a_bar.x:this.a_bar_1.x,this._MouseDownEvt=a.target,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.barMouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.barMouseUp,this)},c.prototype.barMouseMove=function(a){var b=this._lastMcX+(a.x-this._lastMouseX)/UIData.Scale;b=Math.max(this.a_bar_bg_line.x,b),b=Math.min(this.a_bar_bg_line.x+this.a_bar_bg_line.width,b);var c=(b-this.a_bar_bg_line.x)/this.a_bar_bg_line.width;this._MouseDownEvt==this.a_bar?this.refreshDrawUseIcon(c):this.refreshDrawUseIconCopy(c)},c.prototype.barMouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.barMouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.barMouseUp,this)},c.prototype.refreshDrawUseIcon=function(a){GameData.configData.block_volume_set=a,this.a_bar.x=this.a_bar_bg_line.x+this.a_bar_bg_line.width*a,this.a_bar_red.uvScale=a,0==a?this.setTargetState(this.a_selectbtn3,1):this.setTargetState(this.a_selectbtn3,0)},c.prototype.refreshDrawUseIconCopy=function(a){GameData.configData.block_sound_set=a,this.a_bar_1.x=this.a_bar_bg_line.x+this.a_bar_bg_line.width*a,this.a_bar_red_1.uvScale=a,0==a?this.setTargetState(this.a_selectbtn4,1):this.setTargetState(this.a_selectbtn4,0)},c.prototype.butClik=function(b){switch(b.target){case this.e_close:ModuleEventManager.dispatchEvent(new a.HangupUiEvent(a.HangupUiEvent.HIDE_HANGUPUI_EVENT));break;case this.a_bar:case this.a_bar_1:this.barMouseDown(b)}switch(b.target){case this.a_selectbtn0:case this.a_selectbtn1:case this.a_selectbtn2:UiTweenScale.getInstance().changeButSize(b.target),this.setTargetState(b.target);break;case this.a_selectbtn3:UiTweenScale.getInstance().changeButSize(b.target);var c=b.target.current;0==c?this.refreshDrawUseIcon(0):this.refreshDrawUseIcon(1);break;case this.a_selectbtn4:UiTweenScale.getInstance().changeButSize(b.target);var c=b.target.current;0==c?this.refreshDrawUseIconCopy(0):this.refreshDrawUseIconCopy(1)}},c.prototype.setTargetState=function(a,b){void 0===b&&(b=-1);var c=b;-1==b&&(c=(a.current+1)%2),a.goToAndStop(c),a==this.a_selectbtn0?GameData.configData.block_other_plr=c:a==this.a_selectbtn1?GameData.configData.block_effect_ski=c:a==this.a_selectbtn2&&(GameData.configData.block_plr_flyword=c)},c}(WindowMinUi);a.HangupSettingUiPanel=b}(Hangup||(Hangup={}));var Hangup;!function(a){var b=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getTb_hook_quality=function(){this._tb_hook_quality_list||(this._tb_hook_quality_list=new Array);var a=TableData.getInstance().getTableByName(TableData.tb_hook_quality);for(var b in a.data){var c=new tb.TB_hook_quality_Vo(a.data[b]);this._tb_hook_quality_list.push(c)}return this._tb_hook_quality_list},a.prototype.getTb_hook_hp_item=function(){this._tb_hook_hp_item_list||(this._tb_hook_hp_item_list=new Array);var a=TableData.getInstance().getTableByName(TableData.tb_hook_hp_item);for(var b in a.data){var c=new tb.TB_hook_hp_item_Vo(a.data[b]);this._tb_hook_hp_item_list.push(c)}return this._tb_hook_hp_item_list},a}();a.HangupSettingModel=b}(Hangup||(Hangup={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Hangup;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"HangupUiModel"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.HangupUiModel=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_HANGUPUI_EVENT="SHOW_HANGUPUI_EVENT",b.HIDE_HANGUPUI_EVENT="HIDE_HANGUPUI_EVENT",b}(BaseEvent);a.HangupUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"HangupSettingProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_HANGUPUI_EVENT?this.showUi():b.type==c.HIDE_HANGUPUI_EVENT&&this.hideUi()}if(a instanceof UIPanelEvent){var d=a;d.panel==this._hangupSettingUiPanel&&(this._hangupSettingUiPanel.dispose(),this._hangupSettingUiPanel=null,console.log("释放面板 _hangupSettingUiPanel"))}},d.prototype.hideUi=function(){this._hangupSettingUiPanel&&this._hangupSettingUiPanel.hide()},d.prototype.showUi=function(){var b=this;this._hangupSettingUiPanel||(this._hangupSettingUiPanel=new a.HangupSettingUiPanel),this._hangupSettingUiPanel.load(function(){b._hangupSettingUiPanel.show()})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_HANGUPUI_EVENT),new c(c.HIDE_HANGUPUI_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.HangupSettingProcessor=d}(Hangup||(Hangup={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),social;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.left=184,b.top=140,b.setShowLevel(4),b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,c,593,264,0,82,3,256,512,1,5)},b.prototype.refreshDataByNewData=function(){var a=GuidData.social.getApplyList(),b=this.getData(a);this.refreshData(b)},b.prototype.getApplyList=function(){for(var a=GuidData.social.getApplyList(),b=GuidData.social.getApplyFlag(),c=new Array,d=b;d<a.length;d++)c.push(a[d]);for(var d=0;b>d;d++)c.push(a[d]);return c},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=a[c];if(d){var e=new SListItemData;e.data=d,e.id=c,b.push(e)}}return b},b.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData())},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.ApplyList=b;var c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._num=1,b}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.icon1=this.creatSUI(d,this.parentTarget.baseAtlas,"Icon",9,6,68,68),b.addChild(this.icon1),this.icon1.addEventListener(InteractiveEvent.Up,this.butClik,this),this.fam1=this.creatSUI(d,this.parentTarget.baseAtlas,"Ifac",299,30,100,20),b.addChild(this.fam1),this.name1=this.creatSUI(d,this.parentTarget.baseAtlas,"Iname",93,30,100,20),b.addChild(this.name1),this.vip1=this.creatSUI(d,this.parentTarget.baseAtlas,"Ivip",199,33,29,14),b.addChild(this.vip1),this.btn2=this.creatSUI(d,this.parentTarget.baseAtlas,"Ibtn",499,19,72,46),b.addChild(this.btn2),this.btn2.addEventListener(InteractiveEvent.Up,this.butClik,this),this.bg1=this.creatSUI(c,this.parentTarget.baseAtlas,"Ibg",0,0,593,82),b.addChild(this.bg1)},b.prototype.render=function(a){this.itdata=a,a?(a.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.bg1.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG),this.setIcon(a.data),this.uiAtlas.upDataPicToTexture(getVipIconUrl(a.data.vip),this.vip1.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.name1.skinName,getBaseName(a.data.name),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.fam1.skinName,""==a.data.faction?"暂无家族":getBaseName(a.data.faction),16,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.btn2.skinName,"agreed")):this.setnull()},b.prototype.setnull=function(){UiDraw.clearUI(this.bg1),UiDraw.clearUI(this.icon1),UiDraw.clearUI(this.vip1),UiDraw.clearUI(this.name1),UiDraw.clearUI(this.fam1),UiDraw.clearUI(this.btn2)},b.prototype.setIcon=function(a){var b=this;console.log("---$obj--",a),IconManager.getInstance().getIcon(getTouPic(a.gender),function(c){var d=b._baseRender.uiAtlas.getRec(b.icon1.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(c,0,0,82,82,3,3,62,62),UiDraw.cxtDrawImg(e,PuiData.SKILL_LEV_BG,new Rectangle(15,50,53,18),UIData.publicUi),LabelTextFont.writeSingleLabelToCtxSetAnchor(e,ColorType.Whitefffce6+String(a.level),14,42,50,TextAlign.CENTER),b._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},b.prototype.butClik=function(a){switch(a.target){case this.btn2:this.itdata&&this.sureApplyFriend()}},b.prototype.isfriend=function(a){for(var b=GuidData.social.getFriendList(),c=0;c<b.length;c++)if(a.guid==b[c].guid)return!0;return!1},b.prototype.sureApplyFriend=function(){var a=GuidData.social.getApplyList();a.length&&NetManager.getInstance().protocolos.social_sureadd_friend(this.itdata.data.guid)},b}(SListItem);a.ApplyItemRender=c}(social||(social={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),social;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a.setBlackBg(),a._AbgRender=new UIRenderComponent,a.addRender(a._AbgRender),a._AbottomRender=new UIRenderComponent,a.addRender(a._AbottomRender),a._AbaseRender=new UIRenderComponent,a.addRender(a._AbaseRender),a._AtopRender=new UIRenderComponent,a.addRender(a._AtopRender),a._AbgRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._AbgRender.dispose(),this._AbgRender=null,this._AbaseRender.dispose(),this._AbaseRender=null,this._AtopRender.dispose(),this._AtopRender=null,this.applyList&&(this.applyList.dispose(),this.applyList=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._AbottomRender.uiAtlas=WindowUi.winUIAtlas,this._AbgRender.uiAtlas.setInfo("ui/uidata/social/socialmodel.xml","ui/uidata/social/socialmodel.png",function(){a.loadConfigCom()},"ui/uidata/social/socialpc.png")},c.prototype.loadConfigCom=function(){this._AbaseRender.uiAtlas=this._AbgRender.uiAtlas,this._AtopRender.uiAtlas=this._AbgRender.uiAtlas;var a=this._AtopRender;this.a_btn3=this.addEvntButUp("cnew_btn1",this._AbottomRender),this.setSizeForPanelUiCopy(this.a_btn3,"a_btn3",a),this._AbottomRender.applyObjData(),this.listIndex1=this.addChild(a.getComponent("listIndex1")),this.addUIList(["aF_txt3","aF_txt2","aF_txt1","line1111","line11111","aY_cleartxt","aY_txt","line22","line3_1"],a),this.applyLoadComplete(),this.resize()},c.prototype.resize=function(){b.prototype.resize.call(this),this.applyList&&(this.applyList.left=this.listIndex1.parent.x/UIData.Scale+this.listIndex1.x,this.applyList.top=this.listIndex1.parent.y/UIData.Scale+this.listIndex1.y)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.applyList||(this.applyList=new a.ApplyList,this.applyList.init(this._AtopRender.uiAtlas)),this.applyList.show(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.applyList&&this.applyList.hide()},c.prototype.butClik=function(a){switch(a.target){case this.e_close:this.hide();break;case this.a_btn3:var b=GuidData.social.getApplyList();b.length>0&&NetManager.getInstance().protocolos.social_clear_apply()}},c}(WindowMinUi);a.ApplyPanel=b}(social||(social={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),social;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.left=184,b.top=140,b.setShowLevel(4),b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.recommend=function(){NetManager.getInstance().protocolos.social_recommend_friend()},b.prototype.initData=function(){this._ary=new Array,this.setData(this._ary,c,593,264,0,82,3,256,512,1,5)},b.prototype.refreshDataByNewData=function(a){this._ary=this.getData(a),this.refreshData(this._ary)},b.prototype.refreshDataByindex=function(a){this._ary.splice(a,1);for(var b=0;b<this._ary.length;b++)this._ary[b].id=b;this.refreshData(this._ary)},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=a[c],e=new SListItemData;e.data=d,e.id=c,b.push(e)}return b},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.AddFriendList=b;var c=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a._num=1,a}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.icon1=this.creatSUI(d,this.parentTarget.baseAtlas,"Icon",9,6,68,68),a.addChild(this.icon1),this.icon1.addEventListener(InteractiveEvent.Up,this.butClik,this),this.fam1=this.creatSUI(d,this.parentTarget.baseAtlas,"Ifac",299,30,100,20),a.addChild(this.fam1),this.name1=this.creatSUI(d,this.parentTarget.baseAtlas,"Iname",93,30,100,20),a.addChild(this.name1),this.vip1=this.creatSUI(d,this.parentTarget.baseAtlas,"Ivip",199,33,29,14),a.addChild(this.vip1),this.btn1=this.creatSUI(d,this.parentTarget.baseAtlas,"Ibtn",499,19,72,46),a.addChild(this.btn1),this.btn1.addEventListener(InteractiveEvent.Up,this.butClik,this),this.bg1=this.creatSUI(c,this.parentTarget.baseAtlas,"Ibg",0,0,593,82),a.addChild(this.bg1)},c.prototype.render=function(a){this.itdata=a,a?(a.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.bg1.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG),this.setIcon(a.data),this.uiAtlas.upDataPicToTexture(getVipIconUrl(a.data.vip),this.vip1.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.name1.skinName,getBaseName(a.data.name),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.fam1.skinName,""==a.data.faction?"暂无家族":getBaseName(a.data.faction),16,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.btn1.skinName,"add")):this.setnull()},c.prototype.setnull=function(){UiDraw.clearUI(this.bg1),UiDraw.clearUI(this.icon1),UiDraw.clearUI(this.vip1),UiDraw.clearUI(this.name1),UiDraw.clearUI(this.fam1),UiDraw.clearUI(this.btn1)},c.prototype.setIcon=function(a){var b=this;IconManager.getInstance().getIcon(getTouPic(a.gender),function(c){var d=b._baseRender.uiAtlas.getRec(b.icon1.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(c,0,0,82,82,3,3,62,62),UiDraw.cxtDrawImg(e,PuiData.SKILL_LEV_BG,new Rectangle(15,50,53,18),UIData.publicUi),LabelTextFont.writeSingleLabelToCtxSetAnchor(e,ColorType.Whitefffce6+String(a.level),14,42,50,TextAlign.CENTER),b._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},c.prototype.butClik=function(a){switch(a.target){case this.btn1:this.itdata&&this.addFriend()}},c.prototype.addFriend=function(){NetManager.getInstance().protocolos.social_add_friend(this.itdata.data.guid);var b=new a.SocialUiEvent(a.SocialUiEvent.REFRESHADDlIST_EVENT);b.index=this.itdata.id,ModuleEventManager.dispatchEvent(b)},c}(SListItem);a.AddFriendItemRender=c}(social||(social={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),social;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.lasttime=0,a.nextTime=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a.setBlackBg(),a._AbgRender=new UIRenderComponent,a.addRender(a._AbgRender),a._AbottomRender=new UIRenderComponent,a.addRender(a._AbottomRender),a._AbaseRender=new UIRenderComponent,a.addRender(a._AbaseRender),a._AtopRender=new UIRenderComponent,a.addRender(a._AtopRender),a._AbgRender.uiAtlas=new UIAtlas,a.upDataFun=function(b){a.update(b)},a}return __extends(c,b),c.prototype.dispose=function(){this._AbgRender.dispose(),this._AbgRender=null,this._AbaseRender.dispose(),this._AbaseRender=null,this._AtopRender.dispose(),this._AtopRender=null,this.addfriendList&&(this.addfriendList.dispose(),this.addfriendList=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._AbottomRender.uiAtlas=WindowUi.winUIAtlas,this._AbgRender.uiAtlas.setInfo("ui/uidata/social/socialmodel.xml","ui/uidata/social/socialmodel.png",function(){a.loadConfigCom()},"ui/uidata/social/socialpc.png")},c.prototype.update=function(a){this.setUiListVisibleByItem([this.aF_time],!0);var b=Math.ceil((this.nextTime-TimeUtil.getTimer())/1e3);this._AtopRender?(this.lasttime!=b&&(LabelTextFont.writeSingleLabel(this._AtopRender.uiAtlas,this.aF_time.skinName,b+"秒",14,TextAlign.LEFT,ColorType.colorb96d49),
this.lasttime=b),TimeUtil.getTimer()>this.nextTime&&(TimeUtil.removeFrameTick(this.upDataFun),this.setUiListVisibleByItem([this.aF_time],!1))):TimeUtil.removeFrameTick(this.upDataFun)},c.prototype.loadConfigCom=function(){this._AbaseRender.uiAtlas=this._AbgRender.uiAtlas,this._AtopRender.uiAtlas=this._AbgRender.uiAtlas;var a=this._AtopRender;this.a_btn=this.addEvntButUp("a_btn",a),this.aF_refreshbtn=this.addEvntButUp("aF_refreshbtn",a),this.addUIList(["aF_txt3","aF_txt2","aF_txt1","line1111","line11111","aF_txt","line22","line3_1"],a),this.aF_time=a.getComponent("aF_time"),this._a_8=this.addChild(a.getComponent("a_8")),this.aF_bg1_1=this.addEvntButUp("aF_bg1_1",this._AbaseRender),this.listIndex1=this.addChild(a.getComponent("listIndex1")),this._msg="输入玩家昵称或者ID",this._type=!1,this.refreshInputBfun(this._msg,this._type),this.applyLoadComplete(),this.resize()},c.prototype.resize=function(){b.prototype.resize.call(this),this.addfriendList&&(this.addfriendList.left=this.listIndex1.parent.x/UIData.Scale+this.listIndex1.x,this.addfriendList.top=this.listIndex1.parent.y/UIData.Scale+this.listIndex1.y)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.addfriendList||(this.addfriendList=new a.AddFriendList,this.addfriendList.init(this._AbaseRender.uiAtlas)),this.addfriendList.show(),this.listrecommend(),this.resize()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.addfriendList.hide()},c.prototype.listrecommend=function(){TimeUtil.getTimer()>this.nextTime&&(this.nextTime=TimeUtil.getTimer()+5e3,TimeUtil.addFrameTick(this.upDataFun),this.addfriendList.recommend())},c.prototype.butClik=function(a){var b=this;switch(a.target){case this.e_close:this.hide();break;case this.aF_refreshbtn:UiTweenScale.getInstance().changeButSize(a.target),this.listrecommend();break;case this.aF_bg1_1:InputPanel.show(function(a){b.inputBfun(a)},this._type?this._msg:"",0,12);break;case this.a_btn:UiTweenScale.getInstance().changeButSize(a.target),this.addFriend()}},c.prototype.addFriend=function(){this._msg&&(NetManager.getInstance().protocolos.social_add_friend_byname(this._msg),this.inputBfun(""))},c.prototype.inputBfun=function(a){a.length>0?(this._type=!0,this._msg=a):(this._type=!1,this._msg="输入玩家昵称或者ID"),this.refreshInputBfun(this._msg,this._type)},c.prototype.refreshInputBfun=function(a,b){LabelTextFont.writeSingleLabel(this._AtopRender.uiAtlas,this._a_8.skinName,a,16,TextAlign.CENTER,ColorType.colorb96d49)},c}(WindowMinUi);a.AddFriendPanel=b}(social||(social={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),social;!function(a){var b=function(b){function d(a){var c=b.call(this)||this;return c.left=56,c.top=123,c}return __extends(d,b),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,c,802,307,0,90,3,256,1024,1,6)},d.prototype.refreshDataByNewData=function(a,b){void 0===a&&(a=0),this.type=b;var c;c=0==b?GuidData.social.getFriendList():GuidData.social.getEnemyList();var d=this.getData(c,a,b);this.refreshData(d)},d.prototype.getData=function(b,c,d){for(var e=new Array,f=0;f<b.length;f++){var g=new a.SocialgivingData;g.socialItemData=b[f],g.type=d,g.items=this.getItemsAry(b[f],d);var h=new SListItemData;c==f&&(h.selected=!0),h.data=g,h.id=f,e.push(h)}return console.log("===$sListItemData===",b,c,d,e),e},d.prototype.getItemsAry=function(a,b){var c=new Array;return c.push(0),0==b?(""==a.faction&&GuidData.faction&&c.push(1),c.push(5)):c.push(6),c},d.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData(0,a)},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d}(SList);a.SocialListPanel=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.bg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"I_bg",0,0,802,86,10,10),a.addChild(this.bg),this.icon=this.creatSUI(d,this.parentTarget.baseAtlas,"I_icon",18,9,68,68),a.addChild(this.icon),this.name=this.creatSUI(d,this.parentTarget.baseAtlas,"I_name",101,32,115,20),a.addChild(this.name),this.I_vip=this.creatSUI(d,this.parentTarget.baseAtlas,"I_vip",218,36,29,14),a.addChild(this.I_vip),this.fam=this.creatSUI(d,this.parentTarget.baseAtlas,"I_fam",305,32,121,22),a.addChild(this.fam),this.I_force=this.creatSUI(d,this.parentTarget.baseAtlas,"I_force",469,32,100,22),a.addChild(this.I_force),this.chat=this.creatSUI(d,this.parentTarget.baseAtlas,"I_chat",636,21,72,46),a.addChild(this.chat),this.tip=this.creatSUI(d,this.parentTarget.baseAtlas,"I_tip",716,21,72,46),a.addChild(this.tip),this.icon.addEventListener(InteractiveEvent.Up,this.butClik,this),this.chat.addEventListener(InteractiveEvent.Up,this.butClik,this),this.tip.addEventListener(InteractiveEvent.Up,this.butClik,this)},c.prototype.render=function(a){this.itdata=a,a&&a.data?(UiDraw.uiAtlasDrawImg(this.uiAtlas,this.bg.skinName,UIData.publicUi,PuiData.Slist_nselect),this.setIcon(a),LabelTextFont.writeSingleLabel(this.uiAtlas,this.name.skinName,getBaseName(a.data.socialItemData.name),16,TextAlign.CENTER,ColorType.Brown7a2f21),this.uiAtlas.upDataPicToTexture(getVipIconUrl(a.data.socialItemData.vip),this.I_vip.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.fam.skinName,""==a.data.socialItemData.faction?"暂无家族":getBaseName(a.data.socialItemData.faction),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I_force.skinName,Snum(a.data.socialItemData.force),16,TextAlign.CENTER,ColorType.Brown7a2f21),0==a.data.type?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.chat.skinName,"chat"):UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.chat.skinName,"revenge"),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.tip.skinName,"detailed")):this.setnull()},c.prototype.setnull=function(){UiDraw.clearUI(this.bg),UiDraw.clearUI(this.icon),UiDraw.clearUI(this.name),UiDraw.clearUI(this.I_vip),UiDraw.clearUI(this.fam),UiDraw.clearUI(this.I_force),UiDraw.clearUI(this.chat),UiDraw.clearUI(this.tip)},c.prototype.setIcon=function(a){var b=this;IconManager.getInstance().getIcon(getTouPic(a.data.socialItemData.gender),function(c){var d=b._baseRender.uiAtlas.getRec(b.icon.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(c,0,0,82,82,3,3,62,62),a.selected&&UiDraw.cxtDrawImg(e,PuiData.A_HIGHR_C_66,new Rectangle(1,1,66,66),UIData.publicUi),a.data.socialItemData.inOnline||UIManager.getInstance().makeCtxToGray(e,new Rectangle(0,0,d.pixelWitdh,d.pixelHeight)),UiDraw.cxtDrawImg(e,PuiData.SKILL_LEV_BG,new Rectangle(15,50,53,18),UIData.publicUi),LabelTextFont.writeSingleLabelToCtxSetAnchor(e,ColorType.Whitefffce6+String(a.data.socialItemData.level),14,42,50,TextAlign.CENTER),b._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},c.prototype.showPop=function(a){var b=this;console.log("---weizhi---",this.chat.parent.x/UIData.Scale+this.chat.x,this.chat.parent.y/UIData.Scale+this.chat.y),PopMenuUtil.show(this.itdata,function(a){b.popBackFun(a)},this.chat.parent.x/UIData.Scale+this.chat.x,this.chat.parent.y/UIData.Scale+this.chat.y)},c.prototype.popBackFun=function(a){this.itdata&&this.itdata.data&&(0==a?NetManager.getInstance().protocolos.get_player_overview(this.itdata.data.socialItemData.guid):5==a?this.delFriend(this.itdata.data.socialItemData.guid):1==a?NetManager.getInstance().protocolos.send_faction_invite(this.itdata.data.socialItemData.guid):6==a&&NetManager.getInstance().protocolos.social_remove_enemy(this.itdata.data.socialItemData.guid))},c.prototype.delFriend=function(a){var b=GuidData.social.getFriendList();b.length&&NetManager.getInstance().protocolos.social_del_friend(a)},c.prototype.butClik=function(b){if(this.itdata&&this.itdata.data)switch(b.target){case this.tip:case this.icon:this.showPop(b);break;case this.chat:if(0==this.itdata.data.type){ModulePageManager.openPanel(SharedDef.MODULE_CHATPERSON,this.itdata.data.socialItemData.guid);break}if(GuidData.player.getSocial_revenge_num()>0){var c=this.itdata.data;NetManager.getInstance().protocolos.social_revenge_enemy(c.socialItemData.guid),NetManager.getInstance().protocolos.change_battle_mode(SharedDef.FAMILY_MODE),ModuleEventManager.dispatchEvent(new a.SocialUiEvent(a.SocialUiEvent.HIDE_SOCIAL_EVENT))}else msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"剩余次数不足",99)}},c}(SListItem);a.SocialItemRender=c}(social||(social={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),social;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._PaneltopRender=new UIRenderComponent,a.addRender(a._PaneltopRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._redPointRender1=new RedPointRender,a._baseRender.uiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,this._PaneltopRender.dispose(),this._PaneltopRender=null,this._redPointRender.dispose(),this._redPointRender=null,this._redPointRender1.dispose(),this._redPointRender1=null,this.socialListPanel&&(this.socialListPanel.dispose(),this.socialListPanel=null),b.prototype.dispose.call(this)},d.prototype.applyLoad=function(){var a=this;this._publicRender.uiAtlas=WindowUi.winUIAtlas,this._baseRender.uiAtlas.setInfo("ui/uidata/social/socialmodel.xml","ui/uidata/social/socialmodel.png",function(){a.loadConfigCom()},"ui/uidata/social/socialpc.png")},d.prototype.loadConfigCom=function(){this.winmidRender.uiAtlas=this._publicRender.uiAtlas,this._bottomRender.uiAtlas=this._baseRender.uiAtlas,this._topRender.uiAtlas=this._baseRender.uiAtlas,this._PaneltopRender.uiAtlas=this._baseRender.uiAtlas;var a=this._topRender;this.initUI(a);var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(b,"rightLinebg",this._bottomRender);var d=this.addChild(this._publicRender.getComponent("cnew_line"));this.setSizeForPanelUiCopy(d,"cnew_line",this._bottomRender),this.winmidRender.applyObjData(),this._publicRender.applyObjData(),this.addUIList(["a_title","a_1","a_4","a_3","a_2","line1","line11","line111","line2","line3"],this._topRender),this.listIndex=this.addChild(this._topRender.getComponent("listIndex")),this.bottomUiparts=new c,this.bottomUiparts.setRender(this._bottomRender,this._baseRender,this._publicRender,this._topRender,this._redPointRender1),this.addVirtualContainer(this.bottomUiparts),this._redPointRender.getRedPointUI(this,56,new Vector2D(this.tab_0.x+this.tab_0.width-5,this.tab_0.y)),this._redPointRender.getRedPointUI(this,58,new Vector2D(this.tab_1.x+this.tab_1.width-5,this.tab_1.y)),this.applyLoadComplete()},d.prototype.initUI=function(a){this.tab_0=this.addEvntBut("tab_0",this._bottomRender),this.tab_1=this.addEvntBut("tab_1",this._bottomRender)},d.prototype.selecttype=function(a){0==a?(this.tab_0.selected=!0,this.tab_1.selected=!1,this.addRender(this._redPointRender1)):(this.removeRender(this._redPointRender1),this.tab_0.selected=!1,this.tab_1.selected=!0,GuidData.social.enemyredstate=!1),this.selectdata(a)},d.prototype.selectdata=function(b){this.type=b,this.bottomUiparts&&this.bottomUiparts.resetData(b),this.socialListPanel||(this.socialListPanel=new a.SocialListPanel(this),this.socialListPanel.init(this._baseRender.uiAtlas)),this.socialListPanel.show(this.type)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.selecttype(0),this.resize()},d.prototype.hide=function(){this.socialListPanel.hide(),UIManager.getInstance().removeUIContainer(this),ModulePageManager.hideResTittle()},d.prototype.close=function(){UIManager.getInstance().removeUIContainer(this)},d.prototype.butClik=function(b){switch(b.target){case this.tab_0:this.selecttype(0);break;case this.tab_1:this.selecttype(1);break;case this.w_close:ModuleEventManager.dispatchEvent(new a.SocialUiEvent(a.SocialUiEvent.HIDE_SOCIAL_EVENT))}},d.prototype.resize=function(){b.prototype.resize.call(this),this.socialListPanel&&(this.socialListPanel.left=this.listIndex.parent.x/UIData.Scale+this.listIndex.x,this.socialListPanel.top=this.listIndex.parent.y/UIData.Scale+this.listIndex.y)},d}(WindowUi);a.SocialUiPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(c,b),c.prototype.setRender=function(a,b,c,d,e){this._bottomRender=a,this._publicRender=c,this._topRender=d,this._baseRender=b,this._redPointRender=e,this.loadConfigCom()},c.prototype.loadConfigCom=function(){var a=this._topRender;this.RevengeList=new Array,this.RevengeList.push(a.getComponent("fC_cishu")),this.RevengeList.push(this._baseRender.getComponent("a_txtbg")),this.a_btn4=this.addEvntButUp("a_btn4",a),this.RevengeList.push(this.a_btn4),this.FriendList=new Array,this.FriendList.push(this._baseRender.getComponent("fra_txt1")),this.FriendList.push(a.getComponent("fra_txt2")),this.a_btn1=this.addEvntButUp("a_btn1",a),this.FriendList.push(this.a_btn1),this.a_btn2=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.a_btn2,"a_btn2",a),this.FriendList.push(this.a_btn2),this.fri_num=a.getComponent("fri_num"),this.FriendList.push(this.fri_num),this._redPointRender.getRedPointUI(this,57,new Vector2D(this.a_btn2.x+this.a_btn2.width,this.a_btn2.y)),this._publicRender.applyObjData()},c.prototype.resetData=function(a){this._type=a,this.setUiListVisibleByItem(this.FriendList,0==a),this.setUiListVisibleByItem(this.RevengeList,0!=a),0!=a?this.setrevengenum():this.setFriendNum()},c.prototype.setFriendNum=function(){var a=tb.TB_social_num.get_TB_social_num(GuidData.player.getLevel()),b=GuidData.social.getFriendList().length+"/"+a.num;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.fri_num.skinName,"好友:"+b,16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.setrevengenum=function(){var a=tb.TB_enemy_revenge_base.get_TB_enemy_revenge_baseById(1),b="剩余复仇次数:"+GuidData.player.getSocial_revenge_num()+"/"+a.daily_revenge_times;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.RevengeList[0].skinName,b,16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.butClik=function(b){switch(UiTweenScale.getInstance().changeButSize(b.target),b.target){case this.a_btn4:for(var c=tb.TB_enemy_revenge_buy.get_TB_enemy_revenge_buy(),d=new Array,e=GuidData.player.getRevengeBuyNum();e<c.length;e++)d.push(c[e].cost[0]);var f=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL);f.resoureItem=d,f.Info1="今日仇人挑战可购买",f.cutNum=c.length-GuidData.player.getRevengeBuyNum(),f.cutNum>0?(f.SubmitFun=function(a){NetManager.getInstance().protocolos.social_buy_revenge_times(a)},ModuleEventManager.dispatchEvent(f)):msgtip.MsgTipManager.outStrById(22,58);break;case this.a_btn2:console.log("applyPanel"),ModuleEventManager.dispatchEvent(new a.SocialUiEvent(a.SocialUiEvent.SHOW_APPLYPANEL_EVENT));break;case this.a_btn1:ModuleEventManager.dispatchEvent(new a.SocialUiEvent(a.SocialUiEvent.SHOW_ADDFRIEND_EVENT))}},c}(UIVirtualContainer);a.BottomUiparts=c}(social||(social={}));var social;!function(a){var b=function(){function a(){}return a.ZHUDONG=0,a.NUQI=1,a.BEIDONG=2,a}();a.SkillBaseType=b;var c=function(){function a(){}return a}();a.SocialgivingData=c;var d=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a}();a.SocialModel=d}(social||(social={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),social;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"SocialUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.SocialUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_ADDFRIEND_EVENT="SHOW_ADDFRIEND_EVENT",b.SHOW_APPLYPANEL_EVENT="SHOW_APPLYPANEL_EVENT",b.SHOW_SOCIAL_EVENT="SHOW_SOCIAL_EVENT",b.HIDE_SOCIAL_EVENT="HIDE_SOCIAL_EVENT",b.REFRESHADDlIST_EVENT="REFRESHADDlIST_EVENT",b.REFRESHAPPLYlIST_EVENT="REFRESHAPPLYlIST_EVENT",b.REFRESHFRIENDlIST_EVENT="REFRESHFRIENDlIST_EVENT",b.REFRESHFRIENDSELECTED_EVENT="REFRESHFRIENDSELECTED_EVENT",b.REVENGE_NUM_CHG_EVENT="REVENGE_NUM_CHG_EVENT",b.REVENGE_PANEL_EVENT="REVENGE_PANEL_EVENT",b}(BaseEvent);a.SocialUiEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"SocialProcessor"},d.prototype.receivedModuleEvent=function(a){if(this.processRedPoint(),a instanceof c){var b=a;b.type==c.SHOW_SOCIAL_EVENT?this.showUi():b.type==c.HIDE_SOCIAL_EVENT?this.hideUi():b.type==c.REFRESHADDlIST_EVENT?this.refreshAddList(b.index):b.type==c.REFRESHAPPLYlIST_EVENT?this.refreshApplyList(b.isvisiable):b.type==c.REFRESHFRIENDlIST_EVENT?this.refreshFriendList():b.type==c.REFRESHFRIENDSELECTED_EVENT?this.refreshFriendList(b.index):b.type==c.REVENGE_NUM_CHG_EVENT?this.revengenumchg():b.type==c.SHOW_ADDFRIEND_EVENT?this.showAddFriendUi():b.type==c.SHOW_APPLYPANEL_EVENT?this.showApplyPanelUi():b.type==c.REVENGE_PANEL_EVENT&&this.refreshRevengeList()}if(a instanceof UIPanelEvent){var d=a;d.panel==this._socialUiPanel&&(this._socialUiPanel.dispose(),this._socialUiPanel=null,console.log("释放面板 _socialUiPanel")),d.panel==this._addfriendUi&&(this._addfriendUi.dispose(),this._addfriendUi=null,console.log("释放面板 _addfriendUi")),d.panel==this._applyPanelUi&&(this._applyPanelUi.dispose(),this._applyPanelUi=null,console.log("释放面板 _addfriendUi"))}else if((a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT||a.type==EngineEvent.SYSTEM_OPEN_EVENT)&&GuidData.social){var e=GuidData.social.getEnemyList();e&&e.length>0?GuidData.social.enemyredstate=!0:GuidData.social.enemyredstate=!1,this.processRedPoint()}},d.prototype.processRedPoint=function(){if(console.log("---红点----",GuidData.social.getApplyList()),GuidData.player.getsyspageopen(SharedDef.MODULE_SOCIAL,SharedDef.MODULE_SOCIAL_FRIEND)){var a=RedPointManager.getInstance().getNodeByID(57);if(GuidData.social){var b;b=GuidData.social.getApplyList(),b&&b.length>0?a.show=!0:a.show=!1;var c=RedPointManager.getInstance().getNodeByID(58);c.show=GuidData.social.enemyredstate}}},d.prototype.revengenumchg=function(){this._socialUiPanel&&this._socialUiPanel.hasStage&&1==this._socialUiPanel.type&&this._socialUiPanel.bottomUiparts.setrevengenum()},d.prototype.refreshFriendList=function(a){void 0===a&&(a=0),this._socialUiPanel&&this._socialUiPanel.socialListPanel&&this._socialUiPanel.socialListPanel.hasStage&&0==this._socialUiPanel.socialListPanel.type&&(this._socialUiPanel.bottomUiparts.setFriendNum(),this._socialUiPanel.socialListPanel.refreshDataByNewData(a,0))},d.prototype.refreshRevengeList=function(a){void 0===a&&(a=0),this._socialUiPanel&&this._socialUiPanel.socialListPanel&&this._socialUiPanel.socialListPanel.hasStage&&1==this._socialUiPanel.socialListPanel.type&&this._socialUiPanel.socialListPanel.refreshDataByNewData(a,1)},d.prototype.refreshApplyList=function(a){this._applyPanelUi&&this._applyPanelUi.applyList&&this._applyPanelUi.applyList.hasStage&&this._applyPanelUi.applyList.refreshDataByNewData(),ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON))},d.prototype.refreshAddList=function(a){this._addfriendUi&&this._addfriendUi.addfriendList&&this._addfriendUi.addfriendList.hasStage&&this._addfriendUi.addfriendList.refreshDataByindex(a)},d.prototype.hideUi=function(){this._socialUiPanel&&(this._socialUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)))},d.prototype.showUi=function(){var b=this;this._socialUiPanel||(this._socialUiPanel=new a.SocialUiPanel),this._socialUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b._socialUiPanel.show()})},d.prototype.showAddFriendUi=function(){var b=this;this._addfriendUi||(this._addfriendUi=new a.AddFriendPanel),this._addfriendUi.load(function(){b._addfriendUi.show()})},d.prototype.showApplyPanelUi=function(){var b=this;this._applyPanelUi||(this._applyPanelUi=new a.ApplyPanel),this._applyPanelUi.load(function(){b._applyPanelUi.show()})},d.prototype.getRecommend=function(a){for(var b=a.readUint16(),c=new Array,d=0;b>d;d++){var e=new social_friend_info;e.read(a);var f=new SocialItemData;f.guid=e.guid,f.name=e.name,f.faction=e.faction,f.level=e.level,f.gender=e.icon,f.vip=e.vip,c.push(f)}this._addfriendUi&&this._addfriendUi.addfriendList&&this._addfriendUi.addfriendList.refreshDataByNewData(c)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_SOCIAL_EVENT),new c(c.HIDE_SOCIAL_EVENT),new c(c.REFRESHADDlIST_EVENT),new c(c.REFRESHAPPLYlIST_EVENT),new c(c.REFRESHFRIENDlIST_EVENT),new c(c.REFRESHFRIENDSELECTED_EVENT),new c(c.REVENGE_NUM_CHG_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new c(c.SHOW_ADDFRIEND_EVENT),new c(c.SHOW_APPLYPANEL_EVENT),new c(c.REVENGE_PANEL_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT)]},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_SOCIAL_GET_RECOMMEND_FRIEND]=function(b){a.getRecommend(b)},b},d}(BaseProcessor);a.SocialProcessor=d}(social||(social={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(){function a(){}return a}();a.ApplyFactionListVo=b;var c=function(a){function c(){var b=a.call(this)||this;return b.left=305,b.top=174,b}return __extends(c,a),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,357,243,0,42,5,256,512,1,8)},c.prototype.refreshDataByNewData=function(){var a=GuidData.faction.getApplyList(),b=this.getData(a);this.refreshData(b)},c.prototype.getData=function(a){for(var c=new Array,d=0;d<a.length;d++){var e=new b;e.data=a[d];var f=new SListItemData;f.data=e,f.id=d,c.push(f)}return c},c.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData())},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.ApplyFactionList=c;var d=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._num=1,b}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.I2zhanli=this.creatSUI(d,this.parentTarget.baseAtlas,"I2zhanli",185,11,88,20),b.addChild(this.I2zhanli),this.I2name=this.creatSUI(d,this.parentTarget.baseAtlas,"I2name",5,12,100,20),b.addChild(this.I2name),this.I2vip=this.creatSUI(d,this.parentTarget.baseAtlas,"I2vip",106,14,29,14),b.addChild(this.I2vip),this.I2lev=this.creatSUI(d,this.parentTarget.baseAtlas,"I2lev",143,12,35,20),b.addChild(this.I2lev),this.I2btn=this.creatSUI(d,this.parentTarget.baseAtlas,"I2btn",277,2,78,37),b.addChild(this.I2btn),this.I2bg=this.creatSUI(c,this.parentTarget.baseAtlas,"I2bg",0,0,357,42),b.addChild(this.I2bg)},b.prototype.render=function(a){if(this.itdata=a,a&&a.data){var b=a.data;this.I2btn.addEventListener(InteractiveEvent.Down,this.butClik,this),a.id%2||UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.I2bg.skinName,"bg"),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2name.skinName,getBaseName(b.data.name),16,TextAlign.CENTER,ColorType.Orange853d07),this.uiAtlas.upDataPicToTexture(getVipIconUrl(b.data.vipLev),this.I2vip.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2lev.skinName,String(b.data.level),16,TextAlign.CENTER,ColorType.Orange853d07),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2zhanli.skinName,String(b.data.force),16,TextAlign.CENTER,ColorType.Orange853d07),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.I2btn.skinName,"btn_ok")}else this.I2btn.removeEventListener(InteractiveEvent.Down,this.butClik,this),this.setnull()},b.prototype.setnull=function(){LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2zhanli.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2name.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2vip.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2lev.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2btn.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2bg.skinName,"",16,TextAlign.LEFT,"#d5e7ff")},b.prototype.butClik=function(a){switch(a.target){case this.I2btn:this.itdata&&this.sureJoin(this.itdata.data.data.guid)}},b.prototype.sureJoin=function(a){NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_AGREE_JOIN,0,0,a,"")},b}(SListItem);a.ApplyFactionRender=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(){function a(){this.isok=!1}return a}();a.PersonListVo=b;var c=function(a){function c(){var b=a.call(this)||this;return b.left=43,b.top=132,b}return __extends(c,a),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,590,346,0,39,8,512,512,1,10,1)},c.prototype.refreshDataByNewData=function(a,b){var c=a;if(b)for(var d=0;d<c.length;d++)if(c[d].guid==GuidData.player.getGuid()){var e=c[d];c.splice(d,1),c.unshift(e);break}this._sListItemData=this.getData(c),this.refreshData(this._sListItemData)},c.prototype.getData=function(a){for(var c=new Array,d=0;d<a.length;d++){var e=new SListItemData,f=new b;f.factionItemData=a[d],f.items=this.getItemsAry(a[d]),e.data=f,e.id=d,c.push(e)}return c},c.prototype.getItemsAry=function(a){var b=new Array;return this.ismyfriends(a.guid)&&b.push(8),b.push(0),GuidData.faction.playerIdentity<3&&a.identity>GuidData.faction.playerIdentity&&b.push(9),this.ismyfriends(a.guid)||b.push(7),GuidData.faction.playerIdentity<4&&a.identity>GuidData.faction.playerIdentity&&b.push(10),b},c.prototype.ismyfriends=function(a){for(var b=GuidData.social.getFriendList(),c=0;c<b.length;c++)if(b[c].guid==a)return!0;return!1},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(SList);a.PersonListPanel=c;var d=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a.IdentityKeyName=["族长","副族长","长老","精英","成员"],a}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);var f=this._customRenderAry[0];this._Ibg=this.creatSUI(c,this.parentTarget.baseAtlas,"Ibg",0,0,590,39),a.addChild(this._Ibg),this._Iname=this.creatSUI(d,this.parentTarget.baseAtlas,"Iname",5,10,100,20),a.addChild(this._Iname),this._IVip=this.creatSUI(d,this.parentTarget.baseAtlas,"IVip",106,13,30,14),a.addChild(this._IVip),this._Iidentity_Lev=this.creatSUI(d,this.parentTarget.baseAtlas,"Iidentity_Lev",144,10,133,20),a.addChild(this._Iidentity_Lev),this._Iforce_contribution=this.creatSUI(f,this.parentTarget.baseAtlas,"Iforce_contribution",283,10,162,20),a.addChild(this._Iforce_contribution),this._Iactive_logoutTime=this.creatSUI(f,this.parentTarget.baseAtlas,"Iactive_logoutTime",450,10,140,20),a.addChild(this._Iactive_logoutTime)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.applyRender()},enumerable:!0,configurable:!0}),c.prototype.applyRender=function(){var a=this.itdata.data;this._Iname.addEventListener(InteractiveEvent.Up,this.equClick,this),this.itdata.id%2&&UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this._Ibg.skinName,"bg"),LabelTextFont.writeSingleLabel(this.uiAtlas,this._Iname.skinName,getBaseName(a.factionItemData.name),16,TextAlign.CENTER,"#853d07"),this.setvip(a),this.drawIdentityAndLev(a),this.drawForceAndContribution(a),this.drawActiveAndLogoutTime(a)},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():(this._Iname.removeEventListener(InteractiveEvent.Up,this.equClick,this),this.setnull())},c.prototype.setvip=function(a){var b=this;IconManager.getInstance().getIcon(getVipIconUrl(a.factionItemData.vipLev),function(a){var c=b._baseRender.uiAtlas.getRec(b._IVip.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(a,0,0,a.width,a.height,0,0,a.width,a.height),b._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},c.prototype.drawIdentityAndLev=function(a){var b=this._baseRender.uiAtlas.getRec(this._Iidentity_Lev.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);LabelTextFont.writeSingleLabelToCtxSetAnchor(c,"[853d07]"+this.IdentityKeyName[a.factionItemData.identity-1],16,35,0),LabelTextFont.writeSingleLabelToCtxSetAnchor(c,"[853d07]"+String(a.factionItemData.level),16,102,0),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.drawForceAndContribution=function(a){var b=this._baseRender.uiAtlas.getRec(this._Iforce_contribution.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);LabelTextFont.writeSingleLabelToCtxSetAnchor(c,"[853d07]"+Snum(a.factionItemData.force),16,27,0),LabelTextFont.writeSingleLabelToCtxSetAnchor(c,"[853d07]"+Snum(a.factionItemData.contribution),16,97,0),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.drawActiveAndLogoutTime=function(a){var b=this._baseRender.uiAtlas.getRec(this._Iactive_logoutTime.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);LabelTextFont.writeSingleLabelToCtxSetAnchor(c,"[853d07]"+String(a.factionItemData.active),16,30,0);var d="在线";if(!a.factionItemData.isOnline){var e=GameInstance.getServerNow()-a.factionItemData.logoutTime;e=Math.floor(e/3600),
d=e>=1?e+"小时前":"刚刚"}LabelTextFont.writeSingleLabelToCtxSetAnchor(c,"[853d07]"+d,16,99,0),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.setnull=function(){LabelTextFont.writeSingleLabel(this.uiAtlas,this._Ibg.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this._Iname.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this._IVip.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this._Iidentity_Lev.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this._Iforce_contribution.skinName,"",16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this._Iactive_logoutTime.skinName,"",16,TextAlign.LEFT,"#d5e7ff")},c.prototype.equClick=function(a){var b=this,c=this.itdata.data;c.factionItemData.guid!=GuidData.player.getGuid()&&PopMenuUtil.show(this.itdata,function(a){b.popBackFun(a)},a.x,a.y)},c.prototype.popBackFun=function(b){var c=this;if(8==b)ModulePageManager.openPanel(SharedDef.MODULE_CHATPERSON,this.itdata.data.factionItemData.guid);else if(0==b)NetManager.getInstance().protocolos.get_player_overview(this.itdata.data.factionItemData.guid);else if(9==b){var d=new a.FactionEvent(a.FactionEvent.SHOW_FACTIONAPPOINTMENT_EVENT);d.data=this.itdata,ModuleEventManager.dispatchEvent(d)}else if(7==b)NetManager.getInstance().protocolos.social_add_friend(this.itdata.data.factionItemData.guid);else if(10==b){var e=this.itdata.data.factionItemData.name,f=e.split(",");TimeUtil.addTimeOut(30,function(){AlertUtil.show("是否将"+f[2]+"踢出家族？","提示",function(a){c.backFun(a)})})}},c.prototype.backFun=function(a){1==a&&NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_KICK,0,0,this.itdata.data.factionItemData.guid,"")},c}(SListItem);a.PersonListItemRender=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(){function a(){this.isok=!1}return a}();a.ZhaoMuVo=b;var c=function(a){function c(){var b=a.call(this)||this;return b.left=43,b.top=132,b}return __extends(c,a),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,589,250,0,50,5,256,512,1,5,1)},c.prototype.refreshDataByNewData=function(a){this._sListItemData=this.getData(a),this.refreshData(this._sListItemData),this.setSelectIndex(0)},c.prototype.getData=function(a){for(var c=new Array,d=0;d<a.length;d++){var e=new SListItemData,f=new b;f.vo=a[d],e.data=f,e.id=d,c.push(e)}return c},c.prototype.isokstate=function(a){this._isokary||(this._isokary=new Array),this._isokary.push(a),this.resetDataByok()},c.prototype.resetDataByok=function(){if(this._isokary&&this._isokary.length>0){for(var a=0;a<this._sListItemData.length;a++)this.compareData(this._sListItemData[a])&&(this._sListItemData[a].data.isok=!0);this.refreshDraw()}},c.prototype.compareData=function(a){for(var b=0;b<this._isokary.length;b++)if(a.data.vo.faction_guid==this._isokary[b].data.vo.faction_guid)return!0;return!1},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.ApplyZhaoMuListPanel=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);var f=this._customRenderAry[0];this.bg_0=this.creatSUI(c,this.parentTarget.baseAtlas,"Bg",0,0,589,50),a.addChild(this.bg_0),this.b_S_0=this.creatSUI(d,this.parentTarget.baseAtlas,"B_S",11,8,30,30),a.addChild(this.b_S_0),this.i_0=this.creatSUI(d,this.parentTarget.baseAtlas,"I",55,4,42,42),a.addChild(this.i_0),this.n_0=this.creatSUI(d,this.parentTarget.baseAtlas,"N",121,16,98,20),a.addChild(this.n_0),this.lev_0=this.creatSUI(d,this.parentTarget.baseAtlas,"Lev",240,16,40,20),a.addChild(this.lev_0),this.levMax_0=this.creatSUI(f,this.parentTarget.baseAtlas,"LevMax",295,16,80,20),a.addChild(this.levMax_0),this.zn_0=this.creatSUI(f,this.parentTarget.baseAtlas,"Zn",385,16,110,20),a.addChild(this.zn_0),this.needLev_0=this.creatSUI(f,this.parentTarget.baseAtlas,"NeedLev",520,16,45,20),a.addChild(this.needLev_0),this.select_0=this.creatGrid9SUI(f,this.parentTarget.baseAtlas,"Select",0,0,589,50,15,15),a.addChild(this.select_0)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.applyRender(),b){var c=new a.FactionEvent(a.FactionEvent.REFRESHAPPLYZHAOMUlIST_EVENT);c.data=this.itdata,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.refreshDraw=function(){this.itdata&&this.applyRender()},c.prototype.applyRender=function(){console.log("===this.itdata==",this.itdata);var a=this.itdata,b=a.data,c=tb.Tb_faction_base.get_Tb_faction_baseById(b.vo.level);this.bg_0.addEventListener(InteractiveEvent.Down,this.equClick,this),a.id%2?LabelTextFont.clearLabel(this.uiAtlas,this.bg_0.skinName):UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.bg_0.skinName,"bg"),b.isok?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.b_S_0.skinName,UIData.publicUi,PuiData.SELECT_1):LabelTextFont.clearLabel(this.uiAtlas,this.b_S_0.skinName),this.setIcon(a),LabelTextFont.writeSingleLabel(this.uiAtlas,this.n_0.skinName,"[853d07]"+getBaseName(b.vo.faction_name),16,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.lev_0.skinName,"[853d07]"+String(b.vo.level),16,TextAlign.CENTER);var d=b.vo.player_count+"/"+c.maxnum;LabelTextFont.writeSingleLabel(this.uiAtlas,this.levMax_0.skinName,"[853d07]"+d,16,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.zn_0.skinName,"[853d07]"+getBaseName(b.vo.faction_bz),16,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.needLev_0.skinName,"[853d07]"+String(b.vo.minlev),16,TextAlign.CENTER),this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.select_0.skinName,UIData.publicUi,PuiData.Select):LabelTextFont.clearLabel(this.uiAtlas,this.select_0.skinName)},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():(this.bg_0.removeEventListener(InteractiveEvent.Up,this.equClick,this),this.setnull())},c.prototype.setnull=function(){UiDraw.clearUI(this.bg_0),UiDraw.clearUI(this.b_S_0),UiDraw.clearUI(this.i_0),UiDraw.clearUI(this.n_0),UiDraw.clearUI(this.lev_0),UiDraw.clearUI(this.levMax_0),UiDraw.clearUI(this.zn_0),UiDraw.clearUI(this.needLev_0),UiDraw.clearUI(this.select_0)},c.prototype.equClick=function(a){this.setSelect()},c.prototype.setIcon=function(a){var b=this,c=a.data,d=0==c.vo.icon?1:c.vo.icon;IconManager.getInstance().getIcon(getload_FacBuildUrl(String(d)),function(a){var c=b._baseRender.uiAtlas.getRec(b.i_0.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg40,new Rectangle(0,0,42,42),UIData.publicUi),d.drawImage(a,0,0,a.width,a.height,1,1,40,40),b._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},c}(SListItem);a.ApplyZhaoMuListItemRender=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.initUiAtlas=function(a,b){this._bottomRender.uiAtlas=a,this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a;var c=this._topRender;this.initView(c)},b.prototype.initView=function(a){var a=this._baseRender;this.addChild(a.getComponent("a_1")),this.a_left=this._topRender.getComponent("a_left"),this.a_left.addEventListener(InteractiveEvent.Up,this.butClik,this),this.a_right=this._topRender.getComponent("a_right"),this.a_right.addEventListener(InteractiveEvent.Up,this.butClik,this),this.addChild(a.getComponent("a_2")),this._a_3=this.addChild(this._topRender.getComponent("a_3")),this._a_9=this.addChild(this._topRender.getComponent("a_9")),this.addChild(this._topRender.getComponent("a_4")),this.addEvntBut("a_6",a),this.a_5=this.addChild(this._topRender.getComponent("a_5")),this.addChild(a.getComponent("a_7"));var b=this.addEvntButUp("cnew_btn1",this._publicRender);this.setSizeForPanelUiCopy(b,"btnBg",a),this.addChild(this._topRender.getComponent("f_1_1")),this._pagenum=this.addChild(this._topRender.getComponent("a_8")),this._btncompentent=new Array;for(var c=0;15>c;c++){var d=this.addEvntBut("p_"+c,this._topRender);this._btncompentent.push(d)}this.resize(),this.initData()},b.prototype.initData=function(){this._faction_icon_ary=tb.Tb_faction_icon.getTempByID(),this._allpage=Math.floor(this._faction_icon_ary.length/15)+1,this._currentpage=1,this._msgTxt="名字3-6个汉字",this._type=!1,this.refreshInputBfun(this._msgTxt,this._type)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.set_a_9=function(){var a=tb.TB_faction_creat.getItemById(1);this._canbuy=UiDraw.drawRewardIconAndtxt(this._a_9,a.cost[0],!0,TextAlign.LEFT,10)},b.prototype.setvisiableleft_right=function(){return 1==this._allpage?void this.setUiListVisibleByItem([this.a_left,this.a_right],!1):this._allpage==this._currentpage?(this.setUiListVisibleByItem([this.a_right],!1),void this.setUiListVisibleByItem([this.a_left],!0)):1==this._currentpage&&this._allpage>1?(this.setUiListVisibleByItem([this.a_right],!0),void this.setUiListVisibleByItem([this.a_left],!1)):this._currentpage<this._allpage?void this.setUiListVisibleByItem([this.a_left,this.a_right],!0):void 0},b.prototype.setnum=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._pagenum.skinName,this._currentpage+"/"+this._allpage,16,TextAlign.CENTER,ColorType.Brown7a2f21)},b.prototype.drawPicAll=function(){var a=this._currentpage-1;this.defaultData();for(var b=0;b<this._btncompentent.length;b++){var c=15*a+b;if(c<this._faction_icon_ary.length){var d=this._faction_icon_ary[c];d.isvisiable=!0,this.btnSetData(this._btncompentent[b],d),this.drawPic(this._btncompentent[b])}else this.btnSetData(this._btncompentent[b]),this.setnull(this._btncompentent[b])}},b.prototype.defaultData=function(){for(var a=0;a<this._faction_icon_ary.length;a++)this._faction_icon_ary[a].isvisiable=!1},b.prototype.btnSetData=function(a,b){void 0===b&&(b=null),a.data=b,a.enable=!0},b.prototype.setnull=function(a){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,a.skinName,"",16,TextAlign.LEFT),a.enable=!1},b.prototype.drawPic=function(a){var b=this,c=a.data;IconManager.getInstance().getIcon(getload_FacBuildUrl(String(c.icon)),function(d){var e=b._baseRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),f.drawImage(d,0,0,d.width,d.height,4,4,60,60),c.isactivityflag&&UiDraw.cxtDrawImg(f,PuiData.A_HIGHT_F,new Rectangle(3,3,62,62),UIData.publicUi),b._baseRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},b.prototype.drawPicProp100=function(a){var b=this,c=a.data;IconManager.getInstance().getIcon(getload_FacBuildUrl(String(c.icon)+"_c"),function(c){var d=b._baseRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.PropBg100,new Rectangle(0,0,108,108),UIData.publicUi),e.drawImage(c,0,0,c.width,c.height,4,4,100,100),b._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.resetData(),this.setselect(this._btncompentent[0])},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.prototype.resetData=function(){this.drawPicAll(),this.setnum(),this.set_a_9(),this.setvisiableleft_right()},b.prototype.setselect=function(a){if(this._lastData){var b=this._lastData;b.isactivityflag=!1;for(var c=0;c<this._btncompentent.length;c++){var d=this._btncompentent[c].data;if(d&&d.id&&d.id==b.id){this.btnSetData(this._btncompentent[c],b),this.drawPic(this._btncompentent[c]);break}}}var e=a.data;e.isactivityflag=!0,this.btnSetData(a,e),this.drawPic(a),this._a_3.data=e,this.drawPicProp100(this._a_3),this._lastData=a.data;for(var f=0;f<this._faction_icon_ary.length;f++)if(this._faction_icon_ary[f].id==e.id){this._faction_icon_ary.splice(f,1,e);break}},b.prototype.butClik=function(a){var b=this;switch(a.target.name){case"cnew_btn1":if(UiTweenScale.getInstance().changeButSize(a.target),this._lastData&&this._canbuy&&this._type&&this._msgTxt.length>=3&&this._msgTxt.length<=6)this.createFaction(this._lastData.icon);else if(this._canbuy)msgtip.MsgTipManager.outStrById(22,27);else{var c=tb.TB_faction_creat.getItemById(1),d=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);d.data=c.cost[0][0],ModuleEventManager.dispatchEvent(d)}break;case"p_0":case"p_1":case"p_2":case"p_3":case"p_4":case"p_5":case"p_6":case"p_7":case"p_8":case"p_9":case"p_10":case"p_11":case"p_12":case"p_13":case"p_14":this.setselect(a.target);break;case"a_left":UiTweenScale.getInstance().changeButSize(a.target),this._currentpage-=1,this.resetData();break;case"a_right":UiTweenScale.getInstance().changeButSize(a.target),this._currentpage+=1,this.resetData();break;case"a_6":InputPanel.show(function(a){b.inputBfun(a)},this._type?this._msgTxt:"",2,12)}},b.prototype.inputBfun=function(a){a.length>0?(this._type=!0,this._msgTxt=a):(this._type=!1,this._msgTxt="名字3-6个汉字"),this.refreshInputBfun(this._msgTxt,this._type)},b.prototype.refreshInputBfun=function(a,b){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_5.skinName,a,16,TextAlign.CENTER,ColorType.colorb96d49)},b.prototype.createFaction=function(a){NetManager.getInstance().protocolos.create_faction(this._msgTxt,a)},b}(UIVirtualContainer);a.ApplyBuildPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(){function a(){}return a}();a.Avo=b;var c=function(b){function c(){var a=b.call(this)||this;return a._num=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,this.applylist&&(this.applylist.dispose(),this.applylist=null)},c.prototype.initUiAtlas=function(b,c){this._bottomRender.uiAtlas=b,this._publicRender.uiAtlas=c,this._baseRender.uiAtlas=b,this._topRender.uiAtlas=b,this.applylist=new a.ApplyZhaoMuListPanel,this.applylist.init(b),this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.a_left1=this._topRender.getComponent("a_left1"),this.a_left1.addEventListener(InteractiveEvent.Up,this.butClik,this),this.a_right1=this._topRender.getComponent("a_right1"),this.a_right1.addEventListener(InteractiveEvent.Up,this.butClik,this),this._pagenum=this.addChild(this._topRender.getComponent("a_8_1")),this.addChild(a.getComponent("a_2_1"));var b=this.addChild(a.getComponent("xbg1_2"));b.isU=!0,this.addUIList(["f_1_2"],this._topRender),this._a_3_1=this.addChild(this._topRender.getComponent("a_3_1")),this.addUIList(["b_bg4","b_bg5","a_10","a_11","a_12","a_13","a_14","a_17_0","a_17_1","a_17_2","a_17_3","a_16","line2","line4"],a),this.a_18=this.addChild(a.getComponent("a_18"));this.addChild(a.getComponent("a_15"));this.btn1=this.addEvntButUp("f_1_0",this._topRender),this.b_bg2=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.b_bg2,"btnBg",a),this.b_01=this.addEvntBut("b_01",this._topRender),this._a_20=this.addChild(this._topRender.getComponent("a_20")),this._a_19=this.addChild(this._topRender.getComponent("a_19")),this._currentpage=1,this.resetData(new SListItemData),this.resize()},c.prototype.setFactionInfo=function(a){this._selectdata=a,this.resetData(a)},c.prototype.setnum=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._pagenum.skinName,this._currentpage+"/"+this._allpage,16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.resetData=function(a){this.setDataToUicompontent(this._a_3_1,a),this.drawSelect()},c.prototype.setvisiableleft_right=function(){return 1==this._allpage?void this.setUiListVisibleByItem([this.a_left1,this.a_right1],!1):this._allpage==this._currentpage?(this.setUiListVisibleByItem([this.a_right1],!1),void this.setUiListVisibleByItem([this.a_left1],!0)):1==this._currentpage&&this._allpage>1?(this.setUiListVisibleByItem([this.a_right1],!0),void this.setUiListVisibleByItem([this.a_left1],!1)):this._currentpage<this._allpage?void this.setUiListVisibleByItem([this.a_left1,this.a_right1],!0):void 0},c.prototype.setDataToUicompontent=function(a,b){a.data=b},c.prototype.drawSelect=function(){var a=this,b=this._a_3_1.data;if(b){var c=b.data;if(c){var d=0==c.vo.icon?1:c.vo.icon;IconManager.getInstance().getIcon(getload_FacBuildUrl(String(d+"_c")),function(b){var c=a._baseRender.uiAtlas.getRec(a._a_3_1.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg100,new Rectangle(0,0,c.pixelWitdh,c.pixelHeight),UIData.publicUi),d.drawImage(b,0,0,b.width,b.height,4,4,b.width,b.height),a._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)}),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._a_20.skinName,"[853d07]"+getBaseName(c.vo.faction_bz),16,TextAlign.CENTER),LabelTextFont.writeText(this._topRender.uiAtlas,this._a_19.skinName,10,0,c.vo.faction_gg?c.vo.faction_gg:"四海之内皆兄弟，欢迎加入我们的大家庭",16,"#853d07",180,!0)}else UiDraw.uiAtlasDrawImg(this._topRender.uiAtlas,this._a_3_1.skinName,UIData.publicUi,PuiData.PropBg100)}},c.prototype.getList=function(){NetManager.getInstance().protocolos.faction_getlist(this._currentpage,5,this._num%2)},c.prototype.getDataAndRefresh=function(a){this._allpage=0==a.maxpag?1:a.maxpag,this._currentpage=a.curpag,this.setvisiableleft_right(),this.setnum(),this.applylist.refreshDataByNewData(a.list)},c.prototype.resize=function(){b.prototype.resize.call(this),this.applylist.top=this.a_18.parent.y/UIData.Scale+this.a_18.y+this.a_18.height,this.applylist.left=this.a_18.parent.x/UIData.Scale+this.a_18.x},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.applylist.show(),this.getList()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.applylist.hide()},c.prototype.applyJoin=function(a){NetManager.getInstance().protocolos.faction_join(a)},c.prototype.butClik=function(b){switch(UiTweenScale.getInstance().changeButSize(b.target),b.target){case this.btn1:NetManager.getInstance().protocolos.faction_fast_join();break;case this.b_bg2:if(this._selectdata&&this._selectdata.data){var c=new a.FactionEvent(a.FactionEvent.REFRESHAPPLYZHAOMUlISTISOK_EVENT);c.data=this._selectdata,ModuleEventManager.dispatchEvent(c),this.applyJoin(this._selectdata.data.vo.faction_guid)}else msgtip.MsgTipManager.outStrById(22,28);UIManager.popClikNameFun(this.b_bg2.name,SharedDef.MODULE_FACTION);break;case this.a_left1:this._currentpage-=1,this.getList();break;case this.a_right1:this._currentpage+=1,this.getList();break;case this.b_01:this._num++,this.getList()}},c}(UIVirtualContainer);a.ApplyZhaomuPanel=c}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(){function a(){}return a}();a.BtnVo=b;var c=function(c){function f(){var a=c.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a}return __extends(f,c),f.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this.personListPanel&&(this.personListPanel.dispose(),this.personListPanel=null)},f.prototype.initUiAtlas=function(b,c){this._bgRender.uiAtlas=b,this._bottomRender.uiAtlas=c,this._baseRender.uiAtlas=b,this._topRender.uiAtlas=b;var d=this._topRender;this.personListPanel=new a.PersonListPanel,this.personListPanel.init(b),this.initView(d)},f.prototype.initView=function(a){var a=this._topRender;this.line_3=this.addChild(a.getComponent("line1")),this.addUIList(["a_16","a_15","line4A1","line4A2","line4A3","line4A4","line4A5","line4A6"],a),this.title_2=this.addEvntButUp("a_zhanli",this._baseRender),this.title_0=this.addEvntButUp("a_zhiwu",this._baseRender),this.title_1=this.addEvntButUp("a_lev",this._baseRender),this.title_3=this.addEvntButUp("a_gx",this._baseRender),this.title_4=this.addEvntButUp("a_huoyue",this._baseRender),this.arrayUIcomponent=new Array,this.arrayUIcomponent.push(this.title_0),this.arrayUIcomponent.push(this.title_1),this.arrayUIcomponent.push(this.title_2),this.arrayUIcomponent.push(this.title_3),this.arrayUIcomponent.push(this.title_4),this.refreshUIdata(),this.arraySelectButton=new Array;for(var b=0;5>b;b++){var c=this.addChild(a.getComponent("j_"+b));this.arraySelectButton.push(c)}this.bottomLeftPanel=new d,this.bottomLeftPanel.setRender(this._bgRender,this._bottomRender,this._baseRender,this._topRender),this.addVirtualContainer(this.bottomLeftPanel),this.rightPanel=new e,this.rightPanel.setRender(this._bgRender,this._bottomRender,this._baseRender,this._topRender,this._redPointRender),this.rightPanel.parent=this,this.addVirtualContainer(this.rightPanel),this.resize()},f.prototype.refreshUIdata=function(){for(var a=0;a<this.arrayUIcomponent.length;a++){var c=new b;c.indexselect=!1,c.index=a,this.arrayUIcomponent[a].data=c}},f.prototype.resetUiState=function(a,b){var c=this.arraySelectButton[a];if(this._lastselect==a)this.arrayUIcomponent[a].data.indexselect=!this.arrayUIcomponent[a].data.indexselect;else{this._lastselect=a,this.SortType=a,this.setUiListVisibleByItem(this.arraySelectButton,!1),c.parent||this.addChild(c),this.arrayUIcomponent[a].data.indexselect=!1;for(var d=0;5>d;d++){var e=this.arrayUIcomponent[d],f="t_"+d+"_0";a==d&&(f="t_"+d+"_1"),UiDraw.SharedDrawImg(this._baseRender.uiAtlas,this._baseRender.uiAtlas,e.skinName,f)}}c.selected=this.arrayUIcomponent[a].data.indexselect,this.SortFlag=c.selected,this.personListPanel.refreshDataByNewData(GuidData.faction.getFactionListBySortType(a,c.selected),b)},f.prototype.resize=function(){c.prototype.resize.call(this),this.personListPanel.top=this.line_3.parent.y/UIData.Scale+this.line_3.y+6,this.personListPanel.left=this.line_3.parent.x/UIData.Scale+this.line_3.x-4},f.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.personListPanel.show(),this._lastselect=-1,this.rightPanel.resetData(),this.resetUiState(0,!0)},f.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.personListPanel.hide()},f.prototype.butClik=function(a){switch(a.target){case this.title_0:case this.title_1:case this.title_2:case this.title_3:case this.title_4:this.resetUiState(a.target.data.index,!1)}},f}(UIVirtualContainer);a.FactionPersonPanel=c;var d=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setRender=function(a,b,c,d){this._bgRender=a,this._bottomRender=b,this._topRender=d,this._baseRender=c,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.addChild(this._topRender.getComponent("a_1")),this._a_10=this.addChild(this._topRender.getComponent("a_10")),this.addChild(this._baseRender.getComponent("b_bg3A1")),this.initData()},b.prototype.initData=function(){this.resetData()},b.prototype.resetData=function(){var a=GuidData.faction.getFactionList(),b=this.getOnlineNum(a);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._a_10.skinName,b+"/"+a.length,16,TextAlign.CENTER,"#853d07")},b.prototype.getOnlineNum=function(a){for(var b=0,c=0;c<a.length;c++)a[c].isOnline&&b++;return b},b.prototype.butClik=function(a){switch(a.target.name){}},b}(UIVirtualContainer);a.BottomLeftPanel=d;var e=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(c,b),c.prototype.setRender=function(a,b,c,d,e){this._bgRender=a,this._bottomRender=b,this._topRender=d,this._baseRender=c,this._redRender=e,this.loadConfigCom()},c.prototype.loadConfigCom=function(){this.addChild(this._bgRender.getComponent("b_bg1")),this.addChild(this._topRender.getComponent("x_bg1A1"));var a=this.addChild(this._topRender.getComponent("x_bg1A2"));a.isU=!0,this.addChild(this._baseRender.getComponent("b_bg4")),this.addChild(this._baseRender.getComponent("b_bg5")),this.addUIList(["a_4","a_5","a_6","a_7","a_8"],this._topRender),this.addUIList(["b_bg3A2","b_bg3A3","b_bg3A4","b_bg3A5"],this._baseRender),this.a_3=this.addChild(this._topRender.getComponent("a_3")),this.a_2=this.addChild(this._topRender.getComponent("a_2")),this.a_9=this.addChild(this._topRender.getComponent("a_9")),this._a_13=this.addChild(this._topRender.getComponent("a_13")),this._a_12=this.addChild(this._topRender.getComponent("a_12")),this._a_14=this.addChild(this._topRender.getComponent("a_14")),this._a_11=this.addChild(this._topRender.getComponent("a_11")),this.b_exit=this.addChild(this._topRender.getComponent("b_exit")),this.b_exit.addEventListener(InteractiveEvent.Up,this.butClik,this),this.aryUIcompenent=new Array,this.b_edit=this._topRender.getComponent("b_edit"),this.b_edit.addEventListener(InteractiveEvent.Up,this.butClik,this),this.aryUIcompenent.push(this.b_edit),this.b_btnbg_zhoamu=this._baseRender.getComponent("b_btnbg_zhoamu"),this.b_btnbg_zhoamu.addEventListener(InteractiveEvent.Up,this.butClik,this),this.aryUIcompenent.push(this.b_btnbg_zhoamu),this._redRender.getRedPointUI(this,62,new Vector2D(this.b_btnbg_zhoamu.x+this.b_btnbg_zhoamu.width,this.b_btnbg_zhoamu.y)),this.resize()},c.prototype.resetFactionLev=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._a_11.skinName,String(GuidData.faction.getLev()),16,TextAlign.LEFT,"#853d07")},c.prototype.resetFactionMoney=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._a_12.skinName,Snum(GuidData.faction.getMoney()),16,TextAlign.LEFT,"#853d07")},c.prototype.resetFactionContribution=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._a_13.skinName,String(GuidData.faction.getFactionForce()),16,TextAlign.LEFT,"#853d07")},c.prototype.resetFactionPlayerNum=function(){var a=GuidData.faction.getLev(),b=tb.Tb_faction_base.get_Tb_faction_baseById(a),c=GuidData.faction.getFactionList();LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._a_14.skinName,c.length+"/"+b.maxnum,16,TextAlign.LEFT,"#853d07")},c.prototype.resetFactionIcon=function(){var a=this,b=0==GuidData.faction.getIcon()?1:GuidData.faction.getIcon();IconManager.getInstance().getIcon(getload_FacBuildUrl(String(b)),function(b){var c=a._baseRender.uiAtlas.getRec(a.a_3.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(b,0,0,b.width,b.height,4,4,60,60),a._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)}),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_2.skinName,"[853d07]"+getBaseName(GuidData.faction.getName()),16,TextAlign.CENTER)},c.prototype.resetFactionNotice=function(){var a=GuidData.faction.getNotice();if(a){var b=a.split("");0==b[1].length?b[1]="":b[1]="QQ:"+b[1],0==b[2].length?b[2]="":b[2]="微信:"+b[2],LabelTextFont.writeText(this._topRender.uiAtlas,this.a_9.skinName,0,0,a?b[0]+"\n"+b[1]+"\n"+b[2]:"",14,"#853d07",200,!0)}},c.prototype.resetFactionIdentity=function(){GuidData.faction.playerIdentity<4?this.setUiListVisibleByItem(this.aryUIcompenent,!0):this.setUiListVisibleByItem(this.aryUIcompenent,!1),1==GuidData.faction.playerIdentity?this.b_exit.goToAndStop(1):this.b_exit.goToAndStop(0)},c.prototype.resetData=function(){this.resetFactionIcon(),this.resetFactionLev(),this.resetFactionPlayerNum(),this.resetFactionMoney(),this.resetFactionContribution(),this.resetFactionNotice(),this.resetFactionIdentity()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.butClik=function(b){switch(UiTweenScale.getInstance().changeButSize(b.target),b.target){case this.b_btnbg_zhoamu:this.parent;ModuleEventManager.dispatchEvent(new a.FactionEvent(a.FactionEvent.SHOW_FACTIONRECRUITING_EVENT)),console.log("--已经发送--");break;case this.b_edit:this.parent;ModuleEventManager.dispatchEvent(new a.FactionEvent(a.FactionEvent.SHOW_FACTIONNOTICE_EVENT));break;case this.b_exit:var c;c=1==GuidData.faction.playerIdentity?"是否解散家族":"是否退出家族",AlertUtil.show(c,"提示",function(a){1==a&&NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_QUIT,0,0,"","")})}},c.prototype.backFun=function(a){1==a&&NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_LEVEL_UP,0,0,"","")},c}(UIVirtualContainer);a.RightPanel=e}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._bgInit=!1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,
this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null},c.prototype.initUiAtlas=function(a,b){this._bgRender.uiAtlas=a,this._bottomRender.uiAtlas=a,this._baseRender.uiAtlas=a,this.parentWindow=b;var c=this._baseRender;this.initView(c)},c.prototype.onAdd=function(){this.showBg()},c.prototype.onRemove=function(){this.hideBg()},c.prototype.showBg=function(){if(this.parentWindow&&!this._bgInit){var a=this.parentWindow.loadBigPicByUrl("ui/uidata/faction/factionbg.png");this._bgInit=!0,a.width=824,a.height=448}this.parentWindow&&this.parentWindow.addBigPic()},c.prototype.hideBg=function(){this.parentWindow&&this.parentWindow.removeBigPic()},c.prototype.initView=function(b){var b=this._baseRender,c=this.addChild(this._baseRender.getComponent("x_bg1A2"));c.isU=!0;var d=a.FactionBuildModel.getInstance().getList();this._aryBgUI=new Array,this._aryLevUI=new Array,this._aryNameUI=new Array,this._aryOpenUI=new Array;for(var e=0;e<d.length;e++){var f=this.addChild(this._bgRender.getComponent("b_btnbg"+e));f.addEventListener(InteractiveEvent.Up,this.equClick,this),this._aryBgUI.push(f),this._aryLevUI.push(this.addChild(b.getComponent("b_lev"+e))),this._aryNameUI.push(this.addChild(b.getComponent("b_name"+e))),this._aryOpenUI.push(this.addChild(b.getComponent("b_noopen"+e)))}},c.prototype.resetData=function(){var b=a.FactionBuildModel.getInstance().getList();console.log("---ary---",b);for(var c=0;c<b.length;c++)this._aryBgUI[c].data=b[c],this.setUiListVisibleByItem([this._aryOpenUI[c]],2==b[c].state),this.setUiListVisibleByItem([this._aryLevUI[c]],2!=b[c].state),this.setUiListVisibleByItem([this._aryNameUI[c]],2!=b[c].state),this._aryBgUI[c].x=b[c].data.pos[0],this._aryBgUI[c].y=b[c].data.pos[1],2!=b[c].state?(LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this._aryLevUI[c].skinName,"Lv"+b[c].data.level,16,TextAlign.CENTER,ColorType.Whitefffce6),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this._aryNameUI[c].skinName,String(b[c].data.name),16,TextAlign.CENTER,ColorType.Whitefffce6),this._aryNameUI[c].x=this._aryLevUI[c].x=this._aryBgUI[c].x+19,this._aryLevUI[c].y=this._aryBgUI[c].y+5,this._aryNameUI[c].y=this._aryBgUI[c].y+25):(this._aryOpenUI[c].x=this._aryBgUI[c].x+48,this._aryOpenUI[c].y=this._aryBgUI[c].y+12);this.resize()},c.prototype.equClick=function(a){UiTweenScale.getInstance().changeButSize(a.target);var b=a.target.data;return 2==b.state?void msgtip.MsgTipManager.outStrById(22,56):void ModulePageManager.openPanel(b.data["goto"],b.data.goto_sub)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.resetData()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(UIVirtualContainer);a.FactionFunctionPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function e(){var a=b.call(this)||this;return a.setBlackBg(),a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._AtopRender1=new UIRenderComponent,a._BtopRender1=new UIRenderComponent,a._BtopRender2=new UIRenderComponent,a._BtopRender3=new UIRenderComponent,a.ARenderList=new Array,a.ARenderList.push(a._AtopRender1),a.BRenderList=new Array,a.BRenderList.push(a._BtopRender1),a.BRenderList.push(a._BtopRender2),a.BRenderList.push(a._BtopRender3),a}return __extends(e,b),e.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this.shengpiPanel&&(this.shengpiPanel.dispose(),this.shengpiPanel=null),this.zhaomuSettingPanel&&(this.zhaomuSettingPanel.dispose(),this.zhaomuSettingPanel=null),this.applyFactionList&&(this.applyFactionList.dispose(),this.applyFactionList=null),b.prototype.dispose.call(this)},e.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas=new UIAtlas,this._bgRender.uiAtlas.setInfo("ui/uidata/faction/zhaomu/recruiting.xml","ui/uidata/faction/zhaomu/recruiting.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionpc.png")},e.prototype.loadConfigCom=function(){this._AtopRender1.uiAtlas=this._bgRender.uiAtlas,this._BtopRender1.uiAtlas=this._bgRender.uiAtlas,this._BtopRender2.uiAtlas=this._bgRender.uiAtlas,this._BtopRender3.uiAtlas=this._bgRender.uiAtlas,this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this.tab_shenpi=this.addEvntBut("tab_shenpi",this._bgRender),this.tab_zhaosetting=this.addEvntBut("tab_zhaomu",this._bgRender),this.addChild(this._bgRender.getComponent("a_5")),this.no=this.addChild(this._bgRender.getComponent("no"));var a=this.addChild(this._publicbgRender.getComponent("cnew_infobg"));this.setSizeForPanelUiCopy(a,"g_bg_2",this._bgRender),this.shengpiPanel=new c,this.shengpiPanel.setRender(this._AtopRender1,this._publicbgRender),this.addVirtualContainer(this.shengpiPanel),this.zhaomuSettingPanel=new d,this.zhaomuSettingPanel.setRender(this._BtopRender1,this._BtopRender2,this._BtopRender3,this._publicbgRender),this.zhaomuSettingPanel.parent=this,this.addVirtualContainer(this.zhaomuSettingPanel),this.applyLoadComplete()},e.prototype.selecttype=function(b){0==b?(this.tab_shenpi.selected=!0,this.tab_zhaosetting.selected=!1,this.renderSetVisibel(this.ARenderList,!0),this.renderSetVisibel(this.BRenderList,!1),this.applyFactionList||(this.applyFactionList=new a.ApplyFactionList,this.applyFactionList.init(this._bgRender.uiAtlas)),this.applyFactionList.show()):(this.tab_zhaosetting.selected=!0,this.tab_shenpi.selected=!1,this.renderSetVisibel(this.BRenderList,!0),this.renderSetVisibel(this.ARenderList,!1),this.applyFactionList&&this.applyFactionList.hide()),this.selectdata(b)},e.prototype.selectdata=function(a){this._type!=a&&(this._type=a,this.shengpiPanel&&this.shengpiPanel.setSelect(!a),this.zhaomuSettingPanel&&this.zhaomuSettingPanel.setSelect(0!=a),this.resize())},e.prototype.resize=function(){b.prototype.resize.call(this),this.applyFactionList&&(this.applyFactionList.left=this.no.parent.x/UIData.Scale+this.no.x,this.applyFactionList.top=this.no.parent.y/UIData.Scale+this.no.y)},e.prototype.show=function(){console.log("-----招募页面"),this.hasStage||UIManager.getInstance().addUIContainer(this),this.selecttype(0)},e.prototype.hide=function(){this.hasStage&&(UIManager.getInstance().removeUIContainer(this),this.applyFactionList.hide())},e.prototype.butClik=function(a){switch(a.target){case this.c_close:this.hide();break;case this.tab_shenpi:this.selecttype(0);break;case this.tab_zhaosetting:this.selecttype(1)}},e.ServerMaxLev=60,e}(WindowCentenMin);a.RecruitingPanel=b;var c=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b}return __extends(b,a),b.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null},b.prototype.setRender=function(a,b){this._bgRender=a,this._publicRender=b,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.addUIList(["a_19","a_20","a_18","a_17","line_4","line_2_7","line_2_8","line_2_9","a_23","a_22"],this._bgRender),this._uiAry=new Array,this.b_btnbg_no=this.addEvntBut("cnew_but_no",this._publicRender),this.setSizeForPanelUiCopy(this.b_btnbg_no,"b_btnbg_no",this._bgRender),this._uiAry.push(this.b_btnbg_no),this.b_btnbg_ok=this.addEvntBut("cnew_but_yes",this._publicRender),this.setSizeForPanelUiCopy(this.b_btnbg_ok,"b_btnbg_ok",this._bgRender),this._uiAry.push(this.b_btnbg_ok)},b.prototype.setSelect=function(a){this.setUiListVisibleByItem(this._uiAry,a)},b.prototype.butClik=function(a){switch(a.target){case this.b_btnbg_no:NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_REFUSE_JOIN_ALL,0,0,"","");break;case this.b_btnbg_ok:NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_AGREE_JOIN_ALL,0,0,"","")}},b}(UIVirtualContainer);a.ShenpiPanel=c;var d=function(a){function c(){var b=a.call(this)||this;return b._tx1=3,b._tx2=0,b._lastMouseX=0,b._lastMcX=0,b._percentage=0,b._msgTxt="在此输入文字（50）",b._type=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b}return __extends(c,a),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._baseRender.dispose(),this._baseRender=null},c.prototype.setRender=function(a,b,c,d){this._bgRender=a,this._bottomRender=b,this._baseRender=c,this._publicRender=d,this.loadConfigCom()},c.prototype.loadConfigCom=function(){var a=this._baseRender;this.b_selectbtn=this.addChild(a.getComponent("b_selectbtn")),this.a_33=this.addChild(a.getComponent("a_33")),this.a_25=this.addEvntBut("a_25",a),this.a_37=this.addChild(a.getComponent("a_37")),this.minlev=this.addChild(a.getComponent("a_35")),this.maxlev=this.addChild(a.getComponent("a_36")),this.a_26=this.addChild(this._bottomRender.getComponent("a_26")),this.a_27=this.addChild(this._bgRender.getComponent("a_27")),this.a_32=this.addChild(this._bgRender.getComponent("a_32")),this.addUIList(["c_4","c_3"],this._bottomRender),this.addUIList(["a_24_1","a_24_2"],this._bgRender),this.addUIList(["a_28","a_29","a_34","a_30"],a),this._aryUI=new Array,this.b_bg5=this.addEvntBut("cnew_txtbg",this._publicRender),this.setSizeForPanelUiCopy(this.b_bg5,"b_bg5",this._bottomRender),this._aryUI.push(this.b_bg5),this.b_btnbg_sure=this.addEvntBut("cnew_but_yes",this._publicRender),this.setSizeForPanelUiCopy(this.b_btnbg_sure,"b_btnbg_sure",this._bottomRender),this._aryUI.push(this.b_btnbg_sure)},c.prototype.initData=function(){LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.minlev.skinName,String(1),16,TextAlign.CENTER,ColorType.Orange853d07),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.maxlev.skinName,String(b.ServerMaxLev),16,TextAlign.CENTER,ColorType.Orange853d07);var a=GuidData.faction.getZhaomuGG();a&&a.length>0&&(this._msgTxt=a,this._type=!0),this.refreshInputBfun(this._msgTxt,this._type),this.b_selectbtn.selected=GuidData.faction.getAutoJoin(),this._currentLev=GuidData.faction.getJoinLimtLev(),this._percentage=GuidData.faction.getJoinLimtLev()/b.ServerMaxLev,this.drawProbar(this._percentage),this.setPercentage(this._currentLev),this.setcoordinates()},c.prototype.setSelect=function(a){this.setUiListVisibleByItem(this._aryUI,a),this.initData()},c.prototype.setcoordinates=function(){var a=this.a_27.width-this.a_25.width;this.a_25.x=this._percentage*a+this.a_27.x,this.a_32.x=this.a_25.x-this._tx1,this.a_33.x=this.a_25.x-this._tx2},c.prototype.A_left_bg_MouseDown=function(a){this._lastMouseX=a.x,this._lastMcX=this.a_25.x,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.A_left_bg_MouseMove=function(a){var c=this.a_27.x,d=this.a_27.x+this.a_27.width-this.a_25.width,e=this._lastMcX+(a.x-this._lastMouseX)/UIData.Scale,f=this.a_27.width-this.a_25.width;d>e&&e>c?(this.a_25.x=e,this.a_32.x=e-this._tx1,this.a_33.x=e-this._tx2):(this.a_25.x<c&&(this.a_25.x=c,this.a_32.x=c-this._tx1,this.a_33.x=c-this._tx2),this.a_25.x>d&&(this.a_25.x=d,this.a_32.x=d-this._tx1,this.a_33.x=d-this._tx2)),this._percentage=(this.a_25.x-this.a_27.x)/f,this.drawProbar(this._percentage),this._currentLev=Math.ceil(this._percentage*b.ServerMaxLev),this.setPercentage(this._currentLev)},c.prototype.drawProbar=function(a){0==a&&(a=.01),this.a_26.uvScale=a},c.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.setPercentage=function(a){LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_33.skinName,0==a?String(1):String(a),16,TextAlign.CENTER,ColorType.Whitefff4d6)},c.prototype.butClik=function(a){var b=this;switch(a.target){case this.a_25:this.A_left_bg_MouseDown(a);break;case this.b_bg5:InputPanel.show(function(a){b.inputBfun(a)},this._type?this._msgTxt:"",0,50);break;case this.b_btnbg_sure:if(this.dataChangFlag()){var c;c="在此处输入文字（50）"==this._msgTxt||""==this._msgTxt?"":this._msgTxt;var d=new ByteArray;if(d.writeUTF(c),d.length>100)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"字符太长",99);NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_RECRUIT,this.b_selectbtn.selected?1:0,this._currentLev,c,"")}var e=this.parent;e.hide()}},c.prototype.dataChangFlag=function(){return this.b_selectbtn.selected!=GuidData.faction.getAutoJoin()?!0:this._msgTxt!=GuidData.faction.getZhaomuGG()?!0:GuidData.faction.getJoinLimtLev()!=this._currentLev?!0:!1},c.prototype.inputBfun=function(a){a.length>0?(this._type=!0,this._msgTxt=a):(this._type=!1,this._msgTxt="在此处输入文字（50）"),this.refreshInputBfun(this._msgTxt,this._type)},c.prototype.refreshInputBfun=function(a,b){LabelTextFont.writeText(this._bgRender.uiAtlas,this.a_37.skinName,10,5,a,16,"#853d07",320,!0)},c}(UIVirtualContainer);a.ZhaomuSettingPanel=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._publicbgRender=new UIRenderComponent,b.addRender(b._publicbgRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;this._topRender.setInfo("ui/uidata/faction/gonggao/announcement.xml","ui/uidata/faction/gonggao/announcement.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._midRender.uiAtlas=this._topRender.uiAtlas;var a=this._topRender;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this.g_bg_6=this.addEvntBut("cnew_infobg",this._publicbgRender),this.setSizeForPanelUiCopy(this.g_bg_6,"g_bg_6",a),this.g_bg_7=this.addEvntBut("cnew_txtbg",this._publicbgRender),this.setSizeForPanelUiCopy(this.g_bg_7,"g_bg_7",a),this.g_bg_8=this.addEvntBut("cnew_txtbg",this._publicbgRender),this.setSizeForPanelUiCopy(this.g_bg_8,"g_bg_8",a),this._publicbgRender.applyObjData(),this.addUIList(["a_49","a_50","a_48"],a),this.addChild(this._midRender.getComponent("a_1")),this.b_btnbg_qr=this.addEvntBut("a_34_1",a),this.b_btnbg_qx=this.addEvntBut("a_51",a),this.GG=this.addChild(a.getComponent("a_52")),this.QQ=this.addChild(a.getComponent("a_54")),this.WeChat=this.addChild(a.getComponent("a_53")),this.applyLoadComplete()},b.prototype.initData=function(){var a=GuidData.faction.getNotice();if(a&&a.length>0){var b=a.split("");b[0].length>0?(this._msgTxtGG=b[0],this._type=!0):(this._msgTxtGG="在此处输入文字",this._type=!1),this._msgTxtQQ=b[1],this._msgTxtWeChat=b[2]}else this._msgTxtGG="在此处输入文字",this._type=!1,this._msgTxtQQ="",this._msgTxtWeChat="";this.refreshInputBfunGG(this._msgTxtGG,this._type),this.refreshInputBfunQQ(this._msgTxtQQ),this.refreshInputBfunWeChat(this._msgTxtWeChat)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),this.initData())},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){var b=this;switch(a.target){case this.c_close:this.hide();break;case this.g_bg_6:InputPanel.show(function(a){b.inputBfunGG(a)},this._type?this._msgTxtGG:"",0,200);break;case this.g_bg_7:InputPanel.show(function(a){b.inputBfunQQ(a)},this._msgTxtQQ);break;case this.g_bg_8:InputPanel.show(function(a){b.inputBfunWeChat(a)},this._msgTxtWeChat);break;case this.b_btnbg_qx:this.hide();break;case this.b_btnbg_qr:var c="",d="在此处输入文字"==this._msgTxtGG?"":this._msgTxtGG,e=d+c+this._msgTxtQQ+c+this._msgTxtWeChat,f=new ByteArray;if(f.writeUTF(e),f.length>100)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"字符太长",99);NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_NOTICE,0,0,e,""),this.hide()}},b.prototype.inputBfunGG=function(a){a.length>0?(this._type=!0,this._msgTxtGG=a):(this._type=!1,this._msgTxtGG="在此处输入文字"),this.refreshInputBfunGG(this._msgTxtGG,this._type)},b.prototype.inputBfunQQ=function(a){this._msgTxtQQ=a,this.refreshInputBfunQQ(a)},b.prototype.inputBfunWeChat=function(a){this._msgTxtWeChat=a,this.refreshInputBfunWeChat(a)},b.prototype.refreshInputBfunGG=function(a,b){LabelTextFont.writeText(this._topRender.uiAtlas,this.GG.skinName,10,5,a,16,"#853d07",320,!0)},b.prototype.refreshInputBfunQQ=function(a){var b=a.split("");""==b[1]&&(a=""),LabelTextFont.writeText(this._topRender.uiAtlas,this.QQ.skinName,10,5,a,16,"#853d07",180,!0)},b.prototype.refreshInputBfunWeChat=function(a){var b=a.split("");""==b[1]&&(a=""),LabelTextFont.writeText(this._topRender.uiAtlas,this.WeChat.skinName,10,5,a,16,"#853d07",180,!0)},b}(WindowCentenMin);a.NoticePanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b._publicbgRender=new UIRenderComponent,b.addRender(b._publicbgRender),b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b.cellMask=new UIMask,b.cellMask.x=298,b.cellMask.y=133,b.cellMask.width=365,b.cellMask.height=290,b.addMask(b.cellMask),b._midRender.mask=b.cellMask,b._topRender.mask=b.cellMask,b}return __extends(b,a),b.prototype.dispose=function(){this.cellMask&&(this.cellMask.dispose(),this.cellMask=null),this._bottomRender&&(this._bottomRender.dispose(),this._bottomRender=null),this._midRender&&(this._midRender.dispose(),this._midRender=null),this._topRender&&(this._topRender.dispose(),this._topRender=null),a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;this._midRender.setInfo("ui/uidata/faction/zhiwu/appointments.xml","ui/uidata/faction/zhiwu/appointments.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this.moveCellUi=new Array,this._topRender.uiAtlas=this._midRender.uiAtlas,this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this.addChild(this._topRender.getComponent("a_57")),this.b_btnbg_agree=this.addEvntButUp("cnew_but_yes",this._publicbgRender),this.setSizeForPanelUiCopy(this.b_btnbg_agree,"b_btnbg_agree",this._midRender),this.addUIList(["line_2_10","line_2_11","line_2_12","line_5","line_6","a_46","a_44","a_45","a_47","a_43"],this._bottomRender),this.moveCellUi=this.moveCellUi.concat(this.addUIList(["downbg1","downbg2","downbg3"],this._bottomRender)),this.moveCellUi=this.moveCellUi.concat(this.addUIList(["a_38","a_40","a_42","a_39","a_41"],this._topRender)),this._rewardary=new Array,this._permissionsary=new Array,this._numary=new Array,this._selectbtnary=new Array;for(var a=tb.Tb_faction_zhiwei.get_Tb_faction_zhiwei(),b=0;3>b;b++){var c=this.addChild(this._topRender.getComponent("personreward_"+b));c.addEventListener(InteractiveEvent.Up,this.RewardClik,this),c.data=a[b].reward,this.drawReward(c.skinName,a[b].reward),this._rewardary.push(c)}for(var b=0;5>b;b++){var c=this.addChild(this._topRender.getComponent("personInfo_"+b));this._permissionsary.push(c)}for(var b=0;4>b;b++)this._numary.push(this.addChild(this._topRender.getComponent("personNum_"+b)));this.b_select_0=this.addEvntBut("b_select_0",this._topRender),this.b_select_0.data=0,this._selectbtnary.push(this.b_select_0),this.b_select_1=this.addEvntBut("b_select_1",this._topRender),this.b_select_1.data=1,this._selectbtnary.push(this.b_select_1),this.b_select_2=this.addEvntBut("b_select_2",this._topRender),this.b_select_2.data=2,this._selectbtnary.push(this.b_select_2),this.b_select_3=this.addEvntBut("b_select_3",this._topRender),this.b_select_3.data=3,this._selectbtnary.push(this.b_select_3),this.b_select_4=this.addEvntBut("b_select_4",this._topRender),this.b_select_4.data=4,this._selectbtnary.push(this.b_select_4),this.initBasePos(),this.applyLoadComplete()},b.prototype.initBasePos=function(){this.moveCellUi=this.moveCellUi.concat(this._rewardary),this.moveCellUi=this.moveCellUi.concat(this._permissionsary),this.moveCellUi=this.moveCellUi.concat(this._numary),this.moveCellUi=this.moveCellUi.concat(this._selectbtnary),this.baseKeyDic=new Object;for(var a=0;a<this.moveCellUi.length;a++)this.baseKeyDic[this.moveCellUi[a].name]=this.moveCellUi[a].y},b.prototype.RewardClik=function(a){var b=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);b.id=a.target.data,ModuleEventManager.dispatchEvent(b)},b.prototype.drawReward=function(a,b){var c=this,d=TableData.getInstance().getData(TableData.tb_item_template,b);IconManager.getInstance().getIcon(geteqiconIconUrl(String(d.icon)),function(b){var d=c._topRender.uiAtlas.getRec(a),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.PropBg40,new Rectangle(0,0,46,46),UIData.publicUi),e.drawImage(b,0,0,60,60,3,3,40,40),c._topRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},b.prototype.getNum=function(a){for(var b=GuidData.faction.getFactionList(),c=0,d=0;d<b.length;d++)b[d].identity==a&&c++;return c},b.prototype.SelectThisBtn=function(a){console.log(a);for(var b=0;b<this._selectbtnary.length;b++){var c=!1;b==a&&(c=!0),this._selectbtnary[b].selected=c}},b.prototype.initData=function(){this._currentSelect=this._data.factionItemData.identity-1,this.SelectThisBtn(this._data.factionItemData.identity-1);for(var a=0;a<this._numary.length;a++){var b=this._numary[a],c=tb.Tb_faction_zhiwei.get_Tb_faction_zhiweiById(a+1),d=this.getNum(a+1)+"/"+c.num;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,b.skinName,d,16,TextAlign.CENTER,ColorType.Orange853d07)}this.changePostion()},b.prototype.changePostion=function(){var a=0;switch(GuidData.faction.playerIdentity){case 1:a=0;break;case 2:a=78;break;case 3:a=138;break;case 4:a=0;break;default:a=0}for(var b=0;b<this.moveCellUi.length;b++)this.moveCellUi[b].y=this.baseKeyDic[this.moveCellUi[b].name]-a},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.show=function(a){this._data=a.data,this.hasStage||UIManager.getInstance().addUIContainer(this),this.initData()},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.prototype.backFun=function(a){1==a&&(NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_APPOINT,1,0,this._data.factionItemData.guid,""),this.hide())},b.prototype.butClik=function(a){var b=this;switch(a.target){case this.b_btnbg_agree:var c=tb.Tb_faction_zhiwei.get_Tb_faction_zhiweiById(this._currentSelect+1);0==this._currentSelect?AlertUtil.show("您将进行族长转移，是否确认此操作？","提示",function(a){b.backFun(a)}):this._currentSelect==this._data.factionItemData.identity-1?this.hide():this.getNum(this._currentSelect+1)<c.num?(NetManager.getInstance().protocolos.faction_manager(SharedDef.FACTION_MANAGER_TYPE_APPOINT,this._currentSelect+1,0,this._data.factionItemData.guid,""),this.hide()):this.getNum(this._currentSelect+1)>=c.num&&msgtip.MsgTipManager.outStrById(22,15);break;case this.b_select_0:case this.b_select_1:case this.b_select_2:case this.b_select_3:case this.b_select_4:this._currentSelect=a.target.data,this.SelectThisBtn(a.target.data);break;case this.c_close:this.hide()}},b}(WindowCentenMin);a.AppointmentPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){var c=b.call(this)||this;return c._selIdx=0,c.width=UIData.designWidth,c.height=UIData.designHeight,c.center=0,c.middle=0,c._baseRender=new UIRenderComponent,c.addRender(c._baseRender),c._topRender=new UIRenderComponent,c.addRender(c._topRender),c._baseUiAtlas=new UIAtlas,c._leaderPanel=new a.FactionLeaderPanel,c._tripPanel=new a.FactionTripPanel,c}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._leaderPanel&&(this._leaderPanel.dispose(),this._leaderPanel=null),this._tripPanel&&(this._tripPanel.dispose(),this._tripPanel=null),b.prototype.dispose.call(this)},c.prototype.butClik=function(a){a.target==this.w_close&&this.hide()},c.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/faction/factionactive/factionactive.xml","ui/uidata/faction/factionactive/factionactive.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this.applyLoadComplete(),this._baseRender.uiAtlas=this._baseUiAtlas,this._topRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this.initUI(),this._leaderPanel.setUIAtlas(this._baseUiAtlas,this),this._tripPanel.setUIAtlas(this._baseUiAtlas,this.winmidRender),this.setIdx(0),this.resize()},c.prototype.initUI=function(){this.addUIList(["t_win_bian"],this.winmidRender),this.addUIList(["t_win_line"],this._topRender),this.addChild(this._baseRender.getComponent("t_win_title")),this.tab0=this._baseRender.getComponent("t_tab0"),this.addChild(this.tab0),this.tab0.addEventListener(InteractiveEvent.Down,this.tabClick,this),this.tab1=this._baseRender.getComponent("t_tab1"),this.addChild(this.tab1),this.tab1.addEventListener(InteractiveEvent.Down,this.tabClick,this)},c.prototype.tabClick=function(a){a.target==this.tab0?this.setIdx(0):a.target==this.tab1&&this.setIdx(1)},c.prototype.setIdx=function(a){0==a?(this.tab0.selected=!0,this.tab1.selected=!1,this._tripPanel.show(),this._leaderPanel.hide()):1==a&&(this.tab0.selected=!1,this.tab1.selected=!0,this._tripPanel.hide(),this._leaderPanel.show()),this._selIdx=a},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),SceneManager.getInstance().render=!1,this._baseRender.uiAtlas&&this.setIdx(0);var a=new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT);ModuleEventManager.dispatchEvent(a)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),0==this._selIdx?this._tripPanel.hide():1==this._selIdx&&this._leaderPanel.hide(),SceneManager.getInstance().render=!0,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),b.prototype.hide.call(this)},c.prototype.leadDataChg=function(){this._leaderPanel&&this._leaderPanel.hasStage&&this._leaderPanel.drawLead()},c.prototype.tripDataChg=function(){this._tripPanel&&this._tripPanel.hasStage&&this._tripPanel.maxChg()},c}(WindowUi);a.FactionActivePanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a._bgInit=!1,a.rewardIconAry=new Array,a.hallLev=0,a.leadNum=-1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(d,b),d.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null},d.prototype.setUIAtlas=function(a,b){var c=this;this._baseUiAtlas=a,this.parentWindow=b,this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this.initUI(),this.initLead(),this.drawBase(),this._updateFun=function(){c.updateY()},this.hasStage&&(this.showBg(),TimeUtil.addFrameTick(this._updateFun))},d.prototype.updateY=function(){var a=5*Math.sin(TimeUtil.getTimer()/300);if(this.leadAry)for(var b=0;b<this.leadAry.length;b++)this.leadAry[b].offsety=a},d.prototype.onAdd=function(){this.showBg(),this._updateFun&&TimeUtil.addFrameTick(this._updateFun),this.drawLead(),this.drawBase()},d.prototype.onRemove=function(){this.hideBg(),this._updateFun&&TimeUtil.removeFrameTick(this._updateFun)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d.prototype.showBg=function(){if(this.parentWindow&&!this._bgInit){var a=this.parentWindow.loadBigPicByUrl("ui/uidata/faction/factionactive/factionbg.jpg");this._bgInit=!0,a.width=824,a.height=448}this.parentWindow&&this.parentWindow.addBigPic()},d.prototype.hideBg=function(){this.parentWindow&&this.parentWindow.removeBigPic()},d.prototype.initUI=function(){var a=this._baseRender.getComponent("t_title");LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"首领挑战",16,TextAlign.LEFT,ColorType.Brown7a2f21),this.addChild(a),this.datingLev=this._baseRender.getComponent("t_dating_lev"),this.addChild(this.datingLev),this.attAdd=this._baseRender.getComponent("t_att_aa"),this.addChild(this.attAdd),this.rewardAdd=this._baseRender.getComponent("t_reward_add"),this.addChild(this.rewardAdd);var b=this._baseRender.getComponent("t_reward_lab");LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,"击杀所有怪物奖励:通过邮件发放",14,TextAlign.LEFT,ColorType.Brown7a2f21),this.addChild(b),this.lastNum=this._baseRender.getComponent("t_last_num"),this.addChild(this.lastNum);for(var c=0;3>c;c++){var d=this._baseRender.getComponent("t_icon"+c);this.addChild(d),this.rewardIconAry.push(d)}},d.prototype.drawBase=function(){if(this._baseUiAtlas){var b=a.FactionBuildModel.getInstance().getTabvo(SharedDef.FACTION_BUILDING_TYPE_EVENT);if(b.level!=this.hallLev){this.hallLev=b.level;var c=TableData.getInstance().getData(TableData.tb_faction_bossdefense_base,this.hallLev);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.datingLev.skinName,ColorType.Brown7a2f21+"活动大厅等级："+ColorType.Green2ca937+this.hallLev,14,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.attAdd.skinName,ColorType.Brown7a2f21+"玩家属性 "+ColorType.Green2ca937+"+"+c.buffeadd+"%",14,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.rewardAdd.skinName,ColorType.Brown7a2f21+"帮派贡献奖励 "+ColorType.Green2ca937+"+"+c.donate_up+"%",14,TextAlign.LEFT,ColorType.Brown7a2f21);for(var d=0;d<this.rewardIconAry.length;d++)c.clear_reward[d]&&IconManager.getInstance().drawItemIcon40(this.rewardIconAry[d],c.clear_reward[d][0],c.clear_reward[d][1])}var e=GuidData.player.getFactionLeadNum();e!=this.leadNum&&(this.leadNum=e,
LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.lastNum.skinName,"剩余挑战次数："+this.leadNum,14,TextAlign.CENTER,ColorType.Brown7a2f21))}},d.prototype.initLead=function(){this.leadAry=new Array;for(var a=[[578,133],[313,158],[327,339],[516,328],[704,283],[120,378]],b=0;6>b;b++){var d=new c;d.creat(this._bgRender,this._baseRender,b,this),d.setBasePos(a[b][0],a[b][1]),this.leadAry.push(d)}this.drawLead()},d.prototype.drawLead=function(){if(this.leadAry)for(var a=GuidData.faction.getLeaderData(),b=0;b<this.leadAry.length;b++)this.leadAry[b].setData(a[b],b+1)},d}(UIConatiner);a.FactionLeaderPanel=b;var c=function(){function a(){this.posAry=[[26,-10],[0,69],[0,69],[4,80],[9,83],[9,98],[28,-54]],this.baseX=0,this.baseY=0,this._stateType=-1,this._stateFight=-1,this._offsety=0}return a.prototype.creat=function(a,b,c,d){this._uiContainer=d,this.icon=a.getComponent("t_lead_icon"+c),this.bloodBg=a.getComponent("t_lead_bb"+c),this.blood=b.getComponent("t_lead_bt"+c),this.stateBg=a.getComponent("t_lead_bg"+c),this.lev=b.getComponent("t_lead_l"+c),this.state=b.getComponent("t_lead_s"+c),this.jian=b.getComponent("t_jian"+c),this.icon.addEventListener(InteractiveEvent.Up,this.onClick,this),this.uiList=new Array,this.uiList.push(this.icon,this.bloodBg,this.blood,this.stateBg,this.lev,this.state,this.jian);for(var e=0;e<this.uiList.length;e++)this.uiList[e].baseRec.x=this.posAry[e][0],this.uiList[e].baseRec.y=this.posAry[e][1];this._uiContainer.addChild(this.icon),this._uiContainer.addChild(this.stateBg),this._uiContainer.addChild(this.state)},a.prototype.onClick=function(a){var b=this;return 2==this._leadData.state?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"Boss已死亡",99):0==GuidData.player.getFactionLeadNum()?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"您的剩余挑战次数不足，请明天再来挑战！",99):1==this._leadData.state?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"当前BOSS已有人挑战，请耐心等待！",99):void(GuidData.player.getForce()<this._leadData.pool.advisepoint?AlertUtil.show("您当前战力低于推荐战力，是否确定挑战？","",function(a){1==a&&b.showBossView()},2,["前往挑战","取消"]):this.showBossView())},a.prototype.showBossView=function(){var a=this,b=new boss.BossEvent(boss.BossEvent.SHOW_BOSSVIEW_PANEL),c=new boss.BossViewData;c.bossID=this._leadData.pool.entry,c.showRank=!0,c.force=this._leadData.pool.advisepoint,c.rewardList=this._leadData.pool.reward_preview,c.submitFun=function(){NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_BOSSDEFENSE_CHALLENGE,a._leadData.idx,0,"","")},c.rankFun=function(){NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_BOSSDEFENSE_DAMAGE_LIST,a._leadData.indexlocal,0,"","")},b.data=c,ModuleEventManager.dispatchEvent(b)},a.prototype.setData=function(a,b){if(this._leadData=a,this._leadData.indexlocal=b,this._leadID!=a.id){var c=TableData.getInstance().getData(TableData.tb_faction_bossdefense_point,b);IconManager.getInstance().drawCircleBossIcon(this.icon,a.pool.entry,c.type)}var d=0;2==a.state?(d=1,this.jian.parent&&this._uiContainer.removeChild(this.jian)):(d=0,this._stateFight!=a.state&&(0==a.state?this.jian.parent&&this._uiContainer.removeChild(this.jian):this.jian.parent||this._uiContainer.addChild(this.jian))),this._stateType!=d&&(1==d?(this.bloodBg.parent&&(this._uiContainer.removeChild(this.bloodBg),this._uiContainer.removeChild(this.blood),this._uiContainer.removeChild(this.lev)),this.stateBg.height=32,this.state.baseRec.y=85,LabelTextFont.writeSingleLabel(this.state.uiRender.uiAtlas,this.state.skinName,"已死亡",16,TextAlign.CENTER,ColorType.Yellowffe9b4)):(this.bloodBg.parent||(this._uiContainer.addChild(this.bloodBg),this._uiContainer.addChild(this.blood),this._uiContainer.addChild(this.lev)),this.stateBg.height=42,this.state.baseRec.y=98,LabelTextFont.writeSingleLabel(this.state.uiRender.uiAtlas,this.lev.skinName,"Lv"+a.boos.level,16,TextAlign.CENTER,ColorType.Yellowffe9b4),LabelTextFont.writeSingleLabel(this.state.uiRender.uiAtlas,this.state.skinName,ColorType.Yellowffe9b4+"战力:"+(GuidData.player.getForce()<a.pool.advisepoint?ColorType.Redd92200:"")+Snum(a.pool.advisepoint),16,TextAlign.CENTER)),this._stateType=d),0==this._stateType&&(this.blood.uvScale=a.hp/a.maxHp)},Object.defineProperty(a.prototype,"offsety",{get:function(){return this._offsety},set:function(a){this._offsety=a,this.refreshPos()},enumerable:!0,configurable:!0}),a.prototype.setBasePos=function(a,b){this.baseX=a,this.baseY=b,this.refreshPos()},a.prototype.refreshPos=function(){for(var a=0;a<this.uiList.length;a++)this.uiList[a].x=this.uiList[a].baseRec.x+this.baseX,this.uiList[a].y=this.uiList[a].baseRec.y+this.baseY+this._offsety},a}();a.LeaderIcon=c}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.hallLev=-1,a.currentTripLev=-1,a.allTripNum=-1,a.canGetState=[-1,-1,-1,-1,-1,-1],a.maxTripObj=new Object,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._middleRender.dispose(),this._middleRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.bossChar&&(this.bossChar.destory(),this.bossChar=null),this._frameRender&&(this._frameRender.dispose(),this._frameRender=null)},c.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._middleRender=new UIRenderComponent,this._middleRender.uiAtlas=a,this.addRender(this._middleRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this._topRender=new UIRenderComponent,this._topRender.uiAtlas=a,this.addRender(this._topRender),this.initUI()},c.prototype.initUI=function(){this.midAry=new Array,this.midAry.push(this._winMidRender.getComponent("t_wj_bg3")),this.midAry.push(this._winMidRender.getComponent("t_wj_bg4")),this.midAry.push(this._winMidRender.getComponent("t_bg_b")),this.addUIList(["t_wj_bg8","t_wj_bg81","t_wj_bg1","t_wj_bg5","t_wj_bg7","t_wj_bg6","t_wj_bg71"],this._bgRender),this.addUIList(["t_hua1","t_hua2","t_hua3","t_hua4","t_hua5","t_hua6"],this._middleRender),this.addUIList(["t_wj_tz"],this._baseRender),this._sweepLab=this.addChild(this._baseRender.getComponent("t_wj_sd")),this._sweepLab.goToAndStop(0),this._challengBtn=this._middleRender.getComponent("t_wj_bg2"),this.addChild(this._challengBtn),this._challengBtn.addEventListener(InteractiveEvent.Up,this.challenge,this),this._sweepBtn=this._middleRender.getComponent("t_wj_bg21"),this.addChild(this._sweepBtn),this._sweepBtn.addEventListener(InteractiveEvent.Up,this.sweep,this);var a;a=this._baseRender.getComponent("t_wj_lab6"),this.addChild(a),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"关卡信息",14,TextAlign.CENTER,ColorType.colorb96d49),a=this._baseRender.getComponent("t_wj_lab7"),this.addChild(a),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"首通奖励",14,TextAlign.CENTER,ColorType.colorb96d49),this.hallLevLab=this._baseRender.getComponent("t_wj_lab1"),this.addChild(this.hallLevLab),this.hallAttLab=this._baseRender.getComponent("t_wj_lab5"),this.addChild(this.hallAttLab),this.tripNumLab=this._baseRender.getComponent("t_wj_lab2"),this.addChild(this.tripNumLab),this.tripBossLab=this._baseRender.getComponent("t_wj_lab3"),this.addChild(this.tripBossLab),this.tripTimeLab=this._baseRender.getComponent("t_wj_lab4"),this.addChild(this.tripTimeLab),this.stAry=new Array;for(var b=0;3>b;b++)a=this._baseRender.getComponent("t_f_icon"+b),this.addChild(a),this.stAry.push(a);this.tripMap=this._baseRender.getComponent("t_wj_lab8"),this.addChild(this.tripMap),this.tripMapBtn=this._baseRender.getComponent("t_wj_lab9"),this.addChild(this.tripMapBtn),this.tripZl=this._baseRender.getComponent("t_wj_lab10"),this.addChild(this.tripZl),this.myTrip=this._baseRender.getComponent("t_wj_lab11"),this.addChild(this.myTrip),this.dayRewardAry=new Array;for(var b=0;5>b;b++)a=this._baseRender.getComponent("t_a_icon"+b),this.addChild(a),a.data=-1,this.dayRewardAry.push(a);this.maxIcon=this._baseRender.getComponent("t_m_icon"),this.addChild(this.maxIcon),this.maxName=this._baseRender.getComponent("t_wj_max1"),this.addChild(this.maxName),this.maxTrip=this._baseRender.getComponent("t_wj_max2"),this.addChild(this.maxTrip),this.maxZl=this._baseRender.getComponent("t_wj_max3"),this.addChild(this.maxZl),this.frameLineAry=new Array;for(var b=0;4>b;b++){var c=this._baseRender.getComponent("t_wj_line"+b);this.addChild(c),this.frameLineAry.push(c),c.goToAndStop(1)}this.dayRewardLabAry=new Array;for(var b=0;5>b;b++)a=this._baseRender.getComponent("t_a_l"+b),this.addChild(a),this.dayRewardLabAry.push(a);this.dayRewardGetAry=new Array;for(var b=0;5>b;b++)a=this._topRender.getComponent("t_wj_chuo"+b),this.dayRewardGetAry.push(a);this.addBossChar(),this.drawMax(),this.drawTripLel(),this.drawTripBase(),this.buildFram()},c.prototype.maxChg=function(){this.drawMax(),this.drawDayReward(),this.playEff()},c.prototype.onAdd=function(){this._baseUiAtlas&&this.refreshUI()},c.prototype.refreshUI=function(){this.drawMax(),this.drawTripLel(),this.drawTripBase(),this.drawDayReward()},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this);for(var a=0;a<this.midAry.length;a++)this.addChild(this.midAry[a]);this.playEff()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this);for(var a=0;a<this.midAry.length;a++)this.removeChild(this.midAry[a])},c.prototype.challenge=function(a){UiTweenScale.getInstance().changeButSize(a.target),NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_TOWER_CHALLENGE,0,0,"","")},c.prototype.sweep=function(a){UiTweenScale.getInstance().changeButSize(a.target),GuidData.player.getFactionTripSweep()?msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"今天已经扫荡过了，请明天再来",99):this.currentTripLev>1?NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_TOWER_SWEEP,0,0,"",""):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"至少通过第一关，才可扫荡",99)},c.prototype.buildFram=function(){var a=this;this._frameRender||(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ef_fl"),4,4,function(b){a.effAry=b;for(var c=0;c<a.effAry.length;c++)a.effAry[c].x=a.dayRewardAry[c].x-30,a.effAry[c].y=a.dayRewardAry[c].y-30,a.effAry[c].speed=3;a.playEff()},this.dayRewardAry.length))},c.prototype.playEff=function(){if(this.effAry)for(var a=0;a<this.dayRewardAry.length;a++)a<this.rewardFlagAry.length&&!this.rewardFlagAry[a]&&this.hallData.chest_floor[a]<=this.maxTripObj.floor?(this.addChild(this.effAry[a]),this.effAry[a].play()):this.removeChild(this.effAry[a])},c.prototype.getReward=function(a){var b=this.dayRewardAry.indexOf(a.target);return this.rewardFlagAry[b]?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"该奖励已领取！",99):(b++,void NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_TOWER_CHEST,b,0,"",""))},c.prototype.addBossChar=function(){this.bossChar=new MonsterUIChar,this._bgRender.addModel(this.bossChar),this.resize()},c.prototype.drawTripBase=function(){var b=a.FactionBuildModel.getInstance().getTabvo(SharedDef.FACTION_BUILDING_TYPE_EVENT),c=TableData.getInstance().getData(TableData.tb_faction_tower_base,b.level);b.level!=this.hallLev&&(this.hallLev=b.level,this.hallData=c,LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.hallLevLab.skinName,ColorType.Brown7a2f21+"活动大厅加成:"+ColorType.Green2ca937+this.hallLev+"级",14,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.hallAttLab.skinName,ColorType.Brown7a2f21+"属性:"+ColorType.Green2ca937+c.building_buff_des,14,TextAlign.LEFT),this.drawDayReward(),this.drawDayLabReward());var d=GuidData.faction.getTripNum(this.currentTripLev);if(d!=this.allTripNum)if(this.allTripNum=d,LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.tripNumLab.skinName,ColorType.Brown7a2f21+"本关通关人数:"+ColorType.Green2ca937+this.allTripNum,14,TextAlign.LEFT),this.allTripNum>0){var e;e=c.enemy_weaken_buffeffect_id.length<=this.allTripNum?c.enemy_weaken_buffeffect_id[c.enemy_weaken_buffeffect_id.length-1]:c.enemy_weaken_buffeffect_id[this.allTripNum];var f=TableData.getInstance().getData(TableData.tb_buff_effect,e);f?LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.tripBossLab.skinName,ColorType.Brown7a2f21+"本关怪物属性:"+ColorType.Green2ca937+f.value+"%",14,TextAlign.LEFT):LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.tripBossLab.skinName,ColorType.Brown7a2f21+"本关怪物属性:"+ColorType.Green2ca937+"-0%",14,TextAlign.LEFT)}else LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.tripBossLab.skinName,ColorType.Brown7a2f21+"本关怪物属性:"+ColorType.Green2ca937+"-0%",14,TextAlign.LEFT)},c.prototype.drawTripLel=function(){var a=GuidData.player.getFactionTripLev()+1;if(a>TableData.getInstance().getTabMaxID(TableData.tb_faction_tower_floor)&&(a=GuidData.player.getFactionTripLev()),a!=this.currentTripLev){this.currentTripLev=a;var b=TableData.getInstance().getData(TableData.tb_faction_tower_floor,this.currentTripLev);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.tripTimeLab.skinName,ColorType.Brown7a2f21+"本关限时:"+ColorType.Green2ca937+TimeUtil.getLocalTime4(b.time_limit),14,TextAlign.LEFT),this.drawShouTongReward(b.firstpass_reward),this.drawGuanka(this.currentTripLev,b);var c=tb.TB_creature_template.get_TB_creature_template(b.entry);this.bossChar.setAvatar(c.avatar)}},c.prototype.drawShouTongReward=function(a){for(var b=0;b<this.stAry.length;b++){var c=a[b];c?IconManager.getInstance().drawItemIcon60(this.stAry[b],c[0],c[1]):IconManager.getInstance().drawItemIcon60(this.stAry[b],0,0)}},c.prototype.drawGuanka=function(a,b){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.tripMap.skinName,b.name,14,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.tripMapBtn.skinName,b.name,14,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.drawTxtLab(this.tripZl,ColorType.Brown7a2f21+"推荐战力:"+ColorType.colorcd2000+b.advisepoint,14,TextAlign.CENTER),UiDraw.drawTxtLab(this.myTrip,ColorType.Brown7a2f21+"我的通关记录:"+ColorType.colorcd2000+(a-1),14,TextAlign.CENTER)},c.prototype.drawDayReward=function(){GuidData.player.getFactionTripSweep()?this._sweepLab.goToAndStop(1):this._sweepLab.goToAndStop(0);for(var a=this.maxTripObj.floor,b=0;b<this.dayRewardAry.length;b++){var c=this.hallData.chest_floor[b],d=a>=c;this.canGetState[b]!=d&&(IconManager.getInstance().drawItemIcon60(this.dayRewardAry[b],this.hallData.chest_itemId[b],1,!d),this.canGetState[b]=d,d&&this.dayRewardAry[b].addEventListener(InteractiveEvent.Up,this.getReward,this)),b>0&&(d?this.frameLineAry[b-1].goToAndStop(0):this.frameLineAry[b-1].goToAndStop(1))}this.rewardFlagAry=GuidData.player.getFactionTripReward();for(var b=0;b<this.dayRewardGetAry.length;b++)this.rewardFlagAry[b]?this.dayRewardGetAry[b].parent||this.addChild(this.dayRewardGetAry[b]):this.dayRewardGetAry[b].parent&&this.removeChild(this.dayRewardGetAry[b])},c.prototype.drawDayLabReward=function(){for(var a=0;a<this.dayRewardLabAry.length;a++)LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.dayRewardLabAry[a].skinName,this.hallData.chest_floor[a]+"关奖励",16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawMax=function(){var a=GuidData.faction.getMaxTripRole();if(this.maxTripObj.icon!=a.icon&&IconManager.getInstance().drawCircleIcon(this.maxIcon,3,a.icon),this.maxTripObj.name!=a.name){var b=a.name;""==b&&(b="无"),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.maxName.skinName,ColorType.Brown7a2f21+getBaseName(b),16,TextAlign.LEFT)}this.maxTripObj.floor!=a.floor&&LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.maxTrip.skinName,ColorType.Brown7a2f21+"通关记录:"+ColorType.color9a683f+a.floor,16,TextAlign.LEFT),this.maxTripObj.force!=a.force&&LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.maxZl.skinName,ColorType.Brown7a2f21+"通关战力:"+ColorType.color9a683f+a.force,16,TextAlign.LEFT),this.maxTripObj=a},c.prototype.drawRewardGet=function(){},c.prototype.resize=function(){b.prototype.resize.call(this),this.bossChar&&(this.bossChar.scale=1.5*UIData.Scale,this.bossChar.x=0*UIData.Scale,this.bossChar.y=-30*UIData.Scale,this.bossChar.resize())},c}(UIConatiner);a.FactionTripPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a._levelLimit=0,a._lastSkillID=-1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._slist=new c,a._slist.mainPanel=a,a._baseUiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bgRender.dispose(),this._bgRender=null,this._slist&&(this._slist.dispose(),this._slist=null),b.prototype.dispose.call(this)},d.prototype.butClik=function(a){a.target==this.w_close&&this.hide()},d.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/faction/factionskill/factionskill.xml","ui/uidata/faction/factionskill/factionskill.png",function(){a.loadConfigCom()})},d.prototype.loadConfigCom=function(){this.applyLoadComplete(),this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this.initUI(),this._slist.init(this._baseUiAtlas),this.resize()},d.prototype.initUI=function(){this.addUIList(["t_win_bg1","t_win_bg2"],this.winmidRender),this.addUIList(["t_win_title","t_line1","t_line2"],this._bgRender),this._skillIcon=this.addChild(this._baseRender.getComponent("t_icon")),this._skillName=this.addChild(this._baseRender.getComponent("t_lab1")),this._skillLev=this.addChild(this._baseRender.getComponent("t_lab2"));var a;a=this.addChild(this._baseRender.getComponent("t_lab3")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"当前效果",16,TextAlign.LEFT,ColorType.Brown7a2f21),this._skillCurLevDesc=this.addChild(this._baseRender.getComponent("t_lab4")),a=this.addChild(this._baseRender.getComponent("t_lab5")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"下级效果",16,TextAlign.LEFT,ColorType.Brown7a2f21),this._skillNextLevDesc=this.addChild(this._baseRender.getComponent("t_lab6")),a=this.addChild(this._baseRender.getComponent("t_lab7")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"升级消耗",16,TextAlign.CENTER,ColorType.colorb96d49),this._skillCost=this.addChild(this._baseRender.getComponent("t_lab8")),this._skillMax=this.addChild(this._baseRender.getComponent("t_lab9")),a=this.addChild(this._baseRender.getComponent("t_lab10")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"(提高技能坊等级可以提高技能等级上限)",14,TextAlign.CENTER,ColorType.colorcd2000),a=this.addChild(this._baseRender.getComponent("t_btn")),a.addEventListener(InteractiveEvent.Up,this.upLev,this),this._factionLev=this.addChild(this._baseRender.getComponent("t_lab11")),this._factionGong=this.addChild(this._baseRender.getComponent("t_lab12")),this.drawBase(),this.drawMax()},d.prototype.upLev=function(a){if(this.curData){if(this.curData.lev>=this._levelLimit)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"技能等级已达上限",99);var b=1e4*this.curData.id+this.curData.lev+1,c=TableData.getInstance().getData(TableData.tb_faction_skill_lvup,b);if(c&&!hasEnoughRes(c.cost[0])){var d=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return d.data=6,void ModuleEventManager.dispatchEvent(d)}NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_SKILL_LVUP,this.curData.id,0,"","")}},d.prototype.dataChg=function(){this._slist.dataChg()},d.prototype.drawMax=function(){var b=a.FactionBuildModel.getInstance().getTabvo(SharedDef.FACTION_BUILDING_TYPE_SKILL),c=TableData.getInstance().getData(TableData.tb_faction_skill_building,b.level);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._skillMax.skinName,ColorType.Brown7a2f21+"当前技能等级上限："+ColorType.colorff7200+c.level_limit,16,TextAlign.LEFT),UiDraw.drawTxtLab(this._factionLev,ColorType.Brown7a2f21+"家族技能坊Lv:"+b.level,16,TextAlign.CENTER),this._levelLimit=c.level_limit},d.prototype.drawSkill=function(a){var b=tb.TB_skill_base.get_TB_skill_base(a.skillID);if(this._lastSkillID!=a.skillID&&(IconManager.getInstance().drawCircleIcon(this._skillIcon,2,a.skillID),this._lastSkillID=a.skillID,LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._skillName.skinName,b.name,16,TextAlign.LEFT,ColorType.Brown7a2f21)),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._skillLev.skinName,"LV"+a.lev,16,TextAlign.LEFT,ColorType.colorff7200),0==a.lev)LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._skillCurLevDesc.skinName,"无",16,TextAlign.LEFT,ColorType.Green2ca937);else{var c=tb.SkillDataVo.getSkillDesc(a.skillID,a.lev);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._skillCurLevDesc.skinName,c,16,TextAlign.LEFT,ColorType.Green2ca937)}LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._skillNextLevDesc.skinName,tb.SkillDataVo.getSkillDesc(a.skillID,a.lev+1),16,TextAlign.LEFT,ColorType.Green2ca937);var d=1e3*a.id+a.lev+1,e=TableData.getInstance().getData(TableData.tb_faction_skill_lvup,d);e?LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._skillCost.skinName,ColorType.Brown7a2f21+"消耗个人家族贡献："+ColorType.color4392ff+e.cost[0][1],16,TextAlign.LEFT):(console.log("---家族技能等级无----",e,d,a.id,a.lev),UiDraw.clearUI(this._skillCost))},d.prototype.drawBase=function(){UiDraw.drawTxtLab(this._factionGong,ColorType.Brown7a2f21+"家族贡献:"+GuidData.player.getResTypeStr(6),16,TextAlign.CENTER)},d.prototype.setData=function(a){this.drawSkill(a),this.curData=a},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,6]),SceneManager.getInstance().render=!1,this._slist.show(),this._baseRender.uiAtlas&&this.drawMax();var a=new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT);ModuleEventManager.dispatchEvent(a)},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),SceneManager.getInstance().render=!0,this._slist.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),b.prototype.hide.call(this)},d}(WindowUi);a.FactionSkillPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a._hasInit=!1,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=this.getDataAry(),b=536,c=380;this.setData(a,d,b,c,270,95,4,512,512,2,6,2),this.center=-150,this.middle=5,this.setShowLevel(4),this._hasInit=!0,this.setSelectIndex(1)},c.prototype.refreshAll=function(){if(this._hasInit){var a=this.getDataAry();this.refreshData(a)}},c.prototype.getDataAry=function(){for(var b=new Array,c=a.FactionBuildModel.getInstance().getTabvo(SharedDef.FACTION_BUILDING_TYPE_SKILL),d=TableData.getInstance().getTabSize(TableData.tb_faction_skill_base),e=1;d>=e;e++){var f=TableData.getInstance().getData(TableData.tb_faction_skill_base,e),g=new Object;g.skillID=f.skill_id,g.lock=c.level<f.unlock_level,g.lockLev=f.unlock_level,g.lev=GuidData.player.getFactionSkillLv(e),g.id=e;var h=new SListItemData;h.data=g,h.id=e,b.push(h)}return b},c.prototype.dataChg=function(){for(var a=0;a<this._dataAry.length;a++){var b=GuidData.player.getFactionSkillLv(a+1);this._dataAry[a].data.lev!=b&&(this._dataAry[a].data.lev=b,this._itemList[a].refreshDraw())}},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.refreshAll()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(SList);a.FactionSkillList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this._ibg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"s_bg",0,0,256,88,10,10),b.addChild(this._ibg),this._ibg.addEventListener(InteractiveEvent.Up,this.butClik,this),this._itme0=this.creatSUI(d,this.parentTarget.baseAtlas,"s_icon",15,10,68,68),b.addChild(this._itme0),this._imask=this.creatGrid9SUI(e[0],this.parentTarget.baseAtlas,"s_mask",0,0,256,88,10,10),UiDraw.uiAtlasDrawImg(this.uiAtlas,this._imask.skinName,UIData.publicUi,PuiData.MASK),this._iitem1=this.creatSUI(e[1],this.parentTarget.baseAtlas,"s_name",100,20,140,20),b.addChild(this._iitem1),this._iitem2=this.creatSUI(e[1],this.parentTarget.baseAtlas,"s_lev",100,50,140,20),b.addChild(this._iitem2),this._container=b},b.prototype.butClik=function(a){UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&!this.itdata.data.lock&&this.setSelect()},Object.defineProperty(b.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.itdata&&this.applyRender(),a&&this.parentTarget.mainPanel.setData(this.itdata.data)},enumerable:!0,configurable:!0}),b.prototype.render=function(a){this.itdata=a,a&&this.applyRender()},b.prototype.refreshDraw=function(){LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem2.skinName,"Lv"+this.itdata.data.lev,16,TextAlign.LEFT,ColorType.colorff7200),this._selected&&this.parentTarget.mainPanel.setData(this.itdata.data)},b.prototype.applyRender=function(){this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.Slist_select):UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.Slist_nselect);var a=this.itdata.data.lock;a?this._imask.parent||this._container.addChild(this._imask):this._imask.parent&&this._container.removeChild(this._imask),IconManager.getInstance().drawCircleIcon(this._itme0,2,this.itdata.data.skillID);var b=tb.TB_skill_base.get_TB_skill_base(this.itdata.data.skillID);LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem1.skinName,b.name,16,TextAlign.LEFT,a?ColorType.Whitefff4d6:ColorType.Brown7a2f21),a?LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem2.skinName,"技能坊等级"+this.itdata.data.lockLev+"级解锁",16,TextAlign.LEFT,ColorType.Whitefff4d6):LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem2.skinName,"Lv"+this.itdata.data.lev,16,TextAlign.LEFT,ColorType.colorff7200)},b}(SListItem);a.FactionSkillListItemRender=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){var a=b.call(this,0)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this.applybuildpanel.dispose(),this.applybuildpanel=null,this.applyzhaomupanel.dispose(),this.applyzhaomupanel=null,b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this._baseRender.uiAtlas.setInfo("ui/uidata/faction/newfaction/joinfaction.xml","ui/uidata/faction/newfaction/joinfaction.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionpc.png")},c.prototype.loadConfigCom=function(){this.winmidRender.uiAtlas=this._publicbgRender.uiAtlas;var b=this._baseRender;this.applybuildpanel=new a.ApplyBuildPanel,this.applybuildpanel.initUiAtlas(b.uiAtlas,this._publicbgRender.uiAtlas),this.applyzhaomupanel=new a.ApplyZhaomuPanel,this.applyzhaomupanel.initUiAtlas(b.uiAtlas,this._publicbgRender.uiAtlas),this.tab_zhao=this.addEvntBut("tab_zhao",b),this.tab_chuang=this.addEvntBut("tab_chuang",b);var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(c,"rightLinebg",b),this.BaseUiAry=new Array;var d=this.addChild(this.winmidRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(d,"b_right_bg_top",b);var e=this.addChild(this.winmidRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(e,"b_right_bg_bottom",b),this.BaseUiAry.push(d),this.BaseUiAry.push(e),this.addUIList(["title","b_newbg"],this._baseRender),this.winmidRender.applyObjData(),this.applyLoadComplete()},c.prototype.selecttype=function(a){0==a?(this.tab_zhao.selected=!0,this.tab_chuang.selected=!1,this.applybuildpanel.hide(),this.applyzhaomupanel.show()):(this.tab_chuang.selected=!0,this.tab_zhao.selected=!1,this.applybuildpanel.show(),this.applyzhaomupanel.hide());var b=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);0==a&&(b.data=SharedDef.MODULE_FACTION),ModuleEventManager.dispatchEvent(b)},c.prototype.show=function(a){void 0===a&&(a=0),UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.selecttype(0)},c.prototype.hide=function(){this.applybuildpanel.hide(),this.applyzhaomupanel.hide(),UIManager.getInstance().removeUIContainer(this),b.prototype.hide.call(this)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.butClik=function(b){switch(b.target){case this.tab_chuang:this.selecttype(1);break;case this.tab_zhao:this.selecttype(0);break;case this.w_close:ModuleEventManager.dispatchEvent(new a.FactionEvent(a.FactionEvent.HIDE_APPLYFACTIONUI_EVENT))}},c}(WindowUi);a.ApplyFactionUiPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){var a=b.call(this,2)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._topRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.factionFunctionPanel.dispose(),this.factionFunctionPanel=null,this.factionPersonPanel.dispose(),this.factionPersonPanel=null,this._redPointRender.dispose(),this._redPointRender=null,b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this._topRender.uiAtlas.setInfo("ui/uidata/faction/newfaction/extisfaction.xml","ui/uidata/faction/newfaction/extisfaction.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionpc.png")},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._topRender.uiAtlas,this.winmidRender.uiAtlas=this._publicbgRender.uiAtlas;var b=this._topRender;
this.factionPersonPanel=new a.FactionPersonPanel,this.factionPersonPanel.initUiAtlas(b.uiAtlas,this._publicbgRender.uiAtlas),this.factionPersonPanel.parent=this,this.factionFunctionPanel=new a.FactionFunctionPanel,this.factionFunctionPanel.initUiAtlas(b.uiAtlas,this);var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(c,"bg_1",b),this.addUIList(["title"],b),this.tab_person=this.addEvntBut("tab_person",this._baseRender),this.tab_shang=this.addEvntBut("tab_shang",this._baseRender),this._redPointRender.getRedPointUI(this,61,new Vector2D(this.tab_person.x+this.tab_person.width-5,this.tab_person.y)),this._redPointRender.getRedPointUI(this,63,new Vector2D(this.tab_shang.x+this.tab_shang.width-5,this.tab_shang.y)),this.applyLoadComplete()},c.prototype.selectlo=function(a){0==a?(this.tab_person.selected=!0,this.tab_shang.selected=!1):1==a&&(this.tab_person.selected=!1,this.tab_shang.selected=!0),this.selectdatalo(a)},c.prototype.showhide_select=function(a){0==a?(this.factionPersonPanel.show(),this.factionFunctionPanel.hide()):1==a&&(this.factionPersonPanel.hide(),this.factionFunctionPanel.show())},c.prototype.selectdatalo=function(a){this._typelo!=a&&(this._typelo=a,this.showhide_select(a))},c.prototype.refresh=function(){},c.prototype.show=function(a){void 0===a&&(a=0),UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.selectlo(a)},c.prototype.hide=function(){this._typelo=-1,UIManager.getInstance().removeUIContainer(this),this.factionPersonPanel.hide(),this.factionFunctionPanel.hide(),b.prototype.hide.call(this)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.butClik=function(b){switch(console.log("--btn---",b.target),b.target){case this.tab_person:this.selectlo(0);break;case this.tab_shang:this.selectlo(1);break;case this.w_close:ModuleEventManager.dispatchEvent(new a.FactionEvent(a.FactionEvent.HIDE_EXISTFACTIONUI_EVENT))}},c}(WindowUi);a.ExistFactionUiPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.getModuleName=function(){return"FactionModule"},c.prototype.listProcessors=function(){return[new d,new a.FactionBossProcessor,new a.FactionBuildProcessor]},c}(Module);a.FactionModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_FACTIONUI_EVENT="SHOW_FACTIONUI_EVENT",b.HIDE_APPLYFACTIONUI_EVENT="HIDE_APPLYFACTIONUI_EVENT",b.HIDE_EXISTFACTIONUI_EVENT="HIDE_EXISTFACTIONUI_EVENT",b.REFRESHAPPLYZHAOMUlIST_EVENT="REFRESHAPPLYZHAOMUlIST_EVENT",b.REFRESHAPPLYZHAOMUlISTISOK_EVENT="REFRESHAPPLYZHAOMUlISTISOK_EVENT",b.JOINFACTIONITEM_EVENT="JOINFACTIONITEM_EVENT",b.REFRESHFACTIONITEM_EVENT="REFRESHFACTIONITEM_EVENT",b.REFRESHFACTIONITEMAPPLY_EVENT="REFRESHFACTIONITEMAPPLY_EVENT",b.REFRESHFACTIONLEV_EVENT="REFRESHFACTIONLEV_EVENT",b.REFRESHFACTIONMONEY_EVENT="REFRESHFACTIONMONEY_EVENT",b.REFRESHFACTIONGX_EVENT="REFRESHFACTIONGX_EVENT",b.REFRESHFACTIONGG_EVENT="REFRESHFACTIONGG_EVENT",b.REFRESHFACTIONIDENTITY_EVENT="REFRESHFACTIONIDENTITY_EVENT",b.FACTION_QUIT_EVENT="faction_quit_event",b.SHOW_FACTIONAPPOINTMENT_EVENT="SHOW_FACTIONAPPOINTMENT_EVENT",b.SHOW_FACTIONRECRUITING_EVENT="SHOW_FACTIONRECRUITING_EVENT",b.SHOW_FACTIONNOTICE_EVENT="SHOW_FACTIONNOTICE_EVENT",b.SHOW_FACTIONACTIVE_PANEL_EVENT="SHOW_FACTIONACTIVE_PANEL_EVENT",b.SHOW_FACTIONACTIVE_LEAD_CHANGE_EVENT="SHOW_FACTIONACTIVE_LEAD_CHANGE_EVENT",b.SHOW_FACTIONACTIVE_TRIP_CHANGE_EVENT="SHOW_FACTIONACTIVE_TRIP_CHANGE_EVENT",b.SHOW_FACTIONSKILL_PANEL_EVENT="SHOW_FACTIONSKILL_PANEL_EVENT",b.SHOW_FACTIONSKILL_CHG_EVENT="SHOW_FACTIONSKILL_CHG_EVENT",b.SHOW_INVITATION_EVENT="SHOW_INVITATION_EVENT",b.INVITATION_CHG_EVENT="INVITATION_CHG_EVENT",b.FUNBUILD_CHG_EVENT="FUNBUILD_CHG_EVENT",b}(BaseEvent);a.FactionEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"FactionProcessor"},d.prototype.receivedModuleEvent=function(a){var b=a;if(this.processRedPoint(),a instanceof c?b.type==c.SHOW_FACTIONUI_EVENT?this.showFactionUi(b.data):b.type==c.HIDE_APPLYFACTIONUI_EVENT?this.hideApplyFactionUi():b.type==c.HIDE_EXISTFACTIONUI_EVENT?this.hideExistFactionUi():b.type==c.REFRESHAPPLYZHAOMUlIST_EVENT?this.refreshapplyzhaomulist(b.data):b.type==c.REFRESHAPPLYZHAOMUlISTISOK_EVENT?this.refreshapplyzhaomulistisok(b.data):b.type==c.REFRESHFACTIONITEM_EVENT?this.refreshFactionPlayerList():b.type==c.REFRESHFACTIONITEMAPPLY_EVENT?(this.ApplyFactionListChange(),ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON))):b.type==c.JOINFACTIONITEM_EVENT?this.joinFactionevent():b.type==c.REFRESHFACTIONLEV_EVENT?this.refreshFactionLev():b.type==c.REFRESHFACTIONMONEY_EVENT?this.refreshFactionMoney():b.type==c.REFRESHFACTIONGX_EVENT?this.refreshFactionGX():b.type==c.REFRESHFACTIONGG_EVENT?this.refreshFactionGG():b.type==c.REFRESHFACTIONIDENTITY_EVENT?this.refreshFactionIdentity():b.type==c.SHOW_FACTIONAPPOINTMENT_EVENT?this.showFactionAppointment(b.data):b.type==c.FACTION_QUIT_EVENT?this.exitFactionevent():b.type==c.SHOW_FACTIONRECRUITING_EVENT?this.showFactionRecruiting():b.type==c.SHOW_FACTIONNOTICE_EVENT?this.showFactionNotice():b.type==c.SHOW_FACTIONACTIVE_PANEL_EVENT?this.showActivePanel():b.type==c.SHOW_FACTIONACTIVE_LEAD_CHANGE_EVENT?this.refreshActiveLeadPanel():b.type==c.SHOW_FACTIONACTIVE_TRIP_CHANGE_EVENT?this.refreshActiveTripPanel():b.type==c.SHOW_FACTIONSKILL_PANEL_EVENT?this.showSkillPanel():b.type==c.SHOW_FACTIONSKILL_CHG_EVENT?this.skillChg():b.type==c.SHOW_INVITATION_EVENT?this.showinvitationpanel():b.type==c.INVITATION_CHG_EVENT?this.invitationchg():b.type==c.FUNBUILD_CHG_EVENT&&this.funbuildChg():a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT||a.type==EngineEvent.SYSTEM_OPEN_EVENT?this.processRedPoint():a.type==EngineEvent.MONEY_CHANGE&&this.Chgmoney(),a instanceof UIPanelEvent){var d=a;d.panel==this._applyFactionUiPanel&&(this._applyFactionUiPanel.dispose(),this._applyFactionUiPanel=null,console.log("释放面板 _applyFactionUiPanel")),d.panel==this._existFactionUiPanel&&(this._existFactionUiPanel.dispose(),this._existFactionUiPanel=null,console.log("释放面板 _existFactionUiPanel")),d.panel==this.appointmentPanel&&(this.appointmentPanel.dispose(),this.appointmentPanel=null,console.log("释放面板 appointmentPanel")),d.panel==this.noticePanel&&(this.noticePanel.dispose(),this.noticePanel=null,console.log("释放面板 noticePanel")),d.panel==this.recruitingPanel&&(this.recruitingPanel.dispose(),this.recruitingPanel=null,console.log("释放面板 recruitingPanel")),d.panel==this._invitationPanel&&(this._invitationPanel.dispose(),this._invitationPanel=null,console.log("释放面板 _invitationPanel")),d.panel==this.activePanel&&(this.activePanel.dispose(),this.activePanel=null,console.log("释放面板 activePanel")),d.panel==this.skillPanel&&(this.skillPanel.dispose(),this.skillPanel=null,console.log("释放面板 factionskillPanel"))}},d.prototype.funbuildChg=function(){this._existFactionUiPanel&&this._existFactionUiPanel.factionFunctionPanel&&this._existFactionUiPanel.factionFunctionPanel.hasStage&&this._existFactionUiPanel.factionFunctionPanel.resetData()},d.prototype.Chgmoney=function(){this.skillPanel&&this.skillPanel.drawBase(),this._applyFactionUiPanel&&this._applyFactionUiPanel.applybuildpanel&&this._applyFactionUiPanel.applybuildpanel.hasStage&&this._applyFactionUiPanel.applybuildpanel.set_a_9()},d.prototype.processRedPoint=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_FACTION,SharedDef.MODULE_FACTION_RECRUIT)){var a,b=RedPointManager.getInstance().getNodeByID(62);GuidData.faction&&(a=GuidData.faction.getApplyList()),a&&a.length>0&&GuidData.faction.playerIdentity<4?b.show=!0:b.show=!1}},d.prototype.showinvitationpanel=function(){var b=this;this._invitationPanel||(this._invitationPanel=new a.InvitationPanel),this._invitationPanel.load(function(){b._invitationPanel.show()})},d.prototype.invitationchg=function(){this._invitationPanel&&this._invitationPanel.invitationList&&this._invitationPanel.invitationList.hasStage&&this._invitationPanel.invitationList.resetData()},d.prototype.showActivePanel=function(){var b=this;return GuidData.faction?(this.activePanel||(this.activePanel=new a.FactionActivePanel),void this.activePanel.load(function(){b.activePanel.show()})):void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"你还没有加入家族",99)},d.prototype.showSkillPanel=function(){var b=this;return GuidData.faction?(this.skillPanel||(this.skillPanel=new a.FactionSkillPanel),void this.skillPanel.load(function(){b.skillPanel.show()})):void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"你还没有加入家族",99)},d.prototype.skillChg=function(){this.skillPanel&&this.skillPanel.hasStage&&this.skillPanel.dataChg()},d.prototype.refreshActiveLeadPanel=function(){this.activePanel&&this.activePanel.hasStage&&this.activePanel.leadDataChg()},d.prototype.refreshActiveTripPanel=function(){this.activePanel&&this.activePanel.hasStage&&this.activePanel.tripDataChg()},d.prototype.showFactionAppointment=function(b){var c=this;this.appointmentPanel||(this.appointmentPanel=new a.AppointmentPanel),this.appointmentPanel.load(function(){c.appointmentPanel.show(b)})},d.prototype.showFactionNotice=function(){var b=this;this.noticePanel||(this.noticePanel=new a.NoticePanel),this.noticePanel.load(function(){b.noticePanel.show()})},d.prototype.showFactionRecruiting=function(){var b=this;this.recruitingPanel||(this.recruitingPanel=new a.RecruitingPanel),this.recruitingPanel.load(function(){b.recruitingPanel.show()})},d.prototype.ApplyFactionListChange=function(){return this.recruitingPanel&&this.recruitingPanel.applyFactionList&&this.recruitingPanel.applyFactionList.hasStage?void this.recruitingPanel.applyFactionList.refreshDataByNewData():void 0},d.prototype.refreshFactionIdentity=function(){this._existFactionUiPanel&&this._existFactionUiPanel.factionPersonPanel&&this._existFactionUiPanel.factionPersonPanel.rightPanel.resetFactionIdentity()},d.prototype.refreshFactionGG=function(){this._existFactionUiPanel&&this._existFactionUiPanel.factionPersonPanel&&this._existFactionUiPanel.factionPersonPanel.rightPanel.resetFactionNotice()},d.prototype.refreshFactionGX=function(){this._existFactionUiPanel&&this._existFactionUiPanel.factionPersonPanel&&this._existFactionUiPanel.factionPersonPanel.rightPanel.resetFactionContribution()},d.prototype.refreshFactionMoney=function(){this._existFactionUiPanel&&this._existFactionUiPanel.factionPersonPanel&&this._existFactionUiPanel.factionPersonPanel.rightPanel.resetFactionMoney()},d.prototype.refreshFactionLev=function(){this._existFactionUiPanel&&this._existFactionUiPanel.factionPersonPanel&&this._existFactionUiPanel.factionPersonPanel.rightPanel.resetFactionLev()},d.prototype.refreshFactionPlayerList=function(){this._existFactionUiPanel&&this._existFactionUiPanel.factionPersonPanel&&this._existFactionUiPanel.factionPersonPanel.personListPanel&&this._existFactionUiPanel.factionPersonPanel.personListPanel.refreshDataByNewData(GuidData.faction.getFactionListBySortType(this._existFactionUiPanel.factionPersonPanel.SortType,this._existFactionUiPanel.factionPersonPanel.SortFlag),!1),this._existFactionUiPanel&&this._existFactionUiPanel.factionPersonPanel&&(this._existFactionUiPanel.factionPersonPanel.rightPanel.resetFactionPlayerNum(),this._existFactionUiPanel.factionPersonPanel.bottomLeftPanel.resetData())},d.prototype.joinFactionevent=function(){this._applyFactionUiPanel&&this._applyFactionUiPanel.hasStage&&(this.hideApplyFactionUi(),this.showFactionUi(null))},d.prototype.exitFactionevent=function(){this._existFactionUiPanel&&this._existFactionUiPanel.hasStage&&(this.hideExistFactionUi(),this.showFactionUi(null))},d.prototype.refreshapplyzhaomulist=function(a){this._applyFactionUiPanel&&this._applyFactionUiPanel.applyzhaomupanel&&this._applyFactionUiPanel.applyzhaomupanel.applylist&&this._applyFactionUiPanel.applyzhaomupanel.setFactionInfo(a)},d.prototype.refreshapplyzhaomulistisok=function(a){this._applyFactionUiPanel&&this._applyFactionUiPanel.applyzhaomupanel&&this._applyFactionUiPanel.applyzhaomupanel.applylist&&this._applyFactionUiPanel.applyzhaomupanel.applylist.isokstate(a)},d.prototype.hideExistFactionUi=function(){this._existFactionUiPanel&&this._existFactionUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.hideApplyFactionUi=function(){this._applyFactionUiPanel&&this._applyFactionUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showFactionUi=function(b){var c;GuidData.faction?(this._existFactionUiPanel||(this._existFactionUiPanel=new a.ExistFactionUiPanel),c=this._existFactionUiPanel):(this._applyFactionUiPanel||(this._applyFactionUiPanel=new a.ApplyFactionUiPanel),c=this._applyFactionUiPanel),c.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),7==b?c.show(1):c.show();var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_FACTION,ModuleEventManager.dispatchEvent(a)})},d.prototype.getNewList=function(a){var b=new s2c_faction_get_list_result;s2c_faction_get_list_result.read(b,a),this._applyFactionUiPanel&&this._applyFactionUiPanel.applyzhaomupanel&&this._applyFactionUiPanel.applyzhaomupanel.getDataAndRefresh(b),console.log("---faction---",b)},d.prototype.rankLiskResult=function(a){var b=new s2c_rank_add_like_result;s2c_rank_add_like_result.read(b,a),console.log("---sral.type, sral.guid, sral.num--",b.type,b.guid,b.num)},d.prototype.getnewInvite=function(b){var c=new s2c_show_faction_invite;s2c_show_faction_invite.read(c,b),console.log("---来新的邀请了--",c.faction_guid,c.faction_name,c.guid,c.name),a.FactionModel.getInstance().chgInvitationList_add(c),ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON))},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_FACTIONUI_EVENT),new c(c.HIDE_APPLYFACTIONUI_EVENT),new c(c.HIDE_EXISTFACTIONUI_EVENT),new c(c.REFRESHAPPLYZHAOMUlIST_EVENT),new c(c.REFRESHAPPLYZHAOMUlISTISOK_EVENT),new c(c.REFRESHFACTIONITEM_EVENT),new c(c.JOINFACTIONITEM_EVENT),new c(c.REFRESHFACTIONITEMAPPLY_EVENT),new c(c.REFRESHFACTIONLEV_EVENT),new c(c.REFRESHFACTIONMONEY_EVENT),new c(c.REFRESHFACTIONGX_EVENT),new c(c.REFRESHFACTIONGG_EVENT),new c(c.REFRESHFACTIONIDENTITY_EVENT),new c(c.SHOW_FACTIONAPPOINTMENT_EVENT),new c(c.FACTION_QUIT_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new c(c.SHOW_FACTIONRECRUITING_EVENT),new c(c.SHOW_FACTIONNOTICE_EVENT),new c(c.FUNBUILD_CHG_EVENT),new c(c.SHOW_FACTIONACTIVE_PANEL_EVENT),new c(c.SHOW_FACTIONACTIVE_LEAD_CHANGE_EVENT),new c(c.SHOW_FACTIONACTIVE_TRIP_CHANGE_EVENT),new c(c.SHOW_FACTIONSKILL_PANEL_EVENT),new c(c.SHOW_FACTIONSKILL_CHG_EVENT),new c(c.SHOW_INVITATION_EVENT),new c(c.INVITATION_CHG_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE)]},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_FACTION_GET_LIST_RESULT]=function(b){a.getNewList(b)},b[Protocols.SMSG_RANK_ADD_LIKE_RESULT]=function(b){a.rankLiskResult(b)},b[Protocols.SMSG_SHOW_FACTION_INVITE]=function(b){a.getnewInvite(b)},b},d}(BaseProcessor);a.FactionProcessor=d}(faction||(faction={}));var faction;!function(a){var b=function(){function a(){}return a.getNameByGuid=function(a){for(var b=GuidData.faction.getFactionList(),c=0;c<b.length;c++)if(b[c].guid==a)return b[c];return null},a.parsingToOneitemlist=function(a){for(var b=a.split(""),c=new Array,d=0;d<b.length;d++)c.push(b[d]);return c},a.getPropNameByItemID=function(a){var b=tb.TB_item_template.get_TB_item_template(a);return b.getColorName()},a.getRestTime=function(a){var b=GameInstance.getServerNow(),c=new Date(1e3*b),d=c.toLocaleDateString().replace(/\//g,"-"),e=new Date(1e3*a),f=e.toLocaleDateString().replace(/\//g,"-");console.log("==",d,f);var g=f;return d==f&&(g=e.toTimeString().substr(0,5)),g},a}();a.FactionUitl=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getInvitationList=function(){return this._invitationList||(this._invitationList=new Array),this._invitationList},a.prototype.chgInvitationList_add=function(a){this._invitationList||(this._invitationList=new Array);for(var b=0;b<this._invitationList.length;b++)if(this._invitationList[b].guid==a.guid&&this._invitationList[b].faction_guid==a.faction_guid)return;this._invitationList.unshift(a)},a.prototype.chgInvitationList_remove=function(a){this._invitationList||(this._invitationList=new Array);for(var b=0;b<this._invitationList.length;b++)if(this._invitationList[b].guid==a.guid&&this._invitationList[b].faction_guid==a.faction_guid){this._invitationList.splice(b,1);break}},a.prototype.chgInvitationList_clear=function(){if(this._invitationList)for(;this._invitationList.length>0;)this._invitationList.pop();else this._invitationList=new Array},a}();a.FactionModel=c}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_BOSS_EVENT="SHOW_BOSS_EVENT",b.HIDE_BOSS_EVENT="HIDE_BOSS_EVENT",b.CLICK_BOSS_ITEM="CLICK_BOSS_ITEM",b.SHOW_END_PANEL="SHOW_END_PANEL",b.CHANGE_BOSS_CURRENTNUM="CHANGE_BOSS_CURRENTNUM",b.CHANGE_BOSS_INTEGRAL="CHANGE_BOSS_INTEGRAL",b.CHANGE_BOSS_RESIDUE="CHANGE_BOSS_RESIDUE",b.CHANGE_BOSS_CURRENTID="CHANGE_BOSS_CURRENTID",b.BOSS_NEED_REDPOINT="BOSS_NEED_REDPOINT",b}(BaseEvent);a.FactionBossEvent=b;var c=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"FactionBossProcessor"},d.prototype.receivedModuleEvent=function(a){var c=a;if(a instanceof b&&(c.type==b.SHOW_BOSS_EVENT?this.showFactionUi():c.type==b.CLICK_BOSS_ITEM?this.clickbossitem(c.data):c.type==b.SHOW_END_PANEL?this.showfactionBossEndPanel(c.data):c.type==b.HIDE_BOSS_EVENT?this.hideFactionBossUi():c.type==b.CHANGE_BOSS_CURRENTNUM?this.bosscurnum():c.type==b.CHANGE_BOSS_INTEGRAL?this.bossintegral():c.type==b.CHANGE_BOSS_RESIDUE?this.bossresidue():c.type==b.CHANGE_BOSS_CURRENTID?this.bosscurrentid():c.type==b.BOSS_NEED_REDPOINT&&this.needredpoint()),a instanceof EngineEvent){var d=a;d.type==EngineEvent.MONEY_TYPE_SILVER||d.type==EngineEvent.MONEY_TYPE_GOLD_INGOT}if(a instanceof UIPanelEvent){var e=a;e.panel==this._factionBossUiPanel&&(this._factionBossUiPanel.dispose(),this._factionBossUiPanel=null,console.log("释放面板 _factionBossUiPanel")),e.panel==this._factionBossEnd&&(this._factionBossEnd.dispose(),this._factionBossEnd=null,console.log("释放面板 _factionBossEnd"))}},d.prototype.needredpoint=function(){this._factionBossUiPanel&&this._factionBossUiPanel.factionBossRightPanel&&this._factionBossUiPanel.factionBossRightPanel.hasStage&&this._factionBossUiPanel.factionBossRightPanel.Isneedredpoint()},d.prototype.bosscurrentid=function(){this._factionBossUiPanel&&this._factionBossUiPanel.factionBossRightPanel&&this._factionBossUiPanel.factionBossRightPanel.hasStage&&this._factionBossUiPanel.factionBossRightPanel.Needrefresh()},d.prototype.bosscurnum=function(){this._factionBossUiPanel&&this._factionBossUiPanel.hasStage&&this._factionBossUiPanel.refreshCurrentNum()},d.prototype.bossintegral=function(){this._factionBossUiPanel&&this._factionBossUiPanel.hasStage&&this._factionBossUiPanel.refreshCurrentIntegral()},d.prototype.bossresidue=function(){this._factionBossUiPanel&&this._factionBossUiPanel.hasStage&&this._factionBossUiPanel.refreshCurrentResidue()},d.prototype.clickbossitem=function(a){this._factionBossUiPanel&&this._factionBossUiPanel.factionBossRightPanel&&this._factionBossUiPanel.factionBossRightPanel.hasStage&&this._factionBossUiPanel.factionBossRightPanel.resetData(a)},d.prototype.hideFactionBossUi=function(){this._factionBossUiPanel&&this._factionBossUiPanel.hide()},d.prototype.showFactionUi=function(){var b=this;this._factionBossUiPanel||(this._factionBossUiPanel=new a.FactionBossUiPanel),this._factionBossUiPanel.load(function(){b._factionBossUiPanel.show()})},d.prototype.showfactionBossEndPanel=function(b){var c=this;this._factionBossEnd||(this._factionBossEnd=new a.FactionBossEnd),this._factionBossEnd.load(function(){c._factionBossEnd.show(b)},!1)},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_BOSS_EVENT),new b(b.HIDE_BOSS_EVENT),new b(b.CLICK_BOSS_ITEM),new b(b.SHOW_END_PANEL),new b(b.CHANGE_BOSS_CURRENTNUM),new b(b.CHANGE_BOSS_INTEGRAL),new b(b.CHANGE_BOSS_RESIDUE),new b(b.CHANGE_BOSS_CURRENTID),new b(b.BOSS_NEED_REDPOINT),new EngineEvent(EngineEvent.MONEY_TYPE_SILVER),new EngineEvent(EngineEvent.MONEY_TYPE_GOLD_INGOT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_FACTION_BOSS_SEND_RESULT]=function(b){a.getNewList(b)},b},d.prototype.getNewList=function(b){var c=new s2c_faction_boss_send_result;s2c_faction_boss_send_result.read(c,b);var d=new a.FactionBossEvent(a.FactionBossEvent.SHOW_END_PANEL);d.data=c,ModuleEventManager.dispatchEvent(d)},d}(BaseProcessor);a.FactionBossProcessor=c}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._topRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a._publicRender.uiAtlas=b,a._topRender.uiAtlas.setInfo("ui/uidata/faction/factionboss/factionboss.xml","ui/uidata/faction/factionboss/factionboss.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionboss/factionbossuse.png")})},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._topRender.uiAtlas,this.winmidRender.uiAtlas=this._topRender.uiAtlas;var a=this._topRender;this.addChild(this.winmidRender.getComponent("a_list_bg")),this.addChild(this.winmidRender.getComponent("a_left_line")),this.addChild(this._baseRender.getComponent("a_bottom_bg")),this.addChild(this._baseRender.getComponent("a_num_bg2")),this.addChild(this._baseRender.getComponent("a_num_bg1")),this.addChild(this._baseRender.getComponent("a_num_bg0")),this.addChild(a.getComponent("a_res_icon1")),this.addChild(a.getComponent("a_res_icon0")),this.a_5=this.addChild(a.getComponent("a_5")),this.a_6=this.addChild(a.getComponent("a_6")),this.a_7=this.addChild(a.getComponent("a_7")),this.addChild(a.getComponent("a_rand_but")),this.addChild(a.getComponent("a_boss_lp_label")),this.addChild(a.getComponent("a_kill_jifen_label")),this.addChild(a.getComponent("a_day_canget_label")),this.addChild(a.getComponent("a_boss_buy_label")),this.addChild(a.getComponent("a_rewaard_info_label")),this.addChild(a.getComponent("a_win_tittle")),this.applyLoadComplete()},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.factionBossRightPanel||(this.factionBossRightPanel=new a.FactionBossRightPanel,this.factionBossRightPanel.initUiAtlas(this._topRender.uiAtlas,this._publicRender.uiAtlas)),this.factionBossRightPanel.show(),this.refreshCurrentNum(),this.refreshCurrentIntegral(),this.refreshCurrentResidue(),ModulePageManager.showResTittle([1,2,3])},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.factionBossRightPanel&&this.factionBossRightPanel.hide(),b.prototype.hide.call(this)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.refreshCurrentNum=function(){var a=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_5.skinName,ColorType.Orange853d07+GuidData.faction.getBossTokenNum()+"/"+a.token_max_keep,16)},c.prototype.refreshCurrentIntegral=function(){var a=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_6.skinName,ColorType.Orange853d07+GuidData.faction.getBossTokenPoints()+"/"+a.token_points,16)},c.prototype.refreshCurrentResidue=function(){var a=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev()),b=a.token_daily-GuidData.faction.getBossTokenPointscount();LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_7.skinName,ColorType.Orange853d07+String(b),16)},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.FactionBossEvent(a.FactionBossEvent.HIDE_BOSS_EVENT))}},c}(WindowUi);a.FactionBossUiPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);this._customRenderAry[0],this._customRenderAry[1];this.C_list_cell=this.creatSUI(d,this.parentTarget.baseAtlas,"C_list_cell",0,0,256,80),a.addChild(this.C_list_cell)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.applyrender(),b){var c=new a.FactionBossEvent(a.FactionBossEvent.CLICK_BOSS_ITEM);c.data=this.itdata.data,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.applyrender=function(){var a=this,b=this.itdata.data;LoadManager.getInstance().load(Scene_data.fileRoot+getUIIconUrl(String(b.data.entry)),LoadManager.IMG_TYPE,function(c){var d=a.uiAtlas,e=a.parentTarget.baseAtlas,f=a.C_list_cell.skinName,g=d.getRec(f),h=UIManager.getInstance().getContext2D(g.pixelWitdh,g.pixelHeight,!1);if(a.selected&&UiDraw.drawToUiAtlasToCtx(h,e,"S_select_bg",new Rectangle(0,0,256,80)),UiDraw.drawToUiAtlasToCtx(h,e,"S_icon_bg",new Rectangle(6,11)),h.drawImage(c,0,0,65,65,10,15,52,52),LabelTextFont.writeSingleLabelToCtx(h,ColorType.Green20a200+b.data1.name,18,75,14,TextAlign.LEFT),1==b.state?(UiDraw.drawToUiAtlasToCtx(h,e,"S_tiaozhan",new Rectangle(195,6)),LabelTextFont.writeSingleLabelToCtx(h,ColorType.Orange853d07+"剩余时间:"+ColorType.colorce0a00+b.time[0]+":"+b.time[1],14,75,46,TextAlign.LEFT)):3==b.state&&(UiDraw.drawToUiAtlasToCtx(h,e,"S_tiaozhan",new Rectangle(195,6)),LabelTextFont.writeSingleLabelToCtx(h,ColorType.Orange853d07+"倒计时间:"+ColorType.colorce0a00+b.time[0]+":"+b.time[1],14,75,46,TextAlign.LEFT)),1==b.state1&&UiDraw.drawToUiAtlasToCtx(h,e,"S_pass",new Rectangle(185,18)),3==b.state1){var i="";b.data.faction_lv_limit>GuidData.faction.getLev()?(i="帮会"+b.data.faction_lv_limit+"级解锁",UiDraw.drawToUiAtlasToCtx(h,e,"S_mask",new Rectangle(0,0,256,80)),LabelTextFont.writeSingleLabelToCtx(h,ColorType.Whiteffffff+i,20,75,25,TextAlign.LEFT)):(i="击杀上一个boss解锁",LabelTextFont.writeSingleLabelToCtx(h,ColorType.Orange853d07+i,14,75,46,TextAlign.LEFT))}UiDraw.drawToUiAtlasToCtx(h,e,"S_line",new Rectangle(0,0,256,4)),TextureManager.getInstance().updateTexture(d.texture,g.pixelX,g.pixelY,h)})},c.prototype.render=function(a){this.itdata=a,a?(this.applyrender(),this.C_list_cell.addEventListener(InteractiveEvent.Up,this.equClick,this)):(this.C_list_cell.removeEventListener(InteractiveEvent.Up,this.equClick,this),this.setnull())},c.prototype.equClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata){var b=this.itdata.data;if(3==b.state1)return void msgtip.MsgTipManager.outStrById(22,51);this.setSelect()}},c.prototype.setnull=function(){},c}(SListItem);a.FactionBossRender=b;var c=function(c){function d(){var a=c.call(this)||this;return a.left=141,a.top=118,a}return __extends(d,c),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,b,256,350,0,80,3,256,512,1,6,2)},d.prototype.refreshDataByNewData=function(){var a=this.getData();this.refreshData(a)},d.prototype.getData=function(){var b=new Array,c=a.FactionBossModel.getInstance().getList();console.log("--listary--",c);for(var d=0;d<c.length;d++){var e=new SListItemData;e.data=c[d],e.id=d,b.push(e)}return b},d.prototype.show=function(a){this._type=a,console.log("$type--",a),this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},d.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData(),this.setSelectIndex(this._type)},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.FactionBossList=c;var d=function(b){function d(){var a=b.call(this)||this;return a.starItem=new Array,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a}return __extends(d,b),d.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this.bosslist&&(this.bosslist.dispose(),this.bosslist=null)},d.prototype.initUiAtlas=function(a,b){this._bottomRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._publicuiAtlas=b,this.initView()},d.prototype.initView=function(){var a=this,b=this._baseRender;this.tickFun=function(){a.refreshBossState()},this.Needrefresh(),this.addChild(b.getComponent("a_select_boss_label")),this.a_1=this.addChild(b.getComponent("a_1")),this.a_2=this.addChild(b.getComponent("a_2")),this.b_zhaohuan=this.addEvntBut("b_zhaohuan",b),this.a_4=this.addChild(b.getComponent("a_4")),this.b_add=this.addEvntBut("b_add",b),this.a_8=b.getComponent("a_8"),this.Isneedredpoint(),this.a_9=this.addChild(b.getComponent("a_9"))},d.prototype.refreshBossState=function(){this.bosslist&&this.bosslist.refreshDataByNewData(),a.FactionBossModel.getInstance().isneedcountdown&&this.hasStage||TimeUtil.removeTimeTick(this.tickFun)},d.prototype.Needrefresh=function(){0!=GuidData.faction.getBosschallengeidCur()&&TimeUtil.addTimeTick(1e3,this.tickFun)},d.prototype.resize=function(){b.prototype.resize.call(this),this.bosslist&&(this.bosslist.left=this.a_9.parent.x/UIData.Scale+this.a_9.x,this.bosslist.top=this.a_9.parent.y/UIData.Scale+this.a_9.y)},d.prototype.show=function(){
this.hasStage||UIManager.getInstance().addUIContainer(this),this.bosslist||(this.bosslist=new c,this.bosslist.init(this._bottomRender.uiAtlas)),this.bosslist.show(a.FactionBossModel.getInstance().getIndex()),this.resize()},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.bosslist&&this.bosslist.hide()},d.prototype.resetData=function(b){for(console.log("---data---",b),this._data=b,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_1.skinName,ColorType.Brown6a4936+"LV"+b.data1.level,14,TextAlign.LEFT,"#000000"),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_2.skinName,ColorType.Brown6a4936+b.data.time/60+"分钟",14,TextAlign.LEFT,"#000000");this.starItem.length;)this.removeChild(this.starItem.pop());for(var c=a.FactionBossModel.getInstance().getBossStart(b.data1.level),d=0;c>d;d++){var e=this.addChild(this._baseRender.getComponent("a_star"));e.x+=20*d,this.starItem.push(e)}this.drawRewardFrame(b.data.all_rewards),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_4.skinName,ColorType.Orange853d07+b.data.token_cost,16),this.resize()},d.prototype.drawRewardFrame=function(a){this.clearRewardUi();for(var b=0;b<a.length;b++){var c=this.addChild(this._baseRender.getComponent("a_reward_frame"));c.addEventListener(InteractiveEvent.Down,this.rewardClik,this),c.x+=75*b,c.goToAndStop(b),this.drawRewardFrameCtx(a[b],c),this.rewardFrameUiArr.push(c)}},d.prototype.drawRewardFrameCtx=function(a,b){var c=this;b.data=a[0],IconManager.getInstance().getIcon(GameData.getIconCopyUrl(a[0]),function(d){var e=b.getSkinCtxRect(),f=UIManager.getInstance().getContext2D(e.width,e.height,!1);UiDraw.cxtDrawImg(f,PuiData.PropBg60,new Rectangle(0,0,66,66),UIData.publicUi),f.drawImage(d,0,0,60,60,4,4,58,58),ArtFont.getInstance().writeFontToCtxRight(f,String(a[1]),ArtFont.num1,64,45),b.drawToCtx(c._baseRender.uiAtlas,f)})},d.prototype.clearRewardUi=function(){if(this.rewardFrameUiArr)for(;this.rewardFrameUiArr.length;)this.removeChild(this.rewardFrameUiArr.pop());else this.rewardFrameUiArr=new Array},d.prototype.Isneedredpoint=function(){var a=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());a.token_max_keep<=GuidData.faction.getBossTokenNum()?this.setUiListVisibleByItem([this.a_8],!0):this.setUiListVisibleByItem([this.a_8],!1)},d.prototype.rewardClik=function(a){var b=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);b.id=a.target.data,ModuleEventManager.dispatchEvent(b)},d.prototype.butClik=function(a){switch(a.target){case this.b_zhaohuan:if(1!=this.getIdentity())return void msgtip.MsgTipManager.outStrById(22,52);if(0!=GuidData.faction.getBosschallengeidCur())return void msgtip.MsgTipManager.outStrById(22,53);if(3==this._data.state1)return void msgtip.MsgTipManager.outStrById(22,51);if(GuidData.faction.getBossTokenNum()<this._data.data.token_cost)return void msgtip.MsgTipManager.outStrById(22,54);NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_CHALLENGE_BOSS,this._data.data.id,0,"","");break;case this.b_add:this.showDuihuanYinbiPanel()}},d.prototype.showDuihuanYinbiPanel=function(){var a=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());if(GuidData.faction.getBossTokenNum()<a.token_max_keep){var b=GuidData.faction.getBossTokentodaybuycount();if(b<a.token_buy_price.length){var c=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL);c.resoureItem=a.token_buy_price,c.cutNum=a.token_buy_price.length-b,c.Info1="家族Boss剩余可购买",c.SubmitFun=function(a){NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_BUY_TOKEN,a,0,"","")},ModuleEventManager.dispatchEvent(c)}else msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"购买次数已用完..",99)}else msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"先请挑战..",99)},d.prototype.getIdentity=function(){for(var a=GuidData.faction.getFactionList(),b=0;b<a.length;b++)if(a[b].guid==GuidData.player.getGuid())return a[b].identity;return-1},d}(UIVirtualContainer);a.FactionBossRightPanel=d}(faction||(faction={}));var faction;!function(a){var b=function(){function a(){this.isneedcountdown=!1}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getList=function(){for(var a=new Array,b=tb.TB_faction_boss.get_TB_faction_boss(),d=!1,e=0;e<b.length;e++){var f=new c;f.state=2,f.state1=2,GuidData.faction.getBosschallengeidCur()==b[e].id?(this.comPareTime(GuidData.faction.getBosschallengeStartTime()+b[e].wait_time)?(f.state=3,f.time=this.getTime(GuidData.faction.getBosschallengeStartTime()+b[e].wait_time)):(f.state=1,f.time=this.getTime(GuidData.faction.getBosschallengeStartTime()+b[e].wait_time+b[e].time)),d=!0):GuidData.faction.getBosschallengeidMax()>=b[e].id?f.state1=1:GuidData.faction.getBosschallengeidMax()+1==b[e].id&&GuidData.faction.getLev()>=b[e].faction_lv_limit?f.state1=2:f.state1=3,f.data=b[e],f.data1=tb.TB_creature_template.get_TB_creature_template(b[e].entry),a.push(f)}return this.isneedcountdown=d,a},a.prototype.getIndex=function(){for(var a=this.getList(),b=0,c=0;c<a.length;c++){if(2!=a[c].state)return c;3!=a[c].state1&&(b=c)}return b},a.prototype.getTime=function(a){var b,c,d=GameInstance.getServerNow(),e=new Date(d),f=a-e.getTime();return 60>f?(b=0,c=f):(b=Math.floor(f/60),c=f-60*b),[b,c]},a.prototype.comPareTime=function(a){var b=GameInstance.getServerNow(),c=new Date(b),d=a-c.getTime();return 0>d?!1:!0},a.prototype.getRankList=function(a){for(var b=new Array,c=GuidData.faction.getRankList(),e=0;e<c.length;e++){var f=this.getcurvo(c[e].guid);if(f){var g=new d;g.rankid=e+1,g.name=f.name,g.title="头衔名字"+e,g.output=c[e].output,g.ratio=this.getTotaloutput(g.output,c),g.rewardary=this.getReward(a,g.rankid),f.guid==GuidData.player.getGuid()&&(g.isme=!0),b.push(g)}}return b},a.prototype.getTotaloutput=function(a,b){for(var c=0,d=0;d<b.length;d++)c+=b[d].output;var e=Math.floor(a/c*100);return e},a.prototype.getReward=function(a,b){for(var c=tb.TB_faction_boss_reward.get_TB_faction_boss_reward(),d=new Array,e=0;e<c.length;e++)c[e].monster_id==a&&d.push(c[e]);for(var e=0;e<d.length;e++)if(b>=d[e].rank[0]&&b<=d[e].rank[1])return d[e];return null},a.prototype.getcurvo=function(a){for(var b=GuidData.faction.getFactionList(),c=0;c<b.length;c++)if(b[c].guid==a)return b[c];return null},a.prototype.getBossStart=function(a){var b,c=.1*a-GuidData.faction.getLev();return b=0>=c?1:.2>=c?2:.5>=c?3:.7>=c?4:5},a}();a.FactionBossModel=b;var c=function(){function a(){}return a}();a.FBossItemVo=c;var d=function(){function a(){this.isme=!1}return a}();a.RankVo=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.Rankid=this.creatSUI(d,this.parentTarget.baseAtlas,"Rankid",20,17,30,20),b.addChild(this.Rankid),this.Name=this.creatSUI(d,this.parentTarget.baseAtlas,"Name",97,17,138,20),b.addChild(this.Name),this.Title=this.creatSUI(d,this.parentTarget.baseAtlas,"Title",246,17,84,20),b.addChild(this.Title),this.Output=this.creatSUI(d,this.parentTarget.baseAtlas,"Output",363,17,84,20),b.addChild(this.Output),this.Reward0=this.creatSUI(d,this.parentTarget.baseAtlas,"Reward0",490,3,50,50),b.addChild(this.Reward0),this.Reward0.addEventListener(InteractiveEvent.Up,this.equClick,this),this.Bg=this.creatSUI(c,this.parentTarget.baseAtlas,"Bg",0,0,584,55),b.addChild(this.Bg)},b.prototype.drawBg=function(){var a=this.uiAtlas.getRec(this.Bg.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh+2,a.pixelHeight+2,!1);b.fillStyle="#e7d7be",b.fillRect(0,0,a.pixelWitdh+2,a.pixelHeight+2),this.uiAtlas.updateCtx(b,a.pixelX-1,a.pixelY-1)},b.prototype.applyrender=function(){var a=this.itdata.data;console.log("--vo--",a,this.itdata.id),a.rankid%2==1?this.drawBg():this.uiAtlas.clearCtxTextureBySkilname(this.Bg.skinName);var b=a.isme?ColorType.Brown6a4936:ColorType.Orange853d07;LabelTextFont.writeSingleLabel(this.uiAtlas,this.Rankid.skinName,b+String(a.rankid),16),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name.skinName,b+getBaseName(a.name),16),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Title.skinName,b+a.title,16),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Output.skinName,b+a.output,16),1==this.itdata.id?this.drawReward(a.rewardary.reward[0]):a.rewardary&&this.drawReward(a.rewardary.fail_reward[0])},b.prototype.render=function(a){this.itdata=a,a?this.applyrender():this.setnull()},b.prototype.drawReward=function(a){var b=this;this.Reward0.data=a[0],IconManager.getInstance().getIcon(GameData.getIconCopyUrl(a[0]),function(a){var c=b._baseRender.uiAtlas.getRec(b.Reward0.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.A_BLACK_F,new Rectangle(0,0,50,50),UIData.publicUi),d.drawImage(a,0,0,60,60,2,2,46,46),b._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},b.prototype.equClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){var b=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);b.id=a.target.data,ModuleEventManager.dispatchEvent(b)}},b.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.Rankid.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Name.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Title.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Output.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Reward0.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.Bg.skinName)},b}(SListItem);a.FactionBossEndRender=b;var c=function(c){function d(){var a=c.call(this)||this;return a.left=324,a.top=153,a}return __extends(d,c),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,b,584,220,0,55,5,256,512,1,5)},d.prototype.refreshDataByNewData=function(){var a=this.getData();this.refreshData(a)},d.prototype.getData=function(){for(var b=new Array,c=a.FactionBossModel.getInstance().getRankList(this._result),d=0;d<c.length;d++){var e=new SListItemData;e.data=c[d],e.id=this._result,b.push(e)}return b},d.prototype.show=function(a){this._result=a,this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},d.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData(),this.setSelectIndex(0)},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.FactionBossEndList=c;var d=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topRender.uiAtlas=new UIAtlas,b._frameFun=function(a){b.upTime(a)},b}return __extends(b,a),b.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,this.factionBossEndList&&(this.factionBossEndList.dispose(),this.factionBossEndList=null),a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a._publicRender.uiAtlas=b,a._topRender.uiAtlas.setInfo("ui/uidata/faction/factionboss/factionbossend.xml","ui/uidata/faction/factionboss/factionbossend.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionpc.png")})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_label4")),this.addChild(this._bottomRender.getComponent("a_label3")),this.addChild(this._bottomRender.getComponent("a_label2")),this.addChild(this._bottomRender.getComponent("a_label1")),this.addChild(this._bottomRender.getComponent("a_label0")),this.addChild(this._bottomRender.getComponent("a_tittle")),this.addChild(this._topRender.getComponent("a_height_line0")),this.addChild(this._topRender.getComponent("a_height_line1")),this.addChild(this._topRender.getComponent("a_height_line2")),this.addChild(this._topRender.getComponent("a_height_line3")),this.addChild(this._topRender.getComponent("a_width_line0")),this.addChild(this._topRender.getComponent("a_width_line1")),this.a_end_tip_info=this.addChild(this._topRender.getComponent("a_end_tip_info")),this.a_submit=this.addEvntBut("a_submit",this._midRender),this.a_list_pos=this.addChild(this._midRender.getComponent("a_list_pos")),this.applyLoadComplete()},b.prototype.butClik=function(a){switch(a.target){case this.a_submit:case this.e_close:this.close()}},b.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),this.factionBossEndList&&this.factionBossEndList.hide()},b.prototype.show=function(a){this.endTime=TimeUtil.getTimer()+1e4,TimeUtil.addFrameTick(this._frameFun),UIManager.getInstance().addUIContainer(this),this.factionBossEndList||(this.factionBossEndList=new c,this.factionBossEndList.init(this._bottomRender.uiAtlas)),this.factionBossEndList.show(a.result);var b;b=1==a.result?ColorType.Brown6a4936+"挑战成功。家族资金 +"+ColorType.Green20a200+"+"+a.money+ColorType.Brown6a4936+"！家族额外获得【XXXX】":ColorType.Brown6a4936+"挑战失败。家族资金 -"+ColorType.colorce0a00+"-"+a.money+ColorType.Brown6a4936+"！请提升家族实力再来挑战",LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_end_tip_info.skinName,b,14),this.resize()},b.prototype.resize=function(){a.prototype.resize.call(this),this.factionBossEndList&&(this.factionBossEndList.left=this.a_list_pos.parent.x/UIData.Scale+this.a_list_pos.x,this.factionBossEndList.top=this.a_list_pos.parent.y/UIData.Scale+this.a_list_pos.y)},b.prototype.upTime=function(a){var b=Math.floor((this.endTime-TimeUtil.getTimer())/1e3);this._curtime!=b&&(this._curtime=b,console.log(this._curtime),0>b&&this.close()),this.hasStage||TimeUtil.removeFrameTick(this._frameFun)},b}(WindowMinUi);a.FactionBossEnd=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.left=54,a.top=88,a}return __extends(d,b),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,c,152,421,0,50,6,256,512,1,8)},d.prototype.refreshDataByNewData=function(){var a=this.getData();this.refreshData(a)},d.prototype.getData=function(){for(var b=new Array,c=a.FactionBuildModel.getInstance().getList(),d=0;d<c.length;d++){var e=new SListItemData;e.data=c[d],e.id=d,b.push(e)}return b},d.prototype.show=function(a){this.hasStage||UIManager.getInstance().addUIContainer(this)},d.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData(),this.setSelectIndex(this.getCurrentSelectIndex())},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.FactionBuildList=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.ItemBg=this.creatSUI(d,this.parentTarget.baseAtlas,"ItemBg",0,0,152,50),this.ItemBg.addEventListener(InteractiveEvent.Up,this.equClick,this),a.addChild(this.ItemBg)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.applyrender(),b){var c=new a.FactionBuildEvent(a.FactionBuildEvent.CLICK_BUILD_ITEM);c.data=this.itdata.data,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.applyrender=function(){var a,b=this.itdata.data,c=this._baseRender.uiAtlas.getRec(this.ItemBg.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);a=this.selected?"Selectok":"Selectno";var e=this.parentTarget.baseAtlas.getRec(a);if(d.drawImage(this.parentTarget.baseAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,0,e.pixelWitdh,e.pixelHeight),LabelTextFont.writeSingleLabelToCtxSetAnchor(d,b.data.name,16,76,14,TextAlign.CENTER,ColorType.Brown7a2f21),1==b.state){var f=this.parentTarget.baseAtlas.getRec("Buiild");d.drawImage(this.parentTarget.baseAtlas.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,0,0,f.pixelWitdh,f.pixelHeight),LabelTextFont.writeSingleLabelToCtxSetAnchor(d,"建造中",20,76,13,TextAlign.CENTER,"#ffffff")}else if(2==b.state){var f=this.parentTarget.baseAtlas.getRec("Noopen");d.drawImage(this.parentTarget.baseAtlas.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,0,0,f.pixelWitdh,f.pixelHeight),LabelTextFont.writeSingleLabelToCtxSetAnchor(d,"主殿 LV"+b.data.unlock+" 解锁",20,76,13,TextAlign.CENTER,"#ffffff")}this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.render=function(a){this.itdata=a,a?this.applyrender():this.setnull()},c.prototype.equClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&(console.log("--点击--",this.itdata),this.itdata)){var b=this.itdata.data;if(2==b.state)return void msgtip.MsgTipManager.outStrById(22,51);this.setSelect()}},c.prototype.setnull=function(){LabelTextFont.clearLabel(this.uiAtlas,this.ItemBg.skinName)},c}(SListItem);a.FactionBuildRender=c;var d=function(a){function c(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(c,a),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this.buildlist&&(this.buildlist.dispose(),this.buildlist=null)},c.prototype.initUiAtlas=function(a,b){this._bottomRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._publicRender.uiAtlas=b,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.build=this.addEvntButUp("cnew_btn1",this._publicRender),this.build.x=725,this.build.y=352,this._buildLevAry=new Array,this._buildLevAry.push(this.build),this._buildLevAry.push(a.getComponent("build")),this.name=this.addChild(a.getComponent("a_16")),this.maxlev=a.getComponent("a_21"),this.oncetime=this.addChild(a.getComponent("a_22")),this.res=this.addChild(a.getComponent("a_23")),this.curmoney=this.addChild(a.getComponent("a_24")),this.icon=this.addChild(a.getComponent("a_25")),this.addUIList(["bg3_4","bg3_5","bg3_6","a_26"],this._bottomRender);var b=a.getComponent("a_6"),c=this.addChild(a.getComponent("a_7")),d=this.addChild(a.getComponent("a_8")),e=this.addChild(a.getComponent("a_9"));LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,b.skinName,"建筑等级上限：",16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,c.skinName,"建造所需时间：",16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,d.skinName,"消耗家族资金：",16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,e.skinName,"当前家族资金：",16,TextAlign.LEFT,ColorType.Brown7a2f21),this._MaxLevAry=new Array,this._MaxLevAry.push(b),this._MaxLevAry.push(this.maxlev),this._MaxLevAry.push(this._bottomRender.getComponent("bg3_3")),this._uiAry=new Array;for(var f=0;5>f;f++)this._uiAry.push(a.getComponent("a_"+(11+f)));this.a_5=this.addChild(a.getComponent("a_5")),this.addUIList(["line1","xBg1"],a)},c.prototype.resize=function(){a.prototype.resize.call(this),this.buildlist&&(this.buildlist.left=this.a_5.parent.x/UIData.Scale+this.a_5.x,this.buildlist.top=this.a_5.parent.y/UIData.Scale+this.a_5.y)},c.prototype.show=function(){this.buildlist||(this.buildlist=new b,this.buildlist.init(this._bottomRender.uiAtlas)),this.buildlist.show(0),this.hasStage||UIManager.getInstance().addUIContainer(this),this.buildlist.refreshAndselectIndex(),this.resize()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.buildlist&&this.buildlist.hide()},c.prototype.resetData=function(a){this._data=a,this.setUiListVisibleByItem(this._buildLevAry,0!=a.data.can_lvup),this._bottomRender.uiAtlas.upDataPicToTexture(getFactionBuildMapUrl(a.data.type),this.icon.skinName),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.name.skinName,a.data.level+"级"+a.data.name,16,TextAlign.CENTER,ColorType.colorb96d49),1==a.data.type?(LabelTextFont.clearLabel(this._bottomRender.uiAtlas,this.maxlev.skinName),this.setUiListVisibleByItem(this._MaxLevAry,!1)):(this.setUiListVisibleByItem(this._MaxLevAry,!0),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.maxlev.skinName,"  "+GuidData.faction.getLev()+"级",16,TextAlign.LEFT,ColorType.Green2ca937,ColorType.colord27262e)),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.oncetime.skinName,"  "+this.getTimestr(a.data.time),16,TextAlign.LEFT,ColorType.Green2ca937,ColorType.colord27262e),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.res.skinName,"  "+String(a.data.cost),16,TextAlign.LEFT,ColorType.Green2ca937,ColorType.colord27262e),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.curmoney.skinName,"  "+String(GuidData.faction.getMoney()),16,TextAlign.LEFT,ColorType.Green2ca937,ColorType.colord27262e),this.setUiListVisibleByItem(this._uiAry,!1);for(var b=0;b<a.data.desc.length;b++)this.drawinfo(this._uiAry[b],a.data.desc[b],16,ColorType.Green56da35,264),this.setUiListVisibleByItem([this._uiAry[b]],!0);this.resize()},c.prototype.drawinfo=function(a,b,c,d,e){void 0===e&&(e=0),-1!=d.indexOf("[")&&(d="#"+d.substr(1,6));var f=this._baseRender.uiAtlas.getRec(a.skinName),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);g.font="bolder "+c+"px "+UIData.font,TextRegExp.wrapText(g,"[853d07]"+b,d,0,0,e,16),this._baseRender.uiAtlas.updateCtx(g,f.pixelX,f.pixelY)},c.prototype.getTimestr=function(a){var b=Math.floor(a/60),c=a-60*b,d="";if(b>0)var d=b+"小时";var e=d+c+"分钟";return e},c.prototype.rewardClik=function(a){var b=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);b.id=a.target.data,ModuleEventManager.dispatchEvent(b)},c.prototype.butClik=function(a){var b=this;switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.build:if(!this.getIdentity())return void msgtip.MsgTipManager.outStrById(22,52);if(0!=GuidData.faction.getBuildCur())return void TimeUtil.addTimeOut(30,function(){AlertUtil.show("当前有建筑正在建造中，是否需要加速建造？","提示",function(a){b.backFun(a)})});if(GuidData.faction.getMoney()<this._data.data.cost)return void msgtip.MsgTipManager.outStrById(22,55);if(GuidData.faction.getLev()<=this._data.data.level&&1!=this._data.data.type)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"当前建筑已达等级上限",99);NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_BUILDING_UPGRADE,this._data.data.id,0,"","")}},c.prototype.backFun=function(a){var b=this;if(1==a){var c=tb.TB_faction_building_base.get_TB_faction_building_baseById(1),d=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL);d.resoureItem=c.speedup_cost,d.Info1="剩余";var e=tb.TB_faction_building_base.get_TB_faction_building_baseById(1);d.Info2="一次加速减少"+e.speedup_time+"分钟建造时间",d.cutNum=c.speedup_limit-GuidData.player.getFactionSpeedUpNum(),d.SubmitFun=function(a){b.compareTime(a*c.speedup_time)?NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_BUILDING_UPGRADE_SPEEDUP,a,0,"",""):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"建筑即将建造完成，请减少购买次数",99)},ModuleEventManager.dispatchEvent(d)}},c.prototype.compareTime=function(a){var b=GameInstance.getServerNow(),c=new Date(b),d=c.getTime()+60*a-GuidData.faction.getBuildEndTime()-59;return d>0?!1:!0},c.prototype.getIdentity=function(){for(var a,b=GuidData.faction.getFactionList(),c=0;c<b.length;c++)if(b[c].guid==GuidData.player.getGuid()){a=b[c].identity;break}for(var d=tb.TB_faction_building_base.get_TB_faction_building_baseById(1),c=0;c<d.zhiwei_limit.length;c++)if(d.zhiwei_limit[c]==a)return!0;return!1},c}(UIVirtualContainer);a.FactionBuildRightPanel=d}(faction||(faction={}));var faction;!function(a){var b=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getList=function(){for(var a=-100,b=new Array,d=tb.TB_faction_building.get_TB_faction_building(),e=GuidData.faction.getHaveBuild(),f=0;f<e.length;f++)if(e[f]>0){var g=new c;g.data=tb.TB_faction_building.get_TB_faction_buildingById(e[f]),GuidData.faction.getBuildCur()==e[f]?g.state=1:g.state=3,b.push(g)}for(var f=0;f<d.length;f++){if(d[f].type!=a&&!this.hasItem(d[f],b)){var g=new c;g.data=d[f],g.state=2,b.push(g)}a=d[f].type}return b},a.prototype.hasItem=function(a,b){for(var c=0;c<b.length;c++)if(b[c].getType()==a.type)return!0;return!1},a.prototype.getTime=function(a){var b,c,d=GameInstance.getServerNow(),e=new Date(d),f=a-e.getTime();return 60>f?(b=0,c=f):(b=Math.floor(f/60),c=f-60*b),[b,c]},a.prototype.comPareTime=function(a){var b=GameInstance.getServerNow(),c=new Date(b),d=a-c.getTime();return 0>d?!1:!0},a.prototype.getTabvo=function(a){for(var b=GuidData.faction.getHaveBuild(),c=0;c<b.length;c++)if(b[c]>0){var d=b[c],e=Math.floor(d/100);if(e==a)return tb.TB_faction_building.get_TB_faction_buildingById(d)}return null},a}();a.FactionBuildModel=b;var c=function(){function a(){}return a.prototype.getType=function(){return(this.data.id-this.data.level)/100},a}();a.FBuildItemVo=c}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_BUILD_EVENT="SHOW_BUILD_EVENT",b.HIDE_BUILD_EVENT="HIDE_BUILD_EVENT",b.CLICK_BUILD_ITEM="CLICK_BUILD_ITEM",b.BUILD_STATE="BUILD_STATE",b.BUILD_ENDTIME="BUILD_ENDTIME",b}(BaseEvent);a.FactionBuildEvent=b;var c=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"FactionBuildProcessor"},d.prototype.receivedModuleEvent=function(a){var c=a;if(a instanceof b&&(c.type==b.SHOW_BUILD_EVENT?this.showFactionUi():c.type==b.CLICK_BUILD_ITEM?this.clickbossitem(c.data):c.type==b.HIDE_BUILD_EVENT?this.hideFactionBossUi():c.type==b.BUILD_STATE?this.buildstate():c.type==b.BUILD_ENDTIME&&this.buildendtime()),a instanceof EngineEvent){var d=a;d.type==EngineEvent.MONEY_TYPE_SILVER||d.type==EngineEvent.MONEY_TYPE_GOLD_INGOT}if(a instanceof UIPanelEvent){var e=a;e.panel==this._factionBuildUiPanel&&(this._factionBuildUiPanel.dispose(),this._factionBuildUiPanel=null,console.log("释放面板 _factionBuildUiPanel"))}},d.prototype.buildendtime=function(){this._factionBuildUiPanel&&this._factionBuildUiPanel.hasStage&&this._factionBuildUiPanel.resetData(),this._factionBuildUiPanel&&this._factionBuildUiPanel.factionBuildRightPanel&&this._factionBuildUiPanel.factionBuildRightPanel.buildlist&&this._factionBuildUiPanel.factionBuildRightPanel.buildlist.hasStage&&this._factionBuildUiPanel.factionBuildRightPanel.buildlist.refreshAndselectIndex()},d.prototype.buildstate=function(){this._factionBuildUiPanel&&this._factionBuildUiPanel.hasStage&&(this._factionBuildUiPanel.Needrefresh(),this._factionBuildUiPanel.resetData()),this._factionBuildUiPanel&&this._factionBuildUiPanel.factionBuildRightPanel&&this._factionBuildUiPanel.factionBuildRightPanel.buildlist&&this._factionBuildUiPanel.factionBuildRightPanel.buildlist.hasStage&&this._factionBuildUiPanel.factionBuildRightPanel.buildlist.refreshDataByNewData()},d.prototype.clickbossitem=function(a){this._factionBuildUiPanel&&this._factionBuildUiPanel.factionBuildRightPanel&&this._factionBuildUiPanel.factionBuildRightPanel.hasStage&&this._factionBuildUiPanel.factionBuildRightPanel.resetData(a)},d.prototype.hideFactionBossUi=function(){this._factionBuildUiPanel&&this._factionBuildUiPanel.hide()},d.prototype.showFactionUi=function(){var b=this;GuidData.faction?(this._factionBuildUiPanel||(this._factionBuildUiPanel=new a.FactionBuildUiPanel),this._factionBuildUiPanel.load(function(){b._factionBuildUiPanel.show()})):ModulePageManager.openPanel(SharedDef.MODULE_FACTION)},d.prototype.showfactionBossEndPanel=function(b){var c=this;this._factionBossEnd||(this._factionBossEnd=new a.FactionBossEnd),this._factionBossEnd.load(function(){c._factionBossEnd.show(b)},!1)},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_BUILD_EVENT),new b(b.HIDE_BUILD_EVENT),new b(b.CLICK_BUILD_ITEM),new b(b.BUILD_STATE),new b(b.BUILD_ENDTIME),new EngineEvent(EngineEvent.MONEY_TYPE_SILVER),new EngineEvent(EngineEvent.MONEY_TYPE_GOLD_INGOT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d.prototype.getHanderMap=function(){var a=new Object;return a},d}(BaseProcessor);a.FactionBuildProcessor=c}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._timeTickflag=!1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._topRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.factionBuildRightPanel&&(this.factionBuildRightPanel.dispose(),this.factionBuildRightPanel=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._topRender.uiAtlas.setInfo("ui/uidata/faction/factionbuild/mainbuild.xml","ui/uidata/faction/factionbuild/mainbuild.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionpc.png")},c.prototype.loadConfigCom=function(){var a=this;this._baseRender.uiAtlas=this._topRender.uiAtlas,this._publicRender.uiAtlas=WindowUi.winUIAtlas;var b=this._topRender;this.tickFun=function(){a.refreshBossState()};var c=this.addChild(this._publicRender.getComponent("cnew_coffeeBg"));this.setSizeForPanelUiCopy(c,"coffeeBg",b),this.b_speed=this.addEvntButUp("cnew_but_operation",this._publicRender),this.b_speed.x=743,this.b_speed.y=449,this._publicRender.applyObjData(),this.addUIList(["a_17","a_18"],b),this.addUIList(["bg3_1","bg3_2"],this._baseRender),this.curbuild=this.addChild(b.getComponent("a_19")),this.buildtime=this.addChild(b.getComponent("a_20"));var d=this.addChild(b.getComponent("a_1")),e=this.addChild(b.getComponent("a_3"));
LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,d.skinName,"当前建造中:",16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,e.skinName,"剩余建造时间:",16,TextAlign.LEFT,ColorType.Brown7a2f21),this.Needrefresh(),this.applyLoadComplete()},c.prototype.refreshBossState=function(){return 0!=GuidData.faction.getBuildCur()&&this.hasStage?void this.resetData():(this._timeTickflag=!1,void TimeUtil.removeTimeTick(this.tickFun))},c.prototype.Needrefresh=function(){0==GuidData.faction.getBuildCur()||this._timeTickflag||(this._timeTickflag=!0,TimeUtil.addTimeTick(5e3,this.tickFun))},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.factionBuildRightPanel||(this.factionBuildRightPanel=new a.FactionBuildRightPanel,this.factionBuildRightPanel.initUiAtlas(this._topRender.uiAtlas,this._publicRender.uiAtlas)),this.factionBuildRightPanel.show(),this.resetData()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.factionBuildRightPanel&&this.factionBuildRightPanel.hide(),b.prototype.hide.call(this)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.resetData=function(){var a="无",b="无";if(GuidData.faction.getBuildCur()>0){var c=tb.TB_faction_building.get_TB_faction_buildingById(GuidData.faction.getBuildCur());a=c.name+"  LV"+c.level+" - LV"+(c.level+1);var d=this.getRestTime(),e="",f="";d[0]>0&&(e=d[0]+"小时"),d[1]>0&&(f=d[1]+"分钟"),b=e+f}console.log("---",b),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.curbuild.skinName,"  "+a+"  ",16,TextAlign.LEFT,ColorType.Green2ca937,ColorType.colord27262e),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.buildtime.skinName,"  "+b,16,TextAlign.LEFT,ColorType.Green2ca937,ColorType.colord27262e)},c.prototype.getRestTime=function(){var a,b,c=GuidData.faction.getBuildEndTime(),d=GameInstance.getServerNow(),e=new Date(d),f=c-e.getTime();return 3600>f?(a=Math.ceil(f/60),b=0):(b=Math.floor(f/3600),a=Math.ceil(f/60)-60*b),[b,a]},c.prototype.butClik=function(b){var c=this;switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.FactionBuildEvent(a.FactionBuildEvent.HIDE_BUILD_EVENT));break;case this.b_speed:if(UiTweenScale.getInstance().changeButSize(b.target),GuidData.faction.getBuildCur()>0){var d=tb.TB_faction_building_base.get_TB_faction_building_baseById(1),e=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL);e.resoureItem=d.speedup_cost,e.Info1="剩余";var f=tb.TB_faction_building_base.get_TB_faction_building_baseById(1);e.Info2="一次加速减少"+f.speedup_time+"分钟建造时间",e.cutNum=d.speedup_limit-GuidData.player.getFactionSpeedUpNum(),e.SubmitFun=function(a){c.compareTime(a*d.speedup_time)?NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_BUILDING_UPGRADE_SPEEDUP,a,0,"",""):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"建筑即将建造完成，请减少购买次数",99)},ModuleEventManager.dispatchEvent(e)}else msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"当前无可加速建筑",99)}},c.prototype.compareTime=function(a){var b=GameInstance.getServerNow(),c=new Date(b),d=c.getTime()+60*a-GuidData.faction.getBuildEndTime()-59;return d>0?!1:!0},c}(WindowUi);a.FactionBuildUiPanel=b}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),duihuan;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.selectNum=0,b._lastMouseX=0,b._lastMcX=0,b._percentage=0,b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/faction/warehousetreasure/duihuan/duihuan.xml","ui/uidata/faction/warehousetreasure/duihuan/duihuan.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.a_tittle_frame=this.addChild(this._midRender.getComponent("a_tittle_frame")),this.a_tittle_frame.goToAndStop(0),this.addChild(this._midRender.getComponent("a_label2")),this.addChild(this._midRender.getComponent("a_label1")),this.addChild(this._midRender.getComponent("a_label0")),this.addChild(this._bottomRender.getComponent("a_txt_bg")),this.a_bar_red=this.addChild(this._midRender.getComponent("a_bar_red")),this.addChild(this._bottomRender.getComponent("a_bar_bg")),this.a_move_bar_txt=this.addChild(this._topRender.getComponent("a_move_bar_txt")),this.addChild(this._midRender.getComponent("a_res_num_bg1")),this.addChild(this._midRender.getComponent("a_res_num_bg0")),this.addChild(this._midRender.getComponent("a_right_num_bg")),this.addChild(this._midRender.getComponent("a_left_num_bg")),this.a_have_txt=this.addChild(this._midRender.getComponent("a_have_txt")),this.a_use_txt=this.addChild(this._midRender.getComponent("a_use_txt")),this.a_remaining=this.addChild(this._midRender.getComponent("a_remaining")),this.a_cancal=this.addEvntButUp("a_cancal",this._topRender),this.a_submit=this.addEvntButUp("a_submit",this._topRender),this.a_bar=this.addEvntBut("a_bar",this._topRender),this.a_move_bar_tip=this.addChild(this._midRender.getComponent("a_move_bar_tip")),this.a_bar_bg_line=this._midRender.getComponent("a_bar_bg_line"),this.a_left_txt=this.addChild(this._midRender.getComponent("a_left_txt")),this.a_right_txt=this.addChild(this._midRender.getComponent("a_right_txt")),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.drawHasResIcon=function(){UiDraw.drawRewardIconAndtxt(this.a_have_txt,[this.selectEvet.UseResType,GuidData.player.getResType(this.selectEvet.UseResType)],!1,TextAlign.LEFT,10)},b.prototype.refresh=function(a){this.selectEvet=a,LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_remaining.skinName,ColorType.Orange853d07+String(this.selectEvet.MaxSelectNum),16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_right_txt.skinName,ColorType.Orange853d07+String(this.selectEvet.MaxSelectNum),16),this.drawHasResIcon(),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_left_txt.skinName,ColorType.Orange853d07+"1",16),this.selectNum=1,this.refreshDrawUseIcon(),this.a_tittle_frame.goToAndStop(this.selectEvet.tittleid)},b.prototype.refreshDrawUseIcon=function(){UiDraw.drawRewardIconAndtxt(this.a_use_txt,[this.selectEvet.UseResType,this.selectEvet.UnitPrice*this.selectNum],!1,TextAlign.LEFT,10),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_move_bar_txt.skinName,ColorType.Orange853d07+String(this.selectNum),16);var a=1;this.selectEvet.MaxSelectNum>1?a=(this.selectNum-1)/(this.selectEvet.MaxSelectNum-1):LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_left_txt.skinName,"0",16),this.a_bar.x=this.a_bar_bg_line.x+this.a_bar_bg_line.width*a,this.a_move_bar_tip.x=this.a_bar.x,this.a_move_bar_txt.x=this.a_bar.x+4,this.a_bar_red.uvScale=a},b.prototype.butClik=function(a){switch(console.log("---evt.target--",a.target),a.target){case this.a_bar:this.selectEvet.MaxSelectNum>1&&this.barMouseDown(a);break;case this.a_submit:if(this.selectNum*this.selectEvet.UnitPrice<=GuidData.player.getResType(this.selectEvet.UseResType))this.selectEvet.SubmitFun(this.selectNum),this.hide();else{var b=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);b.data=this.selectEvet.UseResType,ModuleEventManager.dispatchEvent(b)}break;case this.c_close:case this.a_cancal:this.hide()}},b.prototype.barMouseDown=function(a){this._lastMouseX=a.x,this._lastMcX=this.a_bar.x,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.barMouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.barMouseUp,this)},b.prototype.barMouseMove=function(a){var b=this._lastMcX+(a.x-this._lastMouseX)/UIData.Scale;b=Math.max(this.a_bar_bg_line.x,b),b=Math.min(this.a_bar_bg_line.x+this.a_bar_bg_line.width,b),this.selectNum=(b-this.a_bar_bg_line.x)/this.a_bar_bg_line.width*(this.selectEvet.MaxSelectNum-1),this.selectNum=Math.floor(this.selectNum)+1,this.refreshDrawUseIcon()},b.prototype.barMouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.barMouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.barMouseUp,this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(WindowCentenMin);a.DuiHuanPanel=b}(duihuan||(duihuan={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),duihuan;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"DuiHuanModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.DuiHuanModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_DUIHUAN_PANEL="SHOW_DUIHUAN_PANEL",b.HIDE_DUIHUAN_PANEL="HIDE_DUIHUAN_PANEL",b}(BaseEvent);a.DuiHuanEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"DuiHuanProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_DUIHUAN_PANEL&&(a.MaxSelectNum>0?this.showPanel(a):msgtip.MsgTipManager.outStr("[ff0000]今日次数已用完",99)),this.exchangepPanel&&b.type==c.HIDE_DUIHUAN_PANEL&&this.hidePanel()}if(a instanceof UIPanelEvent){var d=a;d.panel==this.exchangepPanel&&(this.exchangepPanel.dispose(),this.exchangepPanel=null,console.log("释放面板 exchangepPanel"))}},d.prototype.hidePanel=function(){this.exchangepPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.exchangepPanel||(this.exchangepPanel=new a.DuiHuanPanel),this.exchangepPanel.load(function(){UIManager.getInstance().addUIContainer(c.exchangepPanel),c.exchangepPanel.refresh(b)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_DUIHUAN_PANEL),new c(c.HIDE_DUIHUAN_PANEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.DuiHuanProcessor=d}(duihuan||(duihuan={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),donation;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b._tx1=10,b._tx2=4,b._lastMouseX=0,b._lastMcX=0,b._percentage=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b._AbgRender=new UIRenderComponent,b.addRender(b._AbgRender),b._AbottomRender=new UIRenderComponent,b.addRender(b._AbottomRender),b._AbaseRender=new UIRenderComponent,b.addRender(b._AbaseRender),b._AtopRender1=new UIRenderComponent,b.addRender(b._AtopRender1),b._AtopRender2=new UIRenderComponent,b.addRender(b._AtopRender2),b._AtopRender3=new UIRenderComponent,b.addRender(b._AtopRender3),b}return __extends(b,a),b.prototype.dispose=function(){this._AbgRender.dispose(),this._AbgRender=null,this._AbottomRender.dispose(),this._AbottomRender=null,this._AbaseRender.dispose(),this._AbaseRender=null,this._AtopRender1.dispose(),this._AtopRender1=null,this._AtopRender2.dispose(),this._AtopRender2=null,this._AtopRender3.dispose(),this._AtopRender3=null},b.prototype.applyLoad=function(){var a=this;this._AbgRender.uiAtlas=new UIAtlas,this._AbgRender.uiAtlas.setInfo("ui/uidata/faction/warehousetreasure/donation/donation.xml","ui/uidata/faction/warehousetreasure/donation/donation.png",function(){a.loadUiatalsFinsish()},"ui/uidata/faction/warehousetreasure/warehouseuse.png")},b.prototype.loadUiatalsFinsish=function(){this.init(this._AbgRender.uiAtlas),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.init=function(a){this._AbgRender.uiAtlas=a,this._AbottomRender.uiAtlas=a,this._AbaseRender.uiAtlas=a,this._AtopRender1.uiAtlas=a,this._AtopRender2.uiAtlas=a,this._AtopRender3.uiAtlas=a,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this._AtopRender1;this.addChild(this._AbottomRender.getComponent("g_bg_9")),this.addChild(this._AbaseRender.getComponent("g_bg_10")),this.b_bg9_1=this.addEvntBut("b_bg9_1",this._AbgRender),this.addUIList(["a_21_2","a_59","a_71","a_72","a8_51","a8_34"],this._AtopRender1),this.needcost=this.addChild(this._AtopRender1.getComponent("a_74")),this.mymoney=this.addChild(this._AtopRender1.getComponent("a_75")),this.minTimes=this.addChild(this._AtopRender1.getComponent("a_35_1")),this.maxTimes=this.addChild(this._AtopRender1.getComponent("a_36_1")),this.otherTimes=this.addChild(this._AtopRender1.getComponent("a_73")),this.a_26_1=this.addChild(this._AtopRender2.getComponent("a_26_1")),this.a_27_1=this.addChild(this._AtopRender1.getComponent("a_27_1")),this.a_25_1=this.addEvntBut("a_25_1",this._AtopRender3),this.a_33_1=this.addChild(this._AtopRender2.getComponent("a_33_1")),this.a_32_1=this.addChild(this._AtopRender2.getComponent("a_32_1")),this.b_btn8bg_qr=this.addEvntBut("b_btn8bg_qr",this._AbaseRender),this.b_btn8bg_qx=this.addEvntBut("b_btn8bg_qx",this._AbaseRender),this.b_close4=this.addEvntBut("b_close4",this._AbaseRender),this.f_1=this.addChild(this._AtopRender1.getComponent("f_1"))},b.prototype.initData=function(){this._tabelary=tb.Tb_faction_donation.get_Tb_faction_donation(),ArtFont.getInstance().writeFontToSkinName(this._AtopRender1.uiAtlas,this.minTimes.skinName,String(1),ArtFont.num10,TextAlign.CENTER),this.setMyMoney();tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());1==this._type?this.f_1.goToAndStop(1):this.f_1.goToAndStop(0);var a=this.getresidueTimes(this._type);this.setMaxTimes(a),this._currentYB=1,this._percentage=0,this.drawProbar(this._percentage),this.setPercentage(this._currentYB),this.setcoordinates(),this.setNeedCost(),this.resize()},b.prototype.setMyMoney=function(){var a=this.getMyMoney(),b=1==this._type?3:1;UiDraw.drawRewardIconAndtxt(this.mymoney,[b,a],!1,TextAlign.LEFT)},b.prototype.setNeedCost=function(){var a;a=1==this._type?this._currentYB*this._tabelary[0].cost[0][1]:this._currentYB*this._tabelary[1].cost[0][1],this._needCost=a;var b=1==this._type?3:1;UiDraw.drawRewardIconAndtxt(this.needcost,[b,a],!1,TextAlign.LEFT)},b.prototype.getresidueTimes=function(a){var b,c,d,e=GuidData.player.getVipLevel(),f=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());if(1==a?(c=f.golddonation,d=GuidData.faction.goldDonation):(c=f.ybdonation,d=GuidData.faction.ybDonation),GuidData.player.getIsVIP()){var g=tb.TB_vip_base.get_TB_vip_baseById(e),h=1==a?g.factiondonation:g.factionybdonation;b=c+h}else b=c;return b-d},b.prototype.setMaxTimes=function(a){ArtFont.getInstance().writeFontToSkinName(this._AtopRender1.uiAtlas,this.maxTimes.skinName,String(a),ArtFont.num10,TextAlign.CENTER),ArtFont.getInstance().writeFontToSkinName(this._AtopRender1.uiAtlas,this.otherTimes.skinName,String(a),ArtFont.num10,TextAlign.CENTER)},b.prototype.resize=function(){this.b_bg9_1.top=0,this.b_bg9_1.left=0,this.b_bg9_1.y=0,this.b_bg9_1.x=0,this.b_bg9_1.height=Scene_data.stageHeight/UIData.Scale,this.b_bg9_1.width=Scene_data.stageWidth/UIData.Scale,a.prototype.resize.call(this)},b.prototype.show=function(a){this._type=a,this.hasStage||(UIManager.getInstance().addUIContainer(this),this.initData(),console.log("添加到舞台上来"))},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.prototype.setcoordinates=function(){var a=this.a_27_1.width-this.a_25_1.width;this.a_25_1.x=this._percentage*a+this.a_27_1.x,this.a_32_1.x=this.a_25_1.x-this._tx1,this.a_33_1.x=this.a_25_1.x-this._tx2},b.prototype.A_left_bg_MouseDown=function(a){this._lastMouseX=a.x,this._lastMcX=this.a_25_1.x,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},b.prototype.A_left_bg_MouseMove=function(a){var b=this.a_27_1.x,c=this.a_27_1.x+this.a_27_1.width-this.a_25_1.width,d=this._lastMcX+(a.x-this._lastMouseX)/UIData.Scale,e=this.a_27_1.width-this.a_25_1.width;c>d&&d>b?(this.a_25_1.x=d,this.a_32_1.x=d-this._tx1,this.a_33_1.x=d-this._tx2):(this.a_25_1.x<b&&(this.a_25_1.x=b,this.a_32_1.x=b-this._tx1,this.a_33_1.x=b-this._tx2),this.a_25_1.x>c&&(this.a_25_1.x=c,this.a_32_1.x=c-this._tx1,this.a_33_1.x=c-this._tx2));var f=this.getresidueTimes(this._type);this._percentage=(this.a_25_1.x-this.a_27_1.x)/e,this.drawProbar(this._percentage),this._currentYB=Math.ceil(this._percentage*f),this.setPercentage(this._currentYB),this.setNeedCost()},b.prototype.drawProbar=function(a){var b=this._AtopRender2.uiAtlas.getRec(this.a_26_1.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1),d=this._AtopRender2.uiAtlas.getRec("progress_bar");c.drawImage(this._AtopRender2.uiAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh*a,d.pixelHeight,0,0,329*a,11),this._AtopRender2.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},b.prototype.setPercentage=function(a){ArtFont.getInstance().writeFontToSkinName(this._AtopRender2.uiAtlas,this.a_33_1.skinName,String(a),ArtFont.num3,TextAlign.CENTER)},b.prototype.butClik=function(a){switch(a.target){case this.a_25_1:this.A_left_bg_MouseDown(a);break;case this.b_close4:case this.b_btn8bg_qx:this.hide();break;case this.b_bg9_1:break;case this.b_btn8bg_qr:if(this._needCost>this.getMyMoney())return void msgtip.MsgTipManager.outStrById(22,29);NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_JUANXIAN,this._type,this._currentYB,"",""),this.hide()}},b.prototype.getMyMoney=function(){var a;return a=1==this._type?GuidData.player.getSilver():GuidData.player.getGoldIngot()},b}(UIPanel);a.DonationPanel=b}(donation||(donation={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),donation;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"DonationModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.DonationModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_DONATION_PANEL="SHOW_DONATION_PANEL",b.HIDE_DONATION_PANEL="HIDE_DONATION_PANEL",b}(BaseEvent);a.DonationEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"DonationRrocessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_DONATION_PANEL&&this.showPanel(b.data),this.donationPanel&&b.type==c.HIDE_DONATION_PANEL&&this.hidePanel()}if(a instanceof UIPanelEvent){var d=a;d.panel==this.donationPanel&&(this.donationPanel.dispose(),this.donationPanel=null,console.log("释放面板 exchangepPanel"))}},d.prototype.hidePanel=function(){this.donationPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.donationPanel||(this.donationPanel=new a.DonationPanel),this.donationPanel.load(function(){c.donationPanel.show(b)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_DONATION_PANEL),new c(c.HIDE_DONATION_PANEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.DonationRrocessor=d}(donation||(donation={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),turnonwarehouse;!function(a){var b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.hasLight=!1,b}return __extends(b,a),b.prototype.setNewData=function(a){this._listItemData.data=a,this.draw()},b.prototype.draw=function(){var a=this,b=58,c=b-4,d=this._listItemData.data,e=UIManager.getInstance().getContext2D(this.uvData.ow,this.uvData.oh,!1);UiDraw.cxtDrawImg(e,PuiData.NewPicBg,new Rectangle(0,0,62,62),UIData.publicUi),this.atlas.updateCtx(e,this.uvData.ox,this.uvData.oy),d&&IconManager.getInstance().getIcon(geteqiconIconUrl(d.entryData.icon),function(e){var f=UIManager.getInstance().getContext2D(a.uvData.ow,a.uvData.oh,!1);UiDraw.cxtDrawImg(f,PuiData.A_WUPINKUANG,new Rectangle(2,2,b,b),UIData.publicUi),f.drawImage(e,0,0,c,c,2,2,b,b),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(d.entryData.quality),new Rectangle(2,2,b,b),UIData.publicUi),a.atlas.updateCtx(f,a.uvData.ox,a.uvData.oy)})},Object.defineProperty(b.prototype,"selected",{set:function(a){this.hasLight!=a&&(this.hasLight=a,this.draw())},enumerable:!0,configurable:!0}),b}(ListItemRender);a.TurnonWarehouseListRender=b;var c=function(){function a(a){this.selectDic=new Object,this.perent=a,this._listRender=new UIListRenderComponent,this.addList()}return a.prototype.dispose=function(){this._listRender.dispose(),this._listRender=null},a.prototype.addList=function(){var a=new Vector2D(298,105);this._bgList=this._listRender.createGridList(),this._bgList.x=a.x,this._bgList.y=a.y,this.perent.addChild(this._bgList),this._bgMask=new UIMask,this._bgMask.x=a.x,this._bgMask.y=a.y,this._bgMask.width=375,this._bgMask.height=375,this.perent.addMask(this._bgMask),this._bgMask.level=3,this._listRender.mask=this._bgMask},a.prototype.refreshData=function(){for(var a=this,c=tb.TB_faction_privilege.get_TB_faction_privilege(1).handInQuality,d=GuidData.bag.getEquBgData(),e=new Array,f=0;f<d.length;f++){var g=new ListItemData;d[f]&&d[f].entryData&&d[f].entryData.quality>=c&&(g.data=d[f],g.clickFun=function(b){a.itemDataClick(b)},e.push(g))}for(;e.length<30;){var g=new ListItemData;g.data=null,g.clickFun=function(b){a.itemDataClick(b)},e.push(g)}this._bgList.contentY=0,this._bgList.setGridData(e,b,5,75,75,512,512,375,375)},a.prototype.itemDataClick=function(a){for(var b=this._bgList.data,c=0;b&&c<b.length;c++)b[c]==a?b[c].itemRender.selected=!0:b[c].itemRender.selected=!1;if(a.data){var d=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);d.data=a.data,d.buttonType=5,ModuleEventManager.dispatchEvent(d)}},a.prototype.show=function(){this.perent.addRender(this._listRender),this.refreshData()},a.prototype.hide=function(){this.perent.removeRender(this._listRender)},a}();a.TurnonWarehouseList=c}(turnonwarehouse||(turnonwarehouse={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),turnonwarehouse;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.setBlackBg(),a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this.treasurehouseUpList&&(this.treasurehouseUpList.dispose(),this.treasurehouseUpList=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/faction/warehousetreasure/warehousetreasure.xml","ui/uidata/faction/warehousetreasure/warehousetreasure.png",function(){a.loadConfigCom()},"ui/uidata/faction/warehousetreasure/warehouseuse.png")},c.prototype.loadConfigCom=function(){this.addChild(this._midRender.getComponent("f_tittle_txt")),this.treasurehouseUpList=new a.TurnonWarehouseList(this),this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.butClik=function(a){switch(a.target){case this.c_close:this.hide()}},c.prototype.show=function(){this.hasStage||(this.treasurehouseUpList.show(),UIManager.getInstance().addUIContainer(this))},c.prototype.refresh=function(){this.hasStage&&this.treasurehouseUpList.show()},c.prototype.hide=function(){this.hasStage&&(this.treasurehouseUpList.hide(),UIManager.getInstance().removeUIContainer(this))},c}(WindowCentenMin);a.TurnonWarehousePanel=b}(turnonwarehouse||(turnonwarehouse={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),turnonwarehouse;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"TurnonWarehouseModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.TurnonWarehouseModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_TURNON_WAREHOUSE_PANEL="SHOW_TURNON_WAREHOUSE_PANEL",b.HIDE_TURNON_WAREHOUSE_PANEL="HIDE_TURNON_WAREHOUSE_PANEL",b.FERISH_TURNON_WARHOUSE_DATA="FERISH_TURNON_WARHOUSE_DATA",b}(BaseEvent);a.TurnonWarehouseEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"TurnonWarehouseProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_TURNON_WAREHOUSE_PANEL&&this.showPanel(),this.turnonWarehousePanel&&(b.type==c.HIDE_TURNON_WAREHOUSE_PANEL&&this.hidePanel(),b.type==c.FERISH_TURNON_WARHOUSE_DATA)}if(a instanceof charbg.CharBgEvent&&a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT&&a.showType==BagData.TYPE_EQU_BG&&this.turnonWarehousePanel&&this.turnonWarehousePanel.refresh(),a instanceof UIPanelEvent){var d=a;d.panel==this.turnonWarehousePanel&&(this.turnonWarehousePanel.dispose(),this.turnonWarehousePanel=null,console.log("释放面板 turnonWarehousePanel"))}},d.prototype.hidePanel=function(){this.turnonWarehousePanel.hide()},d.prototype.showPanel=function(){var b=this;this.turnonWarehousePanel||(this.turnonWarehousePanel=new a.TurnonWarehousePanel),this.turnonWarehousePanel.load(function(){b.turnonWarehousePanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_TURNON_WAREHOUSE_PANEL),new c(c.HIDE_TURNON_WAREHOUSE_PANEL),new c(c.FERISH_TURNON_WARHOUSE_DATA),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT)]},d}(BaseProcessor);a.TurnonWarehouseProcessor=d}(turnonwarehouse||(turnonwarehouse={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),warehousetreasure;!function(a){var b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.hasLight=!1,b}return __extends(b,a),b.prototype.setNewData=function(a){this._listItemData.data=a,this.draw()},b.prototype.draw=function(){var a=this,b=58,c=b-4,d=this._listItemData.data,e=UIManager.getInstance().getContext2D(this.uvData.ow,this.uvData.oh,!1);UiDraw.cxtDrawImg(e,PuiData.NewPicBg,new Rectangle(0,0,62,62),UIData.publicUi),this.atlas.updateCtx(e,this.uvData.ox,this.uvData.oy),d&&IconManager.getInstance().getIcon(geteqiconIconUrl(d.entryData.icon),function(e){var f=UIManager.getInstance().getContext2D(a.uvData.ow,a.uvData.oh,!1);UiDraw.cxtDrawImg(f,PuiData.A_WUPINKUANG,new Rectangle(2,2,b,b),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(d.entryData.quality),new Rectangle(2,2,b,b),UIData.publicUi),f.drawImage(e,0,0,c,c,2,2,b,b),a.atlas.updateCtx(f,a.uvData.ox,a.uvData.oy)})},Object.defineProperty(b.prototype,"selected",{set:function(a){this.hasLight!=a&&(this.hasLight=a,this.draw())},enumerable:!0,configurable:!0}),b}(ListItemRender);a.TreasurehouseListRender=b;var c=function(){function a(a){this.perent=a,this._listRender=new UIListRenderComponent,this.addList()}return a.prototype.dispose=function(){this._listRender.dispose(),this._listRender=null},a.prototype.addList=function(){var a=new Vector2D(548,86);this._bgList=this._listRender.createGridList(),this._bgList.x=a.x,this._bgList.y=a.y,this.perent.addChild(this._bgList),this._bgMask=new UIMask,this._bgMask.x=a.x,this._bgMask.y=a.y-5,this._bgMask.width=315,this._bgMask.height=380,this.perent.addMask(this._bgMask),this._listRender.mask=this._bgMask},a.prototype.refreshData=function(){var a=this,c=GuidData.faction.getFactionStorehouse();console.log("现在有这么多个",c.length);for(var d=new Array,e=0;e<c.length;e++)if(c[e]){var f=new ListItemData;f.data=c[e],f.clickFun=function(b){a.itemDataClick(b)},d.push(f)}for(var g=faction.FactionBuildModel.getInstance().getTabvo(2);d.length<Math.max(g.params[0],30);){var f=new ListItemData;d.push(f)}this._bgList.contentY=0,this._bgList.setGridData(d,b,5,62,62,512,512,370,380)},a.prototype.itemDataClick=function(a){for(var b=this._bgList.data,c=0;b&&c<b.length;c++)b[c]==a?b[c].itemRender.selected=!0:b[c].itemRender.selected=!1;if(a.data){var d=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);d.data=a.data,d.buttonType=4,ModuleEventManager.dispatchEvent(d)}},a.prototype.show=function(){this.perent.addRender(this._listRender),this.refresh()},a.prototype.refresh=function(){this._listRender.rendering&&this.refreshData()},a.prototype.hide=function(){this.perent.removeRender(this._listRender)},a}();a.WarehouseList=c}(warehousetreasure||(warehousetreasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),warehousetreasure;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(c,b),c.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,this.treasurehouseList&&(this.treasurehouseList.dispose(),this.treasurehouseList=null);
},c.prototype.initView=function(b){this._bottomRender.uiAtlas=b,this._midRender.uiAtlas=b,this._topRender.uiAtlas=b,this.e_shangjiao_but=this.addEvntButUp("e_shangjiao_but",this._topRender),this.e_txt_bg_0=this.addChild(this._bottomRender.getComponent("e_txt_bg_0")),this.e_txt_bg_1=this.addChild(this._bottomRender.getComponent("e_txt_bg_1"));this.addChild(this._topRender.getComponent("e_gonxian_label")),this.addChild(this._topRender.getComponent("e_cangku_num_label"));this.treasurehouseList=new a.WarehouseList(this)},c.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.e_shangjiao_but:ModuleEventManager.dispatchEvent(new turnonwarehouse.TurnonWarehouseEvent(turnonwarehouse.TurnonWarehouseEvent.SHOW_TURNON_WAREHOUSE_PANEL))}},c.prototype.refreshWareBagList=function(){if(this.hasStage){this.treasurehouseList.refresh();for(var a=GuidData.faction.getFactionStorehouse(),b=faction.FactionBuildModel.getInstance().getTabvo(2),c=0,d=0;d<a.length;d++)a[d]&&c++;UIuitl.getInstance().drawCostUI(this._topRender.uiAtlas,this.e_txt_bg_0.skinName,[String(-1),c+"/"+b.params[0]],ColorType.Orange853d07,100,20),UIuitl.getInstance().drawCostUI(this._topRender.uiAtlas,this.e_txt_bg_1.skinName,[6,GuidData.player.getResTypeStr(6)],ColorType.Orange853d07,83,20)}},c.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),this.treasurehouseList.show(),this.refreshWareBagList())},c.prototype.hide=function(){this.treasurehouseList.hide(),UIManager.getInstance().removeUIContainer(this),ModuleEventManager.dispatchEvent(new turnonwarehouse.TurnonWarehouseEvent(turnonwarehouse.TurnonWarehouseEvent.HIDE_TURNON_WAREHOUSE_PANEL))},c.prototype.getListItem=function(){for(var a=GuidData.faction.getFactionStorehouseLog(),b=new Array,c=a.length-1;c>=0;c--){var d=new SListItemData;d.data=this.getListStr(a[c]),d.id=b.length,b.push(d)}return b},c.prototype.getListStr=function(a){var b=a.split("|"),c=a;switch(Number(b[0])){case 0:c=getBaseName(b[1])+"将"+this.getEquName(b[2])+"放入仓库";break;case 1:c=getBaseName(b[1])+"将"+this.getEquName(b[2])+"从仓库取出";break;case 2:c="系统奖励"+this.getEquName(b[1]);break;case 3:c=getBaseName(b[1])+"将"+this.getEquName(b[2])+"销毁 获得家族资金"+ColorType.Green56da35+b[3];break;default:c=a}return ColorType.Orange853d07+c},c.prototype.getEquName=function(a){var b=tb.TB_item_template.get_TB_item_template(Number(a)),c="["+tb.TB_item_quality_color.getTempVo(b.quality).color+"]";return c+" "+b.name+" "+ColorType.Orange853d07},c}(UIVirtualContainer);a.WarehousePanel=b}(warehousetreasure||(warehousetreasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),warehousetreasure;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,this._midRender.dispose(),this._midRender=null},b.prototype.initUiAtlas=function(a){this._bottomRender.uiAtlas=a,this._midRender.uiAtlas=a,this._topRender.uiAtlas=a;var b=this._topRender;this.initView(b)},b.prototype.initView=function(a){this._topRender;this.addRoundBg(),this.a_add_label_num_0=this.addChild(this._midRender.getComponent("a_add_label_num_0")),this.a_add_label_num_1=this.addChild(this._midRender.getComponent("a_add_label_num_1"));var b=tb.Tb_faction_donation.get_Tb_faction_donation();LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_add_label_num_0.skinName,ColorType.color9a683f+"增加贡献"+b[0].devote[1],14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_add_label_num_1.skinName,ColorType.color9a683f+"增加贡献"+b[1].devote[1],14,TextAlign.CENTER),this.a_duihuanIcon=this.addChild(this._topRender.getComponent("a_duihuanIcon")),this.b_yinbijx=this.addEvntButUp("b_yinbi",this._midRender),this.b_yinbijx.data=1,this.b_yuanbaojx=this.addEvntButUp("b_yuanbao",this._midRender),this.b_yuanbaojx.data=2,this.addChild(this._midRender.getComponent("a_shenyu_label_txt0")),this.addChild(this._midRender.getComponent("a_shenyu_label_txt1"));var c=this.addChild(this._midRender.getComponent("a_shenyu_label_txt2"));LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,c.skinName,ColorType.Orange853d07+"剩余次数:",14,TextAlign.CENTER),this.a_duihuan_txt=this.addChild(this._midRender.getComponent("a_duihuan_txt")),this.a_yuanbao_need_num=this.addChild(this._midRender.getComponent("a_yuanbao_need_num")),this.a_yinbi_need_num=this.addChild(this._midRender.getComponent("a_yinbi_need_num")),this.a_yinbi_can_num=this.addChild(this._midRender.getComponent("a_yinbi_can_num")),this.a_yuanbao_can_num=this.addChild(this._midRender.getComponent("a_yuanbao_can_num")),this.a_duanhuan_need_num=this.addChild(this._midRender.getComponent("a_duanhuan_need_num")),this.a_duanhuan_has_num=this.addChild(this._midRender.getComponent("a_duanhuan_has_num")),this.addChild(this._midRender.getComponent("a_txt2")),this.addChild(this._midRender.getComponent("a_txt3")),this.a_duanhuan_but=this.addEvntButUp("a_duanhuan_but",this._topRender)},b.prototype.addRoundBg=function(){var a=this.addChild(this._bottomRender.getComponent("a_duihuan_round_bg0")),b=this.addChild(this._bottomRender.getComponent("a_duihuan_round_bg1")),c=this.addChild(this._bottomRender.getComponent("a_duihuan_round_bg2"));this.addChild(this._bottomRender.getComponent("a_duihuan_round_bg3"));a.isU=!0,a.isV=!0,b.isV=!0,c.isU=!0,this._bottomRender.applyObjData()},b.prototype.refreshFactionMoney=function(){var a=tb.Tb_faction_donation.get_Tb_faction_donation();UIuitl.getInstance().drawCostUI(this._topRender.uiAtlas,this.a_yinbi_need_num.skinName,a[0].cost[0],ColorType.Orange853d07,118,20),UIuitl.getInstance().drawCostUI(this._topRender.uiAtlas,this.a_yuanbao_need_num.skinName,a[1].cost[0],ColorType.Orange853d07,118,20)},b.prototype.setdonationByYinBiTimes=function(){var a=GuidData.player.getVipLevel(),b=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());if(GuidData.player.getIsVIP()){var c=tb.TB_vip_base.get_TB_vip_baseById(a);this._totalYinBi=b.golddonation+c.factiondonation}else this._totalYinBi=b.golddonation;this._residueTimesYinBi=this._totalYinBi-GuidData.faction.goldDonation,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_yinbi_can_num.skinName,ColorType.Green2ca937+this._residueTimesYinBi+"/"+this._totalYinBi,14,TextAlign.CENTER)},b.prototype.setdonationByYuanBaoTimes=function(){var a=GuidData.player.getVipLevel(),b=tb.Tb_faction_base.get_Tb_faction_baseById(GuidData.faction.getLev());if(GuidData.player.getIsVIP()){var c=tb.TB_vip_base.get_TB_vip_baseById(a);this._totalYuanBao=b.ybdonation+c.factionybdonation}else this._totalYuanBao=b.ybdonation;this._residueTimesYuanBao=this._totalYuanBao-GuidData.faction.ybDonation,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_yuanbao_can_num.skinName,ColorType.Green2ca937+this._residueTimesYuanBao+"/"+this._totalYuanBao,14,TextAlign.CENTER)},b.prototype.refrishDuiHuanTxt=function(){var a=faction.FactionBuildModel.getInstance().getTabvo(2);console.log(a);var b=GuidData.player.getPlayerIntFiledFactionDonateGiftExchangeDailyCount();LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_duihuan_txt.skinName,ColorType.Green2ca937+b+"/"+a.params[0],16);var c=GuidData.player.getResType(6)>=a.params[3]?ColorType.Orange853d07:ColorType.colorce0a00;UIuitl.getInstance().drawCostUI(this._topRender.uiAtlas,this.a_duanhuan_need_num.skinName,[String(6),String(a.params[3])],c,118,20),UIuitl.getInstance().drawCostUI(this._topRender.uiAtlas,this.a_duanhuan_has_num.skinName,[String(6),String(GuidData.player.getResType(6))],ColorType.Brown7a2f21,118,20),IconManager.getInstance().drawItemIcon60(this.a_duihuanIcon,a.params[2])},b.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),this.refreshFactionMoney(),this.setdonationByYinBiTimes(),this.setdonationByYuanBaoTimes(),this.refrishDuiHuanTxt())},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.b_yinbijx:case this.b_yuanbaojx:var b;if(1==a.target.data)return b=this._residueTimesYinBi,void this.showDuihuanYinbiPanel();if(b=this._residueTimesYuanBao,this.showDuihuanYanBaoPanel(),1>b)return void msgtip.MsgTipManager.outStrById(22,19);var c=new donation.DonationEvent(donation.DonationEvent.SHOW_DONATION_PANEL);c.data=a.target.data,ModuleEventManager.dispatchEvent(c);break;case this.a_duanhuan_but:this.showDuihuanPanel()}},b.prototype.showDuihuanYinbiPanel=function(){var a=tb.Tb_faction_donation.get_Tb_faction_donationById(1),b=new duihuan.DuiHuanEvent(duihuan.DuiHuanEvent.SHOW_DUIHUAN_PANEL);b.UseResType=a.cost[0][0],b.tittleid=1,b.MaxSelectNum=this._residueTimesYinBi,b.UnitPrice=a.cost[0][1],b.SubmitFun=function(a){NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_JUANXIAN,1,a,"","")},ModuleEventManager.dispatchEvent(b)},b.prototype.showDuihuanYanBaoPanel=function(){var a=tb.Tb_faction_donation.get_Tb_faction_donationById(2),b=new duihuan.DuiHuanEvent(duihuan.DuiHuanEvent.SHOW_DUIHUAN_PANEL);b.UseResType=a.cost[0][0],b.tittleid=0,b.MaxSelectNum=this._residueTimesYuanBao,b.UnitPrice=a.cost[0][1],b.SubmitFun=function(a){NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_JUANXIAN,2,a,"","")},ModuleEventManager.dispatchEvent(b)},b.prototype.showDuihuanPanel=function(){var a=faction.FactionBuildModel.getInstance().getTabvo(2),b=GuidData.player.getPlayerIntFiledFactionDonateGiftExchangeDailyCount();if(GuidData.player.getResType(6)>=a.params[3])if(a.params[0]-b>0){var c=new duihuan.DuiHuanEvent(duihuan.DuiHuanEvent.SHOW_DUIHUAN_PANEL);c.UseResType=6,c.tittleid=2,c.MaxSelectNum=a.params[0]-b,c.UnitPrice=a.params[3],c.SubmitFun=function(a){NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_DONATE_GIFT_EXCHANGE,a,0,"","")},ModuleEventManager.dispatchEvent(c)}else msgtip.MsgTipManager.outStr("[ff0000]今日已全部兑换",99);else{var d=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);d.data=6,ModuleEventManager.dispatchEvent(d)}},b.prototype.getListItem=function(){var a=this.getDataEventList(),b=this.getData(a);return b},b.prototype.getDataEventList=function(){for(var a=GuidData.faction.getEventList(),b=GuidData.faction.getEventFlag(),c=new Array,d=b;d<a.length;d++)c.push(a[d]);for(var d=0;b>d;d++)c.push(a[d]);return c},b.prototype.getData=function(a){for(var b=new Array,c=a.length-1;c>=0;c--){var d=new SListItemData;d.data=this.getToStr(a[c]),d.id=b.length,b.push(d)}return b},b.prototype.getToStr=function(a){var b=2==a.type?"元宝":"银币",c=tb.Tb_faction_donation.get_Tb_faction_donationById(a.type),d=c.money*a.value,e="[]"+getBaseName(a.name)+"使用"+ColorType.Green56da35+b+"[]捐献了"+ColorType.Green56da35+a.value+"[]次,家族资金增加了"+ColorType.Green56da35+d;return e},b}(UIVirtualContainer);a.TreasurePanel=b}(warehousetreasure||(warehousetreasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),logall;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.F_log_txt=this.creatSUI(d,this.parentTarget.baseAtlas,"F_log_txt",50,5,480,18),b.addChild(this.F_log_txt),this.F_log_bg=this.creatSUI(c,this.parentTarget.baseAtlas,"F_log_bg",0,0,470,38),b.addChild(this.F_log_bg)},b.prototype.render=function(a){if(this.itdata=a,a&&a.data){var b=a.data;a.id%2||UiDraw.uiAtlasDrawImg(this._baseRender.uiAtlas,this.F_log_bg.skinName,UIData.publicUi,PuiData.BG2),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.F_log_txt.skinName,b,16,TextAlign.LEFT,ColorType.Orange853d07)}else this.setnull()},b.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.F_log_txt.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.F_log_bg.skinName)},b}(SListItem);a.WarehouseTreasureLogListRender=b;var c=function(a){function c(){var b=a.call(this)||this;return b.left=45,b.top=120,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(c,a),c.prototype.init=function(a){this._bottomRender.uiAtlas=a,this._topRender.uiAtlas=a,this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,b,488,440,0,38,11,512,256,1,11)},c.prototype.refreshDataByNewData=function(){for(var a=new Array,b=0;10>b;b++){var c=new SListItemData;c.data="就是这条几率嘎嘎大吃大喝",c.id=b,a.push(c)}this.refreshData(a)},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.WarehouseTreasureLogList=c}(logall||(logall={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),warehousetreasure;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.showType=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,this.warehousePanel&&(this.warehousePanel.dispose(),this.warehousePanel=null),this.treasurePanel&&(this.treasurePanel.dispose(),this.treasurePanel=null),this.warehouseTreasureLogList&&(this.warehouseTreasureLogList.dispose(),this.warehouseTreasureLogList=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/faction/warehousetreasure/warehousetreasure.xml","ui/uidata/faction/warehousetreasure/warehousetreasure.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.winmidRender.uiAtlas=WindowUi.winUIAtlas;var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(b,"c_tab_bg",this._topRender);var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(c,"b_right_bg_top",this._topRender);var d=this.addChild(this.winmidRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(d,"b_right_bg_bottom",this._topRender),this.winmidRender.applyObjData(),this.treasurePanel=new a.TreasurePanel,this.treasurePanel.initUiAtlas(this._topRender.uiAtlas),this.warehousePanel=new a.WarehousePanel,this.warehousePanel.initView(this._topRender.uiAtlas),this.addChild(this._midRender.getComponent("c_win_tittle")),this.c_log_tittle_line=this.addChild(this._midRender.getComponent("c_log_tittle_line")),this.addChild(this._bottomRender.getComponent("a_titlebg")),this.c_log_tittle_name=this.addChild(this._midRender.getComponent("c_log_tittle_name")),this.c_tab_0=this.addEvntBut("c_tab_0",this._midRender),this.c_tab_1=this.addEvntBut("c_tab_1",this._midRender);this.addChild(this._topRender.getComponent("a_bjzs_line_1"));this.warehouseTreasureLogList=new logall.WarehouseTreasureLogList,this.warehouseTreasureLogList.init(this._topRender.uiAtlas),this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.refreshWareBagList=function(){this.uiAtlasComplet&&this.warehousePanel.refreshWareBagList()},c.prototype.refreshLog=function(){if(this.uiAtlasComplet){var a;a=0==this.showType?this.treasurePanel.getListItem():this.warehousePanel.getListItem(),this.warehouseTreasureLogList.refreshData(a);var b=ColorType.Orange853d07+(1==this.showType?"仓库记录":"捐献记录");LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.c_log_tittle_name.skinName,b,16,TextAlign.CENTER)}},c.prototype.resize=function(){b.prototype.resize.call(this),this.warehouseTreasureLogList.left=this.c_log_tittle_line.parent.x/UIData.Scale+this.c_log_tittle_line.x-5,this.warehouseTreasureLogList.top=this.c_log_tittle_line.parent.y/UIData.Scale+this.c_log_tittle_line.y+15},c.prototype.refresh=function(){this.warehouseTreasureLogList.show(),0==this.showType?(this.c_tab_0.selected=!0,this.c_tab_1.selected=!1,this.treasurePanel.show(),this.warehousePanel.hide()):(this.c_tab_0.selected=!1,this.c_tab_1.selected=!0,this.treasurePanel.hide(),this.warehousePanel.show()),this.refreshLog()},c.prototype.butClik=function(b){switch(b.target){case this.c_tab_0:ModuleEventManager.dispatchEvent(new turnonwarehouse.TurnonWarehouseEvent(turnonwarehouse.TurnonWarehouseEvent.HIDE_TURNON_WAREHOUSE_PANEL)),this.showType=0,this.refresh();break;case this.c_tab_1:this.showType=1,this.refresh();break;case this.w_close:ModuleEventManager.dispatchEvent(new a.WarehouseEvent(a.WarehouseEvent.HIDE_WAREHOUSE_PANEL))}},c.prototype.hide=function(){this.treasurePanel.hide(),this.warehousePanel.hide(),this.warehouseTreasureLogList.hide(),UIManager.getInstance().removeUIContainer(this),b.prototype.hide.call(this)},c}(WindowUi);a.WarehouseTreasurePanel=b}(warehousetreasure||(warehousetreasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),warehousetreasure;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"WarehouseTreasureModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.WarehouseTreasureModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_WAREHOUSE_PANEL="SHOW_WAREHOUSE_PANEL",b.HIDE_WAREHOUSE_PANEL="HIDE_WAREHOUSE_PANEL",b.WAREHOUSE_LOG_REFRESH="WAREHOUSE_LOG_REFRESH",b.WAREHOUSE_BAG_REFRESH="WAREHOUSE_BAG_REFRESH",b.TREASURE_LOG_REFRESH="TREASURE_LOG_REFRESH",b.TREASURE_NUM_REFRESH="TREASURE_NUM_REFRESH",b}(BaseEvent);a.WarehouseEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"WarehouseTreasureProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_WAREHOUSE_PANEL&&this.showPanel(),this.warehousePanel&&(b.type==c.HIDE_WAREHOUSE_PANEL&&this.hidePanel(),b.type==c.WAREHOUSE_BAG_REFRESH&&this.warehousePanel.refreshWareBagList(),b.type==c.WAREHOUSE_LOG_REFRESH&&this.warehousePanel.refreshLog(),b.type==c.TREASURE_LOG_REFRESH&&this.warehousePanel.refreshLog(),b.type==c.TREASURE_NUM_REFRESH&&(this.warehousePanel.treasurePanel.refrishDuiHuanTxt(),this.warehousePanel.treasurePanel.setdonationByYuanBaoTimes(),this.warehousePanel.treasurePanel.setdonationByYinBiTimes()))}if(a instanceof EngineEvent&&a.type==EngineEvent.MONEY_CHANGE&&(this.warehousePanel&&this.warehousePanel.treasurePanel&&this.warehousePanel.treasurePanel.hasStage&&this.warehousePanel.treasurePanel.refrishDuiHuanTxt(),this.warehousePanel&&this.warehousePanel&&this.warehousePanel.hasStage&&this.warehousePanel.refreshWareBagList()),a instanceof UIPanelEvent){var d=a;d.panel==this.warehousePanel&&(this.warehousePanel.dispose(),this.warehousePanel=null,console.log("释放面板 warehousePanel"))}},d.prototype.hidePanel=function(){this.warehousePanel.hide()},d.prototype.showPanel=function(){var b=this;GuidData.faction?(this.warehousePanel||(this.warehousePanel=new a.WarehouseTreasurePanel),this.warehousePanel.load(function(){UIManager.getInstance().addUIContainer(b.warehousePanel),ModulePageManager.showResTittle([1,2,3]),b.warehousePanel.refresh()},!1)):ModulePageManager.openPanel(SharedDef.MODULE_FACTION)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_WAREHOUSE_PANEL),new c(c.HIDE_WAREHOUSE_PANEL),new c(c.WAREHOUSE_BAG_REFRESH),new c(c.WAREHOUSE_LOG_REFRESH),new c(c.TREASURE_LOG_REFRESH),new c(c.TREASURE_NUM_REFRESH),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE)]},d}(BaseProcessor);a.WarehouseTreasureProcessor=d}(warehousetreasure||(warehousetreasure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),faction;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.setBlackBg(),a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._topRender.uiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.dispose=function(){this._topRender.dispose(),this._topRender=null,this.invitationList&&(this.invitationList.dispose(),this.invitationList=null),b.prototype.dispose.call(this)},d.prototype.applyLoad=function(){var a=this;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this._topRender.uiAtlas.setInfo("ui/uidata/faction/invitation/fac_invitation.xml","ui/uidata/faction/invitation/fac_invitation.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionpc.png")},d.prototype.loadConfigCom=function(){var a=this._topRender;this.addUIList(["a_title","a_line","a_btntxt"],a),this.slistIndex=this.addChild(a.getComponent("slistIndex")),this.btn=this.addEvntBut("cnew_btn1",this._publicbgRender),this.setSizeForPanelUiCopy(this.btn,"btn",a),this._publicbgRender.applyObjData(),this.applyLoadComplete()},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.invitationList||(this.invitationList=new c,this.invitationList.init(this._topRender.uiAtlas)),this.invitationList.show(),this.resize()},d.prototype.close=function(){ModuleEventManager.dispatchEvent(new bottomui.BottomUiEvent(bottomui.BottomUiEvent.BOTTOM_REFRESH_INFO_ICON)),UIManager.getInstance().removeUIContainer(this),this.invitationList&&this.invitationList.hide()},d.prototype.butClik=function(b){switch(b.target){case this.e_close:this.close();break;case this.btn:a.FactionModel.getInstance().chgInvitationList_clear(),ModuleEventManager.dispatchEvent(new a.FactionEvent(a.FactionEvent.INVITATION_CHG_EVENT))}},d.prototype.resize=function(){b.prototype.resize.call(this),this.invitationList&&(this.invitationList.left=this.slistIndex.parent.x/UIData.Scale+this.slistIndex.x,this.invitationList.top=this.slistIndex.parent.y/UIData.Scale+this.slistIndex.y)},d}(WindowMinUi);a.InvitationPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=184,a.top=99,a.setShowLevel(6),a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,593,308,0,84,3,512,512,1,6)},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.resetData=function(){var b=this.getData(a.FactionModel.getInstance().getInvitationList());this.refreshData(b)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(SList);a.InvitationList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Aslist_bg=this.creatSUI(c,this.parentTarget.baseAtlas,"Aslist_bg",0,0,593,84),a.addChild(this.Aslist_bg),this.Aslist_info=this.creatSUI(d,this.parentTarget.baseAtlas,"Aslist_info",33,32,438,20),a.addChild(this.Aslist_info),this.Aslist_btn=this.creatSUI(d,this.parentTarget.baseAtlas,"Aslist_btn",498,19,71,45),a.addChild(this.Aslist_btn),this.Aslist_btn.addEventListener(InteractiveEvent.Up,this.HelpEvt,this)},c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Aslist_bg.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG);var a=this.itdata.data;LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.Aslist_info.skinName,ColorType.Brown7a2f21+getBaseName(a.name)+ColorType.color9a683f+"邀请你加入"+ColorType.Brown7a2f21+getBaseName(a.faction_name)+ColorType.color9a683f+",共同闯荡江湖。",16,TextAlign.LEFT,ColorType.Brown7a2f21),UiDraw.SharedDrawImg(this._baseRender.uiAtlas,this.parentTarget.baseAtlas,this.Aslist_btn.skinName,"Agree")}},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.HelpEvt=function(b){var c=this.itdata.data;NetManager.getInstance().protocolos.faction_join(c.faction_guid),a.FactionModel.getInstance().chgInvitationList_remove(c),ModuleEventManager.dispatchEvent(new a.FactionEvent(a.FactionEvent.INVITATION_CHG_EVENT))},c.prototype.setnull=function(){UiDraw.clearUI(this.Aslist_btn),UiDraw.clearUI(this.Aslist_info),UiDraw.clearUI(this.Aslist_bg)},c}(SListItem);a.InvitationListRender=d}(faction||(faction={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ranking;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._bgRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas.setInfo("ui/uidata/window/windowrank.xml","ui/uidata/window/windowrank.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._midRender.uiAtlas=this._bgRender.uiAtlas,this._baseRender.uiAtlas=this._bgRender.uiAtlas,this.addUIList(["b_title","b_line2","b_line1","b_line","b_bg2","b_bg1"],this._bgRender),this.addUIList(["b_info","b_rank3","b_rank2","b_rank1","b_titlebg1","b_titlebg2","b_titlebg3","b_1","b_2"],this._baseRender),this._rewardAry=new Array;for(var a=0;3>a;a++)this._rewardAry.push(this.addChild(this._midRender.getComponent("b_reward"+a)));this.resize(),this.applyLoadComplete()},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.butClik=function(a){switch(a.target){case this.c_close:UIManager.getInstance().removeUIContainer(this)}},b.prototype.show=function(a){UIManager.getInstance().addUIContainer(this);for(var b=0;3>b;b++){var c=tb.Tb_rank_reward.getTempByID(a,b+1);this._midRender.uiAtlas.upDataPicToTexture(getUItittleUrl(String(c.title)),this._rewardAry[b].skinName)}},b}(WindowCentenMin);a.RankReward=b}(ranking||(ranking={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ranking;!function(a){var b=function(){function a(){}return a}();a.ApplyFactionListVo=b;var c=function(){function a(){}return a.RANK_TYPE_POWER=0,a.RANK_TYPE_LEVEL=1,a.RANK_TYPE_FACTION=2,a.RANK_TYPE_WINGS=3,a.RANK_TYPE_MOUNT=4,a.RANK_TYPE_SINGLE_PVP=5,a}();a.RankingType=c;var d=function(c){function d(){var a=c.call(this)||this;return a.KeyShareDefType=[SharedDef.RANK_TYPE_POWER,SharedDef.RANK_TYPE_LEVEL,SharedDef.RANK_TYPE_FACTION,SharedDef.RANK_TYPE_WINGS,SharedDef.RANK_TYPE_MOUNT,SharedDef.RANK_TYPE_SINGLE_PVP],a.left=221,a.top=131,a}return __extends(d,c),d.prototype.init=function(a){this.baseAtlas=a,this.contextNum=10,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,e,427,293,0,51,5,256,512,1,8)},d.prototype.refreshDataByNewData=function(a){},d.prototype.sendrequest=function(a){this._type=a,this.sendPageByNum(1,a)},d.prototype.toSeversUrl=function(){var a=(this.pageId-1)*this.contextNum+1,b=this.pageId*this.contextNum;console.log("==页数==",this.pageId,"==类型==",this.typeId,"==开始==",a,"==结束==",b),NetManager.getInstance().protocolos.rank_list_query(SharedDef.RANK_TYPE_POWER,this.KeyShareDefType[this.typeId],a,b)},d.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this)},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d.prototype.meshSeverData=function(b){for(var c=b.readUint32(),d=b.readInt(),e=b.readUint32(),f=new Array,g=b.readShort(),h=0;g>h;h++){for(var i=new RankData,j=b.readShort(),k=0;j>k;k++){var l=b.readUint32();i.SetUInt32(k,l)}for(var m=b.readShort(),n=0;m>n;n++){var o=b.readUTF();i.SetStr(n,o)}f.push(i)}var p=new a.RankQueryData;p.type=c,p.rank=d,p.list=f,p.allNum=e;var q=this.rankQueryPaser(p.list,p.type);this.getData(q);var r=new a.RankingEvent(a.RankingEvent.RANKING_OWN_EVENT);r.data=p,ModuleEventManager.dispatchEvent(r)},d.prototype.rankQueryPaser=function(a,b){for(var c=new Array,d=0;d<a.length;d++){var e=a[d],f=this.getRankQueryData(e,b);f&&c.push(f)}return console.log("---data--",c),c},d.prototype.getRankQueryData=function(b,c){var d=b.getRankGuid(),e=b.getRankName();if(!e||""==e)return null;var f=new a.RankItemData;return f.guid=d,f.rank=b.getRank(),f.name=e,f.faction=b.getRankFaction(),f.title=b.getTitle(),f.power=b.getRankPower(),f.coat=b.getRankCoat(),f.weapon=b.getRankWeapon(),f.vip=b.getRankVip(),f.gender=b.getRankGender(),f.level=b.getLevel(),f.money=b.getMoney(),f.divineNum=b.getDivineNum(),f.factionActive=b.getFactionActive(),f.factionIcon=b.getFactionIcon(),f.mountLev=b.getMountLev(),f.mountStart=b.getMountStart(),f.like=b.getLike(),f.wingid=b.getWingId(),f},d.prototype.getData=function(a){for(var c=(new Array,0);c<a.length;c++){var d=new b;d.data=a[c],d.type=this._type,d.typeShareDef=this.KeyShareDefType[this._type];var e=new SListItemData;e.data=d,e.id=(this.pageId-1)*this.contextNum+c,this.pushDataToList(e)}},d.prototype.getHanderMap=function(){
var a=this,b=new Object;return b[Protocols.SMSG_RANK_LIST_QUERY_RESULT]=function(b){a.getSeverFunData(b)},b},d.prototype.dispose=function(){c.prototype.dispose.call(this),NetManager.getInstance().unReg(Protocols.SMSG_RANK_LIST_QUERY_RESULT)},d}(DataSlist);a.CurrentServerRankingList=d;var e=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a._num=1,a}return __extends(d,b),d.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.RankId=this.creatSUI(d,this.parentTarget.baseAtlas,"RankId",30,8,29,32),a.addChild(this.RankId),this.Name1=this.creatSUI(d,this.parentTarget.baseAtlas,"Name1",84,14,138,20),a.addChild(this.Name1),this.Name2=this.creatSUI(d,this.parentTarget.baseAtlas,"Name2",232,14,98,20),a.addChild(this.Name2),this.Name3=this.creatSUI(d,this.parentTarget.baseAtlas,"Name3",342,14,82,20),a.addChild(this.Name3),this.RankBg=this.creatSUI(c,this.parentTarget.baseAtlas,"RankBg",0,0,427,51),a.addChild(this.RankBg),this.RankSelect=this.creatGrid9SUI(d,this.parentTarget.baseAtlas,"RankSelect",0,0,427,51,8,8),a.addChild(this.RankSelect)},Object.defineProperty(d.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.applyrender()},enumerable:!0,configurable:!0}),d.prototype.applyrender=function(){var a=this.itdata.data;switch(this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.RankBg.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG),a.data.rank<4?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.RankId.skinName,String(a.data.rank)):LabelTextFont.writeSingleLabel(this.uiAtlas,this.RankId.skinName,String(a.data.rank),16,TextAlign.CENTER,ColorType.Brown7a2f21,"",7),a.type){case c.RANK_TYPE_POWER:this.drawPowerRank(a);break;case c.RANK_TYPE_LEVEL:this.drawLevRank(a);break;case c.RANK_TYPE_FACTION:this.drawFactionRank(a);break;case c.RANK_TYPE_WINGS:this.drawWingsRank(a);break;case c.RANK_TYPE_MOUNT:this.drawMountRank(a);break;case c.RANK_TYPE_SINGLE_PVP:this.drawPWSRank(a)}this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.RankSelect.skinName,UIData.publicUi,PuiData.A_HIGHT_F):LabelTextFont.writeSingleLabel(this.uiAtlas,this.RankSelect.skinName,"",16,TextAlign.LEFT,"#d5e7ff")},d.prototype.drawPowerRank=function(a){this.drawNameAndVip(this.Name1,a,1),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name2.skinName,getProfessional(a.data.gender),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name3.skinName,Snum(a.data.power),16,TextAlign.CENTER,ColorType.Brown7a2f21)},d.prototype.drawLevRank=function(a){this.drawNameAndVip(this.Name1,a,1),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name2.skinName,getProfessional(a.data.gender),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name3.skinName,String(a.data.level),16,TextAlign.CENTER,ColorType.Brown7a2f21)},d.prototype.drawPWSRank=function(a){this.drawNameAndVip(this.Name1,a,1),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name2.skinName,getProfessional(a.data.gender),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name3.skinName,Snum(a.data.level),16,TextAlign.CENTER,ColorType.Brown7a2f21)},d.prototype.drawWingsRank=function(a){this.drawNameAndVip(this.Name1,a,1);var b=TableData.getInstance().getData(TableData.tb_wings_bless,a.data.level),c=TableData.getInstance().getData(TableData.tb_wings_base,b.rank);LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name2.skinName,String(c.name),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name3.skinName,getChiNum(c.id)+"阶",16,TextAlign.CENTER,ColorType.Brown7a2f21)},d.prototype.drawMountRank=function(a){this.drawNameAndVip(this.Name1,a,1);var b=a.data.mountLev,c=tb.TB_mount_base_vo.get_TB_mount_base_vo(b);LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name2.skinName,c.name,16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name3.skinName,getChiNum(b)+"阶"+a.data.mountStart+"星",16,TextAlign.CENTER,ColorType.Brown7a2f21)},d.prototype.drawFactionRank=function(a){LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name1.skinName,a.data.faction?getBaseName(a.data.faction):"暂无帮派",16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name2.skinName,String(a.data.level),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name3.skinName,Snum(a.data.power),16,TextAlign.CENTER,ColorType.Brown7a2f21)},d.prototype.render=function(a){this.itdata=a,a&&a.data?(this.RankBg.addEventListener(InteractiveEvent.Up,this.equClick,this),0==a.id?this.equClick():this.applyrender()):(this.RankBg.removeEventListener(InteractiveEvent.Up,this.equClick,this),this.setnull())},d.prototype.equClick=function(){this.selected?this.applyrender():this.setSelect();var b=new a.RankingEvent(a.RankingEvent.REFRESH_RANKING_RIGHTPANEL_EVENT);b.data=this.itdata,ModuleEventManager.dispatchEvent(b)},d.prototype.drawNameAndVip=function(a,b,c){IconManager.getInstance().getIcon(getVipIconUrl(b.data.vip),function(c){var d=a.uiRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);LabelTextFont.writeSingleLabelToCtxSetAnchor(e,ColorType.Brown7a2f21+getBaseName(b.data.name),16,57,0),e.drawImage(c,0,0,29,14,108,4,29,14),a.uiRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},d.prototype.setnull=function(){UiDraw.clearUI(this.RankId),UiDraw.clearUI(this.Name1),UiDraw.clearUI(this.Name2),UiDraw.clearUI(this.Name3),UiDraw.clearUI(this.RankBg),UiDraw.clearUI(this.RankSelect)},d.prototype.butClik=function(a){switch(a.target){}},d}(SListItem);a.CurrentRankingRender=e}(ranking||(ranking={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ranking;!function(a){var b=function(){function a(){}return a}();a.Avo=b;var c=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._winmidelRender=new UIRenderComponent,a.addRender(a._winmidelRender),a._roleRender=new UIRenderComponent,a.addRender(a._roleRender),a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,this._roleRender.dispose(),this._roleRender=null,this.currentRankingCenterPanel&&(this.currentRankingCenterPanel.dispose(),this.currentRankingCenterPanel=null),this.currentRankingrightPanel&&(this.currentRankingrightPanel.dispose(),this.currentRankingrightPanel=null)},c.prototype.initUiAtlas=function(a,b,c){this._winmidelRender=c,this._roleRender.uiAtlas=a,this._bottomRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this._publicRender.uiAtlas=b;var d=this._topRender;this.initView(d)},c.prototype.initView=function(b){var b=this._baseRender;this.currentRankingCenterPanel=new d,this.currentRankingCenterPanel.setRender(this._bottomRender,this._baseRender,this._topRender),this.addVirtualContainer(this.currentRankingCenterPanel),this.currentRankingrightPanel=new e,this.currentRankingrightPanel.setRender(this._publicRender,this._roleRender,this._baseRender,this._topRender),this.currentRankingrightPanel.parent=this,this.addVirtualContainer(this.currentRankingrightPanel);var c=this.addChild(this._winmidelRender.getComponent("cnew_coffeeBg"));this.setSizeForPanelUiCopy(c,"coffeeBg",b);var f=this.addChild(this._winmidelRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(f,"b_right_bg_top",this._baseRender);var g=this.addChild(this._winmidelRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(g,"b_right_bg_bottom",this._baseRender),this._winmidelRender.applyObjData(),this._tab_zhanli=this.addEvntBut("tab_zhanli",b),this._tab_zhanli.data=a.RankingType.RANK_TYPE_POWER,this._tab_lev=this.addEvntBut("tab_lev",b),this._tab_lev.data=a.RankingType.RANK_TYPE_LEVEL,this._tab_faction=this.addEvntBut("tab_faction",b),this._tab_faction.data=a.RankingType.RANK_TYPE_FACTION,this._tab_wing=this.addEvntBut("tab_wing",b),this._tab_wing.data=a.RankingType.RANK_TYPE_WINGS,this._tab_zuoqi=this.addEvntBut("tab_zuoqi",b),this._tab_zuoqi.data=a.RankingType.RANK_TYPE_MOUNT,this._tab_pws=this.addEvntBut("tab_pws",b),this._tab_pws.data=a.RankingType.RANK_TYPE_SINGLE_PVP,this._selectButtonAry=new Array,this._selectButtonAry.push(this._tab_zhanli),this._selectButtonAry.push(this._tab_lev),this._selectButtonAry.push(this._tab_faction),this._selectButtonAry.push(this._tab_wing),this._selectButtonAry.push(this._tab_zuoqi),this._selectButtonAry.push(this._tab_pws),this.resize()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(a){void 0===a&&(a=0),UIManager.getInstance().addUIContainer(this),this.selecttab(this._selectButtonAry[a]),this.currentRankingCenterPanel.currentServerRankingList.show()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.currentRankingCenterPanel.currentServerRankingList.hide()},c.prototype.butClik=function(a){this.selecttab(a.target)},c.prototype.selecttab=function(a){for(var b=0;b<this._selectButtonAry.length;b++)this._selectButtonAry[b]==a?this._selectButtonAry[b].selected=!0:this._selectButtonAry[b].selected=!1;this._last!=a&&(this._last=a,this.currentRankingCenterPanel.setUiTitle(a.data),this.currentRankingCenterPanel.currentServerRankingList.clearAryData(),this.currentRankingCenterPanel.currentServerRankingList.sendrequest(a.data))},c}(UIVirtualContainer);a.CurrentServerRanking=c;var d=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(c,b),c.prototype.dispose=function(){this.currentServerRankingList&&(this.currentServerRankingList.dispose(),this.currentServerRankingList=null)},c.prototype.setRender=function(a,b,c){this._bottomRender=a,this._topRender=c,this._baseRender=b,this.loadConfigCom()},c.prototype.loadConfigCom=function(){var b=this._topRender.getComponent("c_7_1"),c=this._topRender.getComponent("c_12_1"),d=this._topRender.getComponent("c_7_2");this._titleAry_faction=new Array,this._titleAry_faction.push(b),this._titleAry_faction.push(this._topRender.getComponent("c_5_1")),this._titleAry_faction.push(this._topRender.getComponent("c_3_1")),this._titleAry_wing=new Array,this._titleAry_wing.push(c),this._titleAry_wing.push(this._topRender.getComponent("c_8_1")),this._titleAry_wing.push(this._topRender.getComponent("c_10_1")),this._titleAry_mount=new Array,this._titleAry_mount.push(c),this._titleAry_mount.push(this._topRender.getComponent("c_6")),this._titleAry_mount.push(this._topRender.getComponent("c_2")),this._titleAry_Lev=new Array,this._titleAry_Lev.push(c),this._titleAry_Lev.push(d),this._titleAry_Lev.push(this._topRender.getComponent("c_1_1")),this._titleAry_zhanli=new Array,this._titleAry_zhanli.push(c),this._titleAry_zhanli.push(d),this._titleAry_zhanli.push(this._topRender.getComponent("c_4_1")),this._titleAry_pws=new Array,this._titleAry_pws.push(c),this._titleAry_pws.push(d),this._titleAry_pws.push(this._topRender.getComponent("c_11"));var e=this.addChild(this._bottomRender.getComponent("t_myranktitlebg1"));e.isU=!0,this.RankNum=this.addChild(this._baseRender.getComponent("nanknum")),this.name1=this.addChild(this._baseRender.getComponent("info1")),this.name2=this.addChild(this._baseRender.getComponent("info2")),this.name3=this.addChild(this._baseRender.getComponent("info3")),this.currentServerRankingList=new a.CurrentServerRankingList,this.currentServerRankingList.init(this._baseRender.uiAtlas),this.slistIndex=this.addChild(this._topRender.getComponent("slistIndex")),this.t_norank=this._topRender.getComponent("t_norank"),this.addUIList(["t_myranktitlebg","b_bg5_3"],this._bottomRender),this.addUIList(["line_1_1","line_1_2","line_1_4","a_8","t_myranktitle","line_2"],this._topRender),this.resize()},c.prototype.resetData=function(a){this._data=a,this.drawMyRank(a.rank)},c.prototype.drawMyRank=function(b){switch(this.setUiListVisibleByItem([this.t_norank],!1),this._type){case a.RankingType.RANK_TYPE_POWER:this.drawPowerRank();break;case a.RankingType.RANK_TYPE_LEVEL:this.drawLevRank();break;case a.RankingType.RANK_TYPE_FACTION:var c=GuidData.player.getFactionID();if(!c||0==c.length)return UiDraw.clearUI(this.name1),UiDraw.clearUI(this.name2),UiDraw.clearUI(this.name3),UiDraw.clearUI(this.RankNum),this.setUiListVisibleByItem([this.t_norank],!0),void this.t_norank.goToAndStop(0);this.drawFactionRank();break;case a.RankingType.RANK_TYPE_WINGS:var d=GuidData.grow.getWingID();if(0==d)return UiDraw.clearUI(this.name1),UiDraw.clearUI(this.name2),UiDraw.clearUI(this.name3),UiDraw.clearUI(this.RankNum),this.setUiListVisibleByItem([this.t_norank],!0),void this.t_norank.goToAndStop(2);var e=TableData.getInstance().getData(TableData.tb_wings_bless,d),f=TableData.getInstance().getData(TableData.tb_wings_base,e.rank);this.drawWingsRank(f.id,f.name);break;case a.RankingType.RANK_TYPE_MOUNT:var g=GuidData.player.getMountLevel();if(!g||0==g)return UiDraw.clearUI(this.name1),UiDraw.clearUI(this.name2),UiDraw.clearUI(this.name3),UiDraw.clearUI(this.RankNum),this.setUiListVisibleByItem([this.t_norank],!0),void this.t_norank.goToAndStop(1);this.drawMountRank();break;case a.RankingType.RANK_TYPE_SINGLE_PVP:this.drawPWSRank()}-1==b||0==b?UiDraw.SharedDrawImg(this._topRender.uiAtlas,this._topRender.uiAtlas,this.RankNum.skinName,"NoRank",0,9,!1):4>b?UiDraw.SharedDrawImg(this._topRender.uiAtlas,this._topRender.uiAtlas,this.RankNum.skinName,String(b),10,0,!1):LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.RankNum.skinName,String(b),16,TextAlign.CENTER,ColorType.Brown7a2f21,"",7)},c.prototype.drawPowerRank=function(){this.drawNameAndVip(this.name1,1),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name2.skinName,getProfessional(GameInstance.mainChar.unit.getCharType()),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name3.skinName,Snum(GuidData.player.getForce()),16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawPWSRank=function(){this.drawNameAndVip(this.name1,1),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name2.skinName,getProfessional(GameInstance.mainChar.unit.getCharType()),16,TextAlign.CENTER,ColorType.Brown7a2f21);var a=GuidData.player.getQualifyScore();LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name3.skinName,Snum(a),16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawLevRank=function(){this.drawNameAndVip(this.name1,1),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name2.skinName,getProfessional(GameInstance.mainChar.unit.getCharType()),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name3.skinName,String(GuidData.player.getLevel()),16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawMoneyRank=function(){this.drawNameAndVip(this.name1,1),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name2.skinName,GuidData.player.getFactionName()?getBaseName(GuidData.player.getFactionName()):"暂无帮派",16,TextAlign.CENTER,ColorType.Brown7a2f21);var a=GuidData.player.getSilver();a&&LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name3.skinName,Snum(a),16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawWingsRank=function(a,b){this.drawNameAndVip(this.name1,1),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name2.skinName,b,16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name3.skinName,getChiNum(a)+"阶",16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawMountRank=function(){this.drawNameAndVip(this.name1,1);var a=GuidData.grow.getMountLevel(),b=tb.TB_mount_base_vo.get_TB_mount_base_vo(a);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name2.skinName,b.name,16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name3.skinName,getChiNum(a)+"阶"+GuidData.grow.getMountStart()+"星",16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawFactionRank=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name1.skinName,GuidData.player.getFactionName()?getBaseName(GuidData.player.getFactionName()):"暂无帮派",16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name2.skinName,String(GuidData.faction.getLev()),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.name3.skinName,Snum(GuidData.player.getForce()),16,TextAlign.CENTER,ColorType.Brown7a2f21)},c.prototype.drawNameAndVip=function(a,b){IconManager.getInstance().getIcon(getVipIconUrl(GuidData.player.getVipLevel()),function(c){var d,e=a.uiRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);d=1==b?GuidData.player.getName():GuidData.faction.getManagerName(),d&&d.length>0&&LabelTextFont.writeSingleLabelToCtxSetAnchor(f,ColorType.Brown7a2f21+getBaseName(d),16,57,0),f.drawImage(c,0,0,29,14,108,4,29,14),a.uiRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},c.prototype.setUiTitle=function(b){switch(this._type=b,this._last&&this.setUiListVisibleByItem(this._last,!1),b){case a.RankingType.RANK_TYPE_POWER:this.setUiListVisibleByItem(this._titleAry_zhanli,!0),this._last=this._titleAry_zhanli;break;case a.RankingType.RANK_TYPE_LEVEL:this.setUiListVisibleByItem(this._titleAry_Lev,!0),this._last=this._titleAry_Lev;break;case a.RankingType.RANK_TYPE_FACTION:this.setUiListVisibleByItem(this._titleAry_faction,!0),this._last=this._titleAry_faction;break;case a.RankingType.RANK_TYPE_WINGS:this.setUiListVisibleByItem(this._titleAry_wing,!0),this._last=this._titleAry_wing;break;case a.RankingType.RANK_TYPE_MOUNT:this.setUiListVisibleByItem(this._titleAry_mount,!0),this._last=this._titleAry_mount;break;case a.RankingType.RANK_TYPE_SINGLE_PVP:this.setUiListVisibleByItem(this._titleAry_pws,!0),this._last=this._titleAry_pws}},c.prototype.resize=function(){b.prototype.resize.call(this),this.currentServerRankingList.top=this.slistIndex.parent.y/UIData.Scale+this.slistIndex.y,this.currentServerRankingList.left=this.slistIndex.parent.x/UIData.Scale+this.slistIndex.x},c}(UIVirtualContainer);a.CurrentRankingCenterPanel=d;var e=function(b){function c(){var a=b.call(this)||this;return a._lastMouseX=0,a._lastRoleRotatioinY=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(c,b),c.prototype.dispose=function(){this.mountRoleSprite&&(this.mountRoleSprite.destory(),this.mountRoleSprite=null),this.wingDisplay&&(this.wingDisplay.destory(),this.wingDisplay=null)},c.prototype.setRender=function(a,b,c,d){this._bgRender=b,this._roleRender=c,this._topRender=d,this._baseRender=a,this.loadConfigCom()},c.prototype.loadConfigCom=function(){this.b_btnreward=this.addEvntButUp("b_btn2",this._topRender),this.b_btnsocial=this.addEvntButUp("b_btn3",this._topRender),this.b_bg_role=this.addEvntBut("b_bg_role",this._bgRender),this.addChild(this._bgRender.getComponent("b_bg2")),this.addChild(this._bgRender.getComponent("a_namebg")),this._aryUI=new Array,this._aryUI.push(this.b_btnsocial),this._aryUI.push(this.b_btnreward),this._BtnaryUI=new Array;var a=this._baseRender.getComponent("cnew_but_yes");this.setSizeForPanelUiCopy(a,"b_btn1",this._roleRender),a.addEventListener(InteractiveEvent.Up,this.zanClik,this),this._BtnaryUI.push(a),this._BtnaryUI.push(this._topRender.getComponent("b_mbtxt")),this._BtnaryUI.push(this._topRender.getComponent("b_ymb")),this._BtnaryUI.push(this._topRender.getComponent("a_17")),this._BtnaryUI.push(this._roleRender.getComponent("a_7")),this.t_curname=this.addChild(this._topRender.getComponent("t_curname")),this.t_curvip=this.addChild(this._topRender.getComponent("t_curvip")),this.t_curtitle=this.addChild(this._topRender.getComponent("t_curtitle")),this.mountRoleSprite=new Person2DChar,this._bgRender.addModel(this.mountRoleSprite),this._scale=4,this._rotationY=0,this._posY=-110,this._bgRender.applyObjData(),this.resize()},c.prototype.A_left_bg_MouseDown=function(a){this._lastMouseX=a.x,this._lastRoleRotatioinY=this.mountRoleSprite.rotationY,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.A_left_bg_MouseMove=function(a){this.mountRoleSprite.rotationY=this._lastRoleRotatioinY-(a.x-this._lastMouseX)},c.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.rotationRole=function(){this.mountRoleSprite.rotationY-=.5},c.prototype.setAvatar=function(a,b){void 0===b&&(b=""),this.mountRoleSprite.setAvatar(a)},c.prototype.setWeapon=function(a){this.mountRoleSprite.setWeapon(a)},c.prototype.resizeRole=function(){this.mountRoleSprite&&(this.mountRoleSprite.resize(),this.mountRoleSprite.scale=this._scale*UIData.Scale,this.mountRoleSprite.rotationY=this._rotationY,this.mountRoleSprite.x=-200*UIData.Scale,this.mountRoleSprite.y=this._posY*UIData.Scale),this.wingDisplay&&(this.wingDisplay.resize(),this.wingDisplay.scale=this._scale*UIData.Scale)},c.prototype.resetData=function(b){var c=b.data;this._data=b,this.likenum=c.data.like;var d=c.type==a.RankingType.RANK_TYPE_MOUNT||c.type==a.RankingType.RANK_TYPE_WINGS;if(this.setUiListVisibleByItem(this._aryUI,!d),d){this._bgRender.removeModel(this.wingDisplay);var e;if(c.type==a.RankingType.RANK_TYPE_MOUNT){var f=tb.TB_mount_base_vo.get_TB_mount_base_vo(c.data.mountLev);this.mountRoleSprite.needUIUrl=!0,this.setAvatar(f.mountID),e=f.name,this._scale=3,this._rotationY=30,this._posY=-110}else{var g=TableData.getInstance().getData(TableData.tb_wings_bless,c.data.level),h=TableData.getInstance().getData(TableData.tb_wings_base,g.rank);this.mountRoleSprite.needUIUrl=!1,this.setAvatar(h.model),e=h.name,this._scale=4,this._rotationY=0,this._posY=-50}LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.t_curname.skinName,getBaseName(e),16,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.clearUI(this.t_curtitle),UiDraw.clearUI(this.t_curvip),this.setWeapon(0),this.setUiListVisibleByItem(this._BtnaryUI,!1)}else this._scale=4,this._rotationY=0,this._posY=-110,this.mountRoleSprite.needUIUrl=!0,console.log("---vo.data.weapon---",c.data.coat,c.data.weapon),this.mountRoleSprite.setBaseRoleAvatar(c.data.coat,c.data.gender),this.mountRoleSprite.setBaseRoleWeapon(c.data.weapon,c.data.gender),this.setWing(c.data.wingid),c.data.rank<=3?this.setNum(c.data.like):this.setUiListVisibleByItem(this._BtnaryUI,!1),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.t_curname.skinName,getBaseName(c.data.name),16,TextAlign.CENTER,ColorType.Brown7a2f21),this._topRender.uiAtlas.upDataPicToTexture(getVipIconUrl(c.data.vip),this.t_curvip.skinName),c.data.title>0?this._topRender.uiAtlas.upDataPicToTexture(getUItittleUrl(String(c.data.title)),this.t_curtitle.skinName):UiDraw.clearUI(this.t_curtitle);this.resizeRole()},c.prototype.setWing=function(a){if(a&&a>0){this.wingDisplay||(this.wingDisplay=new Person2DChar,this.wingDisplay.needUIUrl=!1,this.wingDisplay.setBind(this.mountRoleSprite,SceneChar.WING_SLOT)),this._bgRender.addModel(this.wingDisplay),console.log("---$wingid---",a);var b=TableData.getInstance().getData(TableData.tb_wings_bless,a),c=TableData.getInstance().getData(TableData.tb_wings_base,b.rank);c.model&&this.wingDisplay.setAvatar(c.model)}else this._bgRender.removeModel(this.wingDisplay)},c.prototype.setBtnZan=function(){var a=this._data.data,b=GuidData.player.getRankLikeState(),c=3*a.typeShareDef+a.data.rank-1;b[c]?(this.setUiListVisibleByItem([this._BtnaryUI[0],this._BtnaryUI[1]],!1),this.setUiListVisibleByItem([this._BtnaryUI[2],this._BtnaryUI[3],this._BtnaryUI[4]],!0)):(this.setUiListVisibleByItem([this._BtnaryUI[0],this._BtnaryUI[1],this._BtnaryUI[3],this._BtnaryUI[4]],!0),this.setUiListVisibleByItem([this._BtnaryUI[2]],!1))},c.prototype.setNum=function(a){this._data.data.data.like=a,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._BtnaryUI[3].skinName,"被膜拜次数："+a,16,TextAlign.CENTER,ColorType.Whitefff7db),this.setBtnZan()},c.prototype.resize=function(){this.resizeRole(),b.prototype.resize.call(this)},c.prototype.butClik=function(b){var c=this._data.data;switch(b.target){case this.b_bg_role:this.A_left_bg_MouseDown(b);break;case this.b_btnreward:UiTweenScale.getInstance().changeButSize(b.target);var d=new a.RankingEvent(a.RankingEvent.REWARD_RANK_PANLE);d.data=c.typeShareDef,ModuleEventManager.dispatchEvent(d);break;case this.b_btnsocial:UiTweenScale.getInstance().changeButSize(b.target),NetManager.getInstance().protocolos.get_player_overview(c.data.guid)}},c.prototype.zanClik=function(a){UiTweenScale.getInstance().changeButSize(a.target),NetManager.getInstance().protocolos.rank_add_like(this._data.data.typeShareDef,this._data.data.data.guid)},c}(UIVirtualContainer);a.CurrentRankingRightPanel=e}(ranking||(ranking={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ranking;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this.currentServerRanking&&(this.currentServerRanking.dispose(),this.currentServerRanking=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicRender.uiAtlas=WindowUi.winUIAtlas,this._baseRender.uiAtlas.setInfo("ui/uidata/ranking/ranking.xml","ui/uidata/ranking/ranking.png",function(){a.loadConfigCom()},"ui/uidata/ranking/rankingpc.png")},c.prototype.loadConfigCom=function(){this.winmidRender.uiAtlas=WindowUi.winUIAtlas;var a=this._baseRender;this.addChild(a.getComponent("title")),this.applyLoadComplete()},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.currentServerRanking||(this.currentServerRanking=new a.CurrentServerRanking,this.currentServerRanking.initUiAtlas(this._baseRender.uiAtlas,this._publicRender.uiAtlas,this.winmidRender),this.currentServerRanking.parent=this),this.currentServerRanking.show()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.currentServerRanking&&this.currentServerRanking.hide(),ModulePageManager.hideResTittle()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.RankingEvent(a.RankingEvent.HIDE_RANKING_EVENT))}},c}(WindowUi);a.RankingUiPanel=b}(ranking||(ranking={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ranking;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"RankingModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.RankingModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.HIDE_RANKING_EVENT="HIDE_RANKING_EVENT",b.SHOW_RANKING_EVENT="SHOW_RANKING_EVENT",b.REFRESH_RANKING_RIGHTPANEL_EVENT="REFRESH_RANKING_RIGHTPANEL_EVENT",b.RANKING_DATA_EVENT="ranking_data_event",b.RANKING_LIKE_CHG_EVENT="RANKING_LIKE_CHG_EVENT",b.RANKING_OWN_EVENT="RANKING_OWN_EVENT",b.REWARD_RANK_PANLE="REWARD_RANK_PANLE",b}(BaseEvent);a.RankingEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"RankingProcessor"},d.prototype.receivedModuleEvent=function(a){var b=a;if(a instanceof c)if(b.type==c.SHOW_RANKING_EVENT)this.showRankingUi(b.data);else if(b.type==c.HIDE_RANKING_EVENT)this.hideRankingUi();else if(b.type==c.REFRESH_RANKING_RIGHTPANEL_EVENT)this.refreshRightPanel(b.data);else if(b.type==c.RANKING_DATA_EVENT){var d=b.data;this.rankQueryResult(d)}else b.type==c.RANKING_LIKE_CHG_EVENT?this.rankLikeChg():b.type==c.RANKING_OWN_EVENT?this.rankQueryResult(b.data):b.type==c.REWARD_RANK_PANLE&&this.showRewardPanel(b.data);if(a instanceof UIPanelEvent){var e=a;e.panel==this._rankingUiPanel&&(this._rankingUiPanel.dispose(),this._rankingUiPanel=null,console.log("释放面板 _rankingUiPanel")),e.panel==this._rankReward&&(this._rankReward.dispose(),this._rankReward=null,console.log("释放面板 _rankReward"))}},d.prototype.showRewardPanel=function(b){var c=this;console.log("===222",b),this._rankReward||(this._rankReward=new a.RankReward),this._rankReward.load(function(){c._rankReward.show(b)},!1)},d.prototype.rankLikeChg=function(){this._rankingUiPanel&&this._rankingUiPanel.currentServerRanking&&this._rankingUiPanel.currentServerRanking.currentRankingrightPanel&&this._rankingUiPanel.currentServerRanking.currentRankingrightPanel.setNum(this._rankingUiPanel.currentServerRanking.currentRankingrightPanel.likenum+1)},d.prototype.rankQueryResult=function(a){this._rankingUiPanel&&this._rankingUiPanel.currentServerRanking&&this._rankingUiPanel.currentServerRanking.currentRankingCenterPanel&&this._rankingUiPanel.currentServerRanking.currentRankingCenterPanel.currentServerRankingList&&this._rankingUiPanel.currentServerRanking.currentRankingCenterPanel.resetData(a)},d.prototype.refreshRightPanel=function(a){this._rankingUiPanel&&this._rankingUiPanel.currentServerRanking&&this._rankingUiPanel.currentServerRanking.currentRankingrightPanel&&this._rankingUiPanel.currentServerRanking.currentRankingrightPanel.resetData(a)},d.prototype.hideRankingUi=function(){this._rankingUiPanel&&this._rankingUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showRankingUi=function(b){var c=this;this._rankingUiPanel||(this._rankingUiPanel=new a.RankingUiPanel),this._rankingUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),c._rankingUiPanel.show()})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_RANKING_EVENT),new c(c.HIDE_RANKING_EVENT),new c(c.REFRESH_RANKING_RIGHTPANEL_EVENT),new c(c.RANKING_DATA_EVENT),new c(c.RANKING_LIKE_CHG_EVENT),new c(c.RANKING_OWN_EVENT),new c(c.REWARD_RANK_PANLE),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.RankingProcessor=d;var e=function(){function a(){}return a}();a.RankQueryData=e;
var f=function(){function a(){}return a}();a.RankItemData=f}(ranking||(ranking={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),role;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._publicbgRender=new UIRenderComponent,b.addRender(b._publicbgRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._bgRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._midRender.dispose(),this._midRender=null,this._bgRender.dispose(),this._bgRender=null},b.prototype.applyLoad=function(){var a=this;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender.uiAtlas.setInfo("ui/uidata/role/changename.xml","ui/uidata/role/changename.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._midRender.uiAtlas=this._bgRender.uiAtlas,this._baseRender.uiAtlas=this._bgRender.uiAtlas,this.a_basebg=this.addEvntBut("a_basebg",this._bgRender),this.a_basebg.addEventListener(InteractiveEvent.Up,this.butClik,this),this.addChild(this._bgRender.getComponent("a_bg")),this.a_name=this.addChild(this._midRender.getComponent("a_name")),this.a_cost=this.addChild(this._midRender.getComponent("a_cost")),this.a_txtbg=this.addEvntButUp("a_txtbg",this._baseRender),this.addUIList(["a_title","a_txt","a_btnqd","a_btnqx"],this._midRender),this.cnew_btn0=this.addEvntButUp("cnew_btn1",this._publicbgRender),this.setSizeForPanelUiCopy(this.cnew_btn0,"btnBg0",this._midRender),this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicbgRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg1",this._midRender),this.resize(),this.applyLoadComplete()},b.prototype.resize=function(){this.a_basebg.top=0,this.a_basebg.left=0,this.a_basebg.y=0,this.a_basebg.x=0,this.a_basebg.height=Scene_data.stageHeight/UIData.Scale,this.a_basebg.width=Scene_data.stageWidth/UIData.Scale,a.prototype.resize.call(this)},b.prototype.butClik=function(a){var b=this;switch(a.target){case this.a_basebg:break;case this.cnew_btn0:if(this.checkStr(this._msg)&&this._type&&this._canbuy){var c=new ByteArray;if(c.writeUTF(this._msg),c.length>20)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"字符太长",99);NetManager.getInstance().protocolos.rename(this._msg),UIManager.getInstance().removeUIContainer(this)}else{if(!this._type)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"名称修改失败，与原名相同",99);if(!this._canbuy){var d=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return d.data=this._resid,void ModuleEventManager.dispatchEvent(d)}if(!this.checkStr(this._msg))return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"含敏感词汇,请更正",99)}break;case this.cnew_btn1:UIManager.getInstance().removeUIContainer(this);break;case this.a_txtbg:InputPanel.show(function(a){b.inputBfunGG(a)},this._type?this._msg:"",0,320)}},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.resetInputtxt();for(var a=GuidData.player.getChgNameTime(),b=a+1,c=tb.TB_rename_info.get_TB_rename_info(),d=0;d<c.length;d++){var e=c[d].range[0],f=-1==c[d].range[1]?1e5:c[d].range[1];if(b>=e&&f>=b){this._resid=c[d].costs[0][0],this.drawCost(c[d].costs[0]);break}}},b.prototype.drawCost=function(a){0==a[1]?(this._canbuy=!0,LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.a_cost.skinName,"首次改名免费",16,TextAlign.LEFT,ColorType.colorff7200)):this._canbuy=UiDraw.drawRewardIconAndtxt(this.a_cost,a,!0,TextAlign.LEFT)},b.prototype.resetInputtxt=function(){this._msg=GuidData.player.getBaseName(),this._type=!1,this.refreshInputBfunGG()},b.prototype.inputBfunGG=function(a){var b=new ByteArray;return b.writeUTF(a),b.length>20||a.length>6?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"输入太长了（超过6个字了）",99):(b.length>0?(this._type=!0,this._msg=a):(this._type=!1,this._msg=GuidData.player.getBaseName()),void this.refreshInputBfunGG())},b.prototype.refreshInputBfunGG=function(){LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.a_name.skinName,this._msg,16,TextAlign.CENTER,ColorType.Brown7a2f21)},b.prototype.checkStr=function(a){return!0},b}(UIPanel);a.changenamePanel=b}(role||(role={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),role;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a}return __extends(d,b),d.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this.gdesignationList&&(this.gdesignationList.dispose(),this.gdesignationList=null)},d.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},d.prototype.initView=function(){var a=this._baseRender;this._uiAry=new Array,this.c_listindex=this.addChild(a.getComponent("c_listindex"));var b=this.addChild(this._publicRender.getComponent("cnew_coffeeBg"));this.setSizeForPanelUiCopy(b,"c_coffeeBg",a),this.addChild(this._topRender.getComponent("c_forcebg")),this.addChild(this._baseRender.getComponent("c_kuang")),this._uiAry.push(this._baseRender.getComponent("c_txtbg0")),this._uiAry.push(this._baseRender.getComponent("c_txtbg1")),this._uiAry.push(this._baseRender.getComponent("c_line")),this._uiAry.push(this._topRender.getComponent("c_txt")),this._uiAry.push(this._topRender.getComponent("c_forcebg1")),this.c_titleforce=this.addChild(this._topRender.getComponent("c_titleforce")),this.c_tab0=this.addEvntBut("c_tab0",this._topRender),this.c_tab1=this.addEvntBut("c_tab1",this._topRender),this.c_titlename=this.addChild(this._topRender.getComponent("c_titlename")),this.c_force=this.addChild(this._topRender.getComponent("c_force")),this.c_timetxt=this.addChild(this._topRender.getComponent("c_timetxt")),this._uiAry.push(this.c_titlename),this._uiAry.push(this.c_force),this._uiAry.push(this.c_timetxt),this.AttrAry=new Array;for(var c=0;6>c;c++)this.AttrAry.push(this.addChild(this._topRender.getComponent("c_attr"+c)));this.cnew_btn1=this.addEvntButUp("cnew_btn1",this._publicRender),this.setSizeForPanelUiCopy(this.cnew_btn1,"btnBg",a),this.BtnAry=new Array,this.BtnAry.push(this.cnew_btn1),this.BtnAry.push(this._topRender.getComponent("c_btntxt")),this.CostAry=new Array,this.CostAry.push(this._topRender.getComponent("c_propicon")),this.CostAry.push(this._topRender.getComponent("c_propnum")),this.CostAry.push(this._topRender.getComponent("c_info")),this._redPointRender.getRedPointUI(this,11,new Vector2D(this.c_tab0.x+this.c_tab0.width-5,this.c_tab0.y)),this._redPointRender.getRedPointUI(this,114,new Vector2D(this.c_tab1.x+this.c_tab1.width-5,this.c_tab1.y)),this._btnRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.cnew_btn1.x+this.cnew_btn1.width,this.cnew_btn1.y)),this._publicRender.applyObjData()},d.prototype.selecttype=function(b){this.setUiListVisibleByItem(this._uiAry,!1),this.setUiListVisibleByItem(this.AttrAry,!1),this.setUiListVisibleByItem(this.BtnAry,!1),this.setUiListVisibleByItem(this.CostAry,!1),this.gdesignationList||(this.gdesignationList=new c,this.gdesignationList.init(this._baseRender.uiAtlas)),0==b?(this.c_tab0.selected=!0,this.c_tab1.selected=!1,this.gdesignationList.show(a.TabKey.TabAction)):1==b&&(this.c_tab1.selected=!0,this.c_tab0.selected=!1,this.gdesignationList.show(a.TabKey.Tabdesignation)),this.resize()},d.prototype.resize=function(){b.prototype.resize.call(this),this.gdesignationList&&(this.gdesignationList.left=this.c_listindex.parent.x/UIData.Scale+this.c_listindex.x,this.gdesignationList.top=this.c_listindex.parent.y/UIData.Scale+this.c_listindex.y)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.selecttype(0),this.setAllForce(),this.resize()},d.prototype.setAllForce=function(){ArtFont.getInstance().writeFontToSkinNameCenter(this._topRender.uiAtlas,this.c_titleforce.skinName,Snum(GuidData.player.getTitleForce()),ArtFont.num57)},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.gdesignationList&&this.gdesignationList.hide()},d.prototype.resetData=function(a){this.setUiListVisibleByItem(this._uiAry,!0),this.setUiListVisibleByItem(this.AttrAry,!0),this._vo=a;for(var b=new Array,c=new Array,d=0;d<a.data.prop.length;d++)b.push(a.data.prop[d][0]),c.push(a.data.prop[d][1]);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.c_titlename.skinName,a.data.name,16,TextAlign.CENTER,getColorQua(a.data.qua)),ArtFont.getInstance().writeFontToSkinNameCenter(this._topRender.uiAtlas,this.c_force.skinName,Snum(getForceByAtt(b,c)),ArtFont.num56),this.drawAttr(a.data.prop),this.drawTime(a.data.limtime),this.setUiListVisibleByItem(this.BtnAry,!(1==a.state&&1==a.data.unlock_type)),this.setUiListVisibleByItem(this.CostAry,1==a.state),1==a.state?this.BtnAry[1].goToAndStop(2):4==a.state?this.BtnAry[1].goToAndStop(0):this.BtnAry[1].goToAndStop(1),1==a.data.unlock_type?(UiDraw.clearUI(this.CostAry[0]),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.CostAry[1].skinName,"<激活条件>",16,TextAlign.CENTER,ColorType.color9a683f),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.CostAry[2].skinName,a.data.getinfo,16,TextAlign.CENTER,ColorType.color2daa35)):(UiDraw.clearUI(this.CostAry[2]),IconManager.getInstance().drawItemIcon40(this.CostAry[0],a.data.unlock_cost[0][0]),this._canbuy=UiDraw.drawResHasNumAndAllNum(this.CostAry[1],a.data.unlock_cost[0])),1==a.state&&a.node.show?this._btnRedPoint.preShow():this._btnRedPoint.preHide()},d.prototype.drawAttr=function(a){for(var b=0;b<this.AttrAry.length;b++)a.length-1<b?UiDraw.clearUI(this.AttrAry[b]):UiDraw.drawAttVal(this.AttrAry[b],a[b][0],a[b][1],TextAlign.CENTER)},d.prototype.drawTime=function(a){0==a?LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.c_timetxt.skinName,"有效时间：无期限",16,TextAlign.CENTER,ColorType.colorce0a00):this.drawlimtime()},d.prototype.drawlimtime=function(){var a="";if(1==this._vo.state){var b=this.getTimeAry(this._vo.data.limtime);a="有效时间："+b[0]+"天"+b[1]+"小时"+b[2]+"分钟"}else{var c=GameInstance.getServerNow(),d=new Date(1e3*c),e=Math.floor((this._vo.time-Math.floor(d.getTime()/1e3))/60),f=this.getTimeAry(e);a="剩余时间："+f[0]+"天"+f[1]+"小时"+f[2]+"分钟"}LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.c_timetxt.skinName,a,14,TextAlign.CENTER,ColorType.colorce0a00)},d.prototype.getTimeAry=function(a){var b,c,d,e=new Array,f=a/60;return f>=24?(b=Math.floor(f/24)+1,c=0,d=0):1>f?(b=0,c=0,d=a+1):(b=0,c=Math.floor(f+1),d=0),e.push(b),e.push(c),e.push(d),e},d.prototype.butClik=function(a){switch(a.target){case this.c_tab0:this.selecttype(0);break;case this.c_tab1:this.selecttype(1);break;case this.cnew_btn1:if(UiTweenScale.getInstance().changeButSize(a.target),this._vo)if(3==this._vo.state||2==this._vo.state)NetManager.getInstance().protocolos.set_title(this._vo.data.id);else if(4==this._vo.state)NetManager.getInstance().protocolos.set_title(0);else if(1==this._vo.state)if(this._canbuy)NetManager.getInstance().protocolos.unlock_title(this._vo.data.id);else{var b=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);b.data=this._vo.data.unlock_cost[0][0],ModuleEventManager.dispatchEvent(b)}}},d}(UIVirtualContainer);a.DesignationPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=222,a.top=83,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,400,422,200,85,5,512,1024,2,7)},c.prototype.selectDataToIndex=function(){this.refreshDataByNewData(),this.setSelectIndex(this.getCurrentSelectIndex())},c.prototype.refreshDataByNewData=function(){this._aryList=a.RoleModel.getInstance().getListByTab(this.type);var b=this.getData(this._aryList);this.refreshData(b)},c.prototype.getData=function(b){for(var c=this.type==a.TabKey.TabAction?12:115,d=RedPointManager.getInstance().getNodeByID(c).children,e=new Array,f=0;f<b.length;f++){b[f].node=d[f];var g=new SListItemData;g.data=b[f],g.id=f,e.push(g)}return e},c.prototype.show=function(a){this.hasStage||UIManager.getInstance().addUIContainer(this),this.type!=a&&(this.type=a,this.selectDataToIndex())},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.GDesignationList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Tab=this.creatSUI(c,this.parentTarget.baseAtlas,"Tab",0,1,193,82),a.addChild(this.Tab),this.Tab.addEventListener(InteractiveEvent.Up,this.equClick,this),this.RedPoint=this.creatSUI(d,this.parentTarget.baseAtlas,"RedPoint",176,3,17,16),this.RedPoint.preParent=a,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.RedPoint.skinName,UIData.publicUi,PuiData.A_RED_POINT)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,b){var c=new a.RoleUiEvent(a.RoleUiEvent.SHOWVIEW_Designation_EVENT);c.data=this.itdata,ModuleEventManager.dispatchEvent(c);var d=this.itdata.data;2==d.state&&NetManager.getInstance().protocolos.init_title(d.data.id)}this.applyrender()},enumerable:!0,configurable:!0}),c.prototype.drawDesignation=function(){var a=this,b=this.itdata.data;LoadManager.getInstance().load(Scene_data.fileRoot+getUItittleUrl(String(b.data.id)),LoadManager.IMG_TYPE,function(c){var d=a._baseRender.uiAtlas.getRec(a.Tab.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.TITLEBG,new Rectangle(0,0,d.pixelWitdh,d.pixelHeight),UIData.publicUi);var f=Math.min(d.pixelWitdh/c.width,d.pixelHeight/c.height);if(e.drawImage(c,0,0,c.width,c.height,d.pixelWitdh/2-c.width*f/2,d.pixelHeight/2-c.height*f/2,c.width*f,c.height*f),1==b.state)UiDraw.cxtDrawImg(e,PuiData.MASK,new Rectangle(0,0,d.pixelWitdh,d.pixelHeight),UIData.publicUi);else if(2==b.state)UiDraw.cxtDrawImg(e,PuiData.A_RED_POINT,new Rectangle(172,5,17,16),UIData.publicUi);else if(4==b.state){var g=a.parentTarget.baseAtlas.getRec("outfit");e.drawImage(a.parentTarget.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,0,0,g.pixelWitdh,g.pixelHeight)}a.selected&&UiDraw.cxtDrawImg(e,PuiData.TITLEHIGHT,new Rectangle(0,0,d.pixelWitdh,d.pixelHeight),UIData.publicUi),a._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},c.prototype.applyrender=function(){this.itdata&&this.itdata.data&&(this.itdata.data.node&&this.itdata.data.node.bindUI(this.RedPoint),this.drawDesignation())},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.equClick=function(a){UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data&&this.setSelect()},c.prototype.setnull=function(){UiDraw.clearUI(this.Tab),this.RedPoint.preHide()},c}(SListItem);a.GDesignationListRender=d}(role||(role={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),role;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a._lastMouseX=0,a._lastRoleRotatioinY=0,a.KeyCharType=[0,0,0,1,1,2,2],a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._publicRender=new UIRenderComponent,a.addRender(a._publicRender),a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.roleSprite.destory(),this.roleSprite=null},c.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._bgRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._baseRender;this.roleSprite=new Person2DChar,this._baseRender.addModel(this.roleSprite),this.a_role=this.addEvntBut("a_role",this._baseRender),this.addUIList(["a_bg","a_forcebg","a_probg","a_txtbg0","a_levtxt"],this._bgRender),this.addUIList(["a_txt0"],this._baseRender);var b=this.addChild(this._bgRender.getComponent("a_namebg"));UiDraw.uiAtlasDrawImg(this._bgRender.uiAtlas,b.skinName,UIData.publicUi,PuiData.TXTBG),this.a_btn=this.addEvntButUp("a_btn",this._baseRender),this.a_pro=this.addChild(this._baseRender.getComponent("a_pro")),this.a_exp=this.addChild(this._baseRender.getComponent("a_exp")),this.a_name=this.addChild(this._baseRender.getComponent("a_name")),this.a_force=this.addChild(this._baseRender.getComponent("a_force")),this.a_lev=this.addChild(this._baseRender.getComponent("a_lev")),this.a_profession=this.addChild(this._baseRender.getComponent("a_profession")),this.attrary=new Array;for(var c=0;11>c;c++)this.attrary.push(this.addChild(a.getComponent("a_attr"+c)))},c.prototype.A_left_bg_MouseDown=function(a){this._lastMouseX=a.x,this._lastRoleRotatioinY=this.roleSprite.rotationY,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.A_left_bg_MouseMove=function(a){this.roleSprite.rotationY=this._lastRoleRotatioinY-(a.x-this._lastMouseX)},c.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},c.prototype.rotationRole=function(){this.roleSprite.rotationY-=.5},c.prototype.setAvatar=function(){this.roleSprite.setBaseRoleAvatar(GuidData.player.getAvatar(),GuidData.player.getCharType()),this.roleSprite.setBaseRoleWeapon(GuidData.player.getWeapon(),GuidData.player.getCharType()),this.roleSprite.rotationY=0,this.setWing()},c.prototype.resizeRole=function(){this.roleSprite&&(this.roleSprite.resize(),this.roleSprite.scale=5*UIData.Scale,this.roleSprite.rotationY=0,this.roleSprite.x=140*UIData.Scale,this.roleSprite.y=-110*UIData.Scale)},c.prototype.setWing=function(){this.wingDisplay||GuidData.grow.getWingID()&&(this.wingDisplay=new Person2DChar,this.wingDisplay.needUIUrl=!1,this._baseRender.addModel(this.wingDisplay),this.wingDisplay.setBind(this.roleSprite,SceneChar.WING_SLOT)),GuidData.grow.getWingID()&&this.wingDisplay.setAvatar(GuidData.grow.getWingModel())},c.prototype.resize=function(){b.prototype.resize.call(this),this.resizeRole(),this.wingDisplay&&(this.wingDisplay.resize(),this.wingDisplay.scale=6*UIData.Scale)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.showAttr(),this.setAvatar(),this.setZhanli(),this.setRolemsg(),this.setEXP(),this.setLev(),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.showAttr=function(){UiDraw.drawAttVal(this.attrary[0],1,100*GuidData.player.getPropById(1)),UiDraw.drawAttVal(this.attrary[1],2,100*GuidData.player.getPropById(2)),UiDraw.drawAttVal(this.attrary[2],3,100*GuidData.player.getAllArmor()),UiDraw.drawAttVal(this.attrary[3],4,100*GuidData.player.getPropById(4)),UiDraw.drawAttVal(this.attrary[4],5,100*GuidData.player.getPropById(5)),UiDraw.drawAttVal(this.attrary[5],6,100*GuidData.player.getPropById(6)),UiDraw.drawAttVal(this.attrary[6],7,100*GuidData.player.getPropById(7)),UiDraw.drawAttVal(this.attrary[7],20,100*GuidData.player.getPropById(20)),UiDraw.drawAttVal(this.attrary[8],21,100*GuidData.player.getPropById(21)),UiDraw.drawAttVal(this.attrary[9],13,100*GuidData.player.getPropById(13)),UiDraw.drawAttVal(this.attrary[10],14,100*GuidData.player.getPropById(14))},c.prototype.setEXP=function(){var a,b,c=tb.TB_char_level.get_TB_char_level();c[c.length-1].id<=GuidData.player.getLevel()?(a="等级已达上限",b=1):(a=GuidData.player.getExp()+"/"+GuidData.player.getMaxExp(),b=GuidData.player.getExp()/GuidData.player.getMaxExp()),this.a_pro.uvScale=b,LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.a_exp.skinName,a,16,TextAlign.CENTER,ColorType.color9f7b4d)},c.prototype.setLev=function(){LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.a_lev.skinName,String(GuidData.player.getLevel()),16,TextAlign.LEFT,ColorType.Green2ca937)},c.prototype.setZhanli=function(){ArtFont.getInstance().writeFontToSkinNameCenter(this._baseRender.uiAtlas,this.a_force.skinName,Snum(GuidData.player.getForce()),ArtFont.num56)},c.prototype.setRolemsg=function(){LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.a_name.skinName,GuidData.player.getBaseName(),16,TextAlign.CENTER,ColorType.Brown7a2f21),this.a_profession.goToAndStop(this.KeyCharType[GuidData.player.getCharType()])},c.prototype.butClik=function(b){switch(b.target){case this.a_role:this.A_left_bg_MouseDown(b);break;case this.a_btn:UiTweenScale.getInstance().changeButSize(b.target),ModuleEventManager.dispatchEvent(new a.RoleUiEvent(a.RoleUiEvent.CHANGE_NAME_EVENT))}},c}(UIVirtualContainer);a.AttributeUiPanel=b}(role||(role={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),role;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._publicRender=new UIRenderComponent,b.addRender(b._publicRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.achievementTabList&&(this.achievementTabList.dispose(),this.achievementTabList=null),this.achievementList&&(this.achievementList.dispose(),this.achievementList=null)},b.prototype.initUiAtlas=function(a,b){this._publicRender.uiAtlas=b,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.t_listindex0=this.addChild(a.getComponent("t_listindex0")),this.t_listindex1=this.addChild(a.getComponent("t_listindex1"));var b=this.addChild(this._publicRender.getComponent("cnew_coffeeBg"));this.setSizeForPanelUiCopy(b,"coffeeBg",a),this._publicRender.applyObjData()},b.prototype.resize=function(){a.prototype.resize.call(this),this.achievementTabList&&(this.achievementTabList.left=this.t_listindex0.parent.x/UIData.Scale+this.t_listindex0.x,this.achievementTabList.top=this.t_listindex0.parent.y/UIData.Scale+this.t_listindex0.y),this.achievementList&&(this.achievementList.left=this.t_listindex1.parent.x/UIData.Scale+this.t_listindex1.x,this.achievementList.top=this.t_listindex1.parent.y/UIData.Scale+this.t_listindex1.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.achievementList||(this.achievementList=new e,this.achievementList.init(this._baseRender.uiAtlas)),this.achievementTabList||(this.achievementTabList=new c,this.achievementTabList.init(this._baseRender.uiAtlas)),this.achievementTabList.show(),this.resize()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.achievementTabList&&this.achievementTabList.hide(),this.achievementList&&this.achievementList.hide()},b}(UIVirtualContainer);a.AchievementPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a._type=-1,a.left=45,a.top=82,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,167,426,0,58,7,256,1024,1,10)},c.prototype.refreshDataByNewData=function(b){void 0===b&&(b=-2),-2!=b&&(this._type=b);var c=a.RoleModel.getInstance().getTabListByType(this._type),d=this.getData(c);this.refreshData(d)},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData(-1);var b=a.RoleModel.getInstance().getFirstList(),c=new a.RoleUiEvent(a.RoleUiEvent.Achievement_VIEW_ITEM_EVENT);c.data=b,ModuleEventManager.dispatchEvent(c)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.AchievementTabList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Tab=this.creatSUI(d,this.parentTarget.baseAtlas,"Tab",0,0,167,58),a.addChild(this.Tab)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.applyrender()},enumerable:!0,configurable:!0}),c.prototype.draw=function(a){var b=this.uiAtlas.getRec(this.Tab.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1),d=0,e=0,f=!1;if(2==a.state&&(d=7,e=4,f=!0),f){var g;g=this.selected?this.parentTarget.baseAtlas.getRec("StypeBG2"):this.parentTarget.baseAtlas.getRec("StypeBG1"),c.drawImage(this.parentTarget.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,d,e,g.pixelWitdh,g.pixelHeight);var h=this.parentTarget.baseAtlas.getRec(a.name);c.drawImage(this.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,68,21,h.pixelWitdh,h.pixelHeight)}else{var i=this.parentTarget.baseAtlas.getRec("TpeBG");c.drawImage(this.parentTarget.baseAtlas.useImg,i.pixelX,i.pixelY,i.pixelWitdh,i.pixelHeight,d,e,i.pixelWitdh,i.pixelHeight),h=this.parentTarget.baseAtlas.getRec(a.name),c.drawImage(this.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,66,19,h.pixelWitdh,h.pixelHeight)}if(!f){var j;j=a.selecteds?this.parentTarget.baseAtlas.getRec("UP"):this.parentTarget.baseAtlas.getRec("DOWN"),c.drawImage(this.parentTarget.baseAtlas.useImg,j.pixelX,j.pixelY,j.pixelWitdh,j.pixelHeight,128,24,j.pixelWitdh,j.pixelHeight)}a.isredpoint&&UiDraw.cxtDrawImg(c,PuiData.A_RED_POINT,new Rectangle(143,e,17,16),UIData.publicUi),TextureManager.getInstance().updateTexture(this.uiAtlas.texture,b.pixelX,b.pixelY,c)},c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;this.draw(a)}},c.prototype.render=function(a){this.itdata=a,a?(this.Tab.addEventListener(InteractiveEvent.Up,this.equClick,this),this.applyrender()):(this.Tab.removeEventListener(InteractiveEvent.Up,this.equClick,this),this.setnull())},c.prototype.equClick=function(){var b=new a.RoleUiEvent(a.RoleUiEvent.Achievement_SELECT_TAB_EVENT);b.data=this.itdata,ModuleEventManager.dispatchEvent(b),this.setSelect()},c.prototype.setnull=function(){UiDraw.clearUI(this.Tab)},c}(SListItem);a.AchievementTabRender=d;var e=function(a){function b(){var b=a.call(this)||this;return b.left=229,b.top=87,b}return __extends(b,a),b.prototype.init=function(a){f.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,f,622,422,0,91,4,512,1024,1,7)},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},b.prototype.show=function(a){console.log("-$data--",a),this.hasStage||UIManager.getInstance().addUIContainer(this);var b=this.getData(a);this.refreshData(b)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.AchievementList=e;var f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this.Bg=this.creatGrid9SUI(d,b.baseAtlas,"Bg",0,0,622,86,15,15),c.addChild(this.Bg),this.Icon=this.creatSUI(e,b.baseAtlas,"Icon",8,9,68,68),c.addChild(this.Icon),this.Name=this.creatSUI(e,b.baseAtlas,"Name",93,8,125,20),c.addChild(this.Name),this.Info=this.creatSUI(e,b.baseAtlas,"Info",93,30,245,20),c.addChild(this.Info),this.Progress=this.creatSUI(e,b.baseAtlas,"Progress",92,60,239,16),c.addChild(this.Progress),this.Reward1=this.creatSUI(e,b.baseAtlas,"Reward1",342,9,68,68),c.addChild(this.Reward1),this.Reward2=this.creatSUI(e,b.baseAtlas,"Reward2",415,9,68,68),c.addChild(this.Reward2),this.Btn=this.creatSUI(e,b.baseAtlas,"Btn",501,22,105,45),c.addChild(this.Btn),this.Btn.addEventListener(InteractiveEvent.Up,this.butClik,this)},b.prototype.applyrender=function(){var a=this.itdata.data;UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Bg.skinName,UIData.publicUi,PuiData.Slist_nselect),this.drawIcon(),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name.skinName,a.data.name,16,TextAlign.LEFT,ColorType.Brown7a2f21);var b=a.data.info+"("+a.progress+"/"+a.data.maxnum+")";if(b=a.hasReward?ColorType.Green2ca937+b:ColorType.color9a683f+b,LabelTextFont.writeSingleLabel(this.uiAtlas,this.Info.skinName,b,16,TextAlign.LEFT,ColorType.Brown7a2f21),this.drawProgress(),a.data.title&&a.data.title>0)this.drawReward([0,1],this.Reward1,!0),this.Reward1.data=null,a.data.reward.length>0&&IconManager.getInstance().drawItemIcon60(this.Reward2,a.data.reward[0][0],a.data.reward[0][1],a.hasReward);else for(var c=0;c<a.data.reward.length;c++)c?IconManager.getInstance().drawItemIcon60(this.Reward2,a.data.reward[c][0],a.data.reward[c][1],a.hasReward):IconManager.getInstance().drawItemIcon60(this.Reward1,a.data.reward[c][0],a.data.reward[c][1],a.hasReward);1==a.data.reward.length&&0==a.data.title&&UiDraw.clearUI(this.Reward2),this.drawBtn()},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},b.prototype.drawBtn=function(){var a,c=this.itdata.data,d=this._baseRender.uiAtlas.getRec(this.Btn.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);a=c.hasReach?c.hasReward?b.baseAtlas.getRec("Ok"):b.baseAtlas.getRec("Receive"):b.baseAtlas.getRec("Go"),e.drawImage(b.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)},b.prototype.drawReward=function(a,b,c){var d,e=this,f=this.itdata.data;d=c?"ui/load/tittle/icon"+a[0]+".png":GameData.getIconCopyUrl(a[0]),IconManager.getInstance().getIcon(d,function(c){var d=e._baseRender.uiAtlas.getRec(b.skinName),g=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(g,PuiData.A_BLACK_F,new Rectangle(0,0,64,64),UIData.publicUi),g.drawImage(c,0,0,60,60,2,2,60,60),
ArtFont.getInstance().writeFontToCtxRight(g,String(a[1]),ArtFont.num1,64,45),f.hasReward&&UIManager.getInstance().makeCtxToGray(g,new Rectangle(0,0,64,64)),e._baseRender.uiAtlas.updateCtx(g,d.pixelX,d.pixelY)})},b.prototype.drawProgress=function(){var a=this.itdata.data,c=this._baseRender.uiAtlas.getRec(this.Progress.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),e=40,f=3,g=b.baseAtlas.getRec("Pro_bg");d.drawImage(b.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,0,0,g.pixelWitdh,g.pixelHeight);var h=a.progress/a.data.maxnum,i=b.baseAtlas.getRec("Pro");d.drawImage(b.baseAtlas.useImg,i.pixelX,i.pixelY,i.pixelWitdh*h,i.pixelHeight,e,f,i.pixelWitdh*h,i.pixelHeight),this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},b.prototype.drawIcon=function(){var a=this,b=this.itdata.data;LoadManager.getInstance().load(Scene_data.fileRoot+"ui/load/achievementicon/1.png",LoadManager.IMG_TYPE,function(c){var d=a._baseRender.uiAtlas.getRec(a.Icon.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);UiDraw.cxtDrawImg(e,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(c,0,0,60,60,4,4,60,60),ArtFont.getInstance().writeFontToCtxCenten(e,String(b.data.achval),ArtFont.num1,34,45),a._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},b.prototype.butClik=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){var b=this.itdata.data;b.hasReach?b.hasReward||NetManager.getInstance().protocolos.get_achieve_reward(b.data.id):console.log("前往")}},b.prototype.setnull=function(){UiDraw.clearUI(this.Bg),UiDraw.clearUI(this.Icon),UiDraw.clearUI(this.Name),UiDraw.clearUI(this.Info),UiDraw.clearUI(this.Progress),UiDraw.clearUI(this.Reward1),UiDraw.clearUI(this.Reward2),UiDraw.clearUI(this.Btn)},b}(SListItem);a.AchievementRender=f}(role||(role={}));var role;!function(a){var b=function(){function a(){this.selecteds=!1}return a}();a.TabItemData=b;var c=function(){function a(){}return a.TabAction=1,a.Tabdesignation=2,a}();a.TabKey=c;var d=function(){function a(){this.state=1}return a}();a.TitleData=d;var e=function(){function a(){this.isObtain=!1}return a}();a.ObtainData=e;var f=function(){function a(){this.getBaseList()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getBaseList=function(){this._allachieveary=tb.TB_achieve_base.getTB_achieve_base(),this._allachieveary.sort(function(a,b){return a.type==b.type?a.id-b.id:a.type-b.type}),console.log("---this._allary---",this._allachieveary),this._alltitleary=tb.TB_title_base.getTB_title_base()},a.prototype.getTabListByType=function(a){for(var c=-1,d=-1,e=new Array,f=0;f<this._allachieveary.length;f++){if(this._allachieveary[f].type!=c){c=this._allachieveary[f].type;var g=new b;g.state=1,g.id=c,g.name="T1_"+c,g.isredpoint=this.isredpointByOne(c),a==c?g.selecteds=!0:g.selecteds=!1,e.push(g)}if(a==this._allachieveary[f].type&&this._allachieveary[f].stype!=d){d=this._allachieveary[f].stype;var g=new b;g.state=2,g.id=d,g.name="T1_"+c+"_"+d,this.setAry(g,this._allachieveary[f].type,this._allachieveary[f].stype),g.isredpoint=this.isredpointBytwo(g.data),e.push(g)}}return e},a.prototype.setAry=function(a,b,c){for(var d=new Array,e=new Array,f=new Array,g=0;g<this._allachieveary.length;g++)if(this._allachieveary[g].type==b&&this._allachieveary[g].stype==c){var h=GuidData.quest.getAchieveInfo(this._allachieveary[g].id);h.data=this._allachieveary[g],h.hasReach&&h.hasReward&&d.push(h),h.hasReach&&!h.hasReward&&e.push(h),h.hasReach||f.push(h)}var i=e.concat(f,d);return a.data=i,i},a.prototype.getFirstList=function(){for(var a=1,c=1,d=0;d<this._allachieveary.length;d++){var e=GuidData.quest.getAchieveInfo(this._allachieveary[d].id);if(e.data=this._allachieveary[d],e.hasReach&&!e.hasReward){a=this._allachieveary[d].type,c=this._allachieveary[d].stype;break}}return this.setAry(new b,a,c)},a.prototype.getListBy2Type=function(a,c){return this.setAry(new b,a,c)},a.prototype.isredpointByOne=function(a){for(var b=0;b<this._allachieveary.length;b++)if(this._allachieveary[b].type==a){var c=GuidData.quest.getAchieveInfo(this._allachieveary[b].id);if(c.hasReach&&!c.hasReward)return!0}return!1},a.prototype.isredpointBytwo=function(a){for(var b=0;b<a.length;b++)if(a[b].hasReach&&!a[b].hasReward)return!0;return!1},a.prototype.getListByTab=function(a){for(var b=new Array,c=0;c<this._alltitleary.length;c++)if(this._alltitleary[c].type==a){var e=new d;e.data=this._alltitleary[c],b.push(e)}for(var f=new Array,g=new Array,c=0;c<b.length;c++){var h=this.obtainTitle(b[c]);h.isObtain?(b[c].time=h.time,h.init?b[c].state=3:b[c].state=2,f.push(b[c])):g.push(b[c])}f=this.SortByQualityDESC(f);var i=GuidData.player.getTitleID();if(0!=i){var j=tb.TB_title_base.get_TB_title_baseById(i);if(j.type==a)for(var c=0;c<f.length;c++)if(i==f[c].data.id){var k=f[c];k.state=4,f.splice(c,1),f.splice(0,0,k)}}return g=this.SortByQualityASC(g),f.concat(g)},a.prototype.SortByQualityDESC=function(a){return a.sort(function(a,b){return a.data.qua==b.data.qua?b.data.id-a.data.id:b.data.qua-a.data.qua}),a},a.prototype.SortByQualityASC=function(a){return a.sort(function(a,b){return a.data.qua==b.data.qua?a.data.id-b.data.id:a.data.qua-b.data.qua}),a},a.prototype.obtainTitle=function(a){var b=GuidData.quest.getTitleList(),c=new e;if(b)for(var d=0;d<b.length;d++)b[d].id==a.data.id&&(c.isObtain=!0,c.init=b[d].init,c.time=b[d].time);return c},a}();a.RoleModel=f}(role||(role={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),role;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"RoleUiModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.RoleUiModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_ROLE_EVENT="SHOW_ROLE_EVENT",b.HIDE_ROLE_EVENT="HIDE_ROLE_EVENT",b.Achievement_SELECT_TAB_EVENT="Achievement_SELECT_TAB_EVENT",b.Achievement_VIEW_ITEM_EVENT="Achievement_VIEW_ITEM_EVENT",b.Achievement_RECEIVE_EVENT="Achievement_RECEIVE_EVENT",b.CHANGE_NAME_EVENT="CHANGE_NAME_EVENT",b.NAME_CHG_EVENT="NAME_CHG_EVENT",b.TITLE_FORCE_CHG_EVENT="TITLE_FORCE_CHG_EVENT",b.SHOWVIEW_Designation_EVENT="SHOWVIEW_Designation_EVENT",b.CHANGE_MY_Designation_EVENT="CHANGE_MY_Designation_EVENT",b.INIT_Designation_EVENT="INIT_Designation_EVENT",b}(BaseEvent);a.RoleUiEvent=c;var d=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a._nodeInit=!1,a._type=-2,a._stype=-2,a}return __extends(d,b),d.prototype.getName=function(){return"TreasureProcessor"},d.prototype.receivedModuleEvent=function(a){if(this.processRedPoint(),a instanceof c){var b=a;console.log("---变化type---",b.type),b.type==c.SHOW_ROLE_EVENT?this.showUi():b.type==c.HIDE_ROLE_EVENT?this.hideUi():b.type==c.Achievement_SELECT_TAB_EVENT?this.selectTab(b.data):b.type==c.Achievement_VIEW_ITEM_EVENT?this.viewItem(b.data):b.type==c.Achievement_RECEIVE_EVENT?this.receive():b.type==c.CHANGE_NAME_EVENT?this.showchangenamePanel():b.type==c.NAME_CHG_EVENT?this.chgname():b.type==c.TITLE_FORCE_CHG_EVENT?this.titleforcechg():b.type==c.SHOWVIEW_Designation_EVENT?this.showrightview(b.data):b.type==c.INIT_Designation_EVENT?this.initData():b.type==c.CHANGE_MY_Designation_EVENT&&this.selectdatatoindex()}else a.type==EngineEvent.PLAYER_EXPAND_INT_XP?this.setexp():a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT?this.initRedNode():a.type==EngineEvent.MONEY_CHANGE||a.type==EngineEvent.SYSTEM_OPEN_EVENT?this.processRedPoint():a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT&&this.processRedPoint();if(a instanceof UIPanelEvent){var d=a;d.panel==this._roleUiPanel&&(this.disposenode(),this._roleUiPanel.dispose(),this._roleUiPanel=null,console.log("释放面板 _roleUiPanel")),d.panel==this._changenamePanel&&(this._changenamePanel.dispose(),this._changenamePanel=null,console.log("释放面板 _changenamePanel"))}},d.prototype.disposenode=function(){for(var a=RedPointManager.getInstance().getNodeByID(12).children,b=0;b<a.length;b++)a[b].unBind();for(var c=RedPointManager.getInstance().getNodeByID(115).children,b=0;b<c.length;b++)c[b].unBind()},d.prototype.initRedNode=function(){if(!this._nodeInit){for(var b=RedPointManager.getInstance().getNodeByID(12),c=a.RoleModel.getInstance().getListByTab(a.TabKey.TabAction),d=0;d<c.length;d++){var e=new RedPointNode;e.data=c[d],b.addChild(e)}for(var f=RedPointManager.getInstance().getNodeByID(115),g=a.RoleModel.getInstance().getListByTab(a.TabKey.Tabdesignation),d=0;d<g.length;d++){var e=new RedPointNode;e.data=g[d],f.addChild(e)}this._nodeInit=!0,this.processRedPoint()}},d.prototype.processRedPoint=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_ROLE,SharedDef.MODULE_ROLE_ACHIEVE)){var b=RedPointManager.getInstance().getNodeByID(7),c=a.RoleModel.getInstance().getFirstList();b.show=!1;for(var d=0;d<c.length;d++){var e=c[d];if(e.hasReach&&!e.hasReward){b.show=!0;break}}}if(GuidData.player.getsyspageopen(SharedDef.MODULE_ROLE,SharedDef.MODULE_ROLE_TITLE)){for(var f=a.RoleModel.getInstance().getListByTab(a.TabKey.TabAction),g=RedPointManager.getInstance().getNodeByID(12).children,h=0;h<g.length;h++)g[h].data=f[h],this.chgState(g[h]);for(var i=a.RoleModel.getInstance().getListByTab(a.TabKey.Tabdesignation),j=RedPointManager.getInstance().getNodeByID(115).children,k=0;k<j.length;k++)j[k].data=i[k],this.chgState(j[k])}},d.prototype.chgState=function(a){var b=a.data;2==b.state?a.show=!0:1==b.state?(a.show=!1,1!=b.data.unlock_type&&hasEnoughResItem(b.data.unlock_cost[0])&&(a.show=!0)):a.show=!1},d.prototype.setexp=function(){this._roleUiPanel&&this._roleUiPanel.attributeUiPanel&&this._roleUiPanel.attributeUiPanel.hasStage&&this._roleUiPanel.attributeUiPanel.setEXP()},d.prototype.selectdatatoindex=function(){console.log("===来消息了"),this._roleUiPanel&&this._roleUiPanel.designationPanel&&this._roleUiPanel.designationPanel.gdesignationList&&this._roleUiPanel.designationPanel.gdesignationList.hasStage&&this._roleUiPanel.designationPanel.gdesignationList.selectDataToIndex()},d.prototype.initData=function(){this._roleUiPanel&&this._roleUiPanel.designationPanel&&this._roleUiPanel.designationPanel.gdesignationList&&this._roleUiPanel.designationPanel.gdesignationList.hasStage&&this._roleUiPanel.designationPanel.gdesignationList.selectDataToIndex()},d.prototype.showrightview=function(a){this._roleUiPanel&&this._roleUiPanel.designationPanel&&this._roleUiPanel.designationPanel.hasStage&&this._roleUiPanel.designationPanel.resetData(a.data)},d.prototype.titleforcechg=function(){this._roleUiPanel&&this._roleUiPanel.designationPanel&&this._roleUiPanel.designationPanel.hasStage&&this._roleUiPanel.designationPanel.setAllForce()},d.prototype.chgname=function(){this._roleUiPanel&&this._roleUiPanel.attributeUiPanel&&this._roleUiPanel.attributeUiPanel.hasStage&&this._roleUiPanel.attributeUiPanel.setRolemsg()},d.prototype.selectTab=function(a){var b=a.data;1==b.state&&this._roleUiPanel&&this._roleUiPanel.achievementPanel&&this._roleUiPanel.achievementPanel.achievementTabList&&this._roleUiPanel.achievementPanel.achievementTabList.hasStage&&(b.selecteds?this._roleUiPanel.achievementPanel.achievementTabList.refreshDataByNewData(-1):this._roleUiPanel.achievementPanel.achievementTabList.refreshDataByNewData(b.id)),2==b.state&&(this.viewItem(b.data),this._type=b.data[0].data.type,this._stype=b.data[0].data.stype)},d.prototype.viewItem=function(a){this._roleUiPanel&&this._roleUiPanel.achievementPanel&&this._roleUiPanel.achievementPanel.achievementList&&this._roleUiPanel.achievementPanel.achievementList.show(a)},d.prototype.receive=function(){if(this._roleUiPanel&&this._roleUiPanel.achievementPanel&&this._roleUiPanel.achievementPanel.achievementTabList&&this._roleUiPanel.achievementPanel.achievementTabList.hasStage){this._roleUiPanel.achievementPanel.achievementTabList.refreshDataByNewData();var b;b=-2==this._type&&-2==this._stype?a.RoleModel.getInstance().getFirstList():a.RoleModel.getInstance().getListBy2Type(this._type,this._stype),this.viewItem(b)}},d.prototype.hideUi=function(){this._roleUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(){var b=this;this._roleUiPanel||(this._roleUiPanel=new a.RoleUiPanel),this._roleUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b._roleUiPanel.show()})},d.prototype.showchangenamePanel=function(){var b=this;this._changenamePanel||(this._changenamePanel=new a.changenamePanel),this._changenamePanel.load(function(){b._changenamePanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_ROLE_EVENT),new c(c.HIDE_ROLE_EVENT),new c(c.Achievement_SELECT_TAB_EVENT),new c(c.Achievement_VIEW_ITEM_EVENT),new c(c.Achievement_RECEIVE_EVENT),new c(c.CHANGE_NAME_EVENT),new c(c.NAME_CHG_EVENT),new c(c.TITLE_FORCE_CHG_EVENT),new c(c.SHOWVIEW_Designation_EVENT),new c(c.CHANGE_MY_Designation_EVENT),new c(c.INIT_Designation_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.PLAYER_EXPAND_INT_XP),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT)]},d}(BaseProcessor);a.RoleProcessor=d}(role||(role={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),role;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._publicbguiRender=new UIRenderComponent,a.addRender(a._publicbguiRender),a._roleRender=new UIRenderComponent,a.addRender(a._roleRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._roleRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._roleRender.dispose(),this._roleRender=null,this._redPointRender.dispose(),this._redPointRender=null,this.achievementPanel&&(this.achievementPanel.dispose(),this.achievementPanel=null),this.attributeUiPanel&&(this.attributeUiPanel.dispose(),this.attributeUiPanel=null),this.designationPanel&&(this.designationPanel.dispose(),this.designationPanel=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._publicbguiRender.uiAtlas=WindowUi.winUIAtlas,this._roleRender.uiAtlas.setInfo("ui/uidata/role/newrole.xml","ui/uidata/role/newrole.png",function(){a.loadConfigCom()},"ui/uidata/role/newrolepc.png")},c.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._roleRender.uiAtlas,this.winmidRender.uiAtlas=this._publicbguiRender.uiAtlas,this.initData(),this.applyLoadComplete()},c.prototype.initData=function(){this.addChild(this._bgRender.getComponent("t_title"));var a=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(a,"rightLinebg",this._roleRender),this.tab0UiAry=new Array;var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg_top"));this.tab0UiAry.push(b);var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg_bottom"));this.tab0UiAry.push(c),this.a_tab2=this.addEvntBut("tab2",this._roleRender),this.a_tab1=this.addEvntBut("tab1",this._roleRender),this.a_tab0=this.addEvntBut("tab0",this._roleRender),this._redPointRender.getRedPointUI(this,7,new Vector2D(this.a_tab1.x+this.a_tab1.width-5,this.a_tab1.y)),this._redPointRender.getRedPointUI(this,10,new Vector2D(this.a_tab2.x+this.a_tab2.width-5,this.a_tab2.y)),this.addChild(this._roleRender.getComponent("t_line"))},c.prototype.selecttype=function(a){this.setUiListVisibleByItem(this.tab0UiAry,1!=a),0==a?(this.a_tab0.selected=!0,this.a_tab1.selected=!1,this.a_tab2.selected=!1,this.showTab0pnael(),this.setSizeForPanelUiCopy(this.tab0UiAry[0],"b_right_bg_top",this._roleRender),this.setSizeForPanelUiCopy(this.tab0UiAry[1],"b_right_bg_bottom",this._roleRender)):1==a?(this.a_tab1.selected=!0,this.a_tab0.selected=!1,this.a_tab2.selected=!1,this.showTab1pnael()):(this.a_tab2.selected=!0,this.a_tab0.selected=!1,this.a_tab1.selected=!1,this.showTab2pnael(),this.setSizeForPanelUiCopy(this.tab0UiAry[0],"b_right_bg_top1",this._roleRender),this.setSizeForPanelUiCopy(this.tab0UiAry[1],"b_right_bg_bottom1",this._roleRender)),this.winmidRender.applyObjData(),this.resize()},c.prototype.showTab0pnael=function(){this.attributeUiPanel||(this.attributeUiPanel=new a.AttributeUiPanel,this.attributeUiPanel.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas)),this.attributeUiPanel.show(),this.achievementPanel&&this.achievementPanel.hide(),this.designationPanel&&this.designationPanel.hide()},c.prototype.showTab1pnael=function(){this.achievementPanel||(this.achievementPanel=new a.AchievementPanel,this.achievementPanel.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas)),this.achievementPanel.show(),this.attributeUiPanel&&this.attributeUiPanel.hide(),this.designationPanel&&this.designationPanel.hide()},c.prototype.showTab2pnael=function(){this.designationPanel||(this.designationPanel=new a.DesignationPanel,this.designationPanel.initUiAtlas(this._roleRender.uiAtlas,this._publicbguiRender.uiAtlas)),this.designationPanel.show(),this.achievementPanel&&this.achievementPanel.hide(),this.attributeUiPanel&&this.attributeUiPanel.hide()},c.prototype.hidealltab=function(){this.achievementPanel&&this.achievementPanel.hide(),this.attributeUiPanel&&this.attributeUiPanel.hide(),this.designationPanel&&this.designationPanel.hide()},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.selecttype(0),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.hidealltab(),ModulePageManager.hideResTittle()},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.RoleUiEvent(a.RoleUiEvent.HIDE_ROLE_EVENT));break;case this.a_tab0:this.selecttype(0);break;case this.a_tab1:this.selecttype(1);break;case this.a_tab2:this.selecttype(2)}},c}(WindowUi);a.RoleUiPanel=b}(role||(role={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),boss;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"BossModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.BossModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_BOSS_PANEL_EVENT="show_boss_panel_event",b.HIDE_BOSS_PANEL_EVENT="hide_boss_panel_event",b.SHOW_BOSSHP_EVENT="show_bosshp_event",b.HIDE_BOSSHP_EVENT="hide_bosshp_event",b.SHOW_CHEST_EVENT="show_chest_event",b.HIDE_CHEST_EVENT="hide_chest_event",b.BOSS_HP_CHANGE_EVENT="boss_hp_change_event",b.CHEST_CHANGE_EVENT="chest_change_event",b.SHOW_OFTENRANK_PANEL="SHOW_OFTENRANK_PANEL",b.HIDE_OFTENRANK_PANEL="HIDE_OFTENRANK_PANEL",b.SHOW_BOSSVIEW_PANEL="SHOW_BOSSVIEW_PANEL",b}(BaseEvent);a.BossEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"BossProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_BOSS_PANEL_EVENT||b.type==c.HIDE_BOSS_PANEL_EVENT||(b.type==c.SHOW_BOSSHP_EVENT?this.showHp(b.data):b.type==c.HIDE_BOSSHP_EVENT?this.hideHp():b.type==c.BOSS_HP_CHANGE_EVENT?this.refreshHp(b.data):b.type==c.SHOW_CHEST_EVENT||b.type==c.HIDE_CHEST_EVENT||b.type==c.CHEST_CHANGE_EVENT||(b.type==c.SHOW_OFTENRANK_PANEL?this.showrank(Boolean(b.data)):b.type==c.HIDE_OFTENRANK_PANEL?this.hiderank():b.type==c.SHOW_BOSSVIEW_PANEL&&this.showBossView(b.data)))}},d.prototype.showwindowRank=function(a){var b=this,c=new s2c_show_faction_bossdefense_damage_list;s2c_show_faction_bossdefense_damage_list.read(c,a),this._rankPanle||(this._rankPanle=new WindowRankPanel);for(var d=-1,e=new Array,f=0;f<c.list.length;f++){var g=c.list[f],h=new WindowRankVo,i=g.name;i&&(h.rank=String(f+1),h.val=String(g.dam),h.name=getBaseName(i),e.push(h)),g.name==GuidData.player.getName()&&(d=Number(h.rank))}var j;j=d>0?"我的排名："+d:"我的排名：未上榜",this._rankPanle.load(function(){b._rankPanle.show(["排名","玩家名字","输出"],e,j)})},d.prototype.showBossView=function(b){var c=this;this._bossViewPanel||(this._bossViewPanel=new a.BossViewPanel),this._bossViewPanel.load(function(){c._bossViewPanel.show(b);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=901,ModuleEventManager.dispatchEvent(a)})},d.prototype.showrank=function(b){var c=this;this.bossRankPanel||(this.bossRankPanel=new a.BossRankPanel),this.bossRankPanel.hasStage&&b?this.bossRankPanel.hide():this.bossRankPanel.load(function(){c.bossRankPanel.show(b)},!1)},d.prototype.hiderank=function(){console.log("---隐藏--"),this.bossRankPanel&&this.bossRankPanel.hide()},d.prototype.showHp=function(a){var b=this;this._bossHpPanel||(this._bossHpPanel=new BossHpPanel),this._bossHpPanel.load(function(){UIManager.getInstance().addUIContainer(b._bossHpPanel),b._bossHpPanel.initUnitData(a)},!1)},d.prototype.hideHp=function(){this._bossHpPanel&&UIManager.getInstance().removeUIContainer(this._bossHpPanel)},d.prototype.refreshHp=function(a){this._bossHpPanel&&(a.num<=0?this.hideHp():this._bossHpPanel.setHp(a.num,a.id))},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_BOSS_PANEL_EVENT),new c(c.HIDE_BOSS_PANEL_EVENT),new c(c.SHOW_BOSSHP_EVENT),new c(c.HIDE_BOSSHP_EVENT),new c(c.SHOW_CHEST_EVENT),new c(c.HIDE_CHEST_EVENT),new c(c.BOSS_HP_CHANGE_EVENT),new c(c.CHEST_CHANGE_EVENT),new c(c.SHOW_OFTENRANK_PANEL),new c(c.HIDE_OFTENRANK_PANEL),new c(c.SHOW_BOSSVIEW_PANEL)]},d.prototype.smsg_world_boss_rank=function(a){var b=new s2c_boss_rank;s2c_boss_rank.read(b,a),this.bossRankPanel&&this.bossRankPanel.hasStage&&this.bossRankPanel.setRankData(b),this._bossHpPanel&&this._bossHpPanel.showRankBut(!0)},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_BOSS_RANK]=function(b){a.smsg_world_boss_rank(b)},b[Protocols.SMSG_SHOW_FACTION_BOSSDEFENSE_DAMAGE_LIST]=function(b){a.showwindowRank(b)},b},d}(BaseProcessor);a.BossProcessor=d}(boss||(boss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),BossHpPanel=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.hpcur=1,b.hptabelNum=2,b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.top=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._topRender.uiAtlas=new UIAtlas,this._topRender.uiAtlas.setInfo("ui/uidata/boss/bosshp/bosshp.xml","ui/uidata/boss/bosshp/bosshp.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_hp_bg")),this.a_boss_name=this.addChild(this._topRender.getComponent("a_boss_name")),this.a_boss_lev=this.addChild(this._topRender.getComponent("a_boss_lev")),this.a_rank_but=this.addEvntBut("a_rank_but",this._topRender),this.a_hp_loop_num=this.addChild(this._topRender.getComponent("a_hp_loop_num")),this.a_hp_loop_num.goToAndStop(5),this.a_hp_loop_x=this.addChild(this._topRender.getComponent("a_hp_loop_x")),this.a_mide_hp_bg=this.addChild(this._bottomRender.getComponent("a_hp_bar")),this.a_hp_bar=this.addChild(this._midRender.getComponent("a_hp_bar")),this.uiAtlasComplet=!0,this.applyLoadComplete(),this.refresh()},b.prototype.butClik=function(a){if(a.target==this.a_rank_but){var b=new boss.BossEvent(boss.BossEvent.SHOW_OFTENRANK_PANEL);b.data=!0,ModuleEventManager.dispatchEvent(b)}},b.prototype.initUnitData=function(a){LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_boss_name.skinName,ColorType.Yellowffe9b4+a.getName(),15),LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_boss_lev.skinName,ColorType.Yellowffe9b4+" Lv:"+a.getLevel(),15),this.showRankBut(!1)},b.prototype.setHp=function(a,b){this.hpcur=a,tb.TB_creature_template.get_TB_creature_template(b)&&(this.hptabelNum=tb.TB_creature_template.get_TB_creature_template(b).hp_num),this.refresh()},b.prototype.showRankBut=function(a){this.setUiListVisibleByItem([this.a_rank_but],a)},b.prototype.refresh=function(){if(this.uiAtlasComplet){var a=Math.ceil(this.hpcur*this.hptabelNum);a=Math.max(0,a),a=Math.min(this.hptabelNum,a),this.a_hp_loop_num.goToAndStop(a);var b=this.hptabelNum-a;if(this.a_hp_bar.goToAndStop(b%5),this.a_mide_hp_bg.goToAndStop((b+1)%5),this.hpcur<1/this.hptabelNum&&this.a_mide_hp_bg.goToAndStop(5),this.hpcur<=0)return void this.a_hp_bar.goToAndStop(5);var c=(this.hpcur-(this.hptabelNum-1-b)/this.hptabelNum)/(1/this.hptabelNum);c=Math.max(c,.001),c=Math.min(c,1),c<this.a_hp_bar.uvScale?TweenMoveTo(this.a_hp_bar,.1,{uvScale:c}):this.a_hp_bar.uvScale=c}},b}(UIPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),boss;!function(a){var b=function(){function a(){}return a}();a.BossRankCellVo=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this.RankCell_txt=this.creatSUI(e,b.baseAtlas,"RankCell_txt",0,0,210,22),c.addChild(this.RankCell_txt)},b.prototype.applyrender=function(){var a=this.itdata.data,b="    ";b+=String(a.rankid)+"     ",b+=getBaseName(a.name)+"     ",b+=a.ratio+"%";var c="ffe9b4";switch(a.rankid){case 1:c="[ffe400]";break;case 2:c="[d3ecff]";break;case 3:c="[dd6d29]";break;default:c="[ffe9b4]"}LabelTextFont.writeSingleLabel(this.uiAtlas,this.RankCell_txt.skinName,b,14,TextAlign.LEFT,c)},b.prototype.render=function(a){this.itdata=a,a?this.applyrender():this.setnull()},b.prototype.equClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){var b=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);b.id=a.target.data,ModuleEventManager.dispatchEvent(b)}},b.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.RankCell_txt.skinName)},b}(SListItem);a.BossRankRender=c;var d=function(a){function d(){var b=a.call(this)||this;return b.center=220,b.top=80,b}return __extends(d,a),d.prototype.init=function(a){c.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,c,210,160,210,20,8,256,256,1,10)},d.prototype.refreshDataByNewData=function(){},d.prototype.getFamilyBossRankData=function(){for(var a=new Array,c=faction.FactionBossModel.getInstance().getRankList(GuidData.faction.getBosschallengeidCur()),d=0;d<c.length;d++){var e=new SListItemData,f=new b;f.rankid=c[d].rankid,f.name=c[d].name,f.ratio=c[d].ratio,e.data=f,e.id=d,a.push(e)}return a},d.prototype.getMassBossRankData=function(){for(var a=new Array,c=0;5>c;c++){var d=new SListItemData,e=new b;e.rankid=c+1,e.name="ccavet",e.ratio=10,d.data=e,d.id=c,a.push(d)}return a},d.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},d.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData(),this.setSelectIndex(0)},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.BossRankList=d;var e=function(a){function c(){var b=a.call(this)||this;return b.mineNum=-1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.top=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topRender.uiAtlas=new UIAtlas,b._frameFun=function(a){b.upTime(a)},b}return __extends(c,a),c.prototype.applyLoad=function(){var a=this;this._topRender.uiAtlas.setInfo("ui/uidata/boss/oftenrank/oftenrank.xml","ui/uidata/boss/oftenrank/oftenrank.png",function(){a.loadConfigCom()},"ui/uidata/faction/factionpc.png")},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas,this.addEvntBut("a_list_bg",this._bottomRender),this.addChild(this._topRender.getComponent("a_bottom_line")),this.addChild(this._topRender.getComponent("a_top_line")),this.a_self_tip=this.addChild(this._topRender.getComponent("a_self_tip")),this.bossRankList=new d,this.bossRankList.init(this._midRender.uiAtlas),this.applyLoadComplete()},c.prototype.hide=function(){this.bossRankList&&this.bossRankList.hide(),UIManager.getInstance().removeUIContainer(this)},c.prototype.show=function(a){var b=this;UIManager.getInstance().addUIContainer(this),this.bossRankList.show(),TimeUtil.addFrameTick(this._frameFun),a||TimeUtil.addTimeOut(5e3,function(){b.hide()})},c.prototype.refreshOwn=function(){var a="";a=-1==this.mineNum?"暂时没有上榜单":this.mineNum+1+"  "+getBaseName(GuidData.player.getName()),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_self_tip.skinName,a,14,TextAlign.CENTER,ColorType.Greenadff00)},c.prototype.setRankData=function(a){for(var c=new Array,d=0;d<a.rankList.length;d++){var e=new SListItemData,f=new b;f.rankid=d+1,f.name=a.rankList[d].name,f.ratio=Math.floor(10*a.rankList[d].value)/10,e.data=f,e.id=d,c.push(e)}this.mineNum=a.mine,this.bossRankList.refreshData(c),console.log("更新数据"),this.refreshOwn()},c.prototype.upTime=function(a){if(this.hasStage){var b=Math.floor(TimeUtil.getTimer()/1e3);this._curtime!=b&&(this._curtime=b,console.log("更新",this._curtime),this._curtime=b,this.bossRankList&&this.bossRankList.hasStage&&this.refreshOwn())}else TimeUtil.removeFrameTick(this._frameFun)},c}(UIConatiner);a.BossRankPanel=e}(boss||(boss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),boss;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,
b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._baseUiAtlas=new UIAtlas,b.setBlackBg(),b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/boss/bossview.xml","ui/uidata/boss/bossview.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this.winmidRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this._baseRender.uiAtlas=this._baseUiAtlas,this.addBossChar(),this.uiAtlasComplet=!0,this.initUI(),this.applyLoadComplete()},b.prototype.initUI=function(){this.addUIList(["t_bg1"],this.winmidRender),this.addUIList(["t_name_bg","t_bg3","t_bg2","t_win_title"],this._bgRender);var a=this._baseRender.getComponent("t_drop");this.addChild(a),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"关卡掉落",14,TextAlign.CENTER,ColorType.colorb96d49),this.addChild(this._baseRender.getComponent("t_namebg")),this.mapLab=this._baseRender.getComponent("t_gk"),this.addChild(this.mapLab),this.nameLab=this._baseRender.getComponent("t_name"),this.addChild(this.nameLab),this.bangIcon=this._baseRender.getComponent("t_bang"),this.bangIcon.addEventListener(InteractiveEvent.Down,this.showrankPanel,this),this.submitBtn=this._baseRender.getComponent("t_btn"),this.submitBtn.addEventListener(InteractiveEvent.Up,this.submit,this),this.addChild(this.submitBtn),this.rewardList=new Array;for(var b=0;6>b;b++){var c=this._baseRender.getComponent("t_reward"+b);this.addChild(c),this.rewardList.push(c)}},b.prototype.showrankPanel=function(){this._data&&this._data.rankFun&&this._data.rankFun()},b.prototype.addBossChar=function(){this.bossChar=new MonsterUIChar,this.wintopRender.addModel(this.bossChar)},b.prototype.butClik=function(a){switch(a.target){case this.e_close:ModuleEventManager.dispatchEvent(new adventureinfo.AdventurInfoEvent(adventureinfo.AdventurInfoEvent.ADVENTURE_TRIAL_PROCESS)),this.hide()}},b.prototype.submit=function(a){UiTweenScale.getInstance().changeButSize(a.target),this._data&&this._data.submitFun&&(this._data.submitFun(),this.hide())},b.prototype.refresh=function(){var a=this._data.bossID,b=tb.TB_creature_template.get_TB_creature_template(a),c=b.name;if(this._data.checkpoint&&this._data.checkpoint.length>0&&(c=this._data.checkpoint),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.nameLab.skinName,c,14,TextAlign.CENTER,ColorType.Brown7a2f21),this.bossChar.setAvatar(b.avatar),this._data.showRank?this.bangIcon.parent||this.addChild(this.bangIcon):this.bangIcon.parent&&this.removeChild(this.bangIcon),this._data.force){var d=this._data.force>GuidData.player.getForce()?ColorType.colorce0a00:ColorType.color2daa35;LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.mapLab.skinName,ColorType.color9a683f+"推荐战力："+d+this._data.force,14,TextAlign.CENTER)}else UiDraw.clearUI(this.mapLab);if(this._data.rewardList)for(var e=0;e<this.rewardList.length;e++)this._data.rewardList[e]?IconManager.getInstance().drawItemIcon60(this.rewardList[e],this._data.rewardList[e][0],this._data.rewardList[e][1]):IconManager.getInstance().drawItemIcon60(this.rewardList[e],0,5);else for(var e=0;e<this.rewardList.length;e++)IconManager.getInstance().drawItemIcon60(this.rewardList[e],0,5)},b.prototype.resize=function(){a.prototype.resize.call(this),this.bossChar&&(this.bossChar.scale=1.5*UIData.Scale,this.bossChar.x=0*UIData.Scale,this.bossChar.y=-20*UIData.Scale,this.bossChar.resize())},b.prototype.drawReward=function(){},b.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),this._data=a,this.refresh()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this._data.rankFun=null,this._data.submitFun=null,this._data=null},b}(WindowMinUi);a.BossViewPanel=b;var c=function(){function a(){}return a}();a.BossViewData=c}(boss||(boss={}));var boss;!function(a){var b=function(){function b(){}return b.frameUpData=function(){if(GuidData.map.isBaseMap&&this.nextCatchTime<TimeUtil.getTimer()){for(var b=GameInstance.roleList,c=!0,d=!0,e=0;b&&e<b.length;e++){var f=b[e];if(f.isBoss){if(Math.abs(f.x-GameInstance.mainChar.x)<100&&Math.abs(f.z-GameInstance.mainChar.z)<100){if(f!=this._boss){var g=new a.BossEvent(a.BossEvent.SHOW_BOSSHP_EVENT);g.data=f.unit,ModuleEventManager.dispatchEvent(g),f.refreshLifeNum(),this._boss=f,this.showhidePandaPanel(!1),GuidData.map.isFamilyScene()&&ModuleEventManager.dispatchEvent(new a.BossEvent(a.BossEvent.SHOW_OFTENRANK_PANEL))}c=!1}}else if(f instanceof SceneCollection){var h=f;if(h.isBx()){if(Math.abs(f.x-GameInstance.mainChar.x)<100&&Math.abs(f.z-GameInstance.mainChar.z)<100){if(h!=this._bx){var i=h.getBossInfo(!0),g=new a.BossEvent(a.BossEvent.SHOW_CHEST_EVENT);g.data=i,ModuleEventManager.dispatchEvent(g),this._bx=h,this.showhidePandaPanel(!1)}d=!1}Math.abs(f.x-GameInstance.mainChar.x)<50&&Math.abs(f.z-GameInstance.mainChar.z)<50?h.setOprateState(!0):h.setOprateState(!1)}}}if(this._boss&&c&&(console.log("---隐藏222--",GuidData.map.isFamilyScene()),GuidData.map.isFamilyScene()&&ModuleEventManager.dispatchEvent(new a.BossEvent(a.BossEvent.HIDE_OFTENRANK_PANEL)),ModuleEventManager.dispatchEvent(new a.BossEvent(a.BossEvent.HIDE_BOSSHP_EVENT)),this._boss=null,this.showhidePandaPanel(!0)),this._bx&&d){var g=new a.BossEvent(a.BossEvent.HIDE_CHEST_EVENT);ModuleEventManager.dispatchEvent(g),this._bx=null,this.showhidePandaPanel(!0)}this.nextCatchTime=TimeUtil.getTimer()+1e3}},b.showhidePandaPanel=function(a){var b=new topui.TopUiEvent(topui.TopUiEvent.SHOW_TOP_PANDA_LIST);b.data=a,ModuleEventManager.dispatchEvent(b)},b.nextCatchTime=0,b}();a.BossModel=b}(boss||(boss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),sboss;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){var f=this;void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);var g=this._customRenderAry[0];this.S_BG=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"S_BG",0,0,222,87,8,8),a.addChild(this.S_BG),this.S_BG.addEventListener(InteractiveEvent.Up,this.butClik,this),this.S_ICON=this.creatSUI(d,this.parentTarget.baseAtlas,"S_ICON",8,8,68,68),a.addChild(this.S_ICON),this.S_NAME=this.creatSUI(d,this.parentTarget.baseAtlas,"S_NAME",85,12,120,18),a.addChild(this.S_NAME),this.S_LEVEL=this.creatSUI(d,this.parentTarget.baseAtlas,"S_LEVEL",85,36,120,18),a.addChild(this.S_LEVEL),this.S_TIME=this.creatSUI(d,this.parentTarget.baseAtlas,"S_TIME",85,57,120,18),a.addChild(this.S_TIME),this.Redpoint=this.creatSUI(g,this.parentTarget.baseAtlas,"S_REDPOINT",205,1,17,16),this.Redpoint.preParent=a,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Redpoint.skinName,UIData.publicUi,PuiData.A_RED_POINT),this.upDataFun=function(a){f.update(a)}},c.prototype.update=function(a){this.parentTarget.hasStage?this.drawTimeInfo():TimeUtil.removeFrameTick(this.upDataFun)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.applyRender(),b){var c=new a.SbossEvent(a.SbossEvent.PBOSS_REFRISH_PANEL);c.data=this.itdata.data,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.applyRender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data,b=tb.TB_creature_template.get_TB_creature_template(a.tabbossinfo.bossEntry);a.node&&a.node.bindUI(this.Redpoint),this.loadIcon(String(b.avatar)),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.S_BG.skinName,UIData.publicUi,this.selected?PuiData.Slist_select:PuiData.Slist_nselect);var c;a.openstate?(c=ColorType.Orange853d07+b.name,LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_LEVEL.skinName,ColorType.Orange853d07+"等级:"+a.tabbossinfo.permitLevel,14,TextAlign.LEFT)):(c=ColorType.colorb96d49+b.name,LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_LEVEL.skinName,ColorType.colorb96d49+a.tabbossinfo.permitLevel+"级解锁",16,TextAlign.LEFT)),LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_NAME.skinName,c,16,TextAlign.LEFT)}},c.prototype.drawTimeInfo=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;if(a.openstate){var b=ColorType.Brown7a2f21+"剩余次数:"+a.getTims();b!=this.lastTmStr&&(LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_TIME.skinName,b,14,TextAlign.LEFT),this.lastTmStr=b)}else UiDraw.clearUI(this.S_TIME)}},c.prototype.loadIcon=function(a){var b=this;IconManager.getInstance().getIcon(getRoleIconUrl(a),function(a){var c=b.uiAtlas.getRec(b.S_ICON.skinName);b.uiAtlas.ctx=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),UiDraw.cxtDrawImg(b.uiAtlas.ctx,PuiData.SKILL_BG68,new Rectangle(0,0,c.pixelWitdh,c.pixelHeight),UIData.publicUi),b.uiAtlas.ctx.drawImage(a,3,3,c.pixelWitdh-6,c.pixelHeight-6),TextureManager.getInstance().updateTexture(b.uiAtlas.texture,c.pixelX,c.pixelY,b.uiAtlas.ctx)})},c.prototype.render=function(a){this.itdata=a,a&&a.data?(TimeUtil.removeFrameTick(this.upDataFun),TimeUtil.addFrameTick(this.upDataFun),this.lastTmStr="",this.applyRender()):this.setnull()},c.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.S_BG.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_ICON.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_NAME.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_LEVEL.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_TIME.skinName),this.Redpoint.preHide()},c.prototype.butClik=function(a){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;this.setSelect()}},c}(SListItem);a.PbossLeftListRender=b;var c=function(c){function d(){var a=c.call(this)||this;return a.left=325,a.top=149,a}return __extends(d,c),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,b,225,435,225,87,5,256,1024,1,7,1)},d.prototype.resetData=function(){for(var b=a.SbossModel.getInstance().getPersonBossItemData(),c=RedPointManager.getInstance().getNodeByID(119).children,d=0;d<b.length;d++)c[d].data=b[d].data,b[d].data.node=c[d];this.refreshData(b)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData();var a=this.getCurrentSelectIndex();this.scrollIdx(a),this.setSelectIndex(a)},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.PbossLeftList=c;var d=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b._frameFun=function(a){b.upTime(a)},b}return __extends(b,a),b.prototype.setRender=function(a,b){this._bottomRender.uiAtlas=a,this._midRender.uiAtlas=a,this._topRender.uiAtlas=a,this._winRender=b,this.loadConfigCom()},b.prototype.upTime=function(a){if(!this.hasStage)return void TimeUtil.removeFrameTick(this._frameFun);if(this.selectVo&&this.selectVo.openstate){var b=this.selectVo.getTime();""!=b&&(b=ColorType.Redd92200+b+ColorType.Brown7a2f21+"恢复挑战次数"),b!=this.lastCdStr&&(LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_cd_label.skinName,b,14,TextAlign.CENTER),this.lastCdStr=b)}else UiDraw.clearUI(this.a_cd_label)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.pbossleftList.show(),TimeUtil.addFrameTick(this._frameFun)},b.prototype.hide=function(){this.pbossleftList.hide(),UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.e_tiaozhan:this.tiaozhanBoss();break;case this.e_leftbtn:this._curpage=Math.max(1,--this._curpage),this.drawReward(),this.setPage();break;case this.e_rightbtn:this._curpage=Math.min(this._maxpage,++this._curpage),this.drawReward(),this.setPage();break;case this.e_selbtn:GameData.configData.setopen_prompting_pboss(this.selectVo.tabbossinfo.id-1,this.e_selbtn.selected)}},b.prototype.tiaozhanBoss=function(){var a=this;this.selectVo&&this.selectVo.openstate&&(this.selectVo.hasTims()>0?this.selectVo.tabbossinfo.force>GuidData.player.getForce()?AlertUtil.show(ColorType.Brown7a2f21+"当前您的战斗力"+ColorType.colorcd2000+GuidData.player.getForce()+ColorType.Brown7a2f21+"低于BOSS战斗力"+this.selectVo.tabbossinfo.force+"\n挑战会受到影响，该BOSS属性会大幅增加\n是否进行挑战？","提示",function(b){1==b&&NetManager.getInstance().protocolos.enter_private_boss(a.selectVo.tabbossinfo.id)},2,["前往挑战","取消"]):NetManager.getInstance().protocolos.enter_private_boss(this.selectVo.tabbossinfo.id):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"挑战次数不足",99))},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addUIList(["e_reward_r","e_reward_c","e_reward_l"],this._bottomRender),this.addUIList(["e_rewardtitle"],this._midRender),this.e_leftbtn=this.addEvntButUp("e_leftbtn",this._midRender),this.e_rightbtn=this.addEvntButUp("e_rightbtn",this._midRender),this.unlockAry=new Array,this.unlockAry.push(this._bottomRender.getComponent("e_right_has_bg0")),this.unlockAry.push(this._midRender.getComponent("e_openinfo")),this.e_tiaozhan=this.addEvntButUp("e_tiaozhan",this._topRender),this.a_cd_label=this.addChild(this._bottomRender.getComponent("e_cd_label")),this.e_selbtn=this.addEvntBut("e_selbtn",this._topRender),this.btnAry=new Array,this.btnAry.push(this.e_tiaozhan),this.btnAry.push(this.a_cd_label),this.btnAry.push(this._midRender.getComponent("e_info")),this.btnAry.push(this.e_selbtn),this.addChild(this._bottomRender.getComponent("e_boss_bg")),this.addChild(this._bottomRender.getComponent("a_list_bg")),this.a_list_pos=this.addChild(this._bottomRender.getComponent("a_list_pos")),this.addChild(this._midRender.getComponent("a_boss_name_bg")),this.addChild(this._midRender.getComponent("e_forcebg")),this.a_boss_name=this.addChild(this._topRender.getComponent("a_boss_name")),this.e_force=this.addChild(this._topRender.getComponent("e_force")),this.rewardIconItem=new Array;for(var a=0;6>a;a++){var b=this.addChild(this._midRender.getComponent("e_reward"+a));this.rewardIconItem.push(b)}this.initList(),this.addBossChar()},b.prototype.selectMeshBossByVo=function(a){this.selectVo=a;var b=tb.TB_creature_template.get_TB_creature_template(a.tabbossinfo.bossEntry);this.bossChar.setAvatar(b.avatar);var c="";b.name.length<=3&&(c+="\n");for(var d=0;d<b.name.length;d++)c+=b.name.substr(d,1),c+="\n";ArtFont.getInstance().writeFontToSkinName(this._topRender.uiAtlas,this.e_force.skinName,String(a.tabbossinfo.force),ArtFont.num56),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_boss_name.skinName,ColorType.colorfef3d7+c,16,TextAlign.LEFT),this._curpage=1,this._maxpage=Math.ceil(a.tabbossinfo.show.length/6),this.drawReward(),this.setPage(),a.openstate?(this.setUiListVisibleByItem(this.unlockAry,!1),this.setUiListVisibleByItem(this.btnAry,!0)):(this.setUiListVisibleByItem(this.unlockAry,!0),this.setUiListVisibleByItem(this.btnAry,!1),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.unlockAry[1].skinName,ColorType.Brown7a2f21+a.tabbossinfo.permitLevel+"级解锁BOSS",16,TextAlign.CENTER)),this.e_selbtn.selected=GameData.configData.getopen_prompting_pboss(a.tabbossinfo.id-1)},b.prototype.drawReward=function(){for(var a=6*(this._curpage-1),b=a;a+6>b;b++)b<this.selectVo.tabbossinfo.show.length?(this.setUiListVisibleByItem([this.rewardIconItem[b%6]],!0),IconManager.getInstance().drawItemIcon60(this.rewardIconItem[b%6],this.selectVo.tabbossinfo.show[b])):this.setUiListVisibleByItem([this.rewardIconItem[b%6]],!1)},b.prototype.setPage=function(){this._curpage==this._maxpage&&1==this._maxpage?this.setUiListVisibleByItem([this.e_leftbtn,this.e_rightbtn],!1):this._curpage<this._maxpage&&1==this._curpage?(this.setUiListVisibleByItem([this.e_leftbtn],!1),this.setUiListVisibleByItem([this.e_rightbtn],!0)):this._curpage==this._maxpage&&1!=this._curpage?(this.setUiListVisibleByItem([this.e_leftbtn],!0),this.setUiListVisibleByItem([this.e_rightbtn],!1)):this.setUiListVisibleByItem([this.e_leftbtn,this.e_rightbtn],!0)},b.prototype.refrishListData=function(){this.pbossleftList.resetData()},b.prototype.addBossChar=function(){this.bossChar=new MonsterUIChar,this._bottomRender.addModel(this.bossChar)},b.prototype.initList=function(){this.pbossleftList=new c,this.pbossleftList.init(this._midRender.uiAtlas)},b.prototype.resize=function(){a.prototype.resize.call(this),this.pbossleftList&&(this.pbossleftList.left=this.a_list_pos.parent.x/UIData.Scale+this.a_list_pos.x+3,this.pbossleftList.top=this.a_list_pos.parent.y/UIData.Scale+this.a_list_pos.y+5),this.bossChar&&(this.bossChar.resize(),this.bossChar.scale=1.8*UIData.Scale,this.bossChar.x=-60*UIData.Scale,this.bossChar.y=-30*UIData.Scale)},b}(UIConatiner);a.PersonBossPanel=d}(sboss||(sboss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),sboss;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,d,e,f){var g=this;void 0===f&&(f=null),b.prototype.create.call(this,a,d,e,f),this.S_BG=this.creatGrid9SUI(d,c.baseAtlas,"S_BG",0,0,222,87,8,8),a.addChild(this.S_BG),this.S_BG.addEventListener(InteractiveEvent.Up,this.butClik,this),this.S_ICON=this.creatSUI(e,c.baseAtlas,"S_ICON",8,8,68,68),a.addChild(this.S_ICON),this.S_KILL_TIP=this.creatSUI(e,c.baseAtlas,"S_KILL_TIP",185,0,35,60),a.addChild(this.S_KILL_TIP),this.S_NAME=this.creatSUI(e,c.baseAtlas,"S_NAME",85,12,120,18),a.addChild(this.S_NAME),this.S_LEVEL=this.creatSUI(e,c.baseAtlas,"S_LEVEL",85,36,120,18),a.addChild(this.S_LEVEL),this.S_TIME=this.creatSUI(e,c.baseAtlas,"S_TIME",85,57,120,18),a.addChild(this.S_TIME),this.upDataFun=function(a){g.update(a)}},c.prototype.update=function(a){this.parentTarget.hasStage?(this.drawTimeInfo(),this.loadIcon()):TimeUtil.removeFrameTick(this.upDataFun)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.applyRender(),b){var c=new a.SbossEvent(a.SbossEvent.SELECT_MESH_BOSS_ID);c.selectMeshBossVo=this.itdata.data,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.applyRender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data,b=tb.TB_creature_template.get_TB_creature_template(a.tb.bossEntry);if(this.selected&&console.log(this.selected,this.itdata.id),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.S_BG.skinName,UIData.publicUi,this.selected?PuiData.Slist_select:PuiData.Slist_nselect),GuidData.player.getLevel()<a.tb.permitLevel)UiDraw.clearUI(this.S_NAME),LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_LEVEL.skinName,ColorType.colorb96d49+a.tb.permitLevel+"级解锁",16,TextAlign.LEFT);else{LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_NAME.skinName,ColorType.Orange853d07+b.name,16,TextAlign.LEFT);var c=GuidData.player.getLevel()<a.tb.permitLevel?ColorType.colorce0a00:ColorType.Orange853d07;LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_LEVEL.skinName,c+"等级:"+a.tb.permitLevel,14,TextAlign.LEFT)}}},c.prototype.drawTimeInfo=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;if(GuidData.player.getLevel()>=a.tb.permitLevel){var b,a=this.itdata.data,c=GameInstance.getGameSecond(a.time);1==a.state&&c>0?(b=ColorType.Green20a200,b+=getScencdStr(c),b+="后刷新"):b=ColorType.Orange853d07+"可挑战",b!=this.lastTmStr&&(LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_TIME.skinName,b,14,TextAlign.LEFT),this.lastTmStr=b)}else UiDraw.clearUI(this.S_TIME)}},c.prototype.loadIcon=function(){var a=this,b=this.itdata.data;if(this.lastState!=b.state){this.lastState=b.state;var c=TableData.getInstance().getData(TableData.tb_creature_template,b.tb.bossEntry);IconManager.getInstance().getIcon(getRoleIconUrl(c.avatar),function(b){var c=a.uiAtlas.getRec(a.S_ICON.skinName);a.uiAtlas.ctx=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),UiDraw.cxtDrawImg(a.uiAtlas.ctx,PuiData.SKILL_BG68,new Rectangle(0,0,c.pixelWitdh,c.pixelHeight),UIData.publicUi),a.uiAtlas.ctx.drawImage(b,3,3,c.pixelWitdh-6,c.pixelHeight-6),TextureManager.getInstance().updateTexture(a.uiAtlas.texture,c.pixelX,c.pixelY,a.uiAtlas.ctx)}),this.drawKillIcon()}},c.prototype.drawKillIcon=function(){1==this.lastState?UiDraw.SharedDrawImg(this.uiAtlas,c.baseAtlas,this.S_KILL_TIP.skinName,"U_KILL_TITTLE"):this.uiAtlas.clearCtxTextureBySkilname(this.S_KILL_TIP.skinName)},c.prototype.render=function(a){this.itdata=a,a&&a.data?(TimeUtil.removeFrameTick(this.upDataFun),TimeUtil.addFrameTick(this.upDataFun),this.lastTmStr="",this.applyRender()):this.setnull()},c.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.S_BG.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_ICON.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_NAME.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_LEVEL.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_TIME.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.S_KILL_TIP.skinName)},c.prototype.butClik=function(a){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10))return;var b=this.itdata.data;b.tb.permitLevel>GuidData.player.getLevel()?msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"等级不够，请多多练练再来",99):this.setSelect()}},c}(SListItem);a.SbossLeftListRender=b;var c=function(c){function d(){var a=c.call(this)||this;return a.left=325,a.top=149,a}return __extends(d,c),d.prototype.init=function(a){b.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,b,225,435,225,87,5,256,1024,1,7)},d.prototype.resetData=function(){var b=a.SbossModel.getInstance().getItemData();this.refreshData(b)},d.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.resetData(),this.setSelectIndex(0)},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.SbossLeftList=c;var d=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b._frameFun=function(a){b.upTime(a)},b}return __extends(b,a),b.prototype.setRender=function(a,b){this._bottomRender.uiAtlas=a,this._midRender.uiAtlas=a,this._topRender.uiAtlas=a,this._winRender=b,this.loadConfigCom()},b.prototype.upTime=function(a){if(!this.hasStage)return void TimeUtil.removeFrameTick(this._frameFun);var b="",c=GameInstance.getGameSecond(GuidData.player.getPlayerIntFieldMassBossCd());c>0&&(b=ColorType.colorce0a00+getScencdStr(c),b+=ColorType.Orange853d07+" 增加1次挑战次数"),this.lastCdStr!=b&&(LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_cd_label.skinName,ColorType.Orange853d07+b,14,TextAlign.CENTER),this.lastCdStr=b)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.sbossLeftList.show(),this.refristhPanel();for(var a=0;a<this.winBgAry.length;a++)this.addChild(this.winBgAry[a]);TimeUtil.addFrameTick(this._frameFun)},b.prototype.refristhPanel=function(){var a=GuidData.player.getPlayerIntFieldMassBossTimes(),b=tb.TB_mass_boss_base.getTempVo(1).dailytimes;LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_tz_num.skinName,ColorType.Orange853d07+"挑战次数("+a+"/"+b+")",14,TextAlign.CENTER)},b.prototype.hide=function(){this.sbossLeftList.hide();for(var a=0;a<this.winBgAry.length;a++)this.removeChild(this.winBgAry[a]);UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.a_tiaozhan:this.tiaozhanBoss();break;case this.a_add_buy_but:this.showBuyMeshBoss();break;case this.t_selbtn:console.log("----this.t_selbtn.selected----",this.t_selbtn.selected),GameData.configData.setopen_prompting_sboss(this.selectVo.tb.id-1,this.t_selbtn.selected);break;case this.a_seach_person_list:NetManager.getInstance().protocolos.query_mass_boss_rank(this.selectVo.tb.id),console.log("查看列表")}},b.prototype.tiaozhanBoss=function(){var a=this;if(this.selectVo)if(1==this.selectVo.state)msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"BOSS还未刷新，请耐心等待",99);else if(GuidData.player.getLevel()<this.selectVo.tb.permitLevel)msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"等级不够，先练练再来",99);else{var b=GuidData.player.getPlayerIntFieldMassBossTimes();0>=b?AlertUtil.show("挑战次数不足，是否前往购买？","提示",function(b){1==b&&a.showBuyMeshBoss()},2,["前往购买","取消"]):(console.log("挑战",this.selectVo.tb.id),NetManager.getInstance().protocolos.try_mass_boss(this.selectVo.tb.id))}},b.prototype.showBuyMeshBoss=function(){var a=GuidData.player.getPlayerIntFieldMassBossTimes(),b=tb.TB_mass_boss_base.getTempVo(1).dailytimes+tb.TB_vip_base.get_TB_vip_baseById(GuidData.player.getVipLevel()).massbossBuyTimes;if(a>=b)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"次数满了",99);var c=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL),d=tb.TB_mass_boss_times.getItem();c.resoureItem=new Array;for(var e=GuidData.player.getPlayerIntFieldMassBossBuyedTimes(),f=e;f<d.length&&e+(b-a)>f;f++)c.resoureItem.push(d[f].cost[0]);c.Info1="Boss挑战剩余可购买",c.cutNum=c.resoureItem.length,c.cutNum>0?(c.SubmitFun=function(a){NetManager.getInstance().protocolos.buy_mass_boss_times(a)},ModuleEventManager.dispatchEvent(c)):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"次数满了",99)},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas;var a=this._winRender.getComponent("cnew_right_bg_top");this.setSizeForPanelUiCopy(a,"a_right_bg_top",this._midRender);var b=this._winRender.getComponent("cnew_right_bg_bottom");this.setSizeForPanelUiCopy(b,"a_right_bg_bottom",this._midRender),this.winBgAry=[a,b],this.addChild(this._bottomRender.getComponent("a_list_bg")),this.a_list_pos=this.addChild(this._bottomRender.getComponent("a_list_pos")),this.addChild(this._bottomRender.getComponent("a_right_has_bg")),this.addChild(this._topRender.getComponent("a_right_cell_line")),this.addChild(this._topRender.getComponent("a_right_cell_tittle")),this.addChild(this._bottomRender.getComponent("t_info")),this.a_tz_num=this.addChild(this._midRender.getComponent("a_tz_num")),this.addChild(this._bottomRender.getComponent("a_boss_name_bg")),this.a_boss_name=this.addChild(this._midRender.getComponent("a_boss_name")),this.a_tiaozhan=this.addEvntButUp("a_tiaozhan",this._midRender),this.a_add_buy_but=this.addEvntButUp("a_add_buy_but",this._midRender),this.t_selbtn=this.addEvntBut("t_selbtn",this._midRender),this.rewardIconItem=new Array,this.rewardNameItem=new Array;for(var c=0;4>c;c++){var d=this.addChild(this._midRender.getComponent("a_reward"+c));this.rewardIconItem.push(d),d=this.addChild(this._midRender.getComponent("a_reward_name"+c)),this.rewardNameItem.push(d)}this.a_cd_label=this.addChild(this._midRender.getComponent("a_cd_label")),this.a_person_num=this.addChild(this._midRender.getComponent("a_person_num")),this.a_boss_blood_bg=this.addChild(this._midRender.getComponent("a_boss_blood_bg")),this.a_boss_blood=this.addChild(this._midRender.getComponent("a_boss_blood")),this.a_bar_tip_point=this.addChild(this._topRender.getComponent("a_bar_tip_point")),this.a_seach_person_list=this.addEvntButUp("a_seach_person_list",this._midRender),this.a_boss_blood_num=this.addChild(this._topRender.getComponent("a_boss_blood_num")),this.seachUiarr=new Array,this.seachUiarr.push(this.a_boss_blood_bg),this.seachUiarr.push(this.a_boss_blood),this.seachUiarr.push(this.a_person_num),this.seachUiarr.push(this.a_seach_person_list),this.seachUiarr.push(this.a_bar_tip_point),this.seachUiarr.push(this.a_boss_blood_num),this.setUiListVisibleByItem(this.seachUiarr,!1),this.initList(),this.addBossChar()},b.prototype.selectMeshBossByVo=function(a){this.selectVo=a;var b=tb.TB_creature_template.get_TB_creature_template(a.tb.bossEntry);this.bossChar.setAvatar(b.avatar),0==this.selectVo.state?(this.setUiListVisibleByItem(this.seachUiarr,!0),NetManager.getInstance().protocolos.query_mass_boss_info(a.tb.id)):(this.setUiListVisibleByItem(this.seachUiarr,!0),this.setMassBossInfoRet(0,0),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_person_num.skinName,ColorType.Orange853d07+"已击杀",14,TextAlign.CENTER));for(var c=0;c<this.selectVo.tb.show.length;c++)this.drawRewardById(c,this.selectVo.tb.show[c]),this.drawRewardyName(c,this.selectVo.tb.show[c]);var d="";b.name.length<=3&&(d+="\n");for(var c=0;c<b.name.length;c++)d+=b.name.substr(c,1),d+="\n";LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_boss_name.skinName,ColorType.colorfef3d7+d,16,TextAlign.LEFT),this.t_selbtn.selected=GameData.configData.getopen_prompting_sboss(a.tb.id-1)},b.prototype.drawRewardById=function(a,b){IconManager.getInstance().drawItemIcon60(this.rewardIconItem[a],b,1)},b.prototype.drawRewardyName=function(a,b){var c=tb.TB_item_template.get_TB_item_template(b);LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.rewardNameItem[a].skinName,getColorQua(c.quality)+c.name,14,TextAlign.CENTER)},b.prototype.setMassBossInfoRet=function(a,b){this.a_boss_blood.uvScale=b/100,100>b&&b>0?this.a_bar_tip_point.x=this.a_boss_blood.x+this.a_boss_blood.width*(b/100)-this.a_bar_tip_point.width/2:this.a_bar_tip_point.x=1e4,LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_boss_blood_num.skinName,ColorType.Whiteffffff+b+"%",14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_person_num.skinName,ColorType.Orange853d07+"争夺人数："+ColorType.colorcd2000+a,14,TextAlign.CENTER)},b.prototype.refrishListData=function(){this.sbossLeftList.resetData()},b.prototype.addBossChar=function(){this.bossChar=new MonsterUIChar,this._midRender.addModel(this.bossChar)},b.prototype.initList=function(){this.sbossLeftList=new c,this.sbossLeftList.init(this._midRender.uiAtlas)},b.prototype.resize=function(){a.prototype.resize.call(this),this.sbossLeftList&&(this.sbossLeftList.left=this.a_list_pos.parent.x/UIData.Scale+this.a_list_pos.x+3,this.sbossLeftList.top=this.a_list_pos.parent.y/UIData.Scale+this.a_list_pos.y+5),this.bossChar&&(this.bossChar.resize(),this.bossChar.scale=2*UIData.Scale,this.bossChar.x=0*UIData.Scale,this.bossChar.y=-60*UIData.Scale)},b}(UIConatiner);a.SmassBossPanel=d}(sboss||(sboss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),sboss;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._curid1=-1,b._curid2=-1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._winMidRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender=new UIRenderComponent,
this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._midRender=new UIRenderComponent,this._midRender.uiAtlas=a,this.addRender(this._midRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this.initUI(),this.addSelfRole()},b.prototype.initUI=function(){this.initBg(),this.addUIList(["t_boss_bg1","t_boss_bg2","t_right_has_bg"],this._bgRender),this.addUIList(["t_title_bg1","t_title_bg2","t_reward_l","t_reward_c","t_reward_r","t_reward_l1","t_reward_c1","t_reward_r1"],this._midRender),this.addUIList(["d_rewardtitle","d_rewardtitle1"],this._baseRender);var a;this.bossName1=this.addChild(this._baseRender.getComponent("t_boss_name1")),this.bossName2=this.addChild(this._baseRender.getComponent("t_boss_name2")),this.rewardAry1=new Array,this.rewardAry2=new Array;for(var b=0;5>b;b++)this.rewardAry1.push(this.addChild(this._baseRender.getComponent("t_ba"+b))),this.rewardAry2.push(this.addChild(this._baseRender.getComponent("t_bb"+b)));this.t_vip_add=this.addChild(this._baseRender.getComponent("t_vip_add")),a=this.addChild(this._baseRender.getComponent("t_boos_desc")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"今日挑战boss从以上怪物中随机，在活动时揭晓",16,TextAlign.CENTER,ColorType.Green2ca937),a=this.addChild(this._baseRender.getComponent("t_boss_time")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"开启时间：19:00-19:15",16,TextAlign.CENTER,ColorType.Brown7a2f21),a=this.addChild(this._bgRender.getComponent("t_btn")),a.addEventListener(InteractiveEvent.Up,this.onclick,this),this._btnLab=this.addChild(this._baseRender.getComponent("t_btn_lab")),this.setBtnLab()},b.prototype.onclick=function(a){var b=GuidData.globelValue.getWorldBossState();b==SharedDef.WORLD_BOSS_PROCESS_ENROLL?NetManager.getInstance().protocolos.world_boss_enroll():b==SharedDef.WORLD_BOSS_PROCESS_BORN?NetManager.getInstance().protocolos.world_boss_fight():msgtip.MsgTipManager.outStr("世界boss时间未到",99)},b.prototype.setBtnLab=function(){var a=GuidData.globelValue.getWorldBossState();a==SharedDef.WORLD_BOSS_PROCESS_ENROLL?LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._btnLab.skinName,"报名",16,TextAlign.CENTER,ColorType.Brown7a2f21):a==SharedDef.WORLD_BOSS_PROCESS_BORN?LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._btnLab.skinName,"挑战",16,TextAlign.CENTER,ColorType.Brown7a2f21):LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._btnLab.skinName,"未开始",16,TextAlign.CENTER,ColorType.Brown7a2f21)},b.prototype.draw=function(){var a=GuidData.globelValue.getWorldBossId();if(this._curid1!=a[0]){this._curid1=a[0];var b=TableData.getInstance().getData(TableData.tb_worldboss_base,this._curid1),c=tb.TB_creature_template.get_TB_creature_template(b.entry);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.bossName1.skinName,c.name+" LV"+c.level,16,TextAlign.CENTER,ColorType.Brown7a2f21),this.selfRole1.setAvatar(c.avatar);for(var d=0;d<this.rewardAry1.length;d++)b.items[d]?IconManager.getInstance().drawItemIcon60(this.rewardAry1[d],b.items[d],1):IconManager.getInstance().drawItemIcon60(this.rewardAry1[d],0,1)}if(this._curid2!=a[1]){this._curid2=a[1];var b=TableData.getInstance().getData(TableData.tb_worldboss_base,this._curid2),c=tb.TB_creature_template.get_TB_creature_template(b.entry);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.bossName2.skinName,c.name+" LV"+c.level,16,TextAlign.CENTER,ColorType.Brown7a2f21),this.selfRole2.setAvatar(c.avatar);for(var d=0;d<this.rewardAry2.length;d++)b.items[d]?IconManager.getInstance().drawItemIcon60(this.rewardAry2[d],b.items[d],1):IconManager.getInstance().drawItemIcon60(this.rewardAry2[d],0,1)}},b.prototype.initBg=function(){this._bgAry=new Array,this._bgAry.push(this.addByCopy("cnew_right_bg_top","t_win_bg1")),this._bgAry.push(this.addByCopy("cnew_right_bg_bottom","t_win_bg2")),this._bgAry.push(this.addByCopy("cnew_right_bg_top","t_win_bg3")),this._bgAry.push(this.addByCopy("cnew_right_bg_bottom","t_win_bg4"))},b.prototype.addByCopy=function(a,b){var c=this._winMidRender.getComponent(a);return this.setSizeForPanelUiCopy(c,b,this._bgRender),c},b.prototype.addSelfRole=function(){this.selfRole1=new MonsterUIChar,this._midRender.addModel(this.selfRole1),this.selfRole2=new MonsterUIChar,this._midRender.addModel(this.selfRole2),this.resize()},b.prototype.resize=function(){a.prototype.resize.call(this),this.selfRole1&&(this.selfRole1.resize(),this.selfRole1.scale=1.5*UIData.Scale,this.selfRole1.x=150*UIData.Scale,this.selfRole1.y=-10*UIData.Scale,this.selfRole2.resize(),this.selfRole2.scale=1.5*UIData.Scale,this.selfRole2.x=-130*UIData.Scale,this.selfRole2.y=-10*UIData.Scale)},b.prototype.addWinmid=function(){for(var a=0;a<this._bgAry.length;a++)this.addChild(this._bgAry[a])},b.prototype.removeWinmid=function(){for(var a=0;a<this._bgAry.length;a++)this.removeChild(this._bgAry[a])},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.t_vip_add.skinName,getvipadd("worldbossReward"),14,TextAlign.CENTER,ColorType.color9a683f),this._baseUiAtlas&&(this.addWinmid(),this.draw(),this.setBtnLab())},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.removeWinmid()},b}(UIConatiner);a.WbossPanel=b}(sboss||(sboss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),sboss;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b.setBlackBg(),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/boss/sboss/wbossreward.xml","ui/uidata/boss/sboss/wbossreward.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this.addUIList(["t_line1","t_line2","t_win_title"],this._baseRender);var a;a=this.addChild(this._baseRender.getComponent("t_title1")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"排行",16,TextAlign.CENTER,ColorType.Brown7a2f21),a=this.addChild(this._baseRender.getComponent("t_title2")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"奖励",16,TextAlign.CENTER,ColorType.Brown7a2f21),a=this.addChild(this._baseRender.getComponent("t_reward_title")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"奖励说明",16,TextAlign.CENTER,ColorType.Brown7a2f21),a=this.addChild(this._baseRender.getComponent("t_info")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"●对boss造成伤害的玩家都可以获得奖励。\n排名越高的玩家获得的奖励越多",16,TextAlign.LEFT,ColorType.Green2ca937),this.addLists(),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.addLists=function(){this.rewardSList=new c,this.rewardSList.init(this._baseUiAtlas)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.butClik=function(a){a.target==this.c_close&&this.hide()},b.prototype.hide=function(){this.rewardSList.hide(),UIManager.getInstance().removeUIContainer(this)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.rewardSList.show()},b}(WindowCentenMin);a.WbossRewardPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){d.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array,b=400,c=330;this.setData(a,d,b,c,355,56,5,256,512,1,6),this.center=20,this.middle=30,this.setRankData()},b.prototype.setRankData=function(){for(var a=new Array,b=TableData.getInstance().getTabSize(TableData.tb_worldboss_rank_reward),c=0;b>c;c++){var d=new SListItemData,e=TableData.getInstance().getData(TableData.tb_worldboss_rank_reward,c+1),f=new Object;e.range[0]==e.range[1]?f.rank=String(e.range[0]):e.range[1]>0?f.rank=e.range[0]+"-"+e.range[1]:f.rank=e.range[0]+"以上",f.reward=e.showRewards,d.id=c,d.data=f,a.push(d)}this.refreshData(a)},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.setShowLevel(2)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.WbossRewardSList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this.r_rank=this.creatSUI(e,b.baseAtlas,"s_lab",5,16,100,20),c.addChild(this.r_rank),this.r_bg=this.creatGrid9SUI(d,b.baseAtlas,"s_bg",0,0,356,56,5,5),c.addChild(this.r_bg),this.iconAry=new Array;for(var g=0;4>g;g++){var h=this.creatSUI(e,b.baseAtlas,"s_r"+g,120+55*g,6,48,48);c.addChild(h),this.iconAry.push(h)}},b.prototype.applyRender=function(){this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.r_bg.skinName,UIData.publicUi,PuiData.LISTITEMBG);var a=this.itdata.data;LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_rank.skinName,ColorType.Brown7a2f21+a.rank,14,TextAlign.CENTER);for(var b=0;b<this.iconAry.length;b++)a.reward[b]&&IconManager.getInstance().drawItemIcon40(this.iconAry[b],a.reward[b][0],a.reward[b][1])},b.prototype.render=function(a){this.itdata=a,this.itdata&&this.itdata.data&&this.applyRender()},b}(SListItem);a.WbossRewardSListRender=d}(sboss||(sboss={}));var sboss;!function(a){var b=function(){function a(){this.targetTime=-1}return a}();a.MeshBossVo=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getItemData=function(){if(!this.itemData){var a=this.getMessBossItem();this.itemData=new Array;for(var b=0;b<a.length;b++){var c=new SListItemData;c.id=b,c.data=a[b],this.itemData.push(c)}}for(var b=0;b<this.itemData.length;b++){var d=this.itemData[b].data,e=GuidData.globelValue.getFieldMassBoss(d.tb.id-1);d.state=e.state,d.time=e.time,-1==d.targetTime&&(d.flag=!0,d.targetTime=d.time),d.targetTime!=d.time&&(d.flag=!1,d.targetTime=d.time)}return this.itemData},a.prototype.getMessBossItem=function(){for(var a=tb.TB_mass_boss_info.getItem(),c=new Array,d=0;d<a.length;d++){var e=new b;e.tb=a[d],c.push(e)}return c},a.prototype.refrishBossItemData=function(){},a.prototype.getPersonBossItemData=function(){if(!this._pBossItemData){this._pBossItemData=new Array;for(var a=tb.Tb_private_boss_info.get_Tb_private_boss_info(),b=0;b<a.length;b++){var c=new d;c.tabbossinfo=a[b];var e=new SListItemData;e.id=b,e.data=c,this._pBossItemData.push(e)}}for(var f=GuidData.instanceData.getPersonbosstime(),b=0;b<this._pBossItemData.length;b++){var g=this._pBossItemData[b].data;g.openstate=g.tabbossinfo.permitLevel<=GuidData.player.getLevel(),g.times=f[b],-1==g.targetTime&&(g.flag=!0,g.targetTime=g.times),g.targetTime!=g.times&&(g.flag=!1,g.targetTime=g.times)}return this._pBossItemData},a}();a.SbossModel=c;var d=function(){function a(){this._targetTime=-1}return Object.defineProperty(a.prototype,"targetTime",{get:function(){return this._targetTime},set:function(a){this._targetTime=a},enumerable:!0,configurable:!0}),a.prototype.getTime=function(){var a=GameInstance.getGameSecond(this.times);return a>0?getScencdStr(a):""},a.prototype.getTims=function(){var a=this.hasTims(),b=0>=a?ColorType.Redd92200:ColorType.Brown7a2f21;return b+a+ColorType.Brown7a2f21+"/"+this.tabbossinfo.maxTimes},a.prototype.hasTims=function(){var a=GameInstance.getGameSecond(this.times);if(a>0){var b=this.tabbossinfo.maxTimes-Math.ceil(a/(60*this.tabbossinfo.rebornTime));return b}return this.tabbossinfo.maxTimes},a}();a.PersonBossVo=d}(sboss||(sboss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),sboss;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.tabType=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this._midRender.uiAtlas.setInfo("ui/uidata/boss/sboss/sboss.xml","ui/uidata/boss/sboss/sboss.png",function(){a.loadConfigCom()},"ui/uidata/boss/sboss/sbossuse.png")},c.prototype.wbossChg=function(){this.wBossPanel&&this.wBossPanel.hasStage&&this.wBossPanel.setBtnLab()},c.prototype.show=function(a){ModulePageManager.showResTittle([1,2,3]),UIManager.getInstance().addUIContainer(this),this.refreshOpenLev(),this.selectTabById(a)},c.prototype.hide=function(){this.personBossPanel.hide(),this.smassBossPanel.hide(),this.wBossPanel.hide(),UIManager.getInstance().removeUIContainer(this),b.prototype.hide.call(this)},c.prototype.onRemove=function(){b.prototype.onRemove.call(this),ModuleEventManager.dispatchEvent(new a.SbossEvent(a.SbossEvent.SET_LASTID));var c=new topui.TopUiEvent(topui.TopUiEvent.REFRESH_TOP_PANDA_TIP);c.data=null,ModuleEventManager.dispatchEvent(c)},c.prototype.butClik=function(a){switch(a.target){case this.a_tab0:this.selectTabById(SharedDef.MODULE_BOSS_RISK_BOSS);break;case this.a_tab1:this.selectTabById(SharedDef.MODULE_BOSS_WORLD_BOSS);break;case this.a_tab2:this.selectTabById(SharedDef.MODULE_BOSS_PERSON_BOSS);break;case this.t_unlock0:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock0.data.level+"级后解锁",99);break;case this.t_unlock1:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock1.data.level+"级后解锁",99);break;case this.t_unlock2:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock2.data.level+"级后解锁",99);break;case this.w_close:this.hide()}},c.prototype.selectTabById=function(a){this.tabType=a,this.tabType==SharedDef.MODULE_BOSS_RISK_BOSS?(this.a_tab0.selected=!1,this.a_tab1.selected=!0,this.a_tab2.selected=!0,this.smassBossPanel.show(),this.personBossPanel.hide(),this.wBossPanel.hide()):this.tabType==SharedDef.MODULE_BOSS_WORLD_BOSS?(this.a_tab0.selected=!0,this.a_tab1.selected=!1,this.a_tab2.selected=!0,this.smassBossPanel.hide(),this.personBossPanel.hide(),this.wBossPanel.show()):(this.a_tab0.selected=!0,this.a_tab1.selected=!0,this.a_tab2.selected=!1,this.smassBossPanel.hide(),this.wBossPanel.hide(),this.personBossPanel.show())},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.initRightBg(),this.a_tab0=this.addEvntBut("a_tab0",this._midRender),this.a_tab1=this.addEvntBut("a_tab1",this._midRender),this.a_tab2=this.addEvntBut("a_tab2",this._midRender),this.TabAry=new Array,this.TabAry.push(this.a_tab2),this.TabAry.push(this.a_tab0),this.TabAry.push(this.a_tab1),this.addChild(this._topRender.getComponent("a_win_tittle")),this.addChild(this._topRender.getComponent("t_win_line")),this.UnlockUIAry=new Array,this.t_unlock0=this.addEvntBut("t_unlock0",this._midRender),this.UnlockUIAry.push(this.t_unlock0),this.t_unlock1=this.addEvntBut("t_unlock1",this._midRender),this.UnlockUIAry.push(this.t_unlock1),this.t_unlock2=this.addEvntBut("t_unlock2",this._midRender),this.UnlockUIAry.push(this.t_unlock2),this.smassBossPanel=new a.SmassBossPanel,this.smassBossPanel.setRender(this._midRender.uiAtlas,this.winmidRender),this.personBossPanel=new a.PersonBossPanel,this.personBossPanel.setRender(this._midRender.uiAtlas,this.winmidRender),this.wBossPanel=new a.WbossPanel,this.wBossPanel.setUIAtlas(this._midRender.uiAtlas,this.winmidRender),this._redPointRender.getRedPointUI(this,118,new Vector2D(this.a_tab2.x+this.a_tab2.width-5,this.a_tab2.y)),this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.initRightBg=function(){var a=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(a,"a_right_tab_bg",this._midRender)},c.prototype.refreshOpenLev=function(){for(var a=new Array,b=0;b<SharedDef.MODULE_BOSS_WORLD_BOSS;b++){var c=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_BOSS+b+1));a.push(c)}for(var d=0;d<a.length;d++)a[d].level<=GuidData.player.getLevel()?(this.setUiListVisibleByItem([this.TabAry[d]],!0),this.setUiListVisibleByItem([this.UnlockUIAry[d]],!1)):(this.setUiListVisibleByItem([this.TabAry[d]],!1),this.setUiListVisibleByItem([this.UnlockUIAry[d]],!0),this.UnlockUIAry[d].data=a[d])},c}(WindowUi);a.SbossPanel=b}(sboss||(sboss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),sboss;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"SbossModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.SbossModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_SBOSS_PANEL="SHOW_SBOSS_PANEL",b.HIDE_SBOSS_PANEL="HIDE_SBOSS_PANEL",b.SELECT_MESH_BOSS_ID="SELECT_MESH_BOSS_ID",b.REFRISH_LIST_DATA="REFRISH_LIST_DATA",b.REFRISH_SBOSS_PANEL="REFRISH_SBOSS_PANEL",b.WBOSS_STATE_CHG="WBOSS_STATE_CHG",b.WBOSS_MORE_REWARD="WBOSS_MORE_REWARD",b.PBOSS_REFRISH_PANEL="PBOSS_REFRISH_PANEL",b.SET_LASTID="SET_LASTID",b}(BaseEvent);a.SbossEvent=c;var d=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a._nodeInit=!1,a._lastId=0,a}return __extends(d,b),d.prototype.getName=function(){return"SbossProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_SBOSS_PANEL?this.showPanel(b.data):b.type==c.SET_LASTID&&(this._lastId=0),this.sbossPanel&&this.sbossPanel.hasStage&&(b.type==c.SELECT_MESH_BOSS_ID?this.sbossPanel.smassBossPanel.selectMeshBossByVo(b.selectMeshBossVo):b.type==c.REFRISH_LIST_DATA?this.sbossPanel.smassBossPanel.refrishListData():b.type==c.REFRISH_SBOSS_PANEL?this.sbossPanel.smassBossPanel.refristhPanel():b.type==c.WBOSS_STATE_CHG?this.wbossChg():b.type==c.PBOSS_REFRISH_PANEL&&this.sbossPanel.personBossPanel.selectMeshBossByVo(b.data)),b.type==c.WBOSS_MORE_REWARD&&this.showBossReward()}else a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT&&this.initRedNode()},d.prototype.initRedNode=function(){var b=this;if(!this._nodeInit){for(var c=RedPointManager.getInstance().getNodeByID(119),d=a.SbossModel.getInstance().getPersonBossItemData(),e=0;e<d.length;e++){var f=new RedPointNode;f.data=d[e].data,c.addChild(f)}this._nodeInit=!0,this.initQuestFlag(),this.initTrainingQuestFlag(),this.setNewDateTime(),TimeUtil.addTimeTick(1e3,function(){b.gameTimeTick()})}},d.prototype.setNewDateTime=function(){var a=GameInstance.getServerNow(),b=new Date(1e3*a);b.setDate(b.getDate()+1),b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0),this._newdateTime=b.getTime(),console.log("---------$play----------",b)},d.prototype.compareTime=function(){var a=GameInstance.getServerNow(),b=new Date(1e3*a),c=b.getTime()-this._newdateTime;return c>=0?(this.setNewDateTime(),!0):!1},d.prototype.initQuestFlag=function(){if(!this.showquestPanel){this.showquestPanel=new Array;for(var a=0;6>a;a++)this.showquestPanel.push(!1);var b=quest.QuestModel.getInstance().getQuestDailyVo();if(b&&b.length>0)for(var a=0;a<b.length;a++){var c=b[a].questDataVo.taskState==SharedDef.QUEST_STATUS_END;if(!c){var d;d=6==b[a].tb_quest.targetsPosition[0][0]?GuidData.bag.getItemCount(b[a].tb_quest.targetsPosition[0][b[a].tb_quest.targetsPosition[0].length-1])>=b[a].questDataVo.items[0].num:b[a].questDataVo.items[0].process>=b[a].questDataVo.items[0].num,d&&(this.showquestPanel[b[a].index]=!0)}}}},d.prototype.initTrainingQuestFlag=function(){if(!this.showTrainingquestPanel){var a=training.TrainingModel.getInstance().getTaskvo();this.showTrainingquestPanel=new Array;for(var b=0;b<a.length;b++)this.showTrainingquestPanel.push(!1);if(a&&a.length>0)for(var b=0;b<a.length;b++){var c=a[b];null!=c.questData&&c.questData.taskState!=SharedDef.QUEST_STATUS_END&&GuidData.player.getResType(c.tab_adventure.upres[0])>=c.tab_adventure.upres[1]&&(this.showTrainingquestPanel[c.questData.indx]=!0)}}},d.prototype.gameTimeTick=function(){if(this.processRedPoint(),this.questPanel(),this.bossTips(),this.TrainingquestPanel(),this.compareTime()){var a=GameInstance.getServerNow(),b=new Date(1e3*a);console.log("--------------------------------------------------------------------","-----0点重置-----",b),this.reset0()}},d.prototype.reset0=function(){for(var a=0;a<this.showquestPanel.length;a++)this.showquestPanel[a]=!1;for(var b=0;b<this.showTrainingquestPanel.length;b++)this.showTrainingquestPanel[b]=!1},d.prototype.getBossName=function(a){var b=tb.TB_creature_template.get_TB_creature_template(a);return b.name},d.prototype.bossTips=function(){for(var b=a.SbossModel.getInstance().getItemData(),c=b.length-1;c>=0;c--){var d=b[c].data;if(GuidData.player.getLevel()>=d.tb.permitLevel){var e=GameInstance.getGameSecond(d.time);if(!d.flag&&0>=e){d.flag=!0;var f=100*d.tb.id;if(this._lastId<f&&GameData.configData.getopen_prompting_sboss(c)){var g=new topui.TopUiEvent(topui.TopUiEvent.REFRESH_TOP_PANDA_TIP);g.data=ColorType.Brown7a2f21+"全民BOSS:"+ColorType.Redd92200+this.getBossName(d.tb.bossEntry)+ColorType.Brown7a2f21+"可挑战了！",ModuleEventManager.dispatchEvent(g),this._lastId=f}return}}}for(var h=a.SbossModel.getInstance().getPersonBossItemData(),i=h.length-1;i>=0;i--){var j=h[i].data;if(j.openstate){var e=GameInstance.getGameSecond(j.times);if(!j.flag&&0>=e){j.flag=!0;var f=j.tabbossinfo.id;if(this._lastId<f&&GameData.configData.getopen_prompting_pboss(c)){var g=new topui.TopUiEvent(topui.TopUiEvent.REFRESH_TOP_PANDA_TIP);g.data=ColorType.Brown7a2f21+"个人BOSS:"+ColorType.Redd92200+this.getBossName(j.tabbossinfo.bossEntry)+ColorType.Brown7a2f21+"可挑战了！",ModuleEventManager.dispatchEvent(g),this._lastId=f}return}}}},d.prototype.questPanel=function(){var a=quest.QuestModel.getInstance().getQuestDailyVo();if(a&&a.length>0)for(var b=0;b<a.length;b++){var c=a[b].questDataVo.taskState==SharedDef.QUEST_STATUS_END;if(!c){var d;if(d=6==a[b].tb_quest.targetsPosition[0][0]?GuidData.bag.getItemCount(a[b].tb_quest.targetsPosition[0][a[b].tb_quest.targetsPosition[0].length-1])>=a[b].questDataVo.items[0].num:a[b].questDataVo.items[0].process>=a[b].questDataVo.items[0].num,d&&!this.showquestPanel[a[b].index]){ModulePageManager.openPanel(SharedDef.MODULE_DAILY_TASKS),this.showquestPanel[a[b].index]=!0;break}}}},d.prototype.TrainingquestPanel=function(){var a=training.TrainingModel.getInstance().getTaskvo();if(a&&a.length>0)for(var b=0;b<a.length;b++){var c=a[b];if(null!=c.questData&&c.questData.taskState!=SharedDef.QUEST_STATUS_END&&GuidData.player.getResType(c.tab_adventure.upres[0])>=c.tab_adventure.upres[1]&&!this.showTrainingquestPanel[c.questData.indx]){ModulePageManager.openPanel(SharedDef.MODULE_EXP,SharedDef.MODULE_EXP_QUEST),this.showTrainingquestPanel[c.questData.indx]=!0;break}}},d.prototype.processRedPoint=function(){if(ModuleEventManager.dispatchEvent(new welfare.WelfareEvent(welfare.WelfareEvent.CHG_REDPOINT)),GuidData.player.getsyspageopen(SharedDef.MODULE_BOSS,SharedDef.MODULE_BOSS_PERSON_BOSS))for(var b=a.SbossModel.getInstance().getPersonBossItemData(),c=RedPointManager.getInstance().getNodeByID(119).children,d=0;d<c.length;d++){c[d].data=b[d].data;var e=b[d].data;c[d].show=e.openstate&&e.hasTims()>0}if(GuidData.player.getsyspageopen(SharedDef.MODULE_FISH,SharedDef.MODULE_FISH_ALL)){var f=RedPointManager.getInstance().getNodeByID(123),g=chgfish.ChgfishModel.getInstance().getList();f.show=g.length>0}},d.prototype.hidePanel=function(){this.sbossPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.sbossPanel||(this.sbossPanel=new a.SbossPanel),this.sbossPanel.load(function(){b||(b=c._lastId<100?SharedDef.MODULE_BOSS_PERSON_BOSS:SharedDef.MODULE_BOSS_RISK_BOSS),c.sbossPanel.show(b)},!1)},d.prototype.showBossReward=function(){var b=this;this._rewardPanel||(this._rewardPanel=new a.WbossRewardPanel),this._rewardPanel.load(function(){b._rewardPanel.show()})},d.prototype.wbossChg=function(){this.sbossPanel&&this.sbossPanel.hasStage&&this.sbossPanel.wbossChg()},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_SBOSS_PANEL),new c(c.HIDE_SBOSS_PANEL),new c(c.SELECT_MESH_BOSS_ID),new c(c.REFRISH_LIST_DATA),new c(c.REFRISH_SBOSS_PANEL),new c(c.WBOSS_STATE_CHG),new c(c.WBOSS_MORE_REWARD),new c(c.PBOSS_REFRISH_PANEL),new c(c.SET_LASTID),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d.prototype.smsgMassBossInfoRet=function(a){if(this.sbossPanel&&this.sbossPanel.hasStage){var b=a.readUint32(),c=a.readByte();console.log(b,c),this.sbossPanel.smassBossPanel.setMassBossInfoRet(b,c)}},d.prototype.smsgMassBossRandResult=function(a){var b=this,c=new s2c_mass_boss_rank_result;s2c_mass_boss_rank_result.read(c,a),this._rankPanle||(this._rankPanle=new WindowRankPanel);for(var d=new Array,e=0;e<c.info.length;e++){var f=new WindowRankVo;f.rank=String(e+1),f.name=getBaseName(c.info[e].name),f.val=float2int(100*c.info[e].value)/100+"%",d.push(f)}this._rankPanle.load(function(){b._rankPanle.show(["排名","玩家名字","伤害"],d,"")})},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_MASS_BOSS_INFO_RET]=function(b){a.smsgMassBossInfoRet(b)},b[Protocols.SMSG_MASS_BOSS_RANK_RESULT]=function(b){a.smsgMassBossRandResult(b)},b},d}(BaseProcessor);a.SbossProcessor=d}(sboss||(sboss={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),email;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b.setBlackBg(),b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/mail/mail.xml","ui/uidata/mail/mail.png",function(){a.loadConfigCom()},"ui/uidata/mail/mailuse.png")},b.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.addUIList(["t_win_title","t_list_bg","t_content_bg"],this._bgRender);var a;a=this.addChild(this._baseRender.getComponent("t_del_btn")),a.addEventListener(InteractiveEvent.Up,this.delread,this),a=this.addChild(this._baseRender.getComponent("t_delall_btn")),a.addEventListener(InteractiveEvent.Up,this.getAll,this),this._redPointRender.getRedPointUI(this,4,new Vector2D(a.x+a.width,a.y)),this.mailnumLab=this.addChild(this._baseRender.getComponent("t_mail_num")),this.getBtn=this._baseRender.getComponent("t_get_btn"),this.getBtn.addEventListener(InteractiveEvent.Up,this.getclick,this),this.mailTitle=this.addChild(this._baseRender.getComponent("t_title")),this.mailContent=this.addChild(this._baseRender.getComponent("t_content")),this.mailIconLab=this.addChild(this._baseRender.getComponent("t_icon_lab")),this.mailIconAry=new Array;for(var b=0;4>b;b++)this.mailIconAry.push(this.addChild(this._baseRender.getComponent("t_icon"+b)));this.addLists(),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.mailChg=function(a){1==a?(this.windowRankSList.refreshDraw(),this.drawShowData()):this.windowRankSList.setRankData(),this.drawNum()},b.prototype.delread=function(a){UiTweenScale.getInstance().changeButSize(a.target),NetManager.getInstance().protocolos.remove_mail_one_step()},b.prototype.getAll=function(a){UiTweenScale.getInstance().changeButSize(a.target),NetManager.getInstance().protocolos.pick_mail_one_step()},b.prototype.getclick=function(a){UiTweenScale.getInstance().changeButSize(a.target),this._showData&&NetManager.getInstance().protocolos.pick_mail(this._showData.indx)},b.prototype.setShowData=function(a){this._showData=a,a?this.drawShowData():(this.clearShowData(),this.removeChild(this.getBtn))},b.prototype.clearShowData=function(){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.mailTitle.skinName,"无邮件",16,TextAlign.LEFT,ColorType.Brown7a2f21),UiDraw.clearUI(this.mailContent),UiDraw.clearUI(this.mailIconLab);for(var a=0;a<this.mailIconAry.length;a++)UiDraw.clearUI(this.mailIconAry[a])},b.prototype.drawShowData=function(){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.mailTitle.skinName,this._showData.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.mailContent.skinName,"   "+this._showData.desc,16,TextAlign.LEFT,ColorType.Brown7a2f21);var a=new Array;""!=this._showData.item?(a=this._showData.item.split(","),this._showData.isGetItem?this.removeChild(this.getBtn):this.addChild(this.getBtn)):this.removeChild(this.getBtn);for(var b=0;b<this.mailIconAry.length;b++)a[2*b]?IconManager.getInstance().drawItemIcon60(this.mailIconAry[b],Number(a[2*b]),Number(a[2*b+1])):IconManager.getInstance().drawItemIcon60(this.mailIconAry[b],0,0);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.mailIconLab.skinName,"奖励附件：",16,TextAlign.LEFT,ColorType.Brown7a2f21)},b.prototype.drawNum=function(){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.mailnumLab.skinName,ColorType.Brown7a2f21+"邮件数量："+ColorType.Green2ca937+this.windowRankSList.getDataSize()+"/"+SharedDef.MAX_GIFTPACKS_INFO_COUNT,16,TextAlign.LEFT)},b.prototype.addLists=function(){this.windowRankSList=new c,this.windowRankSList.init(this._baseUiAtlas,this)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.butClik=function(a){a.target==this.e_close&&this.hide()},b.prototype.hide=function(){this.windowRankSList.hide(),UIManager.getInstance().removeUIContainer(this)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.windowRankSList.show(),this.drawNum()},b}(WindowMinUi);a.MailPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a,b){d.baseAtlas=a,this._panel=b,this.initData()},b.prototype.initData=function(){var a=new Array,b=230,c=320;this.setData(a,d,b,c,230,90,4,256,512,1,7),this.center=-180,this.middle=-10},b.prototype.setRankData=function(){for(var a=GuidData.giftPacks.getGiftDataItem(),b=new Array,c=0;c<a.length;c++){var d=new SListItemData;a[c]&&(d.data=a[c]),d.id=c,b.push(d)}this.refreshData(b),a.length&&this.setSelectIndex(0),this._panel.setShowData(a[0])},b.prototype.setSelect=function(b){a.prototype.setSelect.call(this,b),this._panel.setShowData(b.itdata.data)},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.setRankData(),this.setShowLevel(2)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.MailSList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),
this.r_bg=this.creatGrid9SUI(d,b.baseAtlas,"s_bg",0,0,224,90,10,10),c.addChild(this.r_bg),this.r_bg.addEventListener(InteractiveEvent.Up,this.onclick,this),this.r_icon=this.creatSUI(e,b.baseAtlas,"s_icon",9,9,60,64),c.addChild(this.r_icon),this.r_title=this.creatSUI(e,b.baseAtlas,"s_title",82,12,135,20),c.addChild(this.r_title),this.r_time=this.creatSUI(e,b.baseAtlas,"s_time",82,32,135,20),c.addChild(this.r_time),this.r_lasttime=this.creatSUI(e,b.baseAtlas,"s_lasttime",82,56,135,20),c.addChild(this.r_lasttime)},b.prototype.onclick=function(a){this.itdata&&this.itdata.data&&(UiTweenScale.getInstance().changeButSize(a.target),this.parentTarget.setSelect(this))},Object.defineProperty(b.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected!=a&&(this._selected=a,this._selected&&NetManager.getInstance().protocolos.read_mail(this.itdata.data.indx),this.itdata&&this.itdata.data&&this.drawSel())},enumerable:!0,configurable:!0}),b.prototype.drawSel=function(){this._selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.r_bg.skinName,UIData.publicUi,PuiData.Slist_select):UiDraw.uiAtlasDrawImg(this.uiAtlas,this.r_bg.skinName,UIData.publicUi,PuiData.Slist_nselect)},b.prototype.applyRender=function(){this.drawSel();var a=this.itdata.data;LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_title.skinName,ColorType.Brown7a2f21+a.name,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_time.skinName,ColorType.Brown7a2f21+TimeUtil.getLocalTime0(a.startTime),16,TextAlign.LEFT);var b=a.endTime-GameInstance.getServerNow();b=Math.floor(b/60/60/12),b>0?LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_lasttime.skinName,ColorType.Green2ca937+"剩余时间:"+b+"天",16,TextAlign.LEFT):LabelTextFont.writeSingleLabel(this.uiAtlas,this.r_lasttime.skinName,ColorType.Green2ca937+"已过期",16,TextAlign.LEFT),""!=a.item?this.drawIcon(a.isGetItem):this.drawIcon(a.isRead)},b.prototype.drawIcon=function(a){var c=this.r_icon,d=c.uiRender.uiAtlas.getRec(c.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1),f=b.baseAtlas.getRec(a?"u_unlock":"u_lock");e.drawImage(b.baseAtlas.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight),c.uiRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)},b.prototype.refreshDraw=function(){this.itdata&&this.itdata.data?this.applyRender():this.setnull()},b.prototype.render=function(a){this.itdata=a,this.itdata&&this.itdata.data?this.applyRender():this.setnull()},b.prototype.setnull=function(){UiDraw.clearUI(this.r_bg),UiDraw.clearUI(this.r_lasttime),UiDraw.clearUI(this.r_time),UiDraw.clearUI(this.r_icon),UiDraw.clearUI(this.r_title)},b}(SListItem);a.MailSListRender=d;var e=function(){function a(){}return a}();a.WindowRankVo=e}(email||(email={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),email;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MailModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.MailModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MAIL_PANEL_EVENT="SHOW_MAIL_PANEL_EVENT",b.MAIL_CHG_EVENT="MAIL_CHG_EVENT",b}(BaseEvent);a.MailEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"MailProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_MAIL_PANEL_EVENT?this.showPanel():b.type==c.MAIL_CHG_EVENT&&this.mailChg(b.data)}else if(a instanceof EngineEvent)a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT&&this.refreshRedNode();else if(a instanceof UIPanelEvent){var d=a;d.panel==this._mailPanel&&(this._mailPanel.dispose(),this._mailPanel=null,console.log("释放面板 _mailPanel"))}},d.prototype.showPanel=function(){var b=this;this._mailPanel||(this._mailPanel=new a.MailPanel),this._mailPanel.load(function(){b._mailPanel.show()},!0)},d.prototype.mailChg=function(a){this._mailPanel&&this._mailPanel.hasStage&&this._mailPanel.mailChg(a),this.refreshRedNode()},d.prototype.refreshRedNode=function(){for(var a,b=GuidData.giftPacks.getGiftDataItem(),c=!1,d=!1,e=0;e<b.length;e++)""!=b[e].item?b[e].isGetItem||(c=!0,d=!0):b[e].isRead||(c=!0);a=RedPointManager.getInstance().getNodeByID(3),a.show=c,a=RedPointManager.getInstance().getNodeByID(4),a.show=d},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_MAIL_PANEL_EVENT),new c(c.MAIL_CHG_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.MailProcessor=d}(email||(email={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),map;!function(a){var b=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v4Pos")},b.prototype.getVertexShaderString=function(){var a="attribute vec4 v4Pos;void main(void){   vec4 vt0= vec4(v4Pos.x,v4Pos.y,0, 1.0);   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a="precision mediump float;\nvoid main(void)\n{\ngl_FragColor = vec4(0.6,0.0,0.0, 1.0);\n}";return a},b.MapWalkLineShader="MapWalkLineShader",b}(Shader3D);a.MapWalkLineShader=b;var c=function(a){function b(){var b=a.call(this)||this;return b.x=UIData.designWidth/2,b.y=UIData.designHeight/2,b.width=20,b.height=20,b}return __extends(b,a),b.prototype.applyRenderSize=function(){},b}(UICompenent);a.MapLineUi=c;var d=function(a){function d(){var c=a.call(this)||this;return c.anglyNum=0,ProgrmaManager.getInstance().registe(b.MapWalkLineShader,new b),c.shader=ProgrmaManager.getInstance().getProgram(b.MapWalkLineShader),c.program=c.shader.program,c}return __extends(d,a),d.prototype.makeLineUiItem=function(a){if(a&&a.length>1){this.mapLineUiList=new Array;for(var b=a[0],d=0;d<a.length;d++)for(;Vector2D.distance(b,a[d])>8;){b=this.nextPostForTow(b,a[d]);var e=new c;e.x=b.x,e.y=b.y,e.width=1,e.height=1,this.mapLineUiList.push(e)}this.makeLineVetlineObjData()}else this.objData.treNum=0,console.log("路线清除")},d.prototype.nextPostForTow=function(a,b){var c=new Vector2D(b.x-a.x,b.y-a.y);return c.normalize(),c.x=4*c.x,c.y=4*c.y,c.x+=a.x,c.y+=a.y,c},d.prototype.makeLineVetlineObjData=function(){this.objData||(this.objData=new ObjData),this.objData.vertices=new Array,this.objData.indexs=new Array,this.getUiDataForItem(),this.objData.vertexBuffer?(Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)),this.objData.treNum=this.objData.indexs.length},d.prototype.getUiDataForItem=function(){for(var a=(new Array,0);a<this.mapLineUiList.length;a++){var b=this.mapLineUiList[a];b.parent=this.container,b.applyAbsolutePoint(),b.renderX=b.absoluteX/Scene_data.stageWidth*2-1,b.renderY=-b.absoluteY/Scene_data.stageHeight*2+1;var c=new Matrix3D;c.appendRotation(this.anglyNum,Vector3D.Z_AXIS);var d=Scene_data.stageWidth/Scene_data.stageHeight,e=b.absoluteWidth/Scene_data.stageWidth*2,f=b.absoluteHeight/Scene_data.stageHeight*2/d,g=new Vector3D(-1*e,-1*f,0),h=new Vector3D(1*e,-1*f,0),i=new Vector3D(-1*e,1*f,0),j=new Vector3D(1*e,1*f,0);g=c.transformVector(g),h=c.transformVector(h),i=c.transformVector(i),j=c.transformVector(j);var k=new Vector2D(b.renderX+g.x,b.renderY+g.y*d),l=new Vector2D(b.renderX+h.x,b.renderY+h.y*d),m=new Vector2D(b.renderX+i.x,b.renderY+i.y*d),n=new Vector2D(b.renderX+j.x,b.renderY+j.y*d);this.objData.vertices.push(k.x,k.y,1,1),this.objData.vertices.push(l.x,l.y,1,1),this.objData.vertices.push(m.x,m.y,1,1),this.objData.vertices.push(n.x,n.y,1,1),this.objData.indexs.push(0+4*a,1+4*a,3+4*a),this.objData.indexs.push(0+4*a,3+4*a,2+4*a)}},d.prototype.addPosTo=function(a){this.objData.vertices.push(a.x),this.objData.vertices.push(a.y),this.objData.vertices.push(a.z),this.objData.vertices.push(a.w)},d.prototype.update=function(){this.objData&&this.objData.treNum>0&&(Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVa(0,4,this.objData.vertexBuffer),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},d}(UIRenderComponent);a.MapWalkLineComponent=d}(map||(map={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),map;!function(a){var b=function(){function a(){}return a.prototype.draw=function(a){var b=this;LoadManager.getInstance().load(Scene_data.fileRoot+"ui/load/map/world/"+(this.id+1)+".png",LoadManager.IMG_TYPE,function(c){var d=b.pic.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);e.drawImage(c,0,0,d.width,d.height),UIManager.getInstance().makeCtxToGray(e,new Rectangle(0,0,d.width,d.height)),b.pic.drawToCtx(a,e)})},a}();a.MapClikVo=b;var c=function(){function a(){}return a.prototype.draw=function(a,b){this.id;this.txtUI.goToAndStop(this.id),this.txtUI.x=this.pointUi.x-40,this.txtUI.y=this.pointUi.y+20,this.pointUi.goToAndStop(a.data.type);var c=this.txtUI.getSkinCtxRect(),d=UIManager.getInstance().getContext2D(c.width,c.height,!1);LabelTextFont.writeSingleLabelToCtx(d,"[000000]"+a.data.name,15,c.width/2,0,TextAlign.CENTER),this.txtUI.drawToCtx(b,d)},a}();a.NpcNameAndIcon=c;var d=function(d){function e(){var a=d.call(this)||this;return a.severList=new Array,a.npcSpriteList=new Array,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(e,d),e.prototype.setRender=function(a,b,c,d){this._bottomRender=a,this._midRender=b,this._topRender=c,this._pointRender=d,this.loadConfigCom()},e.prototype.loadConfigCom=function(){this.addUIList(["w_big_0","w_big_1","w_big_2"],this._bottomRender),this.w_mapA=this.addChild(this._midRender.getComponent("w_mapA")),this.w_mapB=this.addEvntBut("w_mapB",this._midRender),this.c_red=this.addChild(this._pointRender.getComponent("c_red")),this.a_map_name_bg=this.addChild(this._pointRender.getComponent("a_map_name_bg")),this.a_map_name=this.addChild(this._pointRender.getComponent("a_map_name")),this.a_bottom_mask=this.addChild(this._topRender.getComponent("a_bottom_mask")),this.a_bottom_mask.isV=!0,this.a_top_mask=this.addChild(this._topRender.getComponent("a_top_mask"));var a=tb.TB_world_map.getItem();this.wIconItem=new Array;for(var c=0;c<a.length;c++){var d=new b;d.tb_world_map=a[c],d.id=c,d.txt=this._topRender.getComponent("w_label"),d.txt.goToAndStop(d.id),d.pic=this.addEvntBut("w_icon",this._topRender),d.pic.data=d,d.pic.goToAndStop(c),d.pic.x=d.tb_world_map.x,d.pic.y=d.tb_world_map.y,d.txt.x=d.tb_world_map.x,d.txt.y=d.tb_world_map.y+d.pic.height,d.draw(this._topRender.uiAtlas),this.wIconItem.push(d)}},e.prototype.butClik=function(a){switch(a.target){case this.w_mapB:var c=new Vector2D;console.log(this.w_mapB.x,this.w_mapB.y),console.log(this.x,this.y),console.log("---------------"),c.x=a.x/UIData.Scale-this.x/UIData.Scale,c.y=a.y/UIData.Scale-this.y/UIData.Scale;var d=this.uiPosToWorldPos(c);this.sendWalkToPos(d);break;default:if(a.target.data instanceof b){var e=a.target.data;NetManager.getInstance().protocolos.teleport_map(e.tb_world_map.mapid,GuidData.map.getLineID())}}},e.prototype.sendWalkToPos=function(a){var b=this,c=AstarUtil.findPath3D(GameInstance.mainChar.getCurrentPos(),a);if(c){for(var d=0;d<c.length;d++)console.log(c[d],AstarUtil.isGridCanWalk(c[d]));console.log(c),this.meshToWalkLine(c),AotuSkillManager.getInstance().aotuWalk=!0,MainCharControlModel.getInstance().setWalkPathFun(c,function(){b.walkPathComplete()})}},e.prototype.meshToWalkLine=function(a){for(var b=new Array,c=0;a&&c<a.length;c++){var d=AstarUtil.getWorldPosByStart2D(a[c]),e=this.worldPosToUiPos(d);b.push(e)}this.parent.mapWalkLineComponent.makeLineUiItem(b)},e.prototype.walkPathComplete=function(){this.meshToWalkLine(null),AotuSkillManager.getInstance().aotuWalk=!1},e.prototype.setTabType=function(b){this._bottomRender.uiAtlas.clearCtxTextureBySkilname(this.w_mapA.skinName),this.mathMinMapRect(),0==a.MapModel.tabType?(this.loadMapById(),this.setUiListVisibleByItem([this.w_mapA],!1),this.setUiListVisibleByItem([this.w_mapB],!0),this.clearNpc(),this.makeNpcSprite(),this.a_top_mask.width=566,this.a_bottom_mask.width=566):(this.setUiListVisibleByItem([this.w_mapA],!0),this.setUiListVisibleByItem([this.w_mapB],!1),this.drawWorldMapImg(),this.a_top_mask.width=790,this.a_bottom_mask.width=790);for(var c=0!=a.MapModel.tabType,d=0;d<this.wIconItem.length;d++)this.setUiListVisibleByItem([this.wIconItem[d].pic],c),this.setUiListVisibleByItem([this.wIconItem[d].txt],c)},e.prototype.drawWorldMapImg=function(){var b=this._midRender.uiAtlas,c=b.getRec(this.w_mapA.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(a.MapModel.worldMapImg,0,0,c.pixelWitdh,c.pixelHeight),TextureManager.getInstance().updateTexture(this._bottomRender.uiAtlas.texture,c.pixelX,c.pixelY,d)},e.prototype.showSeverMapInfo=function(b){if(b&&0!=b.length||(b=this.getTestData()),0==a.MapModel.tabType){for(;this.severList.length>b.length;){var c=this.severList.pop();this.removeChild(c)}for(var d=0;d<b.length;d++){var e,f=AstarUtil.getWorldPosByStart2D(b[d].pos),g=this.worldPosToUiPos(f);d>=this.severList.length&&(e=this.addChild(this._pointRender.getComponent("f_icon")),this.severList.push(e),e.x=g.x-e.width/2,e.y=g.y-e.height/2),e=this.severList[d],e.goToAndStop(b[d].type),e.data=g}}},e.prototype.getTestData=function(){for(var b=new Array,c=random(8)+1,d=0;c>d;d++){var e=new a.MapServerVo;e.type=random(3),e.pos=new Vector2D,e.pos.x=80,e.pos.y=80,b.push(e)}return b},e.prototype.makeNpcSprite=function(){for(var b=a.MapModel.getInstance().getxmlList(),d=0;d<b.length;d++){var e=b[d],f=this.addChild(this._pointRender.getComponent("f_icon"));e.pos3d=AstarUtil.getWorldPosByStart2D(e.data.position);var g=this.worldPosToUiPos(e.pos3d);f.x=g.x-f.width/2,f.y=g.y-f.height/2;var h=new c;h.id=d,h.pointUi=f,h.txtUI=this.addChild(this._pointRender.getComponent("t_npcname")),h.draw(e,this._pointRender.uiAtlas),this.npcSpriteList.push(h)}this.removeChild(this.c_red),this.addChild(this.c_red)},e.prototype.worldPosToUiPos=function(a){var b=this.w_mapB.width,c=this.w_mapB.x+b/2,d=this.w_mapB.y+b/2;return c+=a.x/this.minMapRect.width*b/2,d-=a.z/this.minMapRect.width*b/2,new Vector2D(c,d)},e.prototype.uiPosToWorldPos=function(a){var b=this.w_mapB.width,c=this.w_mapB.x+b/2,d=this.w_mapB.y+b/2,e=new Vector3D;return e.x=2*(a.x-c)/b*this.minMapRect.width,e.z=2*(d-a.y)/b*this.minMapRect.width,e},e.prototype.clearNpc=function(){for(;this.npcSpriteList.length;){var a=this.npcSpriteList.pop();this.removeChild(a.pointUi),this.removeChild(a.txtUI)}},e.prototype.upData=function(){if(this.minMapRect){this.resetPostion();for(var a=0;this.severList&&a<this.severList.length;a++){var b=this.severList[a],c=b.data,d=new Vector2D;d.x=c.x-b.width/2,d.y=c.y-b.height/2;var e=Vector2D.distance(d,new Vector2D(b.x,b.y));if(e>1&&40>e){var f=new Vector2D(d.x-b.x,d.y-b.y);f.normalize(),f.scaleBy(.5),b.x+=f.x,b.y+=f.y}else b.x=d.x,b.y=d.y}}},e.prototype.resetPostion=function(){var a=GameInstance.mainChar.getCurrentPos(),b=this.worldPosToUiPos(a);this.c_red.x=b.x-this.c_red.width/2,this.c_red.y=b.y-this.c_red.height/2},e.prototype.mathMinMapRect=function(){var a=(AstarUtil.navmeshData.midu,AstarUtil.navmeshData.astarItem[0].length),b=AstarUtil.navmeshData.astarItem.length,c=AstarUtil.navmeshData.aPos.x+a*AstarUtil.navmeshData.midu,d=AstarUtil.navmeshData.aPos.z+b*AstarUtil.navmeshData.midu;c=Math.max(Math.abs(AstarUtil.navmeshData.aPos.x),Math.abs(c)),d=Math.max(Math.abs(AstarUtil.navmeshData.aPos.z),Math.abs(d));var e=Math.max(c,d);e+=100,e=Math.round(e);var f=new Rectangle;f.x=-e,f.y=-e,f.width=2*e,f.height=2*e,f.x-=1,f.y-=1,f.width+=2,f.height+=2,f.width/=2,f.height/=2,this.minMapRect=f},e.prototype.loadMapById=function(){this._topRender.uiAtlas.upDataPicToTexture("ui/load/map/"+GuidData.map.getMapID()+".png",this.w_mapB.skinName);var a=tb.TB_map.getTB_map(GuidData.map.getMapID());LabelTextFont.writeSingleLabel(this._pointRender.uiAtlas,this.a_map_name.skinName,"[ff0000]"+a.name,18)},e}(UIVirtualContainer);a.MapCetentPanel=d}(map||(map={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),map;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setRender=function(a,b){this._bottomRender=a,this._topRender=b,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this._topRender;this.a_tab_0=this.addEvntBut("a_tab_0",this._topRender),this.a_tab_1=this.addEvntBut("a_tab_1",this._topRender),this.addUIList(["a_red_line_0","a_red_line_1"],this._topRender)},b.prototype.butClik=function(a){switch(a.target){case this.a_tab_0:this.parent.setTabType(0);break;case this.a_tab_1:this.parent.setTabType(1)}},b.prototype.setTabType=function(a){0==a?(this.a_tab_0.enable=!1,this.a_tab_0.selected=!0,this.a_tab_1.enable=!0,this.a_tab_1.selected=!1):(this.a_tab_0.enable=!0,this.a_tab_0.selected=!1,this.a_tab_1.enable=!1,this.a_tab_1.selected=!0)},b}(UIVirtualContainer);a.MapLeftPanel=b}(map||(map={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),map;!function(a){var b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.hasLight=!1,b}return __extends(b,a),b.prototype.draw=function(){var a=this.listItemData.data,c=UIManager.getInstance().getContext2D(this.uvData.ow,this.uvData.oh,!1),d="S_base_pic";a.data?this.hasLight&&(d="S_select_pic"):(0==a.menuType&&(d="S_pic0"),2==a.menuType&&(d="S_pic2"),3==a.menuType&&(d="S_pic3"));var e=b.uiAtlas.getRec(d);if(c.drawImage(b.uiAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,0,200,40),a.data)LabelTextFont.writeSingleLabelToCtx(c,"[ffffff]"+a.data.name,18,100,10,TextAlign.CENTER);else{var f=b.uiAtlas.getRec(a.lock?"S_down":"S_up");c.drawImage(b.uiAtlas.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,130,12,20,20)}this.atlas.updateCtx(c,this.uvData.ox,this.uvData.oy)},Object.defineProperty(b.prototype,"selected",{set:function(a){this.hasLight!=a&&(this.hasLight=a,this.draw())},enumerable:!0,configurable:!0}),b}(ListItemRender);a.MapNpcListItemRender=b;var c=function(c){function d(){var a=c.call(this)||this;return a._listItemArr=new Array,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(d,c),d.prototype.setRender=function(a,c,d){this._bottomRender=a,this._topRender=c,this._listRender=d,b.uiAtlas=this._bottomRender.uiAtlas,this.loadConfigCom()},d.prototype.setTabType=function(a){this.setUiListVisibleByItem(this._uiList,0==a),0==a&&this.showData()},d.prototype.refreshLine=function(){console.log(a.MapModel.getInstance().mapLineData);var c=a.MapModel.getInstance().mapLineData,d=new line_info;d.rate=0,d.lineNo=1;for(var e=0;e<c.info.length;e++)c.info[e].lineNo==GuidData.map.getLineID()&&(d=c.info[e]);if(d){var f=this._bottomRender.uiAtlas.getRec(this.a_line_label_txt.skinName),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1),h="S_yellow";d.rate<60&&(h="S_green"),d.rate>95&&(h="S_red");var i=b.uiAtlas.getRec(h);g.drawImage(b.uiAtlas.useImg,i.pixelX,i.pixelY,i.pixelWitdh,i.pixelHeight,25,0,i.pixelWitdh,i.pixelHeight),ArtFont.getInstance().writeFontToCtxCenten(g,String(GuidData.map.getLineID()),ArtFont.num1,10,0),this._bottomRender.uiAtlas.updateCtx(g,f.pixelX,f.pixelY)}},d.prototype.loadConfigCom=function(){this._uiList=new Array,this.a_list_tittle=this.addEvntBut("a_list_tittle",this._topRender),this._uiList.push(this.a_list_tittle),this.a_line_label_txt=this.addChild(this._topRender.getComponent("a_line_label_txt")),this._uiList.push(this.a_line_label_txt),this._uiList.push(this.addChild(this._bottomRender.getComponent("a_line_bg"))),this.a_win_close=this.addEvntBut("a_win_close",this._topRender),this.addList()},d.prototype.addList=function(){var a=new Vector2D(685,80);this._itemlist=this._listRender.createList(),this._itemlist.x=a.x,this._itemlist.y=a.y,this.addChild(this._itemlist),this._bgMask=new UIMask,this._bgMask.x=a.x,this._bgMask.y=a.y,this._bgMask.width=200,this._bgMask.height=410,this.addMask(this._bgMask),this._listRender.mask=this._bgMask},d.prototype.showData=function(){var c=this,d=a.MapModel.getInstance().getMenuListArr();this._listItemArr.length=0;for(var e=0;e<d.length;e++){var f=new ListItemData;f.data=d[e],f.clickFun=function(a){c.itemDataClick(a)},this._listItemArr.push(f)}this._itemlist.setData(this._listItemArr,b,200,40,256,1024,200,410),this._itemlist.contentY=0},d.prototype.itemDataClick=function(b){var c=b.data;if(c.data){var d=AstarUtil.getWorldPosByStart2D(c.data.position);this.sendWalkToPos(d);for(var e=0;this._listItemArr&&e<this._listItemArr.length;e++)this._listItemArr[e]==b?this._listItemArr[e].itemRender.selected=!0:this._listItemArr[e].itemRender.selected=!1}else console.log(c.menuType),a.MapModel.getInstance().lockItem[c.menuType]=!a.MapModel.getInstance().lockItem[c.menuType],this.showData()},d.prototype.sendWalkToPos=function(a){var b=this,c=AstarUtil.findPath3D(GameInstance.mainChar.getCurrentPos(),a);c&&(this.parent.mapCetentPanel.meshToWalkLine(c),AotuSkillManager.getInstance().aotuWalk=!0,MainCharControlModel.getInstance().setWalkPathFun(c,function(){b.walkPathComplete()}))},d.prototype.walkPathComplete=function(){AotuSkillManager.getInstance().aotuWalk=!1},d.prototype.butClik=function(a){switch(a.target){case this.a_win_close:this.parent.close();break;case this.a_list_tittle:this.parent.showLinePanel(),console.log("显示")}},d}(UIVirtualContainer);a.MapRightPanel=c}(map||(map={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),map;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(c,b),c.prototype.setRender=function(a,b){this._bottomRender=a,this._topRender=b,this.loadConfigCom()},c.prototype.loadConfigCom=function(){},c.prototype.clearFramAll=function(){for(;this.lineFramList&&this.lineFramList.length;){var a=this.lineFramList.length-1;this.lineFramList[a].removeEventListener(InteractiveEvent.Up,this.butClik,this),this.removeChild(this.lineFramList[a]),this.lineFramList.pop()}this.lineFramList=new Array},c.prototype.showLinePanel=function(){this.clearFramAll();for(var b=a.MapModel.getInstance().mapLineData,c=0;10>c;c++)if(b.info[c]||4>c){var d=0;b.info[c]&&(d=b.info[c].rate);var e=this.addChild(this._topRender.getComponent("line_label"));e.goToAndStop(c),e.data=c,e.addEventListener(InteractiveEvent.Up,this.butClik,this),e.x=680,e.y=75+40*c,this.drawToCtxB(e,c+1,d),this.lineFramList.push(e)}},c.prototype.drawToCtxB=function(b,c,d){var e=(this._bottomRender.uiAtlas.getRec(b.skinName),b.getSkinCtxRect()),f=UIManager.getInstance().getContext2D(e.width,e.height,!1),g=a.MapNpcListItemRender.uiAtlas.getRec("S_line_bg");f.drawImage(a.MapNpcListItemRender.uiAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,0,0,e.width,e.height);var h=new Vector2D(30,10),i="S_yellow";60>d&&(i="S_green"),d>95&&(i="S_red");var j=a.MapNpcListItemRender.uiAtlas.getRec(i);f.drawImage(a.MapNpcListItemRender.uiAtlas.useImg,j.pixelX,j.pixelY,j.pixelWitdh,j.pixelHeight,30+h.x,0+h.y,j.pixelWitdh,j.pixelHeight),ArtFont.getInstance().writeFontToCtxCenten(f,String(c),ArtFont.num1,10+h.x,0+h.y),b.drawToCtx(this._bottomRender.uiAtlas,f)},c.prototype.changeLine=function(a){console.log("换线"+(a+1)),NetManager.getInstance().protocolos.change_line(a+1)},c.prototype.butClik=function(a){this.changeLine(a.target.data),this.parent.showLinePanel(),this.parent.close()},c}(UIVirtualContainer);a.MapLinePanel=b}(map||(map={}));var map;!function(a){var b=function(){function a(){}return a}();a.MapMenuVo=b;var c=function(){function a(){}return a}();a.MapServerVo=c;var d=function(){function a(){this.lockItem=[!1,!0,!0,!0],this._dic=new Object}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.refresh=function(){},a.prototype.getxmlList=function(){var a=GuidData.map.getMapID();if(!this._dic[a]){this._dic[a]=new Array;for(var c=tb.TB_map_navigation.get_TB_map_navigation(a),d=0;d<c.navi.length;d++){var e=tb.TB_map_object.get_TB_map_object(c.navi[d]),f=new b;f.data=e,this._dic[a].push(f)}}return this._dic[a]},a.prototype.getMenuListArr=function(){var a=new Array;return this.addTempByType(3,a),this.addTempByType(2,a),this.addTempByType(0,a),a},a.prototype.addTempByType=function(a,c){for(var d=!1,e=this.getxmlList(),f=0;f<e.length;f++)e[f].data.type==a&&(d=!0);if(d){var g=new b;g.menuType=a,g.lock=this.lockItem[a],c.push(g);for(var f=0;f<e.length&&g.lock;f++)e[f].data.type==a&&c.push(e[f])}},a.tabType=0,a}();a.MapModel=d}(map||(map={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),map;!function(a){var b=function(b){function c(){var c=b.call(this)||this;return c.uiAtlasComplet=!1,c.width=UIData.designWidth,c.height=UIData.designHeight,c.center=0,c.middle=0,c._bottomRender=new UIRenderComponent,c.addRender(c._bottomRender),c._midRender=new UIRenderComponent,c.addRender(c._midRender),c.mapWalkLineComponent=new a.MapWalkLineComponent,c.addRender(c.mapWalkLineComponent),c._topRender=new UIRenderComponent,c.addRender(c._topRender),c._pointRender=new UIRenderComponent,c.addRender(c._pointRender),c._lineRender=new UIRenderComponent,c._listRender=new UIListRenderComponent,c.addRender(c._listRender),c._midRender.uiAtlas=new UIAtlas,c}return __extends(c,b),c.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._pointRender.dispose(),this._pointRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,this._lineRender.dispose(),this._lineRender=null,this._listRender.dispose(),this._listRender=null,this.mapWalkLineComponent.dispose(),this.mapWalkLineComponent=null},c.prototype.applyLoad=function(){var b=this,c=new Image;c.onload=function(){a.MapModel.worldMapImg=c,b._midRender.uiAtlas.setInfo("ui/uidata/map/map.xml","ui/uidata/map/map.png",function(){b.loadConfigCom()},"ui/uidata/map/mapuse.png")},c.src=Scene_data.fileRoot+"ui/load/map/worldmap.jpg"},c.prototype.loadConfigCom=function(){var b=this;this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this._pointRender.uiAtlas=this._midRender.uiAtlas,this._lineRender.uiAtlas=this._midRender.uiAtlas,this.mapLeftPanel=new a.MapLeftPanel,this.mapLeftPanel.setRender(this._bottomRender,this._midRender),this.addVirtualContainer(this.mapLeftPanel),this.mapCetentPanel=new a.MapCetentPanel,this.mapCetentPanel.setRender(this._bottomRender,this._midRender,this._topRender,this._pointRender),this.addVirtualContainer(this.mapCetentPanel),this.mapRightPanel=new a.MapRightPanel,this.mapRightPanel.setRender(this._bottomRender,this._midRender,this._listRender),this.addVirtualContainer(this.mapRightPanel),this.mapLinePanel=new a.MapLinePanel,this.mapLinePanel.setRender(this._topRender,this._lineRender),this.addVirtualContainer(this.mapLinePanel),this.upFun=function(){b.upData()},this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.upData=function(){this.mapCetentPanel.upData()},c.prototype.addTime=function(){TimeUtil.addTimeTick(10,this.upFun)},c.prototype.removeTime=function(){TimeUtil.removeTimeTick(this.upFun)},c.prototype.setTabType=function(b){a.MapModel.tabType=b,a.MapModel.getInstance().refresh(),this.mapLeftPanel.setTabType(b),this.mapCetentPanel.setTabType(b),this.mapRightPanel.setTabType(b),this.renderSetVisibel([this.mapWalkLineComponent],0==b),this.renderSetVisibel([this._pointRender,this._listRender],0==b)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.refresh=function(){this.uiAtlasComplet&&(this.mapWalkLineComponent.makeLineUiItem(null),NetManager.getInstance().protocolos.show_map_line(),this.setTabType(a.MapModel.tabType))},c.prototype.refreshLine=function(){this.mapRightPanel.refreshLine()},c.prototype.showLinePanel=function(){this._lineRender.rendering?this.removeRender(this._lineRender):(this.addRender(this._lineRender),this.mapLinePanel.showLinePanel())},c.prototype.close=function(){this.removeTime(),UIManager.getInstance().removeUIContainer(this),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},c}(UIPanel);a.MapPanel=b}(map||(map={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),map;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MAP_EVENT="SHOW_MAP_EVENT",b.HIDE_MAP_EVENT="HIDE_MAP_EVENT",b}(BaseEvent);a.MapEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MapModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.MapModule=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"MapProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;c.type==b.SHOW_MAP_EVENT&&this.showPanel(),c.type==b.HIDE_MAP_EVENT&&this.hidePanel()}if(a instanceof UIPanelEvent){var d=a;d.panel==this._mapPanel&&(this._mapPanel.dispose(),this._mapPanel=null,console.log("释放面板 _mapPanel"))}},d.prototype.hidePanel=function(){},d.prototype.showPanel=function(){var b=this;this._mapPanel||(this._mapPanel=new a.MapPanel),this._mapPanel.load(function(){UIManager.getInstance().addUIContainer(b._mapPanel),SceneManager.getInstance().render=!1,
b._mapPanel.addTime(),b._mapPanel.refresh(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT))})},d.prototype.smsgSendMapLine=function(b){var c=new s2c_send_map_line;s2c_send_map_line.read(c,b),a.MapModel.getInstance().mapLineData=c,this._mapPanel.refreshLine()},d.prototype.isHasXianFuBaoXiang=function(a){for(var b=GuidData.map.getXianFuPlayerGuidList(),c=0;c<b.length;c++)if(GuidData.map.getXianFuPlayerScore(c)>0&&-1!=a.search(b[c]))return!0;return!1},d.prototype.smsgKuafuXianFuMiniMap=function(b){for(var c=new Array,d=b.readUint16(),e=0;d>e;e++){var f=new a.MapServerVo;f.name=b.readUTF(),f.pos=new Vector2D,f.pos.x=b.readUint16(),f.pos.y=b.readUint16(),this.isHasXianFuBaoXiang(f.name)?f.type=7:f.type=1,-1==f.name.search(GuidData.player.getGuid())&&c.push(f)}for(var d=b.readUint16(),e=0;d>e;e++){var f=new a.MapServerVo;b.readUint16(),f.name="生物",f.pos=new Vector2D,f.pos.x=b.readUint16(),f.pos.y=b.readUint16(),f.type=2,c.push(f)}for(var d=b.readUint16(),e=0;d>e;e++){var f=new a.MapServerVo;b.readUint16(),f.name="采集物品",f.pos=new Vector2D,f.pos.x=b.readUint16(),f.pos.y=b.readUint16(),f.type=5,c.push(f)}this._mapPanel&&this._mapPanel.hasStage&&(console.log(c),this._mapPanel.mapCetentPanel.showSeverMapInfo(c))},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_MAP_EVENT),new b(b.HIDE_MAP_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.MapProcessor=d}(map||(map={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mapnew;!function(a){var b=function(){function a(){}return a}();a.MapnewLisDataMesh=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,d,e,f){void 0===f&&(f=null),b.prototype.create.call(this,a,d,e,f),this.G_BG=this.creatGrid9SUI(d,c.baseAtlas,"G_BG",2,0,170,34,5,5),a.addChild(this.G_BG),this.G_BG.addEventListener(InteractiveEvent.Up,this.butClik,this),this.G_NAME=this.creatSUI(e,c.baseAtlas,"G_NAME",35,8,100,18),a.addChild(this.G_NAME)},c.prototype.butClik=function(b){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(b.x,b.y),10))return;this.setSelect();var c=new a.MapNewEvent(a.MapNewEvent.SELECT_MAP_NEW_CELL);c.data=this.itdata.data,ModuleEventManager.dispatchEvent(c)}},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():this.setnull()},c.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.G_BG.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.G_NAME.skinName)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,this.applyRender(),a&&this.itdata&&this.itdata.data},enumerable:!0,configurable:!0}),c.prototype.applyRender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;this.itdata.id%2==0?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.G_BG.skinName,UIData.publicUi,PuiData.LISTITEMBG):this.uiAtlas.clearCtxTextureBySkilname(this.G_BG.skinName),LabelTextFont.writeSingleLabel(this.uiAtlas,this.G_NAME.skinName,a.txt,16,TextAlign.CENTER)}},c}(SListItem);a.MapnewListRender=c;var d=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){c.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,c,175,210,175,35,6,128,1024,1,9)},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.MapNewList=d;var e=function(c){function e(){var a=c.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a.mapWalkLineComponent=new map.MapWalkLineComponent,a.addRender(a.mapWalkLineComponent),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a.upDataFun=function(){a.upDataFrame()},a}return __extends(e,c),e.prototype.applyLoad=function(){var a=this;this._topRender.setInfo("ui/uidata/mapnew/mapnew.xml","ui/uidata/mapnew/mapnew.png",function(){a.loadConfigCom()})},e.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas,this.addChild(this._topRender.getComponent("a_map_name_bg")),this.a_big_pic_bg=this.addChild(this._midRender.getComponent("a_big_pic_bg")),this.a_map_pic=this.addEvntBut("a_map_pic",this._midRender),this.a_map_pic.x=this.a_big_pic_bg.x+3,this.a_map_pic.y=this.a_big_pic_bg.y+3,this.a_word_map_enter=this.addEvntButUp("a_word_map_enter",this._topRender),this.a_map_name_txt=this.addChild(this._topRender.getComponent("a_map_name_txt")),this.addChild(this._topRender.getComponent("a_left_bg_line")),this.a_self_pos_point=this.addChild(this._topRender.getComponent("a_self_pos_point")),this.a_right_tab_0=this.addEvntButUp("a_right_tab_0",this._midRender),this.a_right_tab_1=this.addEvntButUp("a_right_tab_1",this._midRender),this.a_tab_name0=this.addChild(this._topRender.getComponent("a_tab_name0")),this.a_tab_name1=this.addChild(this._topRender.getComponent("a_tab_name1")),this.a_right_list_bg=this.addChild(this._bottomRender.getComponent("a_right_list_bg")),this.initList(),this.applyLoadComplete()},e.prototype.initList=function(){this.mapNewList=new d,this.mapNewList.init(this._midRender.uiAtlas)},e.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.mapNewList.show(),this.refrish(),this.setTabType(1),NetManager.getInstance().protocolos.show_map_line(),TimeUtil.addTimeTick(50,this.upDataFun)},e.prototype.refrish=function(){this.mapWalkLineComponent.makeLineUiItem(null),this.mathMinMapRect(),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_map_name_txt.skinName,ColorType.Yellowffe9b4+GuidData.map.tbMapVo.name,16),this._topRender.uiAtlas.upDataPicToTexture("ui/load/map/"+GuidData.map.getMapID()+".jpg",this.a_map_pic.skinName)},e.prototype.setTabType=function(a){this.typeNum!=a&&(this.typeNum=a,this.mapNewList.refreshData(new Array),0==a?(this.a_right_tab_0.goToAndStop(1),this.a_right_tab_1.goToAndStop(0),this.a_right_tab_1.y=360,this.a_right_list_bg.y=135,NetManager.getInstance().protocolos.show_map_line()):(this.a_right_tab_0.goToAndStop(0),this.a_right_tab_1.goToAndStop(1),this.a_right_tab_1.y=140,this.a_right_list_bg.y=175,this.getMapCharList()),this.a_tab_name0.y=this.a_right_tab_0.y+8,this.a_tab_name1.y=this.a_right_tab_1.y+8,this.resize())},e.prototype.getMapCharList=function(){for(var a=GuidData.map.getMapID(),c=new Array,d=tb.TB_map_navigation.get_TB_map_navigation(a),e=0;e<d.navi.length;e++){var f=tb.TB_map_object.get_TB_map_object(d.navi[e]),g=new SListItemData,h=new b;h.txt=ColorType.Brown7a2f21+f.name,h.type=1,h.data=f,g.data=h,g.id=e,c.push(g)}this.mapNewList.refreshData(c)},e.prototype.selectmapOBJ=function(a){console.log("就是这个地方",a);var b=AstarUtil.getWorldPosByStart2D(a.position);this.sendWalkToPos(b)},e.prototype.refreshLine=function(a){var b=new line_info;b.rate=0,b.lineNo=1;for(var c=0;c<a.info.length;c++)a.info[c].lineNo==GuidData.map.getLineID()&&(b=a.info[c]);var d=ColorType.Orange7a2f21+b.lineNo+"线("+this.getRateStr(b.rate)+")";LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_tab_name0.skinName,d,18),0==this.typeNum&&this.mapNewList.refreshData(this.getLineData(a))},e.prototype.getRateStr=function(a){var b="繁忙";return 60>a&&(b="顺畅"),a>95&&(b="拥挤"),b},e.prototype.getLineData=function(a){for(var c=new Array,d=0;10>d;d++)if(a.info[d]||4>d){var e=0;a.info[d]&&(e=a.info[d].rate);var f=new SListItemData,g=new b;g.txt=ColorType.Brown7a2f21+(d+1)+"线("+this.getRateStr(e)+")",g.type=0,g.data=d+1,f.data=g,f.id=d,c.push(f)}return c},e.prototype.resize=function(){c.prototype.resize.call(this),this.mapNewList&&(this.mapNewList.left=this.a_right_list_bg.parent.x/UIData.Scale+this.a_right_list_bg.x,this.mapNewList.top=this.a_right_list_bg.parent.y/UIData.Scale+this.a_right_list_bg.y+5)},e.prototype.butClik=function(b){switch(b.target){case this.e_close:this.hide();break;case this.a_right_tab_0:this.setTabType(0);break;case this.a_right_tab_1:this.setTabType(1);break;case this.a_word_map_enter:this.hide(),ModuleEventManager.dispatchEvent(new a.MapNewEvent(a.MapNewEvent.SHOW_MAP_NEW_WORLD_EVENT));break;case this.a_map_pic:var c=new Vector2D;console.log(this.a_map_pic.x,this.a_map_pic.y),console.log(this.x,this.y),console.log("---------------"),c.x=b.x/UIData.Scale-this.x/UIData.Scale,c.y=b.y/UIData.Scale-this.y/UIData.Scale;var d=this.uiPosToWorldPos(c);this.sendWalkToPos(d)}},e.prototype.sendWalkToPos=function(a){var b=this,c=AstarUtil.findPath3D(GameInstance.mainChar.getCurrentPos(),a);if(c){for(var d=0;d<c.length;d++)console.log(c[d],AstarUtil.isGridCanWalk(c[d]));console.log(c),this.meshToWalkLine(c),MainCharControlModel.getInstance().setWalkPathFun(c,function(){b.walkPathComplete()})}},e.prototype.walkPathComplete=function(){this.meshToWalkLine(null)},e.prototype.meshToWalkLine=function(a){for(var b=new Array,c=0;a&&c<a.length;c++){var d=AstarUtil.getWorldPosByStart2D(a[c]),e=this.worldPosToUiPos(d);b.push(e)}this.mapWalkLineComponent.makeLineUiItem(b)},e.prototype.uiPosToWorldPos=function(a){var b=this.a_map_pic.width,c=this.a_map_pic.x+b/2,d=this.a_map_pic.y+b/2,e=new Vector3D;return e.x=2*(a.x-c)/b*this.minMapRect.width,e.z=2*(d-a.y)/b*this.minMapRect.width,e},e.prototype.upDataFrame=function(){this.hasStage?this.resetPostion():TimeUtil.removeTimeTick(this.upDataFun)},e.prototype.mathMinMapRect=function(){var a=(AstarUtil.navmeshData.midu,AstarUtil.navmeshData.astarItem[0].length),b=AstarUtil.navmeshData.astarItem.length,c=AstarUtil.navmeshData.aPos.x+a*AstarUtil.navmeshData.midu,d=AstarUtil.navmeshData.aPos.z+b*AstarUtil.navmeshData.midu;c=Math.max(Math.abs(AstarUtil.navmeshData.aPos.x),Math.abs(c)),d=Math.max(Math.abs(AstarUtil.navmeshData.aPos.z),Math.abs(d));var e=Math.max(c,d);e+=100,e=Math.round(e);var f=new Rectangle;f.x=-e,f.y=-e,f.width=2*e,f.height=2*e,f.x-=1,f.y-=1,f.width+=2,f.height+=2,f.width/=2,f.height/=2,this.minMapRect=f},e.prototype.resetPostion=function(){var a=GameInstance.mainChar.getCurrentPos(),b=this.worldPosToUiPos(a);this.a_self_pos_point.x=b.x-this.a_self_pos_point.width/2,this.a_self_pos_point.y=b.y-this.a_self_pos_point.height/2},e.prototype.worldPosToUiPos=function(a){var b=this.a_map_pic.width,c=this.a_map_pic.x+b/2,d=this.a_map_pic.y+b/2;return c+=a.x/this.minMapRect.width*b/2,d-=a.z/this.minMapRect.width*b/2,new Vector2D(c,d)},e.prototype.hide=function(){this.mapNewList.hide(),UIManager.getInstance().removeUIContainer(this)},e}(WindowMinUi);a.MapNewPanel=e}(mapnew||(mapnew={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mapnew;!function(a){var b=function(){function a(){}return a.prototype.draw=function(a){var b=this;LoadManager.getInstance().load(Scene_data.fileRoot+"ui/load/map/world/"+this.tb_world_map.mapid+".png",LoadManager.IMG_TYPE,function(c){var d=b.pic.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);e.drawImage(c,0,0,d.width,d.height),b.isOpen=!0,b.isOpen||UIManager.getInstance().makeCtxToGray(e,new Rectangle(0,0,d.width,d.height)),b.pic.drawToCtx(a,e)})},a.prototype.drawLabel=function(a){var b=this.txt.getSkinCtxRect(),c=UIManager.getInstance().getContext2D(b.width,b.height,!1);LabelTextFont.writeSingleLabelToCtx(c,ColorType.Whitefff4d6+tb.TB_map.getTB_map(this.tb_world_map.mapid).name,16),this.txt.drawToCtx(a,c)},a}();a.MapClikVo=b;var c=function(c){function d(){var a=c.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(d,c),d.prototype.applyLoad=function(){var a=this;this._topRender.setInfo("ui/uidata/mapnew/mapnew.xml","ui/uidata/mapnew/mapnew.png",function(){a.loadConfigCom()})},d.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas,this.bigPic.uiAtlas=this._topRender.uiAtlas,this.b_aer_map_but=this.addEvntButUp("b_aer_map_but",this._topRender),this.loadBigPicByUrl("ui/load/map/bigworld.jpg"),this.resetPicData(),this.applyLoadComplete()},d.prototype.resetPicData=function(){var a=tb.TB_world_map.getItem();this.wIconItem=new Array;for(var c=0;c<a.length;c++){var d=new b;d.tb_world_map=a[c],d.id=c,d.txt=this._topRender.getComponent("w_label"),d.txt.goToAndStop(d.id),this.addChild(d.txt),d.pic=this.addEvntButUp("w_icon",this._topRender),d.pic.data=d,d.pic.goToAndStop(c),d.pic.x=.95*d.tb_world_map.x-35,d.pic.y=.95*d.tb_world_map.y-40,d.txt.x=d.pic.x-15,d.txt.y=d.pic.y+d.pic.height,this.wIconItem.push(d)}},d.prototype.loadBigPicByUrl=function(a){return this.bigPic.setImgUrl(a),this.bigPicUI||(this.bigPicUI=this.addChild(this.bigPic.getComponent("b_world_map_pic"))),this.bigPicUI},d.prototype.butClik=function(c){switch(c.target){case this.e_close:this.hide();break;case this.b_aer_map_but:this.hide(),ModuleEventManager.dispatchEvent(new a.MapNewEvent(a.MapNewEvent.SHOW_MAP_NEW_EVENT));break;default:if(c.target.data instanceof b){var d=c.target.data;d.tb_world_map.mapid!=GuidData.map.tbMapVo.id&&d.isOpen?(this.hide(),NetManager.getInstance().protocolos.teleport_map(d.tb_world_map.mapid,GuidData.map.getLineID())):console.log("当前地图不传")}}},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d.prototype.show=function(){for(var a=0;a<this.wIconItem.length;a++)this.wIconItem[a].draw(this._topRender.uiAtlas);UIManager.getInstance().addUIContainer(this)},d}(WindowMinUi);a.MapNewWorldPanel=c}(mapnew||(mapnew={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mapnew;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MAP_FORM_MINI="SHOW_MAP_FORM_MINI",b.SHOW_MAP_NEW_EVENT="SHOW_MAP_NEW_EVENT",b.SHOW_MAP_NEW_WORLD_EVENT="SHOW_MAP_NEW_WORLD_EVENT",b.HIDE_MAP_NEW_EVENT="HIDE_MAP_NEW_EVENT",b.SELECT_MAP_NEW_CELL="SELECT_MAP_NEW_CELL",b}(BaseEvent);a.MapNewEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MapNewModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.MapNewModule=c;var d=function(c){function d(){var a=null!==c&&c.apply(this,arguments)||this;return a.lastOpenTab=0,a}return __extends(d,c),d.prototype.getName=function(){return"MapNewProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;if(c.type==b.SHOW_MAP_FORM_MINI&&(0==this.lastOpenTab?c.type=b.SHOW_MAP_NEW_EVENT:c.type=b.SHOW_MAP_NEW_WORLD_EVENT),c.type==b.SHOW_MAP_NEW_EVENT&&(this.showmapNewPanel(),this.lastOpenTab=0),c.type==b.SHOW_MAP_NEW_WORLD_EVENT&&(this.showMapNewWorldPanel(),this.lastOpenTab=1),this.mapNewPanel&&(c.type==b.HIDE_MAP_NEW_EVENT&&this.hidePanel(),c.type==b.SELECT_MAP_NEW_CELL)){var d=c.data;0==d.type&&(console.log("换线"),NetManager.getInstance().protocolos.change_line(Number(d.data))),1==d.type&&this.mapNewPanel.selectmapOBJ(d.data)}}},d.prototype.hidePanel=function(){this.mapNewPanel&&this.mapNewPanel.hide()},d.prototype.showmapNewPanel=function(){var b=this;this.mapNewPanel||(this.mapNewPanel=new a.MapNewPanel),this.mapNewPanel.load(function(){b.mapNewPanel.show()})},d.prototype.showMapNewWorldPanel=function(){var b=this;this.mapNewWorldPanel||(this.mapNewWorldPanel=new a.MapNewWorldPanel),this.mapNewWorldPanel.load(function(){b.mapNewWorldPanel.show()})},d.prototype.smsgSendMapLine=function(a){var b=new s2c_send_map_line;s2c_send_map_line.read(b,a),this.mapNewPanel.refreshLine(b)},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_SEND_MAP_LINE]=function(b){a.smsgSendMapLine(b)},b},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_MAP_NEW_EVENT),new b(b.HIDE_MAP_NEW_EVENT),new b(b.SELECT_MAP_NEW_CELL),new b(b.SHOW_MAP_NEW_WORLD_EVENT),new b(b.SHOW_MAP_FORM_MINI)]},d}(BaseProcessor);a.MapNewProcessor=d}(mapnew||(mapnew={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),minmap;!function(a){var b=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.binLocation=function(a){a.bindAttribLocation(this.program,0,"v3Pos"),a.bindAttribLocation(this.program,1,"v2uv")},b.prototype.getVertexShaderString=function(){var a="attribute vec3 v3Pos;attribute vec2 v2uv;uniform vec4 verdata;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2uv.x, v2uv.y);   vec4 vt0= vec4(v3Pos.x*verdata.z,v3Pos.y*verdata.w,v3Pos.z,1.0);vt0.xy+=verdata.xy;\n   gl_Position = vt0;}";return a},b.prototype.getFragmentShaderString=function(){var a=" precision mediump float;\nuniform sampler2D s_texture;\nuniform vec4 uvdata;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec2 scaleuv = v_texCoord;\nfloat angle =uvdata.w;vec4 np = vec4(sin(angle), cos(angle), 0, 0);\nscaleuv.x = np.x * v_texCoord.y + np.y * v_texCoord.x;\nscaleuv.y = np.y * v_texCoord.y - np.x * v_texCoord.x;\nscaleuv *= uvdata.z;\nscaleuv.xy += uvdata.xy;\nvec4 infoUv = texture2D(s_texture, scaleuv.xy);\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}";return a},b.MinMapImgShader="MinMapImgShader",b}(Shader3D),c=function(a){function c(){var b=a.call(this)||this;return b._scaleData=[0,0,1,1],b._rotation=0,b.keyScale=1,b.uvDataPos=new Vector2D,b}return __extends(c,a),c.prototype.initData=function(){this.objData=new ObjData,ProgrmaManager.getInstance().registe(b.MinMapImgShader,new b),this.shader=ProgrmaManager.getInstance().getProgram(b.MinMapImgShader),this.program=this.shader.program,this.objData.vertices.push(-1,1,0,1,1,0,1,-1,0,-1,-1,0),this.objData.uvs.push(-1,-1,1,-1,1,1,-1,1),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=6,this.objData.vertexBuffer=Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this._width=120,this._height=80},c.prototype.resize=function(){this.textureRes&&this.appleyPos()},c.prototype.setImgInfo=function(a){this.setImgUrl(a)},c.prototype.setImgUrl=function(a){var b=this;TextureManager.getInstance().getTexture(Scene_data.fileRoot+a,function(a){b.textureRes=a,b.resize(),b.keyScale=b.textureRes.width/AstarUtil.minMapRect.width})},c.prototype.appleyPos=function(){var a=this._width/Scene_data.stageWidth,b=this._height/Scene_data.stageHeight;this._scaleData[0]=1-a*UIData.Scale,this._scaleData[1]=1-b*UIData.Scale,this._scaleData[2]=a*UIData.Scale,this._scaleData[3]=b*UIData.Scale},c.prototype.setPostion=function(){var a=.5,b=GameInstance.mainChar.getCurrentPos(),c=b.x/AstarUtil.minMapRect.width*a,d=-b.z/AstarUtil.minMapRect.height*a;this.uvDataPos.x=c+.5,this.uvDataPos.y=d+.5,this._rotation=Scene_data.gameAngle*Math.PI/180},c.prototype.update=function(){if(this.objData&&this.texture){this.setPostion(),Scene_data.context3D.setBlendParticleFactors(0),Scene_data.context3D.setProgram(this.program),Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),Scene_data.context3D.setVc4fv(this.shader,"verdata",this._scaleData);var a=new Vector2D(this.uvDataPos.x,this.uvDataPos.y),b=new Vector2D(.1171875*this.keyScale,this._rotation);Scene_data.context3D.setVc4fv(this.shader,"uvdata",[a.x,a.y,b.x,b.y]),Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},c.prototype.interactiveEvent=function(a){return!1},c}(UIRenderComponent);a.MinMapImg=c}(minmap||(minmap={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),minmap;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.nextDrawGMtime=0,b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.right=0,b.top=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._effRender=new FrameUIRender,b.addRender(b._effRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._effGuaRender=new FrameUIRender,b.addRender(b._effGuaRender),b._effGuaRender.blenderMode=1,b._midRender.setInfo("ui/uidata/minmap/minmap.xml","ui/uidata/minmap/minmap.png",function(){b.loadConfigCom()}),b}return __extends(b,a),b.prototype.loadConfigCom=function(){var a=this;this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.a_bg_map=this.addChild(this._bottomRender.getComponent("w_bg")),this.a_map=this.addChild(this._topRender.getComponent("a_map")),this.a_map_name=this.addChild(this._topRender.getComponent("a_map_name")),this.a_money=this.addChild(this._topRender.getComponent("a_money")),this.a_exp=this.addChild(this._topRender.getComponent("a_exp")),this.a_guaji=this.addChild(this._topRender.getComponent("a_guaji")),this.a_pos_txt=this.addChild(this._topRender.getComponent("a_pos_txt")),this.a_map_icon=this._topRender.getComponent("a_map_icon"),this.addChild(this.a_map_icon),this.a_map_icon.goToAndStop(0),this.a_map_icon.addEventListener(InteractiveEvent.Up,this.butClik,this),this._effRender.setImg(getEffectUIUrl("ui_zidong"),4,4,function(b){a.expEff=b,a.expEff.x=a.a_guaji.x-10,a.expEff.y=a.a_guaji.y-38,a.expEff.width=a.expEff.baseRec.width,a.expEff.height=a.expEff.baseRec.height,a.expEff.speed=2,a.addChild(a.expEff)}),this._effGuaRender.setImg(getEffectUIUrl("ef_guangshu"),4,8,function(b){a.guaEff=b,a.guaEff.x=a.a_map_icon.x-8,a.guaEff.y=a.a_map_icon.y+8,a.guaEff.width=.5*a.guaEff.baseRec.width,a.guaEff.height=.5*a.guaEff.baseRec.height,a.guaEff.speed=2,1==a.a_map_icon.current&&a.addChild(a.guaEff)}),this.refresh()},b.prototype.butClik=function(a){var b=3;if(GuidData.map.isAdventureScene())b=1;else if(!GuidData.player.getsyspageopen(SharedDef.MODULE_WORLD_RISK,SharedDef.MODULE_WORLD_RISK_MAIN)){var c=tb.TB_system_base.getTempVo(10*SharedDef.MODULE_WORLD_RISK+SharedDef.MODULE_WORLD_RISK_MAIN);return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级"+c.level+"级后解锁",99)}ModulePageManager.openPanel(SharedDef.MODULE_TEST,b)},b.prototype.update=function(a){if(AstarUtil.minMapRect&&this.hasStage){var b=GameInstance.mainChar.getAstarPos();LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_pos_txt.skinName,ColorType.Yellowffe9b4+""+b.x+":"+b.y,14)}},b.prototype.refresh=function(){if(this._topRender.uiAtlas&&SceneManager.getInstance().ready){var a=adventure.AdventureModel.getInstance().getCurTb();GuidData.map.isAdventureScene()?(LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_map_name.skinName,ColorType.colorffe9b4+a.name,28),this.a_map_icon.goToAndStop(0),this.guaEff&&this.removeChild(this.guaEff)):(LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_map_name.skinName,ColorType.colorffe9b4+GuidData.map.tbMapVo.name,28),this.a_map_icon.goToAndStop(1),this.guaEff&&this.addChild(this.guaEff)),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_map.skinName,ColorType.Coffeeff9200+GuidData.map.tbMapVo.types,28);var b=360*a.expReward[1],c=LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_exp.skinName,ColorType.colorffe9b4+Snum(b)+"/小时 ",24,TextAlign.CENTER),d=360*a.goldReward[1];c=LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_money.skinName,ColorType.colorffe9b4+Snum(d)+"/小时",24,TextAlign.CENTER)}},b.prototype.resize=function(){a.prototype.resize.call(this)},b}(UIConatiner);a.MinMapPanel=b}(minmap||(minmap={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),minmap;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MinMapModule"},b.prototype.listProcessors=function(){return[new c]},b}(Module);a.MinMapModule=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.getName=function(){return"MapProcessor"},c.prototype.receivedModuleEvent=function(a){if(a instanceof EngineEvent){var b=a;b.type==EngineEvent.ENTER_SCENE_EVENT&&(this.showUi(),this._mapPanel.refresh())}if(a instanceof mainUi.MainUiEvent){var c=a;c.type==mainUi.MainUiEvent.SHOW_MAINUI_EVENT?this.showUi():c.type==mainUi.MainUiEvent.HIDE_MAINUI_EVENT&&this.hideUi()}},c.prototype.showUi=function(){this._mapPanel||(this._mapPanel=new a.MinMapPanel),GuidData.map.showAreaById(AreaType.toprightmap_4)&&UIManager.getInstance().addUIContainer(this._mapPanel)},c.prototype.hideUi=function(){this._mapPanel&&UIManager.getInstance().removeUIContainer(this._mapPanel)},c.prototype.listenModuleEvents=function(){return[new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT),new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT),new EngineEvent(EngineEvent.ENTER_SCENE_EVENT)]},c}(BaseProcessor);a.MinMapProcessor=c}(minmap||(minmap={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),dialog;!function(a){var b=function(){function a(){}return a}();a.QuestButVo=b;var c=function(a){function c(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.needSelectQuest=!1,b.endTime=0,b.center=0,b.bottom=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(c,a),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._midRender.dispose(),this._midRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/dialogue/dialogue.xml","ui/uidata/dialogue/dialogue.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._midRender.uiAtlas,this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.bg=this.addChild(this._bgRender.getComponent("bg")),this.bg.addEventListener(InteractiveEvent.Up,this.clickEvt,this),this.a_quest_bg_top=this._bottomRender.getComponent("a_quest_bg_top"),this.a_quest_bg_mid=this._bottomRender.getComponent("a_quest_bg_mid"),this.a_quest_bg_bottom=this._bottomRender.getComponent("a_quest_bg_bottom"),this.setUiListVisibleByItem([this.a_quest_bg_top,this.a_quest_bg_mid,this.a_quest_bg_bottom],!0),this.a_but_next=this.addEvntBut("a_but_next",this._topRender),this.a_talk_bg=this.addChild(this._bottomRender.getComponent("a_talk_bg")),this.a_title_bg=this.addChild(this._midRender.getComponent("a_title_bg")),this.a_npc_name=this.addChild(this._topRender.getComponent("a_npc_name")),this.a_talk_txt=this.addChild(this._topRender.getComponent("a_talk_txt")),this.questUiItemTXT=new Array;for(var a=0;3>a;a++){var c=new b;c.txt=this.addEvntBut("a_quest_"+a,this._topRender),c.bg=this._midRender.getComponent("a_quest_but_bg"),c.bg.x=c.txt.x,c.bg.y=c.txt.y-5,this.questUiItemTXT.push(c)}this.addRoleChar(),this.uiAtlasComplet=!0,this.applyLoadComplete(),this.refresh()},c.prototype.addRoleChar=function(){var a=this;this.roleChar=new DialogueUIChar,this.roleChar.loadFinishFun=function(){a.loadRoleFinish()},this._topRender.addModel(this.roleChar)},c.prototype.loadRoleFinish=function(){this.resize()},c.prototype.butClik=function(a){this.endTime=TimeUtil.getTimer()+100,a.target.data?this.selectQuestToPanel(a.target.data):this.selectButClik()},c.prototype.selectQuestToPanel=function(a){a.tb_quest.specialButton?(console.log(a.tb_quest.specialButton),this.sendToNpcTalk(this._entryId,a.id),this.close()):(this.needSelectQuest=!1,this.setButVisible(!1),this.setUiListVisibleByItem([this.a_quest_bg_top,this.a_quest_bg_mid,this.a_quest_bg_bottom],!1),this.selectQuestTaskVo=a,this.showTextList(this.selectQuestTaskVo.tb_quest.dialogue))},c.prototype.setButVisible=function(a){for(var b=0;b<this.questUiItemTXT.length;b++)this.setUiListVisibleByItem([this.questUiItemTXT[b].txt],!1),this.setUiListVisibleByItem([this.questUiItemTXT[b].bg],!1)},c.prototype.selectButClik=function(){this.selectQuestTaskVo&&this.selectQuestTaskVo.tb_quest.specialButton?this.close():this.selectDialogueVo.next_id?this.showTextList(this.selectDialogueVo.next_id):this.needSelectQuest?GameInstance.questMoveVo&&this.selectQuestToPanel(GameInstance.questMoveVo.data):(!this.needSelectQuest&&this.selectQuestTaskVo&&this.sendToNpcTalk(this._entryId,this.selectQuestTaskVo.id),this.close())},c.prototype.sendToNpcTalk=function(a,b){for(var c=0;c<GameInstance.roleList.length;c++)if(GameInstance.roleList[c].unit.getEntry()==a)return console.log("发送",GameInstance.roleList[c].unit.getUintGuid(),b),void NetManager.getInstance().protocolos.talk_with_npc(GameInstance.roleList[c].unit.getUintGuid(),b)},c.prototype.clickEvt=function(a){this.endTime<TimeUtil.getTimer()&&this.uiAtlasComplet&&this.selectButClik()},c.prototype.close=function(){UIManager.getInstance().removeUIContainer(this),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),Engine.resetViewMatrx3D()},c.prototype.refresh=function(){if(this.selectQuestTaskVo=null,this.a_talk_txt){var a=tb.TB_creature_template.get_TB_creature_template(this._entryId),b=quest.QuestModel.getInstance().getQuestDialogueVo(this._entryId);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_npc_name.skinName,a.name,18,TextAlign.CENTER,"#ffde45");for(var c=!1,d=0;d<b.length;d++)b[d].tb_quest.specialButton&&(c=!0);this.setButVisible(!1);var e=a.dialogue_id;if(b.length>1||c){var f=Math.min(3,b.length);this.a_quest_bg_top.y=350-(32+45*f),this.a_quest_bg_mid.y=this.a_quest_bg_top.y+this.a_quest_bg_top.height,
this.a_quest_bg_mid.height=45*f,this.a_quest_bg_bottom.y=this.a_quest_bg_mid.y+this.a_quest_bg_mid.height,this.a_quest_bg_mid.x=this.a_quest_bg_top.x,this.a_quest_bg_bottom.x=this.a_quest_bg_top.x,this.showQuestListBut(b),this.needSelectQuest=!0,this.setUiListVisibleByItem([this.a_quest_bg_top,this.a_quest_bg_mid,this.a_quest_bg_bottom],!0)}else this.setUiListVisibleByItem([this.a_quest_bg_top,this.a_quest_bg_mid,this.a_quest_bg_bottom],!1);1==b.length&&(e=b[0].tb_quest.dialogue,this.selectQuestTaskVo=b[0]),this.showTextList(e),this.endTime=TimeUtil.getTimer()+100}},c.prototype.showQuestListBut=function(a){for(var b=0;b<this.questUiItemTXT.length&&3>b;b++)if(Boolean(a[b])){this.setUiListVisibleByItem([this.questUiItemTXT[b].txt],!0),this.setUiListVisibleByItem([this.questUiItemTXT[b].bg],!0),this.questUiItemTXT[b].bg.x=this.a_quest_bg_top.x+20,this.questUiItemTXT[b].txt.x=this.a_quest_bg_top.x+20,this.questUiItemTXT[b].bg.y=45*b+this.a_quest_bg_top.y+this.a_quest_bg_top.height,this.questUiItemTXT[b].txt.y=this.questUiItemTXT[b].bg.y+15,this.questUiItemTXT[b].txt.data=a[b];var c=a[b].tb_quest.questName;a[b].tb_quest.specialButton&&(c=a[b].tb_quest.specialButton),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.questUiItemTXT[b].txt.skinName,"[59d9fe]"+c,16,TextAlign.CENTER)}},c.prototype.showTextList=function(a){this.selectDialogueVo=tb.TB_creature_dialogue.get_TB_creature_dialogue(a);var b=this.selectDialogueVo.npc_dialogue;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_talk_txt.skinName,b,16,TextAlign.LEFT);var c=tb.TB_creature_template.get_TB_creature_template(this._entryId);this.roleChar.setAvatar(c.avatar),this.resize()},c.prototype.resize=function(){a.prototype.resize.call(this),this.roleChar&&(this.roleChar.scale=5*UIData.Scale,this.roleChar.x=100,this.roleChar.y=600+this.y/2,this.roleChar.resize(),this.roleChar.updateMatrix()),this.bg&&(this.bg.left=0,this.bg.top=0,this.bg.width=Scene_data.stageWidth/UIData.Scale,this.bg.height=Scene_data.stageHeight/UIData.Scale,this.a_talk_bg.left=0,this.a_talk_bg.bottom=0,this.a_talk_bg.width=Scene_data.stageWidth/UIData.Scale)},c.prototype.show=function(a){this._entryId=a,this.refresh()},c.prototype.setCamViewMatrx3d=function(){Scene_data.viewMatrx3D.identity();var a=Scene_data.stageWidth,b=Scene_data.stageHeight;Scene_data.sceneViewHW=Math.max(a,b),Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(Engine.sceneCamScale,1,50,Scene_data.camFar),Scene_data.viewMatrx3D.appendScale(1*(Scene_data.sceneViewHW/a*2),a/b*(Scene_data.sceneViewHW/a*2),1),Scene_data.viewMatrx3D.appendScale(1,1,.1),Scene_data.viewMatrx3D.appendTranslation(0,0,.9)},c}(UIPanel);a.DialoguePanel=c}(dialog||(dialog={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),dialog;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"DialogueModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.DialogueModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_DIALOGUE_PANEL="SHOW_DIALOGUE_PANEL",b.HIDE_DIALOGUE_PANEL="HIDE_DIALOGUE_PANEL",b}(BaseEvent);a.DialogueEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"DialogueProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_DIALOGUE_PANEL&&1==SceneManager.getInstance().render&&this.showDialoguePanel(b.entryId),b.type==c.HIDE_DIALOGUE_PANEL&&this._dialoguePanel&&this._dialoguePanel.hasStage&&(UIManager.getInstance().removeUIContainer(this._dialoguePanel),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)))}if(a instanceof UIPanelEvent){var d=a;d.panel==this._dialoguePanel&&(this._dialoguePanel.dispose(),this._dialoguePanel=null,console.log("释放面板 _dialoguePanel"))}},d.prototype.showDialoguePanel=function(b){var c=this;if(GuidData.map.isBaseMap()){var d=quest.QuestModel.getInstance().getQuestDialogueVo(b);if(0==d.length){var e=tb.TB_creature_template.get_TB_creature_template(b);if(this.npcFun(e.dialogue_id))return}this._dialoguePanel||(this._dialoguePanel=new a.DialoguePanel),this._dialoguePanel.show(b),this._dialoguePanel.load(function(){ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),UIManager.getInstance().addUIContainer(c._dialoguePanel),c._dialoguePanel.setCamViewMatrx3d()})}},d.prototype.npcFun=function(a){var b=tb.TB_creature_dialogue.get_TB_creature_dialogue(a);return b.type>0?(1==b.type&&ModulePageManager.openNpcPanel(b.typedata[0][0],b.typedata[1]),!0):!1},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_DIALOGUE_PANEL),new c(c.HIDE_DIALOGUE_PANEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.DialogueProcessor=d}(dialog||(dialog={}));var kuafu;!function(a){var b=function(){function a(){this.tb_kuafu3v3_base=tb.TB_kuafu3v3_base.getItem()[0]}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.frameUpData=function(){if(GuidData.map.is3V3()||GuidData.map.isWorldBoss()){if(this.nextCatchTime<TimeUtil.getTimer())for(var a=GameInstance.roleList,b=0;a&&b<a.length;b++){var c=a[b];GameMouseManager.getInstance().isCatchSceneCharDis(c)&&(NetManager.getInstance().protocolos.use_gameobject(c.unit.getUintGuid()),this.nextCatchTime=TimeUtil.getTimer()+1e3)}TimeUtil.getTimer()>this.lastTm&&(RelationManager.getInstance().refresh(),this.lastTm=TimeUtil.getTimer()+1e3)}},a.prototype.get_month_reward_item=function(){for(var a,b=tb.TB_kuafu3v3_month_reward.getItem(),c=GuidData.player.getPlayerIntFieldWorld3V3TotalScore1(),d=0;d<b.length;d++)c>=b[d].score&&(a=b[d]);return a},a.prototype.mergeTypeGameToPk=function(){var a=new ByteArray;a.endian=Endian.LITTLE_ENDIAN,a.optcode=124,a.writeUint16(124),a.writeBytes(this.worldWarByte),NetManager.getInstance().send(a)},a.prototype.refreshKufuData=function(a){void 0===a&&(a=null),this.kuafuItem=GuidData.map.getKuafu3V3DataItem(),this.killTittleTxt=new Vector2D;for(var b=0;b<this.kuafuItem.length;b++)this.kuafuItem[b].name==GuidData.player.getName()&&(this.selfVo=this.kuafuItem[b]),1==this.kuafuItem[b].dieState&&(1==this.kuafuItem[b].group?this.killTittleTxt.x++:this.killTittleTxt.y++)},Object.defineProperty(a.prototype,"isSelfDie",{get:function(){return this.selfVo&&1==this.selfVo.dieState?!0:!1},enumerable:!0,configurable:!0}),a.nextCatchTime=0,a.lastTm=0,a}();a.KuaFu3v3Model=b}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kuafu;!function(a){var b=function(){function a(){}return a}();a.Kuafu1v1UI=b;var c=function(c){function d(){var a=c.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.top=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._timeRender=new UIRenderComponent,a.addRender(a._timeRender),a._topRender.uiAtlas=new UIAtlas,a._frameFun=function(b){a.upTime(b)},a}return __extends(d,c),d.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._timeRender.dispose(),this._timeRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},d.prototype.applyLoad=function(){var a=this;this._topRender.uiAtlas.setInfo("ui/uidata/kuafu/1v1/kuafu1v1.xml","ui/uidata/kuafu/1v1/kuafu1v1.png",function(){a.loadConfigCom()})},d.prototype.loadConfigCom=function(){this._timeRender.uiAtlas=this._topRender.uiAtlas,this._bottomRender.uiAtlas=this._topRender.uiAtlas,this._midRender.uiAtlas=this._topRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_left_color")),this.addChild(this._bottomRender.getComponent("a_right_color")),this.addChild(this._bottomRender.getComponent("a_life_bg0")),this.addChild(this._bottomRender.getComponent("a_life_bg1")),this.addChild(this._bottomRender.getComponent("a_headbg0")),this.addChild(this._bottomRender.getComponent("a_headbg1")),this.addChild(this._topRender.getComponent("a_zl_label1")),this.addChild(this._topRender.getComponent("a_zl_label0")),this.addLeft(),this.addRight(),this.addChild(this._topRender.getComponent("a_time_bg")),this.a_time_txt=this.addChild(this._timeRender.getComponent("a_time_txt")),this.applyLoadComplete()},d.prototype.show=function(){var b=1e3*GameInstance.getGameSecond(GuidData.map.getMapIntFieldStartTm());b>0?PopTimeOutUtil.show(PopTimeOutUtil.PLAYGO,b,function(){AotuSkillManager.getInstance().aotuBattle=!0}):AotuSkillManager.getInstance().aotuBattle=!0,this.endTime=TimeUtil.getTimer()+1e3*GameInstance.getGameSecond(GuidData.map.getMapIntFieldQuestEndTm()),TimeUtil.addFrameTick(this._frameFun),UIManager.getInstance().addUIContainer(this),a.KuaFu1v1Model.getInstance().setFullHp()},d.prototype.close=function(){UIManager.getInstance().removeUIContainer(this)},d.prototype.upTime=function(a){var b=Math.ceil((this.endTime-TimeUtil.getTimer())/1e3);if(this.hasStage){var c="00:00";if(b>0){var d=Math.floor(b/60%60),e=Math.floor(b%60);c=String(10>d?"0":"")+String(d)+":"+String(10>e?"0":"")+String(e)}this.lastTimeStr!=c&&(this.lastTimeStr=c,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_time_txt.skinName,c,16,TextAlign.CENTER,ColorType.Yellowffe9b4),this.refresh())}else TimeUtil.removeFrameTick(this._frameFun)},d.prototype.refresh=function(){var b=a.KuaFu1v1Model.getInstance().get1V1sceneData();2==b.length&&(GuidData.player.getName()==b[0].name?(this.drawLeft(b[0]),this.drawRight(b[1])):(this.drawLeft(b[1]),this.drawRight(b[0])))},d.prototype.drawLeft=function(a){var b=this.leftKuafu1v1UI;this.setUvScaleByUi(b.lifeUi,a.life),this.drawPublicTempVo(b,a)},d.prototype.drawPublicTempVo=function(a,b){this.drawHead(a.headUi,b.charType,b.level),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,a.levelUi.skinName,"LV "+String(b.level),16,TextAlign.CENTER,ColorType.Yellowffe9b4),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,a.forceUi.skinName,String(Math.floor(b.force)),16,TextAlign.CENTER,ColorType.Yellowffe9b4),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,a.nameUi.skinName,ColorType.Yellowffe9b4+getBaseName(b.name),16),b.vip>0?this.drawVipToCtx(a.vipUi,b.vip):this._topRender.uiAtlas.clearCtxTextureBySkilname(a.vipUi.skinName)},d.prototype.drawVipToCtx=function(a,b){var c=this._topRender.uiAtlas.getRec(a.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.A_V,new Rectangle(0,0,22,19),UIData.publicUi),ArtFont.getInstance().writeFontToCtxLeft(d,String(b),ArtFont.BigYellow,25,3),this._topRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},d.prototype.drawRight=function(a){var b=this.rightKuafu1v1UI;b.lifeUi.uvScale=a.life,this.drawPublicTempVo(b,a)},d.prototype.setUvScaleByUi=function(a,b){a.renderX=a.absoluteX/Scene_data.stageWidth,a.renderY=a.absoluteY/Scene_data.stageHeight,a.renderWidth=a.absoluteWidth/Scene_data.stageWidth,a.renderHeight=a.absoluteHeight/Scene_data.stageHeight,a.renderData[0]=a.renderX+a.renderWidth*(1-b),a.renderData[2]=a.renderWidth*b,a.renderData2[0]=a.tr.width*b,a.renderData2[2]=a.tr.x+a.tr.width*(1-b),a.uiRender.makeRenderDataVc(a.vcId)},d.prototype.drawHead=function(a,b,c){var d=this;a.data||(a.data=!0,IconManager.getInstance().getIcon(getTouPic(b),function(b){var c=d._topRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);e.drawImage(b,0,0,c.pixelWitdh,c.pixelHeight),d._topRender.uiAtlas.updateCtx(e,c.pixelX,c.pixelY)}))},d.prototype.addLeft=function(){var a=new b;a.nameUi=this.addChild(this._midRender.getComponent("a_left_name")),a.forceUi=this.addChild(this._midRender.getComponent("a_left_zl")),a.headUi=this.addChild(this._midRender.getComponent("a_left_head")),a.lifeUi=this.addChild(this._midRender.getComponent("a_left_life")),a.vipUi=this.addChild(this._midRender.getComponent("a_left_vip")),a.levelUi=this.addChild(this._midRender.getComponent("a_left_level")),this.leftKuafu1v1UI=a},d.prototype.addRight=function(){var a=new b;a.nameUi=this.addChild(this._midRender.getComponent("a_right_name")),a.forceUi=this.addChild(this._midRender.getComponent("a_right_zl")),a.headUi=this.addChild(this._midRender.getComponent("a_right_head")),a.lifeUi=this.addChild(this._midRender.getComponent("a_right_life")),a.vipUi=this.addChild(this._midRender.getComponent("a_right_vip")),a.levelUi=this.addChild(this._midRender.getComponent("a_right_level")),this.rightKuafu1v1UI=a},d}(UIPanel);a.Kuafu1v1SceneTopPanel=c}(kuafu||(kuafu={}));var kuafu;!function(a){var b=function(){function a(){}return a}();a.KuaFu1v1BangData=b;var c=function(){function a(){}return a}();a.Scene1v1Data=c;var d=function(){function a(){this.tb_doujiantai_base=tb.TB_doujiantai_base.get_TB_doujiantai_baseById(1)}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.get1V1sceneData=function(){for(var a=new Array,b=0;b<GameInstance.roleList.length;b++)a.push(this.getScene1v1DataByUnit(GameInstance.roleList[b].unit));return a},a.prototype.getScene1v1DataByUnit=function(a){var b=new c;return b.charType=a.getCharType(),b.name=a.getName(),b.force=a.getForce(),b.level=a.getLevel(),b.vip=a.getVipLevel(),b.life=a.getHp()/a.getMaxHp(),b},a.prototype.setFullHp=function(){for(var a=0;a<GameInstance.roleList.length;a++)GameInstance.roleList[a].setHp(GameInstance.roleList[a].unit.getMaxHp()),console.log(GameInstance.roleList[a].unit.getHp(),GameInstance.roleList[a].unit.getMaxHp()),GameInstance.roleList[a].refreshHP()},a}();a.KuaFu1v1Model=d}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kuafu;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_1V1_LOG_PANEL="SHOW_1V1_LOG_PANEL",b.SHOW_1V1_SCENE_PANEL="SHOW_1V1_SCENE_PANEL",b.SHOW_1V1_END_PANEL="SHOW_1V1_END_PANEL",b}(BaseEvent);a.KuaFu1v1Event=b;var c=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"KuaFu1v1Processor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;c.type==b.SHOW_1V1_LOG_PANEL,c.type==b.SHOW_1V1_SCENE_PANEL&&this.showKuafu1v1SceneTopPanel(),c.type==b.SHOW_1V1_END_PANEL}if(a instanceof UIPanelEvent){var d=a;d.panel==this._kuafu1v1SceneTopPanel&&(this._kuafu1v1SceneTopPanel.dispose(),this._kuafu1v1SceneTopPanel=null,console.log("释放面板 _kuafu1v1SceneTopPanel"))}},d.prototype.showKuafu1v1SceneTopPanel=function(){var b=this;this._kuafu1v1SceneTopPanel||(this._kuafu1v1SceneTopPanel=new a.Kuafu1v1SceneTopPanel),this._kuafu1v1SceneTopPanel.load(function(){b._kuafu1v1SceneTopPanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_1V1_LOG_PANEL),new b(b.SHOW_1V1_SCENE_PANEL),new b(b.SHOW_1V1_END_PANEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.KuaFu1v1Processor=c}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kuafu;!function(a){var b=function(b){function c(){var c=b.call(this)||this;return c._selIdx=SharedDef.MODULE_ARENA_DOUJIANTAI,c.width=UIData.designWidth,c.height=UIData.designHeight,c.center=0,c.middle=0,c._baseRender=new UIRenderComponent,c.addRender(c._baseRender),c._topRender=new UIRenderComponent,c.addRender(c._topRender),c._baseUiAtlas=new UIAtlas,c._arenaQualifying=new a.ArenaQualifying,c._arenaDjPanel=new a.ArenaDjPanel,c}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,b.prototype.dispose.call(this)},c.prototype.butClik=function(a){a.target==this.w_close?this.hide():a.target==this.tab1dis&&msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.tab1dis.data.level+"级后解锁",99)},c.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/kuafu/arena/arena.xml","ui/uidata/kuafu/arena/arena.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this._topRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this.initUI(),this._arenaDjPanel.setUIAtlas(this._baseUiAtlas,this.winmidRender),this._arenaQualifying.setUIAtlas(this._baseUiAtlas,this.winmidRender),console.log("---初始化结束"),this.resize(),this.applyLoadComplete()},c.prototype.djData=function(a){console.log("---斗剑台排行---",a),this._arenaDjPanel&&this._arenaDjPanel&&this._arenaDjPanel.setListData(a)},c.prototype.qualifyDataChg=function(){this._arenaQualifying&&this._arenaQualifying.hasStage&&this._arenaQualifying.dataChg()},c.prototype.qualifyRankChg=function(a){this._arenaQualifying&&this._arenaQualifying.hasStage&&this._arenaQualifying.drawRank(a)},c.prototype.djRewardChg=function(){this._arenaDjPanel&&this._arenaDjPanel.hasStage&&this._arenaDjPanel.djRewardChg()},c.prototype.initUI=function(){this.addUIList(["t_win_bian"],this.winmidRender),this.addUIList(["t_win_line"],this._topRender),this.addChild(this._baseRender.getComponent("t_win_title")),this.aryTab=new Array;for(var a=0;2>a;a++){var b=this.addEvntBut("t_tab"+a,this._baseRender);b.data=SharedDef.MODULE_ARENA_DOUJIANTAI+3*a,b.addEventListener(InteractiveEvent.Up,this.tabClick,this),this.aryTab.push(b)}this.tab1dis=this._baseRender.getComponent("t_tab1_dis"),this.tab1dis.addEventListener(InteractiveEvent.Up,this.butClik,this)},c.prototype.showTab1=function(){this.tab1dis.parent&&this.refreshOpenLev(this.aryTab[1])},c.prototype.refreshOpenLev=function(a){var b=a.data;if(b==SharedDef.MODULE_ARENA_DOUJIANTAI)return void this.setUiListVisibleByItem([a],!0);if(GuidData.player.getsyspageopen(SharedDef.MODULE_ARENA,b))this.setUiListVisibleByItem([a],!0),this.setUiListVisibleByItem([this.tab1dis],!1);else{var c=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_ARENA+b));this.setUiListVisibleByItem([a],!1),this.setUiListVisibleByItem([this.tab1dis],!0),this.tab1dis.data=c,this.tab1dis.y=a.y}},c.prototype.tabClick=function(a){this.setIdx(a.target.data)},c.prototype.setIdx=function(a){a==SharedDef.MODULE_ARENA_DOUJIANTAI?(this.aryTab[0].selected=!0,this.aryTab[1].selected=!1,this._arenaDjPanel.show(),this._arenaQualifying.hide()):a==SharedDef.MODULE_ARENA_RANK&&(this.aryTab[0].selected=!1,this.aryTab[1].selected=!0,this._arenaDjPanel.hide(),this._arenaQualifying.show()),this._selIdx=a},c.prototype.getTabidx=function(a,b){return a.indexOf(b)},c.prototype.show=function(a,b){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]);for(var c=0;c<this.aryTab.length;c++){var d=this.getTabidx(a,Number(this.aryTab[c].data));-1!=d?(this.aryTab[c].y=95*d+95,this.refreshOpenLev(this.aryTab[c])):this.setUiListVisibleByItem([this.aryTab[c],this.tab1dis],!1)}this._baseRender.uiAtlas&&this.setIdx(b)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this._selIdx==SharedDef.MODULE_ARENA_DOUJIANTAI?this._arenaDjPanel.hide():this._selIdx==SharedDef.MODULE_ARENA_RANK&&this._arenaQualifying.hide(),SceneManager.getInstance().render=!0,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),b.prototype.hide.call(this)},c.prototype.leadDataChg=function(){},c.prototype.tripDataChg=function(){},c.prototype.djChg=function(){this._arenaDjPanel&&this._arenaDjPanel.hasStage&&this._arenaDjPanel.dataChg()},c}(WindowUi);a.ArenaPanel=b}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kuafu;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a._lastTime=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a}return __extends(d,b),d.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this._topRender=new UIRenderComponent,this._topRender.uiAtlas=a,this.addRender(this._topRender),this.initUI()},d.prototype.initUI=function(){this._shopBtn=this.addChild(this._baseRender.getComponent("a_icon1")),this._shopBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._rankBtn=this.addChild(this._bgRender.getComponent("a_icon4")),this._rankBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._rewardBtn=this.addChild(this._bgRender.getComponent("a_icon2")),this._rewardBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._logBtn=this.addChild(this._bgRender.getComponent("a_icon3")),this._logBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._winUIRenderAry=this.getUIList(["a_bg","a_line","a_di0","a_di1","a_di2"],this._winMidRender),this.addUIList(["a_title_bg0","a_title_bg1","a_title_bg2","a_rankBg","a_rankBg1","a_rankBg2","a_rankBg3","a_di","a_u_bg1","a_u_bg2","a_u_bg3","a_u_bg01","a_u_bg02","a_u_bg03"],this._bgRender),this._itemDjRoleAry=new Array;for(var a=0;3>a;a++){var b=new c;b.init(this._bgRender,this._baseRender,a,this),this._itemDjRoleAry.push(b)}var d;d=this.addChild(this._bgRender.getComponent("a_btn")),this.addChild(this._baseRender.getComponent("t_btn_name2")),d.addEventListener(InteractiveEvent.Up,this.refreshEnemy,this),d=this.addChild(this._baseRender.getComponent("a_add_btn1")),d.addEventListener(InteractiveEvent.Up,this.clearCD,this),d=this.addChild(this._baseRender.getComponent("a_add_btn2")),d.addEventListener(InteractiveEvent.Up,this.showBuyMeshBoss,this),this._myRank=this.addChild(this._baseRender.getComponent("a_mylab1")),this._myForce=this.addChild(this._baseRender.getComponent("a_mylab2")),this._myDh=this.addChild(this._baseRender.getComponent("a_bottom_lab1")),this._timeLab=this.addChild(this._baseRender.getComponent("a_bottom_lab2")),this.c_vip_add=this.addChild(this._baseRender.getComponent("c_vip_add")),this.challengeLab=this.addChild(this._baseRender.getComponent("a_bottom_lab3")),this.addSelfRole(),this.drawBaseInfo(),this.drawChallengNum()},d.prototype.initUpdate=function(){var a=this;this._upFun||(this._upFun=function(){a.drawTime()}),TimeUtil.addTimeTick(1e3,this._upFun)},d.prototype.addSelfRole=function(){this.selfRole=new Person2DChar,this._bgRender.addModel(this.selfRole),this.selfRole.setBaseRoleAvatar(GuidData.player.getAvatar(),GuidData.player.getCharType()),this.selfRole.setBaseRoleWeapon(GuidData.player.getDivineID(),GuidData.player.getCharType()),this.resize()},d.prototype.drawBaseInfo=function(){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._myRank.skinName,"我的排名:"+GuidData.player.get1v1Rank(),16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._myForce.skinName,"我的战力:"+Snum(GuidData.player.getForce()),16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._myDh.skinName,"荣誉:"+GuidData.player.getResTypeStr(7),16,TextAlign.LEFT,ColorType.Brown7a2f21)},d.prototype.dataChg=function(){this.drawChallengNum()},d.prototype.djRewardChg=function(){this._rewardPanel&&this._rewardPanel.hasStage&&this._rewardPanel.djRewardChg()},d.prototype.clearCD=function(a){UiTweenScale.getInstance().changeButSize(a.target);var b=GameInstance.getGameSecond(GuidData.instanceData.getDJcdtime());if(0>=b)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"无冷却时间，不需要清除",99);var c=Math.ceil(b/60);AlertUtil.show(ColorType.Brown7a2f21+"您是否花费"+ColorType.Green2ca937+c+"元宝"+ColorType.Brown7a2f21+"重置挑战冷却时间(1分钟=1元宝)","",function(a){1==a&&costRes([1,c],function(){NetManager.getInstance().protocolos.doujiantai_clearcd()},function(){})})},d.prototype.drawTime=function(){var a=GameInstance.getGameSecond(GuidData.instanceData.getDJcdtime());if(a>0){if(this._lastTime==a)return;this._lastTime=a;var b=TimeUtil.getLocalTime3(a);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._timeLab.skinName,"挑战冷却:"+b,16,TextAlign.LEFT,ColorType.Brown7a2f21)}else LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._timeLab.skinName,"挑战冷却:00:00",16,TextAlign.LEFT,ColorType.Brown7a2f21)},d.prototype.drawChallengNum=function(){var a=GuidData.instanceData.getHasChallengeNum(),b=TableData.getInstance().getData(TableData.tb_doujiantai_base,1),c=b.dailytimes,d=c-a+GuidData.instanceData.getCanbuyChallengeNum()+"/"+c;LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.challengeLab.skinName,"挑战次数:"+d,16,TextAlign.LEFT,ColorType.Brown7a2f21)},d.prototype.setListData=function(a){for(var b=0;b<this._itemDjRoleAry.length;b++)this._itemDjRoleAry[b].setData(a[b])},d.prototype.refreshEnemy=function(a){UiTweenScale.getInstance().changeButSize(a.target),NetManager.getInstance().protocolos.doujiantai_refresh_enemys()},d.prototype.showBuyMeshBoss=function(a){UiTweenScale.getInstance().changeButSize(a.target);var b=GuidData.instanceData.getHasChallengeNum(),c=TableData.getInstance().getData(TableData.tb_doujiantai_base,1),d=(c.dailyTimes+tb.TB_vip_base.get_TB_vip_baseById(GuidData.player.getVipLevel()).djtBuyTimes,GuidData.instanceData.getCanbuyChallengeNum());if(d>=b)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"当前挑战次数已满，请消耗一些再来购买",99);var e=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL);e.resoureItem=new Array;for(var f=c.buyInfo.length,g=d;f>g&&b>g;g++)e.resoureItem.push(converItem2Cost(c.buyInfo[g]));e.Info1="斗剑台剩余可购买",e.cutNum=e.resoureItem.length,e.cutNum>0?(e.SubmitFun=function(a){NetManager.getInstance().protocolos.doujiantai_buytime(a)},ModuleEventManager.dispatchEvent(e)):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"购买次数满了",99)},d.prototype.itemIconClick=function(b){var c=this;UiTweenScale.getInstance().changeButSize(b.target),b.target==this._logBtn?(this._logPanel||(this._logPanel=new a.ArenaQualifyingLog),this._logPanel.load(function(){c._logPanel.show(c._baseUiAtlas,1)})):b.target==this._rewardBtn?(this._rewardPanel||(this._rewardPanel=new a.ArenaDjRewardPanel),this._rewardPanel.load(function(){c._rewardPanel.show()})):b.target==this._shopBtn?ModulePageManager.openPanel(SharedDef.MODULE_MALL,[SharedDef.MODULE_MALL_SCORE,2]):b.target==this._rankBtn&&NetManager.getInstance().protocolos.doujiantai_get_rank(1,10)},d.prototype.resize=function(){b.prototype.resize.call(this),this.selfRole&&(this.selfRole.resize(),this.selfRole.scale=3.5*UIData.Scale,this.selfRole.x=200*UIData.Scale,this.selfRole.y=-50*UIData.Scale)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.c_vip_add.skinName,getvipadd("djtReward"),14,TextAlign.CENTER,ColorType.color9a683f),this._baseUiAtlas&&(this.addWinmid(),NetManager.getInstance().protocolos.doujiantai_get_enemys_info(),this.drawBaseInfo(),this.drawChallengNum()),this.initUpdate()},d.prototype.addWinmid=function(){for(var a=0;a<this._winUIRenderAry.length;a++)this.addChild(this._winUIRenderAry[a])},d.prototype.removeWinmid=function(){for(var a=0;a<this._winUIRenderAry.length;a++)this.removeChild(this._winUIRenderAry[a])},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.removeWinmid(),TimeUtil.removeTimeTick(this._upFun)},d}(UIConatiner);a.ArenaDjPanel=b;var c=function(){function a(){this.id=0,this.role=new Person2DChar,this.resize()}return a.prototype.resize=function(){this.role.scale=3*UIData.Scale,this.role.x=(60-125*this.id)*UIData.Scale,this.role.y=-50*UIData.Scale,this.role.resize()},a.prototype.init=function(a,b,c,d){a.addModel(this.role),this.id=c,this.nameUI=d.addChild(b.getComponent("a_name"+c)),this.froceUI=d.addChild(b.getComponent("a_force"+c)),this.rankUI=d.addChild(b.getComponent("a_rank"+c)),this.challengeBut=d.addChild(b.getComponent("a_tz"+c)),this.challengeBut.addEventListener(InteractiveEvent.Up,this.onClick,this),this.rewardUI=d.addChild(b.getComponent("a_reward"+c));var e=TableData.getInstance().getData(TableData.tb_doujiantai_base,1),f="挑战奖励:"+getResName(e.tryReward[0][0])+Snum(e.tryReward[0][1]);LabelTextFont.writeSingleLabel(this.rewardUI.uiRender.uiAtlas,this.rewardUI.skinName,f,16,TextAlign.CENTER,ColorType.Whitefff4d6)},a.prototype.setData=function(a){this.data=a,LabelTextFont.writeSingleLabel(this.nameUI.uiRender.uiAtlas,this.nameUI.skinName,a.name,16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.froceUI.uiRender.uiAtlas,this.froceUI.skinName,"战力："+a.force,14,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.rankUI.uiRender.uiAtlas,this.rankUI.skinName,"第"+a.rank+"名",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.role.setBaseRoleAvatar(a.avatar,a.gender),this.role.setBaseRoleWeapon(a.divine,a.gender),this.resize()},a.prototype.onClick=function(a){UiTweenScale.getInstance().changeButSize(a.target),NetManager.getInstance().protocolos.doujiantai_fight(this.data.postion-1)},a}();a.ItemDjRole=c}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kuafu;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._idx=-1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b.setBlackBg(),b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._baseUiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bgRender.dispose(),this._bgRender=null,a.prototype.dispose.call(this)},b.prototype.butClik=function(a){a.target==this.e_close&&this.hide()},b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/kuafu/arena/arenadjreward.xml","ui/uidata/kuafu/arena/arenadjreward.png",function(){a.loadConfigCom()},"ui/uidata/kuafu/arena/arenadjrewardbtn.png")},b.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this.initUI(),this.applyLoadComplete(),this.resize()},b.prototype.initUI=function(){this.addChild(this.winmidRender.getComponent("t_main_bg"));var a=["首胜奖励","每日排名","每日连胜","挑战奖励"];this._btnAry=new Array;for(var b=0;4>b;b++){var c=this.addChild(this._bgRender.getComponent("t_btn"+b));
c.goToAndStop(1),c.data=b,c.addEventListener(InteractiveEvent.Down,this.onClick,this),this._btnAry.push(c);var d=this.addChild(this._baseRender.getComponent("t_btn_lab"+b));LabelTextFont.writeSingleLabel(this._baseUiAtlas,d.skinName,a[b],14,TextAlign.CENTER,ColorType.Brown7a2f21)}this._title1=this.addChild(this._baseRender.getComponent("t_title1")),this._title2=this._baseRender.getComponent("t_title2"),this._titleLab1=this._baseRender.getComponent("t_title_lab1"),this._titleLab2=this._baseRender.getComponent("t_title_lab2"),this._titleBg1=this._bgRender.getComponent("t_title_bg1"),this._titleBg2=this._bgRender.getComponent("t_title_bg2"),this.addChild(this._bgRender.getComponent("a_title")),this.hasStage&&this.setIdx(0)},b.prototype.addReward=function(){this._rewardList||(this._rewardList=new c,this._rewardList.init(this._baseUiAtlas)),this._rewardList.show(),this._infoList&&this._infoList.hide()},b.prototype.addInfo=function(a){this._infoList||(this._infoList=new e,this._infoList.init(this._baseUiAtlas)),this._infoList.show(a),this._rewardList&&this._rewardList.hide()},b.prototype.hideList=function(){this._infoList&&this._infoList.hide(),this._rewardList&&this._rewardList.hide()},b.prototype.setIdx0=function(){this.addListTitle(),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._title1.skinName,"最佳首胜排名："+GuidData.instanceData.getvictoryrecord(),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._title2.skinName,"首次胜利挑战以下名次将获得以下奖励：",14,TextAlign.CENTER,ColorType.Green2ca937),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._titleLab1.skinName,"首胜排名",16,TextAlign.CENTER,ColorType.color9a683f),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._titleLab2.skinName,"排名奖励",16,TextAlign.CENTER,ColorType.color9a683f),this.addReward()},b.prototype.setIdx1=function(){this.addListTitle(),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._title1.skinName,"今日当前排名："+GuidData.player.get1v1Rank(),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._title2.skinName,"每日22 :00结算奖励，并以邮件发放：",14,TextAlign.CENTER,ColorType.Green2ca937),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._titleLab1.skinName,"每日排名",16,TextAlign.CENTER,ColorType.color9a683f),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._titleLab2.skinName,"排名奖励",16,TextAlign.CENTER,ColorType.color9a683f),this.addInfo(0)},b.prototype.setIdx2=function(){this.addListTitle(),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._title1.skinName,"今日连胜次数："+GuidData.instanceData.getwinningstreakrecord(),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._title2.skinName,"每日主动挑战并连胜达到以下数，可获额外奖励",14,TextAlign.CENTER,ColorType.Green2ca937),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._titleLab1.skinName,"连胜次数",16,TextAlign.CENTER,ColorType.color9a683f),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._titleLab2.skinName,"额外奖励",16,TextAlign.CENTER,ColorType.color9a683f),this.addInfo(1)},b.prototype.setIdx3=function(){this.removeListTitle(),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._title1.skinName,"每次挑战都会获得50荣誉",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.hideList()},b.prototype.setIdx=function(a){console.log("---进来了"),this._idx=a,0==a?this.setIdx0():1==a?this.setIdx1():2==a?this.setIdx2():3==a&&this.setIdx3();for(var b=0;b<this._btnAry.length;b++)b==a?this._btnAry[b].goToAndStop(0):this._btnAry[b].goToAndStop(1)},b.prototype.addListTitle=function(){this._title2.parent||(this._title1.y=this._title1.baseRec.y,this.addChild(this._title2),this.addChild(this._titleLab1),this.addChild(this._titleLab2),this.addChild(this._titleBg1),this.addChild(this._titleBg2))},b.prototype.removeListTitle=function(){this._title2.parent&&(this._title1.y=this._title1.baseRec.y+50,this.removeChild(this._title2),this.removeChild(this._titleLab1),this.removeChild(this._titleLab2),this.removeChild(this._titleBg1),this.removeChild(this._titleBg2))},b.prototype.onClick=function(a){this.setIdx(a.target.data)},b.prototype.djRewardChg=function(){this._rewardList&&this._rewardList.hasStage&&this._rewardList.reget()},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this._baseUiAtlas&&this.setIdx(0)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.hideList(),this._idx=-1},b}(WindowMinUi);a.ArenaDjRewardPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array,b=420,c=300;this.setData(a,d,b,c,400,100,3,512,512,1,6),this.center=95,this.middle=55,this.setShowLevel(4),this.resize()},b.prototype.reget=function(){this.refreshData(this.getDataAry())},b.prototype.getDataAry=function(){for(var a=GuidData.instanceData.getFirstvictoryList(),b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.reget()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.ArenaDjRewardList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this._ibg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"s_bg",0,0,400,100),b.addChild(this._ibg),this._btn=this.creatSUI(d,this.parentTarget.baseAtlas,"s_btn",296,30,107,46),b.addChild(this._btn),this._btn.addEventListener(InteractiveEvent.Down,this.onclick,this),this._name=this.creatSUI(d,this.parentTarget.baseAtlas,"s_lab",15,43,100,20),b.addChild(this._name),this._iconAry=new Array;for(var f=0;3>f;f++){var g=this.creatSUI(d,this.parentTarget.baseAtlas,"s_icon"+f,86+70*f,18,68,68);b.addChild(g),this._iconAry.push(g)}},b.prototype.onclick=function(a){NetManager.getInstance().protocolos.doujiantai_first_reward(this.itdata.data.data.id)},b.prototype.render=function(a){this.itdata=a,a&&this.itdata.data&&this.applyRender()},b.prototype.applyRender=function(){this.itdata.id%2&&UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.LISTITEMBG);var a=this.itdata.data;LabelTextFont.writeSingleLabel(this.uiAtlas,this._name.skinName,"第"+a.data.rank+"名",16,TextAlign.LEFT,ColorType.Brown7a2f21),this.drawBtn(a.state);for(var b=a.data.reward,c=0;c<this._iconAry.length;c++)b[c]?IconManager.getInstance().drawItemIcon60(this._iconAry[c],b[c][0],b[c][1]):IconManager.getInstance().drawItemIcon60(this._iconAry[c],0,1)},b.prototype.drawBtn=function(a){var b=this._btn,c=b.uiRender.uiAtlas.getRec(b.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),e=this.parentTarget.baseAtlas.getRec("u_s"+a);d.drawImage(this.parentTarget.baseAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,0,c.pixelWitdh,c.pixelHeight),b.uiRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},b}(SListItem);a.ArenaDjRewardListItemRender=d;var e=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){f.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array,b=420,c=320;this.setData(a,f,b,c,400,55,6,128,512,1,10),this.center=95,this.middle=70,this.setShowLevel(4),this.resize()},b.prototype.resetData=function(a){0==a?this.refreshData(this.getDayReward()):this.refreshData(this.getCombatwinReward())},b.prototype.getCombatwinReward=function(){for(var a=new Array,b=tb.TB_doujiantai_combat_win.get_TB_doujiantai_combat_win(),c=0;c<b.length;c++){var d=new Object;d.lab=b[c].id+"连胜",d.val=getResName(b[c].reward[0][0])+b[c].reward[0][1];var e=new SListItemData;e.data=d,e.id=c,a.push(e)}return a},b.prototype.getDayReward=function(){for(var a=new Array,b=tb.TB_doujiantai_day.get_TB_doujiantai_day(),c=0;c<b.length;c++){var d=new Object;if(0==c)d.lab="第"+b[c].rank+"名";else{var e=b[c-1].rank+1;e!=b[c].rank?d.lab="第"+e+"-"+b[c].rank+"名":d.lab="第"+b[c].rank+"名"}d.val=getResName(b[c].reward[0][0])+b[c].reward[0][1];var f=new SListItemData;f.data=d,f.id=c,a.push(f)}return a},b.prototype.show=function(a){void 0===a&&(a=0),UIManager.getInstance().addUIContainer(this),this.resetData(a)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.ArenaDjInfoList=e;var f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this._ibg=this.creatGrid9SUI(d,b.baseAtlas,"b_bg",0,0,400,55),c.addChild(this._ibg),this._val=this.creatSUI(e,b.baseAtlas,"b_lab2",200,20,120,20),c.addChild(this._val),this._lab=this.creatSUI(e,b.baseAtlas,"b_lab1",20,20,100,20),c.addChild(this._lab)},b.prototype.onclick=function(a){NetManager.getInstance().protocolos.doujiantai_first_reward(this.itdata.data.data.id)},b.prototype.render=function(a){this.itdata=a,a&&this.itdata.data?this.applyRender():(UiDraw.clearUI(this._ibg),UiDraw.clearUI(this._lab),UiDraw.clearUI(this._val))},b.prototype.applyRender=function(){this.itdata.id%2?UiDraw.clearUI(this._ibg):UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.LISTITEMBG);var a=this.itdata.data;LabelTextFont.writeSingleLabel(this.uiAtlas,this._lab.skinName,a.lab,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this._val.skinName,a.val,16,TextAlign.CENTER,ColorType.Brown7a2f21)},b}(SListItem);a.ArenaDjInfoListItemRender=f}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kuafu;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._lastQdt=-1,b._lastQs=-1,b._extraFlag=[-1,-1,-1],b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.dispose=function(){this._frameRender&&(this._frameRender.dispose(),this._frameRender=null)},b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this._middleRender=new UIRenderComponent,this._middleRender.uiAtlas=a,this.addRender(this._middleRender),this._topRender=new UIRenderComponent,this._topRender.uiAtlas=a,this.addRender(this._topRender),this.initUI()},b.prototype.initUI=function(){this._shopBtn=this.addChild(this._baseRender.getComponent("t_icon1")),this._shopBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._rankBtn=this.addChild(this._baseRender.getComponent("t_icon4")),this._rankBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._rewardBtn=this.addChild(this._baseRender.getComponent("t_icon2")),this._rewardBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._logBtn=this.addChild(this._baseRender.getComponent("t_icon3")),this._logBtn.addEventListener(InteractiveEvent.Up,this.itemIconClick,this),this._mainBg=this._winMidRender.getComponent("t_main_bg"),this.addUIList(["t_bg0","t_bg2","t_bg3","t_bg4","t_bg5","t_bg6","t_bg7"],this._bgRender);var a=this._bgRender.getComponent("t_bg01");a.isU=!0,this.addChild(a),a=this._bgRender.getComponent("t_bg21"),a.isU=!0,this.addChild(a),this._mainImg=this.addChild(this._baseRender.getComponent("t_main_icon")),this.addUIList(["t_r_l","t_r_c","t_r_c1","t_r_r"],this._baseRender),a=this.addChild(this._baseRender.getComponent("t_time_lab")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"活动时间",16,TextAlign.CENTER,ColorType.Brown7a2f21);var b=this.getTimeStr();a=this.addChild(this._baseRender.getComponent("t_time_val1")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,b[0],16,TextAlign.CENTER,ColorType.color9a683f),a=this.addChild(this._baseRender.getComponent("t_time_val2")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,b[1],16,TextAlign.CENTER,ColorType.color9a683f),this._rankLab=this.addChild(this._baseRender.getComponent("t_rank")),this._timeNumVal=this.addChild(this._baseRender.getComponent("t_num_val"));var c=this.addChild(this._baseRender.getComponent("t_btn"));c.addEventListener(InteractiveEvent.Up,this.btnClick,this),this.addChild(this._topRender.getComponent("t_btn_name1")),this.addChild(this._middleRender.getComponent("t_bg1")),a=this._middleRender.getComponent("t_bg11"),a.isU=!0,this.addChild(a),this._rewardAry=new Array;for(var d=0;3>d;d++){var e=TableData.getInstance().getData(TableData.tb_single_pvp_extra,d+1);a=this._middleRender.getComponent("t_reward_icon"+d),a.addEventListener(InteractiveEvent.Up,this.getReward,this),this.addChild(a),this._rewardAry.push(a),a=this._middleRender.getComponent("t_re_lab"+d),this.addChild(a),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,e.wins+"胜奖励",16,TextAlign.CENTER,ColorType.Brown7a2f21)}this._rewardLineAry=new Array;for(var d=0;2>d;d++){var f=this._middleRender.getComponent("t_reward_f"+d);this.addChild(f),f.goToAndStop(1),this._rewardLineAry.push(f)}var g=this.addChild(this._middleRender.getComponent("t_add_btn"));g.addEventListener(InteractiveEvent.Up,this.showBuyMeshBoss,this),this._rewardFlagAry=new Array;for(var d=0;3>d;d++)a=this._topRender.getComponent("t_reward_get"+d),this._rewardFlagAry.push(a);a=this.addChild(this._topRender.getComponent("t_pingfen_lab")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,a.skinName,"当前积分",16,TextAlign.CENTER,ColorType.Whitefff4d6),this.a_vip_add=this.addChild(this._baseRender.getComponent("a_vip_add")),this._jifenLab=this.addChild(this._topRender.getComponent("t_pingfen_val")),this.draw(),this.buildFram()},b.prototype.itemIconClick=function(a){var b=this;UiTweenScale.getInstance().changeButSize(a.target),a.target==this._logBtn?(this._logPanel||(this._logPanel=new f),this._logPanel.load(function(){b._logPanel.show(b._baseUiAtlas)})):a.target==this._rewardBtn?(this._rewardPanel||(this._rewardPanel=new c),this._rewardPanel.load(function(){b._rewardPanel.show(b._baseUiAtlas)})):a.target==this._shopBtn?ModulePageManager.openPanel(SharedDef.MODULE_MALL,[SharedDef.MODULE_MALL_SCORE]):a.target==this._rankBtn&&ModulePageManager.openPanel(SharedDef.MODULE_RANK,5)},b.prototype.btnClick=function(a){UiTweenScale.getInstance().changeButSize(a.target);var b=new s2c_kuafu_match_wait;b.type=SharedDef.MATCH_TYPE_LOCAL_SINGLE_PVP;var c=new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.SHOW_WAITJOIN_PANEL);c.data=b,ModuleEventManager.dispatchEvent(c),NetManager.getInstance().protocolos.match_single_pvp()},b.prototype.showBuyMeshBoss=function(a){UiTweenScale.getInstance().changeButSize(a.target);var b=GuidData.instanceData.getQualifyDailyTimes(),c=TableData.getInstance().getData(TableData.tb_single_pvp_base,1).dailyTimes;if(b>=c)return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"当前挑战次数已满，请消耗一些再来购买",99);var d=new popbuy.PopBuyEvent(popbuy.PopBuyEvent.SHOW_POPBUY_PANEL);d.resoureItem=new Array;for(var e=GuidData.instanceData.getQualifyBuyTimes(),f=TableData.getInstance().getTabSize(TableData.tb_single_pvp_times),g=e;f>g&&e+(c-b)>g;g++){var h=TableData.getInstance().getData(TableData.tb_single_pvp_times,g+1);d.resoureItem.push(h.cost[0])}d.Info1="排位赛剩余可购买",d.cutNum=d.resoureItem.length,d.cutNum>0?(d.SubmitFun=function(a){NetManager.getInstance().protocolos.buy_match_single_pvp_times(a)},ModuleEventManager.dispatchEvent(d)):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"购买次数满了",99)},b.prototype.getReward=function(a){var b=this._rewardAry.indexOf(a.target);return this.pickFlagAry[b]?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"该奖励已领取！",99):void(this._extraFlag[b]&&(b++,NetManager.getInstance().protocolos.pick_match_single_pvp_extra_reward(b)))},b.prototype.buildFram=function(){var a=this;this._frameRender||(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ef_fl"),4,4,function(b){a.effAry=b;for(var c=0;c<a.effAry.length;c++)a.effAry[c].x=a._rewardAry[c].x-30,a.effAry[c].y=a._rewardAry[c].y-30,a.effAry[c].speed=3;a.playEff()},this._rewardAry.length))},b.prototype.playEff=function(){if(this.effAry)for(var a=0;a<this._rewardAry.length;a++)this._extraFlag[a]&&!this.pickFlagAry[a]?(this.addChild(this.effAry[a]),this.effAry[a].play()):this.removeChild(this.effAry[a])},b.prototype.getTimeStr=function(){var a=TableData.getInstance().getData(TableData.tb_single_pvp_base,1),b=a.opentime,c=this.nt(b[0][0])+":"+this.nt(b[0][1])+"-"+this.nt(b[0][2])+":"+this.nt(b[0][3]),d=this.nt(b[1][0])+":"+this.nt(b[1][1])+"-"+this.nt(b[1][2])+":"+this.nt(b[1][3]);return[c,d]},b.prototype.nt=function(a){return 0==a?"00":String(a)},b.prototype.drawDayNum=function(){var a=GuidData.instanceData.getQualifyDailyTimes();if(this._lastQdt!=a){var b=TableData.getInstance().getData(TableData.tb_single_pvp_base,1);UiDraw.drawTxtLab(this._timeNumVal,ColorType.Brown7a2f21+"今日次数："+a+"/"+b.dailyTimes,16,TextAlign.CENTER,-15,6),this._lastQdt=a}},b.prototype.draw=function(){this.drawDayNum(),NetManager.getInstance().protocolos.rank_list_query(SharedDef.RANK_TYPE_SINGLE_PVP,SharedDef.RANK_TYPE_SINGLE_PVP,1,1);var a=GuidData.player.getQualifyScore();if(this._lastQs!=a){var b=this.getGrade(a);this._baseUiAtlas.upDataPicToTexture("ui/load/arena/"+b+".png",this._mainImg.skinName),ArtFont.getInstance().writeFontToSkinNameCenter(this._baseUiAtlas,this._jifenLab.skinName,Snum(a),ArtFont.num57),this._lastQs=a}this.drawReward(),this.drawRewardPick(),this.playEff()},b.prototype.getGrade=function(a){for(var b=1;8>=b;b++){var c=TableData.getInstance().getData(TableData.tb_single_pvp_grade,b);if(a>=c.range[0]&&a<c.range[1])return b}return 1},b.prototype.drawReward=function(){for(var a=GuidData.instanceData.getQualifyExtra(),b=0;3>b;b++)if(a[b]!=this._extraFlag[b]){var c=TableData.getInstance().getData(TableData.tb_single_pvp_extra,b+1);IconManager.getInstance().drawItemIcon60(this._rewardAry[b],c.show,1,!a[b]),this._extraFlag[b]=a[b],b>0&&(a[b]?this._rewardLineAry[b-1].goToAndStop(0):this._rewardLineAry[b-1].goToAndStop(1))}},b.prototype.drawRank=function(a){var b;b=0>a?"2000+":String(a),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._rankLab.skinName,b,16,TextAlign.CENTER,ColorType.Brown7a2f21)},b.prototype.dataChg=function(){this.drawDayNum(),this.drawRewardPick(),this.playEff()},b.prototype.drawRewardPick=function(){this.pickFlagAry=GuidData.instanceData.getQualifyExtraPicked();for(var a=0;3>a;a++)this.pickFlagAry[a]?this._rewardFlagAry[a].parent||this.addChild(this._rewardFlagAry[a]):this._rewardFlagAry[a].parent&&this.removeChild(this._rewardFlagAry[a])},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.addChild(this._mainBg),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_vip_add.skinName,getvipadd("qualifyReward"),14,TextAlign.CENTER,ColorType.color9a683f),this._baseUiAtlas&&this.draw()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.removeChild(this._mainBg)},b}(UIConatiner);a.ArenaQualifying=b;var c=function(a){function b(){var b=a.call(this)||this;return b.setBlackBg(),b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.applyLoad=function(){this.applyLoadComplete()},b.prototype.initUI=function(a){this._slist||(this._slist=new d,this._slist.init(a),this._baseRender.uiAtlas=a,this.addUIList(["t_r_title","t_r_lab1","t_r_lab2","t_r_lab3","t_r_line1","t_r_line2"],this._baseRender))},b.prototype.onRemove=function(){this._slist&&this._slist.hide()},b.prototype.show=function(a){this.initUI(a),UIManager.getInstance().addUIContainer(this),this._slist.show()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){a.target==this.e_close&&this.hide()},b}(WindowMinUi);a.ArenaQualifyingReward=c;var d=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){e.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=this.getDataAry(),b=512,c=330;this.setData(a,e,b,c,500,85,4,512,512,1,6),this.center=0,this.middle=20,this.setShowLevel(4)},b.prototype.getDataAry=function(){for(var a=new Array,b=1;8>=b;b++){var c=new SListItemData;c.data=TableData.getInstance().getData(TableData.tb_single_pvp_grade,b),c.id=b,a.push(c)}return a.reverse(),a},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.ArenaQualifyingRewardList=d;var e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this._ibg=this.creatGrid9SUI(d,b.baseAtlas,"r_bg",0,0,512,85),c.addChild(this._ibg),this._icon=this.creatSUI(e,b.baseAtlas,"r_icon",33,8,66,70),c.addChild(this._icon),this._nameui=this.creatSUI(e,b.baseAtlas,"r_name",105,29,80,23),c.addChild(this._nameui),this._iconAry=new Array;for(var g=0;4>g;g++){var h=this.creatSUI(e,b.baseAtlas,"r_i"+g,190+76*g,8,68,68);c.addChild(h),this._iconAry.push(h)}},b.prototype.render=function(a){this.itdata=a,a&&a.data&&this.applyRender()},b.prototype.applyRender=function(){this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.LISTITEMBG),LabelTextFont.writeSingleLabel(this.uiAtlas,this._nameui.skinName,this.itdata.data.name,16,TextAlign.CENTER,ColorType.Brown7a2f21),UiDraw.clearUI(this._icon),this.uiAtlas.upDataPicToTexture("ui/load/arena/"+this.itdata.data.id+"_s.png",this._icon.skinName);for(var a=this.itdata.data.weekRewards.split(","),b=0;b<this._iconAry.length;b++)IconManager.getInstance().drawItemIcon60(this._iconAry[b],a[2*b],a[2*b+1])},b}(SListItem);a.ArenaQualifyingRewardListItemRender=e;var f=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b.setBlackBg(),b}return __extends(b,a),b.prototype.applyLoad=function(){this.applyLoadComplete()},b.prototype.initUI=function(a){this._slist||(this._slist=new g,this._slist.init(a),this._baseRender.uiAtlas=a,this.addUIList(["t_l_title"],this._baseRender))},b.prototype.onRemove=function(){this._slist&&this._slist.hide()},b.prototype.show=function(a,b){void 0===b&&(b=0),UIManager.getInstance().addUIContainer(this),this.initUI(a),this._slist.show(b)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){a.target==this.e_close&&this.hide()},b}(WindowMinUi);a.ArenaQualifyingLog=f;var g=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){h.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array,b=512,c=380;this.setData(a,h,b,c,512,34,10,512,512,1,14),this.center=0,this.middle=30,this.setShowLevel(4)},b.prototype.getDataAry=function(){var a,b=new Array;a=0==this._type?GuidData.instanceData.getQualify1Log():GuidData.instanceData.get1v1Records();for(var c=0;c<a.length;c++){var d=new SListItemData;d.data={type:this._type,str:a[c]},d.id=c,b.push(d)}return b},b.prototype.show=function(a){void 0===a&&(a=0),this._type=a,UIManager.getInstance().addUIContainer(this);var b=this.getDataAry();this.refreshData(b)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.ArenaQualifyingLogList=g;var h=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this._ibg=this.creatGrid9SUI(d,b.baseAtlas,"s_bg",0,0,512,34),c.addChild(this._ibg),this._itme0=this.creatSUI(e,b.baseAtlas,"s_item0",10,7,184,20),c.addChild(this._itme0),this._iitem1=this.creatSUI(e,b.baseAtlas,"s_item1",207,7,180,20),c.addChild(this._iitem1),this._iitem2=this.creatSUI(e,b.baseAtlas,"s_item2",399,7,100,20),c.addChild(this._iitem2)},b.prototype.render=function(a){this.itdata=a,a&&a.data&&this.applyRender()},b.prototype.applyRender=function(){this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.LISTITEMBG),0==this.itdata.data.type?this.drawQulify():this.drawDj()},b.prototype.drawQulify=function(){var a=this.itdata.data.str,b=a.split("|"),c=1==Number(b[1]),d=c?ColorType.Green2ca937+"胜  ":ColorType.colorcd2000+"败  ",e=ColorType.Brown7a2f21+"您遭遇 "+ColorType.Browndf9a68+getBaseName(b[0]),f=c?ColorType.Green2ca937+"您胜利了  ":ColorType.colorcd2000+"您失败了  ",g=ColorType.Brown7a2f21+"积分 "+(c?ColorType.Green2ca937+"+"+b[2]:ColorType.colorcd2000+"-"+b[2]);LabelTextFont.writeSingleLabel(this.uiAtlas,this._itme0.skinName,d+e,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem1.skinName,f+g,16,TextAlign.LEFT);var h=GameInstance.getServerNow()-Number(b[3]),i=TimeUtil.getDelayTimeStr(h);LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem2.skinName,i,14,TextAlign.LEFT,ColorType.Orange9a683f)},b.prototype.drawDj=function(){var a=this.itdata.data.str,b=a.split("|"),c=1==Number(b[4]),d=c?ColorType.Green2ca937+"胜  ":ColorType.colorcd2000+"败  ",e=ColorType.Brown7a2f21+"您遭遇 "+ColorType.Browndf9a68+getBaseName(b[0]),f=getBaseName(GuidData.player.getName());e=f==b[0]?ColorType.Browndf9a68+getBaseName(b[1])+ColorType.Brown7a2f21+"挑战您 ":ColorType.Brown7a2f21+"您挑战 "+ColorType.Browndf9a68+getBaseName(b[1]);var g,h=c?ColorType.Green2ca937+"您胜利了  ":ColorType.colorcd2000+"您失败了  ",i=Number(b[2]),j=Number(b[3]);i==j?g=ColorType.Brown7a2f21+"排名保持不变":(i=Math.abs(j-i),g=ColorType.Brown7a2f21+"排名 "+(c?ColorType.Green2ca937+"+"+i:ColorType.colorcd2000+"-"+i)),LabelTextFont.writeSingleLabel(this.uiAtlas,this._itme0.skinName,d+e,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem1.skinName,h+g,16,TextAlign.LEFT);var k=GameInstance.getServerNow()-Number(b[5]),l=TimeUtil.getDelayTimeStr(k);LabelTextFont.writeSingleLabel(this.uiAtlas,this._iitem2.skinName,l,14,TextAlign.LEFT,ColorType.Orange9a683f)},b}(SListItem);a.ArenaQualifyingLogListItemRender=h}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kuafu;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.getModuleName=function(){return"KuafuModule"},c.prototype.listProcessors=function(){return[new d,new a.KuaFu1v1Processor]},c}(Module);a.KuafuModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_KUAFU_PANEL_EVENT="SHOW_KUAFU_PANEL_EVENT",b.INSTANCE_INT_FIELD_3V3_TIMES="INSTANCE_INT_FIELD_3V3_TIMES",b.INSTANCE_INT_FIELD_3V3_DAY_REWARD="INSTANCE_INT_FIELD_3V3_DAY_REWARD",b.KUAFU_1V1_REFRESH="KUAFU_1V1_REFRESH",b.KUAFU_SHOW_ARENA_PANEL_EVENT="KUAFU_SHOW_ARENA_PANEL_EVENT",b.KUAFU_HIDE_ARENA_PANEL_EVENT="KUAFU_HIDE_ARENA_PANEL_EVENT",b.KUAFU_ARENA_QUALIFY_REWARD_EVENT="KUAFU_ARENA_QUALIFY_REWARD_EVENT",b.KUAFU_ARENA_QUALIFY_RANK_EVENT="KUAFU_ARENA_QUALIFY_RANK_EVENT",b.KUAFU_ARENA_QUALIFY_NUM_EVENT="KUAFU_ARENA_QUALIFY_NUM_EVENT",b.FIRSTREWARD_DJ_EVENT="FIRSTREWARD_DJ_EVENT",b.SHOW_DJT_RANK="SHOW_DJT_RANK",b}(BaseEvent);a.KuaFuEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"KuaFuProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;if(b.type==c.SHOW_KUAFU_PANEL_EVENT){b.data}else b.type==c.INSTANCE_INT_FIELD_3V3_TIMES||(b.type==c.KUAFU_1V1_REFRESH?this._arenaPanel&&this._arenaPanel.hasStage&&this._arenaPanel.djChg():b.type==c.INSTANCE_INT_FIELD_3V3_DAY_REWARD||(b.type==c.KUAFU_SHOW_ARENA_PANEL_EVENT?this.showArenaPanel(b.data,b.selTab):b.type==c.KUAFU_HIDE_ARENA_PANEL_EVENT?this.hideArenaPanel():b.type==c.KUAFU_ARENA_QUALIFY_REWARD_EVENT||b.type==c.KUAFU_ARENA_QUALIFY_NUM_EVENT?this.refreshArenaQualifyReward():b.type==c.KUAFU_ARENA_QUALIFY_RANK_EVENT?this.refreshArenaQualifyRank(b.data):b.type==c.FIRSTREWARD_DJ_EVENT?this.djRewardChg():b.type==c.SHOW_DJT_RANK&&this.showRank(b.data)))}else a.type==EngineEvent.SYSTEM_OPEN_EVENT&&this._arenaPanel&&this._arenaPanel.showTab1();if(a instanceof UIPanelEvent);},d.prototype.showRank=function(a){var b=this;this._rankPanle||(this._rankPanle=new WindowRankPanel);for(var c=new Array,d=0;d<a.list.length;d++){var e=a.list[d],f=new WindowRankVo,g=e.GetStr(SharedDef.RANK_LIST_CURRENT_OBJ_STR_FIELD_PLAYER_NAME);g&&(f.rank=String(e.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_RANKING)),f.val=String(e.GetUInt32(SharedDef.RANK_LIST_CURRENT_OBJ_INT_FIELD_FORCE)),f.name=getBaseName(g),c.push(f))}var h;h=a.self>0?"我的排名："+a.self:"我的排名：未上榜",this._rankPanle.load(function(){b._rankPanle.show(["排名","玩家名字","战力"],c,h)})},d.prototype.showArenaPanel=function(b,c){var d=this;this._arenaPanel||(this._arenaPanel=new a.ArenaPanel),this._arenaPanel.load(function(){SceneManager.getInstance().render=!1;var a=new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT);ModuleEventManager.dispatchEvent(a),b?b instanceof Array||(b=[b]):b=[1,4],c?c instanceof Array&&(c=c[0]):c=b[0],d._arenaPanel.show(b,c)})},d.prototype.hideArenaPanel=function(){this._arenaPanel&&this._arenaPanel.hasStage&&this._arenaPanel.hide()},d.prototype.djRewardChg=function(){this._arenaPanel&&this._arenaPanel.hasStage&&this._arenaPanel.djRewardChg()},d.prototype.refreshArenaQualifyReward=function(){this._arenaPanel&&this._arenaPanel.hasStage&&this._arenaPanel.qualifyDataChg()},d.prototype.refreshArenaQualifyRank=function(a){this._arenaPanel&&this._arenaPanel.hasStage&&this._arenaPanel.qualifyRankChg(a)},d.prototype.msgWorldWarScPlayerInfo=function(b){a.KuaFu3v3Model.getInstance().worldWarByte=new ByteArray(b.buffer.slice(b.position,b.length)),a.KuaFu3v3Model.getInstance().worldWarByte.endian=Endian.LITTLE_ENDIAN},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_KUAFU_PANEL_EVENT),new c(c.INSTANCE_INT_FIELD_3V3_TIMES),new c(c.INSTANCE_INT_FIELD_3V3_DAY_REWARD),new c(c.KUAFU_1V1_REFRESH),new c(c.KUAFU_SHOW_ARENA_PANEL_EVENT),new c(c.KUAFU_HIDE_ARENA_PANEL_EVENT),new c(c.KUAFU_ARENA_QUALIFY_REWARD_EVENT),new c(c.KUAFU_ARENA_QUALIFY_RANK_EVENT),new c(c.KUAFU_ARENA_QUALIFY_NUM_EVENT),new c(c.FIRSTREWARD_DJ_EVENT),new c(c.SHOW_DJT_RANK),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d.prototype.smsgKuafuXianfuMathchWait=function(a){var b=new s2c_kuafu_match_wait;s2c_kuafu_match_wait.read(b,a),console.log(b);var c=new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.SHOW_WAITJOIN_PANEL);c.data=b,ModuleEventManager.dispatchEvent(c)},d.prototype.msgDoujiantaiGetEnemysInfo=function(a){this.readRankByte(a,!1)},d.prototype.msgDouJianTaiTop3=function(a){this.readRankByte(a,!0)},d.prototype.readRankByte=function(b,c){for(var d=new Array,e=b.readShort(),f=0;e>f;f++){var g=new a.KuaFu1v1BangData;g.postion=b.readByte(),g.rank=b.readUint16(),g.name=b.readUTF(),g.gender=b.readByte(),g.level=b.readUint16(),g.weapon=b.readUint32(),g.avatar=b.readUint32(),g.divine=b.readUint32(),g.force=b.readDouble(),g.pass=c,console.log(g),d.push(g)}this._arenaPanel&&this._arenaPanel.hasStage&&this._arenaPanel.djData(d);
},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.MSG_WORLD_WAR_SC_PLAYER_INFO]=function(b){a.msgWorldWarScPlayerInfo(b)},b[Protocols.SMSG_KUAFU_MATCH_WAIT]=function(b){a.smsgKuafuXianfuMathchWait(b)},b[Protocols.MSG_DOUJIANTAI_GET_ENEMYS_INFO]=function(b){a.msgDoujiantaiGetEnemysInfo(b)},b[Protocols.MSG_DOUJIANTAI_TOP3]=function(b){a.msgDouJianTaiTop3(b)},b},d}(BaseProcessor);a.KuaFuProcessor=d}(kuafu||(kuafu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),activity;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.left=49,a.top=84,a}return __extends(d,b),d.prototype.init=function(a){var b=this;this.baseAtlas=a,this.initData(),this._tickFun=function(){b.tickRefreshState()}},d.prototype.initData=function(){var a=new Array;this.setData(a,c,860,300,430,100,3,1024,512,2,5,1)},d.prototype.addTick=function(){TimeUtil.addTimeTick(1e3,this._tickFun)},d.prototype.removeTick=function(){TimeUtil.removeTimeTick(this._tickFun)},d.prototype.tickRefreshState=function(){a.ActivityModel.getInstance().compareAandB(this._aryList,a.ActivityType.ALL)&&ModuleEventManager.dispatchEvent(new a.ActivityEvent(a.ActivityEvent.ACTIVITY_TABREDPOINT_EVENT))},d.prototype.refreshDataByNewData=function(b){this._aryList=a.ActivityModel.getInstance().getList(b);var c=this.getData(this._aryList);this.refreshData(c)},d.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},d.prototype.show=function(){this.hasStage||(UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData(a.ActivityType.ALL),this.addTick())},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.removeTick()},d}(SList);a.EverydayActivityList=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e);var f=this._customRenderAry[0];this.Recomand=this.creatSUI(f,this.parentTarget.baseAtlas,"Recomand",2,1,58,60),b.addChild(this.Recomand),this.Icon=this.creatSUI(d,this.parentTarget.baseAtlas,"Icon",17,16,68,68),b.addChild(this.Icon),this.Name=this.creatSUI(f,this.parentTarget.baseAtlas,"Name",106,12,164,25),b.addChild(this.Name),this.Num=this.creatSUI(f,this.parentTarget.baseAtlas,"Num",106,40,106,20),b.addChild(this.Num),this.Action=this.creatSUI(d,this.parentTarget.baseAtlas,"Action",212,40,80,20),b.addChild(this.Action),this.Time=this.creatSUI(d,this.parentTarget.baseAtlas,"Time",308,12,108,20),b.addChild(this.Time),this.Btn=this.creatSUI(d,this.parentTarget.baseAtlas,"Btn",308,34,108,54),b.addChild(this.Btn),this.Bg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"Bg",0,0,427,98,10,10),b.addChild(this.Bg),this.Btn.addEventListener(InteractiveEvent.Up,this.butClik,this)},b.prototype.drawIcon=function(a){var b=this;LoadManager.getInstance().load(Scene_data.fileRoot+getactivityIconUrl(String(a.data.icon)),LoadManager.IMG_TYPE,function(a){var c=b._baseRender.uiAtlas.getRec(b.Icon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(a,0,0,a.width,a.height,4,4,60,60),b._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},b.prototype.drawNameAndPk=function(a){var b=this._baseRender.uiAtlas.getRec(this.Name.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);if(LabelTextFont.writeSingleLabelToCtx(c,a.data.name,16,0,0,TextAlign.LEFT,ColorType.Brown7a2f21),a.data.pvp){var d=this.parentTarget.baseAtlas.getRec("PK");c.drawImage(this.parentTarget.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,109,0,d.pixelWitdh,d.pixelHeight)}this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.drawBtn=function(a){var b=this._baseRender.uiAtlas.getRec(this.Btn.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);if(-1==a.state){var d=this.parentTarget.baseAtlas.getRec("Btn_5");c.drawImage(this.parentTarget.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight),ArtFont.getInstance().writeFontToCtxCenten(c,String(a.data.limdata),ArtFont.num27,24,18)}else if(0==a.state){var d=this.parentTarget.baseAtlas.getRec("Btn_2");c.drawImage(this.parentTarget.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight)}else if(1==a.state){if(a.canreceive)var d=this.parentTarget.baseAtlas.getRec("Btn_1");else var d=this.parentTarget.baseAtlas.getRec("Btn_4");c.drawImage(this.parentTarget.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight)}else if(2==a.state){var d=this.parentTarget.baseAtlas.getRec("Btn_1");c.drawImage(this.parentTarget.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight)}else{var d=this.parentTarget.baseAtlas.getRec("Btn_0");c.drawImage(this.parentTarget.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight)}this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.time2timestr=function(a){var b;return b=10>a?"0"+a:a+""},b.prototype.applyrender=function(){var a=this.itdata.data;UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Bg.skinName,UIData.publicUi,PuiData.Slist_select),this.drawIcon(a),1==a.data.recommend?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.Recomand.skinName,"T_1"):UiDraw.clearUI(this.Recomand),this.drawNameAndPk(a),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Num.skinName,ColorType.Brown7a2f21+"次数:"+ColorType.Green2ca937+a.getNum()+"/"+a.data.nums,16,TextAlign.LEFT,"#d5e7ff"),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Action.skinName,ColorType.Brown7a2f21+"活跃:"+ColorType.colorff7200+a.data.active*a.data.nums,16,TextAlign.LEFT,"#d5e7ff");var b;if(a.state>=2||-1==a.state?b=ColorType.Brown7a2f21:0==a.state?b=ColorType.colorcd2000:1==a.state&&(b=ColorType.Green2ca937),a.isallday)LabelTextFont.writeSingleLabel(this.uiAtlas,this.Time.skinName,"全天",16,TextAlign.CENTER,b);else if(2==a.data.time.length){var c=this.time2timestr(a.data.time[0][0])+":"+this.time2timestr(a.data.time[0][1])+","+this.time2timestr(a.data.time[1][0])+":"+this.time2timestr(a.data.time[1][1]);LabelTextFont.writeSingleLabel(this.uiAtlas,this.Time.skinName,c,16,TextAlign.CENTER,b)}else LabelTextFont.writeSingleLabel(this.uiAtlas,this.Time.skinName,this.time2timestr(a.data.time[0][0])+":"+this.time2timestr(a.data.time[0][1])+"-"+this.time2timestr(a.data.time[0][2])+":"+this.time2timestr(a.data.time[0][3]),16,TextAlign.CENTER,b);this.drawBtn(a)},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},b.prototype.butClik=function(a){if(this.itdata&&this.itdata.data){var b=this.itdata.data;if(1==b.state&&!b.canreceive){UiTweenScale.getInstance().changeButSize(a.target);var c=b.data.goto_sub[0];b.data["goto"]==SharedDef.MODULE_MALL&&(c=b.data.goto_sub),console.log("--vo.data.goto,vo.data.goto_sub--",b.data["goto"],c),ModulePageManager.openPanel(b.data["goto"],c)}}},b.prototype.setnull=function(){UiDraw.clearUI(this.Bg),UiDraw.clearUI(this.Icon),UiDraw.clearUI(this.Name),UiDraw.clearUI(this.Num),UiDraw.clearUI(this.Action),UiDraw.clearUI(this.Time),UiDraw.clearUI(this.Btn),UiDraw.clearUI(this.Recomand)},b}(SListItem);a.EverydayActivityRender=c}(activity||(activity={}));var activity;!function(a){var b=function(){function a(){}return a.ALL=0,a}();a.ActivityType=b;var c=function(){function a(){this.getBaseList()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getBaseList=function(){this._activityary=new Array;for(var a=tb.TB_activity_base.get_TB_activity_base(),b=0;b<a.length;b++){var c=new d;c.data=a[b],this._activityary.push(c)}},a.prototype.compareAandB=function(a,b){if(a){for(var c=this.getList(b),d=0;d<c.length;d++){if(c[d].data.id!=a[d].data.id)return!0;if(c[d].state!=a[d].state)return!0;if(c[d].getNum()!=a[d].getNum())return!0}return!1}return!0},a.prototype.getList=function(a){var c;switch(a){case b.ALL:c=this.divisionAry(this.getAllList())}return c},a.prototype.getAllList=function(){for(var a=new Array,b=0;b<this._activityary.length;b++)a.push(this._activityary[b]);return a},a.prototype.SortListByTime=function(a){return a.sort(function(a,b){return a.getNearTime()<b.getNearTime()?-1:1}),a},a.prototype.SortListByOpenLev=function(a){return a.sort(function(a,b){return a.openLev<b.openLev?-1:1}),a},a.prototype.SortListByConditions=function(a){return a.sort(function(a,b){return b.getActivitySortNum()<a.getActivitySortNum()?-1:1}),a},a.prototype.divisionAry=function(a){for(var b=new Array,c=new Array,d=0;d<a.length;d++)a[d].getActivate()&&a[d].getActivityStart()?b.push(a[d]):c.push(a[d]);for(var e=new Array,f=new Array,d=0;d<b.length;d++)b[d].isallday?f.push(b[d]):e.push(b[d]);e=this.SortListByConditions(e),f=this.SortListByConditions(f);for(var g=new Array,h=new Array,i=new Array,d=0;d<c.length;d++)-1==c[d].state?g.push(c[d]):0==c[d].state?h.push(c[d]):i.push(c[d]);h=this.SortListByTime(h),g=this.SortListByOpenLev(g);for(var j=new Array,k=new Array,d=0;d<i.length;d++)2==i[d].state?j.push(i[d]):k.push(i[d]);return j=this.SortListByConditions(j),k=this.SortListByConditions(k),e.concat(f,h,g,j,k)},a}();a.ActivityModel=c;var d=function(){function a(){this.isallday=!1,this.canreceive=!1}return a.prototype.getNum=function(){return this.data.nums-GuidData.instanceData.getActivityNumByID(this.data.id)},a.prototype.getActivateIsComplete=function(){var a,b=GuidData.instanceData.getActivityNumByID(this.data.id),c=this.data.nums,d=GuidData.player.getVipLevel();return a=GuidData.player.getIsVIP()?this.data.vipnums[d-1]:0,b>=c&&(this.canreceive=!0,b>=c+a)?!0:!1},a.prototype.getActivate=function(){if(this.openLev=this.data.limdata,1==this.data.limtype&&this.data.limdata<=GuidData.player.getLevel())return this.state=0,!0;var a=this.data.time;return a&&a.length>0||(this.isallday=!0),this.state=-1,!1},a.prototype.getActivityStart=function(){var a=!1,b=!1,c=this.data.time;if(c&&c.length>0)for(var d=0;d<c.length;d++){if(this.compareTime(c[d][0],c[d][1])){this.state=0;break}if(this.compareTime(c[d][2],c[d][3])){a=!0;break}this.state=3}else this.isallday=!0,a=!0;return this.getActivateIsComplete()?this.state=2:b=!0,a&&b&&(this.state=1),a&&b},a.prototype.getNearTime=function(){this.getActivate()&&this.getActivityStart();var a=this.data.time;if(a&&a.length>0){for(var b=0;b<a.length;b++)if(this.compareTime(a[b][2],a[b][3]))return 60*a[b][2]+a[b][3];return 60*(a[0][0]+24)+a[0][1]}this.isallday=!0;var c=GameInstance.getServerNow(),d=new Date(1e3*c);return 60*d.getHours()+d.getMinutes()},a.prototype.getNearStartTime=function(){var a=this.data.time;if(a&&a.length>0){for(var b=0;b<a.length;b++)if(this.compareTime(a[b][2],a[b][3]))return this.time2timestr(a[b][0])+":"+this.time2timestr(a[b][1]);return this.time2timestr(a[0][0])+":"+this.time2timestr(a[0][1])}return""},a.prototype.time2timestr=function(a){var b;return b=10>a?"0"+a:a+""},a.prototype.compareTime=function(a,b){var c=GameInstance.getServerNow(),d=new Date(1e3*c),e=new Date(1e3*c);e.setHours(a),e.setMinutes(b),e.setSeconds(0),e.setMilliseconds(0);var f=d.getTime()-e.getTime();return 0>f?!0:!1},a.prototype.getActivitySortNum=function(){var a=0;return 1==this.data.recommend&&(a+=5e3),a+=3100-this.openLev},a}();a.ActivityItemVo=d}(activity||(activity={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),activity;!function(a){var b=function(){function a(){}return a}();a.RewardVo=b;var c=function(c){function d(){var a=c.call(this)||this;return a._KeyLocation=[249,385,519,654,789],a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(d,c),d.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._frameRender&&(this._frameRender.dispose(),this._frameRender=null),this.everydayActivityList&&(this.everydayActivityList.dispose(),this.everydayActivityList=null),c.prototype.dispose.call(this)},d.prototype.applyLoad=function(){var a=this;this._baseRender.uiAtlas.setInfo("ui/uidata/activity/activity.xml","ui/uidata/activity/activity.png",function(){a.loadConfigCom()},"ui/uidata/activity/activitypc.png")},d.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._baseRender.uiAtlas,this._topRender.uiAtlas=this._baseRender.uiAtlas;var a=this._baseRender;this._fraary=new Array,this._fraary.push(this.addChild(this._topRender.getComponent("a_1_0"))),this._fraary.push(this.addChild(this._topRender.getComponent("a_1_1"))),this._fraary.push(this.addChild(this._topRender.getComponent("a_1_2"))),this._fraary.push(this.addChild(this._topRender.getComponent("a_1_3"))),this._fraary.push(this.addChild(this._topRender.getComponent("a_1_4"))),this.addUIList(["a_3","a_bg","a_line_bg","a_line","a_title"],this._bgRender),this.slistIndex=this.addChild(a.getComponent("slistIndex")),this._Uiary=new Array,this.pro_base=this.addChild(a.getComponent("a_line_base")),this.currentNum=this.addChild(a.getComponent("a_2"));for(var b=tb.TB_activity_reward.get_TB_activity_reward(),c=0;c<b.length;c++){var d=this.addChild(a.getComponent("a_active"+c));LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,d.skinName,String(b[c].active),16,TextAlign.CENTER,ColorType.Brown7a2f21);var e=!1;b[c].vipreward.length>0&&(e=!0);var f=this.initUI(b[c],2*c,c,!1);if(e){var g=this.initUI(b[c],2*c+1,c,!0);g.x=this._KeyLocation[c]+51,f.x=this._KeyLocation[c]}else f.x=this._KeyLocation[c]+26}this.buildFram(),this.setProgressAndAchievement(GuidData.instanceData.getActivity()),this.applyLoadComplete()},d.prototype.initUI=function(a,c,d,e){var f=new b;f.data=a,f.hasvip=e,f.index=d;var g=this.addChild(this._topRender.getComponent("prop_"+c));return g.data=f,g.addEventListener(InteractiveEvent.Up,this.PropClik,this),this._Uiary.push(g),this.Receivereward(g),g},d.prototype.resetRewardState=function(){for(var a=0;a<this._Uiary.length;a++)this.Receivereward(this._Uiary[a]);this.playEff()},d.prototype.Receivereward=function(a){var b=GuidData.instanceData.getActivityRewardState(),c=a.data;GuidData.instanceData.getActivity()>=c.data.active?(c.conditionsok=!0,c.hasvip?c.hasreceive=b[2*c.index+1]:c.hasreceive=b[2*c.index]):c.conditionsok=!1,a.data=c,this.drawProp(a)},d.prototype.drawProp=function(a){var b,c,d=this,e=a.data;e.hasvip?(c=tb.TB_item_template.get_TB_item_template(e.data.vipreward[0][0]),b=e.data.vipreward[0][1]):(c=tb.TB_item_template.get_TB_item_template(e.data.reward[0][0]),b=e.data.reward[0][1]),IconManager.getInstance().getIcon(geteqiconIconUrl(c.icon),function(f){var g=d._baseRender.uiAtlas.getRec(a.skinName),h=UIManager.getInstance().getContext2D(g.pixelWitdh,g.pixelHeight,!1);if(UiDraw.cxtDrawImg(h,PuiData.PropBg40,new Rectangle(1,0,48,48),UIData.publicUi),UiDraw.cxtDrawImg(h,ItemGoodQuality.getQuaStr(c.quality),new Rectangle(3,2,44,44),UIData.publicUi),h.drawImage(f,0,0,f.width,f.height,5,4,40,40),LabelTextFont.writeSingleLabelToCtxSetAnchor(h,ColorType.Whitefffce6+String(b),14,44,30,TextAlign.CENTER),e.hasvip&&UiDraw.cxtDrawImg(h,PuiData.A_V,new Rectangle(5,29,22,19),UIData.publicUi),e.conditionsok)if(e.hasreceive){UIManager.getInstance().makeCtxToGray(h,new Rectangle(0,0,50,48));var i=d._topRender.uiAtlas.getRec("receive");h.drawImage(d._baseRender.uiAtlas.useImg,i.pixelX,i.pixelY,i.pixelWitdh,i.pixelHeight,0,12,i.pixelWitdh,i.pixelHeight)}else e.hasvip?GuidData.player.getIsVIP()&&UiDraw.cxtDrawImg(h,PuiData.A_RED_POINT,new Rectangle(33,0,17,16),UIData.publicUi):UiDraw.cxtDrawImg(h,PuiData.A_RED_POINT,new Rectangle(33,0,17,16),UIData.publicUi);else UIManager.getInstance().makeCtxToGray(h,new Rectangle(0,0,50,48));d._baseRender.uiAtlas.updateCtx(h,g.pixelX,g.pixelY)})},d.prototype.setProgressAndAchievement=function(a){this.currentAchievementNum(a);var b=a/this.getTotal();this.pro_base.uvScale=b>1?1:b;for(var c=tb.TB_activity_reward.get_TB_activity_reward(),d=0;d<this._fraary.length;d++)a<c[d].active?this._fraary[d].goToAndStop(1):this._fraary[d].goToAndStop(0)},d.prototype.currentAchievementNum=function(a){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.currentNum.skinName,a+"/"+this.getTotal(),16,TextAlign.CENTER,ColorType.Brown7a2f21)},d.prototype.getTotal=function(){var a=tb.TB_activity_reward.get_TB_activity_reward();return a[a.length-1].active},d.prototype.buildFram=function(){var a=this;this._frameRender||(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ef_fl"),4,4,function(b){a.effAry=b;for(var c=0;c<a.effAry.length;c++)a.effAry[c].x=a._Uiary[c].x-20,a.effAry[c].y=a._Uiary[c].y-20,a.effAry[c].width=.7*a.effAry[c].baseRec.width,a.effAry[c].height=.7*a.effAry[c].baseRec.height,a.effAry[c].speed=3;a.playEff()},this._Uiary.length))},d.prototype.playEff=function(){if(this.effAry)for(var a=0;a<this._Uiary.length;a++){var b=this._Uiary[a].data;b&&b.conditionsok&&!b.hasreceive?(this.addChild(this.effAry[a]),this.effAry[a].play()):this.removeChild(this.effAry[a])}},d.prototype.PropClik=function(a){var b=a.target.data;if(b.conditionsok&&!b.hasreceive){var c=!1;b.hasvip&&GuidData.player.getIsVIP()?c=!0:b.hasvip?AlertUtil.show("充值vip即可领取","领取提示",function(a){1==a&&ModulePageManager.openPanel(SharedDef.MODULE_MALL,[2])},2,["前往充值","取消"]):c=!0,c&&NetManager.getInstance().protocolos.get_activity_reward(b.index+1,b.hasvip?1:0)}else{var d=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);b.hasvip?d.id=b.data.vipreward[0][0]:d.id=b.data.reward[0][0],ModuleEventManager.dispatchEvent(d)}},d.prototype.resetData=function(){this.resetRewardState(),this.setProgressAndAchievement(GuidData.instanceData.getActivity())},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.everydayActivityList||(this.everydayActivityList=new a.EverydayActivityList,this.everydayActivityList.init(this._baseRender.uiAtlas)),this.everydayActivityList.show(),console.log("---show----"),this.resetData(),this.resize()},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.everydayActivityList&&this.everydayActivityList.hide(),ModulePageManager.hideResTittle()},d.prototype.resize=function(){c.prototype.resize.call(this),this.everydayActivityList&&(this.everydayActivityList.left=this.slistIndex.parent.x/UIData.Scale+this.slistIndex.x,this.everydayActivityList.top=this.slistIndex.parent.y/UIData.Scale+this.slistIndex.y)},d.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.ActivityEvent(a.ActivityEvent.HIDE_ACTIVITY_EVENT))}},d}(WindowUi);a.ActivityUiPanel=c}(activity||(activity={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),activity;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"ActivityModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.ActivityModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_ACTIVITY_EVENT="SHOW_ACTIVITY_EVENT",b.HIDE_ACTIVITY_EVENT="HIDE_ACTIVITY_EVENT",b.ACTIVITY_CHANGE_EVENT="ACTIVITY_CHANGE_EVENT",b.ACTIVITY_ITEM_CHANGE_EVENT="ACTIVITY_ITEM_CHANGE_EVENT",b.ACTIVITY_REWARD_EVENT="ACTIVITY_REWARD_EVENT",b.ACTIVITY_TABREDPOINT_EVENT="ACTIVITY_TABREDPOINT_EVENT",b}(BaseEvent);a.ActivityEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"ActivityProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){this.processRedPoint();var b=a;if(b.type==c.SHOW_ACTIVITY_EVENT)this.showUi();else if(b.type==c.HIDE_ACTIVITY_EVENT)this.hideUi();else if(b.type==c.ACTIVITY_ITEM_CHANGE_EVENT){var d=b.data;d-SharedDef.INSTANCE_INT_FIELD_ACTIVE_START+1}else b.type==c.ACTIVITY_CHANGE_EVENT||(b.type==c.ACTIVITY_REWARD_EVENT?this.refreshRewardSate():b.type==c.ACTIVITY_TABREDPOINT_EVENT&&this.refreshTabAndRedpoint())}else(a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT||a.type==EngineEvent.SYSTEM_OPEN_EVENT)&&this.processRedPoint();if(a instanceof UIPanelEvent){var e=a;e.panel==this._activityUiPanel&&(this._activityUiPanel.dispose(),this._activityUiPanel=null,console.log("释放面板 _activityUiPanel"))}},d.prototype.processRedPoint=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_ACTIVE,SharedDef.MODULE_ACTIVE_ALL)){var b=RedPointManager.getInstance().getNodeByID(116);b.show=!1;for(var c=tb.TB_activity_reward.get_TB_activity_reward(),d=GuidData.instanceData.getActivityRewardState(),e=0;e<c.length;e++)if(GuidData.instanceData.getActivity()>=c[e].active){if(!d[2*e])return b.show=!0,void(e=c.length);if(GuidData.player.getIsVIP()&&!d[2*e+1]&&c[e].vipreward&&c[e].vipreward.length>0)return b.show=!0,void(e=c.length)}for(var f=a.ActivityModel.getInstance().getList(a.ActivityType.ALL),g=0;g<f.length;g++)if(1==f[g].state&&!f[g].canreceive)return b.show=!0,void(g=f.length)}},d.prototype.refreshTabAndRedpoint=function(){this._activityUiPanel&&this._activityUiPanel.everydayActivityList&&this._activityUiPanel.everydayActivityList.hasStage&&this._activityUiPanel.everydayActivityList.refreshDataByNewData(a.ActivityType.ALL)},d.prototype.refreshRewardSate=function(){this._activityUiPanel&&this._activityUiPanel.hasStage&&this._activityUiPanel.resetRewardState()},d.prototype.hideUi=function(){this._activityUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(){var b=this;this._activityUiPanel||(this._activityUiPanel=new a.ActivityUiPanel),this._activityUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b._activityUiPanel.show()})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_ACTIVITY_EVENT),new c(c.HIDE_ACTIVITY_EVENT),new c(c.ACTIVITY_CHANGE_EVENT),new c(c.ACTIVITY_ITEM_CHANGE_EVENT),new c(c.ACTIVITY_REWARD_EVENT),new c(c.ACTIVITY_TABREDPOINT_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT)]},d}(BaseProcessor);a.ActivityProcessor=d}(activity||(activity={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),store;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.left=216,a.top=89,a}return __extends(d,b),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,c,428,421,214,91,4,256,1024,2,7,1)},d.prototype.refreshDataByNewData=function(){this._aryList=a.StoreModel.getInstance().getList(this._type);var b=this.getData(this._aryList);this.refreshData(b),this.setSelectIndex(this.getCurrentSelectIndex())},d.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;a[c].type=this._type,d.data=a[c],d.id=c,b.push(d)}return console.log("--选中的数据--",b),b},d.prototype.show=function(a){this._type=a,this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData()},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.ShopList=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);var f=this._customRenderAry[0];this.I_icon=this.creatSUI(d,this.parentTarget.baseAtlas,"I_icon",0,0,80,78),this.I_icon.addEventListener(InteractiveEvent.Up,this.onTip,this),a.addChild(this.I_icon),this.I_name=this.creatSUI(d,this.parentTarget.baseAtlas,"I_name",89,20,100,20),a.addChild(this.I_name),this.I_money=this.creatSUI(d,this.parentTarget.baseAtlas,"I_money",86,42,109,35),a.addChild(this.I_money),this.I_bg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"I_bg",0,0,205,88,10,10),a.addChild(this.I_bg),this.I_selects=this.creatGrid9SUI(f,this.parentTarget.baseAtlas,"I_selects",0,0,205,88,14,14),a.addChild(this.I_selects),this.I_bg.addEventListener(InteractiveEvent.Up,this.equClick,this)},c.prototype.onTip=function(){if(this.itdata&&this.itdata.data){var a,b=this.itdata.data;if(1==b.type){var c=tb.Tb_faction_shop.get_Tb_faction_shopById(b.data1.id);a=c.itemId}else a=b.data.itemId;var d=tb.TB_item_template.get_TB_item_template(a),e=new BagItemData;e.entryData=d;var f=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);f.data=e,f.buttonType=-1,ModuleEventManager.dispatchEvent(f)}},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.itdata&&this.itdata.data){if(b){var c=new a.StoreEvent(a.StoreEvent.SELECT_PROP_EVENT);c.data=this.itdata,ModuleEventManager.dispatchEvent(c)}this.applyrender()}},enumerable:!0,configurable:!0}),c.prototype.drawIconAndRecommend=function(a){var b,c=this;if(1==a.type){var d=tb.Tb_faction_shop.get_Tb_faction_shopById(a.data1.id);b=d.itemId}else b=a.data.itemId;var e=tb.TB_item_template.get_TB_item_template(b);IconManager.getInstance().getIcon(geteqiconIconUrl(e.icon),function(b){var f=c._baseRender.uiAtlas.getRec(c.I_icon.skinName),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);if(UiDraw.cxtDrawImg(g,PuiData.PropBg60,new Rectangle(12,10,68,68),UIData.publicUi),UiDraw.cxtDrawImg(g,ItemGoodQuality.getQuaStr(e.quality),new Rectangle(12,10,68,68),UIData.publicUi),g.drawImage(b,0,0,60,60,16,14,60,60),1==a.type){if(d.discount_flag<100){var h=c.parentTarget.baseAtlas.getRec("Discount");g.drawImage(c.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,0,0,h.pixelWitdh,h.pixelHeight)}if(a.data1.num==a.data2.num){var h=c.parentTarget.baseAtlas.getRec("SoldOut");g.drawImage(c.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,30,28,h.pixelWitdh,h.pixelHeight)}LabelTextFont.writeSingleLabelToCtxSetAnchor(g,String(d.itemNum),16,75,54,TextAlign.RIGHT,ColorType.Whitefff4d6,ColorType.colord27262e)}else{if(a.data.discount<10){var h=c.parentTarget.baseAtlas.getRec("Discount");g.drawImage(c.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,0,0,h.pixelWitdh,h.pixelHeight)}else if(a.data.recommend){var h=c.parentTarget.baseAtlas.getRec("Recommend");g.drawImage(c.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,0,0,h.pixelWitdh,h.pixelHeight)}else if(a.isnewprop){var h=c.parentTarget.baseAtlas.getRec("New");g.drawImage(c.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,0,0,h.pixelWitdh,h.pixelHeight)}var i=a.getNum();if(-1!=i&&0==i){var h=c.parentTarget.baseAtlas.getRec("SoldOut");g.drawImage(c.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,30,28,h.pixelWitdh,h.pixelHeight)}LabelTextFont.writeSingleLabelToCtxSetAnchor(g,String(a.data.count),16,75,54,TextAlign.RIGHT,ColorType.Whitefff4d6,ColorType.colord27262e)}c._baseRender.uiAtlas.updateCtx(g,f.pixelX,f.pixelY)})},c.prototype.drawName=function(a){var b,c=this._baseRender.uiAtlas.getRec(this.I_name.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);if(1==a.type){var e=tb.Tb_faction_shop.get_Tb_faction_shopById(a.data1.id);b=e.itemId}else b=a.data.itemId;var f=TableData.getInstance().getData(TableData.tb_item_template,b);LabelTextFont.writeSingleLabelToCtxSetAnchor(d,f.name,16,0,0,TextAlign.LEFT,ColorType.Brown7a2f21),this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.getpriceMoney=function(){var a=Math.ceil(this.itdata.data.data.discount/10*this.itdata.data.data.costResource[0][1]);return a},c.prototype.applyrender=function(){var a=this.itdata.data;this.selected?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.I_selects.skinName,UIData.publicUi,PuiData.TITLEHIGHT):UiDraw.clearUI(this.I_selects),this.drawIconAndRecommend(a),this.drawName(a);var b,c;if(1==a.type){var d=tb.Tb_faction_shop.get_Tb_faction_shopById(a.data1.id);b=d.costResource[0][1],c=d.costResource[0][0]}else b=this.getpriceMoney(),c=a.data.costResource[0][0];UiDraw.drawRewardIconAndtxt(this.I_money,[c,b],!0,TextAlign.LEFT,10),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.I_bg.skinName,UIData.publicUi,PuiData.Slist_select)},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.equClick=function(a){UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data&&this.setSelect()},c.prototype.setnull=function(){UiDraw.clearUI(this.I_selects),UiDraw.clearUI(this.I_icon),UiDraw.clearUI(this.I_name),UiDraw.clearUI(this.I_money),UiDraw.clearUI(this.I_bg)},c}(SListItem);a.ShopListRender=c}(store||(store={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),store;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this.shoplist&&(this.shoplist.dispose(),this.shoplist=null)},c.prototype.initUiAtlas=function(a){this._bottomRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){var a=this._topRender;this.addUIList(["a_22","a_21","a_20","b_rightline1"],this._baseRender),this._b_minus=this.addEvntButUp("b_minus",a),this._b_add_1=this.addEvntButUp("b_add_1",a),this._b_add_2=this.addEvntButUp("b_add_2",a),this._b_buy=this.addEvntButUp("b_buy",a),this._b_btn_selectnum=this.addEvntButUp("a_18_1",this._baseRender),this.slistindex1=this.addChild(a.getComponent("slistindex1")),this._num=this.addChild(a.getComponent("a_29")),this._cost=this.addChild(this._baseRender.getComponent("a_30")),this._have=this.addChild(this._baseRender.getComponent("a_31")),this._name=this.addChild(a.getComponent("a_26")),
this._info=this.addChild(a.getComponent("a_27")),this._aryUI1=new Array,this._aryUI2=new Array,this._aryUI1.push(a.getComponent("a_23")),this._aryUI1.push(a.getComponent("a_25")),this._aryUI1.push(a.getComponent("a_28")),this._aryUI2.push(a.getComponent("a_19")),this._aryUI2.push(a.getComponent("a_16")),this._aryUI2.push(a.getComponent("a_24")),this._aryUI2.push(a.getComponent("a_16_1"))},c.prototype.resetData=function(a){var b=a.data;this._vo=b,this.totalnum=1;var c;if(1==b.type){var d=tb.Tb_faction_shop.get_Tb_faction_shopById(b.data1.id);c=d.itemId,b.data1.num-b.data2.num==0&&(this.totalnum=0)}else c=b.data.itemId,0==b.getNum()&&(this.totalnum=0);var e=tb.TB_item_template.get_TB_item_template(c);this.resetlimNum(),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._name.skinName,e.name,16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeTextAutoVerticalCenter(this._topRender.uiAtlas,this._info.skinName,e.info,16,ColorType.color9a683f,170,"",!0),this.setNum(this.totalnum),this.setOwnMoney()},c.prototype.resetlimNum=function(){if(1==this._vo.type){var a=tb.Tb_faction_shop.get_Tb_faction_shopById(this._vo.data1.id);a.discount_flag<100?(this.setUiListVisibleByItem(this._aryUI2,!0),this.drawDiscountPrice("A_16",a.costResource[0][1],a.costResource[0][0],!1),this.drawDiscountPrice("A_16_1",this.getpriceMoneyByfaction(),a.costResource[0][0],!0)):this.setUiListVisibleByItem(this._aryUI2,!1),this.setUiListVisibleByItem(this._aryUI1,!0);var b=this._aryUI1[0];b.goToAndStop(1),ArtFont.getInstance().writeFontToSkinNameCenter(this._topRender.uiAtlas,"A_28",String(this._vo.data1.num-this._vo.data2.num),ArtFont.num6)}else if(this._vo.data.discount<10?(this.setUiListVisibleByItem(this._aryUI2,!0),this.drawDiscountPrice("A_16",this._vo.data.costResource[0][1],this._vo.data.costResource[0][0],!1),this.drawDiscountPrice("A_16_1",this.getpriceMoney(),this._vo.data.costResource[0][0],!0)):this.setUiListVisibleByItem(this._aryUI2,!1),0==this._vo.data.limtype)this.setUiListVisibleByItem(this._aryUI1,!1);else{this.setUiListVisibleByItem(this._aryUI1,!0);var b=this._aryUI1[0];1==this._vo.data.limtype?b.goToAndStop(1):2==this._vo.data.limtype&&b.goToAndStop(0),ArtFont.getInstance().writeFontToSkinNameCenter(this._topRender.uiAtlas,"A_28",String(this._vo.getNum()),ArtFont.num6)}},c.prototype.drawDiscountPrice=function(a,b,c,d){var e=this._topRender.uiAtlas.getRec(a),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1),g=this._topRender.uiAtlas.getRec("DiscountBg");if(f.drawImage(this._topRender.uiAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,0,0,e.pixelWitdh,e.pixelHeight),UiDraw.cxtDrawImg(f,UIuitl.getInstance().costtype(c),new Rectangle(2,0,35,35),UIData.publicUi),LabelTextFont.writeSingleLabelToCtxSetAnchor(f,Snum(b),16,84,14,TextAlign.CENTER,ColorType.Brown7a2f21),!d){var h=this._topRender.uiAtlas.getRec("Line");f.drawImage(this._topRender.uiAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,58,22,h.pixelWitdh,h.pixelHeight)}this._topRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)},c.prototype.setNum=function(a){this.totalnum=a,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this._num.skinName,String(a),16,TextAlign.CENTER,ColorType.Brown7a2f21),this._costnum=a*this.getpriceMoney();var b;if(1==this._vo.type){var c=tb.Tb_faction_shop.get_Tb_faction_shopById(this._vo.data1.id);b=c.costResource[0][0]}else b=this._vo.data.costResource[0][0];this.drawDiscountPrice(this._cost.skinName,this._costnum,b,!0)},c.prototype.setOwnMoney=function(){var a;if(1==this._vo.type){var b=tb.Tb_faction_shop.get_Tb_faction_shopById(this._vo.data1.id);a=b.costResource[0][0]}else a=this._vo.data.costResource[0][0];this.drawDiscountPrice(this._have.skinName,GuidData.player.getResType(a),a,!0)},c.prototype.getpriceMoney=function(){var a;if(1==this._vo.type){var b=tb.Tb_faction_shop.get_Tb_faction_shopById(this._vo.data1.id);a=Math.ceil(b.discount_flag/100*b.costResource[0][1])}else a=Math.ceil(this._vo.data.discount/10*this._vo.data.costResource[0][1]);return a},c.prototype.getpriceMoneyByfaction=function(){var a=tb.Tb_faction_shop.get_Tb_faction_shopById(this._vo.data1.id),b=Math.ceil(a.discount_flag/100*a.costResource[0][1]);return b},c.prototype.show=function(b){UIManager.getInstance().addUIContainer(this),this.shoplist||(this.shoplist=new a.ShopList,this.shoplist.init(this._bottomRender.uiAtlas)),this.shoplist.show(b),this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.shoplist&&this.shoplist.hide()},c.prototype.resize=function(){b.prototype.resize.call(this),this.shoplist&&(this.shoplist.left=this.slistindex1.parent.x/UIData.Scale+this.slistindex1.x,this.shoplist.top=this.slistindex1.parent.y/UIData.Scale+this.slistindex1.y)},c.prototype.butClik=function(a){var b=this;switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this._b_minus:if(0==this.totalnum)return;this.setNum(--this.totalnum);break;case this._b_add_1:if(this.getMaxNum()==this.totalnum)return;this.setNum(++this.totalnum);break;case this._b_add_2:break;case this._b_buy:var c;if(1==this._vo.type){var d=tb.Tb_faction_shop.get_Tb_faction_shopById(this._vo.data1.id);c=d.costResource[0][0]}else c=this._vo.data.costResource[0][0];costRes([c,this._costnum],function(){1==b._vo.type?NetManager.getInstance().protocolos.faction_member_operate(SharedDef.FACTION_MANAGER_TYPE_SHOP,b._vo.data1.id,b.totalnum,"",""):NetManager.getInstance().protocolos.mall_buy(b._vo.data.id,b.totalnum,0)},function(){});break;case this._b_btn_selectnum:MenuKeyUtil.show(function(a){b.popBackFun(a)},a.x-85*UIData.Scale,a.y-240*UIData.Scale)}},c.prototype.popBackFun=function(a){switch(a){case-1:this.setNum(0);break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:var b;b=0==this.totalnum?a:10*this.totalnum+a,this.getMaxNum()<b&&(b=this.getMaxNum()),this.setNum(b);break;case 10:MenuKeyUtil.closeMune()}},c.prototype.getMaxNum=function(){return 1==this._vo.type?this._vo.data1.num-this._vo.data2.num:0==this._vo.data.limtype?this._vo.data.limit:this._vo.getNum()>this._vo.data.limit?this._vo.data.limit:this._vo.getNum()},c}(UIVirtualContainer);a.Shop=b}(store||(store={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),store;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.initUiAtlas=function(a){this._bottomRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){this._baseRender;this._b_btn_vip=this.addEvntButUp("b_btn_vip",this._topRender),this._helpbtn=this.addEvntButUp("a_6",this._topRender),this._refreshbtn=this.addEvntButUp("a_7",this._topRender),this.addUIList(["a_11_0","a_11_1","a_11_2","a_11_5","a_11_4","a_11_3"],this._topRender),this.addUIList(["a_9"],this._baseRender),this.addChild(this._bottomRender.getComponent("c_bg")),this.addChild(this._bottomRender.getComponent("c_bg1")),this.addUIList(["a_3_1","a_5_1","a_4_1","a_3_2","a_5_2","a_4_2","c_huawen"],this._bottomRender);for(var a=0;6>a;a++){var b=this.addChild(this._baseRender.getComponent("a_8_"+a));this.copyUI(b,"a_8_"+a),this.addChild(this._topRender.getComponent("c_title"+a))}this.probar=this.addChild(this._topRender.getComponent("a_10")),this.c_numtxt=this.addChild(this._topRender.getComponent("c_numtxt")),this.currentviplev=this.addChild(this._baseRender.getComponent("a_38")),this.vipLevNum=this.addChild(this._topRender.getComponent("a_54")),this.nextviplev=this.addChild(this._topRender.getComponent("a_2"));for(var c=tb.TB_shop_chongzhi.getTB_shop_chongzhi(),a=0;a<c.length;a++){var d=this.addChild(this._topRender.getComponent("a_"+(32+a)));LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,d.skinName,"￥"+c[a].yuanbao,16,TextAlign.CENTER,ColorType.Brown7a2f21)}this.resize()},b.prototype.copyUI=function(a,b){var c=this.addChild(this._baseRender.getComponent(b));c.isU=!0,c.x=a.x-a.width},b.prototype.resetData=function(){ArtFont.getInstance().writeFontToSkinName(this._topRender.uiAtlas,this.vipLevNum.skinName,String(GuidData.player.getVipLevel()),ArtFont.num58,TextAlign.LEFT);var a=tb.TB_vip_base.get_TB_vip_baseById(GuidData.player.getVipLevel()+1);if(0!=GuidData.player.getVipLevel()){var b=tb.TB_vip_base.get_TB_vip_baseById(GuidData.player.getVipLevel()),c=(GuidData.player.getChongZhiSum()-b.chongzhi)/(a.chongzhi-b.chongzhi);this.probar.uvScale=0>c?0:c}else{var c=GuidData.player.getChongZhiSum()/a.chongzhi;this.probar.uvScale=0>c?0:c}var d=a.chongzhi-GuidData.player.getChongZhiSum();console.log("充值数---",GuidData.player.getChongZhiSum()),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.c_numtxt.skinName,GuidData.player.getChongZhiSum()+"/"+a.chongzhi,12,TextAlign.CENTER,ColorType.color4b0808),this.drawNextVip(d)},b.prototype.drawNextVip=function(a){var b=String(GuidData.player.getVipLevel()+1),c=ColorType.Brown7a2f21+"再充值"+ColorType.Green2ca937+a+ColorType.Brown7a2f21+"元即可成为"+ColorType.colorff7200+"VIP"+b;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.nextviplev.skinName,c,16,TextAlign.CENTER,ColorType.Brown7a2f21)},b.prototype.drawVip=function(a,b,c,d,e){void 0===d&&(d=0),void 0===e&&(e=0);var f=a.getRec(b),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);UiDraw.cxtDrawImg(g,PuiData.A_V,new Rectangle(d,0,22,19),UIData.publicUi),ArtFont.getInstance().writeFontToCtxLeft(g,String(c),ArtFont.BigYellow,d+24,e),a.updateCtx(g,f.pixelX,f.pixelY)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this._b_btn_vip:ModulePageManager.openPanel(SharedDef.MODULE_VIP)}},b}(UIConatiner);a.RechargePanel=b}(store||(store={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),store;!function(a){var b=function(){function a(){}return a}();a.TabVo=b;var c=function(c){function e(){var a=c.call(this)||this;return a.left=51,a.top=90,a}return __extends(e,c),e.prototype.init=function(a){this.baseAtlas=a,this.initData()},e.prototype.initData=function(){var a=new Array;this.setData(a,d,152,422,0,50,8,256,512,1,10)},e.prototype.refreshDataByNewData=function(){var b=a.StoreModel.getInstance().getTablist(this._type[0]);this._itemDataList=this.getData(b),this.refreshData(this._itemDataList)},e.prototype.getData=function(a){for(var c=new Array,d=0;d<a.length;d++){var e=new b;e.data=tb.TB_shop_base.get_TB_shop_base(a[d]),e.id=e.data.id;var f=new SListItemData;f.data=e,f.id=d,c.push(f)}return c},e.prototype.show=function(a){this.hasStage||UIManager.getInstance().addUIContainer(this),this._type=a,this.refreshAndselectIndex()},e.prototype.getSelectIdByTid=function(a){console.log("---表id---",a);for(var b=0;b<this._itemDataList.length;b++)if(this._itemDataList[b].data.id==a)return this._itemDataList[b].id;return console.log("--没有符合的项",a),0},e.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData();var b=a.StoreModel.getInstance().getPage(this._type[0]);this._type.length>1&&(b=this._type[1]);var c=this.getSelectIdByTid(b);this.setSelectIndex(c)},e.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},e}(SList);a.ShopMallPanelTabList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Tabbg=this.creatSUI(c,this.parentTarget.baseAtlas,"Tabbg",0,0,152,48),a.addChild(this.Tabbg),this.Tabbg.addEventListener(InteractiveEvent.Down,this.equClick,this),this.Tabname=this.creatSUI(d,this.parentTarget.baseAtlas,"Tabname",26,14,100,20),a.addChild(this.Tabname)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.applyrender(),b){var c=new a.StoreEvent(a.StoreEvent.SELECT_TAB_EVENT);c.data=this.itdata.data.id,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.drawTab=function(){var a,b=this._baseRender.uiAtlas.getRec(this.Tabbg.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);a=this.selected?this.parentTarget.baseAtlas.getRec("btn_select"):this.parentTarget.baseAtlas.getRec("btn_noselect"),c.drawImage(this.parentTarget.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;this.drawTab(),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Tabname.skinName,a.data.typename,16,TextAlign.CENTER,ColorType.Brown7a2f21)}},c.prototype.render=function(a){this.itdata=a,a?(this.applyrender(),this.Tabbg.addEventListener(InteractiveEvent.Down,this.equClick,this)):(this.Tabbg.removeEventListener(InteractiveEvent.Down,this.equClick,this),this.setnull())},c.prototype.equClick=function(){this.setSelect()},c.prototype.setnull=function(){UiDraw.clearUI(this.Tabbg),UiDraw.clearUI(this.Tabname)},c}(SListItem);a.ShopMallPanelTabRender=d}(store||(store={}));var store;!function(a){var b=function(){function a(){this.getBaseList()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getBaseList=function(){this._activityary=new Array;for(var a=tb.TB_shop.get_TB_shop(),b=0;b<a.length;b++){var d=new c;d.data=a[b],d.canBuy()&&this._activityary.push(d)}console.log("----this._activityary-----",this._activityary)},a.prototype.getPage=function(a){if(a==SharedDef.MODULE_MALL_SCORE&&GuidData.faction)return 1;for(var b=0;b<this._activityary.length;b++){var c=this._activityary[b];if(a==c.data.tab)return c.data.type}},a.prototype.getList=function(a){var b;return b=1==a?this.getFactionList():this.getrecommendList(a),console.log("--$finalary--",b),b},a.prototype.getItemVo=function(a){for(var b=0;b<this._activityary.length;b++){var c=this._activityary[b];if(a==c.data.itemId)return c}return null},a.prototype.getrecommendList=function(a){for(var b=new Array,c=0;c<this._activityary.length;c++){var d=this._activityary[c];a==d.data.type&&b.push(this._activityary[c])}return b},a.prototype.getFactionList=function(){for(var a=new Array,b=GuidData.faction.getShopList(),d=0;d<b.length;d++){var e=new c;e.data1=b[d],e.data2=this.getfactionshopnumVo(b[d].id),a.push(e)}return a},a.prototype.getfactionshopnumVo=function(a){for(var b=GuidData.player.getFactionShopNumList(),c=0;c<b.length;c++)if(b[c].id==a)return b[c];return b[b.length-1]},a.prototype.getTablist=function(a){var b=new Array;a==SharedDef.MODULE_MALL_SCORE&&GuidData.faction&&b.push(1);for(var c=0;c<this._activityary.length;c++)this._activityary[c].data.tab==a&&this.completeAB(b,this._activityary[c].data.type)&&b.push(this._activityary[c].data.type);return b},a.prototype.completeAB=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!1;return!0},a}();a.StoreModel=b;var c=function(){function a(){this.isnewprop=!1}return a.prototype.canBuy=function(){if(this.data.time&&this.data.time.length>0){if(!this.compareTime(this.data.time[0],this.data.time[1]-1,this.data.time[2])&&this.compareTime(this.data.time[3],this.data.time[4]-1,this.data.time[5])){var a=GameInstance.getServerNow(),b=new Date(1e3*a),c=b.getTime()-this.getTime(this.data.time[0],this.data.time[1],this.data.time[2]),d=this.getTime(2017,1,2)-this.getTime(2017,1,5);return d>c&&(this.isnewprop=!0),!0}return!1}return!0},a.prototype.getNum=function(){var a=-1;if(0!=this.data.limtype){var b=this.data.limdata,c=GuidData.player.getLimShopNum(this.data.id);a=b-c}return a},a.prototype.compareTime=function(a,b,c){var d=GameInstance.getServerNow(),e=new Date(1e3*d),f=new Date(1e3*d);return f.setFullYear(a),f.setMonth(b),f.setDate(c),f.setHours(0),f.setMinutes(0),f.setSeconds(0),e.getTime()<f.getTime()},a.prototype.getTime=function(a,b,c){var d=GameInstance.getServerNow(),e=new Date(1e3*d);return e.setFullYear(a),e.setMonth(b),e.setDate(c),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.getTime()},a}();a.StoreItemVo=c}(store||(store={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),store;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baImg=new UIBackImg,a._baImg.alpha=.5,a._baImg.setFbo(),a.addRender(a._baImg),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baImg.dispose(),this._baImg=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.shopMallPanel&&(this.shopMallPanel.dispose(),this.shopMallPanel=null),this.rechargePanel.dispose(),this.rechargePanel=null},c.prototype.onAdd=function(){b.prototype.onAdd.call(this),SceneManager.getInstance().updateFBO()},c.prototype.applyLoad=function(){var a=this;this._baseRender.uiAtlas.setInfo("ui/uidata/store/store.xml","ui/uidata/store/store.png",function(){a.loadConfigCom()},"ui/uidata/store/storepc.png")},c.prototype.loadConfigCom=function(){this._topRender.uiAtlas=this._baseRender.uiAtlas;var a=this._baseRender;this.Slistindex=this.addChild(this._topRender.getComponent("slistindex")),this.addChild(a.getComponent("b_bg")),this.addChild(a.getComponent("b_bgborrow"));var b=(this.addChild(a.getComponent("bg_2")),this.addChild(a.getComponent("bg_2")));b.isU=!0,b.x=912;var c=this.addChild(a.getComponent("bg_1")),d=this.addChild(a.getComponent("bg_1"));d.isU=!0,d.x=c.x+477,this.addChild(a.getComponent("bg_title"));var e=(this.addChild(a.getComponent("b_titleribbon")),this.addChild(a.getComponent("b_titleribbon")));e.isU=!0,e.x=560;var f=(this.addChild(a.getComponent("bg_3")),this.addChild(a.getComponent("bg_3")));f.isU=!0,f.x=901;var g=(this.addChild(a.getComponent("b_bgribbon")),this.addChild(a.getComponent("b_bgribbon")));g.isU=!0,g.x=910,this.addChild(a.getComponent("b_bghuawen3")),this.addChild(a.getComponent("b_bghuwen1")),this.addChild(a.getComponent("b_bghuawen2")),this.addChild(a.getComponent("b_bg_bottomline")),this.tab_yuanbao=this.addEvntBut("tab_0",this._topRender),this.tab_duihuan=this.addEvntBut("tab_1",this._topRender),this.tab_money=this.addEvntBut("tab_2",this._topRender),this.addChild(this._topRender.getComponent("b_rightline")),this.b_bgleft=this._topRender.getComponent("b_bgleft"),this.b_close=this.addEvntButUp("b_close",this._topRender),this.applyLoadComplete(),this.resize()},c.prototype.selecttype=function(b){b||(b=[SharedDef.MODULE_MALL_GOLD]),this.shop||(this.shop=new a.Shop,this.shop.initUiAtlas(this._baseRender.uiAtlas)),this.shopMallPanel||(this.shopMallPanel=new a.ShopMallPanelTabList,this.shopMallPanel.init(this._baseRender.uiAtlas)),this.rechargePanel||(this.rechargePanel=new a.RechargePanel,this.rechargePanel.initUiAtlas(this._baseRender.uiAtlas)),this.setUiListVisibleByItem([this.b_bgleft],b[0]!=SharedDef.MODULE_MALL_RECHARGE),b[0]==SharedDef.MODULE_MALL_GOLD?(this.tab_yuanbao.selected=!0,this.tab_duihuan.selected=!1,this.tab_money.selected=!1,this.shopMallPanel.show(b),this.rechargePanel.hide()):b[0]==SharedDef.MODULE_MALL_SCORE?(this.tab_duihuan.selected=!0,this.tab_yuanbao.selected=!1,this.tab_money.selected=!1,this.shopMallPanel.show(b),this.rechargePanel.hide()):(this.tab_money.selected=!0,this.tab_yuanbao.selected=!1,this.tab_duihuan.selected=!1,this.rechargePanel.show(),this.shopMallPanel.hide(),this.shop.hide())},c.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.selecttype(a)},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.shopMallPanel&&this.shopMallPanel.hide(),this.rechargePanel&&this.rechargePanel.hide(),this.shop&&this.shop.hide(),ModulePageManager.hideResTittle()},c.prototype.resize=function(){b.prototype.resize.call(this),this.shopMallPanel&&(this.shopMallPanel.left=this.Slistindex.parent.x/UIData.Scale+this.Slistindex.x,this.shopMallPanel.top=this.Slistindex.parent.y/UIData.Scale+this.Slistindex.y)},c.prototype.butClik=function(b){switch(b.target){case this.tab_yuanbao:this.selecttype([SharedDef.MODULE_MALL_GOLD]);break;case this.tab_duihuan:this.selecttype([SharedDef.MODULE_MALL_SCORE]);break;case this.tab_money:this.selecttype([SharedDef.MODULE_MALL_RECHARGE]);break;case this.b_close:ModuleEventManager.dispatchEvent(new a.StoreEvent(a.StoreEvent.HIDE_Store_EVENT))}},c}(UIPanel);a.StoreUiPanel=b}(store||(store={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),store;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"StoreModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.StoreModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_Store_EVENT="SHOW_Store_EVENT",b.HIDE_Store_EVENT="HIDE_Store_EVENT",b.STORE_NUM_EVENT="STORE_NUM_EVENT",b.SELECT_PROP_EVENT="SELECT_PROP_EVENT",b.SELECT_TAB_EVENT="SELECT_TAB_EVENT",b}(BaseEvent);a.StoreEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"StoreProcessor"},d.prototype.receivedModuleEvent=function(a){var b=this;if(a instanceof c){var d=a;d.type==c.SHOW_Store_EVENT?this.showUi(d.data):d.type==c.HIDE_Store_EVENT?this.hideUi():d.type==c.STORE_NUM_EVENT?this.refreshData():d.type==c.SELECT_PROP_EVENT?this.selectedProp(d.data):d.type==c.SELECT_TAB_EVENT&&this.selectTab(d.data)}if(a instanceof EngineEvent){var e=a;e.type==EngineEvent.MONEY_CHANGE&&this._storeUiPanel&&this._storeUiPanel.shopMallPanel&&this._storeUiPanel.shop&&this._storeUiPanel.shop.hasStage&&(this._storeUiPanel.shop.setOwnMoney(),TimeUtil.addTimeOut(10,function(){b._storeUiPanel.shop.resetlimNum()}))}if(a instanceof UIPanelEvent){var f=a;f.panel==this._storeUiPanel&&(this._storeUiPanel.dispose(),this._storeUiPanel=null,console.log("释放面板 _storeUiPanel"))}},d.prototype.selectTab=function(a){this._storeUiPanel&&this._storeUiPanel.shop&&this._storeUiPanel.shop.show(a)},d.prototype.selectedProp=function(a){this._storeUiPanel&&this._storeUiPanel.shop&&this._storeUiPanel.shop.hasStage&&this._storeUiPanel.shop.resetData(a)},d.prototype.refreshData=function(){this._storeUiPanel&&this._storeUiPanel.shop&&this._storeUiPanel.shop.shoplist.refreshDataByNewData()},d.prototype.hideUi=function(){this._storeUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(b){var c=this;void 0===b&&(b=null),console.log("--打开商城--参数",b),this._storeUiPanel||(this._storeUiPanel=new a.StoreUiPanel),this._storeUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),c._storeUiPanel.show(b)})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_Store_EVENT),new c(c.HIDE_Store_EVENT),new c(c.STORE_NUM_EVENT),new c(c.SELECT_PROP_EVENT),new c(c.SELECT_TAB_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.StoreProcessor=d}(store||(store={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),welfare;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._bigPic=new UIRenderOnlyPicComponent,b.addRender(b._bigPic),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._bigPic.dispose(),this._bigPic=null,this._bottomRender.dispose(),this._bottomRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.initUiAtlas=function(a){this._bottomRender.uiAtlas=a,this._bigPic.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){this._baseRender;this.addChild(this._bigPic.getComponent("c_pic")),this._bigPic.setImgUrl("ui/uidata/welfare/sevendaybg.png"),this.b_role=this.addChild(this._baseRender.getComponent("b_role")),this.titleary=new Array,this.nameary=new Array,this.btnary=new Array;for(var a=0;7>a;a++){this.addChild(this._baseRender.getComponent("b_titlebg"+a)),this.titleary.push(this.addChild(this._topRender.getComponent("b_title"+a))),this.nameary.push(this.addChild(this._topRender.getComponent("b_name"+a)));var b=this.addChild(this._topRender.getComponent("b_btn"+a));b.addEventListener(InteractiveEvent.Up,this.receiveClik,this),this.btnary.push(b)}this.iconary=new Array;for(var c=0;6>c;c++)this.iconary.push(this.addChild(this._topRender.getComponent("b_prop"+c))),this.addChild(this._bottomRender.getComponent("b_bg"+c));this.mountRoleSprite=new Person2DChar,this.mountRoleSprite.needUIUrl=!1,this._baseRender.addModel(this.mountRoleSprite)},b.prototype.setAvatar=function(a){console.log("---$avatar--",a),this.mountRoleSprite.setAvatar(a)},b.prototype.resizeRole=function(){this.mountRoleSprite&&(this.mountRoleSprite.resize(),this.mountRoleSprite.scale=4*UIData.Scale,this.mountRoleSprite.rotationY=0,this.mountRoleSprite.x=-203*UIData.Scale,this.mountRoleSprite.y=-90*UIData.Scale)},b.prototype.resize=function(){this.resizeRole(),a.prototype.resize.call(this)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.resetData=function(){for(var a=GuidData.quest.getSevenDayList(),b=0;b<a.length;b++)this.btnary[b].data=a[b],LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.titleary[b].skinName,"登陆"+a[b].data.id+"天可领取",16,TextAlign.CENTER,ColorType.Whitefff4d6),this.btnary[b].goToAndStop(a[b].state),b<a.length-1?(LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.nameary[b].skinName,GameData.getPropName(a[b].data.item[0][0]),16,TextAlign.CENTER,ColorType.Brown7a2f21),IconManager.getInstance().drawItemIcon60(this.iconary[b],a[b].data.item[0][0],a[b].data.item[0][1],!1,!0)):(console.log("---a[i].data.show--",a[b].data.show,b,a[b]),UiDraw.clearUI(this.nameary[b]),this.setAvatar(a[b].data.show));this.resize()},b.prototype.receiveClik=function(a){var b=a.target.data;console.log("---data",b),b&&1==b.state&&(NetManager.getInstance().protocolos.welfare_get_sevenday_reward(b.data.id),console.log("---data.data.id"))},b}(UIVirtualContainer);a.WelfareSevenDay=b}(welfare||(welfare={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),welfare;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bigPic=new UIRenderOnlyPicComponent,b.addRender(b._bigPic),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.dispose=function(){this._bigPic.dispose(),this._bigPic=null,this._baseRender.dispose(),this._baseRender=null,this.welfarCostList&&(this.welfarCostList.dispose(),this.welfarCostList=null)},b.prototype.initUiAtlas=function(a){this._bigPic.uiAtlas=a,this._baseRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.addChild(this._bigPic.getComponent("b_pic")),this._bigPic.setImgUrl("ui/uidata/welfare/adbg.png");var b=this.addChild(a.getComponent("t_info")),c=tb.TB_welfare_base.get_TB_welfare_baseById(1);LabelTextFont.writeTextAutoVerticalCenter(this._baseRender.uiAtlas,b.skinName,"活动说明："+c.expense_info,16,ColorType.Brown40120a,545,"",!0),this.slistIndex2=this.addChild(a.getComponent("slistIndex2"))},b.prototype.resize=function(){a.prototype.resize.call(this),this.welfarCostList&&(this.welfarCostList.left=this.slistIndex2.parent.x/UIData.Scale+this.slistIndex2.x,this.welfarCostList.top=this.slistIndex2.parent.y/UIData.Scale+this.slistIndex2.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.welfarCostList&&this.welfarCostList.hide()},b.prototype.resetData=function(){this.welfarCostList||(this.welfarCostList=new c,this.welfarCostList.init(this._baseRender.uiAtlas)),this.welfarCostList.show(),this.resize()},b}(UIVirtualContainer);a.WelfareCost=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=222,a.top=192,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var b=new Array;this.setData(b,a.WelfareGeneralListRender,681,319,0,83,3,512,512,1,6)},c.prototype.compareAry=function(a){if(a.length!=this._everycheckinlist.length)return!0;for(var b=0;b<a.length;b++)if(a[b].state!=this._everycheckinlist[b].state)return!0;return!1},c.prototype.refreshDataByNewData=function(){var a=!0,b=GuidData.quest.getCostRewardList();if(this._everycheckinlist&&(a=this.compareAry(b)),a){console.log("数据变化了"),this._everycheckinlist=b;var c=this.getData(this._everycheckinlist);this.refreshData(c)}},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},c.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this);
},c}(SList);a.WelfarCostList=c}(welfare||(welfare={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),welfare;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bigPic=new UIRenderOnlyPicComponent,b.addRender(b._bigPic),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.dispose=function(){this._bigPic.dispose(),this._bigPic=null,this._baseRender.dispose(),this._baseRender=null,this.welfareRechargeList&&(this.welfareRechargeList.dispose(),this.welfareRechargeList=null)},b.prototype.initUiAtlas=function(a){this._bigPic.uiAtlas=a,this._baseRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.addChild(this._bigPic.getComponent("b_pic")),this._bigPic.setImgUrl("ui/uidata/welfare/adbg.png");var b=this.addChild(a.getComponent("t_info")),c=tb.TB_welfare_base.get_TB_welfare_baseById(1);LabelTextFont.writeTextAutoVerticalCenter(this._baseRender.uiAtlas,b.skinName,"活动说明："+c.recharge_info,16,ColorType.Brown40120a,545,"",!0),this.slistIndex2=this.addChild(a.getComponent("slistIndex2"))},b.prototype.resize=function(){a.prototype.resize.call(this),this.welfareRechargeList&&(this.welfareRechargeList.left=this.slistIndex2.parent.x/UIData.Scale+this.slistIndex2.x,this.welfareRechargeList.top=this.slistIndex2.parent.y/UIData.Scale+this.slistIndex2.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.welfareRechargeList&&this.welfareRechargeList.hide()},b.prototype.resetData=function(){this.welfareRechargeList||(this.welfareRechargeList=new c,this.welfareRechargeList.init(this._baseRender.uiAtlas)),this.welfareRechargeList.show(),this.resize()},b}(UIVirtualContainer);a.WelfareRecharge=b;var c=function(a){function b(){var b=a.call(this)||this;return b.left=222,b.top=192,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,d,681,319,0,83,3,512,512,1,6)},b.prototype.compareAry=function(a){if(a.length!=this._everycheckinlist.length)return!0;for(var b=0;b<a.length;b++)if(a[b].state!=this._everycheckinlist[b].state)return!0;return!1},b.prototype.refreshDataByNewData=function(){var a=!0,b=GuidData.quest.getRechargeRewardList();if(this._everycheckinlist&&(a=this.compareAry(b)),a){console.log("数据变化了"),this._everycheckinlist=b;var c=this.getData(this._everycheckinlist);this.refreshData(c)}},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},b.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData()},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.WelfareRechargeList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.Txt=this.creatSUI(d,this.parentTarget.baseAtlas,"Txt",12,34,36,20),b.addChild(this.Txt),this.Cost=this.creatSUI(d,this.parentTarget.baseAtlas,"Cost",59,19,100,35),b.addChild(this.Cost),this._ary=new Array,this.I2reward0=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward0",171,8,68,68),b.addChild(this.I2reward0),this.I2reward0.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.I2reward0),this.I2reward1=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward1",251,8,68,68),b.addChild(this.I2reward1),this.I2reward1.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.I2reward1),this.I2reward2=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward2",331,8,68,68),b.addChild(this.I2reward2),this.I2reward2.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.I2reward2),this.I2reward3=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward3",411,8,68,68),b.addChild(this.I2reward3),this.I2reward3.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.I2reward3),this.I2btn=this.creatSUI(d,this.parentTarget.baseAtlas,"I2btn",536,19,105,46),b.addChild(this.I2btn),this.I2btn.addEventListener(InteractiveEvent.Up,this.btnChick,this),this.I2tembg=this.creatSUI(c,this.parentTarget.baseAtlas,"I2tembg",0,0,681,83),b.addChild(this.I2tembg)},b.prototype.drawBtn=function(){var a,b=this._baseRender.uiAtlas.getRec(this.I2btn.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);a=1==this.itdata.data.state?this.parentTarget.baseAtlas.getRec("receivebtn"):2==this.itdata.data.state?this.parentTarget.baseAtlas.getRec("no"):this.parentTarget.baseAtlas.getRec("ok"),c.drawImage(this.parentTarget.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){for(var a=0;a<this._ary.length;a++){var b=this.itdata.data;a<this.itdata.data.data.item.length?(this._ary[a].data=b.data.item[a],IconManager.getInstance().drawItemIcon60(this._ary[a],b.data.item[a][0],b.data.item[a][1],3==b.state,!1)):(this._ary[a].data=null,UiDraw.clearUI(this._ary[a]))}var c;this.itdata.data.type==SharedDef.MODULE_WELFARE_CONSUME?c="TxtCost":this.itdata.data.type==SharedDef.MODULE_WELFARE_RECHARGE&&(c="TxtRecharge"),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.Txt.skinName,c),UiDraw.drawRewardIconAndtxt(this.Cost,[1,this.itdata.data.data.money],!1,TextAlign.LEFT,18),this.drawBtn(),this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.I2tembg.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG)}},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},b.prototype.equClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)){var b=a.target.data;if(b&&b.length>0){var c=tb.TB_item_template.get_TB_item_template(b[0]),d=new BagItemData;d.entryData=c;var e=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);e.data=d,e.buttonType=-1,ModuleEventManager.dispatchEvent(e)}}},b.prototype.btnChick=function(a){UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data&&1==this.itdata.data.state&&(this.itdata.data.type==SharedDef.MODULE_WELFARE_CONSUME?NetManager.getInstance().protocolos.welfare_get_consume_reward(this.itdata.data.data.id):this.itdata.data.type==SharedDef.MODULE_WELFARE_RECHARGE&&NetManager.getInstance().protocolos.welfare_get_recharge_reward(this.itdata.data.data.id))},b.prototype.setnull=function(){UiDraw.clearUI(this.Txt),UiDraw.clearUI(this.Cost),UiDraw.clearUI(this.I2reward0),UiDraw.clearUI(this.I2reward1),UiDraw.clearUI(this.I2reward2),UiDraw.clearUI(this.I2reward3),UiDraw.clearUI(this.I2btn),UiDraw.clearUI(this.I2tembg)},b}(SListItem);a.WelfareGeneralListRender=d}(welfare||(welfare={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),welfare;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bigPic=new UIRenderOnlyPicComponent,b.addRender(b._bigPic),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.dispose=function(){this._bigPic.dispose(),this._bigPic=null,this._baseRender.dispose(),this._baseRender=null,this.welfareLevelList&&(this.welfareLevelList.dispose(),this.welfareLevelList=null)},b.prototype.initUiAtlas=function(a){this._bigPic.uiAtlas=a,this._baseRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender;this.addChild(this._bigPic.getComponent("b_pic")),this._bigPic.setImgUrl("ui/uidata/welfare/adbg.png");var b=this.addChild(a.getComponent("t_info")),c=tb.TB_welfare_base.get_TB_welfare_baseById(1);LabelTextFont.writeTextAutoVerticalCenter(this._baseRender.uiAtlas,b.skinName,"活动说明："+c.lev_info,16,ColorType.Brown40120a,545,"",!0),this.slistIndex2=this.addChild(a.getComponent("slistIndex2"))},b.prototype.resize=function(){a.prototype.resize.call(this),this.welfareLevelList&&(this.welfareLevelList.left=this.slistIndex2.parent.x/UIData.Scale+this.slistIndex2.x,this.welfareLevelList.top=this.slistIndex2.parent.y/UIData.Scale+this.slistIndex2.y)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.welfareLevelList&&this.welfareLevelList.hide()},b.prototype.resetData=function(){this.welfareLevelList||(this.welfareLevelList=new c,this.welfareLevelList.init(this._baseRender.uiAtlas)),this.welfareLevelList.show(),this.resize()},b}(UIVirtualContainer);a.WelfareLevel=b;var c=function(a){function b(){var b=a.call(this)||this;return b.left=222,b.top=192,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,d,681,319,0,83,3,512,512,1,6)},b.prototype.compareAry=function(a){if(a.length!=this._everycheckinlist.length)return!0;for(var b=0;b<a.length;b++)if(a[b].state!=this._everycheckinlist[b].state)return!0;return!1},b.prototype.refreshDataByNewData=function(){var a=!0,b=GuidData.quest.getLevelUpRewardList();if(this._everycheckinlist&&(a=this.compareAry(b)),a){console.log("数据变化了"),this._everycheckinlist=b;var c=this.getData(this._everycheckinlist);this.refreshData(c)}},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},b.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData()},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.WelfareLevelList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.I2name=this.creatSUI(d,this.parentTarget.baseAtlas,"I2name",45,34,100,20),b.addChild(this.I2name),this._ary=new Array,this.I2reward0=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward0",171,8,68,68),b.addChild(this.I2reward0),this._ary.push(this.I2reward0),this.I2reward1=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward1",251,8,68,68),b.addChild(this.I2reward1),this._ary.push(this.I2reward1),this.I2reward2=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward2",331,8,68,68),b.addChild(this.I2reward2),this._ary.push(this.I2reward2),this.I2reward3=this.creatSUI(d,this.parentTarget.baseAtlas,"I2reward3",411,8,68,68),b.addChild(this.I2reward3),this._ary.push(this.I2reward3),this.I2btn=this.creatSUI(d,this.parentTarget.baseAtlas,"I2btn",536,19,105,46),b.addChild(this.I2btn),this.I2btn.addEventListener(InteractiveEvent.Up,this.btnChick,this),this.I2tembg=this.creatSUI(c,this.parentTarget.baseAtlas,"I2tembg",0,0,681,83),b.addChild(this.I2tembg)},b.prototype.drawBtn=function(){var a,b=this.itdata.data,c=this._baseRender.uiAtlas.getRec(this.I2btn.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);a=1==b.state?this.parentTarget.baseAtlas.getRec("receivebtn"):2==b.state?this.parentTarget.baseAtlas.getRec("no"):this.parentTarget.baseAtlas.getRec("ok"),d.drawImage(this.parentTarget.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},b.prototype.drawTitle=function(){var a=this.itdata.data,b=this._baseRender.uiAtlas.getRec(this.I2name.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1),d=ArtFont.getInstance().getAirFontWidth(c,String(a.data.lev),ArtFont.num26,5);ArtFont.getInstance().writeFontToCtxLeft(c,String(a.data.lev),ArtFont.num26,0,2,5);var e=this.parentTarget.baseAtlas.getRec("Libao");c.drawImage(this.parentTarget.baseAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,d,0,e.pixelWitdh,e.pixelHeight),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){for(var a=this.itdata.data,b=0;b<this._ary.length;b++)b<a.data.item.length?(this._ary[b].data=a.data.item[b],IconManager.getInstance().drawItemIcon60(this._ary[b],a.data.item[b][0],a.data.item[b][1],3==a.state,!0)):(this._ary[b].data=null,UiDraw.clearUI(this._ary[b]),IconManager.getInstance().clearItemEvent(this._ary[b]));LabelTextFont.writeSingleLabel(this.uiAtlas,this.I2name.skinName,ColorType.Brown7a2f21+"升到"+ColorType.Green2ca937+a.data.lev+ColorType.Brown7a2f21+"级",16,TextAlign.LEFT,ColorType.Brown7a2f21),this.drawBtn(),this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.I2tembg.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG)}},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},b.prototype.btnChick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){var b=this.itdata.data;1==b.state&&NetManager.getInstance().protocolos.welfare_level(b.data.id)}},b.prototype.setnull=function(){UiDraw.clearUI(this.I2name),UiDraw.clearUI(this.I2reward0),UiDraw.clearUI(this.I2reward1),UiDraw.clearUI(this.I2reward2),UiDraw.clearUI(this.I2reward3),UiDraw.clearUI(this.I2btn),UiDraw.clearUI(this.I2tembg)},b}(SListItem);a.WelfareLevelListRender=d}(welfare||(welfare={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),welfare;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(d,b),d.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._bgRender.dispose(),this._bgRender=null,this._topRender.dispose(),this._topRender=null,this.welfareEveryCheckinList&&(this.welfareEveryCheckinList.dispose(),this.welfareEveryCheckinList=null),this._frameRender&&(this._frameRender.dispose(),this._frameRender=null)},d.prototype.initUiAtlas=function(a){this._bgRender.uiAtlas=a,this._bottomRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},d.prototype.initView=function(){var a=this._baseRender;this._aryRewardUI=new Array,this._aryRewardnameUI=new Array,this._aryRewardstateUI=new Array;for(var b=0;5>b;b++){var c=this.addChild(a.getComponent("t_prop"+b));c.addEventListener(InteractiveEvent.Up,this.RewardClik,this),this._aryRewardUI.push(c),this._aryRewardnameUI.push(this.addChild(a.getComponent("t_name"+b))),this._aryRewardstateUI.push(this._topRender.getComponent("a_wj_chuo"+b))}this._aryProUI=new Array;for(var b=0;4>b;b++){var d=this._baseRender.getComponent("a_wj_line"+b);this.addChild(d),this._aryProUI.push(d),d.goToAndStop(1)}var e=this.addChild(this._bottomRender.getComponent("a_huawen1"));e.isU=!0,this.addUIList(["a_titlebg","a_bg"],this._bgRender),this.addUIList(["a_title","a_huawen","t_hua1","t_hua2","t_hua3","t_hua4","t_hua5","t_hua6"],this._bottomRender),this.slistIndex1=this.addChild(this._bottomRender.getComponent("slistIndex1")),this.buildFram()},d.prototype.buildFram=function(){var a=this;this._frameRender||(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ef_fl"),4,4,function(b){a.effAry=b;for(var c=0;c<a.effAry.length;c++)a.effAry[c].x=a._aryRewardUI[c].x-30,a.effAry[c].y=a._aryRewardUI[c].y-30,a.effAry[c].speed=3;a.playEff()},this._aryRewardUI.length))},d.prototype.playEff=function(){if(this.effAry)for(var a=0;a<this._aryRewardUI.length;a++){var b=this._aryRewardUI[a].data;b&&2==b.state?(this.addChild(this.effAry[a]),this.effAry[a].play()):this.removeChild(this.effAry[a])}},d.prototype.resize=function(){b.prototype.resize.call(this),this.welfareEveryCheckinList&&(this.welfareEveryCheckinList.left=this.slistIndex1.parent.x/UIData.Scale+this.slistIndex1.x,this.welfareEveryCheckinList.top=this.slistIndex1.parent.y/UIData.Scale+this.slistIndex1.y)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.welfareEveryCheckinList&&this.welfareEveryCheckinList.hide()},d.prototype.resetData=function(){this.welfareEveryCheckinList||(this.welfareEveryCheckinList=new c,this.welfareEveryCheckinList.init(this._baseRender.uiAtlas)),this.welfareEveryCheckinList.show(),this.setUiListVisibleByItem(this._aryRewardstateUI,!1);for(var a=GuidData.quest.getSigninWeekList(),b=0;b<a.length;b++){var d=a[b];this._aryRewardUI[b].data=d,this.drawReward(this._aryRewardUI[b]),3==d.state&&this.setUiListVisibleByItem([this._aryRewardstateUI[b]],!0),b>0&&(1!=d.state?this._aryProUI[b-1].goToAndStop(0):this._aryProUI[b-1].goToAndStop(1)),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this._aryRewardnameUI[b].skinName,"签到"+d.data.num+"天",16,TextAlign.CENTER,ColorType.Brown7a2f21)}this.playEff(),this.resize()},d.prototype.drawReward=function(a){var b=this,c=a.data,d=tb.TB_item_template.get_TB_item_template(c.data.item[0][0]);IconManager.getInstance().getIcon(geteqiconIconUrl(d.icon),function(e){var f=b._baseRender.uiAtlas.getRec(a.skinName),g=UIManager.getInstance().getContext2D(f.pixelWitdh,f.pixelHeight,!1);UiDraw.cxtDrawImg(g,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(g,ItemGoodQuality.getQuaStr(d.quality),new Rectangle(3,3,62,62),UIData.publicUi),g.drawImage(e,0,0,60,60,4,4,60,60),LabelTextFont.writeSingleLabelToCtxSetAnchor(g,String(c.data.item[0][1]),16,62,42,TextAlign.RIGHT,ColorType.Whitefff4d6,ColorType.colord27262e),2!=c.state?UIManager.getInstance().makeCtxToGray(g,new Rectangle(0,0,68,68)):UiDraw.cxtDrawImg(g,PuiData.A_RED_POINT,new Rectangle(51,0,17,16),UIData.publicUi),b._bottomRender.uiAtlas.updateCtx(g,f.pixelX,f.pixelY)})},d.prototype.butClik=function(b){ModuleEventManager.dispatchEvent(new a.WelfareEvent(a.WelfareEvent.HIDE_Welfare_EVENT)),ModulePageManager.openPanel(SharedDef.MODULE_MALL,[2])},d.prototype.RewardClik=function(a){var b=a.target.data;if(b)if(2==b.state)NetManager.getInstance().protocolos.welfare_checkin_all(b.data.id);else{var c=tb.TB_item_template.get_TB_item_template(b.data.item[0][0]),d=new BagItemData;d.entryData=c;var e=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);e.data=d,e.buttonType=-1,ModuleEventManager.dispatchEvent(e)}},d}(UIVirtualContainer);a.WelfareEveryCheckin=b;var c=function(a){function b(){var b=a.call(this)||this;return b.left=217,b.top=79,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,d,686,295,98,128,2,1024,512,7,4,2)},b.prototype.compareAry=function(a){if(a.length!=this._everycheckinlist.length)return!0;for(var b=0;b<a.length;b++)if(a[b].state!=this._everycheckinlist[b].state)return!0;return!1},b.prototype.refreshDataByNewData=function(){var a=!0,b=GuidData.quest.getSigninEveryDayVoList();if(this._everycheckinlist&&(a=this.compareAry(b)),a){console.log("数据变化了"),this._everycheckinlist=b;var c=this.getData(this._everycheckinlist);this.refreshData(c)}for(var d=!1,e=0;e<b.length;e++)2==b[e].state&&(d=!0);d?this.showEffect(0,this.getIdxX(this.getscrollX())-25,this.getIdxY(this.getscrollnum())+71,1.1,.5):this.hideEffect(0)},b.prototype.effectComplte=function(){console.log("加载好了，回调"),this.refreshDataByNewData(),this.scrollIdx(this.getscrollnum())},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.setEffectUrl("ef_fl",4,4)},b.prototype.getscrollnum=function(){var a,b=GuidData.quest.getcurDays(),c=GuidData.quest.getSigninEveryDayList(),d=c[b-1];return a=d?0:Math.floor((b-1)/7)},b.prototype.getscrollX=function(){var a=GuidData.quest.getcurDays();return(a-1)%7},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.hideEffect()},b}(EffectSlist);a.WelfareEveryCheckinList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e);var f=this._customRenderAry[0],g=this._customRenderAry[1];this.I1bg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"I1bg",0,0,98,128,22,22),b.addChild(this.I1bg),this.I1icon=this.creatSUI(d,this.parentTarget.baseAtlas,"I1icon",0,0,83,81),b.addChild(this.I1icon),this.I1icon.addEventListener(InteractiveEvent.Up,this.equClick,this),this.I1btn=this.creatSUI(f,this.parentTarget.baseAtlas,"I1btn",8,87,81,34),b.addChild(this.I1btn),this.I1btn.addEventListener(InteractiveEvent.Up,this.btnClick,this),this.I1select=this.creatGrid9SUI(g,this.parentTarget.baseAtlas,"I1select",0,0,98,128,14,14),b.addChild(this.I1select)},b.prototype.drawIcon=function(){var a=this,b=this.itdata.data,c=tb.TB_item_template.get_TB_item_template(b.data.item[0][0]);IconManager.getInstance().getIcon(geteqiconIconUrl(c.icon),function(d){if(a.itdata&&a.itdata.data){var e=a._baseRender.uiAtlas.getRec(a.I1icon.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);if(UiDraw.cxtDrawImg(f,PuiData.PropBg60,new Rectangle(14,13,68,68),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(c.quality),new Rectangle(14,13,68,68),UIData.publicUi),f.drawImage(d,0,0,60,60,18,17,60,60),3==b.state&&(UIManager.getInstance().makeCtxToGray(f,new Rectangle(18,17,60,60)),UiDraw.cxtDrawImg(f,PuiData.A_gou,new Rectangle(42,41,38,38),UIData.publicUi)),b.data.vip>0){var g=a.parentTarget.baseAtlas.getRec("vip"+b.data.vip);f.drawImage(a.parentTarget.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,2,2,g.pixelWitdh,g.pixelHeight)}LabelTextFont.writeSingleLabelToCtxSetAnchor(f,String(b.data.item[0][1]),16,78,58,TextAlign.RIGHT,ColorType.Whitefff4d6,ColorType.colord27262e),a._baseRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)}})},b.prototype.drawBtn=function(){var a=this.itdata.data,b=this._baseRender.uiAtlas.getRec(this.I1btn.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1),d="第"+a.data.id+"天",e=ColorType.Brown7a2f21;if(4==a.state){var f=this.parentTarget.baseAtlas.getRec("I1bq");c.drawImage(this.parentTarget.baseAtlas.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,0,0,f.pixelWitdh,f.pixelHeight),d="补签",e=ColorType.Green464b11}else if(2==a.state){var g=this.parentTarget.baseAtlas.getRec("I1qd");c.drawImage(this.parentTarget.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,0,0,g.pixelWitdh,g.pixelHeight)}else 3==a.state&&(e=ColorType.colorb96d49);LabelTextFont.writeSingleLabelToCtxSetAnchor(c,e+d,16,39,6),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){console.log("--this.itdata.id---",this.itdata.id);var a=this.itdata.data;3==a.state?UiDraw.uiAtlasDrawImg(this.uiAtlas,this.I1bg.skinName,UIData.publicUi,PuiData.I1bg_2):UiDraw.uiAtlasDrawImg(this.uiAtlas,this.I1bg.skinName,UIData.publicUi,PuiData.I1bg_1),this.drawBtn(),this.drawIcon(),2==a.state&&UiDraw.uiAtlasDrawImg(this.uiAtlas,this.I1select.skinName,UIData.publicUi,PuiData.TITLEHIGHT)}},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},b.prototype.equClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){var b=this.itdata.data,c=tb.TB_item_template.get_TB_item_template(b.data.item[0][0]),d=new BagItemData;d.entryData=c;var e=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);e.data=d,e.buttonType=-1,ModuleEventManager.dispatchEvent(e)}},b.prototype.btnClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){var b=this.itdata.data;2==b.state?this.receiveReward():4==b.state&&(GuidData.player.getIsVIP()?this.receiveReward():AlertUtil.show("成为vip后，才可使用补签功能","补签提示",function(a){1==a&&ModulePageManager.openPanel(SharedDef.MODULE_MALL,[SharedDef.MODULE_MALL_RECHARGE])},2,["前往充值","取消"]))}},b.prototype.receiveReward=function(){var a=this.itdata.data;a.data.vip<=GuidData.player.getVipLevel()?2==a.state?NetManager.getInstance().protocolos.welfare_checkin():NetManager.getInstance().protocolos.welfare_checkin_getback(a.data.id):AlertUtil.show("成为vip"+a.data.vip+"后，可以领取"+a.data.times+"倍签到奖励","签到提示",function(b){1==b?2==a.state?NetManager.getInstance().protocolos.welfare_checkin():NetManager.getInstance().protocolos.welfare_checkin_getback(a.data.id):ModulePageManager.openPanel(SharedDef.MODULE_MALL,[SharedDef.MODULE_MALL_RECHARGE])},2,["直接签到","前往充值"])},b.prototype.setnull=function(){UiDraw.clearUI(this.I1icon),UiDraw.clearUI(this.I1bg),UiDraw.clearUI(this.I1btn),UiDraw.clearUI(this.I1select)},b}(SListItem);a.WelfareEveryCheckinListRender=d}(welfare||(welfare={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),welfare;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this.welfareEveryCheckin&&(this.welfareEveryCheckin.dispose(),this.welfareEveryCheckin=null),this.welfareLevel&&(this.welfareLevel.dispose(),this.welfareLevel=null),this.welfareRecharge&&(this.welfareRecharge.dispose(),this.welfareRecharge=null),this.welfareCost&&(this.welfareCost.dispose(),this.welfareCost=null),this.welfareSevenDay&&(this.welfareSevenDay.dispose(),this.welfareSevenDay=null),this.welfareTabList&&(this.welfareTabList.dispose(),this.welfareTabList=null),this.popVipPanel&&(this.popVipPanel.dispose(),this.popVipPanel=null),this.popBuqianPanel&&(this.popBuqianPanel.dispose(),this.popBuqianPanel=null),b.prototype.dispose.call(this)},d.prototype.applyLoad=function(){var a=this;this._publicbgRender.uiAtlas=WindowUi.winUIAtlas,this._baseRender.uiAtlas.setInfo("ui/uidata/welfare/newwelfare.xml","ui/uidata/welfare/newwelfare.png",function(){a.loadConfigCom()},"ui/uidata/welfare/welfarepc.png")},d.prototype.loadConfigCom=function(){var a=this._baseRender;this.slistIndex=this.addChild(a.getComponent("slistIndex")),this.addChild(a.getComponent("t_title"));var b=this.addChild(this._publicbgRender.getComponent("cnew_coffeeBg"));this.setSizeForPanelUiCopy(b,"a_coffeeBg",a),this._publicbgRender.applyObjData(),this.applyLoadComplete()},d.prototype.selecttype=function(b){b==SharedDef.MODULE_WELFARE_MONTH?(this.welfareEveryCheckin||(this.welfareEveryCheckin=new a.WelfareEveryCheckin,this.welfareEveryCheckin.parent=this,this.welfareEveryCheckin.initUiAtlas(this._baseRender.uiAtlas)),this.welfareEveryCheckin.show(),this.welfareLevel&&this.welfareLevel.hide(),this.welfareRecharge&&this.welfareRecharge.hide(),this.welfareCost&&this.welfareCost.hide(),this.welfareSevenDay&&this.welfareSevenDay.hide()):b==SharedDef.MODULE_WELFARE_LEVEL?(this.welfareLevel||(this.welfareLevel=new a.WelfareLevel,this.welfareLevel.initUiAtlas(this._baseRender.uiAtlas)),this.welfareLevel.show(),this.welfareEveryCheckin&&this.welfareEveryCheckin.hide(),this.welfareRecharge&&this.welfareRecharge.hide(),this.welfareCost&&this.welfareCost.hide(),this.welfareSevenDay&&this.welfareSevenDay.hide()):b==SharedDef.MODULE_WELFARE_SEVEN?(this.welfareSevenDay||(this.welfareSevenDay=new a.WelfareSevenDay,this.welfareSevenDay.initUiAtlas(this._baseRender.uiAtlas)),this.welfareSevenDay.show(),this.welfareEveryCheckin&&this.welfareEveryCheckin.hide(),this.welfareLevel&&this.welfareLevel.hide(),this.welfareRecharge&&this.welfareRecharge.hide(),this.welfareCost&&this.welfareCost.hide()):b==SharedDef.MODULE_WELFARE_RECHARGE?(this.welfareRecharge||(this.welfareRecharge=new a.WelfareRecharge,this.welfareRecharge.initUiAtlas(this._baseRender.uiAtlas)),this.welfareRecharge.show(),this.welfareEveryCheckin&&this.welfareEveryCheckin.hide(),this.welfareLevel&&this.welfareLevel.hide(),this.welfareCost&&this.welfareCost.hide(),this.welfareSevenDay&&this.welfareSevenDay.hide()):b==SharedDef.MODULE_WELFARE_CONSUME&&(this.welfareCost||(this.welfareCost=new a.WelfareCost,this.welfareCost.initUiAtlas(this._baseRender.uiAtlas)),this.welfareCost.show(),this.welfareRecharge&&this.welfareRecharge.hide(),this.welfareEveryCheckin&&this.welfareEveryCheckin.hide(),this.welfareLevel&&this.welfareLevel.hide(),this.welfareSevenDay&&this.welfareSevenDay.hide())},d.prototype.show=function(a){a||(a=0),this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.welfareTabList||(this.welfareTabList=new c,this.welfareTabList.init(this._baseRender.uiAtlas)),this.welfareTabList.show(a),this.resize()},d.prototype.showVipPop=function(){this.popVipPanel||(this.popVipPanel=new a.PopVipPanel,this.popVipPanel.initUiAtlas(this._baseRender.uiAtlas,this._publicbgRender.uiAtlas)),this.popVipPanel.show(),this.resize()},d.prototype.showBuqianPop=function(b){this.popBuqianPanel||(this.popBuqianPanel=new a.PopBuqianPanel,this.popBuqianPanel.initUiAtlas(this._baseRender.uiAtlas,this._publicbgRender.uiAtlas)),this.popBuqianPanel.show(b),this.resize()},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.welfareTabList&&this.welfareTabList.hide(),this.welfareEveryCheckin&&this.welfareEveryCheckin.hide(),this.welfareLevel&&this.welfareLevel.hide(),this.welfareRecharge&&this.welfareRecharge.hide(),this.welfareSevenDay&&this.welfareSevenDay.hide(),this.welfareCost&&this.welfareCost.hide(),ModulePageManager.hideResTittle()},d.prototype.resize=function(){b.prototype.resize.call(this),this.welfareTabList&&(this.welfareTabList.left=this.slistIndex.parent.x/UIData.Scale+this.slistIndex.x,this.welfareTabList.top=this.slistIndex.parent.y/UIData.Scale+this.slistIndex.y)},d.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.WelfareEvent(a.WelfareEvent.HIDE_Welfare_EVENT))}},d}(WindowUi);a.WelfareUiPanel=b;
var c=function(a){function b(){var b=a.call(this)||this;return b.left=52,b.top=88,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,d,153,420,0,50,8,256,512,1,10)},b.prototype.refreshDataByNewData=function(){var a=this.getData();this.refreshData(a)},b.prototype.getData=function(){for(var a=new Array,b=RedPointManager.getInstance().getNodeByID(113).children,c=0;5>c;c++){var d=new SListItemData;d.data=b[c],d.id=c,a.push(d)}return a},b.prototype.show=function(a){this._type=a,this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},b.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData(),this.setSelectIndex(this._type)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.WelfareTabList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Tab=this.creatSUI(c,this.parentTarget.baseAtlas,"Tab",0,0,153,50),a.addChild(this.Tab),this.RedPoint=this.creatSUI(d,this.parentTarget.baseAtlas,"RedPoint",136,0,17,16),this.RedPoint.preParent=a,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.RedPoint.skinName,UIData.publicUi,PuiData.A_RED_POINT)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.applyrender(),b){var c=new a.WelfareEvent(a.WelfareEvent.SELECTTAB_Welfare_EVENT);c.data=this.itdata.id+1,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.drawTab=function(){var a,b=this._baseRender.uiAtlas.getRec(this.Tab.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);a=this.selected?this.parentTarget.baseAtlas.getRec("T"+this.itdata.id+"_1"):this.parentTarget.baseAtlas.getRec("T"+this.itdata.id+"_0"),c.drawImage(this.parentTarget.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.applyrender=function(){this.itdata&&(this.itdata.data&&this.itdata.data.bindUI(this.RedPoint),this.drawTab())},c.prototype.render=function(a){this.itdata=a,a?(this.applyrender(),this.Tab.addEventListener(InteractiveEvent.Down,this.equClick,this)):(this.Tab.removeEventListener(InteractiveEvent.Down,this.equClick,this),this.setnull())},c.prototype.equClick=function(){this.setSelect()},c.prototype.setnull=function(){UiDraw.clearUI(this.Tab),this.RedPoint.preHide()},c}(SListItem);a.WelfareTabRender=d}(welfare||(welfare={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),welfare;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"WelfareModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.WelfareModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_Welfare_EVENT="SHOW_Welfare_EVENT",b.HIDE_Welfare_EVENT="HIDE_Welfare_EVENT",b.SELECTTAB_Welfare_EVENT="SELECTTAB_Welfare_EVENT",b.REFRESHTAB_Welfare_EVENT="REFRESHTAB_Welfare_EVENT",b.ALLCHECKIN_Welfare_EVENT="ALLCHECKIN_Welfare_EVENT",b.EveryDayCHECKIN_Welfare_EVENT="EveryDayCHECKIN_Welfare_EVENT",b.RECEIVELEVELREWARD_Welfare_EVENT="RECEIVELEVELREWARD_Welfare_EVENT",b.RECEIVECOSTREWARD_Welfare_EVENT="RECEIVECOSTREWARD_Welfare_EVENT",b.RECEIVERECHARGEREWARD_Welfare_EVENT="RECEIVERECHARGEREWARD_Welfare_EVENT",b.RECEIVESEVENDAYREWARD_Welfare_EVENT="RECEIVESEVENDAYREWARD_Welfare_EVENT",b.GETBACKREWARD_Welfare_EVENT="GETBACKREWARD_Welfare_EVENT",b.OPPENWIN_Welfare_EVENT="OPPENWIN_Welfare_EVENT",b.OPPENWIN_Vip_Welfare_EVENT="OPPENWIN_Vip_Welfare_EVENT",b.OPPENWIN_Qiandao_Welfare_EVENT="OPPENWIN_Qiandao_Welfare_EVENT",b.CHG_REDPOINT="CHG_REDPOINT",b}(BaseEvent);a.WelfareEvent=c;var d=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a._nodeInit=!1,a}return __extends(d,b),d.prototype.getName=function(){return"WelfareProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_Welfare_EVENT?this.showUi(b.data):b.type==c.HIDE_Welfare_EVENT?this.hideUi():b.type==c.SELECTTAB_Welfare_EVENT?this.selecttabpanel(b.data):b.type==c.REFRESHTAB_Welfare_EVENT?this.refreshTab():b.type==c.ALLCHECKIN_Welfare_EVENT?this.allcheckinchange():b.type==c.EveryDayCHECKIN_Welfare_EVENT?this.everydaycheckinchange():b.type==c.RECEIVECOSTREWARD_Welfare_EVENT?this.receivecousumereward():b.type==c.RECEIVERECHARGEREWARD_Welfare_EVENT?this.receiverechargereward():b.type==c.RECEIVESEVENDAYREWARD_Welfare_EVENT?this.receivesevendayreward():b.type==c.RECEIVELEVELREWARD_Welfare_EVENT?this.receivelevelreward():b.type==c.GETBACKREWARD_Welfare_EVENT?this.getbackrewardreward():b.type==c.OPPENWIN_Welfare_EVENT?this.openwinevent(b.data):b.type==c.OPPENWIN_Vip_Welfare_EVENT?this.openwinvipevent():b.type==c.OPPENWIN_Qiandao_Welfare_EVENT?this.openwinqiandaoevent(b.data):b.type==c.CHG_REDPOINT&&this.processRedPoint()}else a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT&&this.initRedNode();if(a instanceof UIPanelEvent){var d=a;if(d.panel==this._welfareUiPanel){for(var e=RedPointManager.getInstance().getNodeByID(113).children,f=0;f<e.length;f++)e[f].unBind();this._welfareUiPanel.dispose(),this._welfareUiPanel=null,console.log("释放面板 _welfareUiPanel")}}},d.prototype.initRedNode=function(){if(!this._nodeInit){for(var a=RedPointManager.getInstance().getNodeByID(113),b=0;5>b;b++){var c=new RedPointNode;a.addChild(c)}this._nodeInit=!0,this.processRedPoint()}},d.prototype.processRedPoint=function(){if(this._nodeInit)for(var a=RedPointManager.getInstance().getNodeByID(113).children,b=0;b<a.length;b++)if(a[b].show=!1,GuidData.player.getsyspageopen(SharedDef.MODULE_WELFARE,b+1))switch(b+1){case SharedDef.MODULE_WELFARE_MONTH:for(var c=GuidData.quest.getSigninEveryDayVoList(),d=0;d<c.length;d++)2==c[d].state&&(a[b].show=!0,d=c.length);for(var e=GuidData.quest.getSigninWeekList(),f=0;f<e.length;f++)2==e[f].state&&(a[b].show=!0,f=e.length);break;case SharedDef.MODULE_WELFARE_LEVEL:for(var g=GuidData.quest.getLevelUpRewardList(),h=0;h<g.length;h++)1==g[h].state&&(a[b].show=!0,h=g.length);break;case SharedDef.MODULE_WELFARE_SEVEN:for(var i=GuidData.quest.getSevenDayList(),j=0;j<i.length;j++)1==i[j].state&&(a[b].show=!0,j=i.length);break;case SharedDef.MODULE_WELFARE_RECHARGE:for(var k=GuidData.quest.getRechargeRewardList(),l=0;l<k.length;l++)1==k[l].state&&(a[b].show=!0,l=k.length);break;case SharedDef.MODULE_WELFARE_CONSUME:for(var m=GuidData.quest.getCostRewardList(),n=0;n<m.length;n++)1==m[n].state&&(a[b].show=!0,n=m.length)}},d.prototype.openwinvipevent=function(){this._welfareUiPanel&&this._welfareUiPanel.hasStage&&this._welfareUiPanel.showVipPop()},d.prototype.openwinqiandaoevent=function(a){this._welfareUiPanel&&this._welfareUiPanel.hasStage&&this._welfareUiPanel.showBuqianPop(a)},d.prototype.openwinevent=function(a){},d.prototype.getbackrewardreward=function(){},d.prototype.receivelevelreward=function(){this._welfareUiPanel&&this._welfareUiPanel.welfareLevel&&this._welfareUiPanel.welfareLevel.hasStage&&(this._welfareUiPanel.welfareLevel.resetData(),this._welfareUiPanel.welfareTabList.refreshDataByNewData())},d.prototype.receiverechargereward=function(){this._welfareUiPanel&&this._welfareUiPanel.welfareRecharge&&this._welfareUiPanel.welfareRecharge.hasStage&&(this._welfareUiPanel.welfareRecharge.resetData(),this._welfareUiPanel.welfareTabList.refreshDataByNewData())},d.prototype.receivecousumereward=function(){this._welfareUiPanel&&this._welfareUiPanel.welfareCost&&this._welfareUiPanel.welfareCost.hasStage&&(this._welfareUiPanel.welfareCost.resetData(),this._welfareUiPanel.welfareTabList.refreshDataByNewData())},d.prototype.receivesevendayreward=function(){this._welfareUiPanel&&this._welfareUiPanel.welfareSevenDay&&this._welfareUiPanel.welfareSevenDay.hasStage&&(this._welfareUiPanel.welfareSevenDay.resetData(),this._welfareUiPanel.welfareTabList.refreshDataByNewData())},d.prototype.everydaycheckinchange=function(){this._welfareUiPanel&&this._welfareUiPanel.welfareEveryCheckin&&this._welfareUiPanel.welfareEveryCheckin.hasStage&&(this._welfareUiPanel.welfareEveryCheckin.resetData(),this._welfareUiPanel.welfareTabList.refreshDataByNewData())},d.prototype.allcheckinchange=function(){this._welfareUiPanel&&this._welfareUiPanel.welfareEveryCheckin&&this._welfareUiPanel.welfareEveryCheckin.hasStage&&(this._welfareUiPanel.welfareEveryCheckin.resetData(),this._welfareUiPanel.welfareTabList.refreshDataByNewData())},d.prototype.refreshTab=function(){this._welfareUiPanel&&this._welfareUiPanel.welfareTabList&&this._welfareUiPanel.welfareTabList.hasStage&&this._welfareUiPanel.welfareTabList.refreshAndselectIndex()},d.prototype.selecttabpanel=function(a){this._welfareUiPanel&&this._welfareUiPanel.hasStage&&this._welfareUiPanel.selecttype(a)},d.prototype.hideUi=function(){this._welfareUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(b){var c=this;this._welfareUiPanel||(this._welfareUiPanel=new a.WelfareUiPanel),this._welfareUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),c._welfareUiPanel.show(b)})},d.prototype.getbackResultList=function(a){var b=a.readUTF(),c=a.readUTF(),d=c.split(","),f=new e;f.items=b.split(","),f.cost=Number(d[1]),f.costtype=Number(d[0])},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_WELFARE_REWARDLIST_GETBACK]=function(b){a.getbackResultList(b)},b},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_Welfare_EVENT),new c(c.HIDE_Welfare_EVENT),new c(c.SELECTTAB_Welfare_EVENT),new c(c.REFRESHTAB_Welfare_EVENT),new c(c.ALLCHECKIN_Welfare_EVENT),new c(c.EveryDayCHECKIN_Welfare_EVENT),new c(c.RECEIVELEVELREWARD_Welfare_EVENT),new c(c.RECEIVECOSTREWARD_Welfare_EVENT),new c(c.RECEIVERECHARGEREWARD_Welfare_EVENT),new c(c.RECEIVESEVENDAYREWARD_Welfare_EVENT),new c(c.GETBACKREWARD_Welfare_EVENT),new c(c.OPPENWIN_Welfare_EVENT),new c(c.OPPENWIN_Vip_Welfare_EVENT),new c(c.OPPENWIN_Qiandao_Welfare_EVENT),new c(c.CHG_REDPOINT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new EngineEvent(EngineEvent.MONEY_TYPE_GOLD_INGOT),new EngineEvent(EngineEvent.MONEY_TYPE_SILVER),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.WelfareProcessor=d;var e=function(){function a(){}return a}();a.rewardList_getback=e}(welfare||(welfare={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),stronger;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.left=237,a.top=157,a}return __extends(d,b),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,c,671,352,0,89,3,512,1024,1,6)},d.prototype.refreshDataByNewData=function(){var a=this.getData(this._ary);this.refreshData(a)},d.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},d.prototype.show=function(b){this.hasStage||UIManager.getInstance().addUIContainer(this),this._ary=a.StrongerModel.getInstance().getList(b),b==a.StrongerUitl.STRONGER_UP?this._ary.sort(function(a,b){return a.state==b.state?a.data.id-b.data.id:b.state-a.state}):this._ary.sort(function(a,b){return b.data.priority-a.data.priority}),this.refreshDataByNewData()},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.StrongerList=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Icon=this.creatSUI(d,this.parentTarget.baseAtlas,"Icon",18,9,68,68),a.addChild(this.Icon),this.Name=this.creatSUI(d,this.parentTarget.baseAtlas,"Name",106,18,82,19),a.addChild(this.Name),this.Info=this.creatSUI(d,this.parentTarget.baseAtlas,"Info",192,20,190,17),a.addChild(this.Info),this.State=this.creatSUI(d,this.parentTarget.baseAtlas,"State",467,31,72,25),a.addChild(this.State),this.Progress=this.creatSUI(d,this.parentTarget.baseAtlas,"Progress",110,49,333,22),a.addChild(this.Progress),this.Btn=this.creatSUI(d,this.parentTarget.baseAtlas,"Btn",552,20,103,45),a.addChild(this.Btn),this.Btn.addEventListener(InteractiveEvent.Up,this.btnChick,this),this.Itembg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"Itembg",0,0,671,86,10,10),a.addChild(this.Itembg)},c.prototype.drawIcon=function(){var a=this,b=this.itdata.data;IconManager.getInstance().getIcon(getstrongerIconUrl(String(b.data.icon)),function(b){var c=a._baseRender.uiAtlas.getRec(a.Icon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(b,0,0,60,60,4,4,60,60),a._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},c.prototype.drawProgress=function(){var b=this.itdata.data,c=this._baseRender.uiAtlas.getRec(this.Progress.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);if(b.data.parent_id==a.StrongerUitl.STRONGER_UP){var e=this.parentTarget.baseAtlas.getRec("progressbg");d.drawImage(this.parentTarget.baseAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,5,e.pixelWitdh,e.pixelHeight);var f=b.curzhanli/b.zhanli,g=this.parentTarget.baseAtlas.getRec("progressup");d.drawImage(this.parentTarget.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh*f,g.pixelHeight,5,5,g.pixelWitdh*f,g.pixelHeight)}else for(var h=this.parentTarget.baseAtlas.getRec("start"),i=0;i<b.data.priority;i++)d.drawImage(this.parentTarget.baseAtlas.useImg,h.pixelX,h.pixelY,h.pixelWitdh,h.pixelHeight,i*h.pixelWitdh,0,h.pixelWitdh,h.pixelHeight);this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var b=this.itdata.data;this.drawProgress(),this.drawIcon(),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Name.skinName,b.data.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this.Info.skinName,b.data.info,14,TextAlign.LEFT,ColorType.color9a683f),b.data.parent_id==a.StrongerUitl.STRONGER_UP?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.State.skinName,"State"+b.state):LabelTextFont.clearLabel(this.uiAtlas,this.State.skinName),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.Btn.skinName,"Btn"),this.itdata.id%2||UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Itembg.skinName,UIData.publicUi,PuiData.NEWLISTITEMBG)}},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.btnChick=function(b){if(UIManager.getInstance().disMoveNnum(new Vector2D(b.x,b.y),10)&&(console.log("--dianji--"),this.itdata&&this.itdata.data)){var c=this.itdata.data;ModuleEventManager.dispatchEvent(new a.StrongerEvent(a.StrongerEvent.HIDE_Stronger_EVENT)),ModulePageManager.openPanel(c.data["goto"],c.data.goto_sub)}},c.prototype.setnull=function(){LabelTextFont.clearLabel(this.uiAtlas,this.Icon.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Name.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.State.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Info.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Progress.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Btn.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Itembg.skinName)},c}(SListItem);a.StrongerListRender=c}(stronger||(stronger={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),stronger;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.left=56,b.top=164,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,c,152,340,0,50,7,256,512,1,8)},b.prototype.refreshDataByNewData=function(){var a=this.getData();this.refreshData(a)},b.prototype.getData=function(){for(var a=new Array,b=0;5>b;b++){var c=new SListItemData;c.id=b,a.push(c)}return a},b.prototype.show=function(a){this._type=a,this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshAndselectIndex()},b.prototype.refreshAndselectIndex=function(){this.refreshDataByNewData(),this.setSelectIndex(this._type)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.StrongerTabList=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Tab=this.creatSUI(d,this.parentTarget.baseAtlas,"Tab",0,0,152,48),a.addChild(this.Tab)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.applyrender(),b){var c=new a.StrongerEvent(a.StrongerEvent.SELECTTAB_Stronger_EVENT);c.data=this.itdata.id+1,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.drawTab=function(){var a,b=this._baseRender.uiAtlas.getRec(this.Tab.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);a=this.selected?this.parentTarget.baseAtlas.getRec("T"+this.itdata.id+"_1"):this.parentTarget.baseAtlas.getRec("T"+this.itdata.id+"_0"),c.drawImage(this.parentTarget.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.applyrender=function(){this.itdata&&this.drawTab()},c.prototype.render=function(a){this.itdata=a,a?(this.applyrender(),this.Tab.addEventListener(InteractiveEvent.Down,this.equClick,this)):(this.Tab.removeEventListener(InteractiveEvent.Down,this.equClick,this),this.setnull())},c.prototype.equClick=function(){this.setSelect()},c.prototype.setnull=function(){LabelTextFont.clearLabel(this.uiAtlas,this.Tab.skinName)},c}(SListItem);a.StrongerTabRender=c}(stronger||(stronger={}));var stronger;!function(a){var b=function(){function a(){}return a.getGrade=function(a,b){for(var c,d=tb.TB_bianqiang_rank.get_TB_bianqiang_rank(),e=a/b*100,f=0;f<d.length;f++)e>=d[f].percent&&(c=f);return c},a.STRONGER_UP=1,a.STRONGER_LEV=2,a.STRONGER_EQUIP=3,a.STRONGER_MOUNT=4,a.STRONGER_WINGS=5,a}();a.StrongerUitl=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getList=function(a){for(var c=new Array,e=tb.TB_bianqiang_sub.get_TB_bianqiang_sub(),f=0;f<e.length;f++)if(a==e[f].parent_id&&GuidData.player.getLevel()>=e[f].limitlev){var g=new d;if(g.data=e[f],a==b.STRONGER_UP){var h=this.getzhanli(e[f].value_type);if(-1==h)alert("战力出错");else{g.zhanli=h;var i=this.getCurrentZhanli(e[f].value_type);g.curzhanli=i,g.state=b.getGrade(i,h)}}c.push(g)}return console.log("--$finalary--",c),c},a.prototype.getzhanli=function(a){for(var b=tb.TB_bianqiang_value.get_TB_bianqiang_valueById(GuidData.player.getLevel()),c=0;c<b.value_devide.length;c++)if(b.value_devide[c][0]==a)return b.value_devide[c][1];return-1},a.prototype.getCurrentZhanli=function(a){var b=0;switch(a){case 1:b=GuidData.player.getDivineForce();break;case 2:b=GuidData.player.getSkillForce();break;case 3:for(var c=0;10>c;c++)console.log("--强化--",GuidData.grow.getStrengLev(c+1)),b+=GuidData.grow.getStrengLev(c+1);break;case 4:for(var c=0;10>c;c++)console.log("--宝石--",GuidData.grow.getGemLev(c+1,0),GuidData.grow.getGemLev(c+1,1),GuidData.grow.getGemLev(c+1,2)),b+=Math.min(GuidData.grow.getGemLev(c+1,0),GuidData.grow.getGemLev(c+1,1),GuidData.grow.getGemLev(c+1,2));break;case 5:b=GuidData.player.getMountForce()}return b},a}();a.StrongerModel=c;var d=function(){function a(){}return a}();a.StrongerItemVo=d}(stronger||(stronger={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),stronger;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.strongerTabList&&(this.strongerTabList.dispose(),this.strongerTabList=null),this.strongerList&&(this.strongerList.dispose(),this.strongerList=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a._publicbgRender.uiAtlas=b,a._baseRender.uiAtlas.setInfo("ui/uidata/stronger/stronger.xml","ui/uidata/stronger/stronger.png",function(){a.loadConfigCom()},"ui/uidata/stronger/strongerpc.png")})},c.prototype.loadConfigCom=function(){this._topRender.uiAtlas=this._baseRender.uiAtlas;var a=this._baseRender;this.listindex0=this.addChild(a.getComponent("listindex0")),this.listindex1=this.addChild(a.getComponent("listindex1")),this.addUIList(["a_4","a_3","a_2"],this._topRender),this.addUIList(["a_bg0","a_bg1","line_s","line1","a_title"],this._baseRender),this.curlev=this.addChild(this._topRender.getComponent("a_7")),this.curzhanli=this.addChild(this._topRender.getComponent("a_5")),this.goodzhanli=this.addChild(this._topRender.getComponent("a_6")),this.a_zhanli_numAry=new Array;for(var b=0;5>b;b++)this.a_zhanli_numAry.push(this.addChild(this._topRender.getComponent("a_zhanli_num"+b)));var c=this.addChild(this._publicbgRender.getComponent("cnew_coffeeBg"));this.setSizeForPanelUiCopy(c,"c_coffeeBg",a),this._publicbgRender.applyObjData(),this.applyLoadComplete()},c.prototype.show=function(b){void 0===b&&(b=0),b||(b=0),this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.strongerTabList||(this.strongerTabList=new a.StrongerTabList,this.strongerTabList.init(this._baseRender.uiAtlas)),this.strongerTabList.show(b),this.fresh(),this.resize()},c.prototype.fresh=function(){var b=GuidData.player.getLevel();LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.curlev.skinName,String(b),16,TextAlign.RIGHT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.curzhanli.skinName,Snum(GuidData.player.getForce()),16,TextAlign.LEFT,ColorType.Brown7a2f21);var c=tb.TB_bianqiang_value.get_TB_bianqiang_valueById(b);LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.goodzhanli.skinName,Snum(c.value),16,TextAlign.LEFT,ColorType.Brown7a2f21);for(var d=a.StrongerUitl.getGrade(Math.floor(GuidData.player.getForce()),c.value),e=0;5>e;e++){var f=d>=e?0:1;this.a_zhanli_numAry[e].goToAndStop(f)}},c.prototype.showStrongerList=function(b){this.strongerList||(this.strongerList=new a.StrongerList,this.strongerList.init(this._baseRender.uiAtlas)),this.strongerList.show(b)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.strongerTabList&&this.strongerTabList.hide(),this.strongerList&&this.strongerList.hide(),ModulePageManager.hideResTittle()},c.prototype.resize=function(){b.prototype.resize.call(this),this.strongerTabList&&(this.strongerTabList.left=this.listindex0.parent.x/UIData.Scale+this.listindex0.x,this.strongerTabList.top=this.listindex0.parent.y/UIData.Scale+this.listindex0.y),this.strongerList&&(this.strongerList.left=this.listindex1.parent.x/UIData.Scale+this.listindex1.x,this.strongerList.top=this.listindex1.parent.y/UIData.Scale+this.listindex1.y)},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.StrongerEvent(a.StrongerEvent.HIDE_Stronger_EVENT))}},c}(WindowUi);a.StrongerUiPanel=b}(stronger||(stronger={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),stronger;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"StrongerModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.StrongerModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_Stronger_EVENT="SHOW_Stronger_EVENT",b.HIDE_Stronger_EVENT="HIDE_Stronger_EVENT",b.SELECTTAB_Stronger_EVENT="SELECTTAB_Stronger_EVENT",b}(BaseEvent);a.StrongerEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"WelfareProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_Stronger_EVENT?this.showUi(b.data):b.type==c.HIDE_Stronger_EVENT?this.hideUi():b.type==c.SELECTTAB_Stronger_EVENT&&this.selecttabpanel(b.data)}if(a instanceof EngineEvent){var d=a;d.type==EngineEvent.PLAYER_FIELD_LEVEL&&this.receivelevelreward()}if(a instanceof UIPanelEvent){var e=a;e.panel==this._strongerUiPanel&&(this._strongerUiPanel.dispose(),this._strongerUiPanel=null,console.log("释放面板 _strongerUiPanel"))}},d.prototype.receivelevelreward=function(){},d.prototype.selecttabpanel=function(a){this._strongerUiPanel&&this._strongerUiPanel.hasStage&&this._strongerUiPanel.showStrongerList(a)},d.prototype.hideUi=function(){this._strongerUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(b){var c=this;this._strongerUiPanel||(this._strongerUiPanel=new a.StrongerUiPanel),this._strongerUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),c._strongerUiPanel.show(b)})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_Stronger_EVENT),new c(c.HIDE_Stronger_EVENT),new c(c.SELECTTAB_Stronger_EVENT),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.StrongerProcessor=d}(stronger||(stronger={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),StateupPopPanel=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.middle=0,b.center=0,b._basebgRender=new UIRenderComponent,b.addRender(b._basebgRender),b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/stateup/stateuppop.xml","ui/uidata/stateup/stateuppop.png",function(){a.loadConfigCom()},"ui/uidata/stateup/stateuppc.png")},b.prototype.loadConfigCom=function(){this._basebgRender.uiAtlas=this._baseUiAtlas,this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this._topRender.uiAtlas=this._baseUiAtlas;var a=this.addChild(this._bgRender.getComponent("a_bg0")),b=this.addChild(this._bgRender.getComponent("a_bg1"));b.isU=!0,a.addEventListener(InteractiveEvent.Down,function(){},this),a.addEventListener(InteractiveEvent.Up,function(){},this),b.addEventListener(InteractiveEvent.Down,function(){},this),b.addEventListener(InteractiveEvent.Up,function(){},this),this._bgRender.applyObjData(),this.aryui=new Array,this.aryui.push(this._baseRender.getComponent("a_txtbg1")),this.aryui.push(this._topRender.getComponent("a_txt1")),this.addUIList(["a_txtbg0","a_title"],this._baseRender),this.a_icon=this.addChild(this._topRender.getComponent("a_icon")),this.a_name=this.addChild(this._topRender.getComponent("a_name")),this.a_txt0=this.addChild(this._topRender.getComponent("a_txt0")),this.c_basebg=this.addEvntButUp("a_basebg",this._basebgRender),this.c_basebg.addEventListener(InteractiveEvent.Down,function(){},this),this.resize(),this.applyLoadComplete()},b.prototype.resize=function(){this.c_basebg.top=0,this.c_basebg.left=0,this.c_basebg.y=0,this.c_basebg.x=0,this.c_basebg.height=Scene_data.stageHeight/UIData.Scale,this.c_basebg.width=Scene_data.stageWidth/UIData.Scale,a.prototype.resize.call(this)},b.prototype.butClik=function(a){a.target==this.c_basebg&&this.hide()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.aaa()},b.prototype.aaa=function(){var a=TableData.getInstance().getData(TableData.tb_realmbreak_base,GuidData.player.getStateLev());if(a.level>GuidData.player.getLevel()){var b=Number(a.level)-GuidData.player.getLevel();this.bbb(b,a)}else this.bbb(0,a)},b.prototype.bbb=function(a,b){this.setUiListVisibleByItem(this.aryui,a>0),a>0?(LabelTextFont.writeSingleLabel(this._basebgRender.uiAtlas,this.aryui[1].skinName,ColorType.Brown541616+"再升"+ColorType.Redff0000+a+ColorType.Brown541616+"级,战力暴涨"+ColorType.Redff0000+b.force+"!!!",16,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._basebgRender.uiAtlas,this.a_txt0.skinName,ColorType.Brown541616+"境界领先等级！请尽快提升等级",16,TextAlign.CENTER)):LabelTextFont.writeSingleLabel(this._basebgRender.uiAtlas,this.a_txt0.skinName,ColorType.Brown541616+"成功突破"+b.name+",战力暴涨"+b.force+"!!!",16,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._basebgRender.uiAtlas,this.a_name.skinName,ColorType.Whiteffeec9+b.name,16,TextAlign.CENTER),this.drawPic(this.a_icon,b.id)},b.prototype.drawPic=function(a,b){IconManager.getInstance().getIcon(getStateUpIconUrl(b),function(b){var c=a.uiRender.uiAtlas.getRec(a.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(b,0,0,c.pixelWitdh,c.pixelHeight),TextureManager.getInstance().updateTexture(a.uiRender.uiAtlas.texture,c.pixelX,c.pixelY,d)})},b}(UIPanel),stateup;!function(a){var b=function(){function a(){}return a}();a.TaskCell=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),
this._instance},a.prototype.getTaskAry=function(){return this._taskAry||this.refreshTaskAry(),this._taskAry},a.prototype.setTaskAry=function(){for(var a=new Array,c=GuidData.quest.getStateUpTaskList(),d=0;d<c.length;d++){var e=new b;e.qusdata=c[d],e.tb_quest=tb.TB_quest.getTbById(e.qusdata.id),a.push(e)}return a},a.prototype.refreshTaskAry=function(){this._taskAry=this.setTaskAry()},a.prototype.getRecommend=function(){var a,b=TableData.getInstance().getTableByName(TableData.tb_realmbreak_base);console.log("基本数据",b);for(var c in b.data)a=c;for(var d=Number(a);d>=0;d--)if(b.data[String(d)].level<=GuidData.player.getLevel())return b.data[String(d)];return null},a}();a.StateUpModel=c}(stateup||(stateup={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),stateup;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"StateUpModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.StateUpModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_STATEUP_PANEL="SHOW_STATEUP_PANEL",b.HIDE_STATEUP_PANEL="HIDE_STATEUP_PANEL",b.REFRESH_LIST_PANEL="REFRESH_LIST_PANEL",b.REFRESH_TASK_PANEL="REFRESH_TASK_PANEL",b.REFRESH_LEV_PANEL="REFRESH_LEV_PANEL",b.REFRESH_EXP_PANEL="REFRESH_EXP_PANEL",b.SHOW_EFFECT_PANEL="SHOW_EFFECT_PANEL",b.CLICK_EVT="CLICK_EVT",b.POP_SHOW_PANEL="POP_SHOW_PANEL",b}(BaseEvent);a.StateUpEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"StateUpProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_STATEUP_PANEL&&this.showPanel(b.data),b.type==c.HIDE_STATEUP_PANEL&&this.hidePanel(),b.type==c.REFRESH_LIST_PANEL&&(this.refreshNode(),this.refreshlist()),b.type==c.REFRESH_TASK_PANEL&&this.refreshtask(),b.type==c.REFRESH_LEV_PANEL&&this.refreshlev(),b.type==c.REFRESH_EXP_PANEL&&this.refreshExp(),b.type==c.SHOW_EFFECT_PANEL&&this.showeff(b.data),b.type==c.CLICK_EVT&&this.stateUpUiPanel&&this.stateUpUiPanel.setpoint(b.data),b.type==c.POP_SHOW_PANEL&&this.popshow()}if(a instanceof EngineEvent){var d=a;d.type==EngineEvent.MONEY_CHANGE||(d.type==EngineEvent.PLAYER_FIELD_LEVEL?this.stateUpUiPanel&&this.stateUpUiPanel.hasStage&&this.stateUpUiPanel.drawPersonLev():d.type==EngineEvent.CORE_DATA_COMPLETE_EVENT?this.refreshNode():d.type==EngineEvent.SYSTEM_OPEN_EVENT&&(this.refreshNode(),this.stateUpUiPanel&&this.stateUpUiPanel.hasStage&&this.stateUpUiPanel.opensystem()))}if(a instanceof UIPanelEvent){var e=a;e.panel==this.stateUpUiPanel&&(this.stateUpUiPanel.dispose(),this.stateUpUiPanel=null,console.log("释放面板 trainingUiPanel"))}},d.prototype.refreshNode=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_REALM,SharedDef.MODULE_REALM_ALL)){var b=a.StateUpModel.getInstance().getTaskAry(),c=RedPointManager.getInstance().getNodeByID(124);c.show=!1;for(var d=0;d<b.length;d++)if(b[d].qusdata.taskState==SharedDef.QUEST_STATUS_COMPLETE){c.show=!0;break}}},d.prototype.showeff=function(a){this.stateUpUiPanel&&this.stateUpUiPanel.hasStage&&(this.stateUpUiPanel.showBezierEff(a.num),this.stateUpUiPanel.showExpEff())},d.prototype.refreshExp=function(){this.stateUpUiPanel&&this.stateUpUiPanel.hasStage&&this.stateUpUiPanel.chgExp()},d.prototype.refreshlev=function(){this.stateUpUiPanel&&this.stateUpUiPanel.hasStage&&this.stateUpUiPanel.chgLev()},d.prototype.refreshtask=function(){this.stateUpUiPanel&&this.stateUpUiPanel.hasStage&&this.stateUpUiPanel.refreshState()},d.prototype.refreshlist=function(){this.stateUpUiPanel&&this.stateUpUiPanel.achievementList&&this.stateUpUiPanel.achievementList.hasStage&&this.stateUpUiPanel.achievementList.refreshDraw()},d.prototype.hidePanel=function(){this.stateUpUiPanel&&this.stateUpUiPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.stateUpUiPanel||(this.stateUpUiPanel=new a.StateUpUiPanel),this.stateUpUiPanel.load(function(){console.log("--$data---",b),b?b instanceof Array&&(b=b[0]):b=SharedDef.MODULE_REALM_ALL,c.stateUpUiPanel.show(b);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_WORLD_RISK,ModuleEventManager.dispatchEvent(a)},!1)},d.prototype.popshow=function(){var a=this;this.stateupPopPanel||(this.stateupPopPanel=new StateupPopPanel),this.stateupPopPanel.load(function(){a.stateupPopPanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_STATEUP_PANEL),new c(c.HIDE_STATEUP_PANEL),new c(c.REFRESH_LIST_PANEL),new c(c.REFRESH_TASK_PANEL),new c(c.REFRESH_LEV_PANEL),new c(c.REFRESH_EXP_PANEL),new c(c.SHOW_EFFECT_PANEL),new c(c.CLICK_EVT),new c(c.POP_SHOW_PANEL),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.StateUpProcessor=d}(stateup||(stateup={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),stateup;!function(a){var b=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.creatBaseComponent=function(a){var b=new c;b.skinName=a;var d=this.uiAtlas.getRec(a);return b.tr.setRec(d),b.width=d.pixelWitdh,b.height=d.pixelHeight,b.uiRender=this,b},b}(UIRenderComponent);a.stateupUIRenderComponent=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.applyRenderSize=function(){if(this.parent){if(this.renderX=this.absoluteX/Scene_data.stageWidth,this.renderY=this.absoluteY/Scene_data.stageHeight,this.renderWidth=this.absoluteWidth/Scene_data.stageWidth,this.renderHeight=this.absoluteHeight/Scene_data.stageHeight,this._uvScale>=0)this.renderData[0]=this.renderX,this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this.scale*this._uvScale,this.renderData[3]=this.renderHeight*this.scale,this.renderData2[0]=this.tr.width*this._uvScale,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x+this.tr.width-this.tr.width*this._uvScale,this.renderData2[3]=this.tr.y;else{var a=Math.abs(this._uvScale);this.renderData[0]=this.renderX+this.renderWidth*(1-a),this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this.scale*a,this.renderData[3]=this.renderHeight*this.scale,this.renderData2[0]=this.tr.width*a,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x+this.tr.width*(1-a),this.renderData2[3]=this.tr.y}this.uiRender.makeRenderDataVc(this.vcId)}},b}(UICompenent);a.StateUpUIcompenent=c;var d=function(c){function d(){var a=c.call(this)||this;return a._maxlevflag=!1,a._isopen=!1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._testRender=new b,a.addRender(a._testRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._bgRender.uiAtlas=new UIAtlas,a}return __extends(d,c),d.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._testRender.dispose(),this._testRender=null,this._topRender.dispose(),this._topRender=null,this.achievementList&&(this.achievementList.dispose(),this.achievementList=null),this._effRender&&(this._effRender.dispose(),this._effRender=null),c.prototype.dispose.call(this)},d.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas.setInfo("ui/uidata/stateup/stateup.xml","ui/uidata/stateup/stateup.png",function(){a.loadConfigCom()},"ui/uidata/stateup/stateuppc.png")},d.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._bgRender.uiAtlas,this._topRender.uiAtlas=this._bgRender.uiAtlas,this.winmidRender.uiAtlas=this._bgRender.uiAtlas,this._testRender.uiAtlas=this._bgRender.uiAtlas,this.initData(),this.resize(),this.applyLoadComplete()},d.prototype.initData=function(){this.addChild(this.winmidRender.getComponent("a_leftbg"));var a=this.addChild(this.winmidRender.getComponent("a_leftbg1"));a.isU=!0,this.winmidRender.applyObjData(),this.addChild(this._baseRender.getComponent("a_title")),this.t_listindex1=this.addChild(this._baseRender.getComponent("listindex")),this.a_taskstate=this.addChild(this._baseRender.getComponent("a_taskstate")),this.a_btnname=this.addChild(this._topRender.getComponent("a_btnname")),this.a_info=this.addChild(this._baseRender.getComponent("a_info")),this.a_taskicon=this.addChild(this._baseRender.getComponent("a_taskicon")),this.a_pro=this.addChild(this._testRender.getComponent("a_pro")),this.a_protxt=this.addChild(this._topRender.getComponent("a_protxt")),this.a_curicon=this.addChild(this._topRender.getComponent("a_curicon")),this.a_nexticon=this.addChild(this._topRender.getComponent("a_nexticon")),this.a_icons=this.addChild(this._topRender.getComponent("a_icons")),this.a_names=this.addChild(this._topRender.getComponent("a_names")),this.a_forces=this.addChild(this._topRender.getComponent("a_forces")),this.a_btn=this.addEvntButUp("a_btn",this._baseRender),this.addUIList(["a_probg","a_infobg0","a_infobg1","a_bg"],this._bgRender),this.addUIList(["a_txt1","a_txt0","a_txt4","a_txt2","a_txt3","a_forcebg"],this._baseRender)},d.prototype.resize=function(){c.prototype.resize.call(this),this.achievementList&&(this.achievementList.left=this.t_listindex1.parent.x/UIData.Scale+this.t_listindex1.x,this.achievementList.top=this.t_listindex1.parent.y/UIData.Scale+this.t_listindex1.y)},d.prototype.setpoint=function(a){this._effpoint=a},d.prototype.showExpEff=function(){var a=this;console.log("up skill lev"),this._effRender||(this._effRender=new FrameUIRender,this.addRender(this._effRender),this._effRender.setImg(getEffectUIUrl("ui_cb"),3,4,function(b){a.expEff=b,a.expEff.x=a.a_pro.x-72,a.expEff.y=a.a_pro.y-55,a.expEff.width=1.3*a.expEff.baseRec.width,a.expEff.speed=5,a.expEff.playOne(a)})),this.expEff&&this.expEff.playOne(this)},d.prototype.showBezierEff=function(a){for(var b=0;b<Math.min(a,15);b++){var c=new msgtip.MsgEffectsMoveData,d=UiTweenVo.getPosByPanel(this._effpoint,{width:UIData.designWidth,height:UIData.designHeight,center:0,middle:0});c.startTM=TimeUtil.getTimer()+random(200),c.endTM=c.startTM+500,c.pos=d,c.bezierPos=new Vector2D(d.x+400*Math.random()-200,d.y+400*Math.random()-200);var e=UiTweenVo.getPosByPanel(new Vector2D(this.a_protxt.x,this.a_protxt.y),{width:UIData.designWidth,height:UIData.designHeight,center:0,middle:0});c.toPos=e,c.MONEY_TYPE=107;var f=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_EFFECTS_DATA);f.data=c,ModuleEventManager.dispatchEvent(f)}},d.prototype.showflyword=function(a){var b=new Vector2D(this.a_pro.parent.x+this.a_pro.width,this.a_pro.y),c=UiTweenVo.getPosByPanel(b,{width:UIData.designWidth,height:UIData.designHeight});c.x=c.x*UIData.Scale,c.y=c.y*UIData.Scale,msgtip.MsgTipManager.outStr(a,msgtip.PopMsgVo.type8,c)},d.prototype.drawPersonLev=function(){ArtFont.getInstance().writeFontToSkinNameCenter(this._baseRender.uiAtlas,"A_perlev",String(GuidData.player.getLevel()),ArtFont.num66);var b=a.StateUpModel.getInstance().getRecommend();console.log("基本数据",b),b&&(this.drawPic(this.a_icons,b.id),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_names.skinName,b.name,16,TextAlign.CENTER,ColorType.Whiteffeec9),ArtFont.getInstance().writeFontToSkinNameCenter(this._baseRender.uiAtlas,this.a_forces.skinName,String(b.force),ArtFont.num65))},d.prototype.chgLev=function(){var a=GuidData.player.getStateLev();this.drawPic(this.a_curicon,String(a));var b=TableData.getInstance().getData(TableData.tb_realmbreak_base,a+1);b?this.drawPic(this.a_nexticon,String(a+1)):(this._maxlevflag=!0,this.drawPic(this.a_nexticon,String(1e4)),this.chgExp())},d.prototype.drawPic=function(a,b){IconManager.getInstance().getIcon(getStateUpIconUrl(b),function(b){var c=a.uiRender.uiAtlas.getRec(a.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);d.drawImage(b,0,0,c.pixelWitdh,c.pixelHeight),TextureManager.getInstance().updateTexture(a.uiRender.uiAtlas.texture,c.pixelX,c.pixelY,d)})},d.prototype.chgExp=function(){if(this._maxlevflag)this.a_pro.uvScale=1,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_protxt.skinName,"已满级",14,TextAlign.CENTER,ColorType.Whiteffffff);else{var a=TableData.getInstance().getData(TableData.tb_realmbreak_base,GuidData.player.getStateLev()),b=GuidData.player.getStateExp()/a.exp,c=GuidData.player.getStateExp()+"/"+a.exp;this.a_pro.uvScale=b,LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_protxt.skinName,c,14,TextAlign.CENTER,ColorType.Whiteffffff)}},d.prototype.opensystem=function(){if(!this._isopen)if(GuidData.player.getsyspageopen(SharedDef.MODULE_EXP,SharedDef.MODULE_EXP_QUEST)&&(this._isopen=!0),this._isopen)this.refreshState();else{this.setUiListVisibleByItem([this.a_btn,this.a_btnname],!1);var a=TableData.getInstance().getData(TableData.tb_system_base,10*SharedDef.MODULE_EXP+SharedDef.MODULE_EXP_QUEST);LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_taskstate.skinName,a.level+"级解锁",16,TextAlign.CENTER,ColorType.Brown7a2f21)}},d.prototype.refreshState=function(){this.a_taskicon.x=417,this.a_taskstate.x=489,this.a_info.x=496;var a=TableData.getInstance().getData(TableData.tb_realmbreak_dailyquest_base,1);LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_taskstate.skinName,"今日已完成任务："+GuidData.player.getStateTaskNum()+"/"+a.daily_quest_count,16,TextAlign.CENTER,ColorType.Brown7a2f21),this.setUiListVisibleByItem([this.a_btnname],!0),1==GuidData.player.getStateTaskRecive()?(this.setUiListVisibleByItem([this.a_btn],!1),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_btnname.skinName,"已完成",16,TextAlign.CENTER,ColorType.Brown7a2f21)):(GuidData.player.getStateTaskNum()>=a.daily_quest_count?LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_btnname.skinName,"领取",16,TextAlign.CENTER,ColorType.Brown7a2f21):LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.a_btnname.skinName,"前往",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.setUiListVisibleByItem([this.a_btn],!0))},d.prototype.show=function(a){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.chgLev(),this.chgExp(),this.drawPersonLev(),this._isopen?this.refreshState():this.opensystem(),this.achievementList||(this.achievementList=new e,this.achievementList.init(this._baseRender.uiAtlas)),this.achievementList.show(),this.resize()},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),ModulePageManager.hideResTittle(),this.achievementList&&this.achievementList.hide()},d.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.StateUpEvent(a.StateUpEvent.HIDE_STATEUP_PANEL));break;case this.a_btn:var c=TableData.getInstance().getData(TableData.tb_realmbreak_dailyquest_base,1);GuidData.player.getStateTaskNum()>=c.daily_quest_count?NetManager.getInstance().protocolos.pick_realmbreak_daily_reward():ModulePageManager.openPanel(SharedDef.MODULE_EXP)}},d}(WindowUi);a.StateUpUiPanel=d;var e=function(b){function c(){return b.call(this)||this}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,f,601,253,0,85,3,512,512,1,5)},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.refreshDraw=function(){var b=this.getData(a.StateUpModel.getInstance().getTaskAry());this.refreshData(b)},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshDraw()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.AchievementList=e;var f=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.As_bg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"As_bg",0,0,601,84,51,20),a.addChild(this.As_bg),this.As_icon=this.creatSUI(d,this.parentTarget.baseAtlas,"As_icon",16,9,68,68),a.addChild(this.As_icon),this.As_name=this.creatSUI(d,this.parentTarget.baseAtlas,"As_name",110,22,232,20),a.addChild(this.As_name),this.As_probg=this.creatSUI(d,this.parentTarget.baseAtlas,"As_probg",93,51,257,18),a.addChild(this.As_probg),this.As_reward0=this.creatSUI(d,this.parentTarget.baseAtlas,"As_reward0",368,20,48,48),a.addChild(this.As_reward0),this.As_reward1=this.creatSUI(d,this.parentTarget.baseAtlas,"As_reward1",420,20,48,48),a.addChild(this.As_reward1),this.btnAry=new Array,this.btnAry.push(this.As_reward0),this.btnAry.push(this.As_reward1),this.As_btn=this.creatSUI(d,this.parentTarget.baseAtlas,"As_btn",480,21,106,46),a.addChild(this.As_btn),this.As_btn.addEventListener(InteractiveEvent.Up,this.butClik,this)},c.prototype.applyrender=function(){var a=this.itdata.data;UiDraw.uiAtlasDrawImg(this.uiAtlas,this.As_bg.skinName,UIData.publicUi,PuiData.STATEUP_LISTBG),this.drawIcon(),LabelTextFont.writeSingleLabel(this.uiAtlas,this.As_name.skinName,a.tb_quest.questName,16,TextAlign.LEFT,ColorType.Brown491207),this.drawProgress();for(var b=a.tb_quest.rewards[0],c=0;2>c;c++)c<b.length?IconManager.getInstance().drawItemIcon40(this.btnAry[c],b[c][0],b[c][1]):(IconManager.getInstance().clearItemEvent(this.btnAry[c]),UiDraw.clearUI(this.btnAry[c]));this.drawBtn()},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.drawBtn=function(){var a,b=this.itdata.data,c=this._baseRender.uiAtlas.getRec(this.As_btn.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);a=b.qusdata.taskState==SharedDef.QUEST_STATUS_COMPLETE?this.parentTarget.baseAtlas.getRec("Receive"):this.parentTarget.baseAtlas.getRec("Go"),d.drawImage(this.parentTarget.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},c.prototype.drawProgress=function(){var a=this.itdata.data,b=this._baseRender.uiAtlas.getRec(this.As_probg.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1),d=this.parentTarget.baseAtlas.getRec("Pro_bg");c.drawImage(this.parentTarget.baseAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,0,d.pixelWitdh,d.pixelHeight);var e=a.qusdata.items[0].process/a.qusdata.items[0].num,f=a.qusdata.items[0].process+"/"+a.qusdata.items[0].num,g=this.parentTarget.baseAtlas.getRec("Pro");c.drawImage(this.parentTarget.baseAtlas.useImg,g.pixelX+g.pixelWitdh-g.pixelWitdh*e,g.pixelY,g.pixelWitdh*e,g.pixelHeight,7,1,g.pixelWitdh*e,g.pixelHeight),LabelTextFont.writeSingleLabelToCtxSetAnchor(c,ColorType.Whitefffce6+f,14,128,0,TextAlign.CENTER),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.drawIcon=function(){var a=this;this.itdata.data;LoadManager.getInstance().load(Scene_data.fileRoot+"ui/load/achievementicon/1.png",LoadManager.IMG_TYPE,function(b){var c=a._baseRender.uiAtlas.getRec(a.As_icon.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.SKILL_BG68,new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(b,0,0,60,60,4,4,60,60),a._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},c.prototype.butClik=function(b){var c=new Vector2D(b.x,b.y);if(UIManager.getInstance().disMoveNnum(c,10)&&this.itdata&&this.itdata.data){var d=this.itdata.data;if(d.qusdata.taskState==SharedDef.QUEST_STATUS_COMPLETE){var e=new a.StateUpEvent(a.StateUpEvent.CLICK_EVT);e.data=c,ModuleEventManager.dispatchEvent(e),NetManager.getInstance().protocolos.pick_quest_realmbreak(d.qusdata.indx)}else{var f=new quest.QuestTaskVo;f.questDataVo=d.qusdata,quest.QuestModel.getInstance().meshQuestTargets(f,d.tb_quest.targetsPosition[0]),ModuleEventManager.dispatchEvent(new a.StateUpEvent(a.StateUpEvent.HIDE_STATEUP_PANEL))}}},c.prototype.setnull=function(){UiDraw.clearUI(this.As_bg),UiDraw.clearUI(this.As_icon),UiDraw.clearUI(this.As_name),UiDraw.clearUI(this.As_probg),UiDraw.clearUI(this.As_reward0),UiDraw.clearUI(this.As_reward1),UiDraw.clearUI(this.As_btn)},c}(SListItem);a.AchievementRender=f}(stateup||(stateup={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),training;!function(a){var b=function(){function a(){this._selected=!1}return Object.defineProperty(a.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected!=a&&(this._selected=a,this.drawUi())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"redShow",{get:function(){return this.redPoint?this.redPoint.show:!1},enumerable:!0,configurable:!0}),a.prototype.drawUi=function(){var a=this.skillui.uiRender.uiAtlas.getRec(this.skillui.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),c="未解锁",d="Lineh"+this.data.baskData.line;this.data.lev>0&&(c="LV"+this.data.lev,d="Line"+this.data.baskData.line);var e=this.skillui.uiRender.uiAtlas.getRec(d);b.drawImage(this.skillui.uiRender.uiAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,3,e.pixelWitdh,e.pixelHeight);var f=this.skillui.uiRender.uiAtlas.getRec("Levbg");b.drawImage(this.skillui.uiRender.uiAtlas.useImg,f.pixelX,f.pixelY,f.pixelWitdh,f.pixelHeight,0,50,f.pixelWitdh,f.pixelHeight),LabelTextFont.writeSingleLabelToCtxSetAnchor(b,c,13,25,51,TextAlign.CENTER,ColorType.Whitefff4d6),this._selected&&UiDraw.cxtDrawImg(b,PuiData.CIRCL74,new Rectangle(1,4,44,44),UIData.publicUi),this.skillui.uiRender.uiAtlas.updateCtx(b,a.pixelX,a.pixelY)},a.prototype.refresh=function(){if(this.data){var a=GuidData.player.getPassiveSkillLev(this.data.id);a!=this.data.lev&&(this.data.lev=a,this.data.lev>0&&(this.data.levData=tb.TB_skill_uplevel.get_TB_skill_uplevel(this.data.skillbaseData.uplevel_id[0]+this.data.lev-1)),this.drawUi(),this._selected&&this.parent.setSel(this))}},a.prototype.initRedpoint=function(a,b){var c=RedPointManager.getInstance().getNodeByID(126);if(c.children[a]){var d=b.getRedPointUI(this.parent,0,new Vector2D(this.skillui.x+this.skillui.width-8,this.skillui.y),"style1");c.children[a].bindUI(d),this.redPoint=c.children[a]}},a}();a.SkillItemCell=b;var c=function(){function a(){}return a}();a.SkillItemData=c;var d=function(a){function d(){var b=a.call(this)||this;return b._canclick=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b}return __extends(d,a),d.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this._frameRender&&(this._frameRender.dispose(),this._frameRender=null)},d.prototype.initUiAtlas=function(a,b){this._bgRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this._winRender=b,this.initView()},d.prototype.initView=function(){var a=this._baseRender;this._cnew_right_bg_top=this._winRender.getComponent("cnew_right_bg_top"),this.setSizeForPanelUiCopy(this._cnew_right_bg_top,"b_right_bg_top",this._baseRender),this._cnew_right_bg_bottom=this._winRender.getComponent("cnew_right_bg_bottom"),this.setSizeForPanelUiCopy(this._cnew_right_bg_bottom,"b_right_bg_bottom",this._baseRender),this._winRender.applyObjData();var d=tb.TB_adventure_skill_base.get_TB_quest_adventure_base();this.skilllist=new Array;for(var e=0;10>e;e++){var f=new b;f.parent=this,f.skillui=this.addChild(a.getComponent("b_skill"+e)),f.skillui.data=f,f.skillui.addEventListener(InteractiveEvent.Up,this.onClick,this);var g=new c;g.id=d[e].id,g.baskData=d[e],g.skillbaseData=tb.TB_skill_base.get_TB_skill_base(g.id),f.initRedpoint(e,this._redPointRender),f.data=g,this.skilllist.push(f)}var h=this.parent.loadBigPicByUrl("ui/load/training/trainingskillbg.jpg");this.parent.setSizeForPanelUiCopy(h,"ccav",this._baseRender),this.initSelSkilPanel(),this.setSel(this.skilllist[0])},d.prototype.onClick=function(a){a.target.data.data&&this.setSel(a.target.data)},d.prototype.showSkillUpEff=function(){var a=this;console.log("up skill lev"),this._frameRender||(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ui_jn"),4,4,function(b){a.upLevEff=b,a.upLevEff.x=a.b_skillicon.x-30,a.upLevEff.y=a.b_skillicon.y-30,a.upLevEff.speed=1,a.upLevEff.playOne(a)})),this.upLevEff&&this.upLevEff.playOne(this)},d.prototype.initSelSkilPanel=function(){this.addUIList(["b_titlebg","b_titlebg1"],this._bgRender),this.b_skillicon=this.addChild(this._baseRender.getComponent("b_skillicon")),this.b_skillname=this.addChild(this._baseRender.getComponent("b_skillname")),this.b_skilllev=this.addChild(this._baseRender.getComponent("b_skilllev"));var a=this.addChild(this._baseRender.getComponent("b_title"));LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,a.skinName,"效果说明",16,TextAlign.CENTER,ColorType.colorb96d49);var b=this.addChild(this._baseRender.getComponent("b_title1"));LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,b.skinName,"升级条件",16,TextAlign.CENTER,ColorType.colorb96d49),this.b_info=this.addChild(this._topRender.getComponent("b_info")),this.b_force=this.addChild(this._topRender.getComponent("b_force")),this.b_info1=this.addChild(this._topRender.getComponent("b_info1")),this.b_force1=this.addChild(this._topRender.getComponent("b_force1")),this.b_cost0=this.addChild(this._topRender.getComponent("b_cost0")),this.b_cost1=this.addChild(this._topRender.getComponent("b_cost1")),this.b_btninfo=this._topRender.getComponent("b_btninfo"),this.uplevbtn=this._topRender.getComponent("b_uplevbtn"),this.uplevbtn.addEventListener(InteractiveEvent.Up,this.butClik,this),this.selRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.uplevbtn.x+this.uplevbtn.width,this.uplevbtn.y))},d.prototype.resize=function(){a.prototype.resize.call(this)},d.prototype.refreshLev=function(){for(var a=0;a<this.skilllist.length;a++)this.skilllist[a].refresh()},d.prototype.setSel=function(a){for(var b=0;b<this.skilllist.length;b++)this.skilllist[b]==a?a.selected=!0:this.skilllist[b].selected=!1;this.drawSelSkill(a)},d.prototype.drawSelSkill=function(a){this._curCell=a;var b=ColorType.colorce0a00+"未解锁";a.data.lev>0&&(b=ColorType.Brown7a2f21+"等级："+ColorType.colorff7200+a.data.lev),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_skilllev.skinName,b,16,TextAlign.LEFT,ColorType.colorb96d49),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_skillname.skinName,a.data.skillbaseData.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),IconManager.getInstance().drawCircleIcon(this.b_skillicon,2,a.data.skillbaseData.id),this._needcost=a.data.baskData.cost[0];var c=ColorType.Brown7a2f21+"当前效果："+ColorType.Green2ca937+"待激活",d=ColorType.Brown7a2f21+"战力:"+ColorType.color4392ff+"0";a.data.lev>0&&(this._needcost=a.data.levData.uplevel_cost[0],c=ColorType.Brown7a2f21+"当前效果："+ColorType.Green2ca937+tb.SkillDataVo.getSkillDesc(a.data.id,a.data.lev),d=ColorType.Brown7a2f21+"战力:"+ColorType.color4392ff+a.data.levData.fight_value),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_info.skinName,c,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_force.skinName,d,14,TextAlign.LEFT);var e=TableData.getInstance().getData(TableData.tb_skill_uplevel,a.data.skillbaseData.uplevel_id[0]+a.data.lev);a.data.lev>a.data.skillbaseData.uplevel_id[1]-a.data.skillbaseData.uplevel_id[0]&&(e=null);var f=ColorType.Brown7a2f21+"下级效果："+ColorType.Green2ca937+"已满级",g="";if(e&&(f=ColorType.Brown7a2f21+"下级效果："+ColorType.Green2ca937+tb.SkillDataVo.getSkillDesc(a.data.id,a.data.lev+1),g=ColorType.Brown7a2f21+"战力:"+ColorType.color4392ff+e.fight_value),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_info1.skinName,f,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_force1.skinName,g,14,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_cost0.skinName,"需求"+getResName(this._needcost[0])+": "+this._needcost[1],16,TextAlign.LEFT,ColorType.Brown7a2f21),this.updataRes(),this.setUiListVisibleByItem([this.b_btninfo,this.uplevbtn],!1),e)if(a.data.baskData.prev_limit[0])if(GuidData.player.getPassiveSkillLev(a.data.baskData.prev_limit[0][0])<a.data.baskData.prev_limit[0][1]){this.setUiListVisibleByItem([this.b_btninfo],!0);var h=tb.TB_skill_base.get_TB_skill_base(a.data.baskData.prev_limit[0][0]);LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_btninfo.skinName,h.name+"达到LV"+a.data.baskData.prev_limit[0][1]+"可升级",16,TextAlign.CENTER,ColorType.colorce0a00)}else this.setUiListVisibleByItem([this.uplevbtn],!0);else this.setUiListVisibleByItem([this.uplevbtn],!0);else this.setUiListVisibleByItem([this.b_btninfo],!0),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_btninfo.skinName,"已满级",16,TextAlign.CENTER,ColorType.Brown7a2f21);this.refreshredpoint()},d.prototype.refreshredpoint=function(){this._curCell.redShow?this.selRedPoint.preShow():this.selRedPoint.preHide()},d.prototype.updataRes=function(){var a=ColorType.colorce0a00;this._canuplev=!1,GuidData.player.getResType(this._needcost[0])>=this._needcost[1]&&(a=ColorType.Green2ca937,this._canuplev=!0),a+=GuidData.player.getResTypeStr(this._needcost[0]),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_cost1.skinName,ColorType.Brown7a2f21+"拥有"+getResName(this._needcost[0])+": "+a,16,TextAlign.LEFT)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.setUiListVisibleByItem([this._cnew_right_bg_top,this._cnew_right_bg_bottom],!0),this.parent.addBigPic(),this._baseRender.uiAtlas&&this.refreshLev(),this.resize()},d.prototype.hide=function(){this.setUiListVisibleByItem([this._cnew_right_bg_top,this._cnew_right_bg_bottom],!1),this.parent.removeBigPic(),UIManager.getInstance().removeUIContainer(this)},d.prototype.butClik=function(a){var b=this;switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.uplevbtn:if(this._canclick)if(this._canclick=!1,TimeUtil.addTimeOut(500,function(){b._canclick=!0}),this._canuplev)NetManager.getInstance().protocolos.raise_adventurespell(this._curCell.data.id);else{var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);c.data=this._needcost[0],ModuleEventManager.dispatchEvent(c)}}},d}(UIVirtualContainer);a.TrainingSkill=d}(training||(training={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,
new d)}}(),training;!function(a){var b=function(){function b(){}return b.prototype.setVo=function(a,b){this.data=a,this.parent.setUiListVisibleByItem([this.leftbg,this.rightbg,this.title,this.taskmap,this.taskinfo,this.line,this.resui,this.rewardtitle,this.btn,this.openlev],!0),this.parent.setUiListVisibleByItem(this.rewardary,!0),this.setXY(b),LabelTextFont.writeSingleLabel(this.title.uiRender.uiAtlas,this.title.skinName,a.tab_quest.questName,16,TextAlign.CENTER,ColorType.Whitefff4d6),this.drawReward(a.tab_quest.rewards),this.taskuidraw(),null==a.questData?(this.btn.goToAndStop(3),LabelTextFont.writeSingleLabel(this.openlev.uiRender.uiAtlas,this.openlev.skinName,"LV"+a.tab_quest.level+"解锁",16,TextAlign.CENTER,ColorType.Brown7a2f21)):(UiDraw.clearUI(this.openlev),a.questData.taskState==SharedDef.QUEST_STATUS_END?this.btn.goToAndStop(2):this.btnChgbyRes()),this.btn.addEventListener(InteractiveEvent.Up,this.click,this)},b.prototype.click=function(b){var c=this.data;if(null!=c.questData&&c.questData.taskState!=SharedDef.QUEST_STATUS_END)if(UiTweenScale.getInstance().changeButSize(b.target),GuidData.player.getResType(c.tab_adventure.upres[0])<c.tab_adventure.upres[1]){var d=new quest.QuestTaskVo;d.questDataVo=c.questData,quest.QuestModel.getInstance().meshQuestTargets(d,c.tab_quest.targetsPosition[0]),ModuleEventManager.dispatchEvent(new a.TrainingEvent(a.TrainingEvent.HIDE_TRAINING_PANEL))}else NetManager.getInstance().protocolos.pick_quest_adventure(c.questData.indx)},b.prototype.setXY=function(a){var b=266*a;this.leftbg.x=b+64,this.rightbg.x=this.leftbg.x+this.leftbg.width,this.title.x=b+141,this.taskmap.x=b+130,this.taskinfo.x=b+91,this.line.x=b+96,this.resui.x=b+128,this.unopened.x=b+122,this.rewardtitle.x=b+86,this.btn.x=b+138,this.openlev.x=b+142;for(var c=0;c<this.rewardary.length;c++)this.rewardary[c].x=b+111+60*c},b.prototype.btnChgbyRes=function(){var a=GuidData.player.getResType(this.data.tab_adventure.upres[0])<this.data.tab_adventure.upres[1]?0:1;this.btn.goToAndStop(a)},b.prototype.drawCurCardNum=function(){var a=this.resui.uiRender.uiAtlas.getRec(this.resui.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),c=this.data.tab_adventure.upres[0],d=this.data.tab_adventure.upres[1],e=GuidData.player.getResType(c)>=d?ColorType.Green2ca937:ColorType.Redd92200,f=ColorType.color9a683f+getResName(c)+":"+e+GuidData.player.getResTypeStr(c),g=LabelTextFont.writeSingleLabelToCtx(b,f,16,0,10,TextAlign.LEFT);UiDraw.cxtDrawImg(b,UIuitl.getInstance().costtype(c),new Rectangle(g,0,35,35),UIData.publicUi),this.resui.uiRender.uiAtlas.updateCtx(b,a.pixelX,a.pixelY),null!=this.data.questData&&this.data.questData.taskState!=SharedDef.QUEST_STATUS_END&&this.btnChgbyRes()},b.prototype.taskuidraw=function(){var a=this.data;this.parent.setUiListVisibleByItem([this.unopened],null==a.questData),this.parent.setUiListVisibleByItem([this.taskmap,this.taskinfo,this.line,this.resui],null!=a.questData),LabelTextFont.writeSingleLabel(this.taskmap.uiRender.uiAtlas,this.taskmap.skinName,ColorType.Brown7a2f21+"任务地图："+ColorType.Green2ca937+tb.TB_map.getTB_map(a.tab_quest.targetsPosition[0][1]).name,16,TextAlign.CENTER);var b=a.tab_adventure.upres[0],c=a.tab_adventure.upres[1],d=GuidData.player.getResType(b)>=c?ColorType.Green2ca937:ColorType.Redd92200,e=ColorType.Brown7a2f21+a.tab_quest.text[0][0]+"("+d+GuidData.player.getResTypeStr(b)+ColorType.Brown7a2f21+"/"+c+")";a.tab_quest.hint[0]&&a.tab_quest.hint[0][0]&&(e=e+"\n"+a.tab_quest.hint[0][0]),LabelTextFont.writeTextAutoCenter(this.taskinfo.uiRender.uiAtlas,this.taskinfo.skinName,e,16,ColorType.Brown7a2f21,180,!0),this.drawCurCardNum()},b.prototype.drawReward=function(a){for(var b=0;b<this.rewardary.length;b++)a[0][b]?IconManager.getInstance().drawItemIcon40(this.rewardary[b],a[0][b][0],a[0][b][1]):UiDraw.clearUI(this.rewardary[b])},b.prototype.clearUi=function(){this.btn.removeEventListener(InteractiveEvent.Up,this.click,this),this.data=null,this.parent.setUiListVisibleByItem([this.leftbg,this.rightbg,this.title,this.taskmap,this.taskinfo,this.line,this.resui,this.rewardtitle,this.btn,this.openlev],!1),this.parent.setUiListVisibleByItem(this.rewardary,!1)},b}();a.TaskCell=b;var c=function(c){function d(){var a=c.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(d,c),d.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null},d.prototype.initUiAtlas=function(a){this._bgRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},d.prototype.initView=function(){this._baseRender;this.taskCellAry=new Array;for(var a=0;3>a;a++){var c=new b;c.parent=this,c.leftbg=this._bgRender.getComponent("leftbg0"),c.leftbg.isU=!0,c.rightbg=this._bgRender.getComponent("right0"),c.title=this._topRender.getComponent("a_name"+a),c.taskmap=this._baseRender.getComponent("a_task"+a+"0"),c.taskinfo=this._baseRender.getComponent("a_task"+a+"1"),c.line=this._baseRender.getComponent("a_task02"),c.resui=this._baseRender.getComponent("a_task"+a+"3"),c.unopened=this._baseRender.getComponent("a_task04"),c.rewardtitle=this._baseRender.getComponent("a_rewardtitle0"),c.rewardary=new Array;for(var d=0;3>d;d++)c.rewardary.push(this.addChild(this._baseRender.getComponent("a_reward"+a+d)));c.btn=this.addChild(this._baseRender.getComponent("a_btn0")),c.openlev=this.addChild(this._topRender.getComponent("a_openlev"+a)),this.taskCellAry.push(c)}this.ArrowAry=new Array,this.a_arrowleft=this.addEvntButUp("a_arrowleft",this._topRender),this.a_arrowleft.isU=!0,this.a_arrowright=this.addEvntButUp("a_arrowright",this._topRender),this.ArrowAry.push(this.a_arrowright),this.ArrowAry.push(this.a_arrowleft),this._topRender.applyObjData()},d.prototype.resize=function(){c.prototype.resize.call(this)},Object.defineProperty(d.prototype,"curpage",{get:function(){return this._curpage},set:function(a){1==a?this.setUiListVisibleByItem([this.ArrowAry[1]],!1):this.setUiListVisibleByItem([this.ArrowAry[1]],!0);var b=Math.ceil(this._itemAry.length/3);b==a?this.setUiListVisibleByItem([this.ArrowAry[0]],!1):this.setUiListVisibleByItem([this.ArrowAry[0]],!0),this._curpage=a,this.drawUI()},enumerable:!0,configurable:!0}),d.prototype.drawUI=function(){for(var a=0;3>a;a++){var b=3*(this.curpage-1)+a;b>this._itemAry.length-1?this.taskCellAry[a].clearUi():this.taskCellAry[a].setVo(this._itemAry[b],a)}},d.prototype.refreshServerData=function(){this._itemAry=a.TrainingModel.getInstance().getTaskvo(),this.drawUI()},d.prototype.refreshCurCardNum=function(){for(var a=0;a<this.taskCellAry.length;a++)this.taskCellAry[a].data&&this.taskCellAry[a].taskuidraw()},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this._itemAry=a.TrainingModel.getInstance().getTaskvo(),this.curpage=1,this.resize()},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.a_arrowleft:this.curpage--;break;case this.a_arrowright:this.curpage++}},d}(UIVirtualContainer);a.TrainingTask=c}(training||(training={}));var training;!function(a){var b=function(){function a(){}return a}();a.TaskVo=b;var c=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getTaskvo=function(){return this.tasklist||(this.tasklist=this.getTaskAry(),this.refreshTaskAry()),this.tasklist},a.prototype.refreshTaskAry=function(){for(var a=0;a<this.tasklist.length;a++)this.tasklist[a].questData=this.hasTrainingVo(this.tasklist[a].tab_adventure.quest_id)},a.prototype.getTaskAry=function(){for(var a=new Array,c=tb.TB_quest_adventure_base.get_TB_quest_adventure_base(),d=0;d<c.length;d++){var e=new b;e.tab_adventure=c[d],e.tab_quest=tb.TB_quest.getTbById(c[d].quest_id),a.push(e)}return a},a.prototype.hasTrainingVo=function(a){for(var b=GuidData.quest.getTrainingTaskList(),c=0;c<b.length;c++)if(a==b[c].id)return b[c];return null},a.prototype.getprev_limitflag=function(a){switch(a[0]){case 1:var b=adventure.AdventureModel.getInstance().getCurTb();return b.id>a[1];case 2:return!1;case 3:return GuidData.player.getForce()>=a[1];case 4:return GuidData.player.getLevel()>=a[1];case 5:var c=!1,d=!1;if(GuidData.grow.getWingIsActive()){var e=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID());c=e.rank>=a[1],d=!0,e.rank==a[1]&&(d=e.star>=a[2])}return c&&d;case 6:var c=GuidData.grow.getMountLevel()>=a[1],d=!0;return GuidData.grow.getMountLevel()==a[1]&&(d=GuidData.grow.getMountStart()>=a[2]),c&&d;default:return!1}},a.prototype.getprev_limitstr=function(a){switch(a[0]){case 1:var b=tb.TB_risk_data.get_TB_risk_data(a[1]);return"幻境通关至"+b.name+"可升级";case 2:return"击杀某只怪物";case 3:return"战力达到"+Snum(a[1])+"可升级";case 4:return"人物达到"+a[1]+"级可升级";case 5:return"翅膀达到"+a[1]+"阶"+a[2]+"星可升级";case 6:return"坐骑达到"+a[1]+"阶"+a[2]+"星可升级";default:return""}},a}();a.TrainingModel=c}(training||(training={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),training;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._bgRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this.trainingTask&&(this.trainingTask.dispose(),this.trainingTask=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender.uiAtlas.setInfo("ui/uidata/training/training.xml","ui/uidata/training/training.png",function(){a.loadConfigCom()},"ui/uidata/training/trainingps.png")},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._bgRender.uiAtlas,this.initData(),this.resize(),this.applyLoadComplete()},c.prototype.initData=function(){this.TabAry=new Array;for(var a=0;1>a;a++){var b=this.addChild(this._bgRender.getComponent("tab"+a));b.data=a+1,b.addEventListener(InteractiveEvent.Up,this.click,this),this.TabAry.push(b)}var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(c,"rightLinebg",this._bgRender),this.UnlockUIAry=new Array,this.t_unlock0=this.addEvntBut("t_unlock0",this._bgRender),this.UnlockUIAry.push(this.t_unlock0),this.winmidRender.applyObjData(),this.addUIList(["a_tittle_name"],this._bgRender),this.addUIList(["t_bgline"],this._baseRender)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.refreshOpenLev=function(){GuidData.player.getsyspageopen(SharedDef.MODULE_EXP,SharedDef.MODULE_EXP_QUEST)?(this.setUiListVisibleByItem([this.TabAry[0]],!0),this.setUiListVisibleByItem([this.UnlockUIAry[0]],!1)):(this.setUiListVisibleByItem([this.TabAry[0]],!1),this.setUiListVisibleByItem([this.UnlockUIAry[0]],!0),this.UnlockUIAry[0].data=tb.TB_system_base.getTempVo(10*SharedDef.MODULE_EXP+SharedDef.MODULE_EXP_QUEST))},c.prototype.show=function(a){this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.refreshOpenLev(),this.selectedTab(a)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.hideTabPage(),ModulePageManager.hideResTittle()},c.prototype.selectedTab=function(a){this._lastvalue=a;for(var b=0;b<this.TabAry.length;b++)this.TabAry[b].data==a?this.TabAry[b].selected=!0:this.TabAry[b].selected=!1;this.hideTabPage(a),this.showTabPage(a)},c.prototype.showTabPage=function(b){switch(b){case SharedDef.MODULE_EXP_QUEST:this.trainingTask||(this.trainingTask=new a.TrainingTask,this.trainingTask.initUiAtlas(this._bgRender.uiAtlas)),this.trainingTask.show()}},c.prototype.hideTabPage=function(a){switch(void 0===a&&(a=-1),a){case SharedDef.MODULE_EXP_ARTIFACT:this.trainingTask&&this.trainingTask.hide();break;default:this.trainingTask&&this.trainingTask.hide()}},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.TrainingEvent(a.TrainingEvent.HIDE_TRAINING_PANEL));break;case this.t_unlock0:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock0.data.level+"级后解锁",99)}},c.prototype.click=function(a){this.selectedTab(a.target.data),UIManager.popClikNameFun(a.target.name)},c}(WindowUi);a.TrainingUiPanel=b}(training||(training={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),training;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"TrainingModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.TrainingModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_TRAINING_PANEL="SHOW_TRAINING_PANEL",b.HIDE_TRAINING_PANEL="HIDE_TRAINING_PANEL",b.REFRESH_TRAINING_PANEL="REFRESH_TRAINING_PANEL",b}(BaseEvent);a.TrainingEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"TrainingProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_TRAINING_PANEL&&this.showPanel(b.data),b.type==c.HIDE_TRAINING_PANEL&&this.hidePanel(),b.type==c.REFRESH_TRAINING_PANEL&&this.refreshtask()}if(a instanceof EngineEvent){var d=a;d.type==EngineEvent.MONEY_CHANGE?this.trainingUiPanel&&this.trainingUiPanel.trainingTask&&this.trainingUiPanel.trainingTask.hasStage&&this.trainingUiPanel.trainingTask.refreshCurCardNum():d.type==EngineEvent.PLAYER_FIELD_LEVEL&&this.trainingUiPanel&&this.trainingUiPanel.refreshOpenLev()}if(a instanceof UIPanelEvent){var e=a;e.panel==this.trainingUiPanel&&(this.trainingUiPanel.dispose(),this.trainingUiPanel=null,console.log("释放面板 trainingUiPanel"))}},d.prototype.refreshtask=function(){a.TrainingModel.getInstance().refreshTaskAry(),this.trainingUiPanel&&this.trainingUiPanel.trainingTask&&this.trainingUiPanel.trainingTask.hasStage&&this.trainingUiPanel.trainingTask.refreshServerData()},d.prototype.hidePanel=function(){this.trainingUiPanel&&this.trainingUiPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.trainingUiPanel||(this.trainingUiPanel=new a.TrainingUiPanel),this.trainingUiPanel.load(function(){console.log("--$data---",b),b?b instanceof Array&&(b=b[0]):b=SharedDef.MODULE_EXP_QUEST,c.trainingUiPanel.show(b);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_WORLD_RISK,ModuleEventManager.dispatchEvent(a)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_TRAINING_PANEL),new c(c.HIDE_TRAINING_PANEL),new c(c.REFRESH_TRAINING_PANEL),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.TrainingProcessor=d}(training||(training={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),divinesword;!function(a){var b=function(){function a(){this._selected=!1}return Object.defineProperty(a.prototype,"selected",{get:function(){return this._selected},set:function(a){this._selected!=a&&(this._selected=a,this.drawUi())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"redShow",{get:function(){return this.redPoint?this.redPoint.show:!1},enumerable:!0,configurable:!0}),a.prototype.drawUi=function(){var a=this.skillui.uiRender.uiAtlas.getRec(this.skillui.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),c="Lineh"+this.data.baskData.line;this.data.lev>0&&(c="Line"+this.data.baskData.line);var d=this.skillui.uiRender.uiAtlas.getRec(c);b.drawImage(this.skillui.uiRender.uiAtlas.useImg,d.pixelX,d.pixelY,d.pixelWitdh,d.pixelHeight,0,3,d.pixelWitdh,d.pixelHeight);var e=this.skillui.uiRender.uiAtlas.getRec("Levbg");b.drawImage(this.skillui.uiRender.uiAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,50,e.pixelWitdh,e.pixelHeight);var f=tb.TB_skill_base.get_TB_skill_base(this.data.baskData.id);LabelTextFont.writeSingleLabelToCtxSetAnchor(b,f.name,13,25,51,TextAlign.CENTER,ColorType.Whitefff4d6),this._selected&&UiDraw.cxtDrawImg(b,PuiData.CIRCL74,new Rectangle(1,4,44,44),UIData.publicUi),this.skillui.uiRender.uiAtlas.updateCtx(b,a.pixelX,a.pixelY)},a.prototype.refresh=function(){if(this.data){var a=GuidData.player.getPassiveSkillLev(this.data.id);a!=this.data.lev&&(this.data.lev=a,this.data.lev>0&&(this.data.levData=tb.TB_skill_uplevel.get_TB_skill_uplevel(this.data.skillbaseData.uplevel_id[0]+this.data.lev-1)),this.drawUi(),this.refreshSel())}},a.prototype.refreshSel=function(){this._selected&&this.parent.setSel(this)},a.prototype.initRedpoint=function(a,b){var c=RedPointManager.getInstance().getNodeByID(128);if(c.children[a]){var d=b.getRedPointUI(this.parent,0,new Vector2D(this.skillui.x+this.skillui.width-8,this.skillui.y),"style1");c.children[a].bindUI(d),this.redPoint=c.children[a]}},a}();a.SkillItemCell=b;var c=function(){function a(){}return a}();a.SkillItemData=c;var d=function(a){function d(){var b=a.call(this)||this;return b._complete=!1,b._canclick=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._frameRender=new FrameUIRender,b.addRender(b._frameRender),b._frameBuleKoRender=new FrameUIRender,b.addRender(b._frameBuleKoRender),b._frameRedKoRender=new FrameUIRender,b.addRender(b._frameRedKoRender),b._frameBuleRender=new FrameUIRender,b.addRender(b._frameBuleRender),b._frameRedRender=new FrameUIRender,b.addRender(b._frameRedRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._topbgRender=new UIRenderComponent,b.addRender(b._topbgRender),b._toptopRender=new UIRenderComponent,b.addRender(b._toptopRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b}return __extends(d,a),d.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._topbgRender.dispose(),this._topbgRender=null,this._toptopRender.dispose(),this._toptopRender=null,this._redPointRender.dispose(),this._redPointRender=null,this._frameRender&&(this._frameRender.dispose(),this._frameRender=null),this._frameRedRender&&(this._frameRedRender.dispose(),this._frameRedRender=null),this._frameBuleRender&&(this._frameBuleRender.dispose(),this._frameBuleRender=null),this._frameRedKoRender&&(this._frameRedKoRender.dispose(),this._frameRedKoRender=null),this._frameBuleKoRender&&(this._frameBuleKoRender.dispose(),this._frameBuleKoRender=null)},d.prototype.initUiAtlas=function(a,b){this._bgRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this._topbgRender.uiAtlas=a,this._toptopRender.uiAtlas=a,this._winRender=b,this.initRedeffect()},d.prototype.initView=function(){var a=this._baseRender;this._cnew_right_bg_top=this._winRender.getComponent("cnew_right_bg_top"),this.setSizeForPanelUiCopy(this._cnew_right_bg_top,"b_right_bg_top",this._baseRender),this._cnew_right_bg_bottom=this._winRender.getComponent("cnew_right_bg_bottom"),this.setSizeForPanelUiCopy(this._cnew_right_bg_bottom,"b_right_bg_bottom",this._baseRender),this._winRender.applyObjData();var d=tb.TB_adventure_skill_base.get_TB_quest_adventure_base();this.skilllist=new Array;for(var e=0;10>e;e++){var f=new b;f.parent=this,f.skillui=this.addChild(a.getComponent("b_skill"+e)),f.skillui.data=f,f.skillui.addEventListener(InteractiveEvent.Up,this.onClick,this);var g=new c;g.id=d[e].id,g.baskData=d[e],g.skillbaseData=tb.TB_skill_base.get_TB_skill_base(g.id),f.initRedpoint(e,this._redPointRender),1==g.baskData.line?(f.effko=this.effredkoAry[e],f.effup=this.effredAry[e]):(f.effko=this.effbluekoAry[e-5],f.effup=this.effblueAry[e-5]),f.data=g,this.skilllist.push(f)}var h=this.parent.loadBigPicByUrl("ui/load/training/trainingskillbg.jpg");this.parent.setSizeForPanelUiCopy(h,"ccav",this._baseRender),this.initSelSkilPanel(),this.b_unlockbg=this._topbgRender.getComponent("b_unlockbg"),this.b_unlockarrow=this._topbgRender.getComponent("b_unlockarrow"),this.b_unlockinfo=this._toptopRender.getComponent("b_unlockinfo"),this._complete=!0,this.show()},d.prototype.drawUnlock=function(a){var b,c=a.data.baskData;if(b=c.prev_limit[0]?training.TrainingModel.getInstance().getprev_limitflag(c.prev_limit[0]):!0,b=!b&&0==a.data.lev,this.setUiListVisibleByItem([this.b_unlockarrow,this.b_unlockbg,this.b_unlockinfo],b),b){var d=training.TrainingModel.getInstance().getprev_limitstr(a.data.baskData.prev_limit[0]),e=LabelTextFont.writeText(this._topRender.uiAtlas,this.b_unlockinfo.skinName,0,0,d,16,"#fff4d6",225,!0);this.b_unlockbg.width=e[0]+30,this.b_unlockbg.height=e[1]+20,this.b_unlockarrow.x=a.skillui.x+a.skillui.width,this.b_unlockarrow.y=a.skillui.y+14,this.b_unlockbg.x=this.b_unlockarrow.x+this.b_unlockarrow.width-2,this.b_unlockbg.y=this.b_unlockarrow.y-(this.b_unlockbg.height-this.b_unlockarrow.height)/2,this.b_unlockinfo.x=this.b_unlockbg.x+15,this.b_unlockinfo.y=this.b_unlockbg.y+10,this._topbgRender.applyObjData()}},d.prototype.onClick=function(a){a.target.data.data&&this.setSel(a.target.data)},d.prototype.showSkillUpEff=function(){var a=this;console.log("up skill lev"),this.upLevEff?this.upLevEff.playOne(this):this._frameRender.setImg(getEffectUIUrl("ui_jn"),4,4,function(b){a.upLevEff=b,a.upLevEff.x=a.b_skillicon.x-30,a.upLevEff.y=a.b_skillicon.y-30,a.upLevEff.speed=1,a.upLevEff.playOne(a)})},d.prototype.initRedeffect=function(){var a=this;this.effredAry?this.initBuleeffect():this._frameRedRender.setImg(getEffectUIUrl("ef_jh_red"),4,4,function(b){a.effredAry=b;for(var c=0;c<a.effredAry.length;c++)a.effredAry[c].width=a.effredAry[c].baseRec.width,a.effredAry[c].height=a.effredAry[c].baseRec.height,a.effredAry[c].speed=3;a.initBuleeffect()},5)},d.prototype.initBuleeffect=function(){var a=this;this.effblueAry?this.initredkoeffect():this._frameBuleRender.setImg(getEffectUIUrl("ef_jh_blue"),4,4,function(b){a.effblueAry=b;for(var c=0;c<a.effblueAry.length;c++)a.effblueAry[c].width=a.effblueAry[c].baseRec.width,a.effblueAry[c].height=a.effblueAry[c].baseRec.height,a.effblueAry[c].speed=3;a.initredkoeffect()},5)},d.prototype.initredkoeffect=function(){var a=this;this.effredkoAry?this.initbluekoeffect():this._frameRedKoRender.setImg(getEffectUIUrl("ef_jh_red_ko"),4,4,function(b){a.effredkoAry=b;for(var c=0;c<a.effredkoAry.length;c++)a.effredkoAry[c].width=a.effredkoAry[c].baseRec.width,a.effredkoAry[c].height=a.effredkoAry[c].baseRec.height,a.effredkoAry[c].speed=3;a.initbluekoeffect()},5)},d.prototype.initbluekoeffect=function(){var a=this;this.effbluekoAry?this.initView():this._frameBuleKoRender.setImg(getEffectUIUrl("ef_jh_blue_ko"),4,4,function(b){a.effbluekoAry=b;for(var c=0;c<a.effbluekoAry.length;c++)a.effbluekoAry[c].width=a.effbluekoAry[c].baseRec.width,a.effbluekoAry[c].height=a.effbluekoAry[c].baseRec.height,a.effbluekoAry[c].speed=3;a.initView()},5)},d.prototype.initSelSkilPanel=function(){this.addUIList(["b_titlebg","b_titlebg1"],this._bgRender),this.b_skillicon=this.addChild(this._baseRender.getComponent("b_skillicon")),this.b_skillname=this.addChild(this._baseRender.getComponent("b_skillname")),this.b_skilllev=this.addChild(this._baseRender.getComponent("b_skilllev"));var a=this.addChild(this._baseRender.getComponent("b_title"));LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,a.skinName,"效果说明",16,TextAlign.CENTER,ColorType.colorb96d49);var b=this.addChild(this._baseRender.getComponent("b_title1"));LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,b.skinName,"升级条件",16,TextAlign.CENTER,ColorType.colorb96d49),this.b_info=this.addChild(this._topRender.getComponent("b_info")),this.b_force=this.addChild(this._topRender.getComponent("b_force")),this.b_info1=this.addChild(this._topRender.getComponent("b_info1")),this.b_force1=this.addChild(this._topRender.getComponent("b_force1")),this.b_cost0=this.addChild(this._topRender.getComponent("b_cost0")),this.b_cost1=this.addChild(this._topRender.getComponent("b_cost1")),this.b_btninfo=this.addChild(this._topRender.getComponent("b_btninfo")),this.uplevbtn=this.addChild(this._topRender.getComponent("b_uplevbtn")),this.uplevbtn.addEventListener(InteractiveEvent.Up,this.butClik,this),this.selRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.uplevbtn.x+this.uplevbtn.width,this.uplevbtn.y))},d.prototype.resize=function(){a.prototype.resize.call(this)},d.prototype.refreshLev=function(){for(var a=0;a<this.skilllist.length;a++){var b=this.skilllist[a];b.refresh(),b.data.lev>b.data.skillbaseData.uplevel_id[1]-b.data.skillbaseData.uplevel_id[0]?(this.removeChild(b.effup),this.playeff(b.effko,b.skillui)):b.redShow?(this.removeChild(b.effko),this.playeff(b.effup,b.skillui)):(this.removeChild(b.effko),this.removeChild(b.effup))}},d.prototype.playeff=function(a,b){a.x=b.x-8,a.y=b.y-6,this.addChild(a),a.play()},d.prototype.refreshSel=function(){for(var a=0;a<this.skilllist.length;a++)this.skilllist[a].refreshSel()},d.prototype.setSel=function(a){for(var b=0;b<this.skilllist.length;b++)this.skilllist[b]==a?(this.skilllist[b].selected=!0,this.drawUnlock(this.skilllist[b])):this.skilllist[b].selected=!1;this.drawSelSkill(a)},d.prototype.drawSelSkill=function(a){this._curCell=a;var b=ColorType.colorce0a00+"未解锁";a.data.lev>0&&(b=ColorType.Brown7a2f21+"等级："+ColorType.colorff7200+a.data.lev),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_skilllev.skinName,b,16,TextAlign.LEFT,ColorType.colorb96d49),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_skillname.skinName,a.data.skillbaseData.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),IconManager.getInstance().drawCircleIcon(this.b_skillicon,2,a.data.skillbaseData.id),this._needcost=a.data.baskData.cost[0];var c=ColorType.Brown7a2f21+"当前效果："+ColorType.Green2ca937+"待激活",d=ColorType.Brown7a2f21+"战力:"+ColorType.color4392ff+"0";a.data.lev>0&&(this._needcost=a.data.levData.uplevel_cost[0],c=ColorType.Brown7a2f21+"当前效果："+ColorType.Green2ca937+tb.SkillDataVo.getSkillDesc(a.data.id,a.data.lev),d=ColorType.Brown7a2f21+"战力:"+ColorType.color4392ff+a.data.levData.fight_value),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_info.skinName,c,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_force.skinName,d,14,TextAlign.LEFT);var e=TableData.getInstance().getData(TableData.tb_skill_uplevel,a.data.skillbaseData.uplevel_id[0]+a.data.lev);a.data.lev>a.data.skillbaseData.uplevel_id[1]-a.data.skillbaseData.uplevel_id[0]&&(e=null);var f=ColorType.Brown7a2f21+"下级效果："+ColorType.Green2ca937+"已满级",g="";e&&(f=ColorType.Brown7a2f21+"下级效果："+ColorType.Green2ca937+tb.SkillDataVo.getSkillDesc(a.data.id,a.data.lev+1),g=ColorType.Brown7a2f21+"战力:"+ColorType.color4392ff+e.fight_value),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_info1.skinName,f,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_force1.skinName,g,14,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_cost0.skinName,"需求"+getResName(this._needcost[0])+": "+this._needcost[1],16,TextAlign.LEFT,ColorType.Brown7a2f21),this.updataRes(),e?(this.setUiListVisibleByItem([this.uplevbtn],!0),this.b_btninfo.y=496,a.data.baskData.prev_limit[0]?training.TrainingModel.getInstance().getprev_limitflag(a.data.baskData.prev_limit[0])?(UiDraw.clearUI(this.b_btninfo),this.uplevbtn.goToAndStop(0)):(this.uplevbtn.goToAndStop(1),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_btninfo.skinName,training.TrainingModel.getInstance().getprev_limitstr(a.data.baskData.prev_limit[0]),16,TextAlign.CENTER,ColorType.colorce0a00)):(UiDraw.clearUI(this.b_btninfo),this.uplevbtn.goToAndStop(0))):(this.b_btninfo.y=464,this.setUiListVisibleByItem([this.uplevbtn],!1),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_btninfo.skinName,"已满级",16,TextAlign.CENTER,ColorType.Brown7a2f21)),this.refreshredpoint()},d.prototype.refreshredpoint=function(){this._curCell.redShow?this.selRedPoint.preShow():this.selRedPoint.preHide()},d.prototype.updataRes=function(){if(this._needcost&&this._needcost.length>0){var a=ColorType.colorce0a00;this._canuplev=!1,GuidData.player.getResType(this._needcost[0])>=this._needcost[1]&&(a=ColorType.Green2ca937,this._canuplev=!0),a+=GuidData.player.getResTypeStr(this._needcost[0]),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_cost1.skinName,ColorType.Brown7a2f21+"拥有"+getResName(this._needcost[0])+": "+a,16,TextAlign.LEFT)}},d.prototype.initSelect=function(){this.skilllist.sort(function(a,b){return a.data.baskData.order-b.data.baskData.order});for(var a=!0,b=0;b<this.skilllist.length;b++)if(this.skilllist[b].data&&0==this.skilllist[b].data.lev){a=!1,this.setSel(this.skilllist[b]);break}a&&this.setSel(this.skilllist[0])},d.prototype.show=function(){this._complete&&(this.hasStage||(UIManager.getInstance().addUIContainer(this),this.setUiListVisibleByItem([this._cnew_right_bg_top,this._cnew_right_bg_bottom],!0),this.parent.addBigPic(),this.refreshLev(),this.initSelect(),this.resize()))},d.prototype.hide=function(){this.setUiListVisibleByItem([this._cnew_right_bg_top,this._cnew_right_bg_bottom],!1),this.parent.removeBigPic(),UIManager.getInstance().removeUIContainer(this)},d.prototype.butClik=function(a){var b=this;switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.uplevbtn:if(this._canclick)if(this._canclick=!1,TimeUtil.addTimeOut(500,function(){b._canclick=!0}),1==this.uplevbtn.current)console.log("---this._curCell.data.baskData.goto[0]---",this._curCell.data.baskData["goto"][0]),this.meshQuestTargets(this._curCell.data.baskData["goto"][0]);else if(this._canuplev)NetManager.getInstance().protocolos.raise_adventurespell(this._curCell.data.id);else{var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);c.data=this._needcost[0],ModuleEventManager.dispatchEvent(c)}}},d.prototype.meshQuestTargets=function(a){if(a){var b=a[0];switch(b){case 2:if(!GuidData.player.getsyspageopen(a[1],a[2]))return void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"系统未开启",99);ModulePageManager.openPanel(a[1],a[2])}}},d}(UIVirtualContainer);a.DivineswordSkill=d}(divinesword||(divinesword={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),divinesword;!function(a){
var b=function(){function b(){}return b.prototype.setVo=function(a,b){this.data=a,this.parent.setUiListVisibleByItem([this.leftbg,this.rightbg,this.title,this.taskmap,this.taskinfo,this.line,this.resui,this.rewardtitle,this.btn,this.openlev],!0),this.parent.setUiListVisibleByItem(this.rewardary,!0),this.setXY(b),LabelTextFont.writeSingleLabel(this.title.uiRender.uiAtlas,this.title.skinName,a.tab_quest.questName,16,TextAlign.CENTER,ColorType.Whitefff4d6),this.drawReward(a.tab_quest.rewards),this.taskuidraw(),null==a.questData?(this.btn.goToAndStop(3),LabelTextFont.writeSingleLabel(this.openlev.uiRender.uiAtlas,this.openlev.skinName,"LV"+a.tab_quest.level+"解锁",16,TextAlign.CENTER,ColorType.Brown7a2f21)):(UiDraw.clearUI(this.openlev),a.questData.taskState==SharedDef.QUEST_STATUS_END?this.btn.goToAndStop(2):this.btnChgbyRes()),this.btn.addEventListener(InteractiveEvent.Up,this.click,this)},b.prototype.click=function(b){var c=this.data;if(null!=c.questData&&c.questData.taskState!=SharedDef.QUEST_STATUS_END)if(UiTweenScale.getInstance().changeButSize(b.target),GuidData.player.getResType(c.tab_adventure.upres[0])<c.tab_adventure.upres[1]){var d=new quest.QuestTaskVo;d.questDataVo=c.questData,quest.QuestModel.getInstance().meshQuestTargets(d,c.tab_quest.targetsPosition[0]),ModuleEventManager.dispatchEvent(new a.DivineswordEvent(a.DivineswordEvent.HIDE_TRAINING_PANEL))}else NetManager.getInstance().protocolos.pick_quest_adventure(c.questData.indx)},b.prototype.setXY=function(a){var b=266*a;this.leftbg.x=b+64,this.rightbg.x=this.leftbg.x+this.leftbg.width,this.title.x=b+141,this.taskmap.x=b+130,this.taskinfo.x=b+91,this.line.x=b+96,this.resui.x=b+128,this.unopened.x=b+122,this.rewardtitle.x=b+86,this.btn.x=b+138,this.openlev.x=b+142;for(var c=0;c<this.rewardary.length;c++)this.rewardary[c].x=b+111+60*c},b.prototype.btnChgbyRes=function(){var a=GuidData.player.getResType(this.data.tab_adventure.upres[0])<this.data.tab_adventure.upres[1]?0:1;this.btn.goToAndStop(a)},b.prototype.drawCurCardNum=function(){var a=this.resui.uiRender.uiAtlas.getRec(this.resui.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),c=this.data.tab_adventure.upres[0],d=this.data.tab_adventure.upres[1],e=GuidData.player.getResType(c)>=d?ColorType.Green2ca937:ColorType.Redd92200,f=ColorType.color9a683f+getResName(c)+":"+e+GuidData.player.getResTypeStr(c),g=LabelTextFont.writeSingleLabelToCtx(b,f,16,0,10,TextAlign.LEFT);UiDraw.cxtDrawImg(b,UIuitl.getInstance().costtype(c),new Rectangle(g,0,35,35),UIData.publicUi),this.resui.uiRender.uiAtlas.updateCtx(b,a.pixelX,a.pixelY),null!=this.data.questData&&this.data.questData.taskState!=SharedDef.QUEST_STATUS_END&&this.btnChgbyRes()},b.prototype.taskuidraw=function(){var a=this.data;this.parent.setUiListVisibleByItem([this.unopened],null==a.questData),this.parent.setUiListVisibleByItem([this.taskmap,this.taskinfo,this.line,this.resui],null!=a.questData),LabelTextFont.writeSingleLabel(this.taskmap.uiRender.uiAtlas,this.taskmap.skinName,ColorType.Brown7a2f21+"任务地图："+ColorType.Green2ca937+tb.TB_map.getTB_map(a.tab_quest.targetsPosition[0][1]).name,16,TextAlign.CENTER);var b=a.tab_adventure.upres[0],c=a.tab_adventure.upres[1],d=GuidData.player.getResType(b)>=c?ColorType.Green2ca937:ColorType.Redd92200,e=ColorType.Brown7a2f21+a.tab_quest.text[0][0]+"("+d+GuidData.player.getResTypeStr(b)+ColorType.Brown7a2f21+"/"+c+")";a.tab_quest.hint[0]&&a.tab_quest.hint[0][0]&&(e=e+"\n"+a.tab_quest.hint[0][0]),LabelTextFont.writeTextAutoCenter(this.taskinfo.uiRender.uiAtlas,this.taskinfo.skinName,e,16,ColorType.Brown7a2f21,180,!0),this.drawCurCardNum()},b.prototype.drawReward=function(a){for(var b=0;b<this.rewardary.length;b++)a[0][b]?IconManager.getInstance().drawItemIcon40(this.rewardary[b],a[0][b][0],a[0][b][1]):UiDraw.clearUI(this.rewardary[b])},b.prototype.clearUi=function(){this.btn.removeEventListener(InteractiveEvent.Up,this.click,this),this.data=null,this.parent.setUiListVisibleByItem([this.leftbg,this.rightbg,this.title,this.taskmap,this.taskinfo,this.line,this.resui,this.rewardtitle,this.btn,this.openlev],!1),this.parent.setUiListVisibleByItem(this.rewardary,!1)},b}();a.TaskCell=b;var c=function(a){function c(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(c,a),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null},c.prototype.initUiAtlas=function(a){this._bgRender.uiAtlas=a,this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},c.prototype.initView=function(){this._baseRender;this.taskCellAry=new Array;for(var a=0;3>a;a++){var c=new b;c.parent=this,c.leftbg=this._bgRender.getComponent("leftbg0"),c.leftbg.isU=!0,c.rightbg=this._bgRender.getComponent("right0"),c.title=this._topRender.getComponent("a_name"+a),c.taskmap=this._baseRender.getComponent("a_task"+a+"0"),c.taskinfo=this._baseRender.getComponent("a_task"+a+"1"),c.line=this._baseRender.getComponent("a_task02"),c.resui=this._baseRender.getComponent("a_task"+a+"3"),c.unopened=this._baseRender.getComponent("a_task04"),c.rewardtitle=this._baseRender.getComponent("a_rewardtitle0"),c.rewardary=new Array;for(var d=0;3>d;d++)c.rewardary.push(this.addChild(this._baseRender.getComponent("a_reward"+a+d)));c.btn=this.addChild(this._baseRender.getComponent("a_btn0")),c.openlev=this.addChild(this._topRender.getComponent("a_openlev"+a)),this.taskCellAry.push(c)}this.ArrowAry=new Array,this.a_arrowleft=this.addEvntButUp("a_arrowleft",this._topRender),this.a_arrowleft.isU=!0,this.a_arrowright=this.addEvntButUp("a_arrowright",this._topRender),this.ArrowAry.push(this.a_arrowright),this.ArrowAry.push(this.a_arrowleft),this._topRender.applyObjData()},c.prototype.resize=function(){a.prototype.resize.call(this)},Object.defineProperty(c.prototype,"curpage",{get:function(){return this._curpage},set:function(a){1==a?this.setUiListVisibleByItem([this.ArrowAry[1]],!1):this.setUiListVisibleByItem([this.ArrowAry[1]],!0);var b=Math.ceil(this._itemAry.length/3);b==a?this.setUiListVisibleByItem([this.ArrowAry[0]],!1):this.setUiListVisibleByItem([this.ArrowAry[0]],!0),this._curpage=a,this.drawUI()},enumerable:!0,configurable:!0}),c.prototype.drawUI=function(){for(var a=0;3>a;a++){var b=3*(this.curpage-1)+a;b>this._itemAry.length-1?this.taskCellAry[a].clearUi():this.taskCellAry[a].setVo(this._itemAry[b],a)}},c.prototype.refreshServerData=function(){this._itemAry=training.TrainingModel.getInstance().getTaskvo(),this.drawUI()},c.prototype.refreshCurCardNum=function(){for(var a=0;a<this.taskCellAry.length;a++)this.taskCellAry[a].data&&this.taskCellAry[a].taskuidraw()},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this._itemAry=training.TrainingModel.getInstance().getTaskvo(),this.curpage=1,this.resize()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.a_arrowleft:this.curpage--;break;case this.a_arrowright:this.curpage++}},c}(UIVirtualContainer);a.DivineswordTask=c}(divinesword||(divinesword={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),divinesword;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._bgRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._redPointRender.dispose(),this._redPointRender=null,this.divineswordSkill&&(this.divineswordSkill.dispose(),this.divineswordSkill=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender.uiAtlas.setInfo("ui/uidata/training/training.xml","ui/uidata/training/training.png",function(){a.loadConfigCom()},"ui/uidata/training/trainingps.png")},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._bgRender.uiAtlas,this.initData(),this.resize(),this.applyLoadComplete()},c.prototype.initData=function(){this.TabAry=new Array;var a=this.addChild(this._bgRender.getComponent("tab2"));a.data=SharedDef.MODULE_GW_ALL,a.addEventListener(InteractiveEvent.Up,this.click,this),this.TabAry.push(a),this._redPointRender.getRedPointUI(this,127,new Vector2D(this.TabAry[0].x+this.TabAry[0].width-5,this.TabAry[0].y));var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(b,"rightLinebg",this._bgRender),this.UnlockUIAry=new Array,this.t_unlock2=this.addEvntBut("t_unlock2",this._bgRender),this.UnlockUIAry.push(this.t_unlock2),this.winmidRender.applyObjData(),this.addUIList(["a_tittle_name"],this._bgRender),this.addUIList(["t_bgline"],this._baseRender)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.refreshOpenLev=function(){GuidData.player.getsyspageopen(SharedDef.MODULE_GW,SharedDef.MODULE_GW_ALL)?(this.setUiListVisibleByItem([this.TabAry[0]],!0),this.setUiListVisibleByItem([this.UnlockUIAry[0]],!1)):(this.setUiListVisibleByItem([this.TabAry[0]],!1),this.setUiListVisibleByItem([this.UnlockUIAry[0]],!0),this.UnlockUIAry[0].data=tb.TB_system_base.getTempVo(10*SharedDef.MODULE_GW+SharedDef.MODULE_GW_ALL))},c.prototype.show=function(a){this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.refreshOpenLev(),this.selectedTab(SharedDef.MODULE_GW_ALL)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.hideTabPage(),ModulePageManager.hideResTittle()},c.prototype.selectedTab=function(a){this._lastvalue=a,this.TabAry[0].selected=!0,this.hideTabPage(a),this.showTabPage(a)},c.prototype.showTabPage=function(b){switch(b){case SharedDef.MODULE_GW_ALL:this.divineswordSkill||(this.divineswordSkill=new a.DivineswordSkill,this.divineswordSkill.parent=this,this.divineswordSkill.initUiAtlas(this._bgRender.uiAtlas,this.winmidRender)),this.divineswordSkill.show()}},c.prototype.hideTabPage=function(a){switch(void 0===a&&(a=-1),a){case SharedDef.MODULE_GW_ALL:this.divineswordSkill&&this.divineswordSkill.hide();break;default:this.divineswordSkill&&this.divineswordSkill.hide()}},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.DivineswordEvent(a.DivineswordEvent.HIDE_TRAINING_PANEL));break;case this.t_unlock2:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock2.data.level+"级后解锁",99)}},c.prototype.click=function(a){this.selectedTab(a.target.data),UIManager.popClikNameFun(a.target.name)},c}(WindowUi);a.DivineswordUiPanel=b}(divinesword||(divinesword={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),divinesword;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"DivineswordModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.DivineswordModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_TRAINING_PANEL="SHOW_TRAINING_PANEL",b.HIDE_TRAINING_PANEL="HIDE_TRAINING_PANEL",b.REFRESH_SKILL_PANEL="REFRESH_SKILL_PANEL",b}(BaseEvent);a.DivineswordEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"DivineswordProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_TRAINING_PANEL&&this.showPanel(b.data),b.type==c.HIDE_TRAINING_PANEL&&this.hidePanel(),b.type==c.REFRESH_SKILL_PANEL&&this.divineswordUiPanel&&this.divineswordUiPanel.divineswordSkill&&this.divineswordUiPanel.hasStage&&this.divineswordUiPanel.divineswordSkill.refreshLev()}if(a instanceof EngineEvent){var d=a;d.type==EngineEvent.SYSTEM_OPEN_EVENT?this.refreshNode():d.type==EngineEvent.CORE_DATA_COMPLETE_EVENT?this.initNode():d.type==EngineEvent.MONEY_CHANGE?(this.refreshNode(),this.divineswordUiPanel&&this.divineswordUiPanel.divineswordSkill&&this.divineswordUiPanel.divineswordSkill.hasStage&&this.divineswordUiPanel.divineswordSkill.updataRes()):d.type==EngineEvent.PLAYER_FIELD_LEVEL&&this.divineswordUiPanel&&this.divineswordUiPanel.refreshOpenLev()}if(a instanceof skillUi.SkillUiEvent){var e=a;e.type==skillUi.SkillUiEvent.SKILL_UP_EVENT&&this.showSkillUpEff()}if(a instanceof mountui.MountUiEvent){var f=a;f.type==mountui.MountUiEvent.MOUNT_LEVET_STAR_CHANGE_EVENT&&this.refreSel()}if(a instanceof wing.WingEvent){var g=a;g.type==wing.WingEvent.WING_ID_CHANG_EVENT&&this.refreSel()}if(a instanceof UIPanelEvent){var h=a;h.panel==this.divineswordUiPanel&&(this.divineswordUiPanel.dispose(),this.divineswordUiPanel=null,console.log("释放面板 trainingUiPanel"))}},d.prototype.refreSel=function(){this.divineswordUiPanel&&this.divineswordUiPanel.divineswordSkill&&this.divineswordUiPanel.divineswordSkill.refreshSel()},d.prototype.showSkillUpEff=function(){this.divineswordUiPanel&&this.divineswordUiPanel.divineswordSkill&&this.divineswordUiPanel.divineswordSkill.hasStage&&this.divineswordUiPanel.divineswordSkill.showSkillUpEff()},d.prototype.initNode=function(){for(var a=tb.TB_adventure_skill_base.get_TB_quest_adventure_base(),b=RedPointManager.getInstance().getNodeByID(128),c=0;c<a.length;c++){var d=new RedPointNode;d.data=a[c],b.addChild(d)}this.refreshNode()},d.prototype.refreshNode=function(){GuidData.player.getsyspageopen(SharedDef.MODULE_GW,SharedDef.MODULE_GW_ALL)&&GuidData.player.isOpenSystemNeedShow(SharedDef.MODULE_GW)&&(this.refreshNodeByID(128),this.divineswordUiPanel&&this.divineswordUiPanel.divineswordSkill&&this.divineswordUiPanel.divineswordSkill.hasStage&&this.divineswordUiPanel.divineswordSkill.refreshredpoint())},d.prototype.refreshNodeByID=function(a){for(var b=RedPointManager.getInstance().getNodeByID(a).children,c=0;c<b.length;c++){var d=b[c].data;d.prev_limit[0]?training.TrainingModel.getInstance().getprev_limitflag(d.prev_limit[0])?b[c].show=this.hasResEnough(d):b[c].show=!1:b[c].show=this.hasResEnough(d)}},d.prototype.hasResEnough=function(a){var b=GuidData.player.getPassiveSkillLev(a.id),c=TableData.getInstance().getData(TableData.tb_skill_base,a.id),d=tb.TB_skill_uplevel.get_TB_skill_uplevel(c.uplevel_id[0]+b);if(b>c.uplevel_id[1]-c.uplevel_id[0]&&(d=null),null==d)return!1;var e=a.cost[0];return b>0&&(e=tb.TB_skill_uplevel.get_TB_skill_uplevel(c.uplevel_id[0]+b-1).uplevel_cost[0]),hasEnoughRes(e)?!0:!1},d.prototype.hidePanel=function(){this.divineswordUiPanel&&this.divineswordUiPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.divineswordUiPanel||(this.divineswordUiPanel=new a.DivineswordUiPanel),this.divineswordUiPanel.load(function(){console.log("--$data---",b),c.divineswordUiPanel.show(b);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_GW,ModuleEventManager.dispatchEvent(a)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_TRAINING_PANEL),new c(c.HIDE_TRAINING_PANEL),new c(c.REFRESH_SKILL_PANEL),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new skillUi.SkillUiEvent(skillUi.SkillUiEvent.SKILL_UP_EVENT),new mountui.MountUiEvent(mountui.MountUiEvent.MOUNT_LEVET_STAR_CHANGE_EVENT),new wing.WingEvent(wing.WingEvent.WING_ID_CHANG_EVENT)]},d}(BaseProcessor);a.DivineswordProcessor=d}(divinesword||(divinesword={}));var logingift;!function(a){var b=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getnearday=function(){for(var a=GuidData.player.getLogingiftReward(),b=0;b<a.length;b++)if(!a[b]){var c=tb.TB_login_activity_reward.get_TB_login_activity_rewardById(b+1);return c.indx}},a.prototype.getList=function(){for(var a=new Array,b=GuidData.player.getLogingiftDay(),d=tb.TB_login_activity_reward.get_TB_login_activity_reward(),e=GuidData.player.getLogingiftReward(),f=0;f<d.length;f++){var g=new c;g.data=d[f],b>=d[f].day?e[f]?g.state=3:g.state=1:g.state=2,a.push(g)}return a.sort(function(a,b){return a.state==b.state?a.data.id-b.data.id:a.state-b.state}),a},a.prototype.isVisiable=function(){for(var a=this.getList(),b=0;b<a.length;b++)if(3!=a[b].state)return!0;return!1},a}();a.LogingiftModel=b;var c=function(){function a(){}return a}();a.LogingiftVo=c}(logingift||(logingift={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),logingift;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a._lastMouseX=0,a._lastRoleRotatioinY=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baImg=new UIBackImg,a._baImg.setImgInfo("ui/uidata/basebg/skillbg.png",128,64),a.addRender(a._baImg),a._publicbgRender=new UIRenderComponent,a.addRender(a._publicbgRender),a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(d,b),d.prototype.dispose=function(){this._baImg.dispose(),this._baImg=null,this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null},d.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a._publicbgRender.uiAtlas=b,a._baseRender.uiAtlas.setInfo("ui/uidata/logingift/logingift.xml","ui/uidata/logingift/logingift.png",function(){a.loadConfigCom()},"ui/uidata/logingift/logingiftpc.png")})},d.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._baseRender.uiAtlas,this._topRender.uiAtlas=this._baseRender.uiAtlas;var a=this._baseRender;this.t_rightbg2_1=this.addChild(this._publicbgRender.getComponent("t_rightbg2")),this.setUiSizeByName(this.t_rightbg2_1,"bg"),this.b_close=this.addEvntBut("b_close",this._publicbgRender),this.setUiSizeByName(this.b_close,"close"),this.addChild(this._bgRender.getComponent("a_18_0"));var b=this.addChild(this._bgRender.getComponent("a_18_3"));b.isU=!0,b.isV=!0;var c=this.addChild(this._bgRender.getComponent("a_18_2"));c.isV=!0;var d=this.addChild(this._bgRender.getComponent("a_18_1"));d.isU=!0,this.addUIList(["line","a_18_0"],this._bgRender),this.a_info=this.addChild(this._topRender.getComponent("a_info")),this.a_receiveday=this.addChild(this._topRender.getComponent("a_receiveday")),this.a_name=this.addChild(this._topRender.getComponent("a_name")),this.btn_up=this.addEvntBut("btn_up",a),this.btn_down=this.addEvntBut("btn_down",a),this.addUIList(["a_2","a_4","a_1","a_3"],a),this.role=this.addChild(a.getComponent("role")),this.role.isVirtual=!0,this.role.addEventListener(InteractiveEvent.Down,this.A_left_bg_MouseDown,this),this.addPersonChar(),this.applyLoadComplete()},d.prototype.setUiSizeByName=function(a,b){var c=this._bgRender.getComponent(b);a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData(),this.logingiftList||(this.logingiftList=new c,this.logingiftList.init(this._baseRender.uiAtlas)),this.logingiftList.show(),this.resize()},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d.prototype.resize=function(){b.prototype.resize.call(this),this.logingiftList&&(this.logingiftList.left=this.t_rightbg2_1.parent.x/UIData.Scale+this.t_rightbg2_1.x+8,this.logingiftList.top=this.t_rightbg2_1.parent.y/UIData.Scale+this.t_rightbg2_1.y+6),this.resizeRole()},d.prototype.butClik=function(b){switch(b.target){case this.b_close:console.log("b_close"),ModuleEventManager.dispatchEvent(new a.LogingiftEvent(a.LogingiftEvent.HIDE_Logingift_EVENT));break;case this.btn_up:if(1==this._indx)return;this._indx--,this.drawView();break;case this.btn_down:var c=tb.TB_login_activity_preview.get_TB_login_activity_preview();if(this._indx==c[c.length-1].id)return;this._indx++,this.drawView()}},d.prototype.resetData=function(){ArtFont.getInstance().writeFontToSkinNameCenter(this._baseRender.uiAtlas,"A_curday",String(GuidData.player.getLogingiftDay()),ArtFont.num7,5),this._indx=a.LogingiftModel.getInstance().getnearday(),this.drawView()},d.prototype.drawView=function(){var a=tb.TB_login_activity_preview.get_TB_login_activity_previewById(this._indx);this.drawName(this.a_name,getload_LogingiftUrl(a.preview_name)),ArtFont.getInstance().writeFontToSkinNameCenter(this._baseRender.uiAtlas,this.a_receiveday.skinName,String(a.day),ArtFont.num26,5),this.drawName(this.a_info,getload_LogingiftInfoUrl(a.preview_info)),1==a.type?(this.showDisPlay.showAvatarVisibel=!1,this.showDisPlay.setAvatar(6302),this.showDisPlay.setWeaponByAvatar(a.preview_model),this._scale=4,this._posy=-40):(this.showDisPlay.showAvatarVisibel=!0,this.showDisPlay.removePart(SceneChar.WEAPON_PART),this.showDisPlay.setAvatar(a.preview_model),this._scale=3,this._posy=-110),this.resizeRole()},d.prototype.drawName=function(a,b){var c=this;IconManager.getInstance().getIcon(b,function(b){var d=c._baseRender.uiAtlas.getRec(a.skinName),e=UIManager.getInstance().getContext2D(d.pixelWitdh,d.pixelHeight,!1);e.drawImage(b,0,0,b.width,b.height,d.pixelWitdh/2-b.width/2,d.pixelHeight-b.height,b.width,b.height),c._baseRender.uiAtlas.updateCtx(e,d.pixelX,d.pixelY)})},d.prototype.addPersonChar=function(){var a=this;this.showDisPlay=new Person2DChar,this._baseRender.addModel(this.showDisPlay),this._rotationFun=function(b){a.rotationRole()}},d.prototype.A_left_bg_MouseDown=function(a){this._lastMouseX=a.x,this._lastRoleRotatioinY=this.showDisPlay.rotationY,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},d.prototype.A_left_bg_MouseMove=function(a){this.showDisPlay.rotationY=this._lastRoleRotatioinY-(a.x-this._lastMouseX)},d.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},d.prototype.rotationRole=function(){this.showDisPlay.rotationY-=.5},d.prototype.resizeRole=function(){this.showDisPlay&&(this.showDisPlay.resize(),this.showDisPlay.scale=this._scale*UIData.Scale,this.showDisPlay.rotationY=0,this.showDisPlay.y=this._posy*UIData.Scale,this.showDisPlay.x=205*UIData.Scale)},d}(UIPanel);a.LogingiftUiPanel=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=351,a.top=75,a}return __extends(c,b),c.prototype.init=function(a){d.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,602,465,0,86,5,512,512,1,7)},c.prototype.refreshDataByNewData=function(){var b=a.LogingiftModel.getInstance().getList(),c=this.getData(b);this.refreshData(c)},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.LogingiftList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(c,d,e,f){void 0===f&&(f=null),a.prototype.create.call(this,c,d,e,f),this.Day=this.creatSUI(e,b.baseAtlas,"Day",30,29,81,23),c.addChild(this.Day),this._ary=new Array,this.Reward0=this.creatSUI(e,b.baseAtlas,"Reward0",124,8,64,64),c.addChild(this.Reward0),this.Reward0.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.Reward0),this.Reward1=this.creatSUI(e,b.baseAtlas,"Reward1",194,8,64,64),c.addChild(this.Reward1),this.Reward1.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.Reward1),this.Reward2=this.creatSUI(e,b.baseAtlas,"Reward2",264,8,64,64),c.addChild(this.Reward2),this.Reward2.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.Reward2),this.Reward3=this.creatSUI(e,b.baseAtlas,"Reward3",334,8,64,64),c.addChild(this.Reward3),this.Reward3.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.Reward3),this.Reward4=this.creatSUI(e,b.baseAtlas,"Reward4",404,8,64,64),c.addChild(this.Reward4),this.Reward4.addEventListener(InteractiveEvent.Up,this.equClick,this),this._ary.push(this.Reward4),this.Btn=this.creatSUI(e,b.baseAtlas,"Btn",489,23,98,36),c.addChild(this.Btn),this.Btn.addEventListener(InteractiveEvent.Up,this.btnChick,this),this.Itembg=this.creatGrid9SUI(d,b.baseAtlas,"Itembg",0,0,601,80,20,20),c.addChild(this.Itembg)},b.prototype.drawIcon=function(a){var b=this,c=this.itdata.data,d=a.data;IconManager.getInstance().getIcon(GameData.getIconCopyUrl(d[0]),function(d){var e=b._baseRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.A_BLACK_F,new Rectangle(0,0,64,64),UIData.publicUi),f.drawImage(d,0,0,60,60,2,2,60,60),1==c.state?UiDraw.cxtDrawImg(f,PuiData.A_HIGHT_F,new Rectangle(0,0,64,64),UIData.publicUi):3==c.state&&UIManager.getInstance().makeCtxToGray(f,new Rectangle(0,0,64,64)),b._baseRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},b.prototype.drawBtn=function(){var a=this.itdata.data,c=this._baseRender.uiAtlas.getRec(this.Btn.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),e=b.baseAtlas.getRec(String(a.state));d.drawImage(b.baseAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,0,e.pixelWitdh,e.pixelHeight),this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},b.prototype.drawTitle=function(){var a=this.itdata.data,c=this._baseRender.uiAtlas.getRec(this.Day.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1),e=b.baseAtlas.getRec("Di");d.drawImage(b.baseAtlas.useImg,e.pixelX,e.pixelY,e.pixelWitdh,e.pixelHeight,0,0,e.pixelWitdh,e.pixelHeight);var f=ArtFont.getInstance().getAirFontWidth(d,String(a.data.day),ArtFont.num26,5);ArtFont.getInstance().writeFontToCtxLeft(d,String(a.data.day),ArtFont.num26,23,0,5);var g=b.baseAtlas.getRec("Tian");d.drawImage(b.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,f+26,0,g.pixelWitdh,g.pixelHeight),this._baseRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)},b.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){for(var a=this.itdata.data,b=0;5>b;b++)b<a.data.reward.length?(this._ary[b].data=a.data.reward[b],this.drawIcon(this._ary[b])):(this._ary[b].data=null,LabelTextFont.writeSingleLabel(this.uiAtlas,this._ary[b].skinName,"",16,TextAlign.LEFT,"#d6e7ff"));this.drawTitle(),this.drawBtn(),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.Itembg.skinName,UIData.publicUi,PuiData.ITEMBG)}},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},b.prototype.equClick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)){var b=a.target.data;if(b&&b.length>0){var c=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_ID_EVENT);c.id=b[0],ModuleEventManager.dispatchEvent(c)}}},b.prototype.btnChick=function(a){if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data){var b=this.itdata.data;1==b.state&&NetManager.getInstance().protocolos.get_login_activity_reward(b.data.id)}},b.prototype.setnull=function(){LabelTextFont.clearLabel(this.uiAtlas,this.Day.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Reward0.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Reward1.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Reward2.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Reward3.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Reward4.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Btn.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.Itembg.skinName)},b}(SListItem);a.LogingiftListRender=d}(logingift||(logingift={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),logingift;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"LogingiftModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.LogingiftModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_Logingift_EVENT="SHOW_Logingift_EVENT",b.HIDE_Logingift_EVENT="HIDE_Logingift_EVENT",b.REFRESH_Logingift_EVENT="REFRESH_Logingift_EVENT",b}(BaseEvent);a.LogingiftEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"LogingiftProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_Logingift_EVENT?this.showUi(b.data):b.type==c.REFRESH_Logingift_EVENT?this.refresh():b.type==c.HIDE_Logingift_EVENT&&this.hideUi()}if(a instanceof UIPanelEvent){var d=a;d.panel==this._logingiftUiPanel&&(this._logingiftUiPanel.dispose(),this._logingiftUiPanel=null,console.log("释放面板 _logingiftUiPanel"))}},d.prototype.refresh=function(){this._logingiftUiPanel&&this._logingiftUiPanel.hasStage&&this._logingiftUiPanel.resetData(),this._logingiftUiPanel&&this._logingiftUiPanel.logingiftList&&this._logingiftUiPanel.logingiftList.hasStage&&this._logingiftUiPanel.logingiftList.refreshDataByNewData()},d.prototype.hideUi=function(){this._logingiftUiPanel.hide(),SceneManager.getInstance().render=!0,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT))},d.prototype.showUi=function(b){var c=this;this._logingiftUiPanel||(this._logingiftUiPanel=new a.LogingiftUiPanel),this._logingiftUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),c._logingiftUiPanel.show()})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_Logingift_EVENT),new c(c.HIDE_Logingift_EVENT),new c(c.REFRESH_Logingift_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.LogingiftProcessor=d}(logingift||(logingift={}));var adventure;!function(a){var b=function(){function a(){
this.initData()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.initData=function(){},a.prototype.getPlayCurId=function(){var a=0,b=GuidData.player.getPlayerIntFieldTrialFinishedSectionid();if(0==b)a=tb.TB_risk_base.get_TB_risk_base(1).firstSection;else{var c=tb.TB_risk_data.get_TB_risk_data(b);a=c.nextId>0?c.nextId:c.id}return a},a.prototype.getCurTb=function(){return tb.TB_risk_data.get_TB_risk_data(this.getPlayCurId())},a.prototype.getCurBossTb=function(){return tb.TB_risk_data.get_TB_risk_data(this.getPlayCurId()+1e6)},a}();a.AdventureModel=b}(adventure||(adventure={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventuremap;!function(a){var b=function(){function a(){}return a.prototype.draw=function(a){var b=this;LoadManager.getInstance().load(Scene_data.fileRoot+"ui/load/map/world/"+this.tb_world_map.mapid+".png",LoadManager.IMG_TYPE,function(c){var d=b.pic.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);e.drawImage(c,0,0,c.width,c.height,(d.width-c.width)/2,(d.height-c.height)/2,c.width,c.height),b.tb_map.levellimit>GuidData.player.getLevel()&&UIManager.getInstance().makeCtxToGray(e,new Rectangle(0,0,d.width,d.height)),b.pic.drawToCtx(a,e)}),this.drawLabel(a)},a.prototype.drawLabel=function(a){var b=this.w_title.getSkinCtxRect(),c=UIManager.getInstance().getContext2D(b.width,b.height,!1);LabelTextFont.writeSingleLabelToCtx(c,ColorType.colorffe9b4+this.tb_map.name,16),this.w_title.drawToCtx(a,c);var b=this.w_info.getSkinCtxRect(),c=UIManager.getInstance().getContext2D(b.width,b.height,!1);if(LabelTextFont.writeSingleLabelToCtxByVertical(c,ColorType.colorffe9b4+this.tb_world_map.info,14),this.w_info.drawToCtx(a,c),this.tb_map.levellimit>GuidData.player.getLevel()){var b=this.w_openlev.getSkinCtxRect(),c=UIManager.getInstance().getContext2D(b.width,b.height,!1);LabelTextFont.writeSingleLabelToCtx(c,ColorType.Whiteffffff+"LV"+this.tb_map.levellimit+"解锁",16),this.w_openlev.drawToCtx(a,c)}},a.prototype.getSelectTbname=function(){for(var a="",b=0;b<this.tb_world_map.info.length;b++)a+=this.tb_world_map.info.substr(b,1),a+="\n";return this.tb_world_map.info.length<4&&(a="\n"+a),console.log(a),a},a}();a.MapClikVo=b;var c=function(c){function d(){var a=c.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(d,c),d.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null},d.prototype.initUiAtlas=function(a){var b=this;this._bottomRender.uiAtlas=a,this._topRender.uiAtlas=a,this._midRender.uiAtlas=a,this._curUi=this.addChild(this._topRender.getComponent("w_cur")),this.resetPicData(),this._updateFun=function(){b.updateY()}},d.prototype.resetPicData=function(){var a=tb.TB_world_map.getItem();this.wIconItem=new Array;for(var c=0;c<a.length;c++){var d=new b;d.tb_world_map=a[c],d.tb_map=tb.TB_map.getTB_map(a[c].mapid),d.id=c,d.w_titlebg=this._bottomRender.getComponent("w_titlebg"),d.w_titlebg.goToAndStop(d.tb_map.is_PK),this.addChild(d.w_titlebg),d.pic=this.addEvntButUp("w_icon",this._bottomRender),d.pic.data=d,d.pic.goToAndStop(c),d.w_title=this.addChild(this._midRender.getComponent("w_title")),d.w_title.goToAndStop(c),d.w_infobg=this.addChild(this._bottomRender.getComponent("w_infobg")),d.w_info=this.addChild(this._midRender.getComponent("w_info")),d.w_info.goToAndStop(c),d.pic.x=.95*d.tb_world_map.x-35,d.pic.y=.95*d.tb_world_map.y-40,d.w_titlebg.x=d.pic.x+22,d.w_titlebg.y=d.pic.y+d.pic.height,d.w_title.x=d.w_titlebg.x+18,d.w_title.y=d.w_titlebg.y+1,d.w_infobg.x=d.pic.x+d.pic.width-10,d.w_infobg.y=d.pic.y,d.w_info.x=d.w_infobg.x+5,d.w_info.y=d.w_infobg.y,d.tb_map.levellimit>GuidData.player.getLevel()&&(d.w_openlev=this.addChild(this._topRender.getComponent("w_openlev")),d.w_openlev.goToAndStop(c),d.w_openbg=this.addChild(this._midRender.getComponent("w_openbg")),d.w_openbg.x=d.pic.x+38,d.w_openbg.y=d.pic.y+31,d.w_openlev.x=d.w_openbg.x+4,d.w_openlev.y=d.w_openbg.y+5),this.wIconItem.push(d)}},d.prototype.butClik=function(c){switch(c.target){default:if(c.target.data instanceof b){var d=c.target.data;d.tb_world_map.mapid!=GuidData.map.tbMapVo.id&&d.tb_map.levellimit<=GuidData.player.getLevel()?d.tb_map.is_PK?AlertUtil.show(ColorType.Brown7a2f21+"当前前往地图为PVP地图，可能会被家族外的其他玩家攻击，是否继续前往？","提示",function(b){1==b&&(ModuleEventManager.dispatchEvent(new a.AdventureMapEvent(a.AdventureMapEvent.HIDE_ADVENTURE_MAP_PANEL)),NetManager.getInstance().protocolos.teleport_map(d.tb_world_map.mapid,GuidData.map.getLineID()))},2,["是","否"]):(ModuleEventManager.dispatchEvent(new a.AdventureMapEvent(a.AdventureMapEvent.HIDE_ADVENTURE_MAP_PANEL)),NetManager.getInstance().protocolos.teleport_map(d.tb_world_map.mapid,GuidData.map.getLineID())):console.log("当前地图不传")}}},d.prototype.hide=function(){this._updateFun&&TimeUtil.removeFrameTick(this._updateFun),UIManager.getInstance().removeUIContainer(this)},d.prototype.show=function(){this.setUiListVisibleByItem([this._curUi],!1);for(var a=0;a<this.wIconItem.length;a++)this.wIconItem[a].draw(this._topRender.uiAtlas),this.wIconItem[a].tb_map.id==GuidData.map.tbMapVo.id&&(this.setUiListVisibleByItem([this._curUi],!0),this._curUi.x=this.wIconItem[a].pic.x+51,this._curUi.y=this.wIconItem[a].pic.y,this._lastY=this._curUi.y,TimeUtil.addFrameTick(this._updateFun));UIManager.getInstance().addUIContainer(this);var b=this.parent.loadBigPicByUrl("ui/load/map/bigworld.jpg");b.width=826,b.height=451},d.prototype.onRemove=function(){c.prototype.onRemove.call(this),this._updateFun&&TimeUtil.removeFrameTick(this._updateFun)},d.prototype.updateY=function(){var a=5*Math.sin(TimeUtil.getTimer()/250);this._curUi&&(this._curUi.y=this._lastY+a)},d}(UIVirtualContainer);a.MapWorldPanel=c}(adventuremap||(adventuremap={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventuremap;!function(a){var b=function(){function a(){}return a}();a.AdventureMapVo=b;var c=function(c){function d(){var a=c.call(this)||this;return a.uiAtlasComplet=!1,a.passUiItem=new Array,a.pageId=-1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(d,c),d.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null},d.prototype.initUiAtlas=function(a){this._bottomRender.uiAtlas=a,this._topRender.uiAtlas=a,this._midRender.uiAtlas=a,this.addChild(this._bottomRender.getComponent("a_txt_bg_exp")),this.addChild(this._bottomRender.getComponent("a_txt_bg_map_name")),this.addChild(this._midRender.getComponent("a_info_txt")),this.a_map_name=this.addChild(this._topRender.getComponent("a_map_name")),this.a_money_txt=this.addChild(this._topRender.getComponent("a_money_txt")),this.a_exp_txt=this.addChild(this._topRender.getComponent("a_exp_txt")),this.a_equ_txt=this.addChild(this._topRender.getComponent("a_equ_txt")),this.a_card_num=this.addChild(this._topRender.getComponent("a_card_num")),this.a_card_num_bg=this.addChild(this._midRender.getComponent("a_card_num_bg")),this.a_attact_now=this.addEvntButUp("a_attact_now",this._topRender),this.a_adventure_time=this.addChild(this._topRender.getComponent("a_adventure_time")),this.a_page_but_left=this.addEvntButUp("a_page_but_left",this._topRender),this.a_page_but_right=this.addEvntButUp("a_page_but_right",this._topRender),this.a_page_but_right.isU=!0,this.mapIconUiList=new Array;for(var c=0;5>c;c++){var d=new b;d.idex=c,d.pic=this.addChild(this._midRender.getComponent("a_chart_frame")),d.pic.goToAndStop(c),d.tittle=this.addChild(this._topRender.getComponent("a_tittle_frame")),d.tittle.goToAndStop(c),d.bg=this.addChild(this._bottomRender.getComponent("a_pic_tittle_bg")),this.mapIconUiList.push(d)}this.a_rank_but=this.addEvntButUp("a_rank_but",this._topRender),this.a_enter_but=this.addEvntButUp("a_enter_but",this._topRender),this.a_guaji=this.addChild(this._topRender.getComponent("a_guaji")),this.uiAtlasComplet=!0},d.prototype.drawLabelTittle=function(a,b){var c=a.getSkinCtxRect(),d=UIManager.getInstance().getContext2D(c.width,c.height,!1);LabelTextFont.writeSingleLabelToCtx(d,ColorType.Whitefffce6+b,16,0,0,TextAlign.CENTER),a.drawToCtx(this._topRender.uiAtlas,d)},d.prototype.drawMapIcon=function(a,b){var c=this,d=b.chapterId,e=5*this.pageId,f=tb.TB_risk_chapter.get_TB_risk_chapter(a.idex+e+1);this.setUpost(a,f.iconpos),this.drawLabelTittle(a.tittle,f.name);var g="ui/load/map/world/"+f.icon+".png";if(g=f.id<d+1?"ui/load/adventure/icon/1.png":"ui/load/adventure/icon/2.png",LoadManager.getInstance().load(Scene_data.fileRoot+g,LoadManager.IMG_TYPE,function(b){var e=a.pic.getSkinCtxRect(),g=UIManager.getInstance().getContext2D(e.width,e.height,!1);g.drawImage(b,0,0,e.width,e.height),f.id>d+1,a.pic.drawToCtx(c._topRender.uiAtlas,g)}),f.id<d){var h=this.addChild(this._topRender.getComponent("a_pass_icon"));h.x=f.iconpos[0]-30,h.y=f.iconpos[1]-10,this.passUiItem.push(h)}if(f.id==d){this.a_attact_now.x=f.iconpos[0]-30,this.a_attact_now.y=f.iconpos[1]-75,this.a_guaji.x=f.iconpos[0]-50,this.a_guaji.y=f.iconpos[1]-15,this.a_card_num.x=f.iconpos[0]-55+10,this.a_card_num.y=f.iconpos[1]+20-10,this.a_card_num_bg.x=this.a_card_num.x,this.a_card_num_bg.y=this.a_card_num.y;var i=tb.TB_risk_menu.get_TB_risk_menu(d).count;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_card_num.skinName,ColorType.Green98ec2c+"关卡"+b.cardId+"/"+i,15,TextAlign.CENTER)}},d.prototype.setUpost=function(a,b){a.pic.x=b[0]-50,a.pic.y=b[1]-50,a.tittle.x=a.pic.x,a.tittle.y=a.pic.y+90,a.bg.x=a.pic.x-10,a.bg.y=a.pic.y+60},d.prototype.refresh=function(){for(UIManager.getInstance().addUIContainer(this);this.passUiItem.length;)this.removeChild(this.passUiItem.pop());this.a_attact_now.x=-1e3,this.a_attact_now.y=0,this.a_guaji.x=-1e3,this.a_guaji.y=0,this.a_card_num.x=-1e3,this.a_card_num.y=0,this.a_card_num_bg.x=-1e3,this.a_card_num_bg.y=0;var a=adventure.AdventureModel.getInstance().getCurTb();-1==this.pageId&&(this.pageId=Math.floor((a.chapterId-1)/5)),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_map_name.skinName,ColorType.Yellowffe9b4+a.name,16,TextAlign.CENTER);var b=360*a.expReward[1];LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_exp_txt.skinName,b+"/小时 ",14,TextAlign.RIGHT,ColorType.Green98ec2c,ColorType.colord27262e);var c=360*a.goldReward[1];LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_money_txt.skinName,c+"/小时",14,TextAlign.RIGHT,ColorType.Green98ec2c,ColorType.colord27262e);var d=Math.ceil(360*a.suitScore/a.suitScoreChange);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_equ_txt.skinName,d+"件/小时",14,TextAlign.RIGHT,ColorType.Green98ec2c,ColorType.colord27262e),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_adventure_time.skinName,getvipadd("riskReward"),16,TextAlign.CENTER,ColorType.Yellowffe9b4,ColorType.colord27262e);for(var e=0;e<this.mapIconUiList.length;e++)this.drawMapIcon(this.mapIconUiList[e],a);var f=(GuidData.player.getPlayerIntFiledLeaveRiskPicked(),GuidData.player.getPlaerExpAndIntLastLogoutTime());this.leaveTime=TimeUtil.getTimer()+1e3*GameInstance.getGameSecond(f);var g=this.parent.loadBigPicByUrl("ui/load/adventure/"+(this.pageId+1)+".jpg");g.width=826,g.height=451,this.setUiListVisibleByItem([this.a_page_but_left],this.pageId>0);var h=tb.TB_risk_chapter.getItem().length;this.setUiListVisibleByItem([this.a_page_but_right],this.pageId<h/5-1)},d.prototype.butClik=function(b){switch(b.target){case this.a_page_but_left:UiTweenScale.getInstance().changeButSize(b.target),this.pageId>0&&(this.pageId--,this.refresh());break;case this.a_page_but_right:UiTweenScale.getInstance().changeButSize(b.target),this.pageId<tb.TB_risk_chapter.getItem().length/5&&(this.pageId++,this.refresh());break;case this.a_attact_now:case this.a_enter_but:UIManager.popClikNameFun(this.a_enter_but.name),ModuleEventManager.dispatchEvent(new a.AdventureMapEvent(a.AdventureMapEvent.HIDE_ADVENTURE_MAP_PANEL)),console.log("=================enter_risk_instance"),NetManager.getInstance().protocolos.enter_risk_instance();break;case this.a_rank_but:UiTweenScale.getInstance().changeButSize(b.target),NetManager.getInstance().protocolos.risk_get_rank()}},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d}(UIVirtualContainer);a.AdventureMapPanel=c}(adventuremap||(adventuremap={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventuremap;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"AdventureMapModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.AdventureMapModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_ADVENTURE_MAP_PANEL="SHOW_ADVENTURE_UI_PANEL",b.HIDE_ADVENTURE_MAP_PANEL="HIDE_ADVENTURE_UI_PANEL",b}(BaseEvent);a.AdventureMapEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"AdventureMapProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_ADVENTURE_MAP_PANEL&&this.showPanel(b.data),b.type==c.HIDE_ADVENTURE_MAP_PANEL&&this.hidePanel()}a.type==EngineEvent.PLAYER_FIELD_LEVEL&&this.worldAdventureUiPanel&&this.worldAdventureUiPanel.refreshOpenLev()},d.prototype.hidePanel=function(){this.worldAdventureUiPanel&&this.worldAdventureUiPanel.hide()},d.prototype.showPanel=function(b){var c=this;this.worldAdventureUiPanel||(this.worldAdventureUiPanel=new a.WorldAdventureUiPanel),this.worldAdventureUiPanel.load(function(){console.log("--$data---",b),b||(b=SharedDef.MODULE_TEST_RISK),c.worldAdventureUiPanel.show(b);var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_WORLD_RISK,ModuleEventManager.dispatchEvent(a)},!1)},d.prototype.showRank=function(a){var b=this,c=new s2c_risk_get_rank_result;s2c_risk_get_rank_result.read(c,a),this._rankPanle||(this._rankPanle=new WindowRankPanel);for(var d=new Array,e=0;e<c.list.length;e++){var f=new WindowRankVo,g=c.list[e].name;if(g){f.rank=String(e+1);var h=tb.TB_risk_data.get_TB_risk_data(c.list[e].value);f.val=h.name,f.name=getBaseName(g),f.isme=c.list[e].name==GuidData.player.getName(),d.push(f)}}for(var i="我的排名：未上榜",j=0;j<d.length;j++)if(d[j].isme){i="我的排名："+d[j].rank;break}this._rankPanle.load(function(){b._rankPanle.show(["排名","玩家名字","关卡"],d,i)})},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_RISK_GET_RANK_RESULT]=function(b){a.showRank(b)},b},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_ADVENTURE_MAP_PANEL),new c(c.HIDE_ADVENTURE_MAP_PANEL),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL)]},d}(BaseProcessor);a.AdventureMapProcessor=d}(adventuremap||(adventuremap={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventuremap;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._bgRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this.adventureMapPanel&&(this.adventureMapPanel.dispose(),this.adventureMapPanel=null),this.mapWorldPanel&&(this.mapWorldPanel.dispose(),this.mapWorldPanel=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this._bgRender.uiAtlas.setInfo("ui/uidata/adventure/adventuremap/adventuremap.xml","ui/uidata/adventure/adventuremap/adventuremap.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._bgRender.uiAtlas,this.initData(),this.resize(),this.applyLoadComplete()},c.prototype.initData=function(){this.TabAry=new Array;for(var a=0;2>a;a++){var b=this.addChild(this._bgRender.getComponent("tab"+a));b.data=2*a+1,b.addEventListener(InteractiveEvent.Up,this.click,this),this.TabAry.push(b)}var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(c,"rightLinebg",this._bgRender),this.UnlockUIAry=new Array,this.t_unlock0=this.addEvntBut("t_unlock0",this._bgRender),this.UnlockUIAry.push(this.t_unlock0),this.t_unlock1=this.addEvntBut("t_unlock1",this._bgRender),this.UnlockUIAry.push(this.t_unlock1),this.winmidRender.applyObjData(),this.addUIList(["a_tittle_name"],this._bgRender),this.addUIList(["t_bgline"],this._baseRender)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.refreshOpenLev=function(){for(var a=0;2>a;a++)GuidData.player.getsyspageopen(SharedDef.MODULE_TEST,2*a+1)?(this.setUiListVisibleByItem([this.TabAry[a]],!0),this.setUiListVisibleByItem([this.UnlockUIAry[a]],!1)):(this.setUiListVisibleByItem([this.TabAry[a]],!1),this.setUiListVisibleByItem([this.UnlockUIAry[a]],!0),this.UnlockUIAry[a].data=tb.TB_system_base.getTempVo(10*SharedDef.MODULE_TEST+2*a+1))},c.prototype.show=function(a){this.hasStage||(UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3])),this.refreshOpenLev(),this.selectedTab(a)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.hideTabPage(),ModulePageManager.hideResTittle()},c.prototype.selectedTab=function(a){this._lastvalue=a;for(var b=0;b<this.TabAry.length;b++)this.TabAry[b].data==a?this.TabAry[b].selected=!0:this.TabAry[b].selected=!1;this.hideTabPage(a),this.showTabPage(a)},c.prototype.showTabPage=function(b){switch(b){case SharedDef.MODULE_TEST_RISK:this.adventureMapPanel||(this.adventureMapPanel=new a.AdventureMapPanel,this.adventureMapPanel.initUiAtlas(this._bgRender.uiAtlas),this.adventureMapPanel.parent=this),this.adventureMapPanel.refresh();break;case SharedDef.MODULE_TEST_WORLD:this.mapWorldPanel||(this.mapWorldPanel=new a.MapWorldPanel,this.mapWorldPanel.initUiAtlas(this._bgRender.uiAtlas),this.mapWorldPanel.parent=this),this.mapWorldPanel.show()}},c.prototype.hideTabPage=function(a){switch(void 0===a&&(a=-1),a){case SharedDef.MODULE_TEST_RISK:this.mapWorldPanel&&this.mapWorldPanel.hide();break;case SharedDef.MODULE_TEST_WORLD:this.adventureMapPanel&&this.adventureMapPanel.hide();break;default:this.adventureMapPanel&&this.adventureMapPanel.hide(),this.mapWorldPanel&&this.mapWorldPanel.hide()}},c.prototype.butClik=function(b){switch(b.target){case this.w_close:ModuleEventManager.dispatchEvent(new a.AdventureMapEvent(a.AdventureMapEvent.HIDE_ADVENTURE_MAP_PANEL));break;case this.t_unlock0:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock0.data.level+"级后解锁",99);break;case this.t_unlock1:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"人物等级达到"+this.t_unlock1.data.level+"级后解锁",99)}},c.prototype.click=function(a){this.selectedTab(a.target.data),UIManager.popClikNameFun(a.target.name)},c}(WindowUi);a.WorldAdventureUiPanel=b}(adventuremap||(adventuremap={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventureinfo;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.endTime=0,b.lastTxtNum=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._midRender.uiAtlas=new UIAtlas,b.interfaceUI=!0,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/adventure/uplev/uplev.xml","ui/uidata/adventure/uplev/uplev.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){var a=this;this._bottomRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_bg")),this.a_time=this.addChild(this._midRender.getComponent("a_time")),this._attrary=new Array,this._nextattrary=new Array;for(var b=0;3>b;b++)this._attrary.push(this.addChild(this._midRender.getComponent("a_attr"+b))),this._nextattrary.push(this.addChild(this._midRender.getComponent("a_nextattr"+b)));this.tickFun=function(b){a.update(b)},this.applyLoadComplete()},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this._curtime=-1,this.endTime=TimeUtil.getTimer()+6e3,TimeUtil.addFrameTick(this.tickFun);var a=adventure.AdventureModel.getInstance().getCurTb(),b=360*a.expReward[1];LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this._nextattrary[0].skinName,b+"/小时 ",16,TextAlign.CENTER,ColorType.Green54db36,ColorType.colord27262e);var c=360*a.goldReward[1];LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this._nextattrary[1].skinName,c+"/小时 ",16,TextAlign.CENTER,ColorType.Green54db36,ColorType.colord27262e);var d=Math.ceil(360*a.suitScore/a.suitScoreChange);LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this._nextattrary[2].skinName,d+"件/小时",16,TextAlign.CENTER,ColorType.Green54db36,ColorType.colord27262e);var e=tb.TB_risk_data.get_TB_risk_data(a.parentid),f=360*e.expReward[1];LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this._attrary[0].skinName,f+"/小时 ",16,TextAlign.CENTER,ColorType.Whitefff7db,ColorType.colord27262e);var g=360*e.goldReward[1];LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this._attrary[1].skinName,g+"/小时 ",16,TextAlign.CENTER,ColorType.Whitefff7db,ColorType.colord27262e);var h=Math.ceil(360*e.suitScore/e.suitScoreChange);LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this._attrary[2].skinName,h+"件/小时",16,TextAlign.CENTER,ColorType.Whitefff7db,ColorType.colord27262e)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.update=function(a){if(this.hasStage){var b=Math.floor((this.endTime-TimeUtil.getTimer())/1e3);-1>=b?this.hide():b>=0&&this.lastTxtNum!=b&&(this.lastTxtNum=b,console.log(b),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_time.skinName,ColorType.Whitefff7db+getScencdStr(b)+"秒后自动关闭",14,TextAlign.CENTER))}else TimeUtil.removeFrameTick(this.tickFun)},b}(UIPanel);a.UplevfoPanel=b}(adventureinfo||(adventureinfo={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventureinfo;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a._autoplayflag=!1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.bottom=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a.interfaceUI=!0,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/adventure/adventurinfo/adventurinfo.xml","ui/uidata/adventure/adventurinfo/adventurinfo.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.unlockArray=new Array,this.a_unlockbtn=this.addEvntButUp("a_unlockbtn",this._topRender),this.unlockArray.push(this.a_unlockbtn),this.unlockArray.push(this._bottomRender.getComponent("a_bg")),this.unlockArray.push(this._topRender.getComponent("a_unlockinfo")),this.a_boss_but=this.addEvntButUp("a_boss_but",this._topRender),this.a_autoplay=this.addEvntButUp("a_autoplay",this._topRender),this.killInfoUiList=new Array,this.a_kill_info_bg=this.addChild(this._bottomRender.getComponent("a_kill_info_bg")),this.a_info_bar=this.addChild(this._midRender.getComponent("a_info_bar")),this.a_kill_info=this.addChild(this._topRender.getComponent("a_kill_info")),this.a_move_point=this.addChild(this._topRender.getComponent("a_move_point")),this.killInfoUiList.push(this.a_move_point),this.killInfoUiList.push(this.a_kill_info_bg),this.killInfoUiList.push(this.a_info_bar),this.killInfoUiList.push(this.a_kill_info),this.uiAtlasComplet=!0,this.buildFram()},c.prototype.butClik=function(a){switch(UiTweenScale.getInstance().changeButSize(a.target),a.target){case this.a_boss_but:UIManager.popClikNameFun("a_boss_but"),this.setUiListVisibleByItem([this.a_boss_but],!1),this.playEff(!1),TimeUtil.addTimeOut(100,this.showBossView);break;case this.a_unlockbtn:msgtip.MsgTipManager.outStr(ColorType.colorce0a00+this._curtb.level+"级开启本关BOSS挑战",99);break;case this.a_autoplay:this.setautoflag(!this._autoplayflag),this.refresh()}},c.prototype.setautoflag=function(a){this._autoplayflag=a,this.a_autoplay&&this.a_autoplay.goToAndStop(this._autoplayflag?1:0)},c.prototype.showBossView=function(){for(var a=adventure.AdventureModel.getInstance().getCurBossTb(),b=new Array,c=0;c<a.showitems.length;c++)b.push([a.showitems[c],1]);var d=a.bossId,e=tb.TB_creature_template.get_TB_creature_template(d),f=(a.name.replace("BOSS",e.name),new boss.BossEvent(boss.BossEvent.SHOW_BOSSVIEW_PANEL)),g=new boss.BossViewData;g.bossID=a.bossId,g.force=a.advisepoint,g.checkpoint=a.name,g.showRank=!1,g.rewardList=b,g.submitFun=function(){UIManager.popClikNameFun("t_btn"),NetManager.getInstance().protocolos.challange_boss(),console.log("请求挑战boss")},f.data=g,ModuleEventManager.dispatchEvent(f)},c.prototype.buildFram=function(){var a=this;this._frameRender?this.applyLoadComplete():(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ef_tzboss"),4,4,function(b){a.effui=b,a.effui.x=a.a_boss_but.x+5,a.effui.y=a.a_boss_but.y-33,a.effui.width=1.2*a.effui.baseRec.width,a.effui.height=1.2*a.effui.baseRec.height,a.effui.speed=3,a.applyLoadComplete()},1))},c.prototype.playEff=function(a){this.effui&&(a?(this.addChild(this.effui),this.effui.play()):this.removeChild(this.effui))},c.prototype.refresh=function(){if(this.uiAtlasComplet){var a=GuidData.player.getPlayerIntFieldTrialProcessCur(),b=GuidData.player.getPlayerIntFieldTrialProcessTotal(),c=ColorType.Yellowffe9b4+"击杀小怪 "+a+"/"+b+" ";LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_kill_info.skinName,c,14,TextAlign.CENTER,"#ffffff");var d=a>=b,e=!1,f=!1,g=adventure.AdventureModel.getInstance().getCurBossTb();this._curtb=g,g.level&&g.level>GuidData.player.getLevel()?(e=!0,f=!1):(e=!1,f=d&&GuidData.map.isAdventureBossScene());var h=!1,i=Number(String(g.id).substr(1,6));i>1003&&(h=GuidData.map.isAdventureBaseScene()||GuidData.map.isAdventureBossScene(),g.level&&g.level>GuidData.player.getLevel()&&(h=!1));var j=GuidData.map.isAdventureBaseScene()&&e&&d;if(this.setUiListVisibleByItem(this.killInfoUiList,GuidData.map.isAdventureBaseScene()&&!d),this.setUiListVisibleByItem([this.a_boss_but],GuidData.map.isAdventureBaseScene()&&!e&&d),this.setUiListVisibleByItem(this.unlockArray,j),this.setUiListVisibleByItem([this.a_autoplay],h),this.playEff(GuidData.map.isAdventureBaseScene()&&!e&&d),j){var k=g.level+"级开启本关BOSS挑战";LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.unlockArray[2].skinName,k,14,TextAlign.CENTER,ColorType.Yellowffe9b4)}h&&(this.a_autoplay.goToAndStop(this._autoplayflag?1:0),GuidData.map.isAdventureBaseScene()&&d&&this._autoplayflag&&NetManager.getInstance().protocolos.challange_boss()),console.log("显示退出boss",e,f,GuidData.map.isAdventureBossScene(),GuidData.map.isAdventureBaseScene(),d),this.a_info_bar.uvScale=a/b,a==b||0==a?this.a_move_point.x=1e4:(this.a_move_point.x=this.a_info_bar.x+this.a_info_bar.width*(a/b)-this.a_move_point.width/2,this.a_move_point.y=this.a_info_bar.y-2),this._midRender.applyObjData()}},c.prototype.hideExitBossBut=function(){},c.prototype.needUpLevShow=function(){var a=GuidData.player.getworldrisklastid(),b=adventure.AdventureModel.getInstance().getCurTb(),c=Math.floor(b.id/1e6);return 1==c&&b.id>1001001&&a!=b.id?!0:!1},c.prototype.showuppanel=function(){var b=adventure.AdventureModel.getInstance().getCurTb();NetManager.getInstance().protocolos.set_world_risk_last_id(b.id),ModuleEventManager.dispatchEvent(new a.AdventurInfoEvent(a.AdventurInfoEvent.UPLEV_SHOW))},c}(UIPanel);a.AdventureInfoPanel=b}(adventureinfo||(adventureinfo={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventureinfo;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"AdventureInfoModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.AdventureInfoModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_ADVENTURE_INFO_UI_PANEL="SHOW_ADVENTURE_INFO_UI_PANEL",b.HIDE_ADVENTURE_INFO_UI_PANEL="HIDE_ADVENTURE_INFO_UI_PANEL",b.ADVENTURE_TRIAL_PROCESS="ADVENTURE_TRIAL_PROCESS",b.ADVENTURE_BOSS_PROCESS_FINISH="ADVENTURE_BOSS_PROCESS_FINISH",b.UPLEV_SHOW="UPLEV_SHOW",b.SET_AUTOFLAG="SET_AUTOFLAG",b}(BaseEvent);a.AdventurInfoEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"AdventureInfoProcessor"},d.prototype.receivedModuleEvent=function(a){var b=this;if(a instanceof c){var d=a;d.type==c.UPLEV_SHOW&&this.showuplevfoPanelPanel(),d.type==c.SHOW_ADVENTURE_INFO_UI_PANEL&&(GuidData.map.isAdventureScene()?this.showPanel():this.hidePanel()),this.adventureInfoPanel&&(d.type==c.HIDE_ADVENTURE_INFO_UI_PANEL&&this.hidePanel(),d.type==c.ADVENTURE_TRIAL_PROCESS&&this.adventureInfoPanel.refresh(),d.type==c.ADVENTURE_BOSS_PROCESS_FINISH&&this.adventureInfoPanel.hideExitBossBut()),
d.type==c.SET_AUTOFLAG&&this.adventureInfoPanel&&this.adventureInfoPanel.hasStage&&this.adventureInfoPanel.setautoflag(!1)}if(a.type==EngineEvent.ENTER_SCENE_EVENT&&(GuidData.map.isAdventureScene()&&this.adventureInfoPanel?this.adventureInfoPanel.needUpLevShow()&&(GameInstance.sceneResEqu?(this.hidePanel(),AotuSkillManager.getInstance().aotuBattle=!1,ModuleEventManager.dispatchEvent(new SceneLoadEvent(SceneLoadEvent.SCENE_TRANSITION_HIDE_EVENT)),TimeUtil.addTimeOut(2500,function(){b.showPanel(),b.adventureInfoPanel.showuppanel(),AotuSkillManager.getInstance().aotuBattle=!0})):(ModuleEventManager.dispatchEvent(new SceneLoadEvent(SceneLoadEvent.SCENE_TRANSITION_HIDE_EVENT)),this.adventureInfoPanel.showuppanel())):ModuleEventManager.dispatchEvent(new SceneLoadEvent(SceneLoadEvent.SCENE_TRANSITION_HIDE_EVENT))),a instanceof UIPanelEvent){var e=a;e.panel==this.uplevfoPanel&&(this.uplevfoPanel.dispose(),this.uplevfoPanel=null,console.log("释放面板 uplevfoPanel"))}a instanceof newbieguide.NewbieguideEvent&&this.adventureInfoPanel&&(a.type==newbieguide.NewbieguideEvent.SHOW_BIEGUIDE_EVENT?this.adventureInfoPanel.setautoflag(!1):a.type==newbieguide.NewbieguideEvent.HIDE_BIEGUIDE_EVENT&&this.adventureInfoPanel.setautoflag(!0))},d.prototype.hidePanel=function(){this.adventureInfoPanel&&UIManager.getInstance().removeUIContainer(this.adventureInfoPanel)},d.prototype.showPanel=function(){var b=this;this.adventureInfoPanel||(this.adventureInfoPanel=new a.AdventureInfoPanel),this.adventureInfoPanel.load(function(){UIManager.getInstance().addUIContainer(b.adventureInfoPanel),b.adventureInfoPanel.refresh()},!1)},d.prototype.showuplevfoPanelPanel=function(){var b=this;this.uplevfoPanel||(this.uplevfoPanel=new a.UplevfoPanel),this.uplevfoPanel.load(function(){b.uplevfoPanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_ADVENTURE_INFO_UI_PANEL),new c(c.HIDE_ADVENTURE_INFO_UI_PANEL),new c(c.ADVENTURE_TRIAL_PROCESS),new c(c.ADVENTURE_BOSS_PROCESS_FINISH),new c(c.UPLEV_SHOW),new c(c.SET_AUTOFLAG),new EngineEvent(EngineEvent.ENTER_SCENE_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.SHOW_BIEGUIDE_EVENT),new newbieguide.NewbieguideEvent(newbieguide.NewbieguideEvent.HIDE_BIEGUIDE_EVENT)]},d}(BaseProcessor);a.AdventureInfoProcessor=d}(adventureinfo||(adventureinfo={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventuresettlement;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.rewardUiArr=new Array,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b.updataFun=function(a){b.updata(a)},b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/adventure/adventuresettlement/adventuresettlement.xml","ui/uidata/adventure/adventuresettlement/adventuresettlement.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._topRender.getComponent("a_label1")),this.addChild(this._topRender.getComponent("a_tittle")),this.addChild(this._topRender.getComponent("a_line0")),this.addChild(this._topRender.getComponent("a_line1")),this.addChild(this._bottomRender.getComponent("a_reward_bg")),this.a_close_time=this.addChild(this._topRender.getComponent("a_close_time")),this.a_get_but=this.addEvntBut("a_get_but",this._bottomRender),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.butClik=function(a){switch(this.hide(),a.target){case this.a_get_but:}},b.prototype.refresh=function(){var a=GuidData.map.getVipInstanceFieldReward();if(console.log("奖励：",a),a.length<1)return void(a="2001:1,2002:1,2003:1,2004:1,2005:1,2006:1,2007:2,2008:1");var b=a.split(",");this.clearRewardUi();for(var c=0;c<b.length;c++){var d=b[c].split(":"),e=this.addChild(this._topRender.getComponent("a_reward_icon"));e.goToAndStop(c),e.x+=c%4*100,e.y+=100*Math.floor(c/4),this.rewardUiArr.push(e),this.drawRewardIconCtx(e,Number(d[0]),Number(d[1]))}},b.prototype.drawRewardIconCtx=function(a,b,c){var d=this;a.data=b,IconManager.getInstance().getIcon(GameData.getIconCopyUrl(b),function(c){var e=a.getSkinCtxRect(),f=UIManager.getInstance().getContext2D(e.width,e.height,!1);UiDraw.cxtDrawImg(f,PuiData.NewPicBg,new Rectangle(10,0,70,70),UIData.publicUi),f.drawImage(c,0,0,60,60,16,6,58,58);var g=tb.TB_item_template.get_TB_item_template(b).getColorName();LabelTextFont.writeSingleLabelToCtx(f,g,15,45,76,TextAlign.CENTER),a.drawToCtx(d._topRender.uiAtlas,f)})},b.prototype.clearRewardUi=function(){for(;this.rewardUiArr.length;)this.removeChild(this.rewardUiArr.pop())},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),TimeUtil.addFrameTick(this.updataFun),this.refresh(),console.log("添加时间事件")},b.prototype.updata=function(a){if(this.hasStage){if(this.endTime>TimeUtil.getTimer()){var b=Math.floor((this.endTime-TimeUtil.getTimer())/1e3),c=ColorType.Whiteffffff+Math.min(b,9);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_close_time.skinName,c,16)}}else TimeUtil.removeFrameTick(this.updataFun),console.log("移除事件")},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(WindowCentenMin);a.AdventureSettlementPanel=b}(adventuresettlement||(adventuresettlement={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventuresettlement;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"AdventureSettlementModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.AdventureSettlementModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_ADVENTURE_SETTLEMENT_UI_PANEL="SHOW_ADVENTURE_SETTLEMENT_UI_PANEL",b.HIDE_ADVENTURE_SETTLEMENT_UI_PANEL="HIDE_ADVENTURE_SETTLEMENT_UI_PANEL",b}(BaseEvent);a.AdventureSettlementEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"AdventureSettlementProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_ADVENTURE_SETTLEMENT_UI_PANEL&&(GuidData.map.isAdventureScene()?(this.showPanel(),ModuleEventManager.dispatchEvent(new adventureinfo.AdventurInfoEvent(adventureinfo.AdventurInfoEvent.ADVENTURE_BOSS_PROCESS_FINISH))):this.hidePanel()),this.adventurePanel&&b.type==c.HIDE_ADVENTURE_SETTLEMENT_UI_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.adventurePanel&&this.adventurePanel.hide()},d.prototype.showPanel=function(){var b=this;this.adventurePanel||(this.adventurePanel=new a.AdventureSettlementPanel);var c=GameInstance.getGameSecond(GuidData.map.getMapIntFieldEndTM());this.adventurePanel.endTime=TimeUtil.getTimer()+1e3*c,console.log("结束时间",c),this.adventurePanel.load(function(){b.adventurePanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_ADVENTURE_SETTLEMENT_UI_PANEL),new c(c.HIDE_ADVENTURE_SETTLEMENT_UI_PANEL)]},d}(BaseProcessor);a.AdventureSettlementProcessor=d}(adventuresettlement||(adventuresettlement={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),offlinereward;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/adventure/offlinereward/offlinereward.xml","ui/uidata/adventure/offlinereward/offlinereward.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.a_label5=this.addChild(this._topRender.getComponent("a_label5")),this.addChild(this._topRender.getComponent("a_label1")),this.addChild(this._topRender.getComponent("a_label0")),this.addChild(this._topRender.getComponent("a_label6")),this.addChild(this._topRender.getComponent("a_label4")),this.addChild(this._topRender.getComponent("a_label7")),this.addChild(this._topRender.getComponent("a_line1")),this.addChild(this._topRender.getComponent("a_line0")),this.addChild(this._bottomRender.getComponent("a_cell_bg")),this.addChild(this._bottomRender.getComponent("a_cell_bg1")),this.addChild(this._midRender.getComponent("a_time_bg")),this.a_use_time_txt=this.addChild(this._topRender.getComponent("a_use_time_txt")),this.a_submit=this.addEvntButUp("a_submit",this._topRender),this.addArray=new Array,this.rewardUiArr=new Array,this.iconArray=new Array;for(var a=0;3>a;a++){this.addChild(this._bottomRender.getComponent("a_label2_"+a));var b=this.addChild(this._midRender.getComponent("a_vip"+a));LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,b.skinName,"VIP"+GuidData.player.getVipLevel(),12,TextAlign.CENTER,ColorType.Whitefff4d6),this.addArray.push(this.addChild(this._topRender.getComponent("b_reward"+a))),this.rewardUiArr.push(this.addChild(this._topRender.getComponent("a_reward"+a))),this.iconArray.push(this.addChild(this._topRender.getComponent("a_cion"+a)))}this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.butClik=function(a){switch(a.target){case this.a_submit:break;case this.c_close:}this.hide()},c.prototype.hide=function(){ModuleEventManager.dispatchEvent(new a.OfflineRewardEvent(a.OfflineRewardEvent.HIDE_OFFLINE_REWARD_PANEL))},c.prototype.refresh=function(a){console.log("=============================================$data",a);for(var b=new Array,c=0;c<a.list.length;c++){var d=a.list[c],e=tb.TB_item_template.get_TB_item_template(d.item_id);if(1==e.type){var f=this.getIndex(b);-1==f?b.push([-2,1]):b[f][1]+=1}else b.push([d.item_id,d.num])}var g=tb.TB_vip_base.get_TB_vip_baseById(GuidData.player.getVipLevel()),h=Math.floor(Number(a.reserve)/((100+g.riskReward)/100));LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.rewardUiArr[2].skinName,String(h),16,TextAlign.LEFT,ColorType.color843b11),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.addArray[2].skinName,String(Number(a.reserve)-h),16,TextAlign.CENTER,ColorType.color843b11);for(var i=0;i<b.length;i++){if(3==b[i][0]){var j=Math.floor(b[i][1]/((100+g.riskReward)/100));LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.rewardUiArr[0].skinName,String(j),16,TextAlign.LEFT,ColorType.color843b11),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.addArray[0].skinName,String(b[i][1]-j),16,TextAlign.CENTER,ColorType.color843b11)}if(104==b[i][0]){var j=Math.floor(b[i][1]/((100+g.riskReward)/100));LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.rewardUiArr[1].skinName,String(j),16,TextAlign.LEFT,ColorType.color843b11),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.addArray[1].skinName,String(b[i][1]-j),16,TextAlign.CENTER,ColorType.color843b11)}if(-2==b[i][0]){var k=b[i][1]+Number(a.reserve),j=Math.floor(k/((100+g.riskReward)/100));LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.rewardUiArr[2].skinName,String(j),16,TextAlign.LEFT,ColorType.color843b11),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.addArray[2].skinName,String(k-j),16,TextAlign.CENTER,ColorType.color843b11)}}console.log("-------离线时间-----",a.reserve2+"秒");var l=Math.floor(a.reserve2/3600),m=Math.ceil(a.reserve2/60-60*l);LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_use_time_txt.skinName,l+"小时"+m+"分",16,TextAlign.CENTER,ColorType.color843b11),a.reserve>0?LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_label5.skinName,ColorType.Brown7a2f21+"背包已满,自动出售 "+ColorType.colorce0a00+a.reserve+ColorType.Brown7a2f21+" 件装备",16,TextAlign.CENTER,ColorType.colorce0a00):UiDraw.clearUI(this.a_label5)},c.prototype.getIndex=function(a){for(var b=0;b<a.length;b++)if(-2==a[b][0])return b;return-1},c}(WindowCentenMin);a.OfflineRewardPanel=b}(offlinereward||(offlinereward={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),offlinereward;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"OfflineRewardModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.OfflineRewardModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_OFFLINE_REWARD_PANEL="SHOW_OFFLINE_REWARD_PANEL",b.HIDE_OFFLINE_REWARD_PANEL="HIDE_OFFLINE_REWARD_PANEL",b}(BaseEvent);a.OfflineRewardEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"OfflineRewardProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_OFFLINE_REWARD_PANEL&&this.showPanel(b.data),this.offlineRewardPanel&&b.type==c.HIDE_OFFLINE_REWARD_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.offlineRewardPanel&&UIManager.getInstance().removeUIContainer(this.offlineRewardPanel)},d.prototype.showPanel=function(b){var c=this;this.offlineRewardPanel||(this.offlineRewardPanel=new a.OfflineRewardPanel),this.offlineRewardPanel.load(function(){UIManager.getInstance().addUIContainer(c.offlineRewardPanel),c.offlineRewardPanel.refresh(b)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_OFFLINE_REWARD_PANEL),new c(c.HIDE_OFFLINE_REWARD_PANEL)]},d}(BaseProcessor);a.OfflineRewardProcessor=d}(offlinereward||(offlinereward={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventurebang;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.bottom=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/adventure/offlinereward/offlinereward.xml","ui/uidata/adventure/offlinereward/offlinereward.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_bg")),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.butClik=function(a){this.close()},b.prototype.close=function(){},b.prototype.refresh=function(){},b}(UIPanel);a.AdventureBangPanel=b}(adventurebang||(adventurebang={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventurebang;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"AdventureBangModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.AdventureBangModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_ADVENTURE_BANG_PANEL="SHOW_ADVENTURE_BANG_PANEL",b.HIDE_ADVENTURE_BANG_PANEL="HIDE_ADVENTURE_BANG_PANEL",b}(BaseEvent);a.AdventureBangEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"AdventureBangProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_ADVENTURE_BANG_PANEL&&this.showPanel(),this.adventureBangPanel&&b.type==c.HIDE_ADVENTURE_BANG_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.adventureBangPanel&&UIManager.getInstance().removeUIContainer(this.adventureBangPanel)},d.prototype.showPanel=function(){var b=this;this.adventureBangPanel||(this.adventureBangPanel=new a.AdventureBangPanel),this.adventureBangPanel.load(function(){UIManager.getInstance().addUIContainer(b.adventureBangPanel),b.adventureBangPanel.refresh()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_ADVENTURE_BANG_PANEL),new c(c.HIDE_ADVENTURE_BANG_PANEL)]},d}(BaseProcessor);a.AdventureBangProcessor=d}(adventurebang||(adventurebang={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventurebossnotice;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.rewardUiArr=new Array,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/adventure/adventurebossnotice/adventurebossnotice.xml","ui/uidata/adventure/adventurebossnotice/adventurebossnotice.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._topRender.getComponent("a_tittle")),this.addChild(this._topRender.getComponent("a_reward_tittle")),this.a_boss_name_txt=this.addChild(this._topRender.getComponent("a_boss_name_txt")),this.addChild(this._midRender.getComponent("a_boss_name_bg")),this.addChild(this._midRender.getComponent("a_line0")),this.addChild(this._midRender.getComponent("a_reward_bg")),this.addChild(this._midRender.getComponent("a_line1")),this.a_submit=this.addEvntBut("a_submit",this._bottomRender),this.addBossChar(),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.addBossChar=function(){this.bossChar=new MonsterUIChar,this._bottomRender.addModel(this.bossChar)},b.prototype.butClik=function(a){switch(a.target){case this.a_submit:UIManager.popClikNameFun("a_submit"),NetManager.getInstance().protocolos.challange_boss();break;default:ModuleEventManager.dispatchEvent(new adventureinfo.AdventurInfoEvent(adventureinfo.AdventurInfoEvent.ADVENTURE_TRIAL_PROCESS))}this.hide()},b.prototype.refresh=function(){var a=adventure.AdventureModel.getInstance().getCurBossTb();this.clearRewardUi();for(var b=0;b<a.showitems.length;b++){var c=this.addChild(this._topRender.getComponent("a_boss_reward_frame"));c.goToAndStop(b),c.x=70*b+440-(a.showitems.length-1)/5*170,this.rewardUiArr.push(c),this.drawRewardIconCtx(c,a.showitems[b])}var d=a.bossId;d||(d=40001);var e=tb.TB_creature_template.get_TB_creature_template(d),f=a.name.replace("BOSS",e.name);LabelTextFont.writeSingleLabel(this._bottomRender.uiAtlas,this.a_boss_name_txt.skinName,f,16,TextAlign.CENTER,ColorType.color843b11),this.bossChar.setAvatar(e.avatar)},b.prototype.resize=function(){a.prototype.resize.call(this),this.bossChar&&(this.bossChar.scale=1.5*UIData.Scale,this.bossChar.x=0*UIData.Scale,this.bossChar.y=0*UIData.Scale,this.bossChar.resize())},b.prototype.drawRewardIconCtx=function(a,b){var c=this;a.data=b,IconManager.getInstance().getIcon(GameData.getIconCopyUrl(b),function(b){var d=a.getSkinCtxRect(),e=UIManager.getInstance().getContext2D(d.width,d.height,!1);UiDraw.cxtDrawImg(e,PuiData.NewPicBg,new Rectangle(0,0,68,68),UIData.publicUi),e.drawImage(b,0,0,60,60,6,6,56,56),a.drawToCtx(c._topRender.uiAtlas,e)})},b.prototype.clearRewardUi=function(){for(;this.rewardUiArr.length;)this.removeChild(this.rewardUiArr.pop())},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.refresh()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(WindowCentenMin);a.AdventureBossNoticePanel=b}(adventurebossnotice||(adventurebossnotice={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),adventurebossnotice;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"AdventureBossNoticeModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.AdventureBossNoticeModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_Adventure_Notice_UI_PANEL="SHOW_Adventure_Notice_UI_PANEL",b.HIDE_Adventure_Notice_UI_PANEL="HIDE_Adventure_Notice_UI_PANEL",b}(BaseEvent);a.AdventureBossNoticeEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"AdventureBossNoticeProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_Adventure_Notice_UI_PANEL&&(GuidData.map.isAdventureScene()?this.showPanel():this.hidePanel()),this.adventurePanel&&b.type==c.HIDE_Adventure_Notice_UI_PANEL&&this.hidePanel()}},d.prototype.hidePanel=function(){this.adventurePanel&&this.adventurePanel.hide()},d.prototype.showPanel=function(){var b=this;this.adventurePanel||(this.adventurePanel=new a.AdventureBossNoticePanel),this.adventurePanel.load(function(){b.adventurePanel.show()},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_Adventure_Notice_UI_PANEL),new c(c.HIDE_Adventure_Notice_UI_PANEL)]},d}(BaseProcessor);a.AdventureBossNoticeProcessor=d}(adventurebossnotice||(adventurebossnotice={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),newbieguide;!function(a){var b=function(){function a(){}return a}();a.UseItemVo=b;var c=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new AlphaUIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.applyLoad=function(){var a=this;this._baseRender.setInfo("ui/uidata/useitem/useitem.xml","ui/uidata/useitem/useitem.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._topRender.uiAtlas=this._baseRender.uiAtlas,this._bottomRender.uiAtlas=this._baseRender.uiAtlas,this.initUI(),this.applyLoadComplete()},b.prototype.initUI=function(){var a=this;this._baseRender;this.addChild(this._bottomRender.getComponent("b_bg")),this.useBtn=this.addEvntBut("a_but",this._baseRender),this.a_icon=this.addChild(this._baseRender.getComponent("a_icon")),this.a_btntxt=this.addChild(this._topRender.getComponent("a_btntxt")),this.a_name=this.addChild(this._topRender.getComponent("a_name")),this.a_time=this._topRender.getComponent("a_time"),this._tickFun=function(b){a.tickRefreshState(b)}},b.prototype.tickRefreshState=function(a){var b=Math.floor((this._endtime-TimeUtil.getTimer())/1e3);if(this._curtime!=b&&(this._curtime=b,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,"A_timetxt",String(b+1),14,TextAlign.CENTER,ColorType.Brown7a2f21),0>b)){var c=tb.TB_item_template.get_TB_item_template(this._curvo.itemId);c.type==SharedDef.ITEM_TYPE_EQUIP&&1==c.Auto&&NetManager.getInstance().protocolos.bag_exchange_pos(SharedDef.BAG_TYPE_EQUIP_BAG,this._curvo.equPos,SharedDef.BAG_TYPE_EQUIP,Number(c.pos)),this.nextprompt()}this.hasStage||TimeUtil.removeFrameTick(this._tickFun)},b.prototype.nextprompt=function(){this._queItemAry.shift(),this.selectItem()},b.prototype.refresh=function(){this._curvo=this._queItemAry[0];var a=tb.TB_item_template.get_TB_item_template(this._curvo.itemId);this.a_btntxt.goToAndStop(this.getType(a.type)),this.drawItemIcon(this.a_icon,this._curvo.itemId,this._curvo.num),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_name.skinName,a.name,16,TextAlign.CENTER,getColorQua(a.quality)),this._curvo.time>0?(this.setUiListVisibleByItem([this.a_time],!0),this.a_btntxt.x=740):(this.setUiListVisibleByItem([this.a_time],!1),this.a_btntxt.x=750)},b.prototype.drawItemIcon=function(a,b,c){var d=tb.TB_item_template.get_TB_item_template(b);IconManager.getInstance().getIconName(d.icon,function(b){var e=a.uiRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),UiDraw.cxtDrawImg(f,ItemGoodQuality.getQuaStr(d.quality),new Rectangle(0,0,68,68),UIData.publicUi),f.drawImage(b,0,0,60,60,4,4,60,60),1==d.type&&(UiDraw.cxtDrawImg(f,PuiData.A_EQULEVBG,new Rectangle(4,4,41,17),UIData.publicUi),ArtFont.getInstance().writeFontToCtxCenten(f,String(d.level),ArtFont.num63,18,4,4)),LabelTextFont.writeSingleLabelToCtxSetAnchor(f,"x"+c,16,64,45,TextAlign.RIGHT,ColorType.Whitefff4d6,ColorType.colord27262e),a.uiRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)})},b.prototype.getType=function(a){switch(a){case 14:case 15:return 0;case 1:return 1;default:return 2}},b.prototype.selectItem=function(){if(this._queItemAry.length>0){var a=tb.TB_item_template.get_TB_item_template(this._queItemAry[0].itemId);if(a.type==SharedDef.ITEM_TYPE_EQUIP){var b=GuidData.bag.getEquByPart(a.pos),c=!1;b?this._queItemAry[0].force>b.data.propData.force&&(c=!0):c=!0,c?(this._endtime=this._queItemAry[0].time+TimeUtil.getTimer(),this.refresh()):this.nextprompt()}else this._endtime=this._queItemAry[0].time+TimeUtil.getTimer(),this.refresh()}else this.hide()},b.prototype.addData=function(a){this._queItemAry||(this._queItemAry=new Array),this._queItemAry.push(a),console.log("_UseItemary------",this._queItemAry)},b.prototype.onAdd=function(){this.selectItem(),TimeUtil.addFrameTick(this._tickFun)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){switch(a.target){case this.useBtn:var b=tb.TB_item_template.get_TB_item_template(this._curvo.itemId);if(b.type==SharedDef.ITEM_TYPE_EQUIP)console.log("穿",SharedDef.BAG_TYPE_MAIN_BAG,this._curvo.equPos,SharedDef.BAG_TYPE_EQUIP,Number(b.pos)),NetManager.getInstance().protocolos.bag_exchange_pos(SharedDef.BAG_TYPE_EQUIP_BAG,this._curvo.equPos,SharedDef.BAG_TYPE_EQUIP,Number(b.pos));else{var c=GuidData.bag.getItemByEntryCopy(b.id);c?NetManager.getInstance().protocolos.bag_item_user(c.guid,this._curvo.num):alert("背包里没有物品")}this.nextprompt()}},b}(UIPanel);a.UseItemPanel=c}(newbieguide||(newbieguide={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),newbieguide;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new AlphaUIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._bigPic=new UIRenderOnlyPicComponent,b.addRender(b._bigPic),b}return __extends(b,a),b.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.applyLoad=function(){var a=this;this._baseRender.setInfo("ui/uidata/poptimeout/systemtrailer.xml","ui/uidata/poptimeout/systemtrailer.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._baseRender.uiAtlas,this._topRender.uiAtlas=this._baseRender.uiAtlas,this._bottomRender.uiAtlas=this._baseRender.uiAtlas,this._bigPic.uiAtlas=this._baseRender.uiAtlas,this.initUI(),this.resize(),this.applyLoadComplete()},b.prototype.initUI=function(){var a=this._baseRender;this.addChild(this._bottomRender.getComponent("b_bg")),this.addChild(a.getComponent("b_infobg")),this.b_titlename=this.addChild(this._topRender.getComponent("b_titlename")),this.b_close=this.addEvntButUp("b_close",a),this.b_info=this.addChild(this._topRender.getComponent("b_info")),this.b_unlock=this.addChild(a.getComponent("b_unlock")),this.b_btn=this.addEvntButUp("b_btn",a),this.addChild(this._bigPic.getComponent("ccav"))},b.prototype.show=function(a){UIManager.getInstance().addUIContainer(this);var b=tb.TB_system_preview.getTempVo(a);this.curvo=b,this.b_titlename.goToAndStop(b.type2-1),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_info.skinName,b.info,16,TextAlign.CENTER,ColorType.Brown7a2f21);var c=tb.TB_system_base.getTempVo(10*b.system_id[0]+b.system_id[1]),d=c.level<=GuidData.player.getLevel();this.setUiListVisibleByItem([this.b_btn],d);var e=c.level+"级开启"+b.name;d&&(e=""),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.b_unlock.skinName,e,16,TextAlign.CENTER,ColorType.Brown7a2f21),this._bigPic.setImgUrl("ui/load/systrailer/"+b.type2+".png"),this.resize()},b.prototype.hide=function(){
UIManager.getInstance().removeUIContainer(this)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.butClik=function(a){switch(a.target){case this.b_close:this.hide();break;case this.b_btn:this.hide(),ModulePageManager.openPanel(this.curvo.system_id[0],this.curvo.system_id.slice(1,this.curvo.system_id.length))}},b}(UIPanel);a.Systemtrailer=b}(newbieguide||(newbieguide={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),newbieguide;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.left=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new AlphaUIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null,this.layer=300},b.prototype.applyLoad=function(){var a=this;this._baseRender.setInfo("ui/uidata/poptimeout/newbieguide.xml","ui/uidata/poptimeout/newbieguide.png",function(){a.loadConfigCom()})},b.prototype.initData=function(a){this.tb=a,this._type=a.type,this._text=a.text,this._rect=this.getLayoutRect(),this.showItems(),this._scale=1,this._num=0,TimeUtil.addFrameTick(this.upDataFun)},b.prototype.getLayoutRect=function(){var a=this.tb,b=new Rectangle,c=new Vector2D(a.area[0],a.area[1]);return c=UiTweenVo.getPosByPanel(c,a.layout),b.x=c.x,b.y=c.y,b.width=a.area[2],b.height=a.area[3],b},b.prototype.loadConfigCom=function(){var a=this;this._topRender.uiAtlas=this._baseRender.uiAtlas,this._bottomRender.uiAtlas=this._baseRender.uiAtlas,this.initUI(),this.upDataFun=function(b){a.update(b)},this.applyLoadComplete()},b.prototype.initUI=function(){var a=this._baseRender;this.a_2=a.getComponent("a_2"),this.a_1=this.addChild(a.getComponent("a_1")),this.a_3=this.addChild(this._topRender.getComponent("a_3")),this.a_4=this._topRender.getComponent("a_4"),this.arybg_2_1=new Array;for(var b=0;4>b;b++){var c=this.addChild(this._bottomRender.getComponent("basebg"));c.addEventListener(InteractiveEvent.Up,this.clickEvt,this),c.addEventListener(InteractiveEvent.Down,this.clickEvt,this),this.arybg_2_1.push(c)}},b.prototype.update=function(a){this.hasStage||TimeUtil.removeFrameTick(this.upDataFun);var b=this._num%60;0==b?(this._scale=1.2,this.a_1.alpha=1):(this._scale-=.003,b>=49&&(this.a_1.alpha-=.1));var c=this.getNewVect(this._scale);this.drawHighlighted(c),this._baseRender.applyObjData(),this._num++},b.prototype.getNewVect=function(a){var b=new Rectangle;return a>1?(b.width=a*this._rect.width,b.height=a*this._rect.height,b.x=this._rect.x-(b.width-this._rect.width)/2,b.y=this._rect.y-(b.height-this._rect.height)/2):b=this._rect,b},b.prototype.movetip=function(){this.arybg_2_1[0].x=0,this.arybg_2_1[0].y=0,this.arybg_2_1[0].width=this._rect.x,this.arybg_2_1[0].height=this.height,this.arybg_2_1[1].x=this._rect.x,this.arybg_2_1[1].y=0,this.arybg_2_1[1].width=this._rect.width,this.arybg_2_1[1].height=this._rect.y,this.arybg_2_1[2].x=this._rect.x+this._rect.width,this.arybg_2_1[2].y=0,this.arybg_2_1[2].width=this.width-(this._rect.x+this._rect.width),this.arybg_2_1[2].height=this.height,this.arybg_2_1[3].x=this._rect.x,this.arybg_2_1[3].y=this._rect.y+this._rect.height,this.arybg_2_1[3].width=this._rect.width,this.arybg_2_1[3].height=this.height-(this._rect.y+this._rect.height)},b.prototype.showItems=function(){if(this.movetip(),this._text.length>0){this.setUiListVisibleByItem([this.a_2,this.a_4],!0);var a=LabelTextFont.writeText(this._topRender.uiAtlas,this.a_3.skinName,0,0,this._text,16,"#4c2605",225,!0);this.a_2.width=a[0]+30,this.a_2.height=a[1]+20;var b=this.getposxAndposy();this.a_3.x=b[0]+15,this.a_3.y=b[1]+10,this.a_2.x=b[0],this.a_2.y=b[1]}else this.setUiListVisibleByItem([this.a_2,this.a_4],!1),LabelTextFont.clearLabel(this._topRender.uiAtlas,this.a_3.skinName);this._baseRender.applyObjData()},b.prototype.drawHighlighted=function(a){this.a_1.x=a.x,this.a_1.y=a.y,this.a_1.width=a.width,this.a_1.height=a.height},b.prototype.getposxAndposy=function(){var a,b,c;switch(this._type){case 1:a=this._rect.x-(this.a_2.width-this._rect.width)/2,b=this._rect.y-this.a_2.height-10,c=1,this.a_4.x=a+this.a_2.width/2-this.a_4.width/2,this.a_4.y=this._rect.y-20;break;case 2:a=this._rect.x+this._rect.width+10,b=this._rect.y-(this.a_2.height-this._rect.height)/2,c=3,this.a_4.x=a-.5*this.a_4.width,this.a_4.y=b+this.a_2.height/2-this.a_4.height/2;break;case 3:a=this._rect.x-(this.a_2.width-this._rect.width)/2,b=this._rect.y+this._rect.height+10,c=0,this.a_4.x=a+this.a_2.width/2-this.a_4.width/2,this.a_4.y=b-.6*this.a_4.height;break;case 4:a=this._rect.x-this.a_2.width-10,b=this._rect.y-(this.a_2.height-this._rect.height)/2,c=2,this.a_4.x=this._rect.x-23,this.a_4.y=b+this.a_2.height/2-this.a_4.height/2}return this.a_4.goToAndStop(c),[a,b]},b.prototype.resize=function(){this.width=Scene_data.stageWidth/UIData.Scale,this.height=Scene_data.stageHeight/UIData.Scale,a.prototype.resize.call(this),this._rect=this.getLayoutRect(),this.showItems()},b.prototype.clickEvt=function(a){},b}(UIPanel);a.Newbieguide=b}(newbieguide||(newbieguide={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),newbieguide;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.left=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._baseRender=new AlphaUIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._topRender.dispose(),this._topRender=null},b.prototype.applyLoad=function(){var a=this;this._baseRender.setInfo("ui/uidata/poptimeout/newbieguide.xml","ui/uidata/poptimeout/newbieguide.png",function(){a.loadConfigCom()})},b.prototype.initData=function(a){this.tb=a,this._type=a.type,this._text=a.text,this._rect=this.getLayoutRect(),this.showItems(),this._scale=1,this._num=0,TimeUtil.addFrameTick(this.upDataFun)},b.prototype.getLayoutRect=function(){var a=this.tb,b=new Rectangle,c=new Vector2D(a.area[0],a.area[1]);return c=UiTweenVo.getPosByPanel(c,a.layout),b.x=c.x,b.y=c.y,b.width=a.area[2],b.height=a.area[3],b},b.prototype.loadConfigCom=function(){var a=this;this._topRender.uiAtlas=this._baseRender.uiAtlas,this._bottomRender.uiAtlas=this._baseRender.uiAtlas,this.initUI(),this.upDataFun=function(b){a.update(b)},this.applyLoadComplete()},b.prototype.initUI=function(){var a=this._baseRender;this.b_2=a.getComponent("b_2"),this.b_1=this.addChild(a.getComponent("b_1")),this.b_3=this.addChild(this._topRender.getComponent("b_3")),this.b_4=this._topRender.getComponent("b_4")},b.prototype.update=function(a){this.hasStage||TimeUtil.removeFrameTick(this.upDataFun);var b=this._num%60;0==b?(this._scale=1.2,this.b_1.alpha=1):(this._scale-=.003,b>=49&&(this.b_1.alpha-=.1));var c=this.getNewVect(this._scale);this.drawHighlighted(c),this._baseRender.applyObjData(),this._num++},b.prototype.getNewVect=function(a){var b=new Rectangle;return a>1?(b.width=a*this._rect.width,b.height=a*this._rect.height,b.x=this._rect.x-(b.width-this._rect.width)/2,b.y=this._rect.y-(b.height-this._rect.height)/2):b=this._rect,b},b.prototype.showItems=function(){if(this._text.length>0){this.setUiListVisibleByItem([this.b_2,this.b_4],!0);var a=LabelTextFont.writeText(this._topRender.uiAtlas,this.b_3.skinName,0,0,this._text,16,"#4c2605",225,!0);this.b_2.width=a[0]+30,this.b_2.height=a[1]+20;var b=this.getposxAndposy();this.b_3.x=b[0]+15,this.b_3.y=b[1]+10,this.b_2.x=b[0],this.b_2.y=b[1]}else this.setUiListVisibleByItem([this.b_2,this.b_4],!1),LabelTextFont.clearLabel(this._topRender.uiAtlas,this.b_3.skinName);this._baseRender.applyObjData()},b.prototype.drawHighlighted=function(a){this.b_1.x=a.x,this.b_1.y=a.y,this.b_1.width=a.width,this.b_1.height=a.height},b.prototype.getposxAndposy=function(){var a,b,c;switch(this._type){case 1:a=this._rect.x-(this.b_2.width-this._rect.width)/2,b=this._rect.y-this.b_2.height-10,c=1,this.b_4.x=a+this.b_2.width/2-this.b_4.width/2,this.b_4.y=this._rect.y-20;break;case 2:a=this._rect.x+this._rect.width+10,b=this._rect.y-(this.b_2.height-this._rect.height)/2,c=3,this.b_4.x=a-.5*this.b_4.width,this.b_4.y=b+this.b_2.height/2-this.b_4.height/2;break;case 3:a=this._rect.x-(this.b_2.width-this._rect.width)/2,b=this._rect.y+this._rect.height+10,c=0,this.b_4.x=a+this.b_2.width/2-this.b_4.width/2,this.b_4.y=b-.6*this.b_4.height;break;case 4:a=this._rect.x-this.b_2.width-10,b=this._rect.y-(this.b_2.height-this._rect.height)/2,c=2,this.b_4.x=this._rect.x-23,this.b_4.y=b+this.b_2.height/2-this.b_4.height/2}return this.b_4.goToAndStop(c),[a,b]},b.prototype.resize=function(){this.width=Scene_data.stageWidth/UIData.Scale,this.height=Scene_data.stageHeight/UIData.Scale,a.prototype.resize.call(this),this._rect=this.getLayoutRect(),this.showItems()},b.prototype.clickEvt=function(a){},b}(UIPanel);a.OptionalGuidePop=b}(newbieguide||(newbieguide={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),newbieguide;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"NewbieguideModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.NewbieguideModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_BIEGUIDE_EVENT="SHOW_BIEGUIDE_EVENT",b.HIDE_BIEGUIDE_EVENT="HIDE_BIEGUIDE_EVENT",b.SHOW_OPTIONL_GUIDE_EVENT="SHOW_OPTIONL_GUIDE_EVENT",b.HIDE_OPTIONL_GUIDE_EVENT="HIDE_OPTIONL_GUIDE_EVENT",b.SHOW_SYSTRAILER_EVENT="SHOW_SYSTRAILER_EVENT",b.HIDE_SYSTRAILER_EVENT="HIDE_SYSTRAILER_EVENT",b.SHOW_USEITEM_EVENT="SHOW_USEITEM_EVENT",b.HIDE_USEITEM_EVENT="HIDE_USEITEM_EVENT",b}(BaseEvent);a.NewbieguideEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"NewbieguideProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_BIEGUIDE_EVENT&&this.showBieGuideUi(b.data),b.type==c.HIDE_BIEGUIDE_EVENT&&this.hideBieGuideUi(),b.type==c.SHOW_OPTIONL_GUIDE_EVENT&&this.showOptionlGuide(b.data),b.type==c.HIDE_OPTIONL_GUIDE_EVENT&&this.hideOptionlGuide(),b.type==c.SHOW_SYSTRAILER_EVENT&&this.showsystemtrailer(b.data),b.type==c.HIDE_SYSTRAILER_EVENT&&this.hidesystemtrailer(),b.type==c.SHOW_USEITEM_EVENT&&this.showuseitem(b.data),b.type==c.HIDE_USEITEM_EVENT&&this.hideuseitem()}if(a instanceof EngineEvent){var d=a;d.type==EngineEvent.PLAYER_FIELD_LEVEL&&this.opensystrailer()}if(a instanceof UIPanelEvent){var e=a;e.panel==this._newbieguide&&(this._newbieguide.dispose(),this._newbieguide=null,console.log("释放面板 _newbieguide")),e.panel==this._systemtrailer&&(this._systemtrailer.dispose(),this._systemtrailer=null,console.log("释放面板 _systemtrailer"))}},d.prototype.opensystrailer=function(){this._tabary||(this._tabary=tb.TB_system_preview.getItem());for(var a=0;a<this._tabary.length;a++)if(this._tabary[a].level==GuidData.player.getLevel()){this.showsystemtrailer(this._tabary[a].id);break}},d.prototype.showOptionlGuide=function(b){var c=this;this.optionTbData=b,this._optionalGuidePop||(this._optionalGuidePop=new a.OptionalGuidePop),this._optionalGuidePop.load(function(){c._optionalGuidePop.initData(c.optionTbData),UIManager.getInstance().addUIContainer(c._optionalGuidePop)})},d.prototype.hideOptionlGuide=function(){this._optionalGuidePop&&UIManager.getInstance().removeUIContainer(this._optionalGuidePop)},d.prototype.hidesystemtrailer=function(){this._systemtrailer&&this._systemtrailer.hide()},d.prototype.showsystemtrailer=function(b){var c=this;this._systemtrailer||(this._systemtrailer=new a.Systemtrailer),this._systemtrailer.load(function(){c._systemtrailer.show(b)})},d.prototype.hideuseitem=function(){this._useitempanel&&this._useitempanel.hide()},d.prototype.showuseitem=function(b){var c=this;this._useitempanel||(this._useitempanel=new a.UseItemPanel),this._useitempanel.addData(b),this._useitempanel.load(function(){UIManager.getInstance().addUIContainer(c._useitempanel)})},d.prototype.hideBieGuideUi=function(){this._newbieguide&&UIManager.getInstance().removeUIContainer(this._newbieguide)},d.prototype.showBieGuideUi=function(b){var c=this;this._newbieguide?this._newbieguide.hasStage&&UIManager.getInstance().removeUIContainer(this._newbieguide):this._newbieguide=new a.Newbieguide,this.lastData=b,this._newbieguide.load(function(){c._newbieguide.initData(c.lastData),UIManager.getInstance().addUIContainer(c._newbieguide)})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_BIEGUIDE_EVENT),new c(c.HIDE_BIEGUIDE_EVENT),new c(c.SHOW_OPTIONL_GUIDE_EVENT),new c(c.HIDE_OPTIONL_GUIDE_EVENT),new c(c.SHOW_SYSTRAILER_EVENT),new c(c.HIDE_SYSTRAILER_EVENT),new c(c.SHOW_USEITEM_EVENT),new c(c.HIDE_USEITEM_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL)]},d}(BaseProcessor);a.NewbieguideProcessor=d}(newbieguide||(newbieguide={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wing;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._curTab=0,b._canclick=!0,b._currentIdx=0,b.curWingID=-1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._redPointRender=new RedPointRender,b.addRender(b._redPointRender),b._baseUiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){a.prototype.dispose.call(this),this._baseRender.dispose(),this._baseRender=null,this._bgRender.dispose(),this._bgRender=null,this.qianghuaPanel&&(this.qianghuaPanel.dispose(),this.qianghuaPanel=null),this.jinjiePanel&&(this.jinjiePanel.dispose(),this.jinjiePanel=null),this.showDisPlay&&(this.showDisPlay.destory(),this.showDisPlay=null),this._redPointRender.dispose(),this._redPointRender=null,this._effRender&&(this._effRender.dispose(),this._effRender=null)},b.prototype.butClik=function(a){a.target==this.w_close&&this.hide()},b.prototype.applyLoad=function(){var a=this;this._baseUiAtlas.setInfo("ui/uidata/wing/wing.xml","ui/uidata/wing/wing.png",function(){a.loadConfigCom()})},b.prototype.loadConfigCom=function(){this.applyLoadComplete(),this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this.addPersonChar(),this.initBaseUI(),this.resize()},b.prototype.addPersonChar=function(){var a=new Person2DChar;a.needUIUrl=!1,this._bgRender.addModel(a),this.showDisPlay=a},b.prototype.resize=function(){a.prototype.resize.call(this),this.showDisPlay&&(this.showDisPlay.resize(),this.showDisPlay.scale=6.5*UIData.Scale,this.showDisPlay.x=100*UIData.Scale,this.showDisPlay.y=-45*UIData.Scale)},b.prototype.initBaseUI=function(){var a=this.addChild(this.winmidRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(a,"t_bg1",this._bgRender);var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(b,"t_bg2",this._bgRender);var e=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(e,"t_bg3",this._bgRender),this.winmidRender.applyObjData(),this.addChild(this._bgRender.getComponent("a_rolebg"));var f=this.addChild(this._bgRender.getComponent("a_huawenbg")),g=this.addChild(this._bgRender.getComponent("a_huawenbg"));g.isU=!0,g.x=f.x-f.width,this.addUIList(["t_main_title","a_namebg"],this._bgRender),this.titleBg=this.addChild(this._bgRender.getComponent("t_title_bg")),this.zLlab=this.addChild(this._baseRender.getComponent("t_zl_lab")),this.mainBtn=this._bgRender.getComponent("t_btn_bg"),this.mainBtn.addEventListener(InteractiveEvent.Up,this.applyClick,this),this.addChild(this.mainBtn),this.addChild(this._baseRender.getComponent("t_bg5")),this.UnlockAry=new Array,this.UnlockAry.push(this._bgRender.getComponent("t_bg4")),this.wingExPer=this._bgRender.getComponent("t_pre"),this.UnlockAry.push(this.wingExPer),this.wingName=this._baseRender.getComponent("t_name"),this.addChild(this.wingName),this.wingZl=this._baseRender.getComponent("t_zl"),this.addChild(this.wingZl),this.wingStarAry=new Array;for(var h=0;10>h;h++){var i=this._baseRender.getComponent("t_star"+h);this.wingStarAry.push(i)}this.wingExp=this._baseRender.getComponent("t_exp"),this.UnlockAry.push(this.wingExp),this.tab0=this._bgRender.getComponent("t_tab0"),this.addChild(this.tab0),this.tab0.addEventListener(InteractiveEvent.Down,this.tabClick,this),this.tab1=this._bgRender.getComponent("t_tab1"),this.tab1.addEventListener(InteractiveEvent.Down,this.tabClick,this),this.tab1dis=this._bgRender.getComponent("t_tab_qiang_dis"),this.showTab1(),this.jinjiePanel=new c,this.jinjiePanel.parentPanel=this,this.jinjiePanel.setUiAtlas(this._baseUiAtlas),this.qianghuaPanel=new d,this.qianghuaPanel.parentPanel=this,this.qianghuaPanel.setUiAtlas(this._baseUiAtlas),this.tab0RedPoint=this._redPointRender.getRedPointUI(this,51,new Vector2D(this.tab0.x+this.tab0.width-5,this.tab0.y)),this.tab1RedPoint=this._redPointRender.getRedPointUI(this,53,new Vector2D(this.tab1.x+this.tab1.width-5,this.tab1.y)),this.btnRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.mainBtn.x+this.mainBtn.width,this.mainBtn.y)),this.drawBaseWingInfo()},b.prototype.showTab1=function(){var a=tb.TB_system_base.getTempVo(Number(10*SharedDef.MODULE_WING+SharedDef.MODULE_WING_STRENGTH));a.level<=GuidData.player.getLevel()?(this.addChild(this.tab1),this.removeChild(this.tab1dis)):(this.removeChild(this.tab1),this.addChild(this.tab1dis))},b.prototype.applyClick=function(a){var b=this;UIManager.popClikNameFun("t_btn_bg"),UiTweenScale.getInstance().changeButSize(a.target),this._canclick&&(this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){b._canclick=!0}),0==this._currentIdx?this.jinjiePanel.applyClick():this.qianghuaPanel.applyClick())},b.prototype.showBtnBg=function(a){a?this.addChild(this.mainBtn):this.removeChild(this.mainBtn)},b.prototype.tabClick=function(a){switch(a.target){case this.tab0:this.setSelectIdx(0);break;case this.tab1:this.setSelectIdx(1)}},b.prototype.setSelectIdx=function(a){if(this._curTab=a,this.setUiListVisibleByItem(this.UnlockAry,0==this._curTab&&GuidData.grow.getWingIsActive()),this.setUiListVisibleByItem(this.wingStarAry,0==this._curTab&&GuidData.grow.getWingIsActive()),0==a)this.tab0.selected=!0,this.tab1.selected=!1,UIManager.getInstance().addUIContainer(this.jinjiePanel),UIManager.getInstance().removeUIContainer(this.qianghuaPanel),this.jinjiePanel.drawInfo(),this._currentIdx=0,this.btnRedPoint.bindNode(52);else if(1==a){if(!GuidData.grow.getWingIsActive())return this.tab0.selected=!0,this.tab1.selected=!1,this._currentIdx=0,void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"请先激活神羽",99);this.tab0.selected=!1,this.tab1.selected=!0,UIManager.getInstance().removeUIContainer(this.jinjiePanel),UIManager.getInstance().addUIContainer(this.qianghuaPanel),this.qianghuaPanel.drawInfo(),this._currentIdx=1,this.btnRedPoint.bindNode(54)}var b=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);b.data=SharedDef.MODULE_WING,ModuleEventManager.dispatchEvent(b)},b.prototype.drawUnActiveInfo=function(){var a=TableData.getInstance().getData(TableData.tb_wings_bless,100);TableData.getInstance().getData(TableData.tb_wings_base,a.rank)},b.prototype.drawBaseWingInfo=function(){this.setSelectIdx(this._curTab);var a=GuidData.grow.getWingID();0==a&&(a=100);var b=TableData.getInstance().getData(TableData.tb_wings_bless,a),c=TableData.getInstance().getData(TableData.tb_wings_base,b.rank);LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.wingName.skinName,getChiNum(c.id)+"阶  "+c.name+"   +"+GuidData.grow.getWingQh(),16,TextAlign.CENTER,ColorType.Brown7a2f21),this.curWingID!=c.id&&(this.showDisPlay.setAvatar(c.model),this.curWingID=c.id),ArtFont.getInstance().writeFontToSkinNameCenter(this._baseUiAtlas,this.wingZl.skinName,Snum(getForceByAtt(b.attr_id,b.attr_value)),ArtFont.num56);for(var d=0;d<this.wingStarAry.length;d++)b.star>d?this.wingStarAry[d].goToAndStop(0):this.wingStarAry[d].goToAndStop(1);this.drawExp()},b.prototype.drawExp=function(){var a="已满级",b=1,c=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID()),d=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID()+1);d&&(a=GuidData.grow.getWingExp()+"/"+c.need_exp,b=GuidData.grow.getWingExp()/c.need_exp),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this.wingExp.skinName,a,14,TextAlign.CENTER,ColorType.Whiteffffff,"",0,0,!0),this.wingExPer.uvScale=b},b.prototype.show=function(a){void 0===a&&(a=0),UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),SceneManager.getInstance().render=!1,this.tab0&&this.setSelectIdx(a);var b=new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT);ModuleEventManager.dispatchEvent(b)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),UIManager.getInstance().removeUIContainer(this.jinjiePanel),UIManager.getInstance().removeUIContainer(this.qianghuaPanel),SceneManager.getInstance().render=!0,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)),a.prototype.hide.call(this)},b.prototype.wingIdChg=function(){this._baseRender.uiAtlas&&(this.drawBaseWingInfo(),this.jinjiePanel.drawInfo())},b.prototype.wingExpChg=function(){this._baseRender.uiAtlas&&(this.drawExp(),this.jinjiePanel.drawIconNum(),this.showExpEff())},b.prototype.showExpEff=function(){var a=this;console.log("up skill lev"),this._effRender||(this._effRender=new FrameUIRender,this.addRender(this._effRender),this._effRender.setImg(getEffectUIUrl("ui_cb"),3,4,function(b){a.expEff=b,a.expEff.x=70,a.expEff.y=422,a.expEff.width=1.5*a.expEff.baseRec.width,a.expEff.speed=5,a.expEff.playOne(a)})),this.expEff&&this.expEff.playOne(this)},b.prototype.wingLevChg=function(){this._baseRender.uiAtlas&&(this.drawBaseWingInfo(),this.qianghuaPanel.drawInfo())},b.prototype.showflyword=function(a){var b=new Vector2D(this.wingExPer.parent.x+this.wingExPer.width,this.wingExPer.y),c=UiTweenVo.getPosByPanel(b,{width:UIData.designWidth,height:UIData.designHeight});c.x=c.x*UIData.Scale,c.y=c.y*UIData.Scale,msgtip.MsgTipManager.outStr(ColorType.Yellowedce7e+"祝福值+"+a,msgtip.PopMsgVo.type8,c)},b.prototype.refreshItem=function(){this.jinjiePanel.hasStage?this.jinjiePanel.drawIconNum():this.qianghuaPanel.hasStage&&this.qianghuaPanel.drawIconNum()},b}(WindowUi);a.WingPanel=b;var c=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null},b.prototype.setUiAtlas=function(a){this._baseUiAtlas=a,this._baseRender.uiAtlas=a,this.addUIList(["t_line"],this._baseRender),this._title1=this._baseRender.getComponent("t_lab0"),this._title0=this._baseRender.getComponent("t_top_title0"),this._propAry=new Array,this._valAry=new Array;for(var b=0;7>b;b++){var c=this._baseRender.getComponent("t_lab"+(b+1));this.addChild(c),this._propAry.push(c);var d=this._baseRender.getComponent("t_val"+(b+1));this.addChild(d),this._valAry.push(d)}this._icon1=this._baseRender.getComponent("t_icon1"),this._icon2=this._baseRender.getComponent("t_icon2"),this._iconLab1=this._baseRender.getComponent("t_icon_lab1"),this._iconLab2=this._baseRender.getComponent("t_icon_lab2"),this._jinjieLab=this._baseRender.getComponent("t_sj_lab"),this.a_limit=this._baseRender.getComponent("a_limit"),this._btn=this._baseRender.getComponent("t_btn"),this.addChild(this._btn),this._btn.goToAndStop(1),this._jihuoLab=this._baseRender.getComponent("t_jihuo_lab"),this.drawInfo()},b.prototype.applyClick=function(){if(GuidData.grow.getWingIsActive()){var a=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID());if(1==a.operate_type){if(this._itemNeedNum>this._itemAllNum){var b=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return b.data=this._itemID,void ModuleEventManager.dispatchEvent(b)}if(this._costVal>GuidData.player.getResType(this._costType)){var b=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return b.data=this._costType,void ModuleEventManager.dispatchEvent(b)}NetManager.getInstance().protocolos.wings_bless()}else{if(this._costVal>GuidData.player.getResType(this._costType)){var b=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return b.data=this._costType,void ModuleEventManager.dispatchEvent(b)}NetManager.getInstance().protocolos.wings_rankup()}}else NetManager.getInstance().protocolos.wings_active()},b.prototype.drawInfo=function(){GuidData.grow.getWingIsActive()?this.drawBase():(this.drawUnActive(),this.parentPanel.showBtnBg(!0))},b.prototype.drawUnActive=function(){this._jihuoLab.parent||(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._jihuoLab.skinName,"激活后即可拥有一阶外观",16,TextAlign.LEFT,ColorType.Orange853d07),this.addChild(this._jihuoLab),this.addChild(this._title0)),this._btn.goToAndStop(0);for(var a=TableData.getInstance().getData(TableData.tb_wings_bless,100),b=(getForceByAtt(a.attr_id,a.attr_value),0);b<this._propAry.length;b++)UiDraw.drawAttVal(this._propAry[b],a.attr_id[b],a.attr_value[b])},b.prototype.drawBase=function(){this._jihuoLab&&this._jihuoLab.parent&&(this.removeChild(this._jihuoLab),this._jihuoLab=null,this.removeChild(this._title0)),this._title1.parent||this.addChild(this._title1);var a=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID()),b=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID()+1);1==a.operate_type?(this._btn.goToAndStop(1),this.removeChild(this.a_limit),this._icon1.parent||(this.addChild(this._icon1),this.addChild(this._icon2),this.addChild(this._iconLab1),this.addChild(this._iconLab2),this.removeChild(this._jinjieLab)),this.parentPanel.showBtnBg(!0)):2==a.operate_type?(this.removeChild(this._icon1),this.removeChild(this._icon2),this.removeChild(this._iconLab1),this.removeChild(this._iconLab2),this.addChild(this._jinjieLab),this.removeChild(this.a_limit),this._btn.goToAndStop(2),this.parentPanel.showBtnBg(!0)):0==a.operate_type&&(this.removeChild(this._icon1),this.removeChild(this._icon2),this.removeChild(this._iconLab1),this.removeChild(this._iconLab2),this.removeChild(this._jinjieLab),this.removeChild(this._btn),this.addChild(this.a_limit),this.parentPanel.showBtnBg(!1));for(var c=0;c<this._propAry.length;c++){UiDraw.drawAttVal(this._propAry[c],a.attr_id[c],a.attr_value[c]);b&&b.attr_value[c]?UiDraw.drawAddValTop(this._valAry[c],b.attr_value[c]-a.attr_value[c]):LabelTextFont.clearLabel(this._baseUiAtlas,this._valAry[c].skinName)}1==a.operate_type?(IconManager.getInstance().drawItemIcon40(this._icon1,a.item_cost[0][0]),IconManager.getInstance().drawItemIcon40(this._icon2,a.money_cost[0][0]),this.drawIconNum()):2==a.operate_type&&this.drawCost(this._jinjieLab.skinName)},b.prototype.drawIconNum=function(){var a=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID());a&&0!=a.length&&0!=a.item_cost.length&&(this._itemNeedNum=a.item_cost[0][1],this._itemAllNum=GuidData.bag.getItemCount(a.item_cost[0][0]),this._costVal=a.money_cost[0][1],this._costType=a.money_cost[0][0],this._itemID=a.item_cost[0][0],UiDraw.drawResHasNumAndAllNum(this._iconLab1,a.item_cost[0]),UiDraw.drawResHasNumAndAllNum(this._iconLab2,a.money_cost[0]))},b.prototype.drawCost=function(a){var b=this._baseRender.uiAtlas.getRec(a),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);UiDraw.cxtDrawImg(c,PuiData.TXTBG,new Rectangle(0,10,b.pixelWitdh,b.pixelHeight-10),UIData.publicUi);var d=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID());UiDraw.cxtDrawImg(c,UIuitl.getInstance().costtype(d.money_cost[0][0]),new Rectangle(5,0,35,35),UIData.publicUi),this._costVal=d.money_cost[0][1],this._costType=d.money_cost[0][0],LabelTextFont.writeSingleLabelToCtxSetAnchor(c,ColorType.Orange7a2f21+String(d.money_cost[0][1]),16,b.pixelWitdh-5,13,TextAlign.RIGHT),this._baseUiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b}(UIConatiner);a.WingJinjiePanel=c;var d=function(a){function b(){var b=a.call(this)||this;return b.width=960,b.height=540,b.center=0,b.middle=0,b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null},b.prototype.setUiAtlas=function(a){this._baseUiAtlas=a,this._baseRender.uiAtlas=a,this.addUIList(["t_top_title2","t_line2"],this._baseRender),this._qhLev=this._baseRender.getComponent("t_qianghua_lev"),this.addChild(this._qhLev),this._qhNextLev=this._baseRender.getComponent("t_qianghua_nextlev"),this.addChild(this._qhNextLev),this.a_arrow=this._baseRender.getComponent("a_arrow"),this.addChild(this.a_arrow),this.aA_limit=this._baseRender.getComponent("a_limit"),this._propAry=new Array,this._valAry=new Array;for(var b=0;7>b;b++){var c=this._baseRender.getComponent("t_lab"+(b+1)+"_qh");this.addChild(c),this._propAry.push(c);var d=this._baseRender.getComponent("t_val"+(b+1)+"_qh");this.addChild(d),this._valAry.push(d)}this._icon1=this._baseRender.getComponent("t_icon1_qh"),this.addChild(this._icon1),this._icon2=this._baseRender.getComponent("t_icon2_qh"),this.addChild(this._icon2),this._iconLab1=this._baseRender.getComponent("t_icon_lab1_qh"),this.addChild(this._iconLab1),this._iconLab2=this._baseRender.getComponent("t_icon_lab2_qh"),this.addChild(this._iconLab2),this._btn=this._baseRender.getComponent("t_btn_qh"),this.addChild(this._btn),this._btn.goToAndStop(3),this._qhLab3=this._baseRender.getComponent("t_qianghua_lab3"),this.addChild(this._qhLab3),this._qhVal3=this._baseRender.getComponent("t_qianghua_val3"),this.addChild(this._qhVal3),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._qhLab3.skinName,"当前成功率:",14,TextAlign.LEFT,ColorType.Orange7a2f21),this.drawInfo()},b.prototype.applyClick=function(){if(this._itemNeedNum>this._itemAllNum){var a=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);return a.data=this._itemID,void ModuleEventManager.dispatchEvent(a)}if(this._costVal>GuidData.player.getResType(this._costType)){var a=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);
return a.data=this._costType,void ModuleEventManager.dispatchEvent(a)}NetManager.getInstance().protocolos.wings_strength()},b.prototype.drawInfo=function(){LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._qhLev.skinName,ColorType.Orange7a2f21+"强化:"+ColorType.Orange9a683f+GuidData.grow.getWingQh(),16,TextAlign.LEFT);var a=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID());if(a){for(var b=TableData.getInstance().getData(TableData.tb_wings_strength,GuidData.grow.getWingQh()),c=TableData.getInstance().getData(TableData.tb_wings_strength,GuidData.grow.getWingQh()+1),d=0;d<this._propAry.length;d++){a.attr_id[d]?b?(UiDraw.drawAttVal(this._propAry[d],b.attr_id[d],b.attr_value[d]),c?UiDraw.drawAddValRight(this._valAry[d],c.attr_value[d]):UiDraw.clearUI(this._valAry[d])):c&&(UiDraw.drawAttVal(this._propAry[d],c.attr_id[d],0),UiDraw.drawAddValRight(this._valAry[d],c.attr_value[d])):(UiDraw.clearUI(this._propAry[d]),UiDraw.clearUI(this._valAry[d]))}c?(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._qhVal3.skinName,(c?float2int(c.possibility/100):0)+"%",14,TextAlign.RIGHT,ColorType.color4392ff),IconManager.getInstance().drawItemIcon40(this._icon1,c.item_cost[0][0]),IconManager.getInstance().drawItemIcon40(this._icon2,c.money_cost[0][0]),this.drawIconNum(),this.parentPanel.showBtnBg(!0),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._qhNextLev.skinName,ColorType.Orange7a2f21+"强化:"+ColorType.Orange9a683f+(GuidData.grow.getWingQh()+1),16,TextAlign.RIGHT)):(this.removeChild(this._qhVal1),this.removeChild(this._qhVal2),this.removeChild(this._qhVal3),this.removeChild(this._icon1),this.removeChild(this._icon2),this.removeChild(this._iconLab1),this.removeChild(this._iconLab2),this.removeChild(this._qhLab1),this.removeChild(this._qhLab2),this.removeChild(this._qhLab3),this.removeChild(this._btn),this.removeChild(this._qhNextLev),this.removeChild(this.a_arrow),this.parentPanel.showBtnBg(!1),this.addChild(this.aA_limit))}},b.prototype.drawIconNum=function(){var a=TableData.getInstance().getData(TableData.tb_wings_strength,GuidData.grow.getWingQh()+1);a&&(this._itemNeedNum=a.item_cost[0][1],this._itemAllNum=GuidData.bag.getItemCount(a.item_cost[0][0]),this._itemID=a.item_cost[0][0],this._costType=a.money_cost[0][0],this._costVal=a.money_cost[0][1],UiDraw.drawResHasNumAndAllNum(this._iconLab1,a.item_cost[0]),UiDraw.drawResHasNumAndAllNum(this._iconLab2,a.money_cost[0]))},b.prototype.drawCost=function(a){var b=this._baseRender.uiAtlas.getRec(a),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);UiDraw.cxtDrawImg(c,PuiData.TXTBG,new Rectangle(0,0,b.pixelWitdh,b.pixelHeight),UIData.publicUi);var d=TableData.getInstance().getData(TableData.tb_wings_strength,GuidData.grow.getWingQh()+1);UiDraw.drawCost(c,5,2,d.money_cost[0][0]),this._costVal=d.money_cost[0][1],this._costType=d.money_cost[0][0];var e=""+d.money_cost[0][1];LabelTextFont.writeSingleLabelToCtx(c,e,16,b.pixelWitdh-c.measureText(e).width-15,5,TextAlign.LEFT,ColorType.Orange7a2f21,"",!0),this._baseUiAtlas.updateCtx(c,b.pixelX,b.pixelY)},b}(UIConatiner);a.WingQianghuaPanel=d}(wing||(wing={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wing;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"WingModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.WingModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_WING_PANEL_EVENT="show_wing_panel_event",b.WING_ID_CHANG_EVENT="wing_id_chang_event",b.WING_EXP_CHANG_EVENT="wing_exp_chang_event",b.WING_LEV_CHANG_EVENT="wing_lev_chang_event",b.EFF_EVENT="EFF_EVENT",b}(BaseEvent);a.WingEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"WingProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_WING_PANEL_EVENT?this.showWingPanel(b.data):b.type==c.WING_ID_CHANG_EVENT?(this._wingPanel&&this._wingPanel.wingIdChg(),this.refreshNode()):b.type==c.WING_EXP_CHANG_EVENT?this._wingPanel&&this._wingPanel.wingExpChg():b.type==c.WING_LEV_CHANG_EVENT?this._wingPanel&&this._wingPanel.wingLevChg():b.type==c.EFF_EVENT&&this._wingPanel&&this._wingPanel.showflyword(b.data)}else if(a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT)this._wingPanel&&this._wingPanel.hasStage&&this._wingPanel.refreshItem(),this.refreshNode();else if(a.type==EngineEvent.MONEY_CHANGE||a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT)this.refreshNode();else if(a.type==EngineEvent.PLAYER_FIELD_LEVEL)this.sysOpen();else if(a instanceof UIPanelEvent){var d=a;d.panel==this._wingPanel&&(this._wingPanel.dispose(),this._wingPanel=null,console.log("释放面板 _wingPanel"))}},d.prototype.sysOpen=function(){this.refreshNode(),this._wingPanel&&this._wingPanel.showTab1()},d.prototype.showWingPanel=function(b){var c=this;this._wingPanel||(this._wingPanel=new a.WingPanel),this._wingPanel.load(function(){var a=0;b>0&&(a=b-1),c._wingPanel.show(a)},!0)},d.prototype.refreshNode=function(){if(GuidData.grow&&GuidData.grow.getWingIsActive()){var a=TableData.getInstance().getData(TableData.tb_wings_bless,GuidData.grow.getWingID());if(a){var b=RedPointManager.getInstance().getNodeByID(52);if(1==a.operate_type?GuidData.bag.getItemCount(a.item_cost[0][0])>=a.item_cost[0][1]&&hasEnoughRes(a.money_cost[0])?b.show=!0:b.show=!1:0==a.operate_type?b.show=!1:b.show=hasEnoughRes(a.money_cost[0]),GuidData.player.getsyspageopen(SharedDef.MODULE_WING,SharedDef.MODULE_WING_STRENGTH)){b=RedPointManager.getInstance().getNodeByID(54);var c=TableData.getInstance().getData(TableData.tb_wings_strength,GuidData.grow.getWingQh()+1);if(!c)return void(b.show=!1);GuidData.bag.getItemCount(c.item_cost[0][0])>=c.item_cost[0][1]&&hasEnoughRes(c.money_cost[0])?b.show=!0:b.show=!1}}}},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_WING_PANEL_EVENT),new c(c.WING_ID_CHANG_EVENT),new c(c.WING_EXP_CHANG_EVENT),new c(c.WING_LEV_CHANG_EVENT),new c(c.EFF_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.PLAYER_FIELD_LEVEL)]},d}(BaseProcessor);a.WingProcessor=d}(wing||(wing={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),meridian;!function(a){var b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._canclick=!0,b}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.BUY_BG=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"BUY_BG",0,5,560,90,10,10),b.addChild(this.BUY_BG),this.BUY_ICON=this.creatSUI(d,this.parentTarget.baseAtlas,"BUY_ICON",15,15,68,68),b.addChild(this.BUY_ICON),this.BUY_NAME=this.creatSUI(d,this.parentTarget.baseAtlas,"BUY_NAME",90,23,80,18),b.addChild(this.BUY_NAME),this.BUY_GET_RES=this.creatSUI(d,this.parentTarget.baseAtlas,"BUY_GET_RES",90,55,200,18),b.addChild(this.BUY_GET_RES),this.BUY_HAS_RES=this.creatSUI(d,this.parentTarget.baseAtlas,"BUY_HAS_RES",240,23,140,18),b.addChild(this.BUY_HAS_RES),this.BUY_BUT=this.creatSUI(c,this.parentTarget.baseAtlas,"BUY_BUT",430,21,120,54),b.addChild(this.BUY_BUT),this.BUY_BUT.addEventListener(InteractiveEvent.Up,this.butClik,this),this.BUY_BUT_TXT=this.creatSUI(d,this.parentTarget.baseAtlas,"BUY_BUT_TXT",450,38,80,18),b.addChild(this.BUY_BUT_TXT)},b.prototype.butClik=function(a){var b=this;if(UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this._canclick&&(this._canclick=!1,TimeUtil.addTimeOut(500,function(){b._canclick=!0}),UiTweenScale.getInstance().changeButSize(a.target),this.itdata&&this.itdata.data)){var c=this.itdata.data,d=GuidData.bag.getItemCount(c.itemId);d>0?NetManager.getInstance().protocolos.add_meridian_exp(c.id):ModulePageManager.openPanel(c["goto"],c.goto_sub)}},b.prototype.refreshDraw=function(){this.render(this.itdata)},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():this.setnull()},b.prototype.setnull=function(){UiDraw.clearUI(this.BUY_BG),UiDraw.clearUI(this.BUY_BUT),UiDraw.clearUI(this.BUY_BUT_TXT),UiDraw.clearUI(this.BUY_ICON),UiDraw.clearUI(this.BUY_HAS_RES),UiDraw.clearUI(this.BUY_NAME),UiDraw.clearUI(this.BUY_GET_RES)},b.prototype.applyRender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;IconManager.getInstance().drawItemIcon60(this.BUY_ICON,a.itemId,1),UiDraw.uiAtlasDrawImg(this.uiAtlas,this.BUY_BG.skinName,UIData.publicUi,PuiData.Slist_nselect),LabelTextFont.writeSingleLabel(this.uiAtlas,this.BUY_NAME.skinName,ColorType.Brown7a2f21+a.name,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this.uiAtlas,this.BUY_GET_RES.skinName,ColorType.color9a683f+"增加穴位修炼经验"+a.exp+"点",16,TextAlign.LEFT),this.changeHasItemNum(GuidData.bag.getItemCount(a.itemId))}},b.prototype.changeHasItemNum=function(a){var b="U_BUY_BUT_B",c="购买";a>0&&(b="U_BUY_BUT_A",c="使用"),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.BUY_BUT.skinName,b),LabelTextFont.writeSingleLabel(this.uiAtlas,this.BUY_BUT_TXT.skinName,ColorType.Brown7a2f21+c,16,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.BUY_HAS_RES.skinName,ColorType.Brown7a2f21+"拥有："+a,16,TextAlign.LEFT)},b}(SListItem);a.MeridianBuyListRender=b;var c=function(a){function c(){return a.call(this)||this}return __extends(c,a),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,b,560,400,512,100,4,512,1024,1,7)},c.prototype.resetData=function(){if(this._tbDataArr)this.refreshVo();else{this._tbDataArr=new Array;for(var a=tb.TB_meridian_item.getItem(),b=0;b<a.length;b++){var c=new SListItemData;c.data=a[b],this._tbDataArr.push(c)}this.refreshData(this._tbDataArr)}},c.prototype.refreshVo=function(){this.refreshDraw()},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.resetData()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.MeridianBuyList=c;var d=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,this.meridianBuyList&&(this.meridianBuyList.dispose(),this.meridianBuyList=null),a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;GameData.getPublicUiAtlas(function(b){a.winmidRender.uiAtlas=b,a._midRender.uiAtlas.setInfo("ui/uidata/meridian/meridian.xml","ui/uidata/meridian/meridian.png",function(){a.loadConfigCom()},"ui/uidata/meridian/meridianuse.png")})},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.meridianBuyList.show()},b.prototype.hide=function(){this.meridianBuyList.hide(),UIManager.getInstance().removeUIContainer(this)},b.prototype.butClik=function(a){switch(a.target){case this.baseBg:this.hide();break;case this.e_close:this.hide()}},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._topRender.getComponent("b_win_tittle")),this.b_list_pos=this.addChild(this._topRender.getComponent("b_list_pos")),this.initList(),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.resize=function(){a.prototype.resize.call(this),this.meridianBuyList&&(this.meridianBuyList.left=this.b_list_pos.parent.x/UIData.Scale+this.b_list_pos.x,this.meridianBuyList.top=this.b_list_pos.parent.y/UIData.Scale+this.b_list_pos.y)},b.prototype.initList=function(){this.meridianBuyList=new c,this.meridianBuyList.init(this._midRender.uiAtlas)},b}(WindowMinUi);a.MeridianBuyPanel=d}(meridian||(meridian={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),meridian;!function(a){var b=function(){function a(){}return a}();a.MeridianListVo=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.S_NAME=this.creatSUI(d,this.parentTarget.baseAtlas,"S_NAME",10,6,80,18),b.addChild(this.S_NAME),this.S_NUM=this.creatSUI(d,this.parentTarget.baseAtlas,"S_NUM",117,6,60,18),b.addChild(this.S_NUM),this.S_EXP=this.creatSUI(d,this.parentTarget.baseAtlas,"S_EXP",190,6,80,18),b.addChild(this.S_EXP),this.S_TO_BUT=this.creatSUI(d,this.parentTarget.baseAtlas,"S_TO_BUT",275,1,65,31),b.addChild(this.S_TO_BUT),this.S_TO_BUT.addEventListener(InteractiveEvent.Up,this.butClik,this),this.S_BG=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"S_BG",0,0,342,32,10,10),b.addChild(this.S_BG)},b.prototype.butClik=function(a){if(this.itdata&&this.itdata.data){var b=this.itdata.data;switch(console.log("---$vo.tb---",b.tb),b.tb["goto"][0]){case 1:GuidData.player.getsyspageopen(b.tb["goto"][1],b.tb["goto"][2])?ModulePageManager.openPanel(b.tb["goto"][1],b.tb["goto"][2]):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"系统未开启",99)}console.log(b.tb["goto"])}},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():this.setnull()},b.prototype.setnull=function(){},b.prototype.applyRender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_NAME.skinName,ColorType.color9a683f+a.tb.name,14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_NUM.skinName,ColorType.color9a683f+"("+a.progress+"/"+a.tb.limit+")",14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this.uiAtlas,this.S_EXP.skinName,ColorType.color9a683f+a.tb.exp,14,TextAlign.CENTER),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.S_TO_BUT.skinName,"U_TO_PLAY"),a.tb.id%2==0?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.S_BG.skinName,"U_LIST_BG"):this.uiAtlas.clearCtxTextureBySkilname(this.S_BG.skinName)}},b}(SListItem);a.MeridianListRender=c;var d=function(a){function d(){return a.call(this)||this}return __extends(d,a),d.prototype.init=function(a){this.baseAtlas=a,this.initData()},d.prototype.initData=function(){var a=new Array;this.setData(a,c,342,160,256,32,5,256,512,1,9)},d.prototype.resetData=function(){var a=GuidData.grow.getSpellIntFieldMeridianCnt(),c=new Array,d=tb.TB_meridian_source.getItem();console.log("$severData",a);for(var e=0;e<d.length;e++){var f=new SListItemData,g=new b;g.tb=d[e],g.progress=a[g.tb.id-1],f.data=g,f.id=e,c.push(f)}this.refreshData(c)},d.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.resetData()},d.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},d}(SList);a.MeridianList=d;var e=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.a_valueItem=new Array,a.a_upItem=new Array,a.canXiulian=!1,a.lastPicId=0,a.greedItem=new Array,a._canclick=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._effRender=new FrameUIRender,a.addRender(a._effRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this._effRender&&(this._effRender.dispose(),this._effRender=null),this.meridianList&&(this.meridianList.dispose(),this.meridianList=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this._midRender.uiAtlas.setInfo("ui/uidata/meridian/meridian.xml","ui/uidata/meridian/meridian.png",function(){a.loadConfigCom()},"ui/uidata/meridian/meridianuse.png")},c.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_bottom_bg")),this.a_list_pos=this.addChild(this._midRender.getComponent("a_list_pos")),this.addChild(this._midRender.getComponent("a_right_label_bg")),this.addChild(this._topRender.getComponent("a_label2")),this.addChild(this._midRender.getComponent("a_label_9_bg2")),this.addChild(this._midRender.getComponent("a_label_9_bg1")),this.addChild(this._midRender.getComponent("a_label_9_bg0")),this.a_jindu_bg=this.addChild(this._midRender.getComponent("a_jindu_bg")),this.addChild(this._midRender.getComponent("a_centen_label_bg")),this.addChild(this._midRender.getComponent("a_left_pic_bg")),this.a_left_pic_name=this.addChild(this._topRender.getComponent("a_left_pic_name")),this.a_but_bg=this.addEvntButUp("a_but_bg",this._midRender),this._redPointRender.getRedPointUI(this,81,new Vector2D(this.a_but_bg.x+this.a_but_bg.width,this.a_but_bg.y)),this.addChild(this._midRender.getComponent("a_win_tittle")),this.addChild(this._midRender.getComponent("a_zhanli_label")),this.a_curlev=this.addChild(this._midRender.getComponent("a_curlev")),this.a_zhanli_num=this.addChild(this._midRender.getComponent("a_zhanli_num")),this.a_label0=this.addChild(this._midRender.getComponent("a_label0")),this.a_xiulian_but=this.addChild(this._topRender.getComponent("a_xiulian_but")),this.a_tupo_but=this.addChild(this._topRender.getComponent("a_tupo_but")),this.a_jindu_bar=this.addChild(this._midRender.getComponent("a_jindu_bar")),this.a_exp_but=this.addEvntButUp("a_exp_but",this._topRender),this._redPointRender.getRedPointUI(this,117,new Vector2D(this.a_exp_but.x+this.a_exp_but.width,this.a_exp_but.y)),this.addChild(this._midRender.getComponent("a_info")),this.addChild(this._midRender.getComponent("a_pic")),this.a_point_line_bg=this.addChild(this._topRender.getComponent("a_point_line_bg")),this.a_exp_txt=this.addChild(this._topRender.getComponent("a_exp_txt")),this.a_tupo_use_res=this.addChild(this._topRender.getComponent("a_tupo_use_res"));for(var a=0;7>a;a++)this.a_valueItem.push(this.addChild(this._topRender.getComponent("a_value_txt"+a))),this.a_upItem.push(this.addChild(this._topRender.getComponent("a_value_up"+a)));this.a_bar_move_point=this.addChild(this._topRender.getComponent("a_bar_move_point")),this.a_limit=this.addChild(this._topRender.getComponent("a_limit")),this.xiulianUiList=[this.a_jindu_bg,this.a_xiulian_but,this.a_jindu_bar,this.a_bar_move_point,this.a_exp_txt],this.tuPoUiList=[this.a_tupo_but,this.a_tupo_use_res],this.initList(),this.initRightBg(),this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.initRightBg=function(){var a=this.addChild(this.winmidRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(a,"a_right_bg_top",this._midRender);var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(b,"a_right_bg_bottom",this._midRender),this.winmidRender.applyObjData()},c.prototype.initList=function(){this.meridianList=new d,this.meridianList.init(this._midRender.uiAtlas)},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.meridianList.show(),this.refresh(!0)},c.prototype.resize=function(){b.prototype.resize.call(this),this.meridianList&&(this.meridianList.left=this.a_list_pos.parent.x/UIData.Scale+this.a_list_pos.x+3,this.meridianList.top=this.a_list_pos.parent.y/UIData.Scale+this.a_list_pos.y+5)},c.prototype.getPicId=function(a){return Math.floor(Math.max(a,0)/8)+1},c.prototype.getCurLev=function(a){return Math.floor(Math.max(a-1,0)/8)},c.prototype.refresh=function(a){if(void 0===a&&(a=!1),this.uiAtlasComplet){var b=GuidData.grow.getSpellIntFieldMeridianLevel(0),c=GuidData.grow.getSpellIntFieldMeridianExp();this.selectTb=tb.TB_meridian_info.getTempVo(b);var d=tb.TB_meridian_info.getItem(),e=d[d.length-1].id<=b;if(e)this.drawComplete();else{this.mathValuesLabel();var f=tb.TB_meridian_info.getTempVo(b+1),g=!0;if(g=f.costMoney.length?!0:!1,this.setUiListVisibleByItem([this.a_limit],!1),this.setUiListVisibleByItem(this.tuPoUiList,g),this.setUiListVisibleByItem(this.xiulianUiList,!g),g)LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_tupo_use_res.skinName,ColorType.Orange7a2f21+"消耗"+getResName(f.costMoney[0][0])+(hasEnoughRes(f.costMoney[0])?ColorType.Green2ca937:ColorType.colorce0a00)+f.costMoney[0][1],14,TextAlign.CENTER),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_label0.skinName,ColorType.Orange7a2f21+"筋脉突破",14,TextAlign.CENTER);else{var h=tb.TB_meridian_info.getTempVo(b+1);this.canXiulian=c>=h.costExp,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_exp_txt.skinName,ColorType.Whiteffffff+c+"/"+h.costExp,14,TextAlign.CENTER);var i=Math.min(c/h.costExp,1);this.a_jindu_bar.uvScale=i,0>=i||i>=1?this.a_bar_move_point.x=1e4:this.a_bar_move_point.x=this.a_jindu_bar.x+this.a_jindu_bar.width*i-this.a_bar_move_point.width/2,LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_label0.skinName,ColorType.Orange7a2f21+"穴位修炼进度",14,TextAlign.CENTER)}}this.upToPicById(this.selectTb.pic),this.drawPointToPic(this.getPicId(this.selectTb.id),this.getCurLev(this.selectTb.id)),a||this.showSkillUpEff(),this._istupoOrxiulian=g,this.setForce(),this.curAttr(e)}},c.prototype.setForce=function(){ArtFont.getInstance().writeFontToSkinName(this._topRender.uiAtlas,this.a_zhanli_num.skinName,String(GuidData.player.getPlayerIntFieldMeridianForce()),ArtFont.num53,TextAlign.LEFT)},c.prototype.drawComplete=function(){this.setUiListVisibleByItem(this.xiulianUiList,!1),this.setUiListVisibleByItem(this.tuPoUiList,!1),this.setUiListVisibleByItem([this.a_but_bg],!1),this.setUiListVisibleByItem([this.a_limit],!0)},c.prototype.upToPicById=function(a){this._topRender.uiAtlas.upDataPicToTexture("ui/load/meridian/name/"+a+".png",this.a_left_pic_name.skinName),this._topRender.uiAtlas.upDataPicToTexture("ui/load/meridian/pic/"+a+".png",this.a_point_line_bg.skinName)},c.prototype.mathValuesLabel=function(){var a=tb.TB_meridian_info.getTempVo(this.selectTb.id+1);a.refrishById(GuidData.player.getCharType()),this.selectTb.refrishById(GuidData.player.getCharType());for(var b=0;b<a.attrKeys.length;b++){var c=a.attrValues[b]-this.selectTb.attrValues[b];UiDraw.drawAddValTop(this.a_upItem[b],c)}},c.prototype.curAttr=function(a){this.selectTb.refrishById(GuidData.player.getCharType());for(var b=0;b<this.selectTb.attrKeys.length;b++)UiDraw.drawAttVal(this.a_valueItem[b],this.selectTb.attrKeys[b],this.selectTb.attrValues[b]),this.a_valueItem[b].x=a?689:602},c.prototype.drawPointToPic=function(a,b){this.clearGreedPoint();for(var c=tb.TB_meridian_info.getItem(),d=0;d<c.length;d++)if(this.getPicId(c[d].id)==a&&this.getCurLev(c[d].id)==b&&c[d].id<=this.selectTb.id&&c[d].pos.length){var e=this.addChild(this._topRender.getComponent("a_greed_point"));e.x=c[d].pos[0]-15,e.y=c[d].pos[1]-16,this.greedItem.push(e),console.log(e)}console.log("------------")},c.prototype.showSkillUpEff=function(){var a=this,b=this.greedItem[this.greedItem.length-1];b&&(console.log("up skill lev",b),this.upLevEff?(this.upLevEff.x=b.x-11,this.upLevEff.y=b.y-11,this.upLevEff.playOne(this)):this._effRender.setImg(getEffectUIUrl("ui_jn"),4,4,function(c){a.upLevEff=c,a.upLevEff.x=b.x-10,a.upLevEff.y=b.y-10,a.upLevEff.width=.4*a.upLevEff.baseRec.width,a.upLevEff.height=.4*a.upLevEff.baseRec.height,a.upLevEff.speed=1,a.upLevEff.playOne(a)}))},c.prototype.clearGreedPoint=function(){for(;this.greedItem.length;)this.removeChild(this.greedItem.pop())},c.prototype.hide=function(){this.meridianList.hide(),UIManager.getInstance().removeUIContainer(this),b.prototype.hide.call(this)},c.prototype.butClik=function(b){var c=this;switch(b.target){case this.w_close:this.hide();break;case this.a_but_bg:if(this._canclick)if(UiTweenScale.getInstance().changeButSize(b.target),this._canclick=!1,TimeUtil.addTimeOut(btnClickTime,function(){c._canclick=!0}),this._istupoOrxiulian){console.log("请求突破",this.selectTb.costMoney);var d=tb.TB_meridian_info.getTempVo(this.selectTb.id+1);if(GuidData.player.getResType(d.costMoney[0][0])>=d.costMoney[0][1])NetManager.getInstance().protocolos.meridian_practise();else{var e=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);e.data=d.costMoney[0][0],ModuleEventManager.dispatchEvent(e)}}else this.canXiulian?NetManager.getInstance().protocolos.meridian_practise():msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"不可修炼",99);break;case this.a_exp_but:UiTweenScale.getInstance().changeButSize(b.target),ModuleEventManager.dispatchEvent(new a.MeridianEvent(a.MeridianEvent.SHOW_MERIDIAN_BUY_EVENT))}},c}(WindowUi);a.MeridianPanel=e}(meridian||(meridian={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),meridian;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_MERIDIAN_EVENT="SHOW_MERIDIAN_EVENT",b.SHOW_MERIDIAN_BUY_EVENT="SHOW_MERIDIAN_BUY_EVENT",b.REFRISH_MERIDIAL_PANEL="REFRISH_MERIDIAL_PANEL",b.CHG_MERIDIAL_FORCE="CHG_MERIDIAL_FORCE",b.REFRISH_MERIDIAL_LIST="REFRISH_MERIDIAL_LIST",b}(BaseEvent);a.MeridianEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MeridianModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.MeridianModule=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.getName=function(){return"MeridianProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;c.type==b.SHOW_MERIDIAN_EVENT?this.showPanel():c.type==b.SHOW_MERIDIAN_BUY_EVENT?this.showMeridianBuyPanel():c.type==b.CHG_MERIDIAL_FORCE?this.meridianPanel&&this.meridianPanel.hasStage&&this.meridianPanel.setForce():c.type==b.REFRISH_MERIDIAL_PANEL?(this.meridianPanel&&this.meridianPanel.hasStage&&this.meridianPanel.refresh(),this.refreshNode()):c.type==b.REFRISH_MERIDIAL_LIST&&this.meridianPanel&&this.meridianPanel.meridianList&&this.meridianPanel.meridianList.hasStage&&this.meridianPanel.meridianList.resetData()}else if(a instanceof EngineEvent)(a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT||a.type==EngineEvent.MONEY_CHANGE||a.type==EngineEvent.SYSTEM_OPEN_EVENT)&&this.refreshNode();else if(a instanceof charbg.CharBgEvent)a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT&&(this.refreshNode(),this.meridianBuyPanel&&this.meridianBuyPanel.meridianBuyList&&this.meridianBuyPanel.meridianBuyList.hasStage&&this.meridianBuyPanel.meridianBuyList.refreshVo());else if(a instanceof UIPanelEvent){var d=a;d.panel==this.meridianPanel?(this.meridianPanel.dispose(),this.meridianPanel=null,console.log("释放面板 meridianPanel")):d.panel==this.meridianBuyPanel&&(this.meridianBuyPanel.dispose(),this.meridianBuyPanel=null,console.log("释放面板 meridianBuyPanel"))}},d.prototype.showPanel=function(){var b=this;this.meridianPanel||(this.meridianPanel=new a.MeridianPanel),this.meridianPanel.load(function(){b.meridianPanel.show()},!1)},d.prototype.showMeridianBuyPanel=function(){var b=this;this.meridianBuyPanel||(this.meridianBuyPanel=new a.MeridianBuyPanel),this.meridianBuyPanel.load(function(){b.meridianBuyPanel.show()},!1)},d.prototype.refreshNode=function(){if(GuidData.player.getsyspageopen(SharedDef.MODULE_TCM,SharedDef.MODULE_TCM_ALL)){var a=GuidData.grow.getSpellIntFieldMeridianLevel(0),b=(GuidData.grow.getSpellIntFieldMeridianLevel(1),GuidData.grow.getSpellIntFieldMeridianExp()),c=tb.TB_meridian_info.getItem();if(c[c.length-1].id<=a)return RedPointManager.getInstance().getNodeByID(81).show=!1,void(RedPointManager.getInstance().getNodeByID(117).show=!1);RedPointManager.getInstance().getNodeByID(117).show=!1;for(var d=tb.TB_meridian_item.getItem(),e=0;e<d.length;e++)if(hasEnoughResItem([d[e].itemId,1])){RedPointManager.getInstance().getNodeByID(117).show=!0;break}var f,g=tb.TB_meridian_info.getTempVo(a+1);if(f=g.costMoney.length?!0:!1)return void(RedPointManager.getInstance().getNodeByID(81).show=hasEnoughRes(g.costMoney[0]));RedPointManager.getInstance().getNodeByID(81).show=b>=g.costExp}},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_MERIDIAN_EVENT),new b(b.REFRISH_MERIDIAL_PANEL),new b(b.REFRISH_MERIDIAL_LIST),new b(b.CHG_MERIDIAL_FORCE),new b(b.SHOW_MERIDIAN_BUY_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.MeridianProcessor=d}(meridian||(meridian={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),exterior;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this.G_BG=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"G_BG",0,0,530,88,10,10),b.addChild(this.G_BG),this.G_BG.addEventListener(InteractiveEvent.Down,this.butClik,this),this.iconAry=new Array,this.G_ICON0=this.creatSUI(d,this.parentTarget.baseAtlas,"G_ICON0",12,10,68,68),b.addChild(this.G_ICON0),this.G_ICON1=this.creatSUI(d,this.parentTarget.baseAtlas,"G_ICON1",87,10,68,68),b.addChild(this.G_ICON1),this.G_ICON2=this.creatSUI(d,this.parentTarget.baseAtlas,"G_ICON2",160,10,68,68),b.addChild(this.G_ICON2),this.iconAry.push(this.G_ICON0),this.iconAry.push(this.G_ICON1),this.iconAry.push(this.G_ICON2),this.G_NAME=this.creatSUI(d,this.parentTarget.baseAtlas,"G_NAME",240,20,300,18),b.addChild(this.G_NAME),this.G_INFO=this.creatSUI(d,this.parentTarget.baseAtlas,"G_INFO",240,45,300,18),b.addChild(this.G_INFO),this.G_LEFT_TOP=this.creatSUI(d,this.parentTarget.baseAtlas,"G_LEFT_TOP",2,2,47,41),b.addChild(this.G_LEFT_TOP)},b.prototype.butClik=function(a){this.itdata&&this.itdata.data&&this.setSelect();
},b.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():this.setnull()},b.prototype.setnull=function(){},b.prototype.applyRender=function(){if(this.itdata&&this.itdata.data)for(var a=this.itdata.data,b="收集:",c=ColorType.Brown7a2f21+"属性:",d=!0,e=0;e<a.exterior.length;e++){var f=GuidData.grow.isSpellIntFieldAppearanceById(a.exterior[e]),g=tb.TB_appearance_info.getTempVo(a.exterior[e]);b+="["+g.name+"]",IconManager.getInstance().drawItemIcon60(this.iconAry[e],g.icon,1,!f,!1),f?c+=ColorType.colorcd2000:(d=!1,c+=ColorType.color5f5c59);for(var h=0;h<a.attrKeys.length;h++)c+=getKeyProById(a.attrKeys[h])+" +"+a.attrValues[h]+";";LabelTextFont.writeSingleLabel(this.uiAtlas,this.G_NAME.skinName,ColorType.Brown7a2f21+b,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this.uiAtlas,this.G_INFO.skinName,c,16,TextAlign.LEFT),UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.G_BG.skinName,"U_BG"),d?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.G_LEFT_TOP.skinName,"U_LEFT_TOP"):this.uiAtlas.clearCtxTextureBySkilname(this.G_LEFT_TOP.skinName)}},b}(SListItem);a.IdentificationListRender=b;var c=function(a){function c(){var b=a.call(this)||this;return b.setShowLevel(12),b}return __extends(c,a),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,b,530,224,530,88,3,512,1024,1,5)},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this);for(var a=tb.TB_char_info.getTempVo(GuidData.player.getCharType()).waiguantj,b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=tb.TB_appearance_pokedex.getTempVo(a[c]),d.id=c,b.push(d)}this.refreshData(b)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.IdentificationList=c;var d=function(a){function b(){var b=a.call(this)||this;return b.uiAtlasComplet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._midRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/exterior/identification/identification.xml","ui/uidata/exterior/identification/identification.png",function(){a.loadConfigCom()},"ui/uidata/exterior/identification/identificationuse.png")},b.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._bottomRender.getComponent("a_list_title")),this.a_zhanli_num=this.addChild(this._bottomRender.getComponent("a_zhanli_num")),this.addChild(this._bottomRender.getComponent("a_zhanli_label")),this.addChild(this._bottomRender.getComponent("a_win_tittle")),this.addChild(this._bottomRender.getComponent("a_list_bg")),this.a_list_pos=this.addChild(this._bottomRender.getComponent("a_list_pos")),this.sxItem=new Array;for(var a=0;6>a;a++)this.sxItem.push(this.addChild(this._bottomRender.getComponent("a_sx_"+a)));this.initList(),this.uiAtlasComplet=!0,this.applyLoadComplete()},b.prototype.initList=function(){this.identificationList=new c,this.identificationList.init(this._midRender.uiAtlas)},b.prototype.butClik=function(a){switch(a.target){case this.baseBg:case this.e_close:this.hide()}},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.identificationList.hide()},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.identificationList.show(),this.refrish()},b.prototype.refrish=function(){for(var a=tb.TB_char_info.getTempVo(GuidData.player.getCharType()).waiguantj,b=new Object,c=0;c<a.length;c++){for(var d=tb.TB_appearance_pokedex.getTempVo(a[c]).exterior,e=!0,f=0;f<d.length;f++){var g=GuidData.grow.isSpellIntFieldAppearanceById(d[f]);g||(e=!1)}if(e)for(var h=0;h<d.length;h++)for(var i=tb.TB_appearance_info.getTempVo(d[h]),f=0;f<i.attrKeys.length;f++)b[i.attrKeys[f]]||(b[i.attrKeys[f]]=0),b[i.attrKeys[f]]+=i.attrValues[f]}var j=0,k=new Array,l=new Array;for(var m in b)UiDraw.drawAttVal(this.sxItem[j++],Number(m),b[m]),k.push(Number(m)),l.push(b[m]);ArtFont.getInstance().writeFontToSkinNameCenter(this._topRender.uiAtlas,this.a_zhanli_num.skinName,String(getForceByAtt(k,l)),ArtFont.num56,3)},b.prototype.resize=function(){a.prototype.resize.call(this),this.identificationList&&(this.identificationList.left=this.a_list_pos.parent.x/UIData.Scale+this.a_list_pos.x,this.identificationList.top=this.a_list_pos.parent.y/UIData.Scale+this.a_list_pos.y)},b}(WindowMinUi);a.IdentificationPanel=d}(exterior||(exterior={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),exterior;!function(a){var b=function(){function a(){}return a}();a.ExteriorCellVo=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);this._customRenderAry[0];this.G_BG=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"G_BG",0,0,230,90,10,10),a.addChild(this.G_BG),this.G_BG.addEventListener(InteractiveEvent.Down,this.butClik,this),this.G_MASK=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"G_MASK",0,0,230,90,10,10),a.addChild(this.G_MASK),this.G_ICON=this.creatSUI(d,this.parentTarget.baseAtlas,"G_ICON",12,10,68,68),a.addChild(this.G_ICON),this.G_NAME=this.creatSUI(d,this.parentTarget.baseAtlas,"G_NAME",90,20,100,18),a.addChild(this.G_NAME),this.G_USE_INFO=this.creatSUI(d,this.parentTarget.baseAtlas,"G_USE_INFO",90,45,100,18),a.addChild(this.G_USE_INFO),this.G_TIP_PIC=this.creatSUI(d,this.parentTarget.baseAtlas,"G_TIP_PIC",188,1,30,60),a.addChild(this.G_TIP_PIC),this.G_RED=this.creatSUI(d,this.parentTarget.baseAtlas,"G_Red",195,3,17,16),this.G_RED.preParent=a,UiDraw.uiAtlasDrawImg(this.uiAtlas,this.G_RED.skinName,UIData.publicUi,PuiData.A_RED_POINT)},c.prototype.butClik=function(a){this.itdata&&this.itdata.data&&this.setSelect()},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyRender():this.setnull()},c.prototype.setnull=function(){this.uiAtlas.clearCtxTextureBySkilname(this.G_BG.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.G_ICON.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.G_NAME.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.G_USE_INFO.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.G_TIP_PIC.skinName),this.uiAtlas.clearCtxTextureBySkilname(this.G_MASK.skinName),this.G_RED.preHide()},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.applyRender(),b&&this.itdata&&this.itdata.data){var c=new a.ExteriorEvent(a.ExteriorEvent.SELECT_EXTERIOR_CELL);c.exteriorCellVo=this.itdata.data,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.drawIcon=function(a){var b=this;IconManager.getInstance().getIcon(getExteriorIconUrl(a),function(a){var c=b.G_ICON.uiRender.uiAtlas.getRec(b.G_ICON.skinName),d=UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(0,0,68,68),UIData.publicUi),d.drawImage(a,0,0,60,60,4,4,60,60),b.G_ICON.uiRender.uiAtlas.updateCtx(d,c.pixelX,c.pixelY)})},c.prototype.applyRender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;a.node&&a.node.bindUI(this.G_RED),this.drawIcon(a.tb.icon),a.isUse?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.G_TIP_PIC.skinName,"U_TIP"):this.uiAtlas.clearCtxTextureBySkilname(this.G_TIP_PIC.skinName),this.selected?UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.G_BG.skinName,"U_BG_SELECT"):UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.G_BG.skinName,"U_BG"),a.isHave?this.uiAtlas.clearCtxTextureBySkilname(this.G_MASK.skinName):UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.G_MASK.skinName,"U_BG_NO");var b;b=a.isUse?"":a.isHave?"":"未收集",LabelTextFont.writeSingleLabel(this.uiAtlas,this.G_USE_INFO.skinName,ColorType.Yellowffecc6+b,16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this.uiAtlas,this.G_NAME.skinName,ColorType.Brown7a2f21+a.tb.name,16,TextAlign.LEFT)}else this.G_RED.preHide()},c}(SListItem);a.ExteriorListRender=c;var d=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,c,230,430,230,90,5,256,1024,1,9,1)},b.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.ExteriorList=d;var e=function(c){function e(){var a=c.call(this)||this;return a.uiAtlasComplet=!1,a.tabIndex=0,a.kkkb=!0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._redPointRender=new RedPointRender,a.addRender(a._redPointRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(e,c),e.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._bottomRender.dispose(),this._bottomRender=null,this._midRender.dispose(),this._midRender=null,this._topRender.dispose(),this._topRender=null,this._redPointRender.dispose(),this._redPointRender=null,this.mountRoleSprite.destory(),this.mountRoleSprite=null,c.prototype.dispose.call(this)},e.prototype.applyLoad=function(){var a=this;this.winmidRender.uiAtlas=WindowUi.winUIAtlas,this._midRender.uiAtlas.setInfo("ui/uidata/exterior/exterior.xml","ui/uidata/exterior/exterior.png",function(){a.loadConfigCom()},"ui/uidata/exterior/exterioruse.png")},e.prototype.loadConfigCom=function(){this._bgRender.uiAtlas=this._midRender.uiAtlas,this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this.a_tab0=this.addEvntBut("a_tab0",this._topRender),this.a_tab1=this.addEvntBut("a_tab1",this._topRender),this._redPointRender.getRedPointUI(this,21,new Vector2D(this.a_tab0.x+this.a_tab0.width-5,this.a_tab0.y)),this._redPointRender.getRedPointUI(this,24,new Vector2D(this.a_tab1.x+this.a_tab1.width-5,this.a_tab1.y)),this.addChild(this._bgRender.getComponent("a_basebg")),this.addChild(this._bottomRender.getComponent("a_rolebg")),this.addChild(this._bottomRender.getComponent("a_win_tittle")),this.addChild(this._bottomRender.getComponent("a_right_bg_top")),this.addChild(this._bottomRender.getComponent("a_right_bg_bottom")),this.addChild(this._bottomRender.getComponent("a_shuxing_label1")),this.addChild(this._bottomRender.getComponent("a_add_label2")),this.a_zhuangbei_ing=this.addChild(this._bottomRender.getComponent("a_zhuangbei_ing")),this.addChild(this._bottomRender.getComponent("a_zhanli_label")),this.a_zhanli_numAry=new Array;for(var a=0;5>a;a++)this.a_zhanli_numAry.push(this.addChild(this._topRender.getComponent("a_zhanli_num"+a)));this.a_tujian_icon=this.addEvntButUp("a_tujian_icon",this._bottomRender),this.addChild(this._bottomRender.getComponent("a_right_center_line")),this.addChild(this._bottomRender.getComponent("a_left_labe3")),this.a_select_name=this.addChild(this._topRender.getComponent("a_select_name")),this.a_left_list_pos=this.addChild(this._bottomRender.getComponent("a_left_list_pos")),this.a_big_but_bg=this.addEvntButUp("a_big_but_bg",this._bottomRender),this._btnRedPoint=this._redPointRender.getRedPointUI(this,0,new Vector2D(this.a_big_but_bg.x+this.a_big_but_bg.width,this.a_big_but_bg.y)),this.a_big_but_txt=this.addChild(this._bottomRender.getComponent("a_big_but_txt")),this.a_res_need_num=this.addChild(this._bottomRender.getComponent("a_res_need_num")),this.a_res_need_icon=this.addChild(this._bottomRender.getComponent("a_res_need_icon")),this.a_valueItem=new Array,this.a_upItem=new Array;for(var a=0;5>a;a++)this.a_valueItem.push(this.addChild(this._topRender.getComponent("a_value_txt"+a))),this.a_upItem.push(this.addChild(this._topRender.getComponent("a_value_up"+a)));this.mountRoleSprite=new Person2DChar,this._bottomRender.addModel(this.mountRoleSprite),this.initRightBg(),this.initList(),this.uiAtlasComplet=!0,this.applyLoadComplete()},e.prototype.resizeRole=function(){this.mountRoleSprite&&(this.mountRoleSprite.resize(),this.mountRoleSprite.scale=this._scale*UIData.Scale,this.mountRoleSprite.rotationY=0,this.mountRoleSprite.y=this._posy*UIData.Scale)},e.prototype.initList=function(){this.exteriorList=new d,this.exteriorList.init(this._midRender.uiAtlas)},e.prototype.initRightBg=function(){var a=this.addChild(this.winmidRender.getComponent("cnew_bg_yellow"));this.setSizeForPanelUiCopy(a,"a_leftbg_yellow",this._midRender);var a=this.addChild(this.winmidRender.getComponent("cnew_right_bg"));this.setSizeForPanelUiCopy(a,"a_rightbg_yellow",this._midRender);var b=this.addChild(this.winmidRender.getComponent("cnew_right_bg_top"));this.setSizeForPanelUiCopy(b,"a_right_bg_top",this._midRender);var c=this.addChild(this.winmidRender.getComponent("cnew_right_bg_bottom"));this.setSizeForPanelUiCopy(c,"a_right_bg_bottom",this._midRender),this._scale=4,this._posy=-100,this.winmidRender.applyObjData()},e.prototype.show=function(){UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.exteriorList.show(),this.selectTabType(0)},e.prototype.selectTabType=function(a){this.tabIndex=a,0==this.tabIndex?(this.a_tab0.selected=!0,this.a_tab1.selected=!1):(this.a_tab0.selected=!1,this.a_tab1.selected=!0),this.refrish()},e.prototype.hide=function(){this.exteriorList.hide(),UIManager.getInstance().removeUIContainer(this),c.prototype.hide.call(this)},e.prototype.resize=function(){c.prototype.resize.call(this),this.exteriorList&&(this.exteriorList.left=this.a_left_list_pos.parent.x/UIData.Scale+this.a_left_list_pos.x,this.exteriorList.top=this.a_left_list_pos.parent.y/UIData.Scale+this.a_left_list_pos.y),this.resizeRole()},e.prototype.selectCell=function(a){this.selectExteriorCellVo=a;for(var b=new Array,c=0;c<this.selectExteriorCellVo.tb.attrKeys.length;c++){var d=this.selectExteriorCellVo.tb.attrValues[c],e=this.selectExteriorCellVo.tb.attrKeys[c],f=GuidData.player.getPropById(e);b.push(Math.ceil(f*d/100)),UiDraw.drawAttVal(this.a_valueItem[c],e,Math.ceil(f*d/100)),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_upItem[c].skinName,ColorType.Green20a200+"增加"+d+"%",14,TextAlign.LEFT)}for(var c=0;5>c;c++){var g=this.selectExteriorCellVo.tb.level>c?0:1;this.a_zhanli_numAry[c].goToAndStop(g)}this.mountRoleSprite.showAvatarVisibel=0==this.tabIndex,0==this.tabIndex?(this.mountRoleSprite.setAvatar(this.selectExteriorCellVo.tb.avatar),this.mountRoleSprite.setWeapon(0),this._posy=-100):(this.mountRoleSprite.setAvatar(6302),this.mountRoleSprite.setBaseRoleWeapon(this.selectExteriorCellVo.tb.id),this._posy=-50),this.setUiListVisibleByItem([this.a_zhuangbei_ing],this.selectExteriorCellVo.isUse),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_select_name.skinName,ColorType.colorfef3d7+this.getSelectTbname(),16,TextAlign.LEFT),this.drawUseRes(),a.node.show?this._btnRedPoint.preShow():this._btnRedPoint.preHide(),this.resize()},e.prototype.getSelectTbname=function(){for(var a="",b=0;b<this.selectExteriorCellVo.tb.name.length;b++)a+=this.selectExteriorCellVo.tb.name.substr(b,1),a+="\n";return this.selectExteriorCellVo.tb.name.length<4&&(a="\n"+a),a},e.prototype.drawUseRes=function(){var a;if(this.setUiListVisibleByItem([this.a_res_need_icon,this.a_res_need_num],!1),this.selectExteriorCellVo.isUse)a="取消装备";else if(this.selectExteriorCellVo.isHave)a="装备";else{var b=this.selectExteriorCellVo.tb.costs[0][0],c=this.selectExteriorCellVo.tb.costs[0][1],d=hasEnoughResItem([b,c])?ColorType.Brown623424:ColorType.Redd92200;LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_res_need_num.skinName,d+ +GuidData.bag.getItemCount(b)+"/"+c,16),IconManager.getInstance().drawItemIcon60(this.a_res_need_icon,b,1),this.setUiListVisibleByItem([this.a_res_need_icon,this.a_res_need_num],!0),a="激活"}LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_big_but_txt.skinName,ColorType.Brown623424+a,16)},e.prototype.bigButClik=function(){if(this.selectExteriorCellVo.isUse)NetManager.getInstance().protocolos.cancel_equip_appearance(1==this.tabIndex?0:1),console.log("取消",this.tabIndex);else if(this.selectExteriorCellVo.isHave)NetManager.getInstance().protocolos.equip_appearance(this.selectExteriorCellVo.tb.id),console.log("装备",this.selectExteriorCellVo.tb.id);else{var a=this.selectExteriorCellVo.tb.costs[0][0],b=this.selectExteriorCellVo.tb.costs[0][1];if(GuidData.bag.hasItem(a,b))NetManager.getInstance().protocolos.active_appearance(this.selectExteriorCellVo.tb.id),console.log("收集",this.selectExteriorCellVo.tb.id);else{var c=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_PANEL);c.data=a,ModuleEventManager.dispatchEvent(c)}}},e.prototype.refrish=function(){if(this.uiAtlasComplet){var a,c;console.log("---当前tab页签---",this.tabIndex),0==this.tabIndex?(a=tb.TB_char_info.getTempVo(GuidData.player.getCharType()).waiguan,c=RedPointManager.getInstance().getNodeByID(22).children):(a=tb.TB_char_info.getTempVo(GuidData.player.getCharType()).weaponwg,c=RedPointManager.getInstance().getNodeByID(25).children);for(var d=GuidData.grow.getSpellIntFieldAppearanceId(),e=new Array,f=0,g=0;g<a.length;g++){var h=new b;h.tb=tb.TB_appearance_info.getTempVo(a[g]);for(var i=0;i<d.length;i++)d[i]==h.tb.id&&(h.isHave=!0);(h.tb.id==GuidData.player.getPlayerIntFieldAppearance(0)||h.tb.id==GuidData.player.getPlayerIntFieldAppearance(1))&&(h.isUse=!0),h.node=c[g];var j=new SListItemData;j.id=g,j.data=h,this.selectExteriorCellVo&&this.selectExteriorCellVo.tb.id==h.tb.id&&(f=e.length,this.selectCell(h)),e.push(j)}this.exteriorList.refreshData(e),this.exteriorList.setSelectIndex(f)}},e.prototype.butClik=function(b){switch(b.target){case this.w_close:this.hide();break;case this.a_tab0:this.selectTabType(0);break;case this.a_tab1:this.selectTabType(1);break;case this.a_big_but_bg:UiTweenScale.getInstance().changeButSize(b.target),this.bigButClik();break;case this.a_tujian_icon:UiTweenScale.getInstance().changeButSize(b.target),ModuleEventManager.dispatchEvent(new a.ExteriorEvent(a.ExteriorEvent.SHOW_IDENTIFICATION_EVENT))}},e}(WindowUi);a.ExteriorPanel=e}(exterior||(exterior={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),exterior;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_EXTERIOR_EVENT="SHOW_EXTERIOR_EVENT",b.REFRISH_EXTERIOR_PANEL="REFRISH_EXTERIOR_PANEL",b.SELECT_EXTERIOR_CELL="SELECT_EXTERIOR_CELL",b.SHOW_IDENTIFICATION_EVENT="SHOW_IDENTIFICATION_EVENT",b}(BaseEvent);a.ExteriorEvent=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"ExteriorModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.ExteriorModule=c;var d=function(c){function d(){var a=null!==c&&c.apply(this,arguments)||this;return a._nodeInit=!1,a}return __extends(d,c),d.prototype.getName=function(){return"ExteriorProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof b){var c=a;c.type==b.SHOW_EXTERIOR_EVENT&&this.showPanel(),c.type==b.SHOW_IDENTIFICATION_EVENT&&this.showIdentificationPanel(),this.exteriorPanel&&(c.type==b.REFRISH_EXTERIOR_PANEL&&(this.processRedPoint(),this.exteriorPanel.refrish(),console.log("外观变化")),c.type==b.SELECT_EXTERIOR_CELL&&this.exteriorPanel.selectCell(c.exteriorCellVo))}else if(a.type==EngineEvent.CORE_DATA_COMPLETE_EVENT)this.initRedNode();else if(a.type==EngineEvent.SYSTEM_OPEN_EVENT)this.processRedPoint();else if(a.type==charbg.CharBgEvent.BGDATA_CHANGE_EVENT)this.processRedPoint();else if(a instanceof UIPanelEvent){var d=a;if(d.panel==this.exteriorPanel){for(var e=RedPointManager.getInstance().getNodeByID(22).children,f=0;f<e.length;f++)e[f].unBind();for(var g=RedPointManager.getInstance().getNodeByID(25).children,f=0;f<g.length;f++)g[f].unBind();this.exteriorPanel.dispose(),this.exteriorPanel=null,console.log("释放面板 exteriorPanel")}else d.panel==this.identificationPanel&&(this.identificationPanel.dispose(),this.identificationPanel=null,console.log("释放面板 exteriorPanel"))}},d.prototype.showPanel=function(){var b=this;this.exteriorPanel||(this.exteriorPanel=new a.ExteriorPanel),this.exteriorPanel.load(function(){b.exteriorPanel.show()},!1)},d.prototype.showIdentificationPanel=function(){var b=this;this.identificationPanel||(this.identificationPanel=new a.IdentificationPanel),this.identificationPanel.load(function(){b.identificationPanel.show()},!1)},d.prototype.initRedNode=function(){if(!this._nodeInit){var a,b=RedPointManager.getInstance().getNodeByID(22);a=tb.TB_char_info.getTempVo(GuidData.player.getCharType()).waiguan;for(var c=0;c<a.length;c++){var d=tb.TB_appearance_info.getTempVo(a[c]),e=new RedPointNode;e.data=d,b.addChild(e)}b=RedPointManager.getInstance().getNodeByID(25),a=tb.TB_char_info.getTempVo(GuidData.player.getCharType()).weaponwg;for(var c=0;c<a.length;c++){var d=tb.TB_appearance_info.getTempVo(a[c]),e=new RedPointNode;e.data=d,b.addChild(e)}this._nodeInit=!0,this.processRedPoint()}},d.prototype.processRedPoint=function(){var a=GuidData.grow.getSpellIntFieldAppearanceId();GuidData.player.getsyspageopen(SharedDef.MODULE_FASHION,SharedDef.MODULE_FASHION_CLOTHES)&&this.processRedPointByID(22,a),GuidData.player.getsyspageopen(SharedDef.MODULE_FASHION,SharedDef.MODULE_FASHION_WEAPON)&&this.processRedPointByID(25,a)},d.prototype.processRedPointByID=function(a,b){for(var c=RedPointManager.getInstance().getNodeByID(a).children,d=0;d<c.length;d++){var e=c[d].data;GuidData.bag.getItemCount(e.costs[0][0])>=e.costs[0][1]&&-1==b.indexOf(e.id)?c[d].show=!0:c[d].show=!1}},d.prototype.listenModuleEvents=function(){return[new b(b.SHOW_EXTERIOR_EVENT),new b(b.REFRISH_EXTERIOR_PANEL),new b(b.SELECT_EXTERIOR_CELL),new b(b.SHOW_IDENTIFICATION_EVENT),new EngineEvent(EngineEvent.CORE_DATA_COMPLETE_EVENT),new EngineEvent(EngineEvent.SYSTEM_OPEN_EVENT),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.ExteriorProcessor=d}(exterior||(exterior={}));var gift;!function(a){var b=function(){function a(){}return a}();a.GiftSendVo=b;var c=function(){function a(){this.dataResouce=new Array;for(var a=tb.TB_faction_gift.get_TB_faction_gift(),c=0;c<a.length;c++){var d=new b;d.id=c,d.num=0,d.has=0,d.tb_faction_gift=a[c],d.tb_item_template=tb.TB_item_template.get_TB_item_template(d.tb_faction_gift.id),this.dataResouce.push(d)}this.sortItem()}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.sortItem=function(){for(var a=0;a<this.dataResouce.length;a++){var b=this.dataResouce[a],c=b.id%10,d=2*c%10+Math.floor(c/5)+10*Math.floor(b.id/10);b.id=d}},a.prototype.getResouceLen=function(){return this.dataResouce.length},a.prototype.refrishResouce=function(){for(var a=0;a<this.dataResouce.length;a++){var b=this.dataResouce[a].tb_item_template.id;this.dataResouce[a].has=GuidData.bag.getItemCount(b),this.dataResouce[a].num=0}},a.prototype.getResouceRewardNow=function(){for(var a=new Object,b=0;b<this.dataResouce.length;b++)if(this.dataResouce[b].num)for(var c=0;c<this.dataResouce[b].tb_faction_gift.reward.length;c++){var d=this.dataResouce[b].tb_faction_gift.reward[c];a[d[0]]||(a[d[0]]=0),a[d[0]]+=d[1]*this.dataResouce[b].num}var e="×0";for(var f in a){e="",console.log(f,a[f]);tb.TB_item_template.get_TB_item_template(Number(f));e+="×"+a[f]}return e},a.prototype.getResouceRewardEx=function(){for(var a=new Object,b=0;b<this.dataResouce.length;b++)if(this.dataResouce[b].num)for(var c=0;c<this.dataResouce[b].tb_faction_gift.ex_reward.length;c++){var d=this.dataResouce[b].tb_faction_gift.ex_reward[c];a[d[0]]||(a[d[0]]=0),a[d[0]]+=d[1]*this.dataResouce[b].num}var e="×0";for(var f in a){e="",console.log(f,a[f]);tb.TB_item_template.get_TB_item_template(Number(f));e+="×"+a[f]}return e},a.prototype.getResouceById=function(a){for(var b=0;b<this.dataResouce.length;b++)if(this.dataResouce[b].id==a)return this.dataResouce[b];return null},a.prototype.isCanAddGiffById=function(a){for(var b=new Array,c=0;c<this.dataResouce.length;c++)this.dataResouce[c].num&&b.push(this.dataResouce[c].id);if(b.length<4)return!0;for(var d=0;d<b.length;d++)if(b[d]==a)return!0;return!1},a.prototype.sendGiftToServer=function(a){for(var b=new Array,c=0;c<this.dataResouce.length;c++)if(this.dataResouce[c].num){var d=new item_reward_info;d.item_id=this.dataResouce[c].tb_item_template.id,d.num=this.dataResouce[c].num,b.push(d)}return b.length?(NetManager.getInstance().protocolos.send_faction_gift(b,a,SharedDef.FACTION_DATA_REPLY_TYPE_TEXT),!0):!1},a}();a.GiftModel=c}(gift||(gift={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),gift;!function(a){var b=function(){function b(a,b,c,d){var e=this;this.select=!1,this.midRender=a,this.topRender=b,this.perent=c,this.ui=this.perent.addChild(this.midRender.getComponent("a_gift_frame")),this.ui.goToAndStop(d),this.ui.addEventListener(InteractiveEvent.Down,this.frameDown,this),this.ui.addEventListener(InteractiveEvent.Up,this.frameUp,this),this.cell_clear=this.perent.addChild(this.topRender.getComponent("a_cell_clear")),this.cell_clear.addEventListener(InteractiveEvent.Down,this.clearDown,this),this.cell_clear.addEventListener(InteractiveEvent.Up,this.clearUp,this),this._id=d,this.updataFun=function(a){e.updata(a)}}return b.prototype.frameDown=function(b){this.data&&(this.clearDown(b),this.downUiPos=new Vector2D(this.ui.x,this.ui.y),this.downTime=TimeUtil.getTimer(),this.lastNum=this.data.num,a.GiftModel.getInstance().isCanAddGiffById(this.id)&&(TimeUtil.addFrameTick(this.updataFun),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)),this.select=!0,this.draw(),this.perent.cellDownById(this))},b.prototype.A_left_bg_MouseUp=function(a){void 0===a&&(a=null),TimeUtil.removeFrameTick(this.updataFun),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this)},b.prototype.updata=function(a){if(this.ui.x==this.downUiPos.x&&this.ui.y==this.downUiPos.y){var b=TimeUtil.getTimer()-this.downTime-300;b=Math.max(0,b),b>0&&(3e3>b?this.data.num=Math.min(this.lastNum+Math.floor(b/10),this.data.has):this.data.num=this.data.has,this.dispatchEventTo(),this.draw())}else this.A_left_bg_MouseUp()},b.prototype.frameUp=function(b){this.downPos&&this.downPos.x==b.x&&this.downPos.y==b.y&&this.data&&this.data.num<this.data.has&&(a.GiftModel.getInstance().isCanAddGiffById(this.id)?(console.log(this.id,"+++"),this.data.num++,this.dispatchEventTo(),this.draw(),UIManager.popClikNameFun("a_gift_frame")):msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"不能选择大于4种礼物",99))},b.prototype.clearDown=function(a){this.perent.A_left_bg_MouseDown(a),this.downPos=new Vector2D(a.x,a.y)},b.prototype.clearUp=function(a){this.downPos.x==a.x&&this.downPos.y==a.y&&this.data&&(console.log(this.id,"clear"),this.data.num=0,this.dispatchEventTo(),this.draw())},b.prototype.dispatchEventTo=function(){ModuleEventManager.dispatchEvent(new a.GiftEvent(a.GiftEvent.REFRISH_CHANGE_CELL_DATA))},Object.defineProperty(b.prototype,"x",{set:function(a){this.ui.x=a,this.cell_clear.x=a+70},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{set:function(a){this.ui.y=a,this.cell_clear.y=a-0},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"id",{get:function(){return this._id},set:function(a){this._id!=a&&(this._id=a,this.refresh())},enumerable:!0,configurable:!0}),b.prototype.refresh=function(){this.data=a.GiftModel.getInstance().getResouceById(this._id),this.draw()},b.prototype.draw=function(){var a=this;this.perent.setUiListVisibleByItem([this.cell_clear],!1),this.data&&(console.log("绘制",this._id),IconManager.getInstance().getIcon(GameData.getIconCopyUrl(this.data.tb_item_template.avatar),function(b){if(a.data){var c=a.ui.getSkinCtxRect(),d=UIManager.getInstance().getContext2D(c.width,c.height,!1);UiDraw.cxtDrawImg(d,a.select?"TBg12":"TBg11",new Rectangle(2,1,116,128),UIData.publicUi),UiDraw.cxtDrawImg(d,PuiData.PropBg60,new Rectangle(27,10,66,66),UIData.publicUi),d.drawImage(b,32,15,56,56);var e=ColorType.Orange853d07;console.log(a.data),0==a.data.has?e=ColorType.Orange853d07:a.data.has==a.data.num&&(e="[ff0000]"),LabelTextFont.writeSingleLabelToCtx(d,e+a.data.num+"/"+a.data.has,16,c.width/2,c.height-16-10,TextAlign.CENTER),LabelTextFont.writeSingleLabelToCtx(d,a.data.tb_item_template.getColorName(),16,c.width/2,c.height-35-10,TextAlign.CENTER),a.perent.setUiListVisibleByItem([a.cell_clear],a.data.num>0),a.ui.drawToCtx(a.midRender.uiAtlas,d)}}))},b}();a.GiftCell=b;var c=function(c){function d(){var a=c.call(this)||this;return a.uiAtlasComplet=!1,a.cellWidht=119,a.moveTx=0,a.basePos=new Vector2D(254,180),a._pxleft=0,a._msgTxt="请输入文字..",a.cutFrameNum=0,a._lastMouseX=0,a._lastRoleRotatioinY=0,a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bottomRender=new UIRenderComponent,a.addRender(a._bottomRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._cellMidRender=new UIRenderComponent,a.addRender(a._cellMidRender),a._cellTopRender=new UIRenderComponent,a.addRender(a._cellTopRender),a._midRender.uiAtlas=new UIAtlas,a}return __extends(d,c),d.prototype.applyLoad=function(){var a=this;this._midRender.uiAtlas.setInfo("ui/uidata/gift/gift.xml","ui/uidata/gift/gift.png",function(){a.loadConfigCom()})},d.prototype.loadConfigCom=function(){this._bottomRender.uiAtlas=this._midRender.uiAtlas,this._topRender.uiAtlas=this._midRender.uiAtlas,this._cellMidRender.uiAtlas=this._midRender.uiAtlas,this._cellTopRender.uiAtlas=this._midRender.uiAtlas,this.addChild(this._topRender.getComponent("a_tittle")),this.addChild(this._topRender.getComponent("a_input_bg")),this.addChild(this._topRender.getComponent("a_reward_label0")),this.addChild(this._topRender.getComponent("a_reward_label1")),this.addChild(this._topRender.getComponent("a_input_label")),this.addChild(this._topRender.getComponent("a_record_but")),this.a_input_txt=this.addEvntBut("a_input_txt",this._topRender),this.addChild(this._bottomRender.getComponent("a_gift_bg")),this.a_reward_num0=this.addChild(this._topRender.getComponent("a_reward_num0")),this.a_reward_num1=this.addChild(this._topRender.getComponent("a_reward_num1")),this.a_send_but=this.addEvntButUp("a_send_but",this._topRender),this.empty=this.addEvntBut("empty",this._topRender),
this.itemList=new Array;for(var a=0;12>a;a++){var c=new b(this._cellMidRender,this._cellTopRender,this,a);this.itemList.push(c)}this.basePos.x=this.empty.x,this.basePos.y=this.empty.y,this.listMask=new UIMask,this.listMask.level=3,this.listMask.x=this.empty.x,this.listMask.y=this.empty.y,this.listMask.width=this.empty.width,this.listMask.height=this.empty.height,this.addMask(this.listMask),this._cellMidRender.mask=this.listMask,this._cellTopRender.mask=this.listMask,this.uiAtlasComplet=!0,this.applyLoadComplete()},d.prototype.showScaloe=function(){if(a.GiftModel.getInstance().getResouceLen()>10){this.moveTx=this.cutFrameNum,this.moveTx=Math.min(0,this.moveTx);var b=Math.ceil((a.GiftModel.getInstance().getResouceLen()-10)/2)*this.cellWidht*-1;this.moveTx=Math.max(b,this.moveTx);for(var c=Math.floor(Math.abs(this.moveTx)/this.cellWidht),d=2*c,e=d+12,f=d;e>f;f++){var g=this.getCellById(f);g||(g=this.getOutCell(d,e),g&&(g.id=f))}this.cutFrameNum>0&&(this.cutFrameNum=this.cutFrameNum/4),this.cutFrameNum<b&&(this.cutFrameNum=b+(this.cutFrameNum-b)/4);for(var f=0;f<this.itemList.length;f++){var g=this.itemList[f],h=new Vector2D;h.x=Math.floor(g.id/2)*this.cellWidht+this.basePos.x+this.cutFrameNum,h.y=130*Math.floor(g.id%2)+this.basePos.y+0,g.x=h.x,g.y=h.y,g.id>=a.GiftModel.getInstance().getResouceLen()&&(g.x=1e3)}}else for(var f=0;10>f;f++){var g=this.getCellById(f);g.id=f;var h=new Vector2D;h.x=Math.floor(g.id/2)*this.cellWidht+this.basePos.x,h.y=130*Math.floor(g.id%2)+this.basePos.y+0,g.x=h.x,g.y=h.y}},d.prototype.cellDownById=function(a){this.selectCellVo&&this.selectCellVo!=a&&(this.selectCellVo.select=!1,this.selectCellVo.draw()),this.selectCellVo=a},d.prototype.resetToCellPos=function(){var b;b=Math.min(0,this.cutFrameNum);var c=Math.ceil((a.GiftModel.getInstance().getResouceLen()-10)/2)*this.cellWidht*-1;b=Math.max(c,b),this._pxleft=this.cutFrameNum,TweenMoveTo(this,.1,{pxleft:b})},Object.defineProperty(d.prototype,"pxleft",{get:function(){return this._pxleft},set:function(a){this._pxleft=a,this.cutFrameNum=this._pxleft,this.showScaloe()},enumerable:!0,configurable:!0}),d.prototype.getCellById=function(a){for(var b=0;b<this.itemList.length;b++){var c=this.itemList[b];if(c.id==a)return c}return null},d.prototype.getOutCell=function(a,b){for(var c,d=0;d<this.itemList.length;d++){var e=this.itemList[d];(e.id<a||e.id>=b)&&(c=e)}return c},d.prototype.refresh=function(){a.GiftModel.getInstance().refrishResouce();for(var b=0;b<this.itemList.length;b++){var c=this.itemList[b];c.refresh()}this.showScaloe(),this.refreshCellData(),this._msgTxt="请输入文字..",this.writeInputTxt()},d.prototype.writeInputTxt=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_input_txt.skinName,this._msgTxt,16,TextAlign.LEFT,ColorType.Orange853d07)},d.prototype.refreshCellData=function(){LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_reward_num0.skinName,ColorType.colorce0a00+a.GiftModel.getInstance().getResouceRewardNow(),16,TextAlign.LEFT),LabelTextFont.writeSingleLabel(this._topRender.uiAtlas,this.a_reward_num1.skinName,ColorType.colorce0a00+a.GiftModel.getInstance().getResouceRewardEx(),16,TextAlign.LEFT)},d.prototype.butClik=function(b){var c=this;switch(b.target){case this.e_close:this.hide();break;case this.empty:this.A_left_bg_MouseDown(b);break;case this.a_send_but:UIManager.popClikNameFun("a_send_but");var d=this._msgTxt;("请输入文字.."==this._msgTxt||0==this._msgTxt.length)&&(d="此玩家没有留言~");var e=a.GiftModel.getInstance().sendGiftToServer(d);e?this.hide():msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"请选赠送礼物",99);break;case this.a_input_txt:"请输入文字.."==this._msgTxt&&(this._msgTxt=""),InputPanel.show(function(a){c.inputBfun(a)},this._msgTxt)}},d.prototype.inputBfun=function(a){this._msgTxt=a,""==this._msgTxt&&(this._msgTxt="请输入文字.."),this.writeInputTxt()},d.prototype.A_left_bg_MouseDown=function(b){a.GiftModel.getInstance().getResouceLen()>10&&(this._lastMouseX=b.x,this._lastRoleRotatioinY=this.cutFrameNum,Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this))},d.prototype.A_left_bg_MouseMove=function(a){this.cutFrameNum=this._lastRoleRotatioinY+(a.x-this._lastMouseX)/UIData.Scale,this.showScaloe()},d.prototype.A_left_bg_MouseUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.A_left_bg_MouseMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.A_left_bg_MouseUp,this),this.resetToCellPos()},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},d}(WindowMinUi);a.GiftPanel=c}(gift||(gift={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),gift;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"GiftModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.GiftModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_GIFT_PANEL="SHOW_GIFT_PANEL",b.HIDE_GIFT_PANEL="HIDE_GIFT_PANEL",b.REFRISH_CHANGE_CELL_DATA="REFRISH_CHANGE_CELL_DATA",b}(BaseEvent);a.GiftEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"GiftProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_GIFT_PANEL&&this.showPanel(),this.giftPanel&&(b.type==c.HIDE_GIFT_PANEL&&this.hidePanel(),b.type==c.REFRISH_CHANGE_CELL_DATA&&this.giftPanel.refreshCellData())}else a instanceof charbg.CharBgEvent&&this.giftPanel&&this.giftPanel.hasStage},d.prototype.hidePanel=function(){this.giftPanel.hide()},d.prototype.showPanel=function(){var b=this;this.giftPanel||(this.giftPanel=new a.GiftPanel),this.giftPanel.load(function(){UIManager.getInstance().addUIContainer(b.giftPanel),b.giftPanel.refresh();var a=new msgtip.MsgTipEvent(msgtip.MsgTipEvent.SHOW_PAGE_POP_VIEW);a.data=SharedDef.MODULE_FACTION,ModuleEventManager.dispatchEvent(a)},!1)},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_GIFT_PANEL),new c(c.HIDE_GIFT_PANEL),new c(c.REFRISH_CHANGE_CELL_DATA),new charbg.CharBgEvent(charbg.CharBgEvent.BGDATA_CHANGE_EVENT)]},d}(BaseProcessor);a.GiftProcessor=d}(gift||(gift={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kaifu;!function(a){var b=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.setActiveID=function(a){this._activeID=a},b}(UIConatiner);a.KaifuBaseContainer=b}(kaifu||(kaifu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kaifu;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this.initUI()},b.prototype.initUI=function(){var a=this;this._bg=this._winMidRender.getComponent("t_cj_bg"),this.addChild(this._bgRender.getComponent("t_cj_bg1"));var b;b=this.addChild(this._bgRender.getComponent("t_cj_btn")),b.addEventListener(InteractiveEvent.Up,this.btn1Click,this),b=this.addChild(this._bgRender.getComponent("t_cj_btn1")),b.addEventListener(InteractiveEvent.Up,this.btn2Click,this),b=this.addChild(this._baseRender.getComponent("t_cj_btn_lab1")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,"买一次",16,TextAlign.CENTER,ColorType.Brown7a2f21),b=this.addChild(this._baseRender.getComponent("t_cj_btn_lab2")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,"买10次",16,TextAlign.CENTER,ColorType.Brown7a2f21),this._contentTxt=this.addChild(this._baseRender.getComponent("t_cj_content")),this._timeUI=this.addChild(this._baseRender.getComponent("t_cj_time")),b=this.addChild(this._baseRender.getComponent("t_cj_info")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,ColorType.Brown7a2f21+"买"+ColorType.Green56da35+"10"+ColorType.Brown7a2f21+"次必得"+ColorType.colorb759ff+"紫色"+ColorType.Brown7a2f21+"以上装备",14),this._cost1=this.addChild(this._baseRender.getComponent("t_cj_cost_lab1")),this._cost2=this.addChild(this._baseRender.getComponent("t_cj_cost_lab2")),this._slist=new c,this._slist.init(this._baseUiAtlas,this._activeID),this.initEndTime(),this._drawTimeFun=function(){a.drawTime()},this.draw()},b.prototype.btn1Click=function(a){this._canbuy1&&NetManager.getInstance().protocolos.draw_lottery(this._activeID,1)},b.prototype.btn2Click=function(a){this._canbuy2&&NetManager.getInstance().protocolos.draw_lottery(this._activeID,2)},b.prototype.initEndTime=function(){var a,b=TableData.getInstance().getData(TableData.tb_activity_time,this._activeID);a=-1==b.startTime?TimeUtil.getZeroTime(GameInstance.serverOpenTime):b.startTime,this._activeEndTime=a+24*(b.delayDays+b.lastDays)*60*60;var c=b.params;b=TableData.getInstance().getData(TableData.tb_activity_lottery_base,c),this._canbuy1=UiDraw.drawRewardIconAndtxt(this._cost1,b.costs[0],!0,TextAlign.CENTER,5),this._canbuy2=UiDraw.drawRewardIconAndtxt(this._cost2,b.costs[1],!0,TextAlign.CENTER,5)},b.prototype.draw=function(){this.drawReward()},b.prototype.drawTime=function(){var a=this._activeEndTime-GameInstance.getServerNow(),b=TimeUtil.getDiffTime1(a);b=ColorType.Brown7a2f21+"宝库将在"+ColorType.colorcd2000+b+ColorType.Brown7a2f21+"后关闭",LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._timeUI.skinName,b,14)},b.prototype.drawReward=function(){var a=TableData.getInstance().getData(TableData.tb_activity_time,this._activeID),b=GuidData.globelValue.getLotteryRecord(a.offset);console.log(b.length);for(var c="",d=0;d<b.length;d++){var e=b[d].split("#"),f=tb.TB_item_template.get_TB_item_template(Number(e[1]));c+=ColorType.Brown7a2f21+getBaseName(e[0])+ColorType.colorb96d49+" 获得 "+getColorQua(f.quality)+f.name+"*"+e[2]+"\n"}LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._contentTxt.skinName,c,16,TextAlign.LEFT)},b.prototype.show=function(){a.prototype.show.call(this),this.addChild(this._bg),this.draw(),this._slist.show(),TimeUtil.addTimeTick(1e3,this._drawTimeFun)},b.prototype.hide=function(){a.prototype.hide.call(this),this.removeChild(this._bg),this._slist.hide(),TimeUtil.removeTimeTick(this._drawTimeFun)},b}(a.KaifuBaseContainer);a.KaifuChoujiangPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a,b){this._activeID=b,this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=this.getDataAry(),b=450,c=430;this.setData(a,d,b,c,150,150,3,512,256,3,3),this.center=-35,this.middle=25,this.setShowLevel(4)},b.prototype.getDataAry=function(){var a=new Array,b=TableData.getInstance().getData(TableData.tb_activity_time,this._activeID),c=b.params;b=TableData.getInstance().getData(TableData.tb_activity_lottery_base,c);var d,e=new Array;d=this.getRandomAry(b.low,3);for(var f=0;f<d.length;f++){var g=TableData.getInstance().getData(TableData.tb_activity_lottery_low,d[f]);e.push(g.item)}d=this.getRandomAry(b.middle,3);for(var f=0;f<d.length;f++){var g=TableData.getInstance().getData(TableData.tb_activity_lottery_middle,d[f]);e.push(g.item)}d=this.getRandomAry(b.high,3);for(var f=0;f<d.length;f++){var g=TableData.getInstance().getData(TableData.tb_activity_lottery_high,d[f]);e.push(g.item)}for(var f=0;f<e.length;f++){var h=new SListItemData;h.data=e[f],h.id=f,a.push(h)}return a},b.prototype.getRandomAry=function(a,b){var c=[].concat(a);return c.sort(function(a,b){return Math.random()>.5?-1:1}),c.length=b,c},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.KaiFuChoujiangList=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this._ibg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"k_s_bg",0,0,133,133,10,10),b.addChild(this._ibg),this._icon=this.creatSUI(d,this.parentTarget.baseAtlas,"k_s_icon",30,18,68,68),b.addChild(this._icon),this._nameui=this.creatSUI(d,this.parentTarget.baseAtlas,"k_s_lab",17,98,100,20),b.addChild(this._nameui)},b.prototype.render=function(a){this.itdata=a,a&&a.data&&this.applyRender()},b.prototype.applyRender=function(){UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.ITEMBIGBG);var a=tb.TB_item_template.get_TB_item_template(this.itdata.data[0][0]);IconManager.getInstance().drawItemIcon60(this._icon,this.itdata.data[0][0],this.itdata.data[0][1]),LabelTextFont.writeSingleLabel(this.uiAtlas,this._nameui.skinName,a.name,16,TextAlign.CENTER,getColorQua(a.quality))},b}(SListItem);a.KaifuChoujiangListItemRender=d}(kaifu||(kaifu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kaifu;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.canGet=!1,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._banner=new UIRenderOnlyPicComponent,this._banner.uiAtlas=a,this.addRender(this._banner),this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this.initUI()},b.prototype.initUI=function(){var a=this;this._baseTabObj=TableData.getInstance().getData(TableData.tb_activity_time,this._activeID),this._activeTabObj=TableData.getInstance().getData(TableData.tb_activity_rank_base,this._baseTabObj.params[0]),this.addChild(this._banner.getComponent("t_banner")),this._banner.setImgUrl(getKaifuIconUrl("b0")),this._bg=this._winMidRender.getComponent("t_qt_bg2"),this.addChild(this._bgRender.getComponent("t_title_bg"));var b;b=this.addChild(this._bgRender.getComponent("t_base_btn")),b.addEventListener(InteractiveEvent.Up,this.btn1Click,this),this._btnLab=this.addChild(this._baseRender.getComponent("t_qt_lab5")),b=this.addChild(this._baseRender.getComponent("t_qt_lab4")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,"我的进度",14,TextAlign.CENTER,ColorType.colorb96d49),this._timeUI=this.addChild(this._baseRender.getComponent("t_qt_time")),b=this.addChild(this._baseRender.getComponent("t_qt_info")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,ColorType.Brown7a2f21+"活动说明："+this._activeTabObj.desc,16,TextAlign.LEFT),this._targetLab1=this.addChild(this._baseRender.getComponent("t_qt_lab1")),this._targetVal1=this.addChild(this._baseRender.getComponent("t_qt_lab2")),this._myLab1=this.addChild(this._baseRender.getComponent("t_qt_lab3")),this._rewardIcon0=this.addChild(this._baseRender.getComponent("t_qt_icon1")),this._rewardIcon1=this.addChild(this._baseRender.getComponent("t_qt_icon2")),this._slist=new d,this._slist.init(this._baseUiAtlas,this._activeID),this.initEndTime(),this._drawTimeFun=function(){a.drawTime()}},b.prototype.btn1Click=function(a){this.canGet&&NetManager.getInstance().protocolos.activity_opt_get_rank_process_reward(this._activeID,this.processRewardID)},b.prototype.btn2Click=function(a){NetManager.getInstance().protocolos.draw_lottery(this._activeID,2)},b.prototype.initEndTime=function(){var a;a=-1==this._baseTabObj.startTime?TimeUtil.getZeroTime(GameInstance.serverOpenTime):this._baseTabObj.startTime,this._activeEndTime=a+24*(this._baseTabObj.delayDays+this._baseTabObj.lastDays)*60*60},b.prototype.draw=function(){this.drawReward()},b.prototype.drawTime=function(){var a=this._activeEndTime-GameInstance.getServerNow(),b=TimeUtil.getDiffTime1(a);b=ColorType.Brown7a2f21+"剩余时间："+ColorType.colorcd2000+b,LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._timeUI.skinName,b,16,TextAlign.LEFT)},b.prototype.drawReward=function(){var a=GuidData.grow.getActivePlayerData(this._baseTabObj.category),b=!1;a[2]>5&&(a[2]=5,b=!0),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._targetLab1.skinName,"达到目标("+(a[2]+1)+"/6)",16,TextAlign.CENTER,ColorType.Brown7a2f21);var c,d=this._activeTabObj.process[a[2]];c=this.getDataStr(this._activeTabObj.type,d),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._targetVal1.skinName,ColorType.colorb96d49+this._activeTabObj.title+":"+ColorType.Brown7a2f21+c,16,TextAlign.CENTER);var e=TableData.getInstance().getData(TableData.tb_activity_rank_process_reward,this._activeTabObj.process_reward[a[2]]);e.item[0]?IconManager.getInstance().drawItemIcon60(this._rewardIcon0,e.item[0][0],e.item[0][1]):IconManager.getInstance().drawItemIcon60(this._rewardIcon0,0,0),e.item[1]?IconManager.getInstance().drawItemIcon60(this._rewardIcon1,e.item[1][0],e.item[1][1]):IconManager.getInstance().drawItemIcon60(this._rewardIcon1,0,0),c=this.getDataStr(this._activeTabObj.type,a[1]),LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._myLab1.skinName,ColorType.colorb96d49+this._activeTabObj.title+":"+ColorType.Brown7a2f21+c,16,TextAlign.CENTER),this.processRewardID=a[2]+1,a[1]>=d?b?(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._btnLab.skinName,"已领取",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.canGet=!1):(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._btnLab.skinName,"领取奖励",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.canGet=!0):(LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._btnLab.skinName,"未达到",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.canGet=!1)},b.prototype.setListData=function(a){if(a.act_id==this._activeID){for(var b=new Array,d=0;3>d;d++){var e=new SListItemData;if(a.list[d]){var f=new c;f.name=a.list[d].name,f.value=a.list[d].value,f.dataStr=[this._activeTabObj.title,this.getDataStr(this._activeTabObj.type,f.value)],f.reward=TableData.getInstance().getData(TableData.tb_activity_rank_rank_reward,d+1),f.rank=d+1,e.data=f,e.id=d,b.push(e)}}this._slist.refreshData(b)}},b.prototype.getDataStr=function(a,b){if(0==a)return String(b);if(2==a)return String(b);if(3==a)return String(b);if(4==a){var c=float2int(b/1e3)+10,d=b%1e3;return c+"阶"+d+"星"}if(5==a){var c=float2int(b/1e3),d=b%1e3;return c+"阶"+d+"星"}if(6==a)return String(b);if(7==a){var c=float2int(b/1e3),d=b%1e3;return c+"阶"+d+"星"}return""},b.prototype.show=function(){a.prototype.show.call(this),this.addChild(this._bg),this.draw(),this._slist.show(),TimeUtil.addTimeTick(1e3,this._drawTimeFun),NetManager.getInstance().protocolos.activity_opt_get_rank_list(this._activeID)},b.prototype.hide=function(){a.prototype.hide.call(this),this.removeChild(this._bg),this._slist.hide(),TimeUtil.removeTimeTick(this._drawTimeFun)},b}(a.KaifuBaseContainer);a.KaifuDayTargetPanel=b;var c=function(){function a(){}return a}();a.KaiFuDayTargetItemVo=c;var d=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a,b){this._activeID=b,this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array,b=458,c=322;this.setData(a,e,b,c,453,105,3,256,512,1,3),this.center=-35,this.middle=95,this.setShowLevel(4)},b.prototype.getRandomAry=function(a,b){var c=[].concat(a);return c.sort(function(a,b){return Math.random()>.5?-1:1}),c.length=b,c},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b}(SList);a.KaiFuDayTargetList=d;var e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._iconAry=new Array,b}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this._ibg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"q_s_bg",0,0,450,105,10,10),b.addChild(this._ibg),this._icon=this.creatSUI(d,this.parentTarget.baseAtlas,"q_s_rank",8,0,76,94),b.addChild(this._icon),this._nameui=this.creatSUI(d,this.parentTarget.baseAtlas,"q_s_lab1",115,23,140,20),b.addChild(this._nameui),this._infoui=this.creatSUI(d,this.parentTarget.baseAtlas,"q_s_lab2",115,54,140,20),b.addChild(this._infoui);for(var f=0;2>f;f++){var g=this.creatSUI(d,this.parentTarget.baseAtlas,"q_s_icon"+f,290+76*f,18,68,68);b.addChild(g),this._iconAry.push(g)}},b.prototype.render=function(a){this.itdata=a,a&&a.data&&this.applyRender()},b.prototype.applyRender=function(){var a=this.itdata.data;UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.ITEMBIGBG),LabelTextFont.writeSingleLabel(this.uiAtlas,this._nameui.skinName,getBaseName(a.name),16,TextAlign.CENTER,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this._infoui.skinName,ColorType.colorb96d49+a.dataStr[0]+":"+ColorType.Brown7a2f21+a.dataStr[1],16,TextAlign.CENTER,ColorType.Brown7a2f21),this.uiAtlas.upDataPicToTexture(getKaifuIconUrl("d"+a.rank),this._icon.skinName);for(var b=0;b<this._iconAry.length;b++)a.reward.item[b]?IconManager.getInstance().drawItemIcon60(this._iconAry[b],a.reward.item[b][0],a.reward.item[b][1]):IconManager.getInstance().drawItemIcon60(this._iconAry[b],0,0)},b}(SListItem);a.KaiFuDayTargetListItemRender=e}(kaifu||(kaifu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kaifu;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._banner=new UIRenderOnlyPicComponent,this._banner.uiAtlas=a,this.addRender(this._banner),this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this.initUI()},b.prototype.initUI=function(){var a=this;this._baseTabObj=TableData.getInstance().getData(TableData.tb_activity_time,this._activeID),this._activeTabObj=TableData.getInstance().getData(TableData.tb_activity_limit_gift_base,this._baseTabObj.params[0]),this.addChild(this._banner.getComponent("t_banner")),this._banner.setImgUrl(getKaifuIconUrl("b0"));var b;this._timeUI=this.addChild(this._baseRender.getComponent("t_lb_time")),b=this.addChild(this._baseRender.getComponent("t_lb_info")),LabelTextFont.writeSingleLabel(this._baseUiAtlas,b.skinName,ColorType.Brown7a2f21+"活动说明："+this._activeTabObj.desc,16,TextAlign.LEFT),this._slist=new c,this._slist.init(this._baseUiAtlas,this._activeTabObj,this._activeID,this._baseTabObj.category),this.initEndTime(),this._drawTimeFun=function(){a.drawTime()}},b.prototype.initEndTime=function(){var a;a=-1==this._baseTabObj.startTime?TimeUtil.getZeroTime(GameInstance.serverOpenTime):this._baseTabObj.startTime,this._activeEndTime=a+24*(this._baseTabObj.delayDays+this._baseTabObj.lastDays)*60*60},b.prototype.drawTime=function(){var a=this._activeEndTime-GameInstance.getServerNow(),b=TimeUtil.getDiffTime1(a);b=ColorType.Brown7a2f21+"剩余时间："+ColorType.colorcd2000+b,LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._timeUI.skinName,b,16,TextAlign.LEFT)},b.prototype.refresh=function(){this._slist&&this._slist.reGetData()},b.prototype.show=function(){a.prototype.show.call(this),this._slist.show(),TimeUtil.addTimeTick(1e3,this._drawTimeFun),NetManager.getInstance().protocolos.activity_opt_get_rank_list(this._activeID)},b.prototype.hide=function(){a.prototype.hide.call(this),this._slist.hide(),TimeUtil.removeTimeTick(this._drawTimeFun)},b}(a.KaifuBaseContainer);a.KaifuRewardPanel=b;var c=function(a){function b(){return a.call(this)||this}return __extends(b,a),b.prototype.init=function(a,b,c,d){this._activeTabObj=b,this.baseAtlas=a,this._activeTabID=c,this._dataOffset=d,this.initData()},b.prototype.initData=function(){var a=this.getDataAry(),b=695,c=300;this.setData(a,e,b,c,692,128,2,512,512,1,3,1),this.center=80,this.middle=80,this.setShowLevel(4)},b.prototype.getDataAry=function(){for(var a=new Array,b=GuidData.grow.getActivePlayerData(this._dataOffset),c=0;3>c;c++){var e=new SListItemData,f=this._activeTabObj.gift_list[c],g=new d;g.tabObj=TableData.getInstance().getData(TableData.tb_activity_limit_gift,f),g.hasBuy=getBit(b[1],c),e.data=g,e.id=c,a.push(e)}return a},b.prototype.reGetData=function(){for(var a=GuidData.grow.getActivePlayerData(this._dataOffset),b=0;b<this._dataAry.length;b++)this._dataAry[b].data.hasBuy=getBit(a[1],b);this.refreshDraw()},b.prototype.getRandomAry=function(a,b){var c=[].concat(a);return c.sort(function(a,b){return Math.random()>.5?-1:1}),c.length=b,c},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this)},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.buyGift=function(a){NetManager.getInstance().protocolos.activity_opt_buy_limitgift(this._activeTabID,a)},b}(SList);a.KaiFuRewardList=c;var d=function(){function a(){}return a}();a.KaiFuRewardItemVo=d;var e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._iconAry=new Array,b}return __extends(b,a),b.prototype.create=function(b,c,d,e){void 0===e&&(e=null),a.prototype.create.call(this,b,c,d,e),this._ibg=this.creatGrid9SUI(c,this.parentTarget.baseAtlas,"l_s_bg",0,0,692,128,10,10),b.addChild(this._ibg),this._icon=this.creatSUI(d,this.parentTarget.baseAtlas,"l_s_id",4,2,504,33),b.addChild(this._icon),this._lab1=this.creatSUI(d,this.parentTarget.baseAtlas,"l_s_lab1",271,53,150,20),b.addChild(this._lab1),this._lab2=this.creatSUI(d,this.parentTarget.baseAtlas,"l_s_lab2",337,87,80,20),b.addChild(this._lab2),LabelTextFont.writeSingleLabel(this.uiAtlas,this._lab2.skinName,"战力暴涨",16,TextAlign.RIGHT,ColorType.Brown7a2f21),this._lab3=this.creatSUI(d,this.parentTarget.baseAtlas,"l_s_lab3",418,85,90,25),b.addChild(this._lab3),this._cost1=this.creatSUI(e[0],this.parentTarget.baseAtlas,"l_s_cost0",361,2,160,30),b.addChild(this._cost1),this._cost2=this.creatSUI(e[0],this.parentTarget.baseAtlas,"l_s_cost1",522,2,160,30),b.addChild(this._cost2),this._btn=this.creatSUI(d,this.parentTarget.baseAtlas,"l_s_btn",520,42,157,60),b.addChild(this._btn),this._btn.addEventListener(InteractiveEvent.Up,this.onclick,this);for(var f=0;3>f;f++){var g=this.creatSUI(d,this.parentTarget.baseAtlas,"l_s_icon"+f,28+76*f,45,68,68);b.addChild(g),this._iconAry.push(g)}},b.prototype.onclick=function(a){this.itdata.data.hasBuy||this.parentTarget.buyGift(this.itdata.id)},b.prototype.render=function(a){this.itdata=a,a&&a.data&&this.applyRender()},b.prototype.refreshDraw=function(){this.drawBuy()},b.prototype.applyRender=function(){UiDraw.uiAtlasDrawImg(this.uiAtlas,this._ibg.skinName,UIData.publicUi,PuiData.ITEMBIGBG),UiDraw.drawUseImg(this._icon,this.parentTarget.baseAtlas,"u_l_t"+this.itdata.id);var a=this.itdata.data.tabObj;LabelTextFont.writeSingleLabel(this.uiAtlas,this._lab1.skinName,a.desc,16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this.uiAtlas,this._lab3.skinName,a.force,20,TextAlign.LEFT,ColorType.Green2ca937);for(var b=0;b<this._iconAry.length;b++)a.item[b]?IconManager.getInstance().drawItemIcon60(this._iconAry[b],a.item[b][0],a.item[b][1]):IconManager.getInstance().drawItemIcon60(this._iconAry[b],0,0);this.drawKillPrice(this._cost1,"原价：",a.fake_cost,!0),this.drawKillPrice(this._cost2,"现价：",a.cost,!1),this.drawBuy()},b.prototype.drawBuy=function(){this.itdata.data.hasBuy?UiDraw.drawUseImg(this._btn,this.parentTarget.baseAtlas,"u_l_btn2"):UiDraw.drawUseImg(this._btn,this.parentTarget.baseAtlas,"u_l_btn1")},b.prototype.drawKillPrice=function(a,b,c,d){var e=this.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1),g=this.parentTarget.baseAtlas.getRec("u_l_cost");f.drawImage(this.parentTarget.baseAtlas.useImg,g.pixelX,g.pixelY,g.pixelWitdh,g.pixelHeight,0,0,e.pixelWitdh,e.pixelHeight);var h=20,i=3;h+=LabelTextFont.writeSingleLabelToCtx(f,b,16,h,i,TextAlign.LEFT,ColorType.Brown7a2f21),UiDraw.drawCost(f,h,i-10,getresIdByreward(c[0][0])),h+=35,h+=LabelTextFont.writeSingleLabelToCtx(f,String(c[0][1]),16,h,i,TextAlign.LEFT,ColorType.Brown7a2f21),d&&(f.strokeStyle="#cd2000",f.lineWidth=3,f.beginPath(),f.moveTo(10,10),f.lineTo(h+5,10+i),f.stroke(),f.closePath()),this.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)},b}(SListItem);a.KaiFuRewardListItemRender=e}(kaifu||(kaifu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kaifu;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b}return __extends(b,a),b.prototype.setUIAtlas=function(a,b){this._baseUiAtlas=a,this._winMidRender=b,this._banner=new UIRenderOnlyPicComponent,this._banner.uiAtlas=a,this.addRender(this._banner),this._bgRender=new UIRenderComponent,this._bgRender.uiAtlas=a,this.addRender(this._bgRender),this._baseRender=new UIRenderComponent,this._baseRender.uiAtlas=a,this.addRender(this._baseRender),this._topRender=new UIRenderComponent,this._topRender.uiAtlas=a,this.addRender(this._topRender),this.initUI()},b.prototype.initUI=function(){var a=this;this._baseTabObj=TableData.getInstance().getData(TableData.tb_activity_time,this._activeID),this._activeTabObj=TableData.getInstance().getData(TableData.tb_activity_daily_gift_base,this._baseTabObj.params[0]),this.addChild(this._banner.getComponent("t_banner1")),this._banner.setImgUrl(getKaifuIconUrl("b1"));this._timeUI=this.addChild(this._baseRender.getComponent("t_vr_time")),this.addBg(),this.addItems(),this.initEndTime(),this._drawTimeFun=function(){a.drawTime()}},b.prototype.addBg=function(){var a=["t_vr_t0","t_vr_t1","t_vr_t2","t_vr_y0","t_vr_y1","t_vr_y2","t_vr_j0","t_vr_j1","t_vr_j2"];this.addUIList(a,this._bgRender);for(var b=0;b<a.length;b++){var c=a[b]+"c",d=this._bgRender.getComponent(c);d.isU=!0,this.addChild(d)}},b.prototype.addItems=function(){this.items=new Array;for(var a=0;3>a;a++){var b=new c;b.create(this._baseRender,this._topRender,a,this);var d=TableData.getInstance().getData(TableData.tb_activity_daily_gift,this._activeTabObj.gift_list[a]);b.drawBase(d),this.items.push(b)}},b.prototype.draw=function(){for(var a=GuidData.grow.getActivePlayerData(this._baseTabObj.category),b=0;b<this.items.length;b++)this.items[b].drawBtn(1==a[b+1]);
},b.prototype.initEndTime=function(){var a;a=-1==this._baseTabObj.startTime?TimeUtil.getZeroTime(GameInstance.serverOpenTime):this._baseTabObj.startTime,this._activeEndTime=a+24*(this._baseTabObj.delayDays+this._baseTabObj.lastDays)*60*60},b.prototype.drawTime=function(){var a=this._activeEndTime-GameInstance.getServerNow(),b=TimeUtil.getDiffTime1(a);b=ColorType.Brown7a2f21+"剩余时间："+ColorType.colorcd2000+b,LabelTextFont.writeSingleLabel(this._baseUiAtlas,this._timeUI.skinName,b,16,TextAlign.LEFT)},b.prototype.show=function(){a.prototype.show.call(this),this.draw(),TimeUtil.addTimeTick(1e3,this._drawTimeFun)},b.prototype.hide=function(){a.prototype.hide.call(this),TimeUtil.removeTimeTick(this._drawTimeFun)},b.prototype.buyGift=function(a){NetManager.getInstance().protocolos.activity_opt_buy_dailygift(this._activeID,a)},b}(a.KaifuBaseContainer);a.KaifuVIPRewardPanel=b;var c=function(){function a(){}return a.prototype.create=function(a,b,c,d){this.title=d.addChild(a.getComponent("t_vr_title"+c)),this.vip=d.addChild(a.getComponent("t_vr_vip"+c)),this.icon=d.addChild(a.getComponent("t_vr_icon"+c)),this.cost1=d.addChild(a.getComponent("t_vr_co"+c)),this.cost2=d.addChild(a.getComponent("t_vr_po"+c)),this.btn=a.getComponent("t_vr_btn"+c),this.btnLab=d.addChild(b.getComponent("t_vr_btnlab"+c)),this.btn.addEventListener(InteractiveEvent.Up,this.onclick,this),this.root=d,this.id=c},a.prototype.onclick=function(a){return this.minVip>GuidData.player.getVipLevel()?void msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"VIP等级不够",99):void this.root.buyGift(this.id)},a.prototype.drawBase=function(a){var b=this.title.uiRender.uiAtlas;LabelTextFont.writeSingleLabel(b,this.title.skinName,a.title,16,TextAlign.CENTER,ColorType.Whitefff4d6),LabelTextFont.writeSingleLabel(b,this.vip.skinName,"VIP"+a.vip+"可购买",16,TextAlign.CENTER,ColorType.Brown7a2f21),this.minVip=a.vip,IconManager.getInstance().drawItemIcon60(this.icon,a.item[0][0],a.item[0][1]),this.drawKillPrice(this.cost1,"原价：",a.fake_cost,!0),this.drawKillPrice(this.cost2,"现价：",a.cost,!1)},a.prototype.drawBtn=function(a){a?(this.root.removeChild(this.btn),LabelTextFont.writeSingleLabel(this.btnLab.uiRender.uiAtlas,this.btnLab.skinName,"已购买",16,TextAlign.CENTER,ColorType.Brown7a2f21)):(this.root.addChild(this.btn),LabelTextFont.writeSingleLabel(this.btnLab.uiRender.uiAtlas,this.btnLab.skinName,"购买",16,TextAlign.CENTER,ColorType.Brown7a2f21))},a.prototype.drawKillPrice=function(a,b,c,d){var e=a.uiRender.uiAtlas.getRec(a.skinName),f=UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);UiDraw.cxtDrawImg(f,PuiData.TXTBG,new Rectangle(0,0,e.pixelWitdh,e.pixelHeight),UIData.publicUi);var g=20,h=3;g+=LabelTextFont.writeSingleLabelToCtx(f,b,16,g,h,TextAlign.LEFT,ColorType.Brown7a2f21),UiDraw.drawCost(f,g,h-10,getresIdByreward(c[0][0])),g+=35,g+=LabelTextFont.writeSingleLabelToCtx(f,String(c[0][1]),16,g,h,TextAlign.LEFT,ColorType.Brown7a2f21),d&&(f.strokeStyle="#cd2000",f.lineWidth=3,f.beginPath(),f.moveTo(10,10),f.lineTo(g+5,10+h),f.stroke(),f.closePath()),a.uiRender.uiAtlas.updateCtx(f,e.pixelX,e.pixelY)},a}();a.KaifuVipRewardItem=c}(kaifu||(kaifu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kaifu;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.uiAtlasComplet=!1,a.tabNameAry=["开服寻宝","七日目标","每日礼包","开服礼包"],a._currentIdx=-1,a.panelDic=[],a.width=UIData.designWidth,a.height=UIData.designHeight,a.middle=0,a.center=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a}return __extends(c,b),c.prototype.applyLoad=function(){var a=this;this._baseUiAtlas=new UIAtlas,this._baseUiAtlas.setInfo("ui/uidata/kaifu/kaifuactive.xml","ui/uidata/kaifu/kaifuactive.png",function(){a.loadConfigCom()},"ui/uidata/kaifu/kaifuactiveuse.png")},c.prototype.loadConfigCom=function(){this._baseRender.uiAtlas=this._baseUiAtlas,this._bgRender.uiAtlas=this._baseUiAtlas,this.winmidRender.uiAtlas=this._baseUiAtlas,this.addChild(this.winmidRender.getComponent("t_list_bg")),this.addChild(this._bgRender.getComponent("t_win_title"));this.uiAtlasComplet=!0,this.applyLoadComplete()},c.prototype.initTabList=function(){if(!this._btnAry){this._btnAry=new Array;for(var a=55,b=0;b<this._activeAry.length;b++){var c=TableData.getInstance().getData(TableData.tb_activity_time,this._activeAry[b]),d=this.addChild(this._bgRender.getComponent("t_list_btn_bg"));d.data=b,d.y=d.baseRec.y+b*a,this._btnAry.push(d),d.addEventListener(InteractiveEvent.Down,this.tabclick,this);var e=this.addChild(this._baseRender.getComponent("t_list_lab"));e.y=e.baseRec.y+b*a,e.goToAndStop(b),this.drawTabName(e,b,c.name)}}},c.prototype.tabclick=function(a){this.setIdx(a.target.data)},c.prototype.setIdx=function(a){for(var b=0;b<this._btnAry.length;b++)this._btnAry[b].data==a?this._btnAry[b].selected=!0:this._btnAry[b].selected=!1;this._currentIdx!=a&&(this.panelDic[a]||(this.panelDic[a]=this.getPanel(a)),this.panelDic[a].show(),this.panelDic[this._currentIdx]&&this.panelDic[this._currentIdx].hide()),this._currentIdx=a},c.prototype.getPanel=function(b){var c=TableData.getInstance().getData(TableData.tb_activity_time,this._activeAry[b]),d=c.scriptIndx;if(2==d){var e=new a.KaifuChoujiangPanel;return e.setActiveID(c.id),e.setUIAtlas(this._baseUiAtlas,this.winmidRender),e}if(3==d){var f=new a.KaifuDayTargetPanel;return f.setActiveID(c.id),f.setUIAtlas(this._baseUiAtlas,this.winmidRender),f}if(4==d){var g=new a.KaifuRewardPanel;return g.setActiveID(c.id),g.setUIAtlas(this._baseUiAtlas,this.winmidRender),g}if(1==d){var h=new a.KaifuVIPRewardPanel;return h.setActiveID(c.id),h.setUIAtlas(this._baseUiAtlas,this.winmidRender),h}},c.prototype.drawTabName=function(a,b,c){var d=UIManager.getInstance().getContext2D(a.baseRec.width,a.baseRec.height,!1);LabelTextFont.writeSingleLabelToCtx(d,c,16,0,0,TextAlign.CENTER,ColorType.Brown7a2f21);var e=this._baseUiAtlas.getRec(a.skinName);this._baseUiAtlas.updateCtx(d,e.pixelX,e.pixelY+a.baseRec.height*b)},c.prototype.butClik=function(a){a.target==this.w_close&&this.hide()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.panelDic[this._currentIdx].hide(),this._currentIdx=-1,b.prototype.hide.call(this)},c.prototype.show=function(a){this._activeAry=a,UIManager.getInstance().addUIContainer(this),ModulePageManager.showResTittle([1,2,3]),this.initTabList(),this.setIdx(0)},c.prototype.getRankActiveID=function(){for(var a=0;a<this._activeAry.length;a++){var b=TableData.getInstance().getData(TableData.tb_activity_time,this._activeAry[a]);if(3==b.scriptIndx)return this._activeAry[a]}return 0},c.prototype.getChouJiangActiveID=function(){return 2},c.prototype.choujiangChg=function(){0==this._currentIdx&&this.panelDic[0].drawReward()},c.prototype.playerDataChg=function(){1==this._currentIdx?this.panelDic[1].drawReward():2==this._currentIdx?this.panelDic[2].refresh():3==this._currentIdx&&this.panelDic[3].draw()},c.prototype.dayTargetList=function(a){1==this._currentIdx&&this.panelDic[1].setListData(a)},c}(WindowUi);a.KaiFuActivePanel=b}(kaifu||(kaifu={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),kaifu;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"KaiFuModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.KaiFuModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_KAIFU_PANEL_EVENT="SHOW_KAIFU_PANEL_EVENT",b.KAIFU_CHOUJING_CHG_EVENT="KAIFU_CHOUJING_CHG_EVENT",b}(BaseEvent);a.KaiFuEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"KaiFuProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.SHOW_KAIFU_PANEL_EVENT&&this.showPanel()}else if(a instanceof ActiveEvent)a.type==ActiveEvent.ACTIVE_GLOBEL_CHOUJIANG_EVENT?this.choujiangChg():a.type==ActiveEvent.ACTIVE_PLAYER_CHANGE_EVENT&&this.playerDataChg();else if(a instanceof UIPanelEvent){var d=a;d.panel==this._kaifuPanel&&(this._kaifuPanel.dispose(),this._kaifuPanel=null,console.log("释放面板 _mailPanel"))}},d.prototype.choujiangChg=function(){this._kaifuPanel&&this._kaifuPanel.hasStage&&this._kaifuPanel.choujiangChg()},d.prototype.playerDataChg=function(){this._kaifuPanel&&this._kaifuPanel.hasStage&&this._kaifuPanel.playerDataChg()},d.prototype.showPanel=function(){var b=this,c=GuidData.globelValue.getKaiFuActiveList();this._kaifuPanel||(this._kaifuPanel=new a.KaiFuActivePanel),this._kaifuPanel.load(function(){b._kaifuPanel.show(c)},!0)},d.prototype.dayTargetList=function(a){var b=new s2c_activity_opt_show_rank_list;s2c_activity_opt_show_rank_list.read(b,a),this._kaifuPanel&&this._kaifuPanel.hasStage&&this._kaifuPanel.dayTargetList(b)},d.prototype.getHanderMap=function(){var a=this,b=new Object;return b[Protocols.SMSG_ACTIVITY_OPT_SHOW_RANK_LIST]=function(b){a.dayTargetList(b)},b},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_KAIFU_PANEL_EVENT),new c(c.KAIFU_CHOUJING_CHG_EVENT),new ActiveEvent(ActiveEvent.ACTIVE_GLOBEL_CHOUJIANG_EVENT),new ActiveEvent(ActiveEvent.ACTIVE_PLAYER_CHANGE_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.MailProcessor=d}(kaifu||(kaifu={}));var ActiveEvent=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.ACTIVE_PLAYER_CHANGE_EVENT="ACTIVE_PLAYER_CHANGE_EVENT",b.ACTIVE_GLOBEL_CHOUJIANG_EVENT="ACTIVE_GLOBEL_CHOUJIANG_EVENT",b}(BaseEvent),moneytree;!function(a){var b=function(){function a(){}return a}();a.MoneyTreeGiftVo=b;var c=function(){function a(){}return a}();a.MoneyTreeBaseVo=c;var d=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.getGiftAry=function(){for(var a=new Array,c=tb.TB_moneytree_gift.get_TB_moneytree_gift(),d=0;d<c.length;d++){var e=new b;e.tab=c[d],GuidData.player.getMoneyTreeNum()>=c[d].count?e.state=GuidData.player.getMoneyTreeState(d)?2:1:e.state=0,a.push(e)}return a},a.prototype.getCurVo=function(){var a=tb.TB_moneytree_base.get_TB_moneytree_base(),b=GuidData.player.getMoneyTreeNum()>=a.length?a.length-1:GuidData.player.getMoneyTreeNum(),d=tb.TB_moneytree_lv.get_TB_moneytree_lvById(GuidData.player.getLevel()),e=new c;return e.tab=a[b],e.state=0,e.tab.cost&&e.tab.cost.length>0&&(e.state=1),e.money=Snum(Math.floor(d.reward[1]*e.tab.rate/1e4)),e},a}();a.MoneyTreeModel=d}(moneytree||(moneytree={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),moneytree;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.setBlackBg(),a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._midRender=new UIRenderComponent,a.addRender(a._midRender),a._bgRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._midRender.dispose(),this._midRender=null,this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._frameRender&&(this._frameRender.dispose(),this._frameRender=null),this._frameRender1&&(this._frameRender1.dispose(),this._frameRender1=null),b.prototype.dispose.call(this)},c.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas.setInfo("ui/uidata/moneytree/moneytree.xml","ui/uidata/moneytree/moneytree.png",function(){a.loadConfigCom()})},c.prototype.loadConfigCom=function(){this._midRender.uiAtlas=this._bgRender.uiAtlas,this._baseRender.uiAtlas=this._bgRender.uiAtlas,this.addUIList(["a_tiitle"],this._bgRender),this.addUIList(["a_info","a_bg"],this._baseRender),this.a_tree=this.addChild(this._bgRender.getComponent("a_tree")),this.a_times=this.addChild(this._baseRender.getComponent("a_times")),this.a_money=this.addChild(this._midRender.getComponent("a_money")),this.a_txt=this.addChild(this._midRender.getComponent("a_txt")),this.a_cost=this.addChild(this._midRender.getComponent("a_cost")),this._rewardAry=new Array,this._infoAry=new Array,this._stateAry=new Array,this._proAry=new Array,this._proAry.push(this.addChild(this._bgRender.getComponent("a_pro0"))),this._proAry.push(this.addChild(this._bgRender.getComponent("a_pro1"))),this._rewardAry=new Array;for(var a=0;3>a;a++){this.addChild(this._bgRender.getComponent("a_rewardbg"+a));var b=this.addChild(this._baseRender.getComponent("a_icon"+a));b.addEventListener(InteractiveEvent.Up,this.rewardClik,this),this._rewardAry.push(b),this._infoAry.push(this.addChild(this._baseRender.getComponent("a_timesinfo"+a))),this._stateAry.push(this.addChild(this._midRender.getComponent("a_state"+a)))}this.a_btn=this.addEvntButUp("a_btn",this._midRender),this.resize(),this.buildFram()},c.prototype.buildFram=function(){var a=this;this._frameRender||(this._frameRender=new FrameUIRender,this.addRender(this._frameRender),this._frameRender.setImg(getEffectUIUrl("ef_fl"),4,4,function(b){a.effAry=b;for(var c=0;c<a.effAry.length;c++)a.effAry[c].x=a._rewardAry[c].x-21,a.effAry[c].y=a._rewardAry[c].y-21,a.effAry[c].width=.7*a.effAry[c].baseRec.width,a.effAry[c].height=.7*a.effAry[c].baseRec.height,a.effAry[c].speed=3;a.playEff(),a.applyLoadComplete()},this._rewardAry.length))},c.prototype.playEff=function(){if(this.effAry)for(var a=0;a<this._rewardAry.length;a++){var b=this._rewardAry[a].data;b&&1==b.state?(this.addChild(this.effAry[a]),this.effAry[a].play()):this.removeChild(this.effAry[a])}},c.prototype.showSkillUpEff=function(){var a=this;console.log("up skill lev"),this._frameRender1||(this._frameRender1=new FrameUIRender,this.addRender(this._frameRender1),this._frameRender1.setImg(getEffectUIUrl("ui_yqs"),4,4,function(b){a.upLevEff=b,a.upLevEff.x=a.a_tree.x+55,a.upLevEff.y=a.a_tree.y+35,a.upLevEff.width=1.6*a.upLevEff.baseRec.width,a.upLevEff.height=1.6*a.upLevEff.baseRec.height,a.upLevEff.speed=3,a.upLevEff.playOne(a)})),this.upLevEff&&this.upLevEff.playOne(this)},c.prototype.showflyword=function(a){var b=new Vector2D(this.a_btn.parent.x/UIData.Scale+this.a_btn.x+this.a_btn.width,this.a_btn.parent.y/UIData.Scale+this.a_btn.y),c=a.split("|");msgtip.MsgTipManager.outStr(ColorType.Yellowedce7e+c[1]+"倍暴击",msgtip.PopMsgVo.type8,b)},c.prototype.resetData=function(){this.residueTime(),this.drawReward(),this.drawMoney(),this.playEff()},c.prototype.drawReward=function(){for(var b=a.MoneyTreeModel.getInstance().getGiftAry(),c=0;c<b.length;c++){if(c<this._rewardAry.length){this._rewardAry[c].data=b[c],IconManager.getInstance().drawItemIcon40(this._rewardAry[c],b[c].tab.rewards[0][0],b[c].tab.rewards[0][1],2==b[c].state,!1);var d,e=b[c].tab.count-GuidData.player.getMoneyTreeNum();d=e>0?e+"次可领取":"可领取",LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this._infoAry[c].skinName,d,14,TextAlign.CENTER,ColorType.Brown7a2f21);var f=2!=b[c].state?0:1;this._stateAry[c].goToAndStop(f)}if(c<this._proAry.length){var g=0!=b[c+1].state?1:0;this._proAry[c].goToAndStop(g)}}},c.prototype.residueTime=function(){if(this.a_times){var a=tb.TB_vip_base.get_TB_vip_baseById(GuidData.player.getVipLevel());this._hastimes=a.treeTimes-GuidData.player.getMoneyTreeNum(),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_times.skinName,ColorType.color9a683f+"剩余次数："+ColorType.Green2ca937+this._hastimes,14,TextAlign.CENTER)}},c.prototype.drawMoney=function(){var b=a.MoneyTreeModel.getInstance().getCurVo();LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_money.skinName,"本次可获得"+b.money,14,TextAlign.CENTER,ColorType.Whitefff4d6);var c;0==b.state?(UiDraw.clearUI(this.a_cost),this.a_txt.x=456,c=ColorType.Green2ca937+"免费",this._canbuy=!0):(this.a_txt.x=414,c=ColorType.color9a683f+"消耗:",this._canbuy=UiDraw.drawRewardIconAndtxt(this.a_cost,b.tab.cost[0],!0,TextAlign.LEFT,10)),LabelTextFont.writeSingleLabel(this._midRender.uiAtlas,this.a_txt.skinName,c,14,TextAlign.CENTER)},c.prototype.rewardClik=function(a){var b=a.target.data;if(b)if(1==b.state)NetManager.getInstance().protocolos.get_moneytree_gift(b.tab.id);else{var c=tb.TB_item_template.get_TB_item_template(b.tab.rewards[0][0]),d=new BagItemData;d.entryData=c;var e=new charbg.ItemTipEvent(charbg.ItemTipEvent.SHOW_TIP_ITEM_EVENT);e.data=d,e.buttonType=-1,ModuleEventManager.dispatchEvent(e)}},c.prototype.butClik=function(b){var c=this;switch(b.target){case this.c_close:ModuleEventManager.dispatchEvent(new a.MoneyTreeEvent(a.MoneyTreeEvent.HIDE_MoneyTree_EVENT));break;case this.a_btn:UiTweenScale.getInstance().changeButSize(b.target);var d=a.MoneyTreeModel.getInstance().getCurVo(),e=new Array;0==d.state?(e.push(2),e.push(0)):e=d.tab.cost[0],costRes(e,function(){c._hastimes>0?NetManager.getInstance().protocolos.use_moneytree():msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"次数不足，提升vip等级可增加每日上限哦",99)},function(){})}},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c}(WindowCentenMin);a.MoneyTree=b}(moneytree||(moneytree={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),moneytree;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"MoneyTreeModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.MoneyTreeModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.HIDE_MoneyTree_EVENT="HIDE_MoneyTree_EVENT",b.SHOW_MoneyTree_EVENT="SHOW_MoneyTree_EVENT",b.CHG_MoneyTree_REWARD_EVENT="CHG_MoneyTree_REWARD_EVENT",b.SHOW_EFF_MoneyTree_EVENT="SHOW_EFF_MoneyTree_EVENT",b.EFF_EVENT="EFF_EVENT",b}(BaseEvent);a.MoneyTreeEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"MoneyTreeProcessor"},d.prototype.receivedModuleEvent=function(a){var b=a;if(a instanceof c&&(b.type==c.SHOW_MoneyTree_EVENT?this.showRankingUi():b.type==c.HIDE_MoneyTree_EVENT?this.hideRankingUi():b.type==c.CHG_MoneyTree_REWARD_EVENT?this.chgreward():b.type==c.SHOW_EFF_MoneyTree_EVENT?this._moneyTree&&this._moneyTree.showSkillUpEff():b.type==c.EFF_EVENT&&this._moneyTree&&this._moneyTree.showflyword(b.data)),a instanceof UIPanelEvent){var d=a;d.panel==this._moneyTree&&(this._moneyTree.dispose(),this._moneyTree=null,console.log("释放面板 _rankingUiPanel"))}a instanceof EngineEvent&&a.type==EngineEvent.MONEY_CHANGE&&this.moneyChg()},d.prototype.chgreward=function(){this._moneyTree&&this._moneyTree.drawReward()},d.prototype.moneyChg=function(){this._moneyTree&&this._moneyTree.resetData()},d.prototype.showRankingUi=function(){var b=this;this._moneyTree||(this._moneyTree=new a.MoneyTree),this._moneyTree.load(function(){b._moneyTree.show()},!1)},d.prototype.hideRankingUi=function(){this._moneyTree&&this._moneyTree.hide()},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_MoneyTree_EVENT),new c(c.HIDE_MoneyTree_EVENT),new c(c.CHG_MoneyTree_REWARD_EVENT),new c(c.SHOW_EFF_MoneyTree_EVENT),new c(c.EFF_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new EngineEvent(EngineEvent.MONEY_CHANGE)]},d}(BaseProcessor);a.MoneyTreeProcessor=d}(moneytree||(moneytree={}));var chgfish;!function(a){var b=function(){function b(){}return b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.addItem=function(b){if(this._itemAry||(this._itemAry=new Array),b.id){var c=tb.TB_red_point.get_TB_red_pointById(b.id);c&&1==c.tip&&(this.hasitem(b.id)||(b.tab=c,this._itemAry.push(b),ModuleEventManager.dispatchEvent(new a.ChgfishEvent(a.ChgfishEvent.REFRESH_Chgfish_EVENT))))}},b.prototype.removeItem=function(b){if(!this._itemAry)return void(this._itemAry=new Array);if(b.id){var c=tb.TB_red_point.get_TB_red_pointById(b.id);if(c&&1==c.tip){var d=this._itemAry.indexOf(b);-1!=d&&(this._itemAry.splice(d,1),ModuleEventManager.dispatchEvent(new a.ChgfishEvent(a.ChgfishEvent.REFRESH_Chgfish_EVENT)))}}},b.prototype.hasitem=function(a){if(!this._itemAry)return!1;for(var b=0;b<this._itemAry.length;b++)if(this._itemAry[b].id==a)return!0;return!1},b.prototype.getList=function(){return this._itemAry||(this._itemAry=new Array),this._itemAry},b}();a.ChgfishModel=b}(chgfish||(chgfish={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),chgfish;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.width=UIData.designWidth,b.height=UIData.designHeight,b.top=0,b.right=0,b._bgRender=new UIRenderComponent,b.addRender(b._bgRender),b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._baseRender.uiAtlas=new UIAtlas,b}return __extends(b,a),b.prototype.dispose=function(){this._bgRender.dispose(),this._bgRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.fishTabList&&(this.fishTabList.dispose(),this.fishTabList=null),a.prototype.dispose.call(this)},b.prototype.applyLoad=function(){var a=this;this._baseRender.uiAtlas.setInfo("ui/uidata/dropmenu/dropmenu.xml","ui/uidata/dropmenu/dropmenu.png",function(){a.loadConfigCom()},"ui/uidata/dropmenu/dropmenupc.png")},b.prototype.loadConfigCom=function(){var a=this;this._bgRender.uiAtlas=this._baseRender.uiAtlas,this._topRender.uiAtlas=this._baseRender.uiAtlas;var b=this._baseRender;this.c_basebg=this.addChild(this._bgRender.getComponent("c_basebg")),this.c_basebg.addEventListener(InteractiveEvent.Up,function(a){},this),this.c_basebg.addEventListener(InteractiveEvent.Down,function(b){a.hide()},this),this.c_bg=this.addChild(b.getComponent("c_bg")),this.applyLoadComplete()},b.prototype.show=function(a){this.hasStage||UIManager.getInstance().addUIContainer(this),this.fishTabList||(this.fishTabList=new c,this.fishTabList.init(this._baseRender.uiAtlas)),this.fishTabList.show(),this.c_bg.x=a.x-5,this.c_bg.y=a.y+a.height,this.fresh(),this.resize()},b.prototype.fresh=function(){},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this),this.fishTabList&&this.fishTabList.hide()},b.prototype.resize=function(){this.c_basebg.top=0,this.c_basebg.left=0,this.c_basebg.height=Scene_data.stageHeight/UIData.Scale,this.c_basebg.width=Scene_data.stageWidth/UIData.Scale,a.prototype.resize.call(this),this.fishTabList&&(this.fishTabList.left=this.c_bg.parent.x/UIData.Scale+this.c_bg.x+6,this.fishTabList.top=this.c_bg.parent.y/UIData.Scale+this.c_bg.y+17)},b.prototype.butClik=function(a){switch(a.target){}},b}(UIPanel);a.ChgfishUiPanel=b;var c=function(b){function c(){return b.call(this)||this}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,154,182,0,52,3,256,512,1,6)},c.prototype.refreshDataByNewData=function(){var a=this.getData();this.refreshData(a)},c.prototype.getData=function(){for(var b=new Array,c=a.ChgfishModel.getInstance().getList(),d=0;d<c.length;d++){var e=new SListItemData;e.data=c[d],e.id=d,b.push(e)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData(),this.setSelectIndex(0)},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.FishTabList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.CS_tab=this.creatSUI(c,this.parentTarget.baseAtlas,"CS_tab",0,0,154,52),a.addChild(this.CS_tab),this.CS_name=this.creatSUI(d,this.parentTarget.baseAtlas,"CS_name",9,13,140,20),a.addChild(this.CS_name)},c.prototype.drawTab=function(){var a=this._baseRender.uiAtlas.getRec(this.CS_tab.skinName),b=UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1),c=this.parentTarget.baseAtlas.getRec("Tabbg");b.drawImage(this.parentTarget.baseAtlas.useImg,c.pixelX,c.pixelY,c.pixelWitdh,c.pixelHeight,0,0,c.pixelWitdh,c.pixelHeight),this._baseRender.uiAtlas.updateCtx(b,a.pixelX,a.pixelY)},c.prototype.applyrender=function(){if(this.itdata){UiDraw.SharedDrawImg(this.uiAtlas,this.parentTarget.baseAtlas,this.CS_tab.skinName,"Tabbg");var a=this.itdata.data;LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.CS_name.skinName,a.tab.name,16,TextAlign.LEFT,ColorType.Brown7a2f21)}},c.prototype.render=function(a){this.itdata=a,a?(this.applyrender(),this.CS_tab.addEventListener(InteractiveEvent.Up,this.equClick,this)):(this.CS_tab.removeEventListener(InteractiveEvent.Up,this.equClick,this),this.setnull())},c.prototype.equClick=function(b){if(this.itdata&&this.itdata.data){if(!UIManager.getInstance().disMoveNnum(new Vector2D(b.x,b.y),10))return;var c=this.itdata.data;ModuleEventManager.dispatchEvent(new a.ChgfishEvent(a.ChgfishEvent.HIDE_Chgfish_EVENT)),ModulePageManager.openPanel(c.tab.link[0],c.tab.link.slice(1,c.tab.link.length))}},c.prototype.setnull=function(){LabelTextFont.clearLabel(this.uiAtlas,this.CS_tab.skinName),LabelTextFont.clearLabel(this.uiAtlas,this.CS_name.skinName)},c}(SListItem);a.FishTabRender=d}(chgfish||(chgfish={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),chgfish;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"ChgfishModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.ChgfishModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SHOW_Chgfish_EVENT="SHOW_Chgfish_EVENT",b.HIDE_Chgfish_EVENT="HIDE_Chgfish_EVENT",b.REFRESH_Chgfish_EVENT="REFRESH_Chgfish_EVENT",b}(BaseEvent);a.ChgfishEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"ChgfishProcessor"},d.prototype.receivedModuleEvent=function(b){if(b instanceof c){var d=b;d.type==c.SHOW_Chgfish_EVENT?this.showUi(d.data):d.type==c.HIDE_Chgfish_EVENT?this.hideUi():d.type==c.REFRESH_Chgfish_EVENT&&this._chgfishUiPanel&&this._chgfishUiPanel.fishTabList&&this._chgfishUiPanel.fishTabList.hasStage&&this._chgfishUiPanel.fishTabList.refreshDataByNewData()}if(b instanceof RedPointEvent){var e=b;e.type==RedPointEvent.SHOW_REDPOINT_EVENT?a.ChgfishModel.getInstance().addItem(e.node):e.type==RedPointEvent.HIDE_REDPOINT_EVENT&&a.ChgfishModel.getInstance().removeItem(e.node)}if(b instanceof UIPanelEvent){var f=b;f.panel==this._chgfishUiPanel&&(this._chgfishUiPanel.dispose(),this._chgfishUiPanel=null,console.log("释放面板 _chgfishUiPanel"))}},d.prototype.hideUi=function(){this._chgfishUiPanel.hide()},d.prototype.showUi=function(b){var c=this;this._chgfishUiPanel||(this._chgfishUiPanel=new a.ChgfishUiPanel),this._chgfishUiPanel.load(function(){c._chgfishUiPanel.show(b)})},d.prototype.listenModuleEvents=function(){return[new c(c.SHOW_Chgfish_EVENT),new c(c.HIDE_Chgfish_EVENT),new c(c.REFRESH_Chgfish_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT),new RedPointEvent(RedPointEvent.SHOW_REDPOINT_EVENT),new RedPointEvent(RedPointEvent.HIDE_REDPOINT_EVENT)]},d}(BaseProcessor);a.ChgfishProcessor=d}(chgfish||(chgfish={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),selectserver;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baImg=new UIBackImg,a._baImg.setImgInfo("ui/load/goplay.png",1024,512),a.addRender(a._baImg),a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._middleRender=new UIRenderComponent,a.addRender(a._middleRender),a._bgRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baImg.dispose(),this._baImg=null,this._bgRender.dispose(),this._bgRender=null,this._middleRender.dispose(),this._middleRender=null},c.prototype.applyLoad=function(){var a=this;this._bgRender.uiAtlas.setInfo("ui/uidata/selectserver/goplay.xml","ui/uidata/selectserver/goplay.png",function(){a.loadConfigCom()},"ui/uidata/selectserver/selectserverpc.png")},c.prototype.loadConfigCom=function(){var b=this;this._middleRender.uiAtlas=this._bgRender.uiAtlas;var c=this._middleRender;this.a_gg=this.addEvntButUp("a_gg",c),this.a_bg=this.addEvntButUp("a_bg",this._bgRender),this.a_enter=this.addEvntButUp("a_enter",c),this.a_state=this.addChild(c.getComponent("a_state")),this.a_serverid=this.addChild(c.getComponent("a_serverid")),this.a_servername=this.addChild(c.getComponent("a_servername")),this.resize(),LoadManager.getInstance().load("xuanfu.txt",LoadManager.XML_TYPE,function(c){var d=JSON.parse(c);a.SelectServerModel.getInstance().convertObj(d),b.applyLoadComplete()})},c.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},c.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},c.prototype.resetData=function(){var b=a.SelectServerModel.getInstance().getCurVo(),c=a.SelectServerModel.getInstance().StateKey[b.state];UiDraw.SharedDrawImg(this._bgRender.uiAtlas,this._bgRender.uiAtlas,this.a_state.skinName,c),LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.a_serverid.skinName,b.id+"服",16,TextAlign.CENTER,ColorType.Whitefff4d6),LabelTextFont.writeSingleLabel(this._bgRender.uiAtlas,this.a_servername.skinName,b.name,16,TextAlign.CENTER,ColorType.Whitefff4d6)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.butClik=function(b){switch(UiTweenScale.getInstance().changeButSize(b.target),b.target){case this.a_enter:ModuleEventManager.dispatchEvent(new a.SelectServerEvent(a.SelectServerEvent.HIDE_JOINGAME_EVENT));break;case this.a_bg:this.hide(),ModuleEventManager.dispatchEvent(new a.SelectServerEvent(a.SelectServerEvent.OPEN_SELECTSERVER_EVENT));break;case this.a_gg:ModuleEventManager.dispatchEvent(new a.SelectServerEvent(a.SelectServerEvent.OPEN_GG_EVENT));
}},c}(UIPanel);a.JoinGameUiPanel=b}(selectserver||(selectserver={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),selectserver;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b.left=295,b.top=98,b}return __extends(b,a),b.prototype.init=function(a){this.baseAtlas=a,this.initData()},b.prototype.initData=function(){var a=new Array;this.setData(a,c,566,354,283,66,5,1024,512,2,7,1)},b.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},b.prototype.show=function(a){this.hasStage||UIManager.getInstance().addUIContainer(this);var b=this.getData(a);this.refreshData(b)},b.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},b}(SList);a.xuanfuList=b;var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e);var f=this._customRenderAry[0];this.bg=this.creatSUI(c,this.parentTarget.baseAtlas,"bg",0,0,275,62),a.addChild(this.bg),this.bg.addEventListener(InteractiveEvent.Up,this.equClick,this),this["new"]=this.creatSUI(d,this.parentTarget.baseAtlas,"new",0,0,33,33),a.addChild(this["new"]),this.state=this.creatSUI(f,this.parentTarget.baseAtlas,"state",12,19,25,25),a.addChild(this.state),this.serverid=this.creatSUI(d,this.parentTarget.baseAtlas,"serverid",47,21,36,20),a.addChild(this.serverid),this.servername=this.creatSUI(f,this.parentTarget.baseAtlas,"servername",96,21,70,20),a.addChild(this.servername),this.rolebg=this.creatSUI(d,this.parentTarget.baseAtlas,"rolebg",165,18,106,27),a.addChild(this.rolebg),this.roleinfomation=this.creatSUI(f,this.parentTarget.baseAtlas,"roleinfomation",168,22,100,20),a.addChild(this.roleinfomation)},c.prototype.applyrender=function(){var b=this.itdata.data;UiDraw.SharedDrawImg(this._baseRender.uiAtlas,this.parentTarget.baseAtlas,this.bg.skinName,"bg"),b.isnew?UiDraw.SharedDrawImg(this._baseRender.uiAtlas,this.parentTarget.baseAtlas,this["new"].skinName,"new"):UiDraw.clearUI(this["new"]);var c=a.SelectServerModel.getInstance().StateKey[b.state];if(UiDraw.SharedDrawImg(this._baseRender.uiAtlas,this.parentTarget.baseAtlas,this.state.skinName,c),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.serverid.skinName,b.id+"服",16,TextAlign.LEFT,ColorType.Brown7a2f21),LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.servername.skinName,b.name,16,TextAlign.LEFT,ColorType.Brown7a2f21),b.role){UiDraw.SharedDrawImg(this._baseRender.uiAtlas,this.parentTarget.baseAtlas,this.rolebg.skinName,"rolebg");var d=a.SelectServerModel.getInstance().RoleKey[b.role.roletype];LabelTextFont.writeSingleLabel(this._baseRender.uiAtlas,this.roleinfomation.skinName,"LV"+b.role.rolelev+" "+d,14,TextAlign.CENTER,ColorType.Whitefff4d6)}else UiDraw.clearUI(this.rolebg),UiDraw.clearUI(this.roleinfomation)},c.prototype.render=function(a){this.itdata=a,a&&a.data?this.applyrender():this.setnull()},c.prototype.equClick=function(b){UIManager.getInstance().disMoveNnum(new Vector2D(b.x,b.y),10)&&this.itdata&&this.itdata.data&&(a.SelectServerModel.getInstance().ChgCurVo(this.itdata.data),ModuleEventManager.dispatchEvent(new a.SelectServerEvent(a.SelectServerEvent.HIDE_SELECTSERVER_EVENT)),ModuleEventManager.dispatchEvent(new a.SelectServerEvent(a.SelectServerEvent.SHOW_JOINGAME_EVENT)))},c.prototype.setnull=function(){UiDraw.clearUI(this.bg),UiDraw.clearUI(this["new"]),UiDraw.clearUI(this.state),UiDraw.clearUI(this.serverid),UiDraw.clearUI(this.servername),UiDraw.clearUI(this.rolebg),UiDraw.clearUI(this.roleinfomation)},c}(SListItem);a.xuanfuListRender=c}(selectserver||(selectserver={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),selectserver;!function(a){var b=function(b){function d(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a}return __extends(d,b),d.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.ssTabList&&(this.ssTabList.dispose(),this.ssTabList=null),this.xuanfulist&&(this.xuanfulist.dispose(),this.xuanfulist=null)},d.prototype.initUiAtlas=function(a){this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},d.prototype.initView=function(){var a=this._baseRender;this.addChild(a.getComponent("c_bg0")),this.addChild(a.getComponent("c_bg1")),this.addChild(a.getComponent("a_title")),this.addChild(a.getComponent("c_info")),this.a_index=this.addChild(a.getComponent("a_index")),this.a_index0=this.addChild(a.getComponent("a_index0"))},d.prototype.resize=function(){b.prototype.resize.call(this),this.ssTabList&&(this.ssTabList.left=this.a_index.parent.x/UIData.Scale+this.a_index.x,this.ssTabList.top=this.a_index.parent.y/UIData.Scale+this.a_index.y),this.xuanfulist&&(this.xuanfulist.left=this.a_index0.parent.x/UIData.Scale+this.a_index0.x,this.xuanfulist.top=this.a_index0.parent.y/UIData.Scale+this.a_index0.y)},d.prototype.refreshData=function(b){this.xuanfulist||(this.xuanfulist=new a.xuanfuList,this.xuanfulist.init(this._baseRender.uiAtlas)),this.xuanfulist.show(b)},d.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.ssTabList||(this.ssTabList=new c,this.ssTabList.init(this._baseRender.uiAtlas)),this.ssTabList.show(),this.resize()},d.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this),this.ssTabList&&this.ssTabList.hide(),this.xuanfulist&&this.xuanfulist.hide()},d}(UIVirtualContainer);a.Ssxuanfu=b;var c=function(b){function c(){var a=b.call(this)||this;return a.left=111,a.top=98,a}return __extends(c,b),c.prototype.init=function(a){this.baseAtlas=a,this.initData()},c.prototype.initData=function(){var a=new Array;this.setData(a,d,152,354,0,48,7,256,512,1,10)},c.prototype.refreshDataByNewData=function(){var b=a.SelectServerModel.getInstance().getFinalList();this._itemDataList=this.getData(b),this.refreshData(this._itemDataList);for(var c=0;c<b.length;c++){var d=b[c];d.select&&(this.scrollIdx(c),this.setSelectIndex(c))}},c.prototype.getData=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=new SListItemData;d.data=a[c],d.id=c,b.push(d)}return b},c.prototype.show=function(){this.hasStage||UIManager.getInstance().addUIContainer(this),this.refreshDataByNewData()},c.prototype.hide=function(){this.hasStage&&UIManager.getInstance().removeUIContainer(this)},c}(SList);a.SsTabList=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.create=function(a,c,d,e){void 0===e&&(e=null),b.prototype.create.call(this,a,c,d,e),this.Tabbg=this.creatSUI(c,this.parentTarget.baseAtlas,"Tabbg",0,0,152,48),a.addChild(this.Tabbg),this.Tabbg.addEventListener(InteractiveEvent.Up,this.equClick,this),this.Tabname=this.creatSUI(d,this.parentTarget.baseAtlas,"Tabname",26,14,100,20),a.addChild(this.Tabname)},Object.defineProperty(c.prototype,"selected",{get:function(){return this._selected},set:function(b){if(this._selected=b,this.applyrender(),b){var c=new a.SelectServerEvent(a.SelectServerEvent.SELECT_TAB_EVENT);c.data=this.itdata.data.serverary,ModuleEventManager.dispatchEvent(c)}},enumerable:!0,configurable:!0}),c.prototype.drawTab=function(){var a,b=this._baseRender.uiAtlas.getRec(this.Tabbg.skinName),c=UIManager.getInstance().getContext2D(b.pixelWitdh,b.pixelHeight,!1);a=this.selected?this.parentTarget.baseAtlas.getRec("btn_select"):this.parentTarget.baseAtlas.getRec("btn_noselect"),c.drawImage(this.parentTarget.baseAtlas.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,a.pixelWitdh,a.pixelHeight),this._baseRender.uiAtlas.updateCtx(c,b.pixelX,b.pixelY)},c.prototype.applyrender=function(){if(this.itdata&&this.itdata.data){var a=this.itdata.data;if(a.tabname&&a.tabname.length>0)LabelTextFont.writeSingleLabel(this.uiAtlas,this.Tabname.skinName,a.tabname,16,TextAlign.CENTER,ColorType.Brown7a2f21);else{var b,c=a.serverary[0].id,d=a.serverary[a.serverary.length-1].id;b=c>d?d+" - "+c+"服":c+" - "+d+"服",LabelTextFont.writeSingleLabel(this.uiAtlas,this.Tabname.skinName,b,16,TextAlign.CENTER,ColorType.Brown7a2f21)}this.drawTab()}},c.prototype.render=function(a){this.itdata=a,a?this.applyrender():this.setnull()},c.prototype.equClick=function(a){UIManager.getInstance().disMoveNnum(new Vector2D(a.x,a.y),10)&&this.itdata&&this.itdata.data&&this.setSelect()},c.prototype.setnull=function(){UiDraw.clearUI(this.Tabbg),UiDraw.clearUI(this.Tabname)},c}(SListItem);a.SsTabListRender=d}(selectserver||(selectserver={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),selectserver;!function(a){var b=function(a){function b(){var b=a.call(this)||this;return b._mouseY=0,b.curY=0,b.scrollLock=!0,b._txtHight=0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.center=0,b.middle=0,b._baseRender=new UIRenderComponent,b.addRender(b._baseRender),b._topRender=new UIRenderComponent,b.addRender(b._topRender),b._bgMask=new UIMask,b._bgMask.x=146,b._bgMask.y=110,b._bgMask.width=695,b._bgMask.height=355,b.addMask(b._bgMask),b._topRender.mask=b._bgMask,b}return __extends(b,a),b.prototype.dispose=function(){this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this._bgMask.dispose(),this._bgMask=null},b.prototype.initUiAtlas=function(a){this._baseRender.uiAtlas=a,this._topRender.uiAtlas=a,this.initView()},b.prototype.initView=function(){var a=this._baseRender,b=this.addChild(a.getComponent("b_angel3"));b.isU=!0,b.isV=!0;var c=this.addChild(a.getComponent("b_angel1"));c.isU=!0,this.addChild(a.getComponent("b_angel0"));var d=this.addChild(a.getComponent("b_angel2"));d.isV=!0,this.addUIList(["b_topline","b_leftline","b_leftline_copy","b_topline_copy","b_title"],a),this.b_gonggao=this.addChild(this._topRender.getComponent("b_gonggao")),this.b_gonggao.addEventListener(InteractiveEvent.Down,this.onDown,this)},b.prototype.resize=function(){a.prototype.resize.call(this)},b.prototype.onDown=function(a){this._bgMask.testPoint(a.x,a.y)&&(this._mouseY=a.y,this.scrollLock||(Scene_data.uiStage.addEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.addEventListener(InteractiveEvent.Up,this.onUp,this)))},b.prototype.onMove=function(a){var b=a.y-this._mouseY;this._mouseY=a.y;var c=this._txtHight-this._bgMask.height;return this.curY=this.curY-b,this.curY<=0?void(this.b_gonggao.y=110):this.curY>=c?void(this.b_gonggao.y=110-c):void(this.b_gonggao.y=this.b_gonggao.y+b)},b.prototype.onUp=function(a){Scene_data.uiStage.removeEventListener(InteractiveEvent.Move,this.onMove,this),Scene_data.uiStage.removeEventListener(InteractiveEvent.Up,this.onUp,this)},b.prototype.show=function(){UIManager.getInstance().addUIContainer(this),this.resetData()},b.prototype.hide=function(){UIManager.getInstance().removeUIContainer(this)},b.prototype.resetData=function(){var a=this;LoadManager.getInstance().load("gg.txt",LoadManager.XML_TYPE,function(b){b=b.replace(/\r/g,"\n");var c=LabelTextFont.writeText(a._baseRender.uiAtlas,a.b_gonggao.skinName,0,0,b,16,ColorType.color9a683f,685,!0);a._txtHight=c[1],a.scrollLock=a._txtHight<=a._bgMask.height,a.b_gonggao.y=110}),this.resize()},b}(UIVirtualContainer);a.Ssgonggao=b}(selectserver||(selectserver={}));var selectserver;!function(a){var b=function(){function a(){this.StateKey=["red","orange","green","gray"],this.RoleKey=["道士","枪客","枪客","剑客","剑客","道士","道士"]}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.convertObj=function(a){if(!this._finalAry){this._finalAry=new Array;var b=a.aaa,f=new c;f.serverary=new Array,f.tabname="已有角色";for(var g=0;g<b.length;g++){var h=b[g],i=new c;i.serverary=new Array;for(var j=0;j<h.length;j++){var k=h[j],l=new d;l.id=k.id,l.isnew=k.isnew,l.name=k.name,l.state=k.state,l.curvo=k.curvo;var m=k.role;if(m){var n=new e;n.roleid=k.role.roleid,n.rolelev=k.role.rolelev,n.rolename=k.role.rolename,n.roletype=k.role.roletype,l.role=n,f.serverary.push(l)}l.curvo&&(this._currentVo=l,i.select=!0),i.serverary.push(l)}this._finalAry.push(i)}this._finalAry.unshift(f),console.log("---最终解析vo----",this._finalAry)}},a.prototype.ChgCurVo=function(a){this._currentVo=a},a.prototype.getCurVo=function(){if(this._currentVo)return this._currentVo;var a=this._finalAry[this._finalAry.length-1].serverary.length;return this._finalAry[this._finalAry.length-1].serverary[a-1]},a.prototype.getFinalList=function(){return this._finalAry?this._finalAry:void 0},a}();a.SelectServerModel=b;var c=function(){function a(){this.select=!1}return a}();a.ServerAryVo=c;var d=function(){function a(){}return a}();a.ServerVo=d;var e=function(){function a(){}return a}();a.RoleVo=e}(selectserver||(selectserver={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),selectserver;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.getModuleName=function(){return"SelectServerModule"},b.prototype.listProcessors=function(){return[new d]},b}(Module);a.SelectServerModule=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.SELECT_TAB_EVENT="SELECT_TAB_EVENT",b.SHOW_JOINGAME_EVENT="SHOW_JOINGAME_EVENT",b.HIDE_JOINGAME_EVENT="HIDE_JOINGAME_EVENT",b.OPEN_SELECTSERVER_EVENT="OPEN_SELECTSERVER_EVENT",b.HIDE_SELECTSERVER_EVENT="HIDE_SELECTSERVER_EVENT",b.OPEN_GG_EVENT="OPEN_GG_EVENT",b.HIDE_GG_EVENT="HIDE_GG_EVENT",b}(BaseEvent);a.SelectServerEvent=c;var d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return __extends(d,b),d.prototype.getName=function(){return"SelectServerProcessor"},d.prototype.receivedModuleEvent=function(a){if(a instanceof c){var b=a;b.type==c.OPEN_SELECTSERVER_EVENT?this.showUiss():b.type==c.HIDE_SELECTSERVER_EVENT?this.hideUiss():b.type==c.OPEN_GG_EVENT?this.showUigg():b.type==c.HIDE_GG_EVENT?this.hideUigg():b.type==c.SELECT_TAB_EVENT?this.selecttab(b.data):b.type==c.SHOW_JOINGAME_EVENT?this.showjoingameUi():b.type==c.HIDE_JOINGAME_EVENT&&this.hidejoingameUi()}if(a instanceof UIPanelEvent){var d=a;d.panel==this._selectServerUiPanel&&(this._selectServerUiPanel.dispose(),this._selectServerUiPanel=null,console.log("释放面板 _selectServerUiPanel")),d.panel==this._joinGameUiPanel&&(this._joinGameUiPanel.dispose(),this._joinGameUiPanel=null,console.log("释放面板 _joinGameUiPanel"))}},d.prototype.selecttab=function(a){this._selectServerUiPanel&&this._selectServerUiPanel.ssxuanfu&&this._selectServerUiPanel.ssxuanfu.hasStage&&this._selectServerUiPanel.ssxuanfu.refreshData(a)},d.prototype.hideUiss=function(){this._selectServerUiPanel&&(this._selectServerUiPanel.hidess(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)))},d.prototype.showUiss=function(){var b=this;this._selectServerUiPanel||(this._selectServerUiPanel=new a.SelectServerUiPanel),this._selectServerUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b._selectServerUiPanel.showss()})},d.prototype.hideUigg=function(){this._selectServerUiPanel&&(this._selectServerUiPanel.hidegg(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)))},d.prototype.showUigg=function(){var b=this;this._selectServerUiPanel||(this._selectServerUiPanel=new a.SelectServerUiPanel),this._selectServerUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b._selectServerUiPanel.showgg()})},d.prototype.hidejoingameUi=function(){this._joinGameUiPanel&&(this._joinGameUiPanel.hide(),ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.SHOW_MAINUI_EVENT)))},d.prototype.showjoingameUi=function(){var b=this;this._joinGameUiPanel||(this._joinGameUiPanel=new a.JoinGameUiPanel),this._joinGameUiPanel.load(function(){SceneManager.getInstance().render=!1,ModuleEventManager.dispatchEvent(new mainUi.MainUiEvent(mainUi.MainUiEvent.HIDE_MAINUI_EVENT)),b._joinGameUiPanel.show()})},d.prototype.listenModuleEvents=function(){return[new c(c.OPEN_SELECTSERVER_EVENT),new c(c.HIDE_SELECTSERVER_EVENT),new c(c.OPEN_GG_EVENT),new c(c.HIDE_GG_EVENT),new c(c.SELECT_TAB_EVENT),new c(c.SHOW_JOINGAME_EVENT),new c(c.HIDE_JOINGAME_EVENT),new UIPanelEvent(UIPanelEvent.DISPOSE_PANEL_EVENT)]},d}(BaseProcessor);a.SelectServerProcessor=d}(selectserver||(selectserver={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),selectserver;!function(a){var b=function(b){function c(){var a=b.call(this)||this;return a.width=UIData.designWidth,a.height=UIData.designHeight,a.center=0,a.middle=0,a._baImg=new UIBackImg,a._baImg.alpha=.5,a._baImg.setImgInfo("ui/load/001.jpg",1024,512),a.addRender(a._baImg),a._bgRender=new UIRenderComponent,a.addRender(a._bgRender),a._middleRender=new UIRenderComponent,a.addRender(a._middleRender),a._baseRender=new UIRenderComponent,a.addRender(a._baseRender),a._topRender=new UIRenderComponent,a.addRender(a._topRender),a._baseRender.uiAtlas=new UIAtlas,a}return __extends(c,b),c.prototype.dispose=function(){this._baImg.dispose(),this._baImg=null,this._bgRender.dispose(),this._bgRender=null,this._middleRender.dispose(),this._middleRender=null,this._baseRender.dispose(),this._baseRender=null,this._topRender.dispose(),this._topRender=null,this.ssgonggao&&(this.ssgonggao.dispose(),this.ssgonggao=null),this.ssxuanfu&&(this.ssxuanfu.dispose(),this.ssxuanfu=null)},c.prototype.applyLoad=function(){var a=this;this._baseRender.uiAtlas.setInfo("ui/uidata/selectserver/selectserver.xml","ui/uidata/selectserver/selectserver.png",function(){a.loadConfigCom()},"ui/uidata/selectserver/selectserverpc.png")},c.prototype.loadConfigCom=function(){var b=this;this._topRender.uiAtlas=this._baseRender.uiAtlas,this._bgRender.uiAtlas=this._baseRender.uiAtlas,this._middleRender.uiAtlas=this._baseRender.uiAtlas;var c=this._baseRender;this.addChild(this._topRender.getComponent("t_1"));var d=this.addChild(this._middleRender.getComponent("t_titlebg1"));d.isU=!0;var e=this.addChild(this._middleRender.getComponent("t_leftline1"));e.isU=!0;var f=this.addChild(this._middleRender.getComponent("t_angel1"));f.isU=!0;var g=this.addChild(c.getComponent("t_towel1"));g.isU=!0,this.addChild(this._bgRender.getComponent("t_leaf2_2")),this.addChild(this._bgRender.getComponent("t_leaf3_1")),this.addChild(this._bgRender.getComponent("t_bg")),this.addChild(this._middleRender.getComponent("t_titlebg")),this.addChild(this._middleRender.getComponent("t_leftline")),this.addChild(this._middleRender.getComponent("t_angel")),this.addChild(this._middleRender.getComponent("t_bottomline")),this.addChild(c.getComponent("t_towel")),this.addChild(this._topRender.getComponent("t_leaf2_1")),this.addChild(this._topRender.getComponent("t_leaf1_0")),this.addChild(this._topRender.getComponent("t_leaf2_0")),this.addChild(this._topRender.getComponent("t_leaf3_0")),this.t_but=this.addEvntButUp("t_but",this._topRender),this.resize(),LoadManager.getInstance().load("xuanfu.txt",LoadManager.XML_TYPE,function(c){var d=JSON.parse(c);a.SelectServerModel.getInstance().convertObj(d),b.applyLoadComplete()})},c.prototype.showgg=function(){UIManager.getInstance().addUIContainer(this),this.ssgonggao||(this.ssgonggao=new a.Ssgonggao,this.ssgonggao.initUiAtlas(this._baseRender.uiAtlas)),this.ssgonggao.show()},c.prototype.hidegg=function(){this.ssgonggao&&this.ssgonggao.hide(),UIManager.getInstance().removeUIContainer(this)},c.prototype.showss=function(){UIManager.getInstance().addUIContainer(this),this.ssxuanfu||(this.ssxuanfu=new a.Ssxuanfu,this.ssxuanfu.initUiAtlas(this._baseRender.uiAtlas)),this.ssxuanfu.show()},c.prototype.hidess=function(){this.ssxuanfu&&this.ssxuanfu.hide(),UIManager.getInstance().removeUIContainer(this)},c.prototype.resize=function(){b.prototype.resize.call(this)},c.prototype.butClik=function(b){switch(b.target){case this.t_but:this.ssxuanfu&&this.ssxuanfu.hasStage&&(this.hidess(),ModuleEventManager.dispatchEvent(new a.SelectServerEvent(a.SelectServerEvent.SHOW_JOINGAME_EVENT))),this.ssgonggao&&this.ssgonggao.hasStage&&this.hidegg()}},c}(UIPanel);a.SelectServerUiPanel=b}(selectserver||(selectserver={}));var ModuleList=function(){function a(){}return a.getModuleList=function(){var a=[new EngineModule,new SceneLoadModule,new mainUi.MainUiModule,new Chat.ChatModule,new Camand.CommandModule,new charbg.CharBgModule,new skillUi.SkillUiModule,new mountui.MountUiModule,new treasure.TreasureUiModule,new Hangup.HangupUiModel,new social.SocialUiModule,new copytask.CopytaskUiModule,new role.RoleUiModule,new ranking.RankingModule,new activity.ActivityModule,new store.StoreModule,new welfare.WelfareModule,new stronger.StrongerModule,new newbieguide.NewbieguideModule,new logingift.LogingiftModule,new training.TrainingModule,new divinesword.DivineswordModule,new stateup.StateUpModule,new LoginModule,new SceneModule,new fb.FubenModule,new reward.RewardModule,new strengthgem.StrengthGemModule,new faction.FactionModule,new boss.BossModule,new mapnew.MapNewModule,new minmap.MinMapModule,new selectserver.SelectServerModule,new quest.QuestModule,new kuafu.KuafuModule,new moneytree.MoneyTreeModule,new chgfish.ChgfishModule,new dialog.DialogueModule,new msgtip.MsgTipModule];return a.push(new wintittle.WindowRestTittleModule),a.push(new popbuy.PopBuyModule),a.push(new homeui.HomeUiModule),a.push(new fightui.FightUiModule),a.push(new topui.TopUiModule),a.push(new bottomui.BottomUiModule),a.push(new leftui.LeftUiModule),a.push(new rightui.RightUiModule),a.push(new hornui.HornUiModule),a.push(new faceui.FaceUiModule),a.push(new setingui.SetingUiModule),a.push(new shieldui.ShieldUiModule),a.push(new whisper.WhisperUiModule),a.push(new offlinereward.OfflineRewardModule),a.push(new adventuremap.AdventureMapModule),a.push(new adventureinfo.AdventureInfoModule),a.push(new adventuresettlement.AdventureSettlementModule),a.push(new adventurebang.AdventureBangModule),a.push(new adventurebossnotice.AdventureBossNoticeModule),a.push(new warehousetreasure.WarehouseTreasureModule),a.push(new duihuan.DuiHuanModule),a.push(new turnonwarehouse.TurnonWarehouseModule),a.push(new gift.GiftModule),a.push(new sboss.SbossModule),a.push(new wing.WingModule),a.push(new email.MailModule),a.push(new meridian.MeridianModule),a.push(new exterior.ExteriorModule),a.push(new kaifu.KaiFuModule),a},a.startup=function(){for(var b=a.getModuleList(),c=0;c<b.length;c++)Module.registerModule(b[c])},a}(),ModulePageManager=function(){function a(){}return a.showResTittle=function(a){var b=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.SHOW_WINDOW_RES_TITTLE_PANEL);b.data=a,ModuleEventManager.dispatchEvent(b)},a.hideResTittle=function(){var a=new wintittle.WindowRestTittleEvent(wintittle.WindowRestTittleEvent.HIDE_WINDOW_RES_TITTLE_PANEL);ModuleEventManager.dispatchEvent(a)},a.openNpcPanel=function(a,b,c){void 0===b&&(b=null),void 0===c&&(c=null);var d;switch(a){case SharedDef.MODULE_INSTANCE:d=new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.SHOW_COPYTASK_EVENT),d.data=b,d.seltab=c,ModuleEventManager.dispatchEvent(d);break;case SharedDef.MODULE_ARENA:d=new kuafu.KuaFuEvent(kuafu.KuaFuEvent.KUAFU_SHOW_ARENA_PANEL_EVENT),d.data=b,d.selTab=c,ModuleEventManager.dispatchEvent(d);break;default:console.log("没有记录",a,TimeUtil.getTimer())}},a.openPanel=function(a,b){void 0===b&&(b=null);var c;switch(console.log("--$tabid--",a,"---$data--",b),a){case SharedDef.MODULE_SETTING:c=new Hangup.HangupUiEvent(Hangup.HangupUiEvent.SHOW_HANGUPUI_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_BAG:c=new charbg.CharBgEvent(charbg.CharBgEvent.SHOW_CHAR_BG_PANEL),c.showType=1,c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_RONGLIAN:c=new charbg.CharBgEvent(charbg.CharBgEvent.SHOW_CHAR_BG_PANEL),c.showType=0,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_QUEST:break;case SharedDef.MODULE_MAIL:ModuleEventManager.dispatchEvent(new email.MailEvent(email.MailEvent.SHOW_MAIL_PANEL_EVENT));break;case SharedDef.MODULE_DAILY_TASKS:c=new quest.QuestEvent(quest.QuestEvent.SHOW_DAILY_QUEST_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_CHAT:c=new Chat.ChatEvent(Chat.ChatEvent.SHOW_CHAT_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_MAIL:break;case SharedDef.MODULE_MAP:break;case SharedDef.MODULE_STRENGTH:c=new stronger.StrongerEvent(stronger.StrongerEvent.SHOW_Stronger_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_CHATPERSON:c=new whisper.WhisperUiEvent(whisper.WhisperUiEvent.SHOW_WHISPER_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_ACTIVE:c=new activity.ActivityEvent(activity.ActivityEvent.SHOW_ACTIVITY_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_FISH:c=new chgfish.ChgfishEvent(chgfish.ChgfishEvent.SHOW_Chgfish_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_MONEYTREE:c=new moneytree.MoneyTreeEvent(moneytree.MoneyTreeEvent.SHOW_MoneyTree_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_REALM:c=new stateup.StateUpEvent(stateup.StateUpEvent.SHOW_STATEUP_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_ROLE:c=new role.RoleUiEvent(role.RoleUiEvent.SHOW_ROLE_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_SPELL:c=new skillUi.SkillUiEvent(skillUi.SkillUiEvent.SHOW_SKILLUI_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_DIVINE:c=new treasure.TreasureUiEvent(treasure.TreasureUiEvent.SHOW_TREASURE_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_FASHION:c=new exterior.ExteriorEvent(exterior.ExteriorEvent.SHOW_EXTERIOR_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_MOUNT:c=new mountui.MountUiEvent(mountui.MountUiEvent.SHOW_MOUNT_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_MIX:c=new strengthgem.StrengthGemEvent(strengthgem.StrengthGemEvent.SHOW_STRENGTHGEM_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_WING:c=new wing.WingEvent(wing.WingEvent.SHOW_WING_PANEL_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_TCM:c=new meridian.MeridianEvent(meridian.MeridianEvent.SHOW_MERIDIAN_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_GW:c=new divinesword.DivineswordEvent(divinesword.DivineswordEvent.SHOW_TRAINING_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_SOCIAL:c=new social.SocialUiEvent(social.SocialUiEvent.SHOW_SOCIAL_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_FACTION:c=new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONUI_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_RANK:c=new ranking.RankingEvent(ranking.RankingEvent.SHOW_RANKING_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_FACTIONMAIN:c=new faction.FactionBuildEvent(faction.FactionBuildEvent.SHOW_BUILD_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_FACTIONSKILL:c=new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONSKILL_PANEL_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_FACTIONACTIVE:c=new faction.FactionEvent(faction.FactionEvent.SHOW_FACTIONACTIVE_PANEL_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_FACTIONBOX:c=new warehousetreasure.WarehouseEvent(warehousetreasure.WarehouseEvent.SHOW_WAREHOUSE_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_MALL:c=new store.StoreEvent(store.StoreEvent.SHOW_Store_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_VIP:c=new charbg.CharBgEvent(charbg.CharBgEvent.SHOW_VIP_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_INSTANCE:c=new copytask.CopytaskUiEvent(copytask.CopytaskUiEvent.SHOW_COPYTASK_EVENT),c.seltab=b,c.data=null,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_TEST:c=new adventuremap.AdventureMapEvent(adventuremap.AdventureMapEvent.SHOW_ADVENTURE_MAP_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_ARENA:c=new kuafu.KuaFuEvent(kuafu.KuaFuEvent.KUAFU_SHOW_ARENA_PANEL_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_BOSS:c=new sboss.SbossEvent(sboss.SbossEvent.SHOW_SBOSS_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_EXP:c=new training.TrainingEvent(training.TrainingEvent.SHOW_TRAINING_PANEL),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_WELFARE:c=new welfare.WelfareEvent(welfare.WelfareEvent.SHOW_Welfare_EVENT),c.data=b,ModuleEventManager.dispatchEvent(c);break;case SharedDef.MODULE_OPENSERVICE:ModuleEventManager.dispatchEvent(new kaifu.KaiFuEvent(kaifu.KaiFuEvent.SHOW_KAIFU_PANEL_EVENT));break;case SharedDef.MODULE_FIRST_RECHARGE:break;default:console.log("没有记录",a,TimeUtil.getTimer())}},a}(),GameMouseManager=function(){function a(){this.ready=!1,this.resetPos=new Vector2D(150,380),this.bindPos=new Vector2D,this.useMouseEvent=!0,this.lastMouseEvetTime=0,this.nextSendTime=0,this.skipNum=0,this.isFristTouchMove=!0,this.yaoganIdentifier=-1,this.collectionType=0}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.setBtn=function(a,b){this.b_yaogan_bar=a,this.b_yaogan_bg=b,this.ready=!0},a.prototype.addMouseEvent=function(){var a=this;Scene_data.isPc?(document.addEventListener(MouseType.MouseDown,function(b){a.onMouse(b)}),document.addEventListener(MouseType.MouseUp,function(b){a.onMouse(b)}),document.addEventListener(MouseType.MouseMove,function(b){a.onMouse(b)}),document.addEventListener(MouseType.MouseWheel,function(b){a.onMouseWheel(b)})):(document.addEventListener(MouseType.TouchMove,function(b){a.onTouchMove(b)}),document.addEventListener(MouseType.TouchEnd,function(b){a.onTouchEnd(b)}),document.addEventListener(MouseType.TouchStart,function(b){a.onTouchStart(b)})),this.bindPos.x=this.resetPos.x,this.bindPos.y=this.resetPos.y,this.updataFun=function(b){a.updata(b);
}},a.prototype.onMouseWheel=function(a){AstarUtil.sceneVectList=null,Scene_data.gameAngle+=a.wheelDelta/100},a.prototype.isCanUseMouseEvent=function(){return this.useMouseEvent},a.prototype.onMouse=function(a){if(this.isCanUseMouseEvent()){var b,c=new Vector2D;a instanceof MouseEvent&&(a.type==MouseType.MouseDown?b=new InteractiveEvent(InteractiveEvent.Down):a.type==MouseType.MouseUp?b=new InteractiveEvent(InteractiveEvent.Up):a.type==MouseType.MouseMove?b=new InteractiveEvent(InteractiveEvent.Move):a.type==MouseType.MouseClick,c.x=a.pageX,c.y=a.pageY),this.makeMouseEvent(b,c)}},a.prototype.makeMouseEvent=function(a,b){this.lastMouseEvetTime=TimeUtil.getTimer();var c=UIManager.getInstance().mouseEvetData(a,b);if(a.type!=InteractiveEvent.Move){if(GuidData.map&&GuidData.map.is1V1())return void(this.lastMouseEvetTime<TimeUtil.getTimer()&&(msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"斗剑台不能操作",99),this.lastMouseEvetTime=TimeUtil.getTimer()+3e3));a.type==InteractiveEvent.Up&&this.canTestClikGroundMove&&!c&&this.isSkillAer(b)&&(AotuSkillManager.getInstance().aotuBattle=!1,AotuSkillManager.getInstance().aotuWalk=!1,AotuSkillManager.getInstance().timeoutAuto(),this.canTestClikGroundMove.x=b.x,this.canTestClikGroundMove.y=b.y,this.onSceneMouseDown(this.canTestClikGroundMove),this.canTestClikGroundMove=null),c||a.type!=InteractiveEvent.Down?this.canTestClikGroundMove=null:(a.x=b.x,a.y=b.y,this.canTestClikGroundMove=a)}},a.prototype.isSkillAer=function(a){var b;return b=document.body.clientWidth>document.body.clientHeight?new Vector2D(document.body.clientWidth,document.body.clientHeight):new Vector2D(0,document.body.clientHeight),Vector2D.distance(b,a)>250*UIData.Scale},a.prototype.mouseToEvent=function(a){var b,c=new Vector2D;return a.type==MouseType.TouchStart?b=new InteractiveEvent(InteractiveEvent.Down):a.type==MouseType.TouchEnd?(b=new InteractiveEvent(InteractiveEvent.Up),c.x=a.changedTouches[0].pageX,c.y=a.changedTouches[0].pageY):a.type==MouseType.TouchMove&&(b=new InteractiveEvent(InteractiveEvent.Move)),a.touches.length&&(c.x=a.touches[a.touches.length-1].clientX,c.y=a.touches[a.touches.length-1].clientY),this.makeMouseEvent(b,c),b},a.prototype.cantClikGround=function(a){if(GameInstance.useYaoGan)return!1;if(!GameInstance.mainChar)return!1;if(!SceneManager.getInstance().render)return!1;if(GameInstance.mainChar.isDeath)return!1;if(GuidData.map.is1V1())return this.lastMouseEvetTime<TimeUtil.getTimer()&&(msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"斗剑台不能操作",99),this.lastMouseEvetTime=TimeUtil.getTimer()+3e3),!1;new Vector2D(a.x/UIData.Scale,a.y/UIData.Scale),Vector2D.distance(a,this.bindPos);return!0},a.prototype.inYaoganButRound=function(a,b){if(void 0===b&&(b=100),Scene_data.isPc&&!this.ready&&!SceneManager.getInstance().ready)return!1;var c=new Vector2D;Scene_data.verticalScene?(c.x=a.y/UIData.Scale,c.y=(Scene_data.stageHeight-a.x)/UIData.Scale):(c.x=a.x/UIData.Scale,c.y=a.y/UIData.Scale),c.x=a.x/UIData.Scale,c.y=a.y/UIData.Scale;var d=Vector2D.distance(c,new Vector2D(0,Scene_data.stageHeight/UIData.Scale));return 300>d?!0:!1},a.prototype.onSceneMouseDown=function(a){if(!this.ready||!this.inYaoganButRound(a)){var b=new Vector2D;if(Scene_data.verticalScene?(b.x=a.y,b.y=Scene_data.stageHeight-a.x):(b.x=a.x,b.y=a.y),this.cantClikGround(b)&&GuidData.player){GameInstance.questMoveVo&&(GameInstance.questMoveVo=null);var c=(GuidData.player.getUnitFieldNotoriety(),this.findHitChat(new Vector2D(a.x,a.y)));if(c&&!c.isDeath){if(c.unit.isPlayer()&&(RelationManager.getInstance().inAttackItemByChar(c)?(GameInstance.attackTarget=c,console.log("选人为攻击对象")):console.log("不在攻击队列中")),c.unit.isMonster()&&(GameInstance.attackTarget=c),c.unit.getTypeID()==SharedDef.TYPEID_GAMEOBJECT&&c instanceof ScenePortal){var d=c;0==d.tb.judge&&(quest.QuestModel.getInstance().use_gameobject(c),console.log("采集对象"))}c.unit.isNpc()&&this.talk_with_npc(c.unit.getEntry())}else GameInstance.attackTarget&&(GameInstance.attackTarget.unit.isPlayer()||(GameInstance.attackTarget=null)),AotuSkillManager.getInstance().aotuBattle||(this.lastMousePos=b,GameInstance.mainChar.isSinging&&GameInstance.mainChar.skillVo.tbSkillId&&0==tb.TB_skill_base.get_TB_skill_base(GameInstance.mainChar.skillVo.tbSkillId).can_move&&GameInstance.mainChar.msgSpellStop(),this.findMoveTo())}}},a.prototype.talk_with_npc=function(a){var b=new dialog.DialogueEvent(dialog.DialogueEvent.SHOW_DIALOGUE_PANEL);b.entryId=a,ModuleEventManager.dispatchEvent(b)},a.prototype.findMoveTo=function(){var a=this;if(this.lastMousePos){GameInstance.mainChar;MainCharControlModel.getInstance().isWalkOrStand()?(this.sendWalkToPos(this.lastMousePos),this.lastMousePos=null):TimeUtil.addTimeOut(100,function(){a.findMoveTo()}),bottomui.Progress_line.getInstance()&&bottomui.Progress_line.getInstance().hide()}},a.prototype.findHitChat=function(a){var b=new Vector2D;Scene_data.verticalScene?(b.x=a.y,b.y=Scene_data.stageHeight-a.x):(b.x=a.x,b.y=a.y);var c=AstarUtil.getScenePos(b.x,b.y);if(c){var d=new Vector3D;d.x=Scene_data.cam3D.x,d.y=Scene_data.cam3D.y,d.z=Scene_data.cam3D.z;for(var e=0;e<GameInstance.roleList.length;e++){var f=GameInstance.roleList[e];if(f.mouseClik(d,c)&&!f.unit.isMain&&f.visible)return console.log(f.unit.getName()),f}}return null},a.prototype.sendWalkToPos=function(b){var c=AstarUtil.getScenePos(b.x,b.y);if(c){var d=AstarUtil.getGrapIndexByPos(c);if(AstarUtil.getJumpDataByV2d(d.x,d.y)&&(c=this.findNearJumpCharPos(),!c))return;var e=AstarUtil.findPath3D(GameInstance.mainChar.getCurrentPos(),c);e&&MainCharControlModel.getInstance().setWalkPathFun(e,function(){a.getInstance().walkPathComplete()})}},a.prototype.findNearJumpCharPos=function(){for(var a,b=GameInstance.roleList,c=0;c<b.length;c++)if(b[c]instanceof ScenePortal){var d=b[c];4==d.tb.judge&&(a=d)}return a?a.getCurrentPos():null},a.prototype.onTouchStart=function(a){this.isCanUseMouseEvent()&&this.mouseToEvent(a)},a.prototype.onTouchEnd=function(b){if(this.isCanUseMouseEvent()){if(GameInstance.useYaoGan){for(var c=!1,d=0;d<b.touches.length;d++)b.touches[d].identifier==this.yaoganIdentifier&&(c=!0);c||(this.bindPos.x=this.resetPos.x,this.bindPos.y=this.resetPos.y,TimeUtil.removeFrameTick(this.updataFun),this.canTestClikGroundMove=null,GameInstance.useYaoGan=!1,this.setBasePostion(),GameInstance.mainChar.stopMove(),a.getInstance().walkPathComplete(),this.yaoganIdentifier=-1,AotuSkillManager.getInstance().timeoutAuto())}this.mouseToEvent(b)}},a.prototype.setBasePostion=function(){this.b_yaogan_bar.x=this.bindPos.x-this.b_yaogan_bar.width/2,this.b_yaogan_bar.y=this.bindPos.y-this.b_yaogan_bar.height/2,console.log(this.b_yaogan_bar.y),this.b_yaogan_bg.x=this.bindPos.x-this.b_yaogan_bg.width/2,this.b_yaogan_bg.y=this.bindPos.y-this.b_yaogan_bg.height/2},a.prototype.onTouchMove=function(a){if(this.isCanUseMouseEvent()&&this.b_yaogan_bar&&SceneManager.getInstance().ready){var b=this.mouseToEvent(a);if(GameInstance.useYaoGan){this.isFristTouchMove=!1;for(var c,d=0;d<a.touches.length;d++)if(a.touches[d].identifier==this.yaoganIdentifier){var e=this.getMouseDownPos(a.touches[d]);c?Vector2D.distance(c,this.bindPos)>Vector2D.distance(e,this.bindPos)&&(c=e):c=e}this.changeBingPostion(new Vector2D(c.x,c.y))}else if(this.canTestClikGroundMove||this.inYaoganButRound(b)){if(GuidData.map.is1V1())return void(this.lastMouseEvetTime<TimeUtil.getTimer()&&(msgtip.MsgTipManager.outStr(ColorType.colorce0a00+"斗剑台不能操作",99),this.lastMouseEvetTime=TimeUtil.getTimer()+3e3));this.beginYaogan(a),this.isFristTouchMove=!0}}},a.prototype.changeBingPostion=function(a){var b=Vector2D.distance(a,this.bindPos);if(b>50){var c=new Vector2D(this.bindPos.x-a.x,this.bindPos.y-a.y);c.normalize(),c.scaleBy(50),this.bindPos.x=a.x+c.x,this.bindPos.y=a.y+c.y}var d=this.b_yaogan_bg.parent,e=new Vector2D(a.x-this.bindPos.x,a.y-this.bindPos.y);e.normalize(),this.b_yaogan_bar.x=this.bindPos.x-this.b_yaogan_bar.width/2+20*e.x,this.b_yaogan_bar.y=this.bindPos.y-this.b_yaogan_bar.height/2+20*e.y-d.y,this.b_yaogan_bg.x=this.bindPos.x-this.b_yaogan_bg.width/2,this.b_yaogan_bg.y=this.bindPos.y-this.b_yaogan_bg.height/2-d.y;var f=30,g=180*Math.atan2(e.y,e.x)/Math.PI;if(this._lastV2dNrm){var h=180*Math.atan2(this._lastV2dNrm.y,this._lastV2dNrm.x)/Math.PI;if(Math.abs(g-h)<f)return}this._lastV2dNrm=new Vector2D(e.x,e.y);var i=new Matrix3D;i.appendRotation(-Scene_data.focus3D.rotationY,Vector3D.Y_AXIS),this._speedDirect=i.transformVector(new Vector3D(e.x,0,-e.y)),this.changeMainChar()},a.prototype.changeMainChar=function(){this.isCanChangeRole?(MainCharControlModel.getInstance().setSpeedDirect(this._speedDirect),this.sendYaoGanPath()):TimeUtil.addTimeOut(100,function(){})},a.prototype.sendYaoGanPath=function(){if(this.isCanChangeRole&&(AotuSkillManager.getInstance().aotuBattle&&(AotuSkillManager.getInstance().aotuBattle=!1),AotuSkillManager.getInstance().aotuWalk&&(AotuSkillManager.getInstance().aotuWalk=!1),this._speedDirect&&!GameInstance.mainChar.isDeath)){if(!MainCharControlModel.getInstance().isWalk())return;var a=GameInstance.mainChar.getCurrentPos();a.x=a.x+20*this._speedDirect.x,a.z=a.z+20*this._speedDirect.z,a=AstarUtil.findNearLinePoint(GameInstance.mainChar.getCurrentPos(),a);var b=GameInstance.mainChar.getAstarPos(),c=AstarUtil.getGrapIndexByPos(a);this.nextSendTime=TimeUtil.getTimer()+300,GameInstance.useYaoGan||(this._speedDirect=null),b.x==c.x&&b.y==c.y||(GameInstance.questMoveVo=null,AstarUtil.isGridCanWalk(b)?AstarUtil.isGridCanWalk(c)?MainCharControlModel.getInstance().sendPath([b,c]):MainCharControlModel.getInstance().sendPath([b,b]):AstarUtil.isGridCanWalk(c)?MainCharControlModel.getInstance().sendPath([c,c]):console.log("移动的两个位置都不可移动。需要优化"))}},a.prototype.getNearFiledRoad=function(){var a=GameInstance.mainChar.getAstarPos(),b=a.x,c=a.y,d=new Array;d.push(new Vector2D(b-1,c-1)),d.push(new Vector2D(b,c-1)),d.push(new Vector2D(b+1,c-1)),d.push(new Vector2D(b-1,c)),d.push(new Vector2D(b,c)),d.push(new Vector2D(b+1,c)),d.push(new Vector2D(b-1,c+1)),d.push(new Vector2D(b,c+1)),d.push(new Vector2D(b+1,c+1));for(var e="",f=0;f<d.length;f++)e+=AstarUtil.isGridCanWalk(d[f])?"1,":"0,",f%3==2&&(e+="\n");console.log(e),console.log("-----------------------------")},Object.defineProperty(a.prototype,"isCanChangeRole",{get:function(){if(JumpModel.isTestJumpNow())return!1;var a=GameInstance.mainChar.curentAction;return GameInstance.mainChar.isSinging||a==CharAction.WALK||a==CharAction.STANAD||a==CharAction.STAND_MOUNT||a==CharAction.WALK_MOUNT?!0:!1},enumerable:!0,configurable:!0}),a.prototype.beginYaogan=function(a){for(var b=0;b<a.touches.length;b++){var c=this.getMouseDownPos(a.touches[b]);c.x<Scene_data.stageWidth/4&&(GameInstance.useYaoGan||(this.bindPos.x=c.x,this.bindPos.y=c.y,TimeUtil.addFrameTick(this.updataFun),GameInstance.useYaoGan=!0,FpsMc.tipStr=String(a.touches[b].identifier),this.yaoganIdentifier=a.touches[b].identifier))}},a.prototype.updata=function(a){TimeUtil.getTimer()>this.nextSendTime&&this.isCanChangeRole&&!this.isFristTouchMove&&GameInstance.mainChar&&(GameInstance.mainChar.curentAction==CharAction.STANAD&&this.changeMainChar(),this.sendYaoGanPath())},a.prototype.getMouseDownPos=function(a){var b=new Vector2D;return Scene_data.verticalScene?(b.x=a.pageY/UIData.Scale,b.y=(Scene_data.stageHeight-a.pageX)/UIData.Scale):(b.x=a.pageX/UIData.Scale,b.y=a.pageY/UIData.Scale),b.y+=Scene_data.stageHeight/UIData.Scale-540,b},a.prototype.walkPathComplete=function(){var a=GameInstance.roleList;this.collectionType=0;for(var b=0;a&&b<a.length;b++){var c=a[b];if(c.unit)if(c.unit.getTypeID()==SharedDef.TYPEID_GAMEOBJECT){if(this.teleportToScene(c))break}else if(c.unit.isNpc()&&GameInstance.mainChar.math_distance(c)<80){this.collectionType=1;break}}GameInstance.attackTarget&&GameInstance.attackTarget.unit.isPlayer()&&(GameInstance.attackTarget=null)},a.prototype.isCatchSceneCharDis=function(a){if(a.unit.getTypeID()==SharedDef.TYPEID_GAMEOBJECT){var b=tb.TB_gameobject_template.get_TB_gameobject_template(a.unit.getEntry()),c=GameInstance.mainChar.getAstarPos(),d=a.getAstarPos();if(c&&d&&Math.abs(c.x-d.x)<b.trigger_width&&Math.abs(c.y-d.y)<b.trigger_height)return!0}return!1},a.prototype.isCatchSceneLoot=function(a){var b=a.getOwnderGuid();if(""==b||b==GameInstance.mainChar.unit.getPlayerGUID()){var c=GameInstance.mainChar.getAstarPos(),d=a.getAstarPos();if(c&&d&&Math.abs(c.x-d.x)<=1&&Math.abs(c.y-d.y)<=1)return!0}return!1},a.prototype.teleportToScene=function(a){if(a instanceof SceneCollection)return!1;if(this.isCatchSceneCharDis(a)){var b=tb.TB_gameobject_template.get_TB_gameobject_template(a.unit.getEntry());return 6==b.id?(NetManager.getInstance().protocolos.teleport(a.unit.uintGuid),this.collectionType=0):this.collectionType=b.style,!0}return!1},a}(),GameStart=function(){function a(){this.dataReady=!1,this.uiReadyNum=0,this.uiAllNum=0}return a.prototype.init=function(){var b=this,c=new Array;c.push({xmlurl:"ui/arpgui/textlist.xml",picurl:"ui/arpgui/textlist.png",name:UIData.textlist}),c.push({xmlurl:"ui/uidata/public/public.xml",picurl:"ui/uidata/public/public.png",name:UIData.publicUi}),this.uiAllNum=UIData.init(c,function(){b.loadAll()},function(a){b.uiReadyNum=a,b.dataReady&&FpsStage.getInstance().showLoadInfo("读取UI数据："+b.uiReadyNum+"/"+b.uiAllNum)}),a.outNet?TableData.getInstance().loadZipGameData(function(){b.dataReady=!0,b.loadAll()},function(a){FpsStage.getInstance().showLoadInfo("读取游戏数据"+float2int(100*a)+"%")}):TableData.getInstance().loadGameData(function(){b.dataReady=!0,b.loadAll()},function(a){FpsStage.getInstance().showLoadInfo("读取游戏数据"+float2int(100*a)+"%")}),this.loadDataComplet(),GameMouseManager.getInstance().addMouseEvent()},a.prototype.loadAll=function(){this.uiReadyNum==this.uiAllNum&&this.dataReady&&(FpsStage.getInstance().showLoadInfo("正在连接服务器"),a.ready=!0,RedPointManager.getInstance().init(),ModuleEventManager.dispatchEvent(new LoginEvent(LoginEvent.LOGIN_ENTER_EVENT)))},a.prototype.loadDataComplet=function(){a.outNet,ModuleList.startup(),GameData.needCreatChar=!1,GameInstance.init()},a.outNet=!1,a.GM=!0,a.ready=!1,a.appVersion=0,a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),scene2d;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.applyWalk=function(b){if(b&&2==b.length&&b[0].x==b[1].x&&b[0].y==b[1].y){console.log("收到寻路坐标是在原地==>",b),this._speedDirect=null,this._walkPath=null,this.curentAction==CharAction.WALK&&this.play(CharAction.STANAD);var c=AstarUtil.getWorldPosByStart2D(b[0]);return this.px=c.x,void(this.pz=c.z)}this.walkPath=a.SceneAstarModel.getInstance().Path2dTo3d(b)},c.prototype.refreshY=function(){this.py=0,this.refreshPos()},Object.defineProperty(c.prototype,"isDeath",{get:function(){return!1},enumerable:!0,configurable:!0}),c.prototype.updateFrame=function(a){b.prototype.updateFrame.call(this,a),this._speedDirect&&this.walkDirect(a)},c.prototype.walkDirect=function(b){var c=Math.min(Math.max(1e3/60,b),30),d=c*this.speedTX,e=new Vector3D,f=this._speedDirect.x*d,g=this._speedDirect.z*d;this.toRotationY=180*-Math.atan2(g,f)/Math.PI+90,e.x=this.px+f,e.z=this.pz+g,console.log(a.SceneAstarModel.getPosIsCanMove(e)),a.SceneAstarModel.getPosIsCanMove(e)&&(this.px=e.x,this.pz=e.z),this.refreshPos()},c.prototype.showName=function(a){void 0===a&&(a=null);var b=a;this._charNameVo?this._charNameVo.name=b:this._charNameVo=BloodManager.getInstance().getCharNameMeshVo(b),this.refreshPos()},c.prototype.showBlood=function(a){void 0===a&&(a=0),this._charBloodVo?this._charBloodVo.colortype=a:(this._charBloodVo=BloodManager.getInstance().getBloodLineMeshVo(),this._charBloodVo.colortype=a),this.refreshPos()},c.prototype.changeAction=function(a){this.curentAction=this._defaultAction},c}(SceneChar);a.Scene2dChar=b}(scene2d||(scene2d={}));var scene2d;!function(a){var b=function(){function b(){}return b.init=function(){var c=this;b.htmlScale=1,a.MapConfig.Scale=2*b.htmlScale,a.SceneGroundModel.configSize=256,SceneManager._instance=new a.Scene2dManager,Scene_data.focus3D.x=0,Scene_data.focus3D.y=0,Scene_data.focus3D.z=0,Scene_data.focus3D.rotationY=0,Scene_data.focus3D.rotationX=-45,Scene_data.cam3D.distance=250,this.resetViewMatrx3D(),MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D),a.AppDataArpg.refrishPos(a.AppDataArpg.sceneStagePos),Engine.resetViewMatrx3D=function(){c.resetViewMatrx3D()}},b.resetViewMatrx3D=function(){Scene_data.viewMatrx3D?Scene_data.viewMatrx3D.identity():Scene_data.viewMatrx3D=new Matrix3D;var a=Scene_data.stageWidth,c=Scene_data.stageHeight;Scene_data.sceneViewHW=Math.max(a,c),Scene_data.viewMatrx3D.appendScale(1/Scene_data.sceneViewHW*2,1/Scene_data.sceneViewHW*2,.001),Scene_data.viewMatrx3D.appendScale(1*(Scene_data.sceneViewHW/a*2),a/c*(Scene_data.sceneViewHW/a*2),1),Scene_data.viewMatrx3D.appendScale(2*b.htmlScale,2*b.htmlScale,1)},b.update=function(){Engine.update(),a.AppDataArpg.lockMainChar&&a.AppDataArpg.resetSelfPosCenter()},b.resetSize=function(){Engine.resetSize()},b.htmlScale=1,b}();a.Engine2d=b}(scene2d||(scene2d={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),scene2d;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.update=function(){this.test||(Scene_data.context3D.update(),Scene_data.context3D.setDepthTest(!1),UIManager.getInstance().upBgGroundZero(),Scene_data.context3D.setDepthTest(!0),this.updateMovieFrame(),MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D),SceneManager.getInstance().ready&&(ParticleManager.getInstance().updateTime(),SkillManager.getInstance().update(),this.render&&(this.updateStaticDiplay(),this.updateSpriteDisplay(),Scene_data.context3D.setWriteDepth(!0),this.updateMovieDisplay(),ShadowManager.getInstance().update(),Scene_data.context3D.setWriteDepth(!1),ParticleManager.getInstance().update(),BloodManager.getInstance().update())),Scene_data.context3D.setDepthTest(!1),UIManager.getInstance().update())},b}(SceneManager);a.Scene2dManager=b}(scene2d||(scene2d={}));var scene2d;!function(a){var b=function(){function b(){}return b.math3dto2Darpg=function(b){var c=Scene_data.vpMatrix.transformVector(b),d=Scene_data.stageWidth/4/a.Engine2d.htmlScale,e=Scene_data.stageHeight/4/a.Engine2d.htmlScale,f=d+c.x*d,g=e-c.y*e;return new Vector2D(f,g)},b.getScene2DBy3Dpostion=function(a){var c=this.math3dto2Darpg(a);return c.x-=b.sceneStagePos.x,c.y-=b.sceneStagePos.y,c},b.math2Dto3DGroundarpg=function(a){this._vpMatrixInver=Scene_data.vpMatrix.clone(),this._vpMatrixInver.invert();var b=this.math2dto3Darpg(a,100),c=this.math2dto3Darpg(a,200);return this.triItem||(this.triItem=new Array,this.triItem.push(new Vector3D(0,0,0)),this.triItem.push(new Vector3D(-100,0,100)),this.triItem.push(new Vector3D(100,0,100))),MathUtil.getLinePlaneInterectPointByTri(b,c,this.triItem)},b.math2dto3Darpg=function(a,b){void 0===b&&(b=100);var c=Scene_data.stageWidth/4,d=Scene_data.stageHeight/4,e=a.x,f=a.y,g=new Vector3D;return g.y=(d-f)/d,g.x=(e-c)/c,g.z=b,g=this._vpMatrixInver.transformVector(g)},b.refrishPos=function(c){b.sceneStagePos.x=c.x,b.sceneStagePos.y=c.y,Scene_data.focus3D.x=-b.sceneStagePos.x/2,Scene_data.focus3D.z=b.sceneStagePos.y/2/Math.sin(45*Math.PI/180),a.SceneGroundModel.getInstance().resetViewMatrx3D()},b.resetSelfPosCenter=function(){if(GameInstance.mainChar){var b=this.getScene2DBy3Dpostion(new Vector3D(GameInstance.mainChar.x,0,GameInstance.mainChar.z)),c=Scene_data.stageWidth/4/a.Engine2d.htmlScale,d=Scene_data.stageHeight/4/a.Engine2d.htmlScale,e=new Vector2D(c-b.x,d-b.y);this.refrishPos(e)}},b.sceneStagePos=new Vector2D,b.lockMainChar=!0,b}();a.AppDataArpg=b}(scene2d||(scene2d={}));var scene2d;!function(a){var b=function(){function a(){this._singSeparate=",",this.dateStr="",this.thumbScale=1,this.pxWidth=0,this.pxHeight=0,this.row=0,this.column=0,this.tileWidth=48,this.tileHeight=24,this.mapType=0,this.teleports=new Array,this.reborns=new Array,this.gameobjects=new Array,this.collects=new Array,this.obstacleMask=new UpdateMask}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.anlyData=function(b){this.obstacleMask=new UpdateMask;var g=b.split("\n"),h=g[0].split(this._singSeparate);this.id=parseInt(h[0]),this.name=h[1],this.dateStr=h[2],this.pxWidth=Number(h[3]),this.pxHeight=Number(h[4]),this.sliceWidth=Number(h[5])||512,this.sliceHeight=Number(h[6])||512,this.column=Number(h[7]),this.row=Number(h[8]),this.tileWidth=Number(h[14])||48,this.tileHeight=Number(h[15])||24,this.tileWidth=24,this.tileHeight=24,a.pix15.x=this.tileWidth,a.pix15.y=this.tileHeight;var i,j=g[1].split(this._singSeparate),k=j.length;for(i=0;k>i;i++)this.obstacleMask.baseByteArray.writeUnsignedInt(Number(j[i]));var l=g[10].split(this._singSeparate);for(i=0,k=l.length;k>i;)this.gameobjects.push(new e(l[i++],l[i++],l[i++],l[i++],l[i++],l[i++]));var m=g[11].split(this._singSeparate);for(i=0,k=m.length,i=0;k>i;)this.teleports.push(new c(l[i++],l[i++],l[i++],l[i++],l[i++],l[i++],l[i++]));var n=g[12].split(this._singSeparate);for(i=0,k=n.length,i=0;k>i;)this.reborns.push(new d(l[i++],l[i++],l[i++],l[i++]));var o=new Array;if(g[13])var o=g[13].split(this._singSeparate);for(i=0,k=o.length,i=0;k>i;)this.collects.push(new f(l[i++],l[i++],l[i++],l[i++]));this.makeAstarItem()},a.prototype.makeAstarItem=function(){this.astarItem=new Array;for(var a=0;a<this.row;a++){for(var b=new Array,c=0;c<this.column;c++)b.push(this.isBlock(c,a)?0:1);this.astarItem.push(b)}},a.prototype.isBlock=function(a,b){return 0>a||a>=this.column||0>b||b>=this.row?!0:this.obstacleMask.GetBit(this.column*b+a)},a.pix15=new Vector2D(24,24),a.Scale=1,a}();a.MapConfig=b;var c=function(){function a(a,b,c,d,e,f,g){this.px=parseInt(a),this.py=parseInt(b),this.name=c,this.tmapId=parseInt(d),this.tx=parseInt(e),this.ty=parseInt(f),this.modelId=g}return a}(),d=function(){function a(a,b,c,d){this.mapId=parseInt(a),this.px=parseInt(b),this.py=parseInt(c),this.zhenying=parseInt(d)}return a}(),e=function(){function a(a,b,c,d,e,f){this.modelId=a,this.px=parseInt(b),this.py=parseInt(c),this.moveType=parseInt(d),this.dir=parseInt(e),this.script=f}return a}(),f=function(){function a(a,b,c,d){this.modelId=a,this.px=parseInt(b),this.py=parseInt(c)}return a}()}(scene2d||(scene2d={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),scene2d;!function(a){var b=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a._showOrHide=!1,a.lastMouseDownTm=0,a}return __extends(c,b),c.getInstance=function(){return this._instance||(this._instance=new c),this._instance},c.prototype.showAstarLine=function(){if(this._astarLineSprite||(ProgrmaManager.getInstance().registe(LineDisplayShader.LineShader,new LineDisplayShader),this._astarLineSprite=new MulLineSprite),this._showOrHide=!this._showOrHide,this._showOrHide){MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D),SceneManager.getInstance().addDisplay(this._astarLineSprite),this.drawTemp(a.MapConfig.getInstance().astarItem);var b=this.getWorldPosByStart2D(new Vector2D);this._astarLineSprite.x=b.x,this._astarLineSprite.z=b.z}else this.clearAstarLine()},c.prototype.getWorldPosByStart2D=function(b){var c=new Vector2D;c.x=a.AppDataArpg.sceneStagePos.x+b.x*a.MapConfig.pix15.x,c.y=a.AppDataArpg.sceneStagePos.y+b.y*a.MapConfig.pix15.y,c.x*=a.Engine2d.htmlScale,c.y*=a.Engine2d.htmlScale;var d=a.AppDataArpg.math2Dto3DGroundarpg(c);return d},c.prototype.clearAstarLine=function(){this._astarLineSprite.clear(),this._astarLineSprite.upToGpu()},c.prototype.mouseDownFindLoad=function(a){this.lastMouseDownTm=TimeUtil.getTimer()},c.prototype.mouseMoveFindLoad=function(a){this.lastMouseDownTm=0},c.prototype.mouseUpFindLoad=function(b){if(GameInstance.mainChar&&TimeUtil.getTimer()-this.lastMouseDownTm<200){var d=this.findHitChat(new Vector2D(b.x,b.y));if(GameInstance.attackTarget=d,d)a.AppDataArpg.lockMainChar=!0;else{var e=c.getAstarBySceneV3D(new Vector3D(GameInstance.mainChar.x,0,GameInstance.mainChar.z)),f=this.getAstarSceneByMouse(b),g=AstarUtil.findPath2D(e,f);g&&g.length&&MainCharControlModel.getInstance().setWalkPathFun(g)}}},c.prototype.findHitChat=function(a){return null},c.getPosIsCanMove=function(b){if(!a.MapConfig.getInstance().astarItem)return console.log("寻路这时是不可的a"),!1;var c=this.getAstarBySceneV3D(b);return!a.MapConfig.getInstance().isBlock(c.x,c.y)},c.prototype.getAstarSceneByMouse=function(b){var c=new Vector2D;return c.x=b.x/a.MapConfig.Scale-a.AppDataArpg.sceneStagePos.x,c.y=b.y/a.MapConfig.Scale-a.AppDataArpg.sceneStagePos.y,c.x=Math.round(c.x/a.MapConfig.pix15.x),c.y=Math.round(c.y/a.MapConfig.pix15.y),c},c.getAstarBySceneV3D=function(b){var c=a.AppDataArpg.getScene2DBy3Dpostion(b);return c.x=Math.round(c.x/a.MapConfig.pix15.x),c.y=Math.round(c.y/a.MapConfig.pix15.y),c},c.prototype.drawTemp=function(b){this._astarLineSprite.clear(),this._astarLineSprite.baseColor=new Vector3D(.6,.6,.6,1);for(var c=(b[0].length,b.length,a.MapConfig.pix15.x/a.MapConfig.Scale*a.Engine2d.htmlScale),d=a.MapConfig.pix15.y/a.MapConfig.Scale*a.Engine2d.htmlScale,e=1/Math.sin(45*Math.PI/180),f=0;f<b.length;f++)for(var g=0;g<b[f].length;g++)if(1==b[f][g]){var h=new Vector3D(g*c,0,-f*d);h.z=h.z*e;var i=new Vector3D(h.x,h.y,h.z),j=new Vector3D(h.x+c,h.y,h.z),k=new Vector3D(h.x+c,h.y,h.z-d*e),l=new Vector3D(h.x,h.y,h.z-d*e);this._astarLineSprite.makeLineMode(i,j),this._astarLineSprite.makeLineMode(i,l),b[f+1]&&1!=b[f+1][g]&&this._astarLineSprite.makeLineMode(k,l),b[f][g+1]&&1!=b[f][g+1]&&this._astarLineSprite.makeLineMode(j,k)}this._astarLineSprite.upToGpu()},c.prototype.Path2dTo3d=function(a){for(var b=new Array,c=0;c<a.length;c++)b.push(this.getWorldPosByStart2D(a[c]));return b},c}(UIPanel);a.SceneAstarModel=b}(scene2d||(scene2d={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),YaoGanModelPanel=function(a){function b(){var b=a.call(this)||this;return b.isMouseDown=!1,b.bindPos=new Vector2D,b.interfaceUI=!0,b.width=UIData.designWidth,b.height=UIData.designHeight,b.bottom=0,b.left=0,b._bottomRender=new UIRenderComponent,b.addRender(b._bottomRender),b._midRender=new UIRenderComponent,b.addRender(b._midRender),b.hasStage||UIManager.getInstance().addUIContainer(b),b.configuiAtlas(),b}return __extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.initData=function(a){void 0===a&&(a=null),this.yaoganFunction=a},b.prototype.addMouseEvent=function(){var a=this;Scene_data.isPc&&(document.addEventListener(MouseType.MouseDown,function(b){a.onMouse(b)}),document.addEventListener(MouseType.MouseUp,function(b){a.onMouse(b)}),document.addEventListener(MouseType.MouseMove,function(b){a.onMouse(b)}),this.b_yaogan_bg.addEventListener(InteractiveEvent.Down,this.butClik,this),Scene_data.uiBlankStage.addEventListener(InteractiveEvent.Move,this.onStageMouseMove,this),this.baseBindPos=new Vector2D(this.b_yaogan_bg.x+this.b_yaogan_bg.width/2,this.b_yaogan_bg.y+this.b_yaogan_bg.height/2))},b.prototype.setBasePostion=function(){this.b_yaogan_bar.x=this.baseBindPos.x-this.b_yaogan_bar.width/2,this.b_yaogan_bar.y=this.baseBindPos.y-this.b_yaogan_bar.height/2,this.b_yaogan_bg.x=this.baseBindPos.x-this.b_yaogan_bg.width/2,this.b_yaogan_bg.y=this.baseBindPos.y-this.b_yaogan_bg.height/2;var a=GameInstance.mainChar;a&&a._speedDirect&&MainCharControlModel.getInstance().sendStop()},b.prototype.onMouse=function(a){a.type&&(a.type==MouseType.MouseDown||(a.type==MouseType.MouseUp?(this.isMouseDown=!1,this.setBasePostion()):a.type==MouseType.MouseMove))},b.prototype.onStageMouseMove=function(a){if(this.isMouseDown){var b=new Vector2D;b.x=a.x/UIData.Scale-this.x/UIData.Scale,b.y=a.y/UIData.Scale-this.y/UIData.Scale,this.changeBingPostion(b)}},b.prototype.changeBingPostion=function(a){var b=Vector2D.distance(a,this.bindPos);if(b>50){var c=new Vector2D(this.bindPos.x-a.x,this.bindPos.y-a.y);c.normalize(),c.scaleBy(50),this.bindPos.x=a.x+c.x,this.bindPos.y=a.y+c.y}var d=(this.b_yaogan_bg.parent,new Vector2D(a.x-this.bindPos.x,a.y-this.bindPos.y));d.normalize(),this.b_yaogan_bar.x=this.bindPos.x-this.b_yaogan_bar.width/2+20*d.x,this.b_yaogan_bar.y=this.bindPos.y-this.b_yaogan_bar.height/2+20*d.y,this.b_yaogan_bg.x=this.bindPos.x-this.b_yaogan_bg.width/2,this.b_yaogan_bg.y=this.bindPos.y-this.b_yaogan_bg.height/2;var e=180*Math.atan2(d.y,d.x)/Math.PI,f=new Matrix3D;f.appendRotation(e,Vector3D.Y_AXIS),this._speedDirect=f.transformVector(new Vector3D(1,0,0)),this.changeMainChar(e),this.yaoganFunction&&this.yaoganFunction(e)},b.prototype.changeMainChar=function(a){MainCharControlModel.getInstance().setSpeedDirect(this._speedDirect)},b.prototype.butClik=function(a){this.isMouseDown=!0,MainCharControlModel.getInstance().sendStop()},b.prototype.configuiAtlas=function(){var a=new UIAtlas;a.configData=new Array;var b=new Rectangle(0,0,256,128);a.ctx=UIManager.getInstance().getContext2D(b.width,b.height,!1),a.textureRes=new TextureRes,a.textureRes.texture=Scene_data.context3D.getTexture(a.ctx.canvas,0,1),a.configData.push(a.getObject("b_yaogan_bg",0,0,128,128,b.width,b.height)),a.configData.push(a.getObject("b_yaogan_bar",128,0,128,128,b.width,b.height)),this._bottomRender.uiAtlas=a,this._midRender.uiAtlas=a,this.loadConfigCom()},b.prototype.loadConfigCom=function(){this.b_yaogan_bg=this.addChild(this._bottomRender.creatBaseComponent("b_yaogan_bg")),this.b_yaogan_bar=this.addChild(this._bottomRender.creatBaseComponent("b_yaogan_bar")),this.b_yaogan_bg.x=90,this.b_yaogan_bg.y=334,this.b_yaogan_bg.width=130,this.b_yaogan_bg.height=130,this.b_yaogan_bar.x=115,this.b_yaogan_bar.y=360,this.b_yaogan_bar.width=80,this.b_yaogan_bar.height=80,this._midRender.uiAtlas.upDataPicToTexture("pan/pic/b_yaogan_bar.png",this.b_yaogan_bar.skinName),this._midRender.uiAtlas.upDataPicToTexture("pan/pic/b_yaogan_bg.png",this.b_yaogan_bg.skinName),this.addMouseEvent()},b}(UIPanel),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),scene2d;!function(a){var b=function(){function a(){}return Object.defineProperty(a.prototype,"mapresId",{get:function(){return this._mapresId},set:function(a){this._mapresId!=a&&(this.key=null,this.lastUrl=null),this._mapresId=a},enumerable:!0,configurable:!0}),a.prototype.drawCtx=function(a,b){var c=1007;if(!isNaN(this._mapresId)){this._mapresId>0&&(c=this._mapresId);var d=get2dMappicById(c)+b.y+"_"+b.x+".jpg";this.lastUrl!=d&&(this.lastUrl=d,a.upDataPicToTexture(this.lastUrl,this.ui.skinName)),this.key=b}},a}();a.GroundMapVo=b;var c=function(c){function d(){var a=c.call(this)||this;return a.key256=256,a.top=0,a.left=0,a.layer=-1,a.width=UIData.designWidth,a.height=UIData.designHeight,a._bottomRender=new UIRenderComponent,
a.addRender(a._bottomRender),a.initConfigGroundUiAtlas(),a}return __extends(d,c),d.getInstance=function(){return this._instance||(this._instance=new d),this._instance},d.prototype.initData=function(a){void 0===a&&(a=0),this.hasStage||UIManager.getInstance().addUIContainer(this);for(var b=0;b<this.mapuiItem.length;b++){var c=this.mapuiItem[b];c.mapresId=a}this.resetViewMatrx3D()},d.prototype.initConfigGroundUiAtlas=function(){d.configSize&&(this.key256=d.configSize),this.mapuiItem=new Array,this._bottomRender.uiAtlas=new UIAtlas;var c=this._bottomRender.uiAtlas;c.configData=new Array,console.log("configSize",this.key256);var e=4*this.key256;c.ctx=UIManager.getInstance().getContext2D(e,e,!1),c.textureRes=new TextureRes,c.textureRes.texture=Scene_data.context3D.getTexture(c.ctx.canvas,0,1);for(var f=0;16>f;f++){var g=new b;g.id=f;var h=new Vector2D(Math.floor(f%4),Math.floor(f/4));c.configData.push(c.getObject("idk"+f,h.x*this.key256,h.y*this.key256,this.key256,this.key256,e,e)),g.ui=this.addChild(this._bottomRender.creatBaseComponent("idk"+f)),g.ui.scale=2/UIData.Scale*a.Engine2d.htmlScale,this.mapuiItem.push(g)}},d.prototype.resetViewMatrx3D=function(){this.saveUseKey();for(var b=a.AppDataArpg.sceneStagePos,c=0;c<this.mapuiItem.length;c++){var d=this.mapuiItem[c];d.key?(d.ui.x=this.key256*d.key.x+b.x,d.ui.y=this.key256*d.key.y+b.y):d.ui.x=9999}},d.prototype.saveUseKey=function(){for(var b=new Array,c=a.AppDataArpg.sceneStagePos,d=(c.x%this.key256-this.key256,c.y%this.key256-this.key256,0);d<this.mapuiItem.length;d++){var e=new Vector2D(Math.floor(d%4),Math.floor(d/4)),f=new Vector2D(Math.floor(e.x-c.x/this.key256),Math.floor(e.y-c.y/this.key256));f.x>=0&&f.y>=0&&b.push(f)}this.clearKey(b),this.addKeyToUi(b)},d.prototype.clearKey=function(a){for(var b=0;b<this.mapuiItem.length;b++){for(var c=!1,d=0;d<a.length;d++)this.mapuiItem[b].key&&this.mapuiItem[b].key.x==a[d].x&&this.mapuiItem[b].key.y==a[d].y&&(c=!0);c||(this.mapuiItem[b].key=null)}},d.prototype.addKeyToUi=function(a){for(var b=0;b<a.length;b++){for(var c=!1,d=0;d<this.mapuiItem.length;d++)this.mapuiItem[d].key&&this.mapuiItem[d].key.x==a[b].x&&this.mapuiItem[d].key.y==a[b].y&&(c=!0);if(!c){var e=this.getEempty();e.drawCtx(this._bottomRender.uiAtlas,a[b])}}},d.prototype.getEempty=function(){for(var a=0;a<this.mapuiItem.length;a++)if(!this.mapuiItem[a].key)return this.mapuiItem[a]},d}(UIPanel);a.SceneGroundModel=c}(scene2d||(scene2d={}));var scene2d;!function(a){var b=function(){function b(){}return b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.playSkillByChar=function(a,b,c){void 0===b&&(b="jichu_3"),void 0===c&&(c="skill_02");var d=SkillManager.getInstance().getSkill(getSkillUrl(b),c);d.keyAry&&(d.configFixEffect(a),a.playSkill(d))},b.prototype.makeSceneCharById=function(b,c){var d=new a.Scene2dChar;d.setRoleUrl(getRoleUrl(b)),SceneManager.getInstance().addMovieDisplay(d);var e=a.SceneAstarModel.getInstance().getWorldPosByStart2D(c);return d.px=e.x,d.pz=e.z,d},b.prototype.clearScene=function(){SceneManager.getInstance().clearStaticScene(),SceneManager.getInstance().clearScene(),SceneManager.getInstance().ready=!1,MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D)},b.prototype.loadMapById=function(c){b.getInstance().clearScene(),LoadManager.getInstance().load(Scene_data.fileRoot+get2dMapdataById(c),LoadManager.XML_TYPE,function(b){Scene_data.sceneNumId++,a.MapConfig.getInstance().anlyData(b),AstarUtil.makeStarGraph(a.MapConfig.getInstance().astarItem),a.SceneGroundModel.getInstance().initData(c),a.SceneAstarModel.getInstance().showAstarLine(),SceneManager.getInstance().ready=!0})},b.prototype.makesceneChar=function(){GameInstance.mainChar=b.getInstance().makeSceneCharById("50001",new Vector2D(32,25)),a.AppDataArpg.lockMainChar=!0,GameInstance.mainChar.showName("习近平"),GameInstance.mainChar.showBlood(0);for(var c=0;10>c;c++);},b.prototype.addRandomPostion=function(){for(var a=0;20>a;a++){var c=b.getInstance().makeSceneCharById("690092",new Vector2D(random(50),random(50)));c.showBlood(1),c.showName("习近平")}},b.prototype.addChuanshongDian=function(a){var b=new ScenePortal;SceneManager.getInstance().addMovieDisplay(b);var c=AstarUtil.getWorldPosByStart2D(a);return b.setAvatar(670001),b.px=c.x,b.pz=c.z,b},b}();a.LinkScene2DManager=b}(scene2d||(scene2d={}));var scene2d;!function(a){var b=function(){function b(){}return b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.addEvets=function(){var a=this;document.addEventListener(MouseType.KeyDown,function(b){a.onKeyDown(b)}),GameMouseManager.getInstance().onSceneMouseDown=function(b){a.onSceneMouseDown(b)},GameMouseManager.getInstance().addMouseEvent()},b.prototype.onSceneMouseDown=function(a){this.onMouseDown(a)},b.prototype.onKeyDown=function(a){},b.prototype.onMouseDown=function(b){if(GameInstance.mainChar){var c=a.SceneAstarModel.getAstarBySceneV3D(new Vector3D(GameInstance.mainChar.x,0,GameInstance.mainChar.z)),d=a.SceneAstarModel.getInstance().getAstarSceneByMouse(b),e=AstarUtil.findPath2D(c,d);e&&e.length&&(e.shift(),GameInstance.mainChar.applyWalk(e))}},b}();a.SceneLinkEventModel=b}(scene2d||(scene2d={}));var scene2d;!function(a){var b=function(){function b(){}return b.prototype.init=function(){var b=this;Scene_data.fileRoot=" http://"+document.domain+"/arpg/res/",Engine.init(document.getElementById("ArpgStageCanvas")),FpsStage.getInstance().init(document.getElementById("FpsTipsCanvas"),document.getElementById("LoadCanvas")),a.Engine2d.init(),this.initSceneView(),setInterval(function(){b.upFrameData()},1e3/60)},b.prototype.initSceneView=function(){a.SceneLinkEventModel.getInstance().addEvets(),a.LinkScene2DManager.getInstance().loadMapById(1007),a.LinkScene2DManager.getInstance().makesceneChar(),YaoGanModelPanel.getInstance().initData(function(a){})},b.prototype.upFrameData=function(){a.Engine2d.update()},b.prototype.resetSize=function(){a.Engine2d.resetSize()},b}();a.Scene2dStart=b}(scene2d||(scene2d={}));var Arpg2dAstarUtil=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.initAstarFun=function(){AstarUtil.getWorldPosByStart2D=this.getWorldPosByStart2D,AstarUtil.getGrapIndexByPos=this.getGrapIndexByPos,AstarUtil.getHeightByPos=this.getHeightByPos,AstarUtil.getScenePos=this.getScenePos},a.prototype.getScenePos=function(a,b){var c=new InteractiveEvent(InteractiveEvent.Down);c.x=a,c.y=b;var d=scene2d.SceneAstarModel.getInstance().getAstarSceneByMouse(c),e=this.getWorldPosByStart2D(d);return e},a.prototype.getPosIsCanMove=function(a){var b=this.getGrapIndexByPos(a);return this.isGridCanWalk(b)},a.prototype.isGridCanWalk=function(a){return!scene2d.MapConfig.getInstance().isBlock(a.x,a.y)},a.prototype.getGrapIndexByPos=function(a){return scene2d.SceneAstarModel.getAstarBySceneV3D(a)},a.prototype.getWorldPosByStart2D=function(a){return scene2d.SceneAstarModel.getInstance().getWorldPosByStart2D(a)},a.prototype.getHeightByPos=function(a){return 0},a}(),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Arpg2dGameManeger=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.loadScene=function(a,b,c,d){var e=this;this.clearStaticScene(),this.ready=!1;var f=GuidData.map.tbMapVo.id;return 1001==f?(GuidData.player.getLevel()<100&&GameControlManager.sendGmCom("@Rank "+String(100)),TimeUtil.addTimeOut(2e3,function(){NetManager.getInstance().protocolos.teleport_map(1007,1)}),void TimeUtil.addTimeOut(3e3,function(){var a=window.location.toString();window.location.href=a})):void LoadManager.getInstance().load(Scene_data.fileRoot+get2dMapdataById(f),LoadManager.XML_TYPE,function(a){scene2d.MapConfig.getInstance().anlyData(a),AstarUtil.makeStarGraph(scene2d.MapConfig.getInstance().astarItem),scene2d.SceneGroundModel.getInstance().initData(f),d(),e.ready=!0})},b}(scene2d.Scene2dManager),__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Arpg2dGameStart=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.init=function(){a.prototype.init.call(this);var b=!0;b&&(this.configNetRoot(),scene2d.Engine2d.init(),SceneManager._instance=new Arpg2dGameManeger,Arpg2dAstarUtil.getInstance().initAstarFun(),quest.QuestModel.getInstance().meshQuestTargets=this.meshQuestTargets,Scene_data.cam3D.update=this.cam3Dupdate,msgtip.GuideModel.getInstance().hideGuidePop(),this.traceLog())},b.prototype.configNetRoot=function(){(-1!=document.domain.search("h5abc")||-1!=document.domain.search("h5key"))&&(localStorage.setItem("sid","1001"),localStorage.setItem("ipurl","123.56.3.241"),localStorage.setItem("platformid","5"))},b.prototype.meshQuestTargets=function(a,b){1007==GuidData.map.tbMapVo.id?NetManager.getInstance().protocolos.teleport_map(1008,1):NetManager.getInstance().protocolos.teleport_map(1007,1)},b.prototype.traceLog=function(){for(var a="7013,40,20,0,0,0,7013,33,18,0,0,0,7013,48,22,0,0,0,7013,55,28,0,0,0,7013,62,31,0,0,0,7013,29,17,0,0,0",b=a.split(","),c="",d=0;d<b.length/6;d++)c+=b[6*d+0]+","+b[6*d+1]+","+b[6*d+2]+",0,0,0,0,0,0,0,0,0,1,0,0";console.log(c)},b.prototype.cam3Dupdate=function(){},b}(GameStart);